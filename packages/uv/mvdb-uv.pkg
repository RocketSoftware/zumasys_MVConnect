001161RSS.BPş0c00000ECSUB.TEMPLATE.SELş0c2SUBROUTINE SUB.XXX.SEL(VARS,VALS,FEED,F.FILE,MAT RSS.DATA)ş*şINCLUDE RSS.BP RSS.DATA.INCş*şOPEN "FILE" TO F.FILE ELSE STOP 201, "FILE"ş*şXLINE = 'SSELECT FILE .... WITH PARAMS ...'şEXECUTE XLINE CAPTURING JUNKşRETURN0002EESUB.RE.SELş0c2SUBROUTINE SUB.RE.SEL(VARS,VALS,FEED,F.RUNTIME.ERRORS,MAT RSS.DATA)ş*şINCLUDE RSS.BP RSS.DATA.INCş*şFEED.TITLE = RSS$FEED.REC<1>şLOCATE "account" IN VARS SETTING POS THENş  account = VALS<POS>ş  FEED.TITLE := '(Account: ':account:')'şEND ELSE account = ""şLOCATE "user" IN VARS SETTING POS THENş  user = VALS<POS>ş  FEED.TITLE := '(User: ':user:')'şEND ELSE user = ""şRSS$FEED.REC<1> = FEED.TITLEş*şOPEN '','RUNTIME-ERRORS' TO F.RUNTIME.ERRORS ELSE STOP 201, 'RUNTIME-ERRORS'şXLINE = 'SSELECT RUNTIME-ERRORS BY-DSND DATE BY-DSND TIME'şIF account # "" THENş  XLINE := ' WITH USERPIB = "[ ':account:'"'şEND ELSE IF user # "" THENş  XLINE := ' WITH USERPIB = "[ ':user:' ]"'şENDşXLINE := " SAMPLING 100"şEXECUTE XLINE CAPTURING JUNKşRETURN0001F2RSS.DATA.INCş0c2DIM RSS.DATA(20)ş*şEQU RSS$TITLE       TO RSS.DATA(1)şEQU RSS$LINK        TO RSS.DATA(2)şEQU RSS$AUTHOR      TO RSS.DATA(3)şEQU RSS$DATE        TO RSS.DATA(4)şEQU RSS$TIME        TO RSS.DATA(5)şEQU RSS$DESCRIPTION TO RSS.DATA(6)ş*şEQU RSS$FEED.REC    TO RSS.DATA(14)şEQU RSS$USER1       TO RSS.DATA(15)şEQU RSS$USER2       TO RSS.DATA(16)şEQU RSS$USER3       TO RSS.DATA(17)şEQU RSS$USER4       TO RSS.DATA(18)şEQU RSS$USER5       TO RSS.DATA(19)şEQU RSS$USER6       TO RSS.DATA(20)0000EESUB.FEEDS.SELş0c2SUBROUTINE SUB.FEEDS.SEL(VARS,VALS,FEED,F.RSS.FEEDS,MAT RSS.DATA)ş*şINCLUDE RSS.BP RSS.DATA.INCş*şOPEN '','RSS.FEEDS' TO F.RSS.FEEDS ELSE STOP 201, 'RSS.FEEDS'ş*şEXECUTE 'SSELECT RSS.FEEDS # "FEEDS"' CAPTURING JUNKşRETURN000196SUB.FEEDS.ITEMş0c2SUBROUTINE SUB.FEEDS.ITEM(VARS,VALS,F.RSS.FEEDS,FEED.ID,FEED.REC,MAT RSS.DATA)ş*şINCLUDE RSS.BP RSS.DATA.INCş*şRSS$TITLE = FEED.REC<1>şRSS$LINK = "RSS.MAIN?feed=":FEED.IDşIF FEED.REC<2> # "" THENş  PARAMS = FEED.REC<2>ş  IF PARAMS[1,1] # "&" THEN PARAMS = "&":PARAMSş  RSS$LINK := PARAMSşENDşRSS$AUTHOR = "RSS Feed"şRSS$DATE = DATE()şRSS$TIME = TIME()şRSS$DESCRIPTION = FEED.REC<3>şRETURN0007FCSUB.RE.ITEMş0c2SUBROUTINE SUB.RE.ITEM(VARS,VALS,F.RUNTIME.ERRORS,ITEM.ID,RECORD,MAT RSS.DATA)ş*şINCLUDE RSS.BP RSS.DATA.INCş*şRSS$TITLE = ""şRSS$LINK = ""şRSS$AUTHOR = ""şRSS$DATE = ""şRSS$TIME = ""şRSS$DESCRIPTION = ""ş*şDATA RECORD<2,1>şEXECUTE "PRINT-ERR DM,MESSAGES, ":RECORD<1>:" (S" CAPTURING ERRş*şCONVERT @AM TO " " IN ERRşERR = OCONV(ERR,'MCP')şERR = TRIM(ERR)şRSS$TITLE = OCONV(FIELD(ITEM.ID,'*',1),'D0/'):" @ ":OCONV(FIELD(ITEM.ID,'*',2),'MTS'):": ":RECORD<4>:" ":ERRş*şRSS$AUTHOR=RECORD<3>ş*şRSS$DESCRIPTION = 'Pib /User: ':RECORD<3>:'<br />'şSTACK = ""şFOR N = DCOUNT(RECORD<5>,@VM) TO 1 STEP -1ş  STACK := RECORD<5,N>ş  IF STACK # "" AND N # 1 THEN STACK := ' --> 'şNEXT NşIF RECORD<5> # '' THEN RSS$DESCRIPTION := "Stack: ":STACK:'<hr />'şMD = FIELD( RECORD<3>, ' ', 3 )ş*ş* Try and find the source code to include in the feed.ş*şSREC = ""şOPEN MD:",MD," TO F.MD THENş  FNAME = ""ş  READ CREC FROM F.MD, RECORD<4> THENş    IF CREC<1> = "VR" THEN ;* This is a catalog pointer, file name is in field 4ş      FNAME = FIELD(CREC<4>,' ',1)ş    END ELSE IF CREC<1> = "PQ" THENş      IF FIELD(CREC<2>, ' ', 1 ) = "HRUN" THENş        FNAME = FIELD( CREC<2>, ' ', 2 )ş      ENDş    ENDş  ENDş  IF FNAME # "" THENş    OPEN MD:",":FNAME:"," TO SFILE THENş      READ SREC FROM SFILE, RECORD<4> ELSE SREC = ""ş    ENDş  ENDşENDşIF SREC # "" THENş  CALL SWAP(SREC,'&','&amp;')ş  CALL SWAP(SREC,'<','&lt;')ş  CALL SWAP(SREC,'>','&gt;')ş  LINENO = RECORD<2,1>ş  IF LINENO MATCHES "1N0N" THENş    START.LINE = LINENO - 10ş    IF START.LINE < 0 THEN START.LINE = 1ş  END ELSE LINENO = 1 ; START.LINE = 1ş  END.LINE = LINENO + 10ş  RSS$DESCRIPTION := '<pre>'ş  FOR LINUM = START.LINE TO END.LINEş    LINE = LINUM "R#4":" ":SREC<LINUM>ş    IF LINUM = LINENO THEN LINE = '</pre><b>':LINE:'</b><pre>'ş    RSS$DESCRIPTION := LINE:CHAR(10)ş  NEXT LINUMş  RSS$DESCRIPTION := '</pre>'şEND ELSEş  RSS$DESCRIPTION := 'Unable to open source code for ':RECORD<4>:' in account ':MDşENDş*şRSS$DATE = FIELD(ITEM.ID,'*',1)şRSS$TIME = FIELD(ITEM.ID,'*',2)ş*şRETURN0000E1SUB.TEMPLATE.ITEMş0c2SUBROUTINE SUB.XXX.ITEM(VARS,VALS,F.FILE,ITEM.ID,RECORD,MAT RSS.DATA)ş*şINCLUDE RSS.BP RSS.DATA.INCş*şRSS$TITLE = ""şRSS$LINK = ""şRSS$AUTHOR = ""şRSS$DATE = ""şRSS$TIME = ""şRSS$DESCRIPTION = ""ş*şRETURN006E51DICT_DASHBOARD.BALANCESş0c0000020*CURRENT.NET.INCOME.STATSş0c199900001C*LAST.UPDATE.ARş0c119113113100001F*LAST.UPDATE.SALESş0c119097194000003E*CURRENT.AP.STATSş0c142331924ş15903989ş2728093ş1250503ş169201000002ADEBUGş0c1READş3ş1422ü3005ü483ü206ü198ş389200001C*LAST.UPDATE.APş0c119113113100001C*LAST.UPDATE.ALLş0c1UPDATING000024*LAST.UPDATE.NET.INCOMEş0c119113113100001E**LAST.UPDATE.ALLş0c1191131131006CBD*CURRENT.AR.STATSş0c1145608908ş43071741ş19451042ş2787790ş13834461ş2016ı2017ı2018ı2019ı2020şı360ü1520ü317ü116ü115ı1422ü3005ü483ü206ü198ı1397ü3235ü509ü172ü233ı548ü1013ü95ü38ü5şı164696370ü847879531ü219774039ü141932813ü118439101ı515435988ü1401696726ü227649763ü85961979ü77624339ı573563398ü1366076359ü266443141ü73932137ü108298342ı199762638ü513919157ü76008932ü25799874ü558530şı58791ı100283ı104490ı18020şıüüüüü100ü316ü364ü381ü399ü342ü385ı409ü351ü401ü448ü507ü483ü497ü472ü423ü439ü439ü417ı420ü428ü457ü451ü477ü459ü456ü481ü415ü524ü509ü477ı520ü387ü498ü455şıüüüüü161ü4212ü5826ü6594ü8875ü7142ü7515ı5254ü5881ü5021ü7272ü6122ü8031ü9362ü9216ü5601ü6713ü6903ü5854ı6464ü9433ü7866ü6064ü8167ü8359ü10164ü7202ü4924ü7515ü10322ü6424ı7987ü7124ü11015ü8306ş2896ıDu monde entierı2927ı1134ı1530ı2442ıReal Computersı3018ı2549ıHUNGRY HOWIES PIZZAı2801ı2481ı2761ıBobs Used CyclesıIntercom ProductsıBetter Computingı2622ıDrachenblut Delikatessenı1292ı2374ıComp ConsultingıQue DeliciaıElectronic Companyı2891ıBerglunds snabbkopı2589ı1402ı2965ıCyber ProductsıFrankenversandıPiccolo und mehrı1423ı2902ı2704ı2632ı2128ı1619ı1795ı2886ı2871ı1140ı1021ı1122ı3023ıQueen CozinhaıFolies gourmandesıOnes & Zeros Inc.ı1703ı2713ıComputer TechıVictuailles en stockıMemory Capturersı1416ıDisk Productsı2887ı2953ıAjax Computer Electronicsı1660ı2863ı2908ıComp Productsı1123ı2996ıTRGıGaleria del gastronomoıJoe's Computersı2935ıUSA ComputersıGodos Cocina Tipicaı2449ıBottom-Dollar MarketsıBakers Goodsı2552ı1677ı1117ıComputer TipsıEastern ConnectionıAround the HornıData Compı3002ı2335ı2724ı2758ı1608ı2398ı3028ıABC Electronics CorpıHanari CarnesıFranchi S.p.A.ı2997ı2809ıThe Big Cheeseı2915ıWartian HerkkuıChop-suey Chineseı2843ı2969ıWhite Clover MarketsıVins et alcools Chevalierı2970ı2991ı1206ı2727ıFor Computers Inc.ıBills Shoes & Gopedsı2759ı2308ıHILARION-AbastosıWellington Importadoraı2263ı1251ı3015ıClassic ComputersıWolski Zajazdı2710ı2574ı2827ı2937ı3019ı1920ıBetter BytesıBlauer See DelikatessenıData Netı1517ı1012ı2830ı2907ı2959ıSoftware Incı1308ı1599ı1103ı1684ı1544ı2778ı2885ı1381ı1010ı1105ı1434ı1032ıGROSELLA-RestauranteıBon app'ı3009ı2293ı1252ıPericles Comidas clasicası2854ı1705ı2803ı2947ıLongo ToyotaıBest Computer Companyı1958ı2967ıSpecialites du mondeı2047ı2814ıAlfreds FutterkisteıPrinter Productsı2497ıComputers N Moreı2394ı2722ı1072ı1076ıLogical Computersı2974ıSave-a-lot Marketsı2513ıNet Connectı2882ıBits and Bytes IncıComputer Sittersı1351ı1350ı2560ıDie Wandernde Kuhı2115ı2554ıRichter Supermarktı2056ı2531ı2784ı1344ı2624ı1653ı1799ı1829ı2940ı2901ı2733ı1569ıSupremes delicesı2958ı2966ı2708ı3012ıOttilies KaseladenıWhite HouseıTortuga Restauranteı2607ı2979ı1605ı1219ıGreat Lakes Food Marketı2568ı2465ı2986ı1078ı2648ı2920ı2867ı1152ı2906ı1586ı1106ıFrance restaurationı1058ı1511ı2942ı2516ı2545ı2443ı2982ıGourmet Lanchonetesı2943ı2831ı3029ıComputers Inc.Systemsı3032ı2456ıNorth/Southı2628ıPrincesa Isabel Vinhosı1214ıOld World DelicatessenıErnst Handelı2651ı2950ı1372ı3033ı3014ı2894ı2931ı3031ı2962ı1290ı2596ı2895ı2459ı3004ı2944ı1556ı2113ı2757ı3034ı2035ı2703ı2929ı3035ı1265ı1469ıRicardo Adocicadosı1024ı1054ı1358ı1218ı1564ı2690ı3036ı2521ı2933ı2900ı2532ı3037ıB's Beveragesı3024ı2806ı3041ı3038ı1411ı1307ı1119ı2126ı1238ı2538ı1366ı2744ı2406ı3040ı2793ı1452ı1184ı1780ı2434ıAntonio Moreno Taqueriaı3039ıConsolidated Holdingsı1480ı3007ı2313ı3046ı3047ı3048ı1419ı3050ı3053ı3054ı3055ı3056ı1413ı3057ı3058ı3042ı1030ı2670ıFamilia Arquibaldoı1382ı2558ı1157ı3061ı3063ı3064ı3065ı3067ı3069ı3070ıHungry Coyote Import Storı2837ı1717ı3071ı3075ıData Bitsı3000ı2855ı1155ı1299ı3043ı1592ı2925ı2359ı3044ıModem Productsı3076ı1943ı3078ı3080ıWilman Kalaı1211ı3051ı3082ı3059ı3083ı3086ı1097ı2782ı3087ı2783ı3088ı3089ı1775ı3077ı3068ı1289ı1171ı3092ı3093ı2095ı3072ı3073ı1057ı1388ı3095ı3096ı3097ı3098ı2571ı2960ı3074ı3099ıLet's Stop N Shopı3100ı1034ı1762ı2405ı1965ıABC Computersı3101ı3103ı3104ı3105ı3106ı3107ı3081ı1401ı3108ı3109ı3110ı3111ı2880ı3112ı1099ı3114ı3084ı3085ı1257ı3066ı2856ı2859ı1047ı1541ı3011ıLINO-Delicatesesı3091ı3062ı3121ı3122ı3123ı3124ı3125ı1269ı3127ı3126ı3128ı3129ı2941ı3131ı3132ı3102ı3094ı2089ı3137ı3136ı3113ı3006ı3139ı3140ı1287ı3141ı3142ı1415ı2462ı2600ı1540ı3144ı3145ı2694ı2995ı1083ı3146ı3116ı3149ı3150ı3151ı3117ı3118ıComercio Mineiroı3153ı3154ı3156ı3115ı3157ıCactus Comidas para llevaı3158ı3159ı1391ı3160ı1050ı3119ı3162ı3163ı3164ı3130ı2387ıComputer Fancyı3166ı1293ı1859ı3167ı3120ı1183ı3138ı3168ı3171ı3170ı3174ı3143ı3176ı3180ı3181ı2994ıComputer Townı3148ı3178ı3182ı3183ı3184ı3185ı1453ı1028ı1015ı1651ıLILA-Supermercadoı3188ı3191ı3193ı3195ı3196ı3005ı1334ı3179ı3199ı3200ı3201ı3202ı3208ı3209ı3135ı3211ı3212ı3213ı3214ı3215ı2857ı1040ı3161ı3165ı2877ı3169ı1374ı3172ı2740ı2936ı2656ı3219ı3220ı3221ı3177ı3222ı3223ı1261ıComputers R Usı2800ı3225ı3227ı3228ı3230ı3231ı3232ı3189ı3190ı1199ı3192ı3194ı3197ı3233ı3235ı3238ı3239ı1046ıParis specialitesı3240ı3241ı3204ı3205ı3206ı3207ı3242ı3246ı3210ı3247ı3248ı3198ı3173ı3254ı3257ı3258ı3262ı3216ı3263ı3265ı2865ı3217ı3175ıFISSA Fabrica Inter. Salcı3253ı3267ı3268ı3272ı3273ı1486ı1013ı3274ı3277ıVaffeljernetı2973ı3280ı3224ı2822ı3281ı3282ı3283ı3285ı3286ı3229ı3287ı2993ı3234ı3284ıComputer TrainersıBolido Comidas preparadası3237ı3243ı3244ı3245ı3249ı3290ı2664ı3250ı3251ı1087ıRomero y tomilloı3292ı3293ı3255ı3256ı3259ı3291ı3294ı1060ı3261ı1745ı3264ı3297ı3298ı3260ı1818ı3269ı3270ı3271ı2873ı3302ıThe Cracker Boxı3186ı3275ı3276ı3303ı3266ı3226ı3278ı3279ı1182ı3305ı3307ı3133ı3312ı3313ı2689ı3315ıLehmanns Marktstandı3316ı3317ı3296ıBetter ConnectionıNumber One in Computingı3318ı3301ı3322ı3295ı2369ı3321ı3323ı2878ı3324ı3325ı3299ı3300ı3306ı2448ı3304ı3326ı3327ı3309ı3329ı3310ı3330ı3331ı3332ı2938ı3311ı3336ı3337ı3340ı3342ı3344ı3345ı3349ı2031ıComp Data Inc.ı3351ı3350ı3352ı3353ı3354ı3320ı3319ı3357ı3358ı3360ı3328ı3359ı3363ı3364ı3365ı3333ı3366ı3367ı3335ı1118ı3368ı3338ı3371ı3343ı3372ı3373ı2491ı3374ı3022ı3375ı3376ı3377ı3379ı1125ı3381ı3382ı1679ı3384ı3386ı3355ı3387ıOceano Atlantico Ltda.ı3383ı2729ıThe Only Computersı3391ı3390ı3362ı3392ı3393ı3395ı3396ı3370ı3397ı3398ı3399ı3369ı3400ı3402ı3378ı3403ı3404ı3380ı3385ı3406ı3407ı2105ı3388ı3408ı3389ıRancho grandeı3412ı3415ı1286ı3417ı3419ı3401ı3394ı2879ı3424ı3425ı1764ı3405ı3427ı1368ı3428ı3429ı3432ı1601ı3435ı3434ı3436ı1074ı3409ı3410ı2774ı3438ı3439ı3440ı3441ı3418ı3443ı1198ı3444ı3445ı3446ı3447ı3414ı3448ıIsland Tradingı3413ı3416ı3420ı2337ı3452ı1006ı3426ı3431ı3453ı3433ı3454ıFuture In Computingı3347ı3455ıSante Gourmetı2644ı1095ı3442ı3462ı3463ı3468ı3469ı3471ı2592ı2677ı3449ı3473ı3450ı2829ı3476ıDisks N Moreı3477ı3479ı3480ı3481ıSplit Rail Beer & Aleı3484ı3485ı3465ı3487ı3489ı3457ı3490ı3467ı2647ı3461ı3459ı3492ı3494ı2817ı3464ı3496ı3499ıSimons bistroı3466ı3500ı3501ı3504ı3474ı3475ıFuture Computersı2155ı3505ı3506ı3482ı3470ı3411ı3508ı3509ı3472ı2701ı2325ı3491ı3510ı1490ıLazy K Kountry Storeı3493ı3514ı3502ıTradicao Hipermercadosı3515ı3516ı3517ı3518ı2819ı3511ı3519ı3521ı3495ı1393ı3503ı3522ı3524ı3526ı3528ı3529ı3530ıReggiani Caseificiı3507ı3422ı3532ıToms Spezialitatenı3520ı3534ı3536ı3537ı3540ı3512ı1159ı3543ı3545ı3486ı3513ı3548ıComputers Etc.ı3556ı3551ı3553ı3554ı3558ı3559ı1667ı3560ı3561ıMaison Deweyı3563ı2502ı3564ı3527ı3525ı3566ı3567ı3568ı3016ı3538ı3539ı1270ı3573ı3574ıBlondel pere et filsı3542ı3523ı3547ıQUICK-StopıSeven Seas Importsı3544ı3579ı3580ı3550ı3552ı1243ı3583ı3584ı3588ı3586ı3587ı3590ı3589ı2975ı3592ı3593ı2583ı3555ı3549ı3595ı3596ı3598ı3599ı3600ı3569ı3571ı3572ı3602ı3603ı1476ı3575ı2370ı3565ı3605ı3606ı3607ı3610ı3578ı3582ı3611ı3585ı3576ı3013ı3615ı3616ı3591ı3594ı3597ı3617ı3618ı3622ı1598ı3604ı3601ı3624ı3626ı3627ı3581ıRattlesnake Canyon Grocerı3629ı3630ı3609ı3608ı3612ı3613ı3634ı3635ı3631ı3636ı3639ı3640ı3641ı3642ı3643ı3644ı3645ı3646ı3647ı3648ı3649ı3650ı3621ı3652ı3619ı3637ı3625ı3655ıComputer Portables Inc.ı3658ı3628ıKoniglich Essenı3661ı3662ı3665ı2254ı3666ı3667ı3632ı3675ı3676ı3668ı3677ıMere Paillardeı3679ı3680ı3681ı3682ı3683ı3684ı3685ı3686ı3687ı3688ı3689ı3690ı3691ı3692ı3693ı3694ı3695ı3696ı3697ı3698ı3653ı3699ı3700ı3701ı3702ı3704ı3638ı3705ı3706ı3707ı3708ı3709ı3711ı3712ı3713ı3714ı3654ı3716ı3717ı3718ı3719ı3720ı3722ı1407ı3656ı3723ı3726ı3727ı3728ı3729ı3659ı3663ı3664ı3731ı2795ı3734ı3733ı3736ı3738ı3739ı3741ı3742ı3744ı3746ı3743ı3669ı3670ı2000ı3671ı3672ı3673ı3674ı3751ı1082ı3678ı3753ı3754ı3755ı3756ı3757ı3758ı3657ı3710ı3715ı3760ı3761ı3762ı3763ı3764ı3765ı3721ı3725ı3767ı3768ı3769ı3724ı3770ı2912ıMorgenstern Gesundkostı3771ı3772ı3773ıLonesome Pine RestaurantıLa corne d'abondanceı3774ı3737ı3778ı3745ı3748ı3747ı3752ı3780ı3783ı3750ı3784ı3785ı3786ı3788ı3791ı3790ı1114ı2520ı3766ı3794ı3796ı3798ıComputer Warehouseı3793ı3775ı3749ı1291ıMemory Plus Inc.ı3776ı2252ı3801ı3802ı3777ı3804ı3781ı3806ı3807ı3782ı3810ı3787ı3812ı3789ı3813ı3815ı3792ı3821ı3614ı3822ı3759ı3824ı3823ı3795ı3799ı3827ı3828ı3829ı3830ıComputers Galoreı3832ı3833ı3834ı3803ı3835ı3805ı3837ı3836ı3838ı3840ı2099ı3808ı3811ı3841ı2881ı3843ı3844ı3817ı3814ı3740ıLa maison d'Asieı3819ı3816ı3820ı3847ı3848ı3809ı3831ı3826ı3854ı3008ı3825ı3849ı3856ı3857ı3839ı3853ı3860ıLaughing Bacchus Wine Celı3862ı3864ı3800ı3842ı3846ı3845ı3868ı3869ı3850ı3870ı3852ıAna Trujillo Emparedadosı3871ı3872ı3874ı3858ıSecure Computersı3876ı3875ı3859ı3880ı3883ı3884ı3863ı3886ı3887ı3888ı3889ı3891ı3865ı3892ı3873ı3895ı3896ı3877ı3879ı3897ı3881ı3855ı3882ı3898ıFuria Bacalhau e Frutos dıMagazzini Alimentari Riunı1263ı3900ı3901ı3899ı3904ı3905ı3906ı3907ı3909ı3910ı3894ı3890ı1733ı3913ı3912ı3914ı3867ı3866ıHungry Owl All-Night Grocı3893ı3885ı3916ı3918ı3919ı3903ı3920ıCentro comercial Moctezumı3908ı1173ı2706ı3878ı1348ı3917şı250000ııııı584774ıııııııı1433950ı510000ıı250000ııı500000ıı750000ıı436147ıııı8089200ı158400ıııııııııııııııı160550ı1608034ııı485423ıı1045482ıı908400ııııııı2348627ıııı115315ı1000000ıı748879ı87100ıı335050ııııı1069960ı100600ı55043ı699634ııııııııı65284ı121400ıııııı296015ııııııııı836400ıııı46500ııııı572635ıııııııı1734075ı433519ı715625ıııııı4855773ııııııııııııı74000ı390050ıııııııııı712600ıııııı635027ı887500ı25974ı588528ııııı2305506ıııı1110000ıı3254015ı665680ııııııııııııııııııııııııı1788ııııııı76125ıııııııııııı148000ıııııııı86560ıııı2000000ııı63000ıııı21000ı206250ıııııııııııııııııııııııııııııııııı17568ııııı322500ıııııııııııııııııııı443700ıı252192ııııııııııııııııııı203760ııııııııııı8900ııııı855100ıııııııııı1579932ıııııııııııııııııııııııııııııııııııııı38400ıııııı2284902ıııııııııııııııııııııııııı68300ı9700ııııııııııııııııııııııııııııııııııııııııııı252500ıııııı301635ıııııııııııı947550ııı40700ıııııııııııııı577500ııııııııııı17850ıııııııııııııııııııııııııııııııııııı3200ııı1000000ııııııııııııııııııııııııııııııııııııııııııı160600ııııııııııııııııııııııııı547450ı393543ııııııııııııııııııııııııııııııııııııııııııııııııı56850ıııı1242250ı1013550ıııııııııııııııııııııııııııııııııı1030532ıııııııııııııııııııııııııııııııııııııııııı98975ı3200ıı712500ııııııııııııııııııııııııııııııııııııı250000ıııııııııııııııııııııııııııı30158ıııııııııııı2350000ııııııııııııııııııı850000ıııııııııııııııııı51000ıııııııııııı1020000ııııııııııııııı69193ıııı3795ııııııııııı185000ıııııııııııııııııııııııı2793473ıııııııııı2300ıııııı2300ııııııııı408000ıııııııııııııııııı38600ııııııı39800ıııııı152510ııııııııııı19900ııııııııııııııııııııııııııııııııııııııııııııııııııı635452ııı182000ıııııııııııı59500ııııııııııııııııııııı1500ıııııııııııııııııııııııııııııııııııııııııııııııııııııııııııııııııııııı13900ıııııııı91463ıııı8250ı74000ııııııııııııııııııııııı3681755ıı222000ııı1283175ıııııııııııııııııııııııııııııı484035ııııııııııııııııııııı118000ıııııııııııııııııı29900ıııııııııııı481889ııııı1703750ııııııııııııııııııııııııı120440ı71960ııııııııııııııııııı7400ııııııı13900ı300000ıı150000şı58ııııı33ıııııııı299ı116ıı1043ııı1041ıı40ıı86ıııı102ı24ıııııııııııııııı146ı54ııı117ıı152ıı24ııııııı8ıııı24ı29ıı7ı117ıı25ııııı23ı179ı33ı20ııııııııı99ı18ıııııı24ııııııııı29ıııı25ııııı25ıııııııı5ı11ı147ıııııı25ııııııııııııı76ı24ıııııııııı116ıııııı40ı55ı4ı22ııııı179ıııı54ıı13ı116ııııııııııııııııııııııııı6ııııııı1ıııııııııııı130ıııııııı85ıııı152ııı29ıııı25ı42ıııııııııııııııııııııııııııııııııı7ııııı23ıııııııııııııııııııı25ıı11ııııııııııııııııııı25ııııııııııı55ııııı29ıııııııııı25ıııııııııııııııııııııııııııııııııııııı86ıııııı54ıııııııııııııııııııııııııı83ı5ııııııııııııııııııııııııııııııııııııııııııı330ıııııı25ıııııııııııı24ııı24ıııııııııııııı24ııııııııııı83ıııııııııııııııııııııııııııııııııııı22ııı4ııııııııııııııııııııııııııııııııııııııııııı24ııııııııııııııııııııııııı54ı147ııııııııııııııııııııııııııııııııııııııııııııııııı86ıııı146ı217ıııııııııııııııııııııııııııııııııı22ıııııııııııııııııııııııııııııııııııııııııı25ı22ıı25ııııııııııııııııııııııııııııııııııııı20ıııııııııııııııııııııııııııı272ıııııııııııı391ııııııııııııııııııı34ıııııııııııııııııı23ıııııııııııı188ııııııııııııııı99ıııı24ııııııııııı24ıııııııııııııııııııııııı117ıııııııııı53ıııııı22ııııııııı55ıııııııııııııııııı24ııııııı22ıııııı24ııııııııııı22ııııııııııııııııııııııııııııııııııııııııııııııııııı24ııı239ıııııııııııı42ııııııııııııııııııııı20ıııııııııııııııııııııııııııııııııııııııııııııııııııııııııııııııııııııı18ıııııııı34ıııı55ı208ııııııııııııııııııııııı36ıı34ııı178ıııııııııııııııııııııııııııııı147ııııııııııııııııııııı131ıııııııııııııııııı111ıııııııııııı92ııııı89ııııııııııııııııııııııııı54ı54ııııııııııııııııııı25ııııııı14ı13ıı5ş1651ı367ı515ı320ı93ı215ı8001ı80ı1915ı5121ı658ı4204ı394ı1027ı7522ı888ı142ı1083ı386ı266ı1041ı1347ı323ı54ı3020ı701ı216ı1533ı3186ı2299ı3105ı1112ı3534ı879ı1196ı732ı3853ı1061ı1094ı2759ı346ı228ı146ı714ı476ı5535ı1566ı174ı1167ı1413ı713ı973ı630ı1964ı581ı404ı714ı809ı1269ı1719ı430ı419ı282ı2193ı1655ı86ı155ı1246ı741ı1567ı2090ı236ı607ı662ı383ı928ı1428ı4725ı2636ı173ı797ı13ı596ı491ı138ı35ı647ı875ı368ı87ı636ı616ı247ı739ı550ı588ı912ı185ı269ı118ı660ı108ı197ı1295ı141ı1355ı303ı1080ı949ı191ı1262ı259ı601ı712ı2137ı166ı94ı572ı101ı242ı1390ı300ı956ı611ı190ı511ı323ı1676ı2491ı167ı155ı411ı22ı133ı48ı77ı277ı757ı22ı284ı458ı159ı2007ı1449ı405ı75ı870ı169ı340ı1754ı493ı2208ı525ı375ı198ı1060ı346ı364ı2409ı2452ı137ı1121ı732ı96ı190ı212ı585ı275ı145ı75ı366ı50ı3715ı1520ı290ı563ı425ı50ı517ı524ı293ı84ı42ı254ı159ı218ı104ı148ı429ı119ı215ı799ı342ı198ı226ı413ı231ı19ı460ı147ı296ı209ı372ı38ı167ı1073ı8ıı201ı264ı317ı296ı47ı21ı392ı858ı166ı279ı9ı88ı71ı342ı72ı1888ı228ı232ı907ı579ı102ı1274ı439ı224ı574ı36ı337ı326ı136ı540ı109ı12ı112ı211ı70ı10ı65ı11ı8ı4ı75ı21ı21ı55ı131ı88ıı162ı41ı283ı88ı10ı138ı11ı74ı151ı593ı69ı27ı76ı463ı94ı39ı144ı46ı13ı48ı16ı291ı128ı45ı117ı11ı105ı376ı202ı222ı163ı35ı400ı78ı93ı661ı84ı286ı145ı105ı16ı420ı87ı106ıı206ı71ı81ı49ı49ı254ı126ı44ı44ı158ı43ı86ı92ı17ı275ı37ı66ı244ı129ı46ı121ı83ı33ı21ı58ı11ı11ı11ı145ı179ıı158ı12ı151ı92ı121ı73ı73ı273ıı15ı11ı22ı1229ı31ı146ı178ı17ı742ı64ı137ı75ı219ı15ı29ı121ı160ı102ı69ı12ı79ı356ıı110ıı916ı39ı87ı11ı405ı12ı407ı204ı12ı21ı12ı12ııı1734ı11ı475ı20ııı34ı165ı4210ı19ı28ı19ı19ı778ı15ıı137ı14ı14ı14ı14ı18ı23ı239ı401ı49ı14ı99ı48ıı80ı46ıı91ı1227ı291ı188ı13ı13ı13ı13ı479ı11ı20ı10ı37ı10ı6ı81ı9ıı930ı10ı9ı10ı180ı9ı36ı10ı123ı9ı9ı79ı47ı16ı90ı10ı19ı24ıı485ı224ı892ı12ı12ı12ı32ı25ı703ı15ı12ı11ıı50ı213ı20ı10ı9ı9ı35ı149ı9ı9ı9ı20ı19ı1264ı10ı305ı913ı9ı556ı10ı15ı9ı9ı247ı39ı14ı9ı10ı10ı386ı543ı192ı381ı9ı9ı72ı9ı107ı48ı152ı17ı243ı9ı28ı14ı9ı27ı87ıı40ı9ı18ı9ı9ı9ı9ı477ı18ı9ı9ı25ı9ıı87ı514ı163ı36ı27ıı35ıı29ı34ı11ı11ı19ı24ı87ı9ıı42ı245ı10ı18ı10ı10ı40ı260ıı36ı131ı35ı16ıı255ı9ı9ı9ı83ı3141ı9ı9ı228ııı28ı40ı10ı55ı9ı18ı70ı68ı9ı35ı9ı10ıı9ı27ı3ı114ı16ı154ı10ı9ı19ı9ı49ıı310ı18ı9ı33ı13ı198ıı13ı9ı9ı37ı9ı100ıı27ı25ıı11ı849ı147ı182ı27ı2ıı14ı21ı20ı60ı152ıı96ı48ı86ı10ı36ı19ı10ı132ııı25ı13ı9ı18ı79ı44ı13ı22ı9ı18ı9ı607ı376ı56ıı9ı37ı197ı37ı49ı80ı33ı196ı116ı9ı9ı23ı9ı467ı9ı459ıı2501ı299ı71ıı305ı150ıı10ı10ı18ı559ı22ı153ı85ıı104ı3ı72ı9ı3ı10ıı18ı39ı18ı104ı118ı19ı19ı140ı9ı9ı9ı10ı25ı2275ı9ı59ı10ı18ı9ı885ı10ı9ı9ı375ı406ı10ı9ı178ı77ı20ı10ı28ı92ı77ı9ı59ı30ıı37ı9ı9ı9ı63ı9ı9ı9ı12ı26ı60ı19ı31ı9ı9ı9ı9ı414ı325ıı320ı365ı130ı117ı97ı9ı9ı13ı41ı168ı9ı108ı86ı10ı9ı258ı28ı53ıı8ı9ı70ı224ı148ı184ı20ı297ı24ı13ıı9ı9ı400ı33ı114ı40ı18ı100ıı28ı132ı27ı10ı99ı66ı22ı9ı12ıı5ı6ı136ı10ı19ı9ı9ıı9ı75ı9ı9ı9ı28ı101ı30ı1251ı412ı83ı18ı727ı18ı9ı958ıı57ı44ı9ı688ı37ı9ı100ıı103ı35ı30ı9ı9ı9ı9ıı73ı52ı18ı132ı23ı10ı202ı117ı9ı9ı18ı70ı9ı32ı13ı9ı23ı308ı9ı156ı24ı13ı118ı55ı155ıı14ı9ı37ı124ı63ı9ı18ı9ı59ıı336ı188ı9ı9ı318ı30ıı9ı9ı165ı20ı443ı11ı110ı170ı165ı78ı9ı9ı1084ı18ı9ı12ı9ı6ı24ı9ı37ı13ı51ı782ı9ı9ı9ı9ı9ı9ı66ı311ı52ı9ı53ı9ı36ı9ı122ı9ı18ı669ı29ı10ı189ı17ı9ı822ı39ı25ı9ı9ı32ı9ı67ı10ı10ı64ı28ı387ı9ı153ıı74ı9ı9ı102ı111ı110ı73ı9ı9ı57ı34ı15ı174ı106ı152ı296ı9ı9ı23ııı10ı28ı10ı9ı9ı9ı172ı74ı30ı12ıı156ı11ı62ı9ı9ı34ı9ı52ı43ı66ı10ı61ı28ı80ı360ı28ı14ı21ı9ı33ı23ı25ı9ı13ı10ı436ı41ı20ı31ıı33ı9ı18ı18ıı205ı150ı9ı10ı12ı154ı81ı6ı11ı35ı139ı69ı98ı9ı19ı13ı9ı9ı10ı9ı14ı42ı10ı12ı11ı17ı17ı9ı9ı16ı307ı596ı43ıı9ı305ı9ı132ı512ı18ı9ı11ı86ı15ı9ı54ı41ı18ı13ı9ı42ı13ı9ı18ı19ı9ı28ı20ı13ı9ı19ı33ı20ı10ı10ı9ı9ı9ı9ı9ı15ı229ı9ı15ı9ı9ı10ı24ı9ı27ı20ı13ı12ı10ı10ı10ı10ıı9ı9ı9ı9ı23ı10ı9ı567ı9ı10ı16ı9ı10ı96ı70ı21ı191ı35ı41ı9ı9ı9ı9ı27ı19ı10ı9ı63ıı8ııı83ııı9ı8ı8ı19ı75ı9ı10ı9ı78ı56ı29ıı19ı19ı10ı9ı10ı10ı25ı1ı19ı19ı12ı22ı9ıı113ı9ı47ı9ı132ı208ı18ıı18ıııı99ı9ı54ı4ı9ı9ı51ı87ı9ı36ııı33ı9ı10ı9ı45ı42ı109ı59ı31ı184ıı7ı9ı9ı9ı10ı14ı9ı9ı10ı9ı27ı9ı8ı9ı54ı35ı24ı98ı13ı36ı9ı47ı104ıı9ı9ı9ı9ı152ı9ı35ı9ı136ı9ı16ı9ı9ı9ı9ııı23ı18ıı9ı10ıı233ı68ı131ıı131ıı10ı9ı98ı39ı155ı10ıı113ı27ı9ı18ı88ı74ı9ı111ı18ı18ı72ı69ı30ı20ı9ı9ıı10ı85ı219ı9ı9ı9ıı119ı9ı14ı4ı9ı18ı13ı42ı42ı18ı9ı19ı10ı9ı9ıı9ı10ı28ı15ı10ııı6ı9ı78ı126ı60ı10ı10ı9ı9ı9ı10ı9ı9ı11ı7ı7ı9ı13ı9ı11ıı12ı25ıı9ı9ı9ı9ıı14ı13ıı5ş14ı3ı5ı10ı3ı5ı422ı1ı67ı115ı19ı31ı13ı66ı95ı17ı6ı2ı10ı4ı1ı52ı4ı3ı113ı30ı11ı72ı81ı49ı52ı47ı44ı20ı14ı27ı66ı25ı42ı55ı11ı8ı4ı26ı46ı53ı73ı8ı45ı53ı10ı41ı40ı78ı9ı48ı65ı42ı32ı23ı30ı14ı8ı64ı65ı4ı4ı58ı58ı82ı53ı36ı52ı37ı37ı48ı171ı367ı177ı8ı49ı1ı31ı39ı9ı1ı32ı35ı41ı2ı8ı7ı13ı19ı42ı31ı19ı5ı14ı3ı52ı8ı31ı56ı18ı77ı27ı76ı82ı5ı42ı31ı38ı40ı74ı17ı10ı38ı4ı26ı89ı17ı40ı45ı11ı31ı38ı65ı106ı6ı4ı23ı2ı1ı4ı1ı5ı23ı3ı8ı13ı10ı89ı51ı29ı9ı25ı1ı29ı37ı26ı81ı20ı42ı20ı65ı46ı35ı63ı81ı12ı50ı17ı2ı6ı3ı20ı11ı16ı2ı8ı8ı118ı28ı29ı37ı14ı12ı45ı36ı27ı7ı3ı18ı20ı11ı3ı7ı15ı3ı10ı60ı15ı13ı18ı14ı4ı2ı36ı10ı26ı19ı12ı1ı7ı54ı1ıı17ı7ı11ı12ı5ı1ı62ı12ı3ı6ı1ı3ı6ı6ı11ı55ı13ı8ı28ı49ı3ı25ı6ı2ı12ı3ı7ı11ı4ı18ı6ı1ı4ı4ı2ı2ı10ı1ı1ı1ı2ı1ı3ı1ı4ı4ıı3ı4ı7ı4ı1ı1ı2ı3ı10ı12ı6ı2ı3ı15ı5ı1ı7ı2ı2ı3ı1ı7ı1ı1ı3ı1ı3ı18ı5ı12ı7ı2ı10ı4ı4ı39ı6ı7ı8ı6ı1ı16ı2ı13ıı2ı1ı4ı1ı1ı2ı9ı1ı1ı16ı1ı3ı1ı1ı17ı3ı3ı20ı2ı3ı3ı9ı1ı2ı5ı1ı1ı1ı5ı3ıı8ı1ı7ı5ı2ı1ı5ı17ıı4ı1ı1ı58ı2ı15ı5ı1ı28ı4ı5ı1ı16ı2ı3ı6ı4ı8ı1ı1ı8ı9ıı2ıı25ı4ı6ı1ı8ı1ı8ı9ı1ı2ı1ı1ııı50ı1ı7ı1ııı2ı6ı75ı1ı2ı1ı1ı77ı1ıı3ı1ı1ı1ı1ı2ı2ı11ı13ı1ı2ı6ı2ıı8ı2ıı3ı91ı11ı2ı1ı1ı1ı1ı13ı1ı2ı1ı4ı1ı1ı3ı1ıı26ı1ı1ı1ı6ı1ı4ı1ı3ı1ı1ı3ı3ı3ı4ı1ı2ı1ıı23ı7ı14ı1ı1ı1ı1ı1ı8ı1ı1ı1ıı5ı4ı2ı1ı1ı1ı1ı9ı1ı1ı1ı1ı2ı24ı1ı27ı31ı1ı15ı1ı1ı1ı1ı7ı1ı1ı1ı1ı1ı20ı19ı8ı10ı1ı1ı2ı1ı2ı2ı4ı1ı11ı1ı3ı1ı1ı3ı3ıı1ı1ı2ı1ı1ı1ı1ı39ı2ı1ı1ı1ı1ıı3ı25ı5ı4ı1ıı2ıı2ı2ı1ı1ı2ı1ı5ı1ıı3ı10ı1ı2ı1ı1ı3ı6ıı1ı6ı1ı1ıı10ı1ı1ı1ı3ı29ı1ı1ı6ııı1ı4ı1ı3ı1ı2ı5ı13ı1ı4ı1ı1ıı1ı3ı1ı2ı1ı3ı1ı1ı2ı1ı5ıı9ı2ı1ı3ı2ı3ıı2ı1ı1ı4ı1ı11ıı3ı1ıı1ı27ı1ı3ı1ı1ıı1ı2ı1ı2ı1ıı2ı2ı3ı1ı1ı1ı1ı3ııı1ı1ı1ı2ı3ı2ı1ı1ı1ı2ı1ı2ı3ı1ıı1ı2ı12ı1ı1ı4ı3ı3ı1ı1ı1ı1ı1ı19ı1ı8ıı32ı6ı4ıı6ı9ıı1ı1ı2ı10ı2ı12ı1ıı1ı1ı8ı1ı1ı1ıı2ı4ı2ı3ı2ı2ı2ı2ı1ı1ı1ı1ı2ı52ı1ı3ı1ı2ı1ı14ı1ı1ı1ı14ı4ı1ı1ı7ı4ı1ı1ı3ı1ı2ı1ı1ı1ıı4ı1ı1ı1ı3ı1ı1ı1ı1ı2ı2ı2ı2ı1ı1ı1ı1ı21ı6ıı14ı3ı4ı1ı1ı1ı1ı1ı1ı4ı1ı2ı16ı1ı1ı4ı3ı2ıı1ı1ı2ı4ı13ı4ı1ı9ı2ı1ıı1ı1ı38ı1ı2ı1ı2ı2ıı3ı2ı3ı1ı11ı3ı2ı1ı1ıı1ı1ı1ı1ı2ı1ı1ıı1ı3ı1ı1ı1ı3ı9ı1ı16ı19ı1ı2ı22ı2ı1ı20ıı2ı1ı1ı4ı3ı1ı2ıı2ı1ı3ı1ı1ı1ı1ıı1ı3ı2ı1ı1ı1ı5ı3ı1ı1ı2ı2ı1ı2ı1ı1ı2ı8ı1ı5ı2ı1ı1ı2ı3ıı1ı1ı2ı2ı2ı1ı2ı1ı3ıı4ı2ı1ı1ı20ı1ıı1ı1ı3ı2ı9ı1ı1ı1ı4ı3ı1ı1ı16ı2ı1ı1ı1ı1ı1ı1ı1ı1ı3ı17ı1ı1ı1ı1ı1ı1ı3ı14ı2ı1ı2ı1ı4ı1ı12ı1ı2ı4ı3ı1ı1ı2ı1ı18ı1ı1ı1ı1ı2ı1ı1ı1ı1ı2ı1ı5ı1ı8ıı2ı1ı1ı3ı1ı1ı1ı1ı1ı2ı2ı1ı13ı5ı2ı12ı1ı1ı1ııı1ı3ı1ı1ı1ı1ı8ı8ı1ı1ıı14ı1ı3ı1ı1ı1ı1ı3ı4ı4ı1ı6ı2ı1ı12ı1ı1ı1ı1ı2ı1ı1ı1ı1ı1ı3ı3ı2ı1ıı1ı1ı2ı2ıı16ı3ı1ı1ı1ı4ı2ı1ı1ı2ı3ı6ı1ı1ı2ı1ı1ı1ı1ı1ı1ı4ı1ı1ı1ı1ı1ı1ı1ı1ı10ı11ı1ıı1ı17ı1ı10ı10ı2ı1ı1ı6ı1ı1ı4ı4ı2ı1ı1ı1ı1ı1ı2ı2ı1ı3ı2ı1ı1ı1ı1ı2ı1ı1ı1ı1ı1ı1ı1ı1ı9ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ıı1ı1ı1ı1ı1ı1ı1ı22ı1ı1ı1ı1ı1ı10ı2ı4ı1ı1ı2ı1ı1ı1ı1ı3ı2ı1ı1ı1ıı1ııı3ııı1ı1ı1ı2ı1ı1ı1ı1ı4ı5ı1ıı2ı2ı1ı1ı1ı1ı2ı1ı2ı2ı1ı2ı1ıı3ı1ı4ı1ı4ı1ı2ıı2ıııı1ı1ı5ı1ı1ı1ı1ı1ı1ı1ııı1ı1ı1ı1ı2ı2ı7ı3ı1ı3ıı1ı1ı1ı2ı1ı1ı1ı1ı1ı1ı3ı1ı1ı1ı6ı1ı2ı2ı1ı5ı1ı1ı7ıı1ı1ı1ı1ı2ı1ı4ı1ı1ı1ı2ı1ı1ı1ı1ııı1ı1ıı1ı1ıı9ı5ı1ıı4ıı1ı1ı6ı1ı2ı1ıı7ı1ı1ı2ı3ı3ı1ı1ı2ı2ı1ı1ı5ı2ı1ı1ıı1ı1ı4ı1ı1ı1ıı2ı1ı1ı1ı1ı2ı1ı2ı1ı2ı1ı2ı1ı1ı1ıı1ı1ı4ı1ı1ııı1ı1ı2ı3ı2ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ıı1ı1ıı1ı1ı1ı1ıı1ı1ıı1şı58ıı22ııı1067ııı555ıııı78ı1436ı140ıı1043ııı1041ı61ı40ıı354ı24ıı22ı447ı109ı163ı2ı44ı10ııı4ııı38ııııı48ıı242ıı26ı202ı110ı190ı34ı43ıı16ı36ı8ııı59ııı292ı276ı29ıı55ı125ı97ı153ı15ı21ı6ı4ı90ı218ı255ı76ııııı9ııı73ı236ı20ııı305ıı175ı31ııı51ı28ıı30ııı50ı20ı75ıı43ı96ııı18ı222ı48ı8ı19ıı25ıı4ı41ı63ı416ı32ı11ıı5ı30ı157ııı3ıııııııııı76ı483ı70ııı199ıı5ıı1ı173ı170ı11ı5ı57ı4ıı894ı91ı8ı41ııııı62ı23ı16ıı54ıı791ı346ı3ıı15ı12ı18ıı20ııı4ı6ı21ııı6ııı30ı5ı53ııııı38ı18ı74ı6ıııı39ııııııııı18ııı130ıııııı8ıı163ıııı344ııı56ıı122ı26ı25ı123ıııııııııııııııı14ıııııııııı58ıııııııı7ııııı32ıııııı15ı17ıı8ııııı42ıııı13ıı52ıı16ıııı9ıııı9ııı11ıı33ıııııı77ııııııııııı55ııııı29ııııııı1ııı79ııııı36ıııııııı21ııııııııııııııı40ıııııııı110ıı196ıııııı1786ııııı37ııı38ıııııııı21ıııııı3ıııı83ı5ıııııııııııııııı22ıııııııııııı9ı3ı12ııııı4ıı328ıııııı629ıııııı49ıııııııııııı24ıı18ı139ııııııı21ııııııı140ııııııııııı67ııııııııııııııı47ıııııııı55ııııııııııııı41ııı4ıııııı11ıııııııı22ııııı1083ııııııııııııı10ıı7ııııııııı24ıııııııııı17ııııııııııııııı297ı147ı69ıııııııııı88ııııııııııııııııııııı518ııııııııı2ıııııııı136ıııı565ı217ııııııııııı11ııııııı3ıııııııııııııııı140ıııııı173ııııııııı10ıııııııııııııı22ııııııııııııı74ı150ıı48ıııııııııııı9ııııııı8ıııı15ııı201ıııııı133ııııı20ıııııı9ıııııııııı10ııııııııı10ııı505ı83ııı65ııı135ııııı55ı8ıı90ıııııııııııııııı89ııııı61ıııııı24ııı5ıııı23ııııı109ııııı41ıı217ıııı33ııııııııııı99ıııı326ııııııııııı36ııııııı44ı34ı30ıı44ıııı27ııı60ı10ııııı336ıııııııııı53ıııııı22ııııııııı55ııı9ı92ı134ı22ııııııı9ııııı40ı40ıııı31ıı44ıııııı32ı2ııııı125ııııı22ııııııııııııııııı28ııııııııııııııııııııııııııııı33ı484ıııı94ıı29ı420ııııııı29ııııı42ıııı10ııııııııııııııııı66ıııııııııııııııııııııııı211ıııııı13ı13ı4ı191ıııııııııııııııııııııı9ıııııı8ııııııııı18ıııııııı58ıııı67ı208ııııııııı26ıııııııııııııı36ı19ı68ı27ıııııııııııııı16ııııııııı9ııı80ıııııııııı136ııııııııııııııı167ı62ııı97ıııı7ıı155ııı96ııııııı111ı9ı9ı72ı69ı20ı11ııııı85ı219ııııı119ııııı9ıı42ı42ı9ıı10ı10ı9ı9ıı9ı10ı28ı15ı10ııı6ı9ı78ı126ı60ı10ı10ı9ı9ı9ı10ı9ı9ı11ı7ı7ı9ı13ı9ı11ıı12ı25ıı9ı9ı9ı9ıı14ı13ıı5şı1ıı1ııı41ııı12ıııı4ı9ı2ıı1ııı1ı1ı1ıı10ı2ıı6ı6ı3ı1ı1ı1ı1ııı1ııı4ııııı2ıı4ıı2ı4ı1ı3ı3ı2ıı4ı3ı1ııı7ııı7ı6ı1ıı7ı3ı7ı4ı2ı2ı2ı1ı4ı16ı20ı9ııııı2ııı3ı4ı2ııı2ıı3ı2ııı1ı1ıı3ııı2ı2ı6ıı3ı6ııı2ı6ı2ı2ı4ıı2ıı1ı5ı3ı5ı2ı1ıı1ı5ı8ııı3ıııııııııı1ı10ı4ııı2ıı1ıı1ı6ı2ı2ı1ı2ı1ıı14ı7ı2ı2ııııı3ı1ı1ıı1ıı15ı5ı1ıı2ı2ı2ıı1ııı2ı1ı2ııı1ııı3ı1ı2ııııı5ı1ı4ı1ıııı3ııııııııı4ııı1ıııııı2ıı3ıııı4ııı2ıı1ı1ı1ı5ıııııııııııııııı1ıııııııııı2ıııııııı1ııııı2ıııııı2ı1ıı1ııııı3ıııı1ıı2ıı2ıııı1ıııı1ııı1ıı1ıııııı4ııııııııııı1ııııı1ııııııı1ııı3ııııı1ıııııııı1ııııııııııııııı1ıııııııı4ıı2ıııııı30ııııı4ııı1ıııııııı2ıııııı1ıııı1ı1ıııııııııııııııı1ıııııııııııı1ı1ı1ııııı1ıı4ıııııı2ıııııı2ıııııııııııı1ıı3ı5ııııııı1ııııııı6ııııııııııı3ııııııııııııııı4ıııııııı5ııııııııııııı2ııı1ıııııı1ıııııııı1ııııı3ııııııııııııı2ıı1ııııııııı1ıııııııııı1ııııııııııııııı5ı1ı1ıııııııııı1ııııııııııııııııııııı1ııııııııı1ıııııııı2ıııı7ı1ııııııııııı1ııııııı1ıııııııııııııııı5ıııııı3ııııııııı1ıııııııııııııı1ııııııııııııı4ı2ıı3ıııııııııııı2ııııııı1ıııı2ııı3ıııııı15ııııı1ıııııı1ıııııııııı1ııııııııı1ııı5ı3ııı3ııı3ııııı1ı1ıı1ıııııııııııııııı3ııııı1ıııııı2ııı1ıııı1ııııı1ııııı2ıı2ıııı3ııııııııııı1ıııı3ııııııııııı3ııııııı1ı3ı1ıı1ıııı3ııı1ı1ııııı6ıııııııııı1ıııııı1ııııııııı1ııı2ı2ı1ı2ııııııı1ııııı2ı3ıııı3ıı2ıııııı3ı1ııııı3ııııı1ııııııııııııııııı1ııııııııııııııııııııııııııııı2ı6ıııı5ıı2ı5ııııııı2ııııı1ıııı1ııııııııııııııııı3ıııııııııııııııııııııııı8ıııııı2ı1ı1ı1ıııııııııııııııııııııı1ıııııı2ııııııııı1ıııııııı2ıııı2ı1ııııııııı2ıııııııııııııı1ı1ı4ı1ıııııııııııııı2ııııııııı2ııı6ıııııııııı1ııııııııııııııı6ı3ııı2ıııı2ıı2ııı4ııııııı1ı1ı1ı1ı1ı3ı1ııııı1ı4ııııı2ııııı1ıı2ı1ı1ıı1ı1ı1ı1ıı1ı1ı4ı1ı1ııı1ı1ı2ı3ı2ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ı1ıı1ı1ıı1ı1ı1ı1ıı1ı1ıı1şCyber ProductsıSoftware IncıComputer WarehouseıBits and Bytes IncıComputers Etc.ıFuture In ComputingıComp ProductsıLogical ComputersıABC ComputersıComputers Inc.SystemsıBetter BytesıSecure ComputersıOnes & Zeros Inc.ıModem ProductsıIntercom ProductsıMemory Plus Inc.ıBetter ConnectionıNet ConnectıComputer TipsıMemory CapturersıComp Data Inc.ıFuture ComputersıNumber One in ComputingıComputers R UsıJoe's ComputersıComputer FancyıDisk ProductsıPrinter ProductsıData BitsıDisks N MoreıFor Computers Inc.ıElectronic CompanyıUSA ComputersıData NetıBest Computer CompanyıThe Only ComputersıData CompıComputer SittersıComputer Portables Inc.ıAlfreds FutterkisteıComputers N MoreıReal ComputersıComputer TownıClassic ComputersıComputer TrainersıBetter ComputingıComp ConsultingıComputer TechıComputers GaloreıAna Trujillo EmparedadosıAntonio Moreno TaqueriaıBerglunds snabbkopıBlauer See DelikatessenıBlondel pere et filsıBolido Comidas preparadasıBon app'ıBottom-Dollar MarketsıB's BeveragesıCactus Comidas para llevaıChop-suey ChineseıComercio MineiroıConsolidated HoldingsıDrachenblut DelikatessenıDu monde entierıErnst HandelıFamilia ArquibaldoıFISSA Fabrica Inter. SalcıFolies gourmandesıFrankenversandıFrance restaurationıFranchi S.p.A.ıGaleria del gastronomoıEastern ConnectionıGodos Cocina TipicaıGourmet LanchonetesıGreat Lakes Food MarketıGROSELLA-RestauranteıHanari CarnesıNorth/SouthıAround the HornıHILARION-Abastosı2497ıOttilies Kaseladenş8089200ı4855773ı3681755ı3254015ı2793473ı2350000ı2348627ı2305506ı2284902ı2000000ı1734075ı1703750ı1608034ı1579932ı1433950ı1283175ı1242250ı1110000ı1069960ı1045482ı1030532ı1020000ı1013550ı1000000ı1000000ı947550ı908400ı887500ı855100ı850000ı836400ı750000ı748879ı715625ı712600ı712500ı699634ı665680ı635452ı635027ı588528ı584774ı577500ı572635ı547450ı510000ı500000ı485423ı484035ı481889ı443700ı436147ı433519ı408000ı393543ı390050ı335050ı322500ı301635ı296015ı252500ı252192ı250000ı250000ı206250ı203760ı160600ı160550ı158400ı148000ı121400ı115315ı100600ı87100ı86560ı76125ı74000ı65284ı63000ı55043ı46500ı25974ı1788şDrachenblut DelikatessenıComp ConsultingıFuture In ComputingıComercio MineiroıIntercom ProductsıIsland TradingıKoniglich EssenıNumber One in ComputingıLa corne d'abondanceıFuture ComputersıLogical ComputersıEastern ConnectionıMemory Plus Inc.ıComputers Inc.SystemsıMemory CapturersıComputers GaloreıBolido Comidas preparadasıData NetıBetter ConnectionıFolies gourmandesıLa maison d'AsieıFrance restaurationıComputers Etc.ıGodos Cocina TipicaıComputer TechıComputer SittersıBest Computer CompanyıBetter ComputingıLaughing Bacchus Wine CelıCyber ProductsıLazy K Kountry StoreıHanari CarnesıAna Trujillo EmparedadosıSecure ComputersıLehmanns MarktstandıLet's Stop N ShopıBerglunds snabbkopıGourmet LanchonetesıLILA-SupermercadoıLINO-DelicatesesıGROSELLA-RestauranteıDu monde entierıLonesome Pine RestaurantıBlondel pere et filsıHungry Coyote Import StorıPrinter ProductsıMagazzini Alimentari RiunıFuria Bacalhau e Frutos dıComputer TrainersıABC ComputersıNet ConnectıOnes & Zeros Inc.ıMaison DeweyıMere PaillardeıErnst HandelıAlfreds FutterkisteıElectronic CompanyıComputer WarehouseıMorgenstern GesundkostıDisks N MoreıAround the HornıReal ComputersıData BitsıNorth/SouthıFor Computers Inc.ıJoe's ComputersıThe Only ComputersıOceano Atlantico Ltda.ıCactus Comidas para llevaıModem ProductsıFamilia ArquibaldoıAntonio Moreno TaqueriaıOld World DelicatessenıSoftware IncıClassic ComputersıHILARION-AbastosıBottom-Dollar MarketsıFISSA Fabrica Inter. SalcıComputer Townı1859ıComputer FancyıBon app'ıChop-suey ChineseıGaleria del gastronomoıDisk ProductsıFrankenversandıB's BeveragesıComputer TipsıComputers N MoreıData CompıFranchi S.p.A.ıBits and Bytes IncıConsolidated HoldingsıBlauer See DelikatessenıComp Productsı2521ıUSA ComputersıOttilies KaseladenıBetter Bytesı2497ıGreat Lakes Food Marketş1043ı1041ı391ı330ı299ı272ı239ı217ı208ı188ı179ı179ı178ı152ı152ı147ı147ı147ı146ı146ı131ı130ı117ı117ı117ı116ı116ı116ı111ı102ı99ı99ı92ı89ı86ı86ı86ı85ı83ı83ı76ı58ı55ı55ı55ı55ı54ı54ı54ı54ı54ı54ı53ı42ı42ı40ı40ı36ı34ı34ı33ı33ı29ı29ı29ı29ı25ı25ı25ı25ı25ı25ı25ı25ı25ı25ı25ı24ı24ı24ı24ı24ı24ı24ı24ı24ı23ı23ı22ı20ı18ı13ı11ı11ı8ı7ı7ı6ı5ı4ı1şComercio MineiroıParis specialitesıDrachenblut DelikatessenıThe Cracker Boxş257.9ı233.3ı92.6ı70.7ş31.5ı36.1ı104.3ı51.8ş8.8ı10.8ı54.2ı30.4000257DICT_PORTAL.SALESş0c0000033CLOSE.DATE.YMOş0c1Aş0şşşşşşA;1(DY):1(D2-)(G-1)şRş1000002BCLOSE.DATE.MMş0c1Aş1şCLOSE MONTHşşşşşDMşRş800002CCLOSE.DATE.YMş0c1Aş0şşşşşşA;1(DY):1(DM)şRş10000028CLOSE.DATEş0c1Sş1şCLOSE DATEşşşşD2-şşRş8000022REP.NAMEş0c1Aş5şRep.NameşşşşşşLş2500002CCLOSE.DATE.YYYYş0c1Aş1şCLOSE DATEşşşşşDYşRş800001APIPEş0c1Aş0ş şşşşşF;C|şLş1000045GROSS.PROFITş0c1Aş0şgross profitşşşşMD2şA;N(EXT.AMT)-N(EXT.COST)şRş10000019BRANCHş0c1Aş13şşşşşşşLş15000019REGIONş0c1Aş14şşşşşşşLş15000026EXT.AMTş0c1Aş8şExt.AmountşşşşMD2şşRş10000025EXT.COSTş0c1Aş9şExt.CostşşşşMD2şşRş10000018CNTş0c1Aş0şşşşşşF;C1şRş50000E2DICT_PORTAL.APş0c0000026DATE.PAIDş0c1Aş8şDate PaidşşşşD2-şşRş8000029INV.AMOUNTş0c1Aş6şInv.AmountşşşşMD2şşRş13000025DUE.DATEş0c1Aş20şDue.DateşşşşD2-şşRş8000024BALANCEş0c1Aş50şBalanceşşşşMD2şşRş1300001APIPEş0c1Aş0ş şşşşşF;C|şLş100015EDICT_MVDB.WIDGET.TYPESş0c000001ATYPEş0c1Aş1şTYPEşşşşşşLş15000018SWFş0c1Aş2şSWFşşşşşşLş15000020HANDLERş0c1Aş3şHANDLERşşşşşşLş1500001AICONş0c1Aş4şICONşşşşşşLş2500001ADESCş0c1Aş6şDESCşşşşşşLş300000171ş0c1Aş1şTYPEşşşşşşLş150000172ş0c1Aş6şDESCşşşşşşLş300000173ş0c1Aş4şICONşşşşşşLş2500001CGROUPş0c1Aş5şGROUPşşşşşşLş15000021INACTIVEş0c1Aş7şINACTIVEşşşşşşLş1000C72MVDB.WIDGET.TYPESş0c0000043FC2DPIEş0c2FC2DPIEşPie2DşFCPIEşpie_widget_icon.jpgşPIEş2D Pie Chart00005CSPARKCOLUMNş0c2SPARKCOLUMNşSparkColumnşFWSPARKşspark_widget_icon.gifşFWşSpark Column Chartş1000055VBULLETş0c2VBULLETşVBulletşFWBULLETşbullet_widget_icon.gifşFWşVertical Bullet Chartş1000054SPARKLINEş0c2SPARKLINEşSparkLineşFWSPARKşspark_widget_icon.gifşFWşSpark Line Chartş1000057HBULLETş0c2HBULLETşHBulletşFWBULLETşbullet_widget_icon.gifşFWşHorizontal Bullet Chartş100004AFCCOLUMN3Dş0c2FCCOLUMN3DşColumn3DşSşcol_widget_icon.jpgşLCş3D Column Chart00005DFCMSCOLUMN3Dş0c2FCMSCOLUMN3DşMSColumn3DşMşcol_widget_icon.jpgşLCş3D Multi-Series Column Chart000039TABLEş0c2TABLEşşTABLEştable_widget_icon.jpgşşTable Widget000060HLINEARGAUGEş0c2HLINEARGAUGEşHLinearGaugeşFWGAUGEşlinear_widget_icon.jpgşFWşLinear Gauge Chartş1000045FUNNELş0c2FUNNELşFunnelşFWFPşfunnel_widget_icon.gifşFWşFunnel Chartş1000061SPARKWINLOSSş0c2SPARKWINLOSSşSparkWinLossşFWSPARKşspark_widget_icon.gifşFWşSpark Win/Loss Chartş100005BTHERMOMETERş0c2THERMOMETERşThermometerşFWGAUGEştherm_widget_icon.jpgşFWşThermometer Chartş100004APYRAMIDş0c2PYRAMIDşPyramidşFWFPşpyramid_widget_icon.jpgşFWşPyramid Chartş1000060ANGULARGAUGEş0c2ANGULARGAUGEşAngularGaugeşFWGAUGEşangle_widget_icon.jpgşFWşAngular Gauge Chartş100003AUSAMAPş0c2MAPşMAPşşmap_widget_icon.jpgşMAPşUSA Map Chartş1000043FCAREA2Dş0c2FCAREA2DşArea2DşSşarea_widget_icon.gifşLCş2D Area Chart000051FCMSBAR2Dş0c2FCMSBAR2DşMSBar2DşMşbar_widget_icon.gifşLCş2D Multi-Series Bar Chart000067FCSTACKEDCOLUMN2Dş0c2FCSTACKEDCOLUMN2DşStackedColumn2DşMşcol_widget_icon.jpgşLCş2D Stacked Column Chart000059FCDOUGHNUT2Dş0c2FCDOUGHNUT2DşDoughnut2DşFCPIEşdonut_widget_icon.jpgşPIEş2D Doughnut Chart00003ATEXTş0c2TEXTşşTEXTştext_widget_icon.pngşşPreformatted Text000052CYLINDERş0c2CYLINDERşCylinderşFWGAUGEşcylinder_widget_icon.jpgşFWşCylinder Chartş1000054FCMSAREA2Dş0c2FCMSAREA2DşMSAreaşMşarea_widget_icon.gifşLCş2D Multi-Series Area Chart000034HTMLş0c2HTMLşşHTMLşhtml_widget_icon.pngşşHTML Widget00003AFCLINEş0c2FCLINEşLineşSşline_widget_icon.gifşLCşLine Chart00004DFCMSLINEş0c2FCMSLINEşMSLineşMşline_widget_icon.gifşLCşMulti-Series Line Chart000043FC3DPIEş0c2FC3DPIEşPie3DşFCPIEşpie_widget_icon.jpgşPIEş3D Pie Chart000045VLEDş0c2VLEDşVLEDşFWGAUGEşled_widget_icon.jpgşFWşVertical LED Gaugeş1000047HLEDş0c2HLEDşHLEDşFWGAUGEşled_widget_icon.jpgşFWşHorizontal LED Gaugeş100004AFCCOLUMN2Dş0c2FCCOLUMN2DşColumn2DşSşcol_widget_icon.jpgşLCş2D Column Chart00003EFCBAR2Dş0c2FCBAR2DşBar2DşSşbar_widget_icon.gifşLCş2D Bar Chart00005DFCMSCOLUMN2Dş0c2FCMSCOLUMN2DşMSColumn2DşMşcol_widget_icon.jpgşLCş2D Multi-Series Column Chart000067FCSTACKEDCOLUMN3Dş0c2FCSTACKEDCOLUMN3DşStackedColumn3DşMşcol_widget_icon.jpgşLCş3D Stacked Column Chart00005BFCSTACKEDBAR2Dş0c2FCSTACKEDBAR2DşStackedBar2DşMşbar_widget_icon.gifşLCş2D Stacked Bar Chart00003CGANTTş0c2GANTTşGanttşşgantt_widget_icon.gifşFWşGantt Chartş1000042FAILEDş0c2FAILEDşşFAILEDştext_widget_icon.pngşşPreformatted Textş1000033MAPş0c2MAPşMAPşşmap_widget_icon.jpgşMAPşMap Chartş100003EBULBş0c2BULBşBulbşFWGAUGEşbulb_widget_icon.jpgşFWşBulb Gaugeş1000061FCSTACKEDAREA2Dş0c2FCSTACKEDAREA2DşStackedArea2DşMşarea_widget_icon.gifşLCş2D Staacked Area Chart0155A3WOBJ.BPş0c0000B9CWOBJ.PARSEOBJECTş0c2SUBROUTINE WOBJ.PARSEOBJECT(JSTR,INDEXPOS,PARSEOBJECT)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: parse json objectş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şIF WOBJ.DEBUG THEN PRINT "PARSEOBJECT - STARTING"ş*şPARSEOBJECT=""şCALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)ş*şIF JSTR[INDEXPOS,1] <> "{" THENş    PSERRORS<-1> = "Invalid Object at position ":INDEXPOS:" : ":JSTR[INDEXPOS,1]ş    RETURNşENDş*şLEN.JSTR = LEN(JSTR)şINDEXPOS+=1ş*ş*şJSONOBJECT(JSONOBJECT$NODECNTR)+=1şNODEID=JSONOBJECT(JSONOBJECT$NODECNTR); * WE NEED TO STAY AT THIS NODEID POSITIONşJSONOBJECT(JSONOBJECT$NODETYPE)<1,NODEID>="O"; *SET AS OBJECTşIF WOBJ.DEBUG THENş    PRINT "PARSEOBJECT: SETTING NODETYPE NODEID:":NODEID:" = O"şENDş*şLOOPş    CALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)ş    C=JSTR[INDEXPOS,1]ş    BEGIN CASEş        CASE C="}"ş            INDEXPOS+=1ş            IF WOBJ.DEBUG > 1 THEN PRINT "PARSEOBJECT: EXIT CHAR }"ş            EXITş        CASE C=","ş            INDEXPOS+=1ş            CALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)ş        CASE INDEXPOS > LEN.JSTRş            PSERRORS<-1>="Missing '}': ":JSTR[LEN.JSTR-20,20]ş            EXITş    END CASEş    *ş    * ADD KEY/VALUE PAIRş    *ş    JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEID>+=1ş    PARTPOS=JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEID>ş    IF WOBJ.DEBUG THEN PRINT "PARSEOBJECT: ":NODEID:" PARSEOBJECT CALLING PARSEKEY"ş    CALL WOBJ.PARSEKEY(JSTR,INDEXPOS,SKEY)ş    JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)<1,NODEID,PARTPOS>=SKEYş    IF WOBJ.DEBUG THEN PRINT "PARSEOBJECT: ":NODEID:" BACK FROM PARSEKEY: ":SKEY[1,10]ş    *ş    IF WOBJ.DEBUG THEN PRINT "PARSEOBJECT: ":NODEID:" CALLING PARSEVALUE"ş    CALL WOBJ.PARSEVALUE(JSTR,INDEXPOS,PARSEVALUE)ş    IF WOBJ.DEBUG THEN PRINT "PARSEOBJECT: ":NODEID:" BACK FROM PARSEVALUE N=":NODEID:" P=":PARTPOS:" T=":PARSEVALUE<1>:" F=":PARSEVALUE<2>ş    BEGIN CASEş        CASE PARSEVALUE=""ş            PSERRORS<-1>="Invalid value syntax for node ":SKEYş            RETURNş        CASE PARSEVALUE<1>="A" OR PARSEVALUE<1>="O"ş            * ARRAYş            JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,NODEID,PARTPOS>=PARSEVALUE<1>ş            JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,NODEID,PARTPOS>=PARSEVALUE<2>ş        CASE 1ş            JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,NODEID,PARTPOS>=PARSEVALUE<1>ş            V=PARSEVALUE<2>ş            IF INDEX(V,LF,1) OR INDEX(V,CR,1) THENş                V=OCONV(V,"MX0C")ş                E="H"ş            END ELSEş                E="A"ş            ENDş            JSONOBJECT(JSONOBJECT$NODEPARTS.VALUE)<1,NODEID,PARTPOS>=Vş            JSONOBJECT(JSONOBJECT$NODEPARTS.ENCODING)<1,NODEID,PARTPOS>=Eş    END CASEşREPEATşPARSEOBJECT="O"şPARSEOBJECT<2>=NODEIDşIF WOBJ.DEBUG THEN PRINT "PARSEOBJECT - END OF ROUTINE"şRETURNşENDş0003E3WOBJ.INCLUDEş0c2*ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: WOBJ includes for json libraryş*ş**********************************************************************ş*şCOMMON /MVIWOBJ/ PSERRORS,JSONOBJECT(20),WOBJ.DEBUG,PRETTIFY,PRETTIFYCR,INDENT.DEPTHş*şEQU CR TO CHAR(13), LF TO CHAR(10), TB TO CHAR(9), BS TO CHAR(8), FF TO CHAR(12)şNL = CR:LFş*şEQU INVALID_JSON TO 1şEQU INVALID_OBJECT TO 2şEQU INVALID_ARRAY TO 3şEQU INVALID_BOOLEAN TO 4şEQU INVALID_NULL TO 5şEQU INVALID_KEY TO 6ş*şEQU JSONOBJECT$NODECNTR TO 2ş* ARRAY OF NODESşEQU JSONOBJECT$NODETYPE TO 3şEQU JSONOBJECT$NODELENGTH TO 4şEQU JSONOBJECT$NODEPARTS.KEY TO 5şEQU JSONOBJECT$NODEPARTS.TYPE TO 6şEQU JSONOBJECT$NODEPARTS.FLINK TO 7şEQU JSONOBJECT$NODEPARTS.BLINK TO 8şEQU JSONOBJECT$NODEPARTS.ENCODING TO 9şEQU JSONOBJECT$NODEPARTS.VALUE TO 10ş* END OF ARRAY OF NODES000248WOBJ.NUMBER.TOSTRINGş0c2SUBROUTINE WOBJ.NUMBER.TOSTRING(JSON,NODEPOS,PARTPOS)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: convert json number to stringş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şCALL WOBJ.DECODE.PART(NODEPOS,PARTPOS,VALUE)ş*şCALL WOBJ.ENCODE(VALUE,OUT.VALUE)şJSON:=OUT.VALUEş*şIF WOBJ.DEBUG THEN PRINT "N=":NODEPOS:" P=":PARTPOS:" V=":VALUEşRETURNşEND000797WOBJ.PARSEKEYş0c2SUBROUTINE WOBJ.PARSEKEY(JSTR,INDEXPOS,PARSEKEY)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: parse json property keyş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şPARSEKEY=""şIF WOBJ.DEBUG THEN PRINT "PARSEKEY: ENTERING ":INDEXPOSş*şCALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)ş*şLEN.JSTR = LEN(JSTR)ş*şIFDQUOTE = 0şIFSQUOTE = 0şşLOOPşWHILE INDEXPOS > 0 AND INDEXPOS <= LEN.JSTR DOş    C = JSTR[INDEXPOS,1]ş    IF WOBJ.DEBUG > 0 THEN PRINT "PARSEKEY: ":INDEXPOS,C,SEQ(C),PARSEKEYş    BEGIN CASEş        CASE C = '"'ş            IF NOT(IFDQUOTE) THEN IFDQUOTE=1 ELSE IFDQUOTE=0ş            INDEXPOS+=1ş            IF NOT(IFDQUOTE) THENş                CALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)ş                IF JSTR[INDEXPOS,1] <> ":" THENş                    PSERRORS<-1>="Invalid Key at position ":INDEXPOS:" : ":PARSEKEYş                    EXITş                ENDş            ENDş        CASE C = "'"ş            IF NOT(IFSQUOTE) THEN IFSQUOTE=1 ELSE IFSQUOTE=0ş            INDEXPOS+=1ş            IF NOT(IFSQUOTE) THENş                CALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)ş                IF JSTR[INDEXPOS,1] <> ":" THENş                    PSERRORS<-1>="Invalid Key at position ":INDEXPOS:" : ":PARSEKEYş                    EXITş                ENDş            ENDş        CASE C = ":"ş            INDEXPOS+=1ş            IF NOT(IFDQUOTE) AND NOT(IFSQUOTE) THENş                IF WOBJ.DEBUG THEN PRINT "EXITING"ş                EXITş            ENDş            PARSEKEY:=Cş        CASE 1ş            IF C=LF OR C=CR OR C=TB OR C=" " THENş                NULLş            END ELSEş                PARSEKEY:=Cş            ENDş            INDEXPOS+=1ş    END CASEşREPEATş*şIF WOBJ.DEBUG THEN PRINT "PARSEKEY: ":PARSEKEYşRETURNşEND00021FWOBJ.SKIPCHARş0c2SUBROUTINE WOBJ.SKIPCHAR(JSTR,INDEXPOS)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: skip all whitespaceş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şWS = " ()":TB:CR:LF:@AMşLEN.JSTR=LEN(JSTR)şLOOP WHILE INDEXPOS <= LEN.JSTR DOş    IF INDEX(WS,JSTR[INDEXPOS,1],1) = 0 THEN EXITş    INDEXPOS += 1şREPEATşRETURNşEND000837UDO.Hş0c2******************************************************************************ş*ş*   Header file for UDO BASIC programsş*ş*ş*    Rocket Software Confidentialş*    OCO Source Materialsş*    Copyright Rocket Software, Inc.  2011şş*****************************************************************************ş* UDO Status codes:şEQU	UDO_SUCCESS			TO 			0şEQU	UDO_ERROR			TO			-1şEQU	UDO_INVALIDHANDLE 		TO			-2şş* UDO value types: şEQU	UDO_FALSE			TO			0şEQU	UDO_TRUE			TO			1şEQU	UDO_NULL 			TO			2şEQU	UDO_NUMBER			TO			3şEQU	UDO_STRING			TO			4şEQU	UDO_ARRAY			TO			5şEQU	UDO_OBJECT			TO			6şş* UDO Error codes:şEQU	UDOERROR_OUTOFMEMORY			TO		1şEQU	UDOERROR_INVALIDJSON			TO		2şEQU	UDOERROR_NOTSTANDALONE			TO		3şEQU	UDOERROR_NOTFOUND			TO		4şEQU	UDOERROR_INVALIDNAME			TO		5şEQU	UDOERROR_NOTANOBJECT			TO		6şEQU	UDOERROR_NOTANARRAY			TO		7şEQU	UDOERROR_INVALIDINDEX			TO		8şEQU	UDOERROR_OUTOFBOUND			TO		9şEQU	UDOERROR_INVALIDOPTION			TO		10şEQU	UDOERROR_INVALIDOPTIONVALUE		TO		11şEQU	UDOERROR_OPTIONNOTSET			TO		12şEQU	UDOERROR_INVALIDFORMAT			TO		13şEQU	UDOERROR_INVALIDVALUE			TO		14şEQU	UDOERROR_INVALIDTYPE			TO		15şEQU	UDOERROR_REFERENCECYCLE			TO		16şEQU 	UDOERROR_INVALIDXML			TO		17şEQU 	UDOERROR_DOMAPIFAILURE			TO		18ş	ş* UDO flags:şEQU	UDOFORMAT_JSON				TO		0şEQU	UDOFORMAT_XML				TO		1şş* UDO options:şEQU	UDOOPTION_UDO2XML_XMLSTYLE		TO	0şEQU	UDOOPTION_UDO2XML_NAMESPACE		TO	1şEQU	UDOOPTION_OUTPUTMODE			TO	2şEQU	UDOOPTION_XML2UDO_INFERNUMBER		TO	3	şEQU	UDOOPTION_XML2UDO_INFERBOOLEAN		TO	4	şEQU	UDOOPTION_XML2UDO_INFERNULL	 	TO	5	şEQU	UDOOPTION_XML2UDO_EMPTY2NULL	 	TO	6	şEQU	UDOOPTION_XML2UDO_TRIMWHITESPACE	TO	7	şEQU	UDOOPTION_XML2UDO_CASEINSENSITIVE	TO	8	şEQU	UDOOPTION_XML2UDO_KEEPROOT		TO	9	şEQU 	UDOOPTION_UDO2XML_ROOTNAME		TO	10	şEQU 	UDOOPTION_UDO2XML_NULL2EMPTY		TO	11şEQU 	UDOOPTION_UDO2XML_NAMESPACEPREFIX	TO	12	şş* UDO option values:	şEQU	UDO_XMLSTYLE_ATTR			TO		"ATTRIBUTE"şEQU	UDO_XMLSTYLE_ELEM			TO		"ELEMENT"şEQU	UDO_OUTPUT_COMPACT      		TO		"COMPACT"şEQU 	UDO_OUTPUT_FORMATTED    		TO		"FORMATTED"şEQU	UDO_OPTION_ON				TO		"ON"şEQU	UDO_OPTION_OFF				TO		"OFF"ş00030EWOBJ.PARSENULLş0c2SUBROUTINE WOBJ.PARSENULL(JSTR,INDEXPOS,PARSESTRING)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: parse json null keywordş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şPARSESTRING=""şSAVE.INDEXPOS=INDEXPOSş*şCALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)şIF OCONV(JSTR[INDEXPOS,4],"MCL") = "null" THENş    INDEXPOS+=4ş    CALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)ş    C=JSTR[INDEXPOS,1]ş    IF INDEX(",]}",C,1)=0 THENş        * invalid terminator - not nullş    END ELSEş        PARSESTRING="null"ş        RETURNş    ENDşENDşPARSESTRING=""şINDEXPOS=SAVE.INDEXPOSşRETURNşEND000741WOBJ.ARRAY.TOSTRINGş0c2SUBROUTINE WOBJ.ARRAY.TOSTRING(JSON,POS)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: convert json array to stringş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şJSON:="["; * START OUR STRINGşINDENT.DEPTH+=1ş*IF PRETTIFY THEN JSON:=NLşNUMBER.PARTS=JSONOBJECT(JSONOBJECT$NODELENGTH)<1,POS>şIF WOBJ.DEBUG THEN PRINT "ARRAY.TOSTRING: POS=":POS:" NUMBER.PARTS=":NUMBER.PARTSşFOR P=1 TO NUMBER.PARTSş    PART.TYPE=JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,POS,P>ş    IF WOBJ.DEBUG THEN PRINT "ARRAY.TOSTRING: POS=":POS:" P=":P:" T=":PART.TYPEş    IF PRETTIFY AND P=1 THEN JSON:=NLş    CALL WOBJ.PRETTIFY.INDENT(JSON,POS)ş    BEGIN CASEş        CASE PART.TYPE="S"ş            CALL WOBJ.STRING.TOSTRING(JSON,POS,P)ş        CASE PART.TYPE="B"ş            CALL WOBJ.BOOLEAN.TOSTRING(JSON,POS,P)ş        CASE PART.TYPE="D"ş            CALL WOBJ.NUMBER.TOSTRING(JSON,POS,P)ş        CASE PART.TYPE="N"ş            CALL WOBJ.NULL.TOSTRING(JSON,POS,P)ş        CASE PART.TYPE="O"ş            PART.FLINK=JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,POS,P>ş            IF WOBJ.DEBUG THEN PRINT "OBJ FLINK=":PART.FLINKş            CALL WOBJ.OBJECT.TOSTRING(JSON,PART.FLINK)ş        CASE PART.TYPE="A"ş            PART.FLINK=JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,POS,P>ş            IF WOBJ.DEBUG THEN PRINT "FL=":PART.FLINKş            CALL WOBJ.ARRAY.TOSTRING(JSON,PART.FLINK)ş    END CASEş    IF P <> NUMBER.PARTS THENş        JSON:=", "ş        IF PRETTIFY THEN JSON:=NLş    ENDşNEXT Pş*şIF PRETTIFY AND NUMBER.PARTS THENş    JSON:=NLş    CALL WOBJ.PRETTIFY.INDENT(JSON,POS)şENDşJSON:="]"ş*IF PRETTIFY THEN JSON:=NLşINDENT.DEPTH-=1şRETURNşEND00066CWOBJ.ENCODEş0c2SUBROUTINE WOBJ.ENCODE(IN.STR,OUT.STR)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: encode json stringş*ş**********************************************************************ş***ş* THIS PROGRAM WILL CONVERT ALL BAD CHARACTERS TO AN ESCAPED CHARACTERş***şINCLUDE WOBJ.INCLUDEş*ş*OPEN 'RESULT.FILE' TO RFILE ELSE STOPş* WE NEED TO ENCODEş* " = \"   (34)ş* \ = \\    (92)ş* / = \/ş* CHAR(7) = \bş* CHAR(13) = \rş* char(10) = \nş* char(12) = \fş* char(9)  = \tşOUT.STR=''şL=LEN(IN.STR)şCONVERT @AM TO LF IN IN.STR; * LETS SWITCH 254 TO LF BE DEFAULTşFOR X=1 TO Lş    C=IN.STR[X,1]ş    SEQ.C=SEQ(C)ş    ENCODE=0ş    *IF SEQ.C < 32 THEN ENCODE=1; * BELOW SPACEş    *IF SEQ.C > 32 AND SEQ.C < 48 THEN ENCODE=1; * LETS ENCODE ALL OF THIS !@$%^&*()ş    IF SEQ.C=34 THEN ENCODE=1ş    IF SEQ.C=92 THEN ENCODE=1ş    * IF SEQ.C=47 THEN ENCODE=1ş    *IF SEQ.C > 126 THEN ENCODE = 1; * LETS ENCODE ALL THE HIGH ENTRIESş    *IF SEQ.C >= 91 AND SEQ.C <= 96 THEN ENCODE=1ş    IF ENCODE THENş        BEGIN CASEş            CASE SEQ.C=7; OUT.STR='\b'ş            CASE C='\'; OUT.STR:='\\'ş                *CASE C='/'; OUT.STR:='\/'ş            CASE C='"'; OUT.STR:='\"'ş            CASE SEQ.C=10ş                OUT.STR:='\n'ş                IF PRETTIFYCR THEN OUT.STR:=NLş            CASE SEQ.C=13; OUT.STR:='\r'ş            CASE SEQ.C=12; OUT.STR:='\f'ş            CASE 1; OUT.STR:='\u00':OCONV(C,'MX0C')ş        END CASEş    END ELSEş        OUT.STR=OUT.STR:Cş    ENDşNEXT XşRETURNşEND0003B5WOBJ.PARSEBOOLEANş0c2SUBROUTINE WOBJ.PARSEBOOLEAN(JSTR,INDEXPOS,PARSESTRING)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: parse json boolean valueş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şPARSESTRING=""ş*şCALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)şSAVE.INDEXPOS=INDEXPOSşBEGIN CASEş    CASE OCONV(JSTR[INDEXPOS,4],"MCL") = "true"ş        PARSESTRING="true"ş        INDEXPOS+=4ş    CASE OCONV(JSTR[INDEXPOS,5],"MCL") = "false"ş        PARSESTRING="false"ş        INDEXPOS+=5ş    CASE 1ş        * not booleanş        INDEXPOS=SAVE.INDEXPOSş        RETURNşEND CASEşCALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)şC=JSTR[INDEXPOS,1]şIF INDEX(",]}",C,1)=0 THENş    * invalid terminator - not booleanş    PARSESTRING=""ş    INDEXPOS=SAVE.INDEXPOSşENDşRETURNşEND000873WOBJ.GET.UDOş0c2SUBROUTINE WOBJ.GET.UDO(ACTION,NODE,VALUE,RERR)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: get json element valueş*ş* Modified by: Peter Schellenbach, Zumasysş* Date: January 2018ş* Description: if specified node is an Object or Array, returnş*   a JSON string representation of the node.ş*ş**********************************************************************ş***ş   INCLUDE UDO.Hş      ş   şINCLUDE WOBJ.INCLUDEşCOMMON /WUDO.C/ UDO.OBJECTS(100),UDO.OBJECT.METADATAş*şVALUE=""şşIF 0 THEN; * TODO şIF NODE="" THENş    CALL WOBJ.OBJECT.TOSTRING(VALUE,1) ; * Root objectş    RETURNşENDşENDşş* THIS WILL ACTUALLY RETURN BACK A UDOOBJECT INSTEAD OF A LINK POSITION,  NEED TO DETERMINE HOW TO DO THIS!!!şşCALL WOBJ.FINDNODE.UDO(NODE,NODEPOS,NODETYPE,PARTPOS,JUSTNODE,PARTTYPE,RERR)şşIF WOBJ.DEBUG THEN DEBUGşşIF NODEPOS > 0 AND PARTTYPE # "" THENş    OBJ.TYPE=PARTTYPEş    *OBJ.TYPE=JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,NODEPOS,PARTPOS>ş    BEGIN CASEş        CASE NODETYPE="A"ş            UDOSTATUS=UDOARRAYGETITEM(UDO.OBJECTS(NODEPOS),PARTPOS+1,VALUE,UDOTYPE)ş            * DEBUGş        CASE 1ş            UDOSTATUS=UDOGETPROPERTY(UDO.OBJECTS(NODEPOS),JUSTNODE,VALUE,UDOTYPE)ş            * THIS IS A DUPLICATE CALL, COULD WE STORE THE STRING INFORMATION INSIDE UDO.OBJECTS???ş            * CALL WOBJ.DECODE.PART(NODEPOS,PARTPOS,VALUE)ş            IF WOBJ.DEBUG THEN DEBUGş    END CASEş    GOSUB convert.udoşEND ELSEş    VALUE="" ; * NODE NOT FOUND!şENDşIF WOBJ.DEBUG THEN PRINT "WOBJ.GET: ":NODE:" NODEPOS=":NODEPOS:" PARTPOS=":PARTPOS:" VALUE=":OBJ.TYPEşRETURNşşconvert.udo: *şBEGIN CASEş        CASE OBJ.TYPE="T"ş            VALUE="true"ş        CASE OBJ.TYPE="F"ş            VALUE="false"ş        CASE OBJ.TYPE="NULL"ş            VALUE="null"ş            RERR<3>='null'ş      CASE OBJ.TYPE='O' OR OBJ.TYPE='A'ş            STATUS=UDOWRITE(VALUE,UDOFORMAT_JSON,TMP.VALUE)ş            UDOSTATUS=UDOFREE(VALUE); * DESTROY THAT VARIABLEş            VALUE=TMP.VALUEşEND CASEşRETURNşşEND001292WOBJ.FINDNODEş0c2SUBROUTINE WOBJ.FINDNODE(INNODE,NODEPOS,PARTPOS,CHILDPOS,LASTNODE,RERR)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: find a json node in parsed object structureş*ş**********************************************************************ş*şşINCLUDE WOBJ.INCLUDEş*ş* NEED TO BREAK OUR NODE REQUEST UP INTO IT'S SEPERATE PARTSş*şRERR=""şLASTNODE=""ş*şOBJECT.SEPERATOR = "."şNODES=INNODEşCONVERT OBJECT.SEPERATOR TO @AM IN NODESş*şNODEPOS=1; * WE ALWAYS START WITH THE FIRST ONE.şPARTPOS=0; * START AS ZERO 6/19/2017 - PAPşCHILDPOS=0;* SET WHEN OUR NODE IS AN OBJECT OR ARRAYşPARTTYPE=""ş*şNUMBER.NODES=DCOUNT(NODES,@AM)şIF INDEX(NODES,"[",1) THENş* We need to trick this into seeing an array as another node levelş    ORIG.NODES=NODESş    NODES=""ş    FOR A=1 TO NUMBER.NODESş        NODE=ORIG.NODES<A>ş        IF INDEX(NODE,"[",1) THENş            NUMBER.ARRAYS = COUNT(NODE,"[")ş            ACTUAL.NODE=FIELD(NODE,"[",1)ş            NODES<-1>=ACTUAL.NODEş            FOR B=1 TO NUMBER.ARRAYSş                K=INDEX(NODE,"]",B)ş                NODES<-1>=NODE[1,K]ş            NEXT Bş        END ELSEş            NODES<-1>=NODEş        ENDş    NEXT AşENDşNUMBER.NODES=DCOUNT(NODES,@AM)şIF WOBJ.DEBUG THEN PRINT "WOBJ.FINDNODE: number of parts in ":INNODE:": ":NUMBER.NODESşFOR A=1 TO NUMBER.NODESş    NODE=NODES<A>ş    LASTNODE=NODEş    NODETYPE=JSONOBJECT(JSONOBJECT$NODETYPE)<1,NODEPOS>ş    IF WOBJ.DEBUG THEN PRINT "  part ":A:" key=":NODE:" pos=":NODEPOS:" type=":NODETYPEş    BEGIN CASEş        CASE NODETYPE="O"ş            JUSTNODE=FIELD(NODE,"[",1)ş            IF WOBJ.DEBUG THENş                PRINT "    locating ":JUSTNODEş                PRINT "          in ":JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)<1,NODEPOS>ş                NUM.SUBS=DCOUNT(JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)<1,NODEPOS>,CHAR(252))ş                PRINT 'NUM.SUBS=':NUM.SUBSş            ENDş            LOCATE JUSTNODE IN JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)<1,NODEPOS> SETTING PARTPOS ELSE PARTPOS=0ş            IF NOT(PARTPOS) THENş                TEMP.NODE=JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)<1,NODEPOS>ş                LOCATE JUSTNODE IN TEMP.NODE<1,1> SETTING PARTPOS ELSE PARTPOS=0ş                IF WOBJ.DEBUG THENş                    PRINT 'TEMP.NODE=':TEMP.NODEş                    PRINT 'JUSTNODE=':JUSTNODEş                    PRINT 'PARTPOS=':PARTPOSş                ENDş            ENDş        CASE NODETYPE="A"ş            NUMBER.ARRAYS=COUNT(NODE,"[")ş            ST=INDEX(NODE,"[",NUMBER.ARRAYS)ş            EN=INDEX(NODE,"]",NUMBER.ARRAYS)ş            IF ST>1 AND EN>ST THENş                PARTPOS=NODE[ST+1,EN-ST-1]ş            END ELSEş                PARTPOS=''ş            ENDş            IF NOT((PARTPOS MATCHES '1N0N') OR (PARTPOS = '-1')) THENş                RERR=2ş                RERR<2>="Numeric subscript required for array element"ş                IF WOBJ.DEBUG THEN PRINT "WOBJ.FINDNODE: ":RERR<2>ş                RETURNş            ENDş            IF PARTPOS<0 THEN PARTPOS=JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS> ;* ALLOW -1, SINCE WOBJ.SET USES THAT TO CREATE NEXT ELEMENTş            PARTPOS += 1ş            IF PARTPOS > JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS> THENş                IF WOBJ.DEBUG THEN PRINT "WOBJ.FINDNODE: PARTPOS=":PARTPOS:" LEN=":JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS>:" NODEPOS=":NODEPOSş                PARTPOS=0ş            ENDş    END CASEş    IF NOT(PARTPOS) THENş        RERR=1ş        RERR<2>="Node ":NODE:" not found at level ":NODEPOSş        IF WOBJ.DEBUG THEN PRINT "WOBJ.FINDNODE: ":RERR<2>ş        RETURNş    ENDş    PARTTYPE=JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,NODEPOS,PARTPOS>ş    IF (PARTTYPE="A" OR PARTTYPE="O") THENş        IF A=NUMBER.NODES THENş* RETURN CHILD OBJECT NODE POSITIONş            CHILDPOS=JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,NODEPOS,PARTPOS>ş        END ELSEş* FOLLOW FORWARD LINK TO CHILD NODEş            NODEPOS=JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,NODEPOS,PARTPOS>ş            NODEPOS +=0; * WEIRD FIX NEEDED WHEN D3 IS FLASHCOMPILED.  Not always treating this as a numeric?ş        ENDş    END ELSEş        IF A<>NUMBER.NODES THENş            RERR=1ş            RERR<2>="Node ":NODE:" not found at level ":NODEPOSş            IF WOBJ.DEBUG THENş                PRINT "WOBJ.FINDNODE: ":RERR<2>ş                PRINT "    Node type ":PARTTYPE:" cannot have properties or array elements"ş            ENDş            RETURNş        ENDş    ENDşNEXT AşIF WOBJ.DEBUG THEN PRINT "WOBJ.FINDNODE: nodepos=":NODEPOS:" partpos=":PARTPOS:" type=":PARTTYPE:" childpos=":CHILDPOSşRETURNşEND001976WOBJ.SETş0c2SUBROUTINE WOBJ.SET(ACTION,NODE,VALUE,RERR)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: set json node to valueş*ş* Modified by: Peter Schellenbach, Zumasysş* Date: January 2018ş* Description: allow Object and Array properties to be set, passingş*   a JSON string representation of the node.ş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şIF WOBJ.DEBUG THEN PRINT "WOBJ.SET: NODE=":NODE:" ACTION=":ACTIONş*şSACTION=FIELD(ACTION,".",2)şIF NODE="" THENş    IF SACTION <> "OBJECT" THEN    ş        RERR=1ş        RERR<2>="Node cannot be null"ş    END ELSEş        CALL WOBJ.PARSE(VALUE,NEWOBJ)ş        DEBUGş        IF PSERRORS#"" THENş            RERR=2ş            RERR<2> = PSERRORSş            IF WOBJ.DEBUG THEN PRINT "WOBJ.SET.OBJECT: parse failure: ":RERR<2>ş        ENDş    END        ş    RETURNşENDş*şCALL WOBJ.FINDNODE(NODE,NODEPOS,PARTPOS,CHILDPOS,LASTNODE,RERR)şIF WOBJ.DEBUG THEN PRINT "WOBJ.SET: NODEPOS=":NODEPOS:" PARTPOS=":PARTPOS:" CHILDPOS=":CHILDPOS:" LASTNODE=":LASTNODE:" RERROR=":RERR<2>ş*şIF NOT(NODEPOS) THENş    RERR=1ş    RERR<2>="Node not found"ş    RETURNşENDş*ş* CHECK THE NODE WE ARE SETTING PROPERTY TOşNODETYPE=JSONOBJECT(JSONOBJECT$NODETYPE)<1,NODEPOS>şIF NODETYPE#"O" AND NODETYPE#"A" THENş    RERR=1ş    RERR<2>="Parent node must be an object or array"ş    RETURNşENDş*şIGNORE.RERR=""şIF NODETYPE="O" THEN PARTKEY=LASTNODE ELSE PARTKEY=""ş*şIF NOT(PARTPOS) THENş* ENSURE PARENT NODE EXISTSş    NUM.PARTS=DCOUNT(NODE,".")ş    FINAL.NODE=FIELD(NODE,".",NUM.PARTS)ş    IF INDEX(FINAL.NODE,"[",1) THENş        NUMBER.ARRAYS=COUNT(FINAL.NODE,"[")ş        PARENT.NODE=NODE[1,LEN(NODE)-LEN(FINAL.NODE)+INDEX(FINAL.NODE,"[",NUMBER.ARRAYS)-1]ş    END ELSEş        NUMBER.ARRAYS=0ş        PARENT.NODE=NODE[1,LEN(NODE)-LEN(FINAL.NODE)-1]ş    ENDş    IF NUM.PARTS > 1 OR NUMBER.ARRAYS > 0 THENş        CALL WOBJ.FINDNODE(PARENT.NODE,PARENT.NODEPOS,PARENT.PARTPOS,PARENT.CHILDPOS,PARENT.LASTNODE,"")ş        IF NOT(PARENT.PARTPOS) THENş            RERR=1ş            RERR<2>="Parent node not found"ş            IF WOBJ.DEBUG THEN PRINT "WOBJ.SET: ":RERR<2>ş            RETURNş        ENDş    ENDş*ş* WE NEED TO ADD A NEW ELEMENTş    IF NODETYPE="O" THENş        PARTPOS=JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS>ş        PARTPOS += 1ş        JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS>=PARTPOSş        CALL WOBJ.SET.PART(NODEPOS,PARTPOS,"N",PARTKEY,"",IGNORE.RERR) ; * DUMMY NULL ELEMENT WILL BE REPLACED IN FINAL WOBJ.SET.PART CALLş    END ELSEş        NUMBER.ARRAYS=COUNT(LASTNODE,"[")ş        ST=INDEX(LASTNODE,"[",NUMBER.ARRAYS)ş        EN=INDEX(LASTNODE,"]",NUMBER.ARRAYS)ş        IF ST>1 AND EN>ST THENş            PARTPOS=LASTNODE[ST+1,EN-ST-1]ş        END ELSEş            PARTPOS=''ş        ENDş        IF NOT((PARTPOS MATCHES '1N0N') OR (PARTPOS = '-1')) THENş            RERR=2ş            RERR<2>="Numeric subscript required for setting array element"ş            IF WOBJ.DEBUG THEN PRINT "WOBJ.SET: ":RERR<2>ş            RETURNş        ENDş        IF PARTPOS<0 THENş            PARTPOS=JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS>+1ş        END ELSEş            PARTPOS += 1 ; * ZERO-BASED ARRAY INDEX -> 1 BASED PARTPOSş        ENDş        LASTPARTPOS=JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS>+1ş        FOR P=LASTPARTPOS TO PARTPOSş            CALL WOBJ.SET.PART(NODEPOS,P,"N",PARTKEY,"",IGNORE.RERR)ş        NEXT Pş        IF PARTPOS>JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS> THENş            JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS>=PARTPOSş        ENDş    ENDşENDş*şPARTTYPE=JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,NODEPOS,PARTPOS>şIF WOBJ.DEBUG THEN PRINT "WOBJ.SET: PARTTYPE=":PARTTYPEş*şIF PARTTYPE="O" OR PARTTYPE="A" THENş*ş* DELETE NESTED NODE BEFORE SETTING NEW VALUEş    IF NODETYPE="A" THENş*ş* ARRAYS ARE SPECIAL, BECAUSE WE DO NOT WANT TO DELETE THE ARRAY POSITIONş* THAT WE ARE SETTING, WHICH WILL SLIDE THE ARRAY DOWN BY ONE. INSTEAD,ş* INSERT A NULL ELEMENT AFTER THE ONE WE NEED TO DELETE, THEN AFTERş* DELETING, WE CAN SIMPLY REPLACE THE NULL NODE.ş*ş        JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)=INSERT(JSONOBJECT(JSONOBJECT$NODEPARTS.KEY),1,NODEPOS,PARTPOS+1,"")ş        JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)=INSERT(JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE),1,NODEPOS,PARTPOS+1,"N")ş        JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)=INSERT(JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK),1,NODEPOS,PARTPOS+1,"")ş        JSONOBJECT(JSONOBJECT$NODEPARTS.BLINK)=INSERT(JSONOBJECT(JSONOBJECT$NODEPARTS.BLINK),1,NODEPOS,PARTPOS+1,"")ş        JSONOBJECT(JSONOBJECT$NODEPARTS.ENCODING)=INSERT(JSONOBJECT(JSONOBJECT$NODEPARTS.ENCODING),1,NODEPOS,PARTPOS+1,"")ş        JSONOBJECT(JSONOBJECT$NODEPARTS.VALUE)=INSERT(JSONOBJECT(JSONOBJECT$NODEPARTS.VALUE),1,NODEPOS,PARTPOS+1,"")ş        JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS> += 1ş    ENDş*ş    CALL WOBJ.DELETE("DELETE",NODE,"",IGNORE.RERR)ş* BECAUSE DELETING MAY ALTER JSONOBJECT STRUCTURE, REFRESH NODEPOS & PARTPOSş    CALL WOBJ.FINDNODE(NODE,NODEPOS,PARTPOS,CHILDPOS,LASTNODE,IGNORE.RERR)ş    IF NODETYPE="O" THENş        IF PARTPOS=0 THENş            PARTPOS=JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS>ş            PARTPOS += 1ş            JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS>=PARTPOSş            CALL WOBJ.SET.PART(NODEPOS,PARTPOS,"N",PARTKEY,"",IGNORE.RERR)ş        END ELSEş            RERR=2ş            RERR<2>="While setting node ":NODE:", existing object was deleted, yet it is still here!"ş            IF WOBJ.DEBUG THEN PRINT "WOBJ.SET: ":RERR<2>ş            RETURNş        ENDş    END ELSEş        IF PARTPOS=0 THENş            RERR=2ş            RERR<2>="While setting node ":NODE:", existing array element was deleted, but dummy element is missing!"ş            IF WOBJ.DEBUG THEN PRINT "WOBJ.SET: ":RERR<2>ş            RETURNş        ENDş    ENDşENDş*ş* NOW WE ARE SAFE TO SET NEW VALUEşBEGIN CASEş    CASE SACTION="ARRAY" OR SACTION="OBJECT"ş        PARTTYPE=SACTION[1,1]ş    CASE SACTION="NULL"ş        PARTTYPE="N"ş    CASE SACTION="NUMBER"ş        PARTTYPE="D"ş    CASE SACTION="BOOLEAN"ş        PARTTYPE="B"ş    CASE SACTION="STRING" OR SACTION=""ş        PARTTYPE="S"ş    CASE 1ş        RERR=1ş        RERR<2>="Unknown value type ":SACTION:", assume STRING"ş        PARTTYPE="S"şEND CASEşCALL WOBJ.SET.PART(NODEPOS,PARTPOS,PARTTYPE,PARTKEY,VALUE,RERR)şRETURNşEND001A97WOBJ.FINDNODE.UDOş0c2      SUBROUTINE WOBJ.FINDNODE.UDO(INNODE,NODEPOS,NODETYPE,PARTPOS,JUSTNODE,PARTTYPE,RERR)ş      **********************************************************************ş      *ş      * Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş      *ş      * Written by: Patrick Payne, Zumasysş      * Date: December 2017ş      * Description: find a json node in parsed object structureş      *ş      **********************************************************************ş      ***ş      INCLUDE WOBJ.INCLUDEş      ş      * FIRST LETS INIT OUR TEMPORARY STORAGE AREA FOR UDO OBJECTSş      ş      COMMON /WUDO.C/ UDO.OBJECTS(100),UDO.OBJECT.METADATAş      ş      *MAT UDO.OBJECTS=""ş      *UDO.OBJECT.METADATA=""ş      ş      *ş      * NEED TO BREAK OUR NODE REQUEST UP INTO IT'S SEPERATE PARTSş      *ş      RERR=""ş      LASTNODE=""ş      *ş      OBJECT.SEPERATOR = "."ş      NODES=INNODEş      CONVERT OBJECT.SEPERATOR TO @AM IN NODESş      *ş      NODEPOS=1; * WE ALWAYS START WITH THE FIRST ONE.ş      PARTPOS=0; * START AS ZERO 6/19/2017 - PAPş      CHILDPOS=0;* SET WHEN OUR NODE IS AN OBJECT OR ARRAYş      PARTTYPE=""ş      *ş      NUMBER.NODES=DCOUNT(NODES,@AM)ş      IF INDEX(NODES,"[",1) AND 1 THENş         * We need to trick this into seeing an array as another node levelş         ORIG.NODES=NODESş         NODES=""ş         FOR A=1 TO NUMBER.NODESş            NODE=ORIG.NODES<A>ş            IF INDEX(NODE,"[",1) THENş               NUMBER.ARRAYS = COUNT(NODE,"[")ş               ACTUAL.NODE=FIELD(NODE,"[",1)ş               NODES<-1>=ACTUAL.NODEş               FOR B=1 TO NUMBER.ARRAYSş                  K=INDEX(NODE,"]",B)ş                  NODES<-1>=NODE[1,K]ş               NEXT Bş            END ELSEş               NODES<-1>=NODEş            ENDş         NEXT Aş      ENDş      NUMBER.NODES=DCOUNT(NODES,@AM)ş      IF WOBJ.DEBUG THEN PRINT "WOBJ.FINDNODE.UDO: number of parts in ":INNODE:": ":NUMBER.NODESş      FOR A=1 TO NUMBER.NODESş         NODE=NODES<A>ş         LASTNODE=NODEş         JUSTNODE=FIELD(NODE,"[",1)ş         *NODETYPE=JSONOBJECT(JSONOBJECT$NODETYPE)<1,NODEPOS>şş         UDOSTATUS=UDOGETTYPE(UDO.OBJECTS(A), UDOTYPE)ş         GOSUB convert.udotypeş         NODETYPE=UDOTYPEş         UDO.OBJECT.METADATA<A,2>=NODETYPEş         UDO.OBJECT.METADATA<A,3>=JUSTNODEşş         IF WOBJ.DEBUG THEN PRINT "  part ":A:" key=":NODE:" pos=":NODEPOS:" type=":NODETYPEş         ş         BEGIN CASEş            CASE NODETYPE="O"ş               JUSTNODE=FIELD(NODE,"[",1)ş               IF WOBJ.DEBUG THENş                  PRINT "    locating ":JUSTNODEş                  PRINT "          in ":JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)<1,NODEPOS>ş               ENDş               UDOSTATUS=UDOGETPROPERTY(UDO.OBJECTS(A),JUSTNODE,TMPOBJECT,UDOTYPE)ş               *UDOSTATUS=UDOGETTYPE(UDO.OBJECTS(A), UDOTYPE)ş               GOSUB convert.udotypeş               * NEED TO SET PARTPOS AND PARTTYPEş               PARTTYPE = UDOTYPEş               IF UDOSTATUS < 0 THEN ş                  PARTPOS=0ş                  TMPOBJECT=""ş               END ELSEş                  PARTPOS=1ş               ENDş               UDO.OBJECTS(A+1)=TMPOBJECTş        IF WOBJ.DEBUG THEN PRINT "udostatus=":UDOSTATUS:" A=":A:" TMPOBJECT=":A; INPUT WAITş               NODEPOS=Aş               IF WOBJ.DEBUG THEN DEBUGş            CASE NODETYPE="A"ş               NUMBER.ARRAYS=COUNT(NODE,"[")ş               ST=INDEX(NODE,"[",NUMBER.ARRAYS)ş               EN=INDEX(NODE,"]",NUMBER.ARRAYS)ş               IF ST>1 AND EN>ST THENş                  PARTPOS=NODE[ST+1,EN-ST-1]ş               END ELSEş                  PARTPOS=''ş               ENDş         ş               IF NOT((PARTPOS MATCHES '1N0N') OR (PARTPOS = '-1')) THENş                  RERR=2ş                  RERR<2>="Numeric subscript required for array element"ş                  IF WOBJ.DEBUG THEN PRINT "WOBJ.FINDNODE: ":RERR<2>ş                  RETURNş               ENDş               *IF WOBJ.DEBUG THEN DEBUGş               *IF PARTPOS<0 THEN PARTPOS=JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS> ;* ALLOW -1, SINCE WOBJ.SET USES THAT TO CREATE NEXT ELEMENTş               *PARTPOS += 1ş               *IF PARTPOS > JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS> THENş               *   IF WOBJ.DEBUG THEN PRINT "WOBJ.FINDNODE.UDO: PARTPOS=":PARTPOS:" LEN=":JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS>:" NODEPOS=":NODEPOSş               *   PARTPOS=0ş               *ENDş               NODEPOS=Aş               IF WOBJ.DEBUG THEN PRINT "WOBJ.FINDNODE.UDO NODEPOS=":NODEPOS:" PARTPOS=":PARTPOSş               PARTTYPE=""ş               IF PARTPOS # "" THENş                  UDOSTATUS=UDOARRAYGETITEM(UDO.OBJECTS(A),PARTPOS+1,TMPOBJECT,UDOTYPE)ş                  GOSUB convert.udotypeş                  PARTTYPE=UDOTYPEş                  UDO.OBJECTS(A+1)=TMPOBJECTş                  UDO.OBJECT.METADATA<A+1,2>=PARTTYPEş                  UDO.OBJECT.METADATA<A+1,3>=JUSTNODEş                  UDO.OBJECT.METADATA<A+1,4>=PARTPOSş               ENDş               *IF WOBJ.DEBUG THEN DEBUGş         END CASEş         IF 1 THENş            IF UDOSTATUS < 0 THENş               RERR=1ş               RERR<2>="Node ":NODE:" not found at level ":NODEPOSş               IF WOBJ.DEBUG THEN PRINT "WOBJ.FINDNODE: ":RERR<2>ş               RETURNş            ENDş            *PARTTYPE=JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,NODEPOS,PARTPOS>ş            IF 1 THENş            IF (PARTTYPE="A" OR PARTTYPE="O") THENş               IF A=NUMBER.NODES THENş                  * RETURN CHILD OBJECT NODE POSITIONş                  *CHILDPOS=JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,NODEPOS,PARTPOS>ş               END ELSEş                  * FOLLOW FORWARD LINK TO CHILD NODEş                  *NODEPOS=JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,NODEPOS,PARTPOS>ş                  *NODEPOS+=1;**** NEED TO FIGURE OUTş               ENDş            END ELSEş               IF A<>NUMBER.NODES THENş                  RERR=1ş                  RERR<2>="Node ":NODE:" not found at level ":NODEPOSş                  IF WOBJ.DEBUG THENş                     PRINT "WOBJ.FINDNODE: ":RERR<2>ş                     PRINT "    Node type ":PARTTYPE:" cannot have properties or array elements"ş                  ENDş                  RETURNş               ENDş            ENDş            ENDş         ENDş      NEXT Aş      IF WOBJ.DEBUG THEN PRINT "WOBJ.FINDNODE: nodepos=":NODEPOS:" partpos=":PARTPOS:" type=":PARTTYPE:" childpos=":CHILDPOSş      RETURNşşconvert.udotype: *şşBEGIN CASEş   CASE UDOTYPE="0"; UDOTYPE="F"ş   CASE UDOTYPE="1"; UDOTYPE="T"ş   CASE UDOTYPE="2"; UDOTYPE="NULL"ş   CASE UDOTYPE="3"; UDOTYPE="N"ş   CASE UDOTYPE="4"; UDOTYPE="S"ş   CASE UDOTYPE="5"; UDOTYPE="A"ş   CASE UDOTYPE="6"; UDOTYPE="O"ş   CASE 1; UDOTYPE=""şEND CASEşşRETURN000E1FWOBJ.SET.PARTş0c2SUBROUTINE WOBJ.SET.PART(NODEPOS,PARTPOS,PARTTYPE,PARTKEY,VALUE,RERR)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: set json part valueş*ş* Modified by: Peter Schellenbach, Zumasysş* Date: January 2018ş* Description: allow Object and Array properties to be set, passingş*   a JSON string representation of the node.ş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şENCODING=""şFLINK=""ş* VALIDATE THE VALUE DATAşBEGIN CASEş    CASE PARTTYPE="O" OR PARTTYPE="A"ş        OUT.VALUE=""ş    CASE PARTTYPE="N"ş        OUT.VALUE=""ş        IF VALUE#"" THENş            RERR=1ş            RERR<2>="Value ignored for NULL property"ş        ENDş    CASE PARTTYPE="D"ş        OUT.VALUE=VALUEş        IF VALUE="" THENş            OUT.VALUE=0ş        END ELSEş            IF NOT(NUM(VALUE)) THENş                RERR=1ş                RERR<2>="Non-numeric value for NUMBER property; zero used"ş                OUT.VALUE=0ş            ENDş        ENDş    CASE PARTTYPE="B"ş        OUT.VALUE=OCONV(VALUE,"MCL")ş        IF OUT.VALUE#"true" AND OUT.VALUE#"false" THENş            RERR=1ş            RERR<2>="Invalid boolean value: must be true or false; false used"ş            OUT.VALUE="false"ş        END        ş    CASE 1ş        ENCODING="H"ş        BEGIN CASEş            CASE INDEX(VALUE,@AM,1)ş            CASE INDEX(VALUE,@VM,1)ş            CASE INDEX(VALUE,@SVM,1)ş            CASE INDEX(VALUE,LF,1)ş            CASE INDEX(VALUE,CR,1)ş            CASE 1ş                ENCODING="A"ş                OUT.VALUE=VALUEş        END CASEş        IF ENCODING="H" THEN OUT.VALUE=OCONV(VALUE,"MX0C")şEND CASEş*şIF PARTTYPE="O" OR PARTTYPE="A" THENş* SET UP THE NEW OBJECTş    FLINK=JSONOBJECT(JSONOBJECT$NODECNTR)+1ş    IF VALUE="" THENş        JSONOBJECT(JSONOBJECT$NODECNTR)=FLINK ; * UPDATE NODE COUNT FOR NULL OBJECTş    END ELSEş* PARSE OBJECT OR ARRAY        ş        MATBUILD SAVEJSONOBJECT FROM JSONOBJECT ; * SAVE CURRENT OBJECT IN CASE OF PARSE FAILUREş        INDEXPOS=1ş        IF PARTTYPE="O" THENş            CALL WOBJ.PARSEOBJECT(VALUE,INDEXPOS,PARSERESULT)ş        END ELSEş            CALL WOBJ.PARSEARRAY(VALUE,INDEXPOS,PARSERESULT)ş        ENDş        IF PARSERESULT="" THENş            RERR=2ş            IF PARTTYPE="O" THENş                RERR<2>="Object parse failure"ş            END ELSEş                RERR<2>="Array parse failure"ş            ENDş        END ELSEş* MAKE SURE WE CONSUMED ENTIRE JSTRş            CALL WOBJ.SKIPCHAR(VALUE,INDEXPOS)ş            IF INDEXPOS <= LEN(VALUE) THENş                RERR=2ş                RERR<2>="Extra data (":(LEN(VALUE)-INDEXPOS+1):" characters) after final close brace ignored"ş            END            ş        ENDş        IF RERR<1> >= 2 THENş* OBJECT OR ARRAY PARSE ERRORş            MATPARSE JSONOBJECT FROM SAVEJSONOBJECTş            PARTTYPE="N"ş            FLINK=""ş        ENDş    ENDşENDş* SET THE PART PROPERTIESşJSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,NODEPOS,PARTPOS>        =    PARTTYPEşJSONOBJECT(JSONOBJECT$NODEPARTS.KEY)<1,NODEPOS,PARTPOS>         =    PARTKEYşJSONOBJECT(JSONOBJECT$NODEPARTS.VALUE)<1,NODEPOS,PARTPOS>       =    OUT.VALUEşJSONOBJECT(JSONOBJECT$NODEPARTS.ENCODING)<1,NODEPOS,PARTPOS>    =    ENCODINGşJSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,NODEPOS,PARTPOS>       =    FLINKşIF WOBJ.DEBUG THEN PRINT "WOBJ.SET.PART: T=":PARTTYPE:" K=":PARTKEY:" E=":ENCODING:" OUT.VALUE=":OUT.VALUEş*şRETURNşEND001BCCWOBJ.UDOş0c2      SUBROUTINE WOBJ.UV(PASSEDOBJ,ACTION,NODE,VALUE,OPTIONS,RERR)ş      **********************************************************************ş      *ş      * Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş      *ş      * Written by: Patrick Payne, Zumasysş      * Date: December 2017ş      * Description: WOBJ json library main routineş      *ş      * Updated: 3/3/2019 by Peter Schellenbach, Zumasysş      *ş      **********************************************************************ş      *ş      INCLUDE UDO.Hş      ş      INCLUDE WOBJ.INCLUDEş      ş      COMMON /WOBJD/ COMMON.WOBJ.DEBUGş      ş      IF UNASSIGNED(COMMON.WOBJ.DEBUG) THEN COMMON.WOBJ.DEBUG=0ş      ş      * This common is a storage area to store udo objects as weş      * traverse into a multi-level objectş      ş      COMMON /WUDO.C/ UDO.OBJECTS(100),UDO.OBJECTS.METADATAş      ş      MAT UDO.OBJECTS=""ş      UDO.OBJECTS.METADATA=""ş      *ş      IF INDEX(OPTIONS,"PRETTIFY",1) THEN PRETTIFY=1 ELSE PRETTIFY=0ş      IF INDEX(OPTIONS,"PRETTIFYCR",1) THEN PRETTIFYCR=1 ELSE PRETTIFYCR=0ş      IF INDEX(OPTIONS,"DEBUG",1) THEN WOBJ.DEBUG=1 ELSE WOBJ.DEBUG=0ş      *ş      IF COMMON.WOBJ.DEBUG THEN WOBJ.DEBUG=1ş    IF WOBJ.DEBUG THENş       OPEN "RESULT.FILE" TO RFILE ELSE STOPş       DREC=ACTIONş       DREC<2>=NODEş       WRITE DREC ON RFILE, 'OBJ.DEBUG'ş    ENDş*PRINT 'WOBJ.DEBUG=':WOBJ.DEBUG:'  ':COMMON.WOBJ.DEBUGş      ş      PLATFORM='UV'şş      WOBJ.VERSION='2.0.UDO'ş         *ş      MAT JSONOBJECT = ""ş      RERR=""ş      INDENT.DEPTH=0ş      *ş      BEGIN CASEş         CASE ACTION="FROMSTRING"ş            * THIS EXISTS EARLIER DUE TO MATPARSE BELOWş            * UDO WILL FLOW UP IF YOU SEND ANY @AM IN THE DATAş            CONVERT CHAR(254) TO '' IN VALUEş            UDOSTATUS=UDOREAD(VALUE, 0, PASSEDOBJ)ş            IF UDOSTATUS # UDO_SUCCESS  "" THENş               RERR=2ş               RERR<2> = UDOSTATUSş            ENDş            IF WOBJ.DEBUG THEN PRINT "WOBJ: FROMSTRING ACTION: VALUE=":VALUE:" RERR=":RERR<2>ş            RETURNş         CASE ACTION="VERSION"ş            VALUE=WOBJ.VERSIONş            RETURNş      END CASEş      *ş      *MATPARSE JSONOBJECT FROM PASSEDOBJş      *ş      UDO.OBJECTS(1)=PASSEDOBJş      UDO.OBJECTS.METADATA<1>="MAIN"ş      IF WOBJ.DEBUG THEN PRINT "ACTION=":ACTION,NODEş      BEGIN CASEş         CASE ACTION="TOSTRING"ş            VALUE=""ş            IF NODE # "" THENş               RERR=1ş               RERR<2>="Node ignored - returning the root node"ş               IF WOBJ.DEBUG THEN PRINT "WOBJ: TOSTRING ACTION: NODE ":NODE:" IGNORED"ş            ENDş            STATUS=UDOWRITE(PASSEDOBJ,UDOFORMAT_JSON,VALUE)ş         CASE ACTION="GET"ş            GOSUB action.getş         CASE FIELD(ACTION,".",1)="SET"ş            GOSUB action.setş         CASE ACTION="DELETE"ş            GOSUB action.deleteş         CASE ACTION="KEYS"ş            GOSUB action.keysş         CASE ACTION="LENGTH" OR ACTION="SIZE"ş            GOSUB action.lengthş         CASE ACTION="TYPE"ş            GOSUB action.typeş         CASE ACTION="DESTROY"ş            GOSUB action.destroyş         CASE 1ş            VALUE=""ş            RERR=1ş            RERR<2>="Invalid action '":ACTION:"'"ş            IF WOBJ.DEBUG THEN PRINT "WOBJ: INVALID ACTION: ":ACTIONş      END CASEş      *ş      *NUM.ENTRIES=DCOUNT(UDO.OBJECTS.METADATA,@VM)ş      *FOR V=1 TO NUM.ENTRIESş      *   UDOSTATUS=UDOFREE(UDO.OBJECTS(V))ş      *   IF WOBJ.DEBUG THEN PRINT V,UDOSTATUSş      *NEXT Vş      ş      MAT UDO.OBJECTS=""ş      UDO.OBJECTS.METADATA=""ş      ş      ş      ş      *MATBUILD PASSEDOBJ FROM JSONOBJECTş      *ş      RETURNş      *şaction.get: *ş      CALL WOBJ.GET.UDO(ACTION,NODE,VALUE,RERR)ş      RETURNş      *şaction.set: *ş      CALL WOBJ.SET.UDO(ACTION,NODE,VALUE,RERR)ş      RETURNş      *şaction.delete: *ş      CALL WOBJ.FINDNODE.UDO(NODE,NODEPOS,NODETYPE,PARTPOS,JUSTNODE,PARTTYPE,RERR)ş      UDOSTATUS=""ş      VALUE=""ş      BEGIN CASEş         CASE NODETYPE='A'ş         CASE NODETYPE='O'ş            UDOSTATUS=UDODELETEPROPERTY(UDO.OBJECTS(NODEPOS), JUSTNODE)ş      END CASEş      IF WOBJ.DEBUG THEN PRINT "WOBJ: DELETE ACTION: ":NODE:" NODEPOS=":NODEPOS:" ":NODETYPE:" PARTTYPE=":PARTTYPE:" PARTPOS=":PARTPOS:" UDOSTATUS=":UDOSTATUS:" RERR=":RERR<2>ş      ş *     CALL WOBJ.DELETE(ACTION,NODE,VALUE,RERR)ş      RETURNş      *şaction.keys: *ş      CALL WOBJ.FINDNODE.UDO(NODE,NODEPOS,NODETYPE,PARTPOS,JUSTNODE,PARTTYPE,RERR)ş      UDOSTATUS=""ş      VALUE=""ş      BEGIN CASEş         CASE PARTTYPE='O'ş            UDOSTATUS=UDOGETPROPERTYNAMES(UDO.OBJECTS(NODEPOS+1),PROPNAMES)ş            IF UDOSTATUS >=0 THENş               UDOSTATUS2=UDOARRAYGETSIZE(PROPNAMES,NUM.PROPERTIES)ş               FOR S=1 TO NUM.PROPERTIESş                  UDOSTATUS3=UDOARRAYGETITEM(PROPNAMES,S,PROP.NAME,TEMP.UDO.TYPE)ş                  VALUE<1,1,-1>=PROP.NAMEş               NEXT Sş               UDOSTATUS=UDOFREE(PROPNAMES)ş            ENDş         CASE 1ş            VALUE=1ş      END CASEş  ş      IF WOBJ.DEBUG THEN PRINT "WOBJ: LENGTH ACTION: ":NODE:" NODEPOS=":NODEPOS:" ":NODETYPE:" PARTTYPE=":PARTTYPE:" PARTPOS=":PARTPOS:" UDOSTATUS=":UDOSTATUS:" LENGTH=":VALUE:" RERR=":RERR<2>ş      RETURNşş      *şaction.length: *ş      CALL WOBJ.FINDNODE.UDO(NODE,NODEPOS,NODETYPE,PARTPOS,JUSTNODE,PARTTYPE,RERR)ş      UDOSTATUS=""ş      VALUE=1ş      BEGIN CASEş         CASE PARTTYPE="A"ş            UDOSTATUS=UDOARRAYGETSIZE(UDO.OBJECTS(NODEPOS+1),VALUE); * WE ADD ONE TO GET TO THE ACTUAL ARRAYş         CASE PARTTYPE='O'ş            UDOSTATUS=UDOGETPROPERTYNAMES(UDO.OBJECTS(NODEPOS+1),PROPNAMES)ş            IF UDOSTATUS >=0 THENş               UDOSTATUS2=UDOARRAYGETSIZE(PROPNAMES,VALUE)ş               UDOSTATUS=UDOFREE(PROPNAMES)ş            ENDş         CASE 1ş            VALUE=1ş      END CASEş  ş      IF WOBJ.DEBUG THEN PRINT "WOBJ: LENGTH ACTION: ":NODE:" NODEPOS=":NODEPOS:" ":NODETYPE:" PARTTYPE=":PARTTYPE:" PARTPOS=":PARTPOS:" UDOSTATUS=":UDOSTATUS:" LENGTH=":VALUE:" RERR=":RERR<2>ş      RETURNş      *şaction.type: *ş      CALL WOBJ.FINDNODE.UDO(NODE,NODEPOS,NODETYPE,PARTPOS,JUSTNODE,PARTTYPE,RERR)ş      IF PARTPOS THENş         BEGIN CASEş            CASE PARTTYPE='O'ş               VALUE='OBJECT'ş            CASE PARTTYPE='A'ş               VALUE='ARRAY'ş            CASE PARTTYPE='D'ş               VALUE='NUMBER'ş            CASE PARTTYPE='S'ş               VALUE='STRING'ş            CASE PARTTYPE='N'ş               VALUE='NULL'ş            CASE PARTTYPE='B'ş               VALUE='BOOLEAN'ş            CASE 1ş               VALUE='UNKNOWN'ş         END CASEş      END ELSEş         IF NODE="" THENş            VALUE="OBJECT"ş         END ELSEş            VALUE="UNDEFINED" ;* NODE NOT FOUND!ş         ENDş      ENDş      IF WOBJ.DEBUG THEN PRINT "WOBJ: TYPE ACTION: ":NODE:" NODEPOS=":NODEPOS:" PARTPOS=":PARTPOS:" TYPE=":VALUE:" RERR=":RERR<2>ş      RETURNş      *ş      şaction.destroy: *ş   UDOSTATUS=UDOFREE(PASSEDOBJ)ş   IF UDOSTATUS = 0 THEN NULL ELSEş      RERR<1>=1ş      RERR<2>='Error destroying object (':UDOSTATUS:')'ş   ENDş   ş   RETURNşENDşşş001A13WOBJ.DELETEş0c2SUBROUTINE WOBJ.DELETE(ACTION,NODE,VALUE,RERR)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: delete a json node in parsed object structureş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şVALUE=""şDONE=0şLOOPş    CALL WOBJ.FINDNODE(NODE,NODEPOS,PARTPOS,CHILDPOS,LASTNODE,RERR)ş    IF WOBJ.DEBUG THEN PRINT "WOBJ.DELETE: NODEPOS=":NODEPOS:" PARTPOS=":PARTPOS:" CHILDPOS=":CHILDPOS:" RERROR=":RERR<2>ş    IF NOT(NODEPOS) OR NOT(PARTPOS) THENş        RERR=1ş        RERR<2>="Node not found"ş        RETURNş    ENDş    ş    NODETYPE = JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,NODEPOS,PARTPOS>ş    BEGIN CASEşş        CASE NODETYPE = 'O' AND CHILDPOS > 0şş* DELETE NESTED OBJECTS BEFORE DELETING PARENT NODEş            NEST.COUNT = 0ş            NUM.PARTS = JSONOBJECT(JSONOBJECT$NODELENGTH)<1,CHILDPOS>ş            FOR I=1 TO NUM.PARTSş                PARTTYPE=JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,CHILDPOS,I>ş                IF PARTTYPE = 'O' OR PARTTYPE = 'A' THENş                    PARTKEY=JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)<1,CHILDPOS,I>ş                    CALL WOBJ.DELETE(ACTION,NODE:".":PARTKEY,VALUE,RERR)ş                    NEST.COUNT += 1ş                    EXIT ;* AFTER MODIFYING THE JSONOBJECT STRUCTURE, NEED TO CALL FINDNODE AGAINş                ENDş            NEXT Işş            IF NEST.COUNT = 0 THENş* DELETE OBJECT NODEş                JSONOBJECT(JSONOBJECT$NODETYPE)=DELETE(JSONOBJECT(JSONOBJECT$NODETYPE),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODELENGTH)=DELETE(JSONOBJECT(JSONOBJECT$NODELENGTH),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.KEY),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODEPARTS.BLINK)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.BLINK),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODEPARTS.ENCODING)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.ENCODING),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODEPARTS.VALUE)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.VALUE),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODECNTR) -= 1şş* ADJUST LINKS TO ACCOUNT FOR DELETED NODEş                NUM.NODES = JSONOBJECT(JSONOBJECT$NODECNTR)ş                FOR I = 1 TO NUM.NODESş                    NUM.PARTS = JSONOBJECT(JSONOBJECT$NODELENGTH)<1,I>ş                    FOR J = 1 TO NUM.PARTSş                        FLINK = JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,I,J>ş                        IF FLINK >= CHILDPOS THENş                            JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,I,J> = FLINK - 1ş                        ENDş                        BLINK = JSONOBJECT(JSONOBJECT$NODEPARTS.BLINK)<1,I,J>ş                        IF BLINK >= CHILDPOS THENş                            JSONOBJECT(JSONOBJECT$NODEPARTS.BLINK)<1,I,J> = BLINK - 1ş                        ENDş                    NEXT Jş                NEXT Iş                DONE = 1ş            ENDşş        CASE NODETYPE = 'A' AND CHILDPOS > 0şş* DELETE NESTED OBJECTS BEFORE DELETING PARENT NODEş            NEST.COUNT = 0ş            NUM.ELEMS = JSONOBJECT(JSONOBJECT$NODELENGTH)<1,CHILDPOS>ş            FOR I = 1 TO NUM.ELEMSş                PARTTYPE = JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,CHILDPOS,I>ş                IF PARTTYPE = 'O' OR PARTTYPE = 'A' THENş* DELETE NESTED OBJECTS BEFORE DELETING PARENT NODEş                    CALL WOBJ.DELETE(ACTION,NODE:"[":(I-1):"]",VALUE,RERR)ş                    NEST.COUNT += 1ş                    EXIT ;* AFTER MODIFYING THE JSONOBJECT STRUCTURE, NEED TO CALL FINDNODE AGAINş                ENDş            NEXT Işş* AFTER MODIFYING THE JSONOBJECT STRUCTURE, NEED TO CALL FINDNODE AGAINş            IF NEST.COUNT = 0 THENş* DELETE ARRAY NODEş                JSONOBJECT(JSONOBJECT$NODETYPE)=DELETE(JSONOBJECT(JSONOBJECT$NODETYPE),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODELENGTH)=DELETE(JSONOBJECT(JSONOBJECT$NODELENGTH),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.KEY),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODEPARTS.BLINK)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.BLINK),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODEPARTS.ENCODING)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.ENCODING),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODEPARTS.VALUE)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.VALUE),1,CHILDPOS)ş                JSONOBJECT(JSONOBJECT$NODECNTR) -= 1şş* ADJUST LINKS TO ACCOUNT FOR DELETED NODEş                NUM.NODES = JSONOBJECT(JSONOBJECT$NODECNTR)ş                FOR I = 1 TO NUM.NODESş                    NUM.PARTS = JSONOBJECT(JSONOBJECT$NODELENGTH)<1,I>ş                    FOR J = 1 TO NUM.PARTSş                        FLINK = JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,I,J>ş                        IF FLINK >= CHILDPOS THENş                            JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,I,J> = FLINK - 1ş                        ENDş                        BLINK = JSONOBJECT(JSONOBJECT$NODEPARTS.BLINK)<1,I,J>ş                        IF BLINK >= CHILDPOS THENş                            JSONOBJECT(JSONOBJECT$NODEPARTS.BLINK)<1,I,J> = BLINK - 1ş                        ENDş                    NEXT Jş                NEXT Iş                DONE = 1ş            ENDşş        CASE 1ş            DONE = 1ş    END CASEşUNTIL DONE DO REPEATşş* DELETE SIMPLE NODEşJSONOBJECT(JSONOBJECT$NODEPARTS.KEY)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.KEY),1,NODEPOS,PARTPOS)şJSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE),1,NODEPOS,PARTPOS)şJSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK),1,NODEPOS,PARTPOS)şJSONOBJECT(JSONOBJECT$NODEPARTS.BLINK)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.BLINK),1,NODEPOS,PARTPOS)şJSONOBJECT(JSONOBJECT$NODEPARTS.ENCODING)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.ENCODING),1,NODEPOS,PARTPOS)şJSONOBJECT(JSONOBJECT$NODEPARTS.VALUE)=DELETE(JSONOBJECT(JSONOBJECT$NODEPARTS.VALUE),1,NODEPOS,PARTPOS)şJSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEPOS> -= 1ş*şRETURNşEND000EB5WOBJ.SET.UDOş0c2      SUBROUTINE WOBJ.SET.UDO(ACTION,NODE,VALUE,RERR)ş      **********************************************************************ş      *ş      * Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş      *ş      * Written by: Patrick Payne, Zumasysş      * Date: December 2017ş      * Description: set json node to valueş      *ş      * Modified by: Peter Schellenbach, Zumasysş      * Date: January 2018ş      * Description: allow Object and Array properties to be set, passingş      *   a JSON string representation of the node.ş      *ş      **********************************************************************ş      *ş      INCLUDE WOBJ.INCLUDEş      *INCLUDE UNIVERSE.INCLUDE UDO.Hş      ş      *$INCLUDE INCLUDE UDO.Hş      INCLUDE UDO.Hş      ş      COMMON /WUDO.C/ UDO.OBJECTS(100),UDO.OBJECT.METADATAş      *ş      IF WOBJ.DEBUG THEN PRINT "WOBJ.SET.UDO: NODE=":NODE:" ACTION=":ACTIONş      *ş      SACTION=FIELD(ACTION,".",2)şş      IF 0 THENş         IF NODE="" THENş            IF SACTION <> "OBJECT" THENş               RERR=1ş               RERR<2>="Node cannot be null"ş            END ELSEş               CALL WOBJ.PARSE(VALUE,NEWOBJ)ş               IF PSERRORS#"" THENş                  RERR=2ş                  RERR<2> = PSERRORSş                  IF WOBJ.DEBUG THEN PRINT "WOBJ.SET.OBJECT: parse failure: ":RERR<2>ş               ENDş            ENDş            RETURNş         ENDş      ENDş      *ş      CALL WOBJ.FINDNODE.UDO(NODE,NODEPOS,NODETYPE,PARTPOS,JUSTNODE,PARTTYPE,RERR)şş      IF WOBJ.DEBUG THEN PRINT "WOBJ.SET.UDO: NODEPOS=":NODEPOS:" PARTPOS=":PARTPOS:" NODETYPE=":NODETYPE:" PARTTYPE=":PARTTYPE:" RERROR=":RERR<2>ş      *ş      LASTNODE=""; * WE MAY NEED THIS!!şş      IF NOT(NODEPOS) THENş         RERR=1ş         RERR<2>="Node not found"ş         RETURNş      ENDş      *ş      * CHECK THE NODE WE ARE SETTING PROPERTY TOş      * NODETYPE=JSONOBJECT(JSONOBJECT$NODETYPE)<1,NODEPOS>ş      IF NODETYPE#"O" AND NODETYPE#"A" THENş         RERR=1ş         RERR<2>="Parent node must be an object or array"ş         RETURNş      ENDş      *ş      IGNORE.RERR=""ş      *** THIS MAY BE NEEDED TO IDENTIFY OUR LAST NODE!!!şşş      *ş      * NOW WE ARE SAFE TO SET NEW VALUEşş      UDOVALUE=""şş      BEGIN CASEş         CASE SACTION="OBJECT"ş            IF VALUE="" THEN VALUE="{}"ş            UDOSTATUS=UDOREAD(VALUE,UDOFORMAT_JSON,UDOVALUE)ş         CASE SACTION="ARRAY"ş            IF VALUE="" THEN VALUE="[]"ş            UDOSTATUS=UDOREAD(VALUE,UDOFORMAT_JSON,UDOVALUE)ş         CASE SACTION="NULL"ş            UDOSTATUS=UDOCREATE(UDO_NULL,UDOVALUE)ş         CASE SACTION="BOOLEAN"ş            IF OCONV(VALUE[1,1],"MCU") = "T" OR VALUE=0 THENş               UDOSTATUS=UDOCREATE(UDO_TRUE,UDOVALUE)ş            END ELSEş               UDOSTATUS=UDOCREATE(UDO_FALSE,UDOVALUE)ş            ENDş         CASE SACTION="STRING" OR SACTION=""ş            UDOVALUE=VALUE:""ş         CASE SACTION="NUMBER"ş            UDOVALUE=VALUE+0ş         CASE 1ş            UDOVALUE=VALUE:""ş      END CASEşş      UDOSTATUS=UDOGETTYPE(UDOVALUE,THIS.UDOTYPE)ş   ş      IF WOBJ.DEBUG THEN PRINT "WOBJ.SET.UDO: SET PARTTYPE=":PARTTYPE:" JUSTNODE=":JUSTNODE:" SACTION: ":SACTION:" THIS.UDOTYPE=":THIS.UDOTYPE; DEBUGşş      BEGIN CASEş         CASE NODETYPE="O"ş            UDOSTATUS=UDOSETPROPERTY(UDO.OBJECTS(NODEPOS),JUSTNODE,UDOVALUE)ş         CASE NODETYPE='A' AND PARTPOS=-1ş            UDOSTATUS=UDOARRAYAPPENDITEM(UDO.OBJECTS(NODEPOS),UDOVALUE)ş         CASE NODETYPE='A'ş            UDOSTATUS=UDOARRAYSETITEM(UDO.OBJECTS(NODEPOS),PARTPOS+1, UDOVALUE)ş      END CASEşş      IF WOBJ.DEBUG THEN PRINT "WOBJ.SET.UDO: UDOSTATUS=":UDOSTATUSşş      *CALL WOBJ.SET.PART(NODEPOS,PARTPOS,PARTTYPE,PARTKEY,VALUE,RERR)şş      RETURNş      END001C67WOBJ.TESTş0c2**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: WOBJ.TEST - QC Testing tool for WOBJş*ş**********************************************************************ş*ş* Build test json to parseş*şşINCLUDE WOBJ.CHOOSE.WOBJşşJSON =  \{\şJSON := \ "stringtest":"stringtestvalue",\şJSON := \ "numbertest": 100.12,\şJSON := \ "booleantesttrue": True, \şJSON := \ "booleantestfalse": False, \şJSON := \ "nulltest": null \şJSON := \}\ş*ş* Lets build the objşCALL @WOBJ.RTNE(TESTOBJ,"VERSION","",VERSION,"",RERR)şPRINT "VERSION: ":VERSIONşşCALL @WOBJ.RTNE(TESTOBJ,"FROMSTRING","","{}","",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"SET.ARRAY","arraytest","[]","",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"SET.STRING","arraytest[-1]","1","",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"SET.STRING","arraytest[-1]","2","",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"SET.OBJECT","objecttest",'{ "objecttestv1":"ok" }',"",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"SET.STRING","stringtest","stringtestvalue","",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"SET.NUMBER","numbertest",100.12,"",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"SET.BOOLEAN","booleantesttrue","True","",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"SET.BOOLEAN","booleantestfalse","False","",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"SET.NULL","nulltest","NULL","",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"TOSTRING","",JSON,"",RERR)şTESTOBJ=""ş*ş* TEST 1 - PARSEş*şTEST="parse"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"FROMSTRING","",JSON,"",RERR)şGOSUB process.errorşIF NOT(RERR<1>) THENş   TEST.MSG="Parse ok"ş   TEST.STATUS=1şENDşGOSUB end.testşş*ş* TEST 2 - GetStringş*şTEST="GetString"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"GET","stringtest",VALUE,"",RERR)şGOSUB process.errorşIF NOT(RERR<1>) THENş   TEST.MSG="String Found: (":VALUE:")"ş   IF VALUE="stringtestvalue" THENş      TEST.STATUS=1ş   END ELSEş       TEST.STATUS=0ş   ENDşENDşGOSUB end.testş*ş* TEST 3 - GetNumberş*şTEST="GetNumber"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"GET","numbertest",VALUE,"",RERR)şGOSUB process.errorşIF NOT(RERR<1>) THENş   TEST.MSG="Number Found: (":VALUE:")"ş   BEGIN CASEş      CASE NOT(NUM(VALUE))ş      CASE VALUE=100.12ş         TEST.STATUS=1ş      CASE 1ş   END CASEşENDşGOSUB end.testş*ş* TEST 4 - GETBooleanş*şTEST="GetBooleanTrue"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"GET","booleantesttrue",VALUE,"",RERR)şGOSUB process.errorşIF NOT(RERR<1>) THENş   TEST.MSG="Boolean Found: (":VALUE:")"ş   BEGIN CASEş      CASE VALUE="true"ş         TEST.STATUS=1ş      CASE 1ş   END CASEşENDşGOSUB end.testş*ş* TEST 5 - GETBooleanş*şTEST="GetBooleanFalse"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"GET","booleantestfalse",VALUE,"",RERR)şGOSUB process.errorşIF NOT(RERR<1>) THENş   TEST.MSG="Boolean Found: (":VALUE:")"ş   BEGIN CASEş      CASE VALUE="false"ş         TEST.STATUS=1ş      CASE 1ş   END CASEşENDşGOSUB end.testş*ş* TEST 6 - get nullş*şTEST="GetNull"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"GET","nulltest",VALUE,"",RERR)şGOSUB process.errorşIF NOT(RERR<1>) THENş   TEST.MSG="testnull Found: (":VALUE:")"ş   BEGIN CASEş      CASE VALUE="null"ş         TEST.STATUS=1ş      CASE 1ş   END CASEşENDşGOSUB end.testş*ş* TEST 7 - get lengthş*şTEST="LENGTH"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"LENGTH","arraytest",VALUE,"",RERR)şGOSUB process.errorşIF NOT(RERR<1>) THENş   TEST.MSG="LENGTH(arraytest) Found: (":VALUE:")"ş   BEGIN CASEş      CASE VALUE="2"ş         TEST.STATUS=1ş      CASE 1ş   END CASEşENDşGOSUB end.testş*ş* TEST 8 get array sub partş*şTEST="get array part"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"GET","arraytest[1]",VALUE,"",RERR)şGOSUB process.errorşIF NOT(RERR<1>) THENş   TEST.MSG="arraytest[2] Found: (":VALUE:")"ş   BEGIN CASEş      CASE VALUE="2"ş         TEST.STATUS=1ş      CASE 1ş   END CASEşENDşGOSUB end.testş*ş* TEST 9 - get object keysş*şTEST="KEYS"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"KEYS","objecttest",VALUE,"",RERR)şGOSUB process.errorşIF NOT(RERR<1>) THENş   TEST.MSG="KEYS Found: (":VALUE:")"ş   BEGIN CASEş      CASE VALUE="objecttestv1"ş         TEST.STATUS=1ş      CASE 1ş   END CASEşENDşGOSUB end.testşş*ş* TEST 10- add item and retrieveş*şTEST="addstring2"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"SET.STRING","string2","string2","",RERR)şGOSUB process.errorşIF NOT(RERR<1>) THENş   TEST.MSG="Added string2"şENDşGOSUB end.testş*ş* TEST 11 - get string2ş*şTEST="getstring2"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"GET","string2",VALUE,"",RERR)şGOSUB process.errorşIF NOT(RERR<1>) THENş   TEST.MSG="string2 Found: (":VALUE:")"ş   BEGIN CASEş      CASE VALUE="string2"ş         TEST.STATUS=1ş      CASE 1ş   END CASEşENDşGOSUB end.testş*ş* TEST 12- add item and retrieveş*şTEST="addnull2"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"SET.NULL","null2","null","",RERR)şGOSUB process.errorşIF NOT(RERR<1>) THENş   TEST.MSG="Add Null2"şENDşGOSUB end.testşş*ş* TEST 11 - get NULL2ş*şTEST="getnull2"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"GET","null2",VALUE,"",RERR)şGOSUB process.errorşIF NOT(RERR<1>) THENş   TEST.MSG="null2 Found: (":VALUE:")"ş   BEGIN CASEş      CASE VALUE="null"ş         TEST.STATUS=1ş      CASE 1ş   END CASEşENDşGOSUB end.testşş*ş* TEST 12 - Add blank Objectş*şTEST="Add blank object"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"SET.OBJECT","nullobject","","",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"SET","nullobject.nullfield","nullvalue","",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"GET","nullobject.nullfield",VALUE,"",RERR)şGOSUB process.errorşIF NOT(RERR<1>) AND VALUE="nullvalue" THENş   TEST.MSG="nullfield found "ş   TEST.STATUS=1şEND ELSEş   TEST.MSG="nullfield not found "şENDşTEST.MSG:=' (':VALUE:')'şşGOSUB end.testşş*ş* TEST 13 - Add blank arrayş*şTEST="Add blank array"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"SET.ARRAY","nullarray","","",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"SET","nullarray[-1]","nullvalue","",RERR)şCALL @WOBJ.RTNE(TESTOBJ,"GET","nullarray[0]",VALUE,"",RERR)şGOSUB process.errorşIF NOT(RERR<1>) AND VALUE="nullvalue" THENş   TEST.MSG="nullfield found "ş   TEST.STATUS=1şEND ELSEş   TEST.MSG="nullfield not found "şENDşTEST.MSG:=' (':VALUE:')'şşGOSUB end.testşş*ş* TEST 14 - Test TOJSONşTEST="Test TOJSON"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ,"TOJSON","",TJSON,"PRETTIFY",RERR)şGOSUB process.errorşTEST.STATUS=0şTEST.MSG="Testing JSON"şIF NOT(RERR<1>) THENş   IF INDEX(TJSON,"arraytest",1) THENş   TEST.MSG="nullfield found "ş   TEST.STATUS=1ş   ENDşEND ELSEş   TEST.MSG=""şENDşşGOSUB end.testşş*ş* TEST 15 - Test FROMJSONşTEST="Test FROMJSON"şGOSUB start.testşCALL @WOBJ.RTNE(TESTOBJ2,"FROMJSON","",TJSON,"",RERR)şCALL @WOBJ.RTNE(TESTOBJ2,"GET","stringtest",VALUE,"",RERR)şGOSUB process.errorşTEST.MSG="stringtestvalue=(":VALUE:")"şTEST.STATUS=0şIF NOT(RERR<1>) THENş   IF VALUE="stringtestvalue" THENş   TEST.STATUS=1ş   ENDşENDşşGOSUB end.testşşşCALL @WOBJ.RTNE(TESTOBJ,"TOSTRING","",OUT.JSON,"PRETTIFY",RERR)şPRINT OUT.JSONşşşSTOPş*şGOSUB start.testşRETURNş*şprocess.error: *şIF RERR<1> THENş   TEST.STATUS=-1ş   TEST.MSG=RERR<1>şENDşRETURNş*ş*şstart.test: *şTEST.STATUS=0şTEST.MSG="Success"şPRINT "Test: ":TEST[1,20]"L(#20)":şRETURNş*şend.test: *şPRINT "  ":TEST.MSG[1,60]"L(#60)":şPRINT " ":şIF TEST.STATUS THEN PRINT "[Ok    ]" ELSE PRINT @(-13):"[Failed]":@(-14)şRETURN0009CEWOBJ.OBJECT.TOSTRINGş0c2SUBROUTINE WOBJ.OBJECT.TOSTRING(JSON,POS)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: convert parsed json object node to stringş*ş**********************************************************************ş*şşINCLUDE WOBJ.INCLUDEş*şJSON:="{"; * START OUR STRINGşINDENT.DEPTH+=1ş*IF PRETTIFY THEN JSON:=NLşNUMBER.PARTS=JSONOBJECT(JSONOBJECT$NODELENGTH)<1,POS>şIF WOBJ.DEBUG THEN PRINT "WOBJ.TOSTRING: POS=":POS:" NUMBER.PARTS=":NUMBER.PARTSş*ş* OPTION TO SORT THISş*ş*SORTTYPE="NSBASIC"şSORTTYPE=""şBEGIN CASEş     CASE 1ş        KEYS=JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)<1,POS>ş        CONVERT @SVM TO @AM IN KEYSş        SORTED.KEYS=KEYSşEND CASEşACTUAL.KEYS=JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)<1,POS>şFOR PP=1 TO NUMBER.PARTSş    PART.KEY=SORTED.KEYS<PP>ş    LOCATE PART.KEY IN ACTUAL.KEYS<1,1> SETTING P ELSEş        IF WOBJ.DEBUG THEN PRINT "WOBJ.TOSTRING: COULD NOT LOCATE ":PART.KEY:" IN ":ACTUAL.KEYSş    ENDş    PART.TYPE=JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,POS,P>ş    PART.KEY=JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)<1,POS,P>ş    IF WOBJ.DEBUG THEN PRINT "WOBJ.TOSTRING: POS=":POS:" P=":P:" T=":PART.TYPE:" K=":PART.KEYş    IF PP=1 AND PRETTIFY THEN JSON:=NLş    CALL WOBJ.ENCODE(PART.KEY,OUT.PART.KEY)ş    CALL WOBJ.PRETTIFY.INDENT(JSON,POS)ş    JSON:='"':OUT.PART.KEY:'": 'ş    BEGIN CASEş        CASE PART.TYPE="S"ş            CALL WOBJ.STRING.TOSTRING(JSON,POS,P)ş        CASE PART.TYPE="B"ş            CALL WOBJ.BOOLEAN.TOSTRING(JSON,POS,P)ş        CASE PART.TYPE="D"ş            CALL WOBJ.NUMBER.TOSTRING(JSON,POS,P)ş        CASE PART.TYPE="N"ş            CALL WOBJ.NULL.TOSTRING(JSON,POS,P)ş        CASE PART.TYPE="O"ş            PART.FLINK=JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,POS,P>ş            IF WOBJ.DEBUG THEN PRINT "WOBJ.TOSTRING: FL=":PART.FLINKş            CALL WOBJ.OBJECT.TOSTRING(JSON,PART.FLINK)ş        CASE PART.TYPE="A"ş            PART.FLINK=JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,POS,P>ş            IF WOBJ.DEBUG THEN PRINT "WOBJ.TOSTRING: FL=":PART.FLINKş            CALL WOBJ.ARRAY.TOSTRING(JSON,PART.FLINK)ş    END CASEş    IF PP <> NUMBER.PARTS THENş        JSON:=", "ş        IF PRETTIFY THEN JSON:=NLş    ENDşNEXT PPş*şIF PRETTIFY THENş    JSON:=NLş    PASS.POS=POS-1ş    CALL WOBJ.PRETTIFY.INDENT(JSON,PASS.POS)şENDşJSON:="}"ş*IF PRETTIFY THEN JSON:=NLşINDENT.DEPTH -= 1şRETURNşEND000459WOBJ.KEYSş0c2SUBROUTINE WOBJ.KEYS(ACTION,NODE,VALUE,RERR)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: return list of elements in a json node in parsed object structureş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şVALUE=""şCALL WOBJ.FINDNODE(NODE,NODEPOS,PARTPOS,CHILDPOS,LASTNODE,RERR)ş*ş*IF WOBJ.DEBUG THEN PRINT "WOBJ.KEYS: NODEPOS=":NODEPOS:" PARTPOS=":PARTPOS:" LASTNODE=":LASTNODE:" RERR=":RERR<2>ş*şIF NOT(NODEPOS) THENş    RERR=1ş    RERR<2>="Node not found" ş    RETURNşENDşIF NODE#"" AND NOT(PARTPOS) THENş    RERR=1ş    RERR<2>="Node not found" ş    RETURNşENDşIF NODE="" THENş    NODEPOS=1ş    CHILDPOS=1şENDşIF NOT(CHILDPOS) THENş   RERR=1ş   RERR<2>="Node is not an object"ş   RETURNşENDşNODETYPE=JSONOBJECT(JSONOBJECT$NODETYPE)<1,CHILDPOS>şIF NODETYPE#"O" THENş   RERR=1ş   RERR<2>="Node is not an object"ş   RETURNşENDşVALUE=JSONOBJECT(JSONOBJECT$NODEPARTS.KEY)<1,CHILDPOS>şRETURNşEND0001C5COMPILE.TXTş0c2WOBJşWOBJ.ARRAY.TOSTRINGşWOBJ.BOOLEAN.TOSTRINGşWOBJ.DECODE.PARTşWOBJ.DELETEşWOBJ.ENCODEşWOBJ.FINDNODEşWOBJ.GETşWOBJ.INCLUDEşWOBJ.KEYSşWOBJ.NULL.TOSTRINGşWOBJ.NUMBER.TOSTRINGşWOBJ.OBJECT.TOSTRINGşWOBJ.PARSEşWOBJ.PARSEARRAYşWOBJ.PARSEBOOLEANşWOBJ.PARSEKEYşWOBJ.PARSENULLşWOBJ.PARSENUMBERşWOBJ.PARSEOBJECTşWOBJ.PARSESTRINGşWOBJ.PARSEVALUEşWOBJ.PRETTIFY.INDENTşWOBJ.SETşWOBJ.SET.PARTşWOBJ.SKIPCHARşWOBJ.STRING.TOSTRINGşWOBJ.TESTşWOBJ.TOSTRING0002C7WOBJ.TOSTRINGş0c2SUBROUTINE WOBJ.TOSTRING(JSON)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: internal convert json object to stringş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şPOS=1şOBJ.TYPE=JSONOBJECT(JSONOBJECT$NODETYPE)<1,POS>şIF OBJ.TYPE="" OR POS > JSONOBJECT$NODECNTR THEN RETURNşIF WOBJ.DEBUG THEN PRINT "FIRST OBJECT=":OBJ.TYPEşBEGIN CASEş    CASE OBJ.TYPE="A"ş        CALL WOBJ.ARRAY.TOSTRING(JSON,POS)ş    CASE OBJ.TYPE="O"ş        CALL WOBJ.OBJECT.TOSTRING(JSON,POS)şEND CASEşRETURNşEND0002AFWOBJ.DECODE.PARTş0c2SUBROUTINE WOBJ.DECODE.PART(NODEPOS,PARTPOS,VALUE)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: decode json part valueş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şPARTENCODING =  JSONOBJECT(JSONOBJECT$NODEPARTS.ENCODING)<1,NODEPOS,PARTPOS>şPARTVALUE    =  JSONOBJECT(JSONOBJECT$NODEPARTS.VALUE)<1,NODEPOS,PARTPOS>ş*şBEGIN CASEş    CASE PARTENCODING="H"ş        VALUE=ICONV(PARTVALUE,"MX0C"); * UVş    CASE 1ş        VALUE=PARTVALUEşEND CASEş*şRETURNşEND000529WOBJ.GETş0c2SUBROUTINE WOBJ.GET(ACTION,NODE,VALUE,RERR)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: get json element valueş*ş* Modified by: Peter Schellenbach, Zumasysş* Date: January 2018ş* Description: if specified node is an Object or Array, returnş*   a JSON string representation of the node.ş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şVALUE=""şIF NODE="" THENş    CALL WOBJ.OBJECT.TOSTRING(VALUE,1) ; * Root objectş    RETURNşENDş*şCALL WOBJ.FINDNODE(NODE,NODEPOS,PARTPOS,CHILDPOS,LASTNODE,RERR)şIF NODEPOS > 0 AND PARTPOS > 0 THENş    OBJ.TYPE=JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,NODEPOS,PARTPOS>ş    BEGIN CASEş        CASE OBJ.TYPE="O"ş            CALL WOBJ.OBJECT.TOSTRING(VALUE,CHILDPOS)ş        CASE OBJ.TYPE="A"ş            CALL WOBJ.ARRAY.TOSTRING(VALUE,CHILDPOS)ş        CASE OBJ.TYPE="N"ş            VALUE="null"; * 4/23/202 - Return null valueş        CASE 1ş            CALL WOBJ.DECODE.PART(NODEPOS,PARTPOS,VALUE)ş    END CASEşEND ELSEş    VALUE="" ; * NODE NOT FOUND!şENDşIF WOBJ.DEBUG THEN PRINT "WOBJ.GET: ":NODE:" NODEPOS=":NODEPOS:" PARTPOS=":PARTPOS:" VALUE=":VALUEşRETURNşEND0008BCWOBJ.PARSESTRINGş0c2SUBROUTINE WOBJ.PARSESTRING(JSTR,INDEXPOS,PARSESTRING)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: parse json string valueş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şPARSESTRING=""ş*şSAVE.INDEXPOS=INDEXPOSşCALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)şIFQUOTE = JSTR[INDEXPOS,1]şINDEXPOS+=1şLEN.JSTR=LEN(JSTR)ş*şLOOPşWHILE INDEXPOS > 0 AND INDEXPOS < LEN.JSTR DOş    C = JSTR[INDEXPOS,1]ş    IF WOBJ.DEBUG > 1 THEN PRINT "PARSESTRING: LOOKING AT (":C:")"ş    BEGIN CASEş        CASE C = "\"ş            INDEXPOS+=1ş            C=JSTR[INDEXPOS,1]ş            BEGIN CASEş                CASE C = \"\ OR C = "\" OR C= "/" OR C = "'"ş                    PARSESTRING:=Cş                    INDEXPOS+=1ş                CASE C = "b"ş                    PARSESTRING:=BSş                    INDEXPOS+=1ş                CASE C = "f"ş                    PARSESTRING:=FFş                    INDEXPOS+=1ş                CASE C = "n"ş                    PARSESTRING:=LFş                    INDEXPOS+=1ş                CASE C = "r"ş                    PARSESTRING:=CRş                    INDEXPOS+=1ş                CASE C = "t"ş                    PARSESTRING:=TBş                    INDEXPOS+=1ş                CASE C = "u"ş                    INDEXPOS+=1ş                    CODE=JSTR[INDEXPOS,4]ş                    IF CODE[1,2]="00" THENş                        PARSESTRING:=ICONV(CODE[3,2],"MX0C")ş                    END ELSEş                        PARSESTRING:="_" ;* Poor substitute for invalid Unicode character!ş                        PSERRORS<-1> = "Invalid Unicode character at position ":INDEXPOS-1:" : u":CODEş                    ENDş                    INDEXPOS+=4ş            END CASEş        CASE C = IFQUOTEş            INDEXPOS+=1ş            EXITş        CASE 1ş            PARSESTRING:=Cş            INDEXPOS+=1ş    END CASEşREPEATşIF C # IFQUOTE THENş    * string not terminated!ş    PARSESTRING=""ş    INDEXPOS=SAVE.INDEXPOSşENDşIF WOBJ.DEBUG THEN PRINT "PARSESTRING: EXITING: ":PARSESTRINGşRETURNşEND000120WOBJ.UNASSIGNED.INCLUDEş0c2IF NOT(ASSIGNED(PASSEDOBJ)) THEN RERR='PARAM1 BLANK'şIF NOT(ASSIGNED(ACTION)) THEN RERR='PARAM2 (ACTION) NOT ASSIGNED'şIF NOT(ASSIGNED(NODE)) THEN RERR='PARAM3 (NODE) NOT ASSIGNED'şIF NOT(ASSIGNED(VALUE)) THEN VALUE=""şIF NOT(ASSIGNED(OPTIONS)) THEN OPTIONS=""ş000258WOBJ.BOOLEAN.TOSTRINGş0c2SUBROUTINE WOBJ.BOOLEAN.TOSTRING(JSON,NODEPOS,PARTPOS)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: convert json boolean to stringş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şCALL WOBJ.DECODE.PART(NODEPOS,PARTPOS,VALUE)ş*şCALL WOBJ.ENCODE(VALUE,OUT.VALUE)şJSON:=OCONV(OUT.VALUE,"MCL")ş*şIF WOBJ.DEBUG THEN PRINT "N=":NODEPOS:" P=":PARTPOS:" V=":VALUEşRETURNşEND0001E4WOBJ.NULL.TOSTRINGş0c2SUBROUTINE WOBJ.NULL.TOSTRING(JSON,NODEPOS,PARTPOS)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: json null to stringş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şJSON:="null"ş*şIF WOBJ.DEBUG THEN PRINT "N=":NODEPOS:" P=":PARTPOS:" V=null"şRETURNşEND0001E1WOBJ.PRETTIFY.INDENTş0c2SUBROUTINE WOBJ.PRETTIFY.INDENT(JSON,POS)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: indent json stringş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şINDENTSTEP=2ş*şIF PRETTIFY THENş    JSON:=STR(" ",(INDENT.DEPTH*INDENTSTEP))şENDş*şRETURNşEND00024DWOBJ.STRING.TOSTRINGş0c2SUBROUTINE WOBJ.STRING.TOSTRING(JSON,NODEPOS,PARTPOS)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: return json node as stringş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şCALL WOBJ.DECODE.PART(NODEPOS,PARTPOS,VALUE)ş*şCALL WOBJ.ENCODE(VALUE,OUT.VALUE)şJSON:='"':OUT.VALUE:'"'ş*şIF WOBJ.DEBUG THEN PRINT "N=":NODEPOS:" P=":PARTPOS:" V=":VALUEşRETURNşEND000971WOBJ.PARSEVALUEş0c2SUBROUTINE WOBJ.PARSEVALUE(JSTR,INDEXPOS,PARSEVALUE)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: parse json valueş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şPARSEVALUE=""ş*şIF WOBJ.DEBUG THEN PRINT "PARSEVALUE - STARTING"şCALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)ş*şC=JSTR[INDEXPOS,1]şLEN.JSTR=LEN(JSTR)ş*şIF WOBJ.DEBUG THEN PRINT "PARSEVALUE LOOKING AT ":Cş*ş* WE WILL BE ADDING A NEW ITEM TO OUR OBJECT ARRAYş*şBEGIN CASEş    CASE C="{"ş        CALL WOBJ.PARSEOBJECT(JSTR,INDEXPOS,PARSEVALUE)ş    CASE C="["ş        IF WOBJ.DEBUG THEN PRINT "PARSEVALUE CALLING PARSEARRAY"ş        CALL WOBJ.PARSEARRAY(JSTR,INDEXPOS,PARSEVALUE)ş    CASE C='"' OR C="'"ş        IF WOBJ.DEBUG THEN PRINT "PARSEVALUE - CALLING PARSESTRING"ş        CALL WOBJ.PARSESTRING(JSTR,INDEXPOS,PARSEVALUE)ş        PARSEVALUE=INSERT(PARSEVALUE,1;"S")ş    CASE 1ş        IF C="t" OR C="T" OR C="f" OR C="F" THENş            IF WOBJ.DEBUG THEN PRINT "PARSEVALUE - CALLING PARSEBOOLEAN"ş            CALL WOBJ.PARSEBOOLEAN(JSTR,INDEXPOS,PARSEVALUE)ş            IF PARSEVALUE#"" THENş                PARSEVALUE=INSERT(PARSEVALUE,1;"B")ş            ENDş        ENDş        IF PARSEVALUE="" AND (C="n" OR C="N") THENş            IF WOBJ.DEBUG THEN PRINT "PARSEVALUE - CALLING PARSENULL"ş            CALL WOBJ.PARSENULL(JSTR,INDEXPOS,PARSEVALUE)ş            IF PARSEVALUE#"" THENş                 PARSEVALUE=INSERT(PARSEVALUE,1;"N")ş            ENDş        ENDş        IF PARSEVALUE="" THENş            IF WOBJ.DEBUG THEN PRINT "PARSEVALUE - CALLING PARSENUMBER"ş            CALL WOBJ.PARSENUMBER(JSTR,INDEXPOS,PARSEVALUE)ş            IF PARSEVALUE#"" THENş                PARSEVALUE=INSERT(PARSEVALUE,1;"D")ş            ENDş        ENDş        IF PARSEVALUE="" THENş            * Treat unidentified value as stringş            LOOPş            WHILE INDEXPOS > 0 AND INDEXPOS < LEN.JSTR DOş                C = JSTR[INDEXPOS,1]ş                IF INDEX(",]}",C,1) THENş                    EXITş                ENDş                PARSEVALUE:=Cş                INDEXPOS+=1ş            REPEATş            PARSEVALUE=INSERT(PARSEVALUE,1;"S")ş        ENDşEND CASEşIF WOBJ.DEBUG THEN PRINT "PARSEVALUE - END OF ROUTINE"ş*şRETURNşEND000180WOBJ.CHOOSE.WOBJş0c2* Code to determine default wobj library to useşş* This needs to change for MVDBTOOLKIT build, defaults to WOBJşşWOBJ.RTNE="WOBJ"şşNO.MD.FILE=0şşOPEN "MD" TO FILE.MD ELSEş    OPEN "VOC" TO FILE.MD ELSE NO.MD.FILE=1şENDşşIF NOT(NO.MD.FILE) THENş    READ WOBJ.CONF FROM FILE.MD, "WOBJ.CONF" ELSE WOBJ.CONF=""şş    IF WOBJ.CONF<3> # "" THEN WOBJ.RTNE=WOBJ.CONF<3>şEND0014F3WOBJş0c2SUBROUTINE WOBJ(PASSEDOBJ,ACTION,NODE,VALUE,OPTIONS,RERR)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: WOBJ json library main routineş*ş**********************************************************************ş*şWOBJ.VERSION = "2.0"ş*şINCLUDE WOBJ.INCLUDEş*şş* 4/21/2020 Merged in udo object supportşşPLATFORM=""şş* HOW TO DEFINE CONFIGURATION FOR WOBJ??şşNO.MD.FILE=0şşOPEN "MD" TO MD.FILE ELSEş   OPEN "VOC" TO MD.FILE ELSE NO.MD.FILE=1şENDşşWOBJ.CONF=""şşIF NOT(NO.MD.FILE) THENş   READ WOBJ.CONF FROM MD.FILE, "WOBJ.CONF" ELSE WOBJ.CONF=""şENDşşşIF WOBJ.CONF="" THENş   NO.DICT.WOBJ.BP=0ş   OPEN "DICT","WOBJ.BP" TO DICT.WOBJ.BP ELSE NO.DICT.WOBJ.BP=1ş   IF NOT(NO.DICT.WOBJ.BP) THENş      READ WOBJ.CONF FROM DICT.WOBJ.BP, "WOBJ.CONF" ELSE WOBJ.CONF=""ş   ENDşENDşşPLATFORM=WOBJ.CONF<2>şş* 5/11/2020 - Moved unassigned check to hereş*ş* Doing inline include due to Assign/Unassigned (unidata)ş* WOBJ.UNASSIGNED.INCLUDEşş*$INCLUDE WOBJ.UNASSIGNED.INCLUDEşINCLUDE WOBJ.UNASSIGNED.INCLUDEşşşIF INDEX(OPTIONS,"PRETTIFY",1) THEN PRETTIFY=1 ELSE PRETTIFY=0şIF INDEX(OPTIONS,"PRETTIFYCR",1) THEN PRETTIFYCR=1 ELSE PRETTIFYCR=0şIF INDEX(OPTIONS,"DEBUG",1) THEN WOBJ.DEBUG=1 ELSE WOBJ.DEBUG=0şIF INDEX(OPTIONS,"UDO=1",1) THEN PLATFORM="UDO"şIF INDEX(OPTIONS,"UDO=0",1) AND PLATFORM="UDO" THEN PLATFORM=""şIF INDEX(OPTIONS,"NATIVE",1) THEN PLATFORM=""şş* 5/11/2020 - pap Patch to allow default setting for a ş*             set.object or set.arrayş*şşIF ACTION="SET.OBJECT" AND VALUE="" THEN VALUE="{}"şIF ACTION="SET.ARRAY" AND VALUE="" THEN VALUE="[]"şIF ACTION="FROMJSON" THEN ACTION="FROMSTRING"şIF ACTION="TOJSON" THEN ACTION="TOSTRING"şşşBEGIN CASEş   CASE PLATFORM='UDO'ş      CALL WOBJ.UDO(PASSEDOBJ,ACTION,NODE,VALUE,OPTIONS,RERR)ş      RETURNş   CASE 1şEND CASEşş*şMAT JSONOBJECT = ""şRERR=""şINDENT.DEPTH=0ş*şBEGIN CASEş    CASE ACTION="FROMSTRING"ş* THIS EXISTS EARLIER DUE TO MATPARSE BELOWş        CALL WOBJ.PARSE(VALUE,NEWOBJ)ş        PASSEDOBJ=NEWOBJş        IF PSERRORS # "" THENş            RERR=2ş            RERR<2> = PSERRORSş        ENDş        IF WOBJ.DEBUG THEN PRINT "WOBJ: FROMSTRING ACTION: VALUE=":VALUE:" RERR=":RERR<2>ş        RETURNş    CASE ACTION="VERSION"ş        VALUE=WOBJ.VERSIONş        RETURNşEND CASEşşRERR=''şş*IF NOT(ASSIGNED(PASSEDOBJ)) THEN RERR='PARAM1 BLANK'ş*IF NOT(ASSIGNED(ACTION)) THEN RERR='PARAM2 (ACTION) NOT ASSIGNED'ş*IF NOT(ASSIGNED(NODE)) THEN RERR='PARAM3 (NODE) NOT ASSIGNED'ş*IF NOT(ASSIGNED(VALUE)) THEN VALUE=""ş*IF NOT(ASSIGNED(OPTIONS)) THEN OPTIONS=""şşIF RERR <> "" THENş   RERR<2>=RERRş   RERR<1>=1ş   PRINT RERR<1>ş   RETURNşENDşş*ş* MATPARSE JSONOBJECT FROM PASSEDOBJ; * all except unidataşMATPARSE JSONOBJECT FROM PASSEDOBJ, @AM; * Unidataş*şIF WOBJ.DEBUG THEN PRINT "ACTION=":ACTIONşBEGIN CASEş    CASE ACTION="TOSTRING"ş        VALUE=""ş        IF NODE # "" THENş            RERR=1ş            RERR<2>="Node ignored - returning the root node"ş            IF WOBJ.DEBUG THEN PRINT "WOBJ: TOSTRING ACTION: NODE ":NODE:" IGNORED"ş        ENDş        CALL WOBJ.TOSTRING(VALUE)ş    CASE ACTION="GET"ş        GOSUB action.getş    CASE FIELD(ACTION,".",1)="SET"ş        GOSUB action.setş    CASE ACTION="DELETE"ş        GOSUB action.deleteş    CASE ACTION="KEYS"ş        GOSUB action.keysş    CASE ACTION="LENGTH"ş        GOSUB action.lengthş    CASE ACTION="TYPE"ş        GOSUB action.typeş    CASE 1ş        VALUE=""ş        RERR=1ş        RERR<2>="Invalid action '":ACTION:"'"ş        IF WOBJ.DEBUG THEN PRINT "WOBJ: INVALID ACTION: ":ACTIONşEND CASEş*şMATBUILD PASSEDOBJ FROM JSONOBJECTş*şRETURNş*şaction.get: *şCALL WOBJ.GET(ACTION,NODE,VALUE,RERR)şRETURNş*şaction.set: *şCALL WOBJ.SET(ACTION,NODE,VALUE,RERR)şRETURNş*şaction.delete: *şCALL WOBJ.DELETE(ACTION,NODE,VALUE,RERR)şRETURNş*şaction.keys: *şCALL WOBJ.KEYS(ACTION,NODE,VALUE,RERR)şRETURNş*şaction.length: *şCALL WOBJ.FINDNODE(NODE,NODEPOS,PARTPOS,CHILDPOS,LASTNODE,RERR)şIF PARTPOS THENş    IF CHILDPOS THENş        VALUE=JSONOBJECT(JSONOBJECT$NODELENGTH)<1,CHILDPOS>+0ş    END ELSEş        VALUE=1 ;* SIMPLE NODE HAS LENGTH OF 1ş    ENDşEND ELSEş    IF NODE="" THENş        VALUE=JSONOBJECT(JSONOBJECT$NODELENGTH)<1,1>+0ş    END ELSEş        VALUE=0 ;* NODE NOT FOUND!ş    ENDşENDşIF WOBJ.DEBUG THEN PRINT "WOBJ: LENGTH ACTION: ":NODE:" NODEPOS=":NODEPOS:" PARTPOS=":PARTPOS:" CHILDPOS=":CHILDPOS:" LENGTH=":VALUE:" RERR=":RERR<2>şRETURNş*şaction.type: *şCALL WOBJ.FINDNODE(NODE,NODEPOS,PARTPOS,CHILDPOS,LASTNODE,RERR)şIF PARTPOS THENş    PARTTYPE = JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,NODEPOS,PARTPOS>ş    BEGIN CASEş        CASE PARTTYPE='O'ş            VALUE='OBJECT'ş        CASE PARTTYPE='A'ş            VALUE='ARRAY'ş        CASE PARTTYPE='D'ş            VALUE='NUMBER'ş        CASE PARTTYPE='S'ş            VALUE='STRING'ş        CASE PARTTYPE='N'ş            VALUE='NULL'ş        CASE PARTTYPE='B'ş            VALUE='BOOLEAN'ş        CASE 1ş            VALUE='UNKNOWN'ş    END CASEşEND ELSEş    IF NODE="" THENş        VALUE="OBJECT"ş    END ELSEş        VALUE="UNDEFINED" ;* NODE NOT FOUND!ş    ENDşENDşIF WOBJ.DEBUG THEN PRINT "WOBJ: TYPE ACTION: ":NODE:" NODEPOS=":NODEPOS:" PARTPOS=":PARTPOS:" CHILDPOS=":CHILDPOS:" TYPE=":VALUE:" RERR=":RERR<2>şRETURNş*şEND00038DWOBJ.PARSENUMBERş0c2SUBROUTINE WOBJ.PARSENUMBER(JSTR,INDEXPOS,PARSESTRING)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: parse json numeric valueş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şPARSESTRING=""ş*şCALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)şSAVE.INDEXPOS=INDEXPOSş*şJSTR.LENGTH=LEN(JSTR)ş*şLOOP WHILE INDEXPOS > 0 AND INDEXPOS <= JSTR.LENGTH DOş    C=JSTR[INDEXPOS,1]ş    IF NUM(C) OR C="+" OR C="-" OR C="." OR C="E" OR C="e" THENş        PARSESTRING:=Cş        INDEXPOS+=1ş    END ELSEş        EXITş    ENDşREPEATşCALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)şC=JSTR[INDEXPOS,1]şIF INDEX(",]}",C,1)=0 THENş    * invalid terminator - not a numberş    PARSESTRING=""ş    INDEXPOS=SAVE.INDEXPOSşENDşRETURNşEND000419WOBJ.PARSEş0c2SUBROUTINE WOBJ.PARSE(JSTR,JSONOBJECTRETURN)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: parse json string into objectş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şPSERRORS=""şMAT JSONOBJECT=""şJSONOBJECTRETURN=""ş*şINDEXPOS=1şCALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)şC=JSTR[INDEXPOS,1]şIF C # "{" THENş    IF C # "" THENş        PSERRORS<-1>="Leading brace for JSON object missing"ş    ENDş    RETURNşENDş*şCALL WOBJ.PARSEOBJECT(JSTR,INDEXPOS,PARSERESULT)şIF PARSERESULT="" THENş    IF PSERRORS="" THEN PSERRORS<-1>="Parse failure"şEND ELSEş    * MAKE SURE WE CONSUMED ENTIRE JSTRş    CALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)ş    IF INDEXPOS <= LEN(JSTR) THENş        PSERRORS<-1>="Extra data (":(LEN(JSTR)-INDEXPOS+1):" characters) after final close brace ignored"ş    ENDşENDş*şMATBUILD JSONOBJECTRETURN FROM JSONOBJECTş*şRETURNşEND000A0FWOBJ.PARSEARRAYş0c2SUBROUTINE WOBJ.PARSEARRAY(JSTR,INDEXPOS,PARSEARRAY)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: parse json arrayş*ş**********************************************************************ş*şINCLUDE WOBJ.INCLUDEş*şPARSEVARRAY=""şIF WOBJ.DEBUG THEN PRINT "PARSEARRAY - STARTING"ş*şCALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)ş*şIF JSTR[INDEXPOS,1] <> "[" THENş    PSERRORS<-1>="Invalid Array at position ":INDEXPOS:" : ":JSTR[INDEXPOS,20]ş    RETURNşENDş*şLEN.JSTR = LEN(JSTR)şINDEXPOS+=1ş*şJSONOBJECT(JSONOBJECT$NODECNTR)+=1şNODEID=JSONOBJECT(JSONOBJECT$NODECNTR)şJSONOBJECT(JSONOBJECT$NODETYPE)<1,NODEID>="A"; *SET AS OBJECTş*şLOOPş    CALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)ş    C=JSTR[INDEXPOS,1]ş    IF WOBJ.DEBUG THEN PRINT "PARSEARRAY: ":NODEID:" - LOOKING AT ":Cş    BEGIN CASEş        CASE C = "]"ş            IF WOBJ.DEBUG THEN PRINT "PARSEARRAY: ":NODEID:" EXIT ON ]"ş            INDEXPOS+=1ş            EXITş        CASE C = ","ş            INDEXPOS+=1ş            CALL WOBJ.SKIPCHAR(JSTR,INDEXPOS)ş        CASE INDEXPOS > LEN.JSTRş            PSERRORS<-1>="Missing ']': ":JSTR[LEN(JSTR)-20,20]ş            RETURNş    END CASEş    *ş    CALL WOBJ.PARSEVALUE(JSTR,INDEXPOS,PARSEVALUE)ş    *ş    JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEID>+=1ş    PARTPOS=JSONOBJECT(JSONOBJECT$NODELENGTH)<1,NODEID>ş    BEGIN CASEş        CASE PARSEVALUE=""ş            PSERRORS<-1>="Invalid value syntax for array element ":(PARTPOS-1)ş            IF WOBJ.DEBUG THEN PRINT "PARSEARRAY ":NODEID:" invalid value syntax"ş            RETURNş        CASE PARSEVALUE<1>="A" OR PARSEVALUE<1>="O"ş            * ARRAY OR OBJECTş            JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,NODEID,PARTPOS>=PARSEVALUE<1>ş            JSONOBJECT(JSONOBJECT$NODEPARTS.FLINK)<1,NODEID,PARTPOS>=PARSEVALUE<2>ş        CASE 1ş            JSONOBJECT(JSONOBJECT$NODEPARTS.TYPE)<1,NODEID,PARTPOS>=PARSEVALUE<1>ş            V=PARSEVALUE<2>ş            IF INDEX(V,LF,1) OR INDEX(V,CR,1) THENş                V=OCONV(V,"MX0C")ş                E="H"ş            END ELSEş                E="A"ş            ENDş            JSONOBJECT(JSONOBJECT$NODEPARTS.VALUE)<1,NODEID,PARTPOS>=Vş            JSONOBJECT(JSONOBJECT$NODEPARTS.ENCODING)<1,NODEID,PARTPOS>=Eş    END CASEş    IF WOBJ.DEBUG THEN PRINT "PARSEARRAY ":NODEID:" ":PARSEVALUE<1>:" ":PARSEVALUE<2>şREPEATşPARSEARRAY="A"şPARSEARRAY<2>=NODEIDşIF WOBJ.DEBUG THEN PRINT "PARSEARRAY - EXITING"şRETURNşENDş000165DICT_PORTAL.ARş0c000002BINVOICE.AMTş0c1Aş6şInvoice.AmtşşşşMD2şşRş13000025DUE.DATEş0c1Aş20şDue.DateşşşşD2-şşRş8000024BALANCEş0c1Aş50şBalanceşşşşMD2şşRş13000029DATES.PAIDş0c1Aş8şCheckıDatesşşşşD2-şşRş800001APIPEş0c1Aş0ş şşşşşF;C|şLş100001ACUSTş0c1Aş1şCustşşşşşşLş2500001EBIG.CUSTş0c1Aş1şCustşşşşşşLş40000034CUST.NAMEş0c1Aş1şCust.NameşşşşşTPORTAL.AR;X;1;1şLş25000A7FMVDB.WIDGETSş0c0000025AdminConfigş0c2SUB.ADMIN.CONFIGşADMIN000025Code Templatesş0c2SUB.CODE.TEMPLATESş000014D3 Freeş0c2SUB.FREEş00001CD3 LISTPEQSş0c2SUB.LISTPEQSş000016D3 LISTUş0c2SUB.LISTUş000028D3 Runtime Errorsş0c2SUB.RUNTIME.ERRORSş000024D3 Sys Err Chartş0c2SUB.SYS.ERR.BARş000021D3 System Errorsş0c2SUB.SYS.ERRSş00002DDashboard License Usageş0c2SUB.TABLE.LIC.USED000038DEMO ANNUAL SALES BY REPş0c2SUB.DEMO.ANNUAL.SALES.BY.REP000035DEMO AVERAGE DAYS CHARTş0c2SUB.DEMO.DAYS.TO.PAY.CHART000030DEMO DAYS TO PAY PIEş0c2SUB.DEMO.DAYS.TO.PAY.PIE00004BDEMO FINANCIAL PICTUREş0c2DEMO.FINANCIALS.DASHBOARDşşDemo Financial Picture00003ADEMO MONTHLY SALES BY REPş0c2SUB.DEMO.MONTHLY.SALES.BY.REP000032DEMO NET INCOME CHARTş0c2SUB.DEMO.NET.INCOME.CHART000036DEMO REV.GP SALES CHARTş0c2SUB.DEMO.REV.GP.SALES.CHART00002EDEMO SALE TYPES PIEş0c2SUB.DEMO.SALE.TYPES.PIE000028DEMO SALES CHARTş0c2SUB.DEMO.SALES.CHART00002EDEMO SALES PERCENTSş0c2SUB.DEMO.SALES.PERCENTS000044DEMO SINGLE MONTH SALES BY REPş0c2SUB.DEMO.SINGLE.MONTH.SALES.BY.REP000020Demo- MS Colş0c2SUB.DEMO.MS.COLş00001FDemo-Doughnutş0c2SUB.DEMO.DNUTş000019Demo-Pieş0c2SUB.DEMO.PIEş00001EDemo-SS Colş0c2SUB.DEMO.SS.COL000021Demo-SS Lineş0c2SUB.DEMO.SS.LINEş000025Drilldown Demoş0c2SUB.DEMO.DRILLDOWNş000024Emailed Reportş0c2SUB.EMAILED.REPORT00001EGRID TESTş0c2SUB.GRID.TESTşSAI000021Icon Galleryş0c2SUB.ICON.GALLERYş000022Mobile Managerş0c2SUB.MOBILE.APPSş000026MW CodeFactoryş0c2SUB.MW.CODE.FACTORYş000021PDFConfigş0c2SUB.PDF.CONFIGşADMIN000028QM Runtime Errorsş0c2SUB.RUNTIME.ERRORSş00001BRSS Feedsş0c2SUB.RSS.FEEDSş000028SC-Lines By Lib (Pie)ş0c2SUB.SC.LIB.PIEş000023SC-Lines By Progş0c2SUB.SC.LIB.COLş000028SC-Progs by Lib (Pie)ş0c2SUB.SC.LIB.PIEş00001BShow Varsş0c2SUB.SHOW.VARSş000021Source Viewerş0c2SUB.SOURCE.VIEWş000025System - Sessionş0c2SUB.SHOW.SESSIONş000028PORTAL DASHBOARDş0c2SUB.PORTAL.DASHBOARD000030PORTAL SALES REPORTSş0c2SUB.PORTAL.SALES.REPORTS000034PORTAL AR REPORT SETUPş0c2SUB.PORTAL.AR.REPORT.SETUP00002APORTAL AR REPORTSş0c2SUB.PORTAL.AR.REPORTS00002APORTAL AP REPORTSş0c2SUB.PORTAL.AP.REPORTS000034PORTAL AP REPORT SETUPş0c2SUB.PORTAL.AP.REPORT.SETUP000024PORTAL MARGINSş0c2SUB.PORTAL.MARGINS00003APORTAL SALES REPORT SETUPş0c2SUB.PORTAL.SALES.REPORT.SETUP000040DISPLAY PORTAL AP BALANCE PIE CHARTş0c2SUB.PORTAL.AP.BALANCE.PIE000040DISPLAY PORTAL AR BALANCE PIE CHARTş0c2SUB.PORTAL.AR.BALANCE.PIE000034PORTAL DAYS TO PAY PIEş0c2SUB.PORTAL.DAYS.TO.PAY.PIE00003CPORTAL SETUP DOCUMENTATIONş0c2SUB.PORTAL.SETUP.DOCUMENTATION000030PORTAL.DOCUMENTATIONş0c2SUB.PORTAL.DOCUMENTATION000040PORTAL.REPORTS.DOCUMENTATIONş0c2SUB.PORTAL.REPORTS.DOCUMENTATION000038PORTAL.RUN.DOCUMENTATIONş0c2SUB.PORTAL.RUN.DOCUMENTATION014090MVDBTOOLKIT.BPş0c0002F51MVDBTOOLKIT.TESTş0c2PRINT @(-1):"MVDBTOOLKIT.TEST"şPRINTşşINCLUDE MVDBTOOLKIT.TEST.INCLUDEşşINCLUDE MVDBTOOLKIT.WOBJ.CHOOSE.WOBJşşTEST.PLATFORM=FIELD(CMND,' ',2)şTEST.MVTYPE=FIELD(CMND,' ',3)şşCALL MVDBTOOLKIT.WPLATFORM(PLATFORM.OBJ)şşIF TEST.PLATFORM = "" THENş   CALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","platform",TEST.PLATFORM,"",RERR)şENDşIF TEST.MVTYPE = "" THENş   CALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","mvtype",TEST.MVTYPE,"",RERR)şENDşşIF TEST.PLATFORM = "" THENş   PRINT "Enter Platform: ":; INPUT TEST.PLATFORMşENDşşIF TEST.MVTYPE = "" THENş   PRINT "Enter MVType: ":; INPUT TEST.MVTYPEşENDşşIF TEST.PLATFORM='' OR TEST.MVTYPE='' THENş    PRINT "Usage: MVDBTOOLKIT PLATFORM MVTYPE"ş    PRINTş    PRINT "PLATFORM=WINDOWS or LINUX"ş    PRINT "MVTYPE=JBASE,D3,UNIVERSE,UNIDATA"ş    STOPşENDşş* GET ENVIRONMENTşCALL MVDBTOOLKIT.WPLATFORM(PLATFORM.OBJ)şşCALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","curllocation",CURLLOCATION,"",RERR)şşCALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","platform",PLATFORM,"",RERR)şTEST='platform'; GOSUB start.testşTEST.MSG=PLATFORM:"=":TEST.PLATFORMşIF PLATFORM # TEST.PLATFORM THEN TEST.STATUS=0 ELSE TEST.STATUS=1şGOSUB end.testşşCALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","mvtype",RESULT,"",RERR)şşşTEST='mvtype'; GOSUB start.testşTEST.MSG=RESULT:"=":TEST.MVTYPEşIF RESULT # TEST.MVTYPE THEN TEST.STATUS=0 ELSE TEST.STATUS=1şGOSUB end.testşCALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","tmpdir",TMP.DIR,"",RERR)şCALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","filedelim",FILEDELIM,"",RERR)şşTEST='filedelim'; GOSUB start.testşCALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","filedelim",FILEDELIM,"",RERR)şTEST.MSG=FILEDELIMşTEST.STATUS=1şBEGIN CASEş   CASE OCONV(PLATFORM,"MCU") = "LINUX" AND FILEDELIM="/"ş   CASE OCONV(PLATFORM,"MCU") = "WINDOWS" AND FILEDELIM="\"ş   CASE 1; TEST.STATUS=0şEND CASEşGOSUB end.testşşTEST='tmpdir'; GOSUB start.testşCALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","tmpdir",TMP.DIR,"",RERR)şTEST.MSG=TMP.DIRşTEST.STATUS=1şIF TMP.DIR="" THEN TEST.STATUS=0şGOSUB end.testşşşTEST='MVDBTOOLKIT.SWAP'şGOSUB start.testşS='TEST LINE TEST LINE'şORIG.STRING=SşCALL MVDBTOOLKIT.SWAP(S,"ES","XX")şIF S = "TXXT LINE TXXT LINE" THEN TEST.STATUS=1 ELSE TEST.STATUS=0şTEST.MSG=SşGOSUB end.testşş* Test 1 GetenvşşTEST="getenv"şGOSUB start.testşCALL MVDBTOOLKIT.WGETENV("PATH",PATH)şIF PATH # "" THENş    TEST.MSG=PATH[1,60]ş    TEST.STATUS=1şEND ELSEş    TEST.MSG=""ş    TEST.STATUS=0şENDşGOSUB end.testşş* Test WEXECUTEşşTEST="wexecute"; GOSUB start.testşCMND='echo MVDBTOOLKIT.TEST'şşCALL @WOBJ.RTNE(COBJ,"FROMSTRING","","{}","",RERR)şCALL @WOBJ.RTNE(COBJ,"SET","command",CMND,"",RERR)şCALL MVDBTOOLKIT.WEXECUTE(COBJ)şCALL @WOBJ.RTNE(COBJ,"GET","result.result",CMND.RESULT,"",RERR)şşIF INDEX(CMND.RESULT,"MVDBTOOLKIT.TEST",1) THENş    TEST.MSG=CMND.RESULTş    TEST.STATUS=1şEND ELSEş    TEST.MSG=CMND.RESULTş    TEST.STATUS=0şENDşCONVERT CHAR(13):CHAR(10) TO '' IN TEST.MSGşGOSUB end.testşş* Test WFILEIOşşTEST="WFILEIO-WRITE"şşUSER.NO=FIELD(OCONV('','U50BB'),' ',1)şGOSUB start.testşCALL @WOBJ.RTNE(FOBJ,"FROMSTRING","","{}","",RERR)şCALL @WOBJ.RTNE(FOBJ,"SET","action","WRITE","",RERR)şTMP.FILE.NAME=TMP.DIR:FILEDELIM:'TMP-':USER.NO:'.txt'şTEST.MSG=TMP.FILE.NAMEşşCALL @WOBJ.RTNE(FOBJ,"SET","path",TMP.FILE.NAME,"",RERR)şSAVE.FOBJ=FOBJşTMP.DATA=TIMEDATE()şCALL @WOBJ.RTNE(FOBJ,"SET","data",TMP.DATA,"",RERR)şCALL MVDBTOOLKIT.WFILEIO(FOBJ)şCALL @WOBJ.RTNE(FOBJ,"GET","response.status",RESPONSE.STATUS,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","response.statusmsg",RESPONSE.STATUS.MSG,"",RERR)şTEST.STATUS=RESPONSE.STATUSşIF NOT(RESPONSE.STATUS) THEN TEST.MSG:=RESPONSE.STATUS.MSGşGOSUB end.testşşIF NOT(TEST.STATUS) THEN STOP "Test Failed, no reason to continue"şşTEST='WFILEIO-READ'şGOSUB start.testşş* NOW READ IT BACK INşCALL @WOBJ.RTNE(FOBJ,"SET","action","READ","",RERR)şCALL MVDBTOOLKIT.WFILEIO(FOBJ)şCALL @WOBJ.RTNE(FOBJ,"GET","response.data",RESPONSE.DATA,"",RERR)şşTEST.MSG="(":TMP.DATA:')=(':RESPONSE.DATA:")"şTEST.STATUS=1şIF TMP.DATA # RESPONSE.DATA THEN TEST.STATUS=0şGOSUB end.testşşTEST="WFILEIO-DELETE"; GOSUB start.testşFOBJ=SAVE.FOBJşCALL @WOBJ.RTNE(FOBJ,"SET","action","DELETE","",RERR)şCALL MVDBTOOLKIT.WFILEIO(FOBJ)şşFOBJ=SAVE.FOBJşCALL @WOBJ.RTNE(FOBJ,"SET","action","READ","",RERR)şCALL MVDBTOOLKIT.WFILEIO(FOBJ)şRESPONSE.DATA=""şşCALL @WOBJ.RTNE(FOBJ,"GET","response.data",RESPONSE.DATA,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","response.status",RESPONSE.STATUS,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","response.statusmsg",RESPONSE.STATUSMSG,"",RERR)şTEST.STATUS=1şTEST.MSG=TMP.FILE.NAME:' ':RESPONSE.STATUSşIF RESPONSE.STATUS=0 AND RESPONSE.DATA="" THEN NULL ELSE TEST.STATUS=0şGOSUB end.testşş* Let get our current directoryşTEST="pwd"; GOSUB start.testşIF OCONV(PLATFORM,"MCU") = "WINDOWS" THENş   CMND='echo %CD%'şEND ELSEş   CMND='pwd'şENDşşCALL @WOBJ.RTNE(COBJ,"FROMSTRING","","{}","",RERR)şCALL @WOBJ.RTNE(COBJ,"SET","command",CMND,"",RERR)şCALL MVDBTOOLKIT.WEXECUTE(COBJ)şCALL @WOBJ.RTNE(COBJ,"GET","result.result",CMND.RESULT,"",RERR)şşIF 1 THENş    TEST.MSG=CMND.RESULTş    TEST.STATUS=1şEND ELSEş    TEST.MSG=CMND.RESULTş    TEST.STATUS=0şENDşCONVERT CHAR(13):CHAR(10) TO '' IN TEST.MSGşGOSUB end.testşşMVDBTOOLKIT.LOCATION = CMND.RESULTşşIF 0 THENş* Lets verify we have curl!!!şIF CURLLOCATION="" THEN CURLLOCATION="curl"şşTEST="default curl"; GOSUB start.testşCMND=CURLLOCATION:' -V'şşCALL @WOBJ.RTNE(COBJ,"FROMSTRING","","{}","",RERR)şCALL @WOBJ.RTNE(COBJ,"SET","command",CMND,"",RERR)şCALL MVDBTOOLKIT.WEXECUTE(COBJ)şCALL @WOBJ.RTNE(COBJ,"GET","result.result",CMND.RESULT,"",RERR)şşBEGIN CASEş   CASE INDEX(CMND.RESULT,"libcurl",1) AND 0ş    TEST.MSG=CMND.RESULTş    TEST.STATUS=1ş   CASE OCONV(PLATFORM,"MCU")="WINDOWS"ş    TEST.MSG=CMND.RESULTş    TEST.STATUS=2ş   CASE 1ş    TEST.MSG=0şEND CASEşşCONVERT CHAR(13):CHAR(10) TO '' IN TEST.MSGşGOSUB end.testşş* Start looking for curlşIF TEST.STATUS=2 THENş   CURLLOCATION="c:\progra~1\git\mingw64\bin\curl.exe"ş   TEST="git curl"; GOSUB start.testş   CMND=CURLLOCATION:' -V'şş   CALL @WOBJ.RTNE(COBJ,"FROMSTRING","","{}","",RERR)ş   CALL @WOBJ.RTNE(COBJ,"SET","command",CMND,"",RERR)ş   CALL MVDBTOOLKIT.WEXECUTE(COBJ)ş   CALL @WOBJ.RTNE(COBJ,"GET","result.result",CMND.RESULT,"",RERR)şş   BEGIN CASEş      CASE INDEX(CMND.RESULT,"libcurl",1) AND 0ş         TEST.MSG=CMND.RESULTş         TEST.STATUS=1ş      CASE OCONV(PLATFORM,"MCU")="WINDOWS"ş         TEST.MSG=CMND.RESULTş         TEST.STATUS=2ş      CASE 1ş         TEST.MSG=CMND.RESULTş         TEST.STATUS=0ş   END CASEşş   CONVERT CHAR(13):CHAR(10) TO '' IN TEST.MSGş   GOSUB end.testşENDşşIF TEST.STATUS=2 THENş   CURLLOCATION=MVDBTOOLKIT.LOCATION:"\mvdbtoolkit\curl\windows64\curl.exe"ş   TEST="mvdbtoolkit curl"; GOSUB start.testş   CMND=CURLLOCATION:' -V'şş   CALL @WOBJ.RTNE(COBJ,"FROMSTRING","","{}","",RERR)ş   CALL @WOBJ.RTNE(COBJ,"SET","command",CMND,"",RERR)ş   CALL MVDBTOOLKIT.WEXECUTE(COBJ)ş   CALL @WOBJ.RTNE(COBJ,"GET","result.result",CMND.RESULT,"",RERR)şş   BEGIN CASEş      CASE INDEX(CMND.RESULT,"libcurl",1) AND 0ş         TEST.MSG=CMND.RESULTş         TEST.STATUS=1ş       CASE 1ş         TEST.STATUS=0ş         TEST.MSG=CMNDşş   END CASEşş   CONVERT CHAR(13):CHAR(10) TO '' IN TEST.MSGş   GOSUB end.testşENDşENDşşTEST="WCALL"şGOSUB start.testşşCALL @WOBJ.RTNE(OBJ,"FROMSTRING","","{}","",RERR)şş CALL @WOBJ.RTNE(OBJ,"SET","method","POST","",RERR)ş CALL @WOBJ.RTNE(OBJ,"SET","debug","N","",RERR)ş CALL @WOBJ.RTNE(OBJ,"SET","url","https://httpbin.org/anything?field1=value1","",RERR)ş CALL @WOBJ.RTNE(OBJ,"SET","insecure","Y","",RERR)ş ş CALL @WOBJ.RTNE(OBJ,"SET.OBJECT","headers","{}","",RERR)ş CALL @WOBJ.RTNE(OBJ,"SET","headers.X-TEST-HEADER","headertest","",RERR)ş ş CALL @WOBJ.RTNE(OBJ,"SET.ARRAY","formfields","[]","",RERR)ş CALL @WOBJ.RTNE(OBJ,"SET.OBJECT","formfields[-1]","{}","",RERR)ş CALL @WOBJ.RTNE(OBJ,"SET","formfields[0].name","field2","",RERR)ş CALL @WOBJ.RTNE(OBJ,"SET","formfields[0].value","VALUE2$","",RERR)şş CALL @WOBJ.RTNE(SOBJ,"FROMSTRING","","{}","",RERR)ş CALL @WOBJ.RTNE(SOBJ,"SET","name","field3","",RERR)ş CALL @WOBJ.RTNE(SOBJ,"SET","value","<EXAMPLE HTML>","",RERR)ş CALL @WOBJ.RTNE(SOBJ,"TOSTRING","",SJSON,"",RERR)ş CALL @WOBJ.RTNE(OBJ,"SET.OBJECT","formfields[-1]",SJSON,"",RERR)şş CALL MVDBTOOLKIT.WCALL(OBJ)şş CALL @WOBJ.RTNE(OBJ,"GET","response.data",RESPONSE,"",RERR)ş OPEN "MVDBTOOLKIT.BP" TO FILE ELSE STOPş *PRINT "RESPONSE=":RESPONSEş* WRITE RESPONSE ON FILE, "MVDBTOOLKIT.TEST.JSON"ş CALL @WOBJ.RTNE(OBJ,"TOSTRING","",OUT.JSON,"PRETTIFY",RERR)ş* WRITE OUT.JSON ON FILE, "MVDBTOOLKIT.WCALL.JSON"şş ş CALL @WOBJ.RTNE(OBJ,"GET","response.status",RESPONSE.STATUS,"",RERR)ş *PRINT 'RESPONSE.STATUS=':RESPONSE.STATUS:'  ':ş *IF RESPONSE.STATUS="200" THEN PRINT "OK" ELSE PRINT "FAIL"ş TEST.MSG=RESPONSE.STATUSş IF RESPONSE.STATUS="200" THENş    TEST.STATUS=1ş END ELSEş    TEST.STATUS=0ş ENDş GOSUB end.testşş TEST='WCALL.HTTPTYPE'ş GOSUB start.testş CALL @WOBJ.RTNE(OBJ,"GET","response.http_type",RESPONSE.HTTP.TYPE,"",RERR)ş *PRINT 'RESPONSE.HTTP_TYPE=':RESPONSE.HTTP.TYPEş TEST.MSG=RESPONSE.HTTP.TYPEş IF INDEX(TEST.MSG,'HTTP/',1) THENş    TEST.STATUS=1ş END ELSEş    TEST.STATUS=0ş ENDş GOSUB end.testş CALL @WOBJ.RTNE(ROBJ,"FROMSTRING","",RESPONSE,"",RERR)şş TEST="WCALL.FIELD1"ş GOSUB start.testş CALL @WOBJ.RTNE(ROBJ,"GET","args.field1",VALUE,"",RERR)ş TEST.MSG=VALUEş IF TEST.MSG="value1" THEN TEST.STATUS=1 ELSE TEST.STATUS=0ş GOSUB end.testşşşTEST="WCALL.field2"ş GOSUB start.testş CALL @WOBJ.RTNE(ROBJ,"GET","form.field2",VALUE,"",RERR)ş TEST.MSG=VALUEş IF TEST.MSG="VALUE2$" THEN TEST.STATUS=1 ELSE TEST.STATUS=0ş GOSUB end.testşşTEST="WCALL.field3"ş GOSUB start.testş CALL @WOBJ.RTNE(ROBJ,"GET","form.field3",VALUE,"",RERR)ş TEST.MSG=VALUEş IF TEST.MSG="<EXAMPLE HTML>" THEN TEST.STATUS=1 ELSE TEST.STATUS=0ş GOSUB end.testşşş TEST="WCALL.HEADER"ş GOSUB start.testş CALL @WOBJ.RTNE(ROBJ,"GET","headers.X-Test-Header",VALUE,"",RERR)ş TEST.MSG=VALUEş IF TEST.MSG="headertest" THEN TEST.STATUS=1 ELSE TEST.STATUS=0ş GOSUB end.testşşTEST="WCALL.BODY"şGOSUB start.testşş CALL @WOBJ.RTNE(OBJ,"FROMSTRING","","{}","",RERR)ş CALL @WOBJ.RTNE(OBJ,"SET","method","POST","",RERR)ş CALL @WOBJ.RTNE(OBJ,"SET","debug","N","",RERR)ş CALL @WOBJ.RTNE(OBJ,"SET","url","https://httpbin.org/anything?field1=value1","",RERR)ş CALL @WOBJ.RTNE(OBJ,"SET","insecure","N","",RERR)şş CALL @WOBJ.RTNE(OBJ,"SET.OBJECT","headers","{}","",RERR)ş CALL @WOBJ.RTNE(OBJ,"SET","Content-Type","application/json","",RERR)ş ş CALL @WOBJ.RTNE(TESTOBJ,"FROMSTRING","","{}","",RERR)ş CALL @WOBJ.RTNE(TESTOBJ,"SET","test","value","",RERR)ş CALL @WOBJ.RTNE(TESTOBJ,"TOSTRING","",TESTJSON,"PRETTIFY",RERR)şş CALL @WOBJ.RTNE(OBJ,"SET.STRING","body",TESTJSON,"",RERR)ş ş CALL MVDBTOOLKIT.WCALL(OBJ)şş CALL @WOBJ.RTNE(OBJ,"GET","response.data",RESPONSE,"",RERR)ş ş* WRITE RESPONSE ON FILE, "MVDBTOOLKIT.TESTBODY.JSON"ş CALL @WOBJ.RTNE(OBJ,"TOSTRING","",OUT.JSON,"PRETTIFY",RERR)ş* WRITE OUT.JSON ON FILE, "MVDBTOOLKIT.WCALLBODY.JSON"şşş CALL @WOBJ.RTNE(OBJ,"GET","response.status",RESPONSE.STATUS,"",RERR)ş *PRINT 'RESPONSE.STATUS=':RESPONSE.STATUS:'  ':ş *IF RESPONSE.STATUS="200" THEN PRINT "OK" ELSE PRINT "FAIL"ş TEST.MSG=RESPONSE.STATUSş IF RESPONSE.STATUS="200" THENş    TEST.STATUS=1ş END ELSEş    TEST.STATUS=0ş ENDş GOSUB end.testşş TEST="WCALL.BODY.RESULT"ş GOSUB start.testş * The testing web site does not send raw body back very wellş * we will just look for what we expectş CONVERT CHAR(254):CHAR(253):CHAR(252):CHAR(10):CHAR(13) TO '' IN RESPONSEş POS=INDEX(RESPONSE,'"form"',1)ş IF POS THEN RESPONSE=RESPONSE[POS,9999]ş TEST.MSG=RESPONSEş IF INDEX(RESPONSE,'"test',1) AND INDEX(RESPONSE,'"value',1) THENş     TEST.STATUS=1ş END ELSEş     TEST.STATUS=0ş ENDş GOSUB end.testş şSTOPş*şGOSUB start.testşRETURNş*şprocess.error: *şIF RERR<1> THENş   TEST.STATUS=-1ş   TEST.MSG=RERR<1>şENDşRETURNş*ş*şstart.test: *şTEST.STATUS=0şTEST.MSG="Success"şPRINT "":TEST[1,15]"L(#15)":şRETURNş*şend.test: *şPRINT "  ":TEST.MSG[1,50]"L(#50)":şPRINT " ":şPRE=''; AFT=''şBEGIN CASEş   CASE TEST.STATUS=2; ERROR="Warning"; PRE=''; AFT=''ş   CASE TEST.STATUS; ERROR="Passed"ş   CASE 1; ERROR="Passed"; PRE=@(-13); AFT=@(-14)şEND CASEşPRINT PRE:"[":şPRINT ERROR"L(#7)":şPRINT "]":AFTşRETURNşşş 00131FMVDBTOOLKIT.WFILEIOş0c2SUBROUTINE MVDBTOOLKIT.WFILEIO(INOBJ)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: June 7th 2018ş* Description: WFILEIO MULTI PLATFORM WORKING WITH O/S FILESş*ş**********************************************************************ş*ş* INOBJş*ş* { "ACTION":"READ,WRITE,DELETE",ş*   "PATH":"PATH TO THE FILE",ş*   "DATA":"DATA FOR A WRITE",ş*   "dosletter":"OPTIONAL DOS LETTER TO ADD TO PATH",ş*   "NEWLINE":"CR,LF,CRLF,DOS,UNIX",ş*   "PERMISSIONS":"TBD"ş*   "response": {ş*       "data":"responsedata",ş*       "status":1-ok, else no,ş*       "statusmsg":"statusmsg" ş*   }ş* }ş*ş* need to know the existing platformşş*PLATFORM.DELIM="\"ş*PLATFORM.TYPE="WINDOWS"ş*PLATFORM.MV="D3"şşCALL MVDBTOOLKIT.WPLATFORM(POBJ)şşINCLUDE MVDBTOOLKIT.WOBJ.CHOOSE.WOBJşşCALL @WOBJ.RTNE(POBJ,"GET","mvtype",PLATFORM.MV,"",RERR)şCALL @WOBJ.RTNE(POBJ,"GET","filedelim",PLATFORM.DELIM,"",RERR)şCALL @WOBJ.RTNE(POBJ,"GET","platform",PLATFORM.TYPE,"",RERR)şşFSTATUS=1şFSTATUSMSG="OK"şşCALL @WOBJ.RTNE(INOBJ,"GET","action",FILEIO.ACTION,"",RERR)şCALL @WOBJ.RTNE(INOBJ,"GET","path",FILEIO.PATH,"",RERR)şCALL @WOBJ.RTNE(INOBJ,"GET","data",FILEIO.DATA,"",RERR)şCALL @WOBJ.RTNE(INOBJ,"GET","dosletter",FILEIO.DOSLETTER,"",RERR)şCALL @WOBJ.RTNE(INOBJ,"GET","newline",FILEIO.NEWLINE,"",RERR)şCALL @WOBJ.RTNE(INOBJ,"GET","permissions",FILEIO.PERMISSIONS,"",RERR)şş*CALL @WOBJ.RTNE(OUTOBJ,"FROMSTRING","","{}","",RERR)şCALL @WOBJ.RTNE(INOBJ,"SET.OBJECT","response","{}","",RERR)şşFILEIO.ACTION=OCONV(FILEIO.ACTION,"MCU")şFILEIO.NEWLINE=OCONV(FILEIO.NEWLINE,"MCU")şşIF FILEIO.ACTION = "" THENş    FSTATUS=0ş    FSTATUSMSG="No action defined"ş    GOTO end.of.runşENDşşIF FILEIO.PATH = "" THENş    FSTATUS=0ş    FSTATUSMSG="No path defined"ş    GOTO end.of.runşENDşşPARSED.FILEIO.PATH=""şL=LEN(FILEIO.PATH)şFOR X=1 TO Lş   C=FILEIO.PATH[X,1]ş   IF C=PLATFORM.DELIM THENş      PARSED.FILEIO.PATH:=@AMş   END ELSEş      PARSED.FILEIO.PATH:=Cş   ENDşNEXT Xşş*PARSED.FILEIO.PATH=EXCHANGE(FILEIO.PATH,PLATFORM.DELIM,@AM)şPARSED.FILEIO.PATH=FILEIO.PATHşCONVERT PLATFORM.DELIM TO @AM IN PARSED.FILEIO.PATHşPARSED.FILEIO.PARTS=DCOUNT(PARSED.FILEIO.PATH,@AM)şş* JBASE DOES NOT APPEAR TO HONOR WINDOWS ENVIROMENT VARIABLES IN THE OPENş* THIS IS MAKING %USERPROFILE% NOT WORKş*ş* WE ARE GOING TO LOOP THRU THE THE PARTS AN EXPAND THEM OURSELVESş*ş* THIS HAS BEEN TESTED ON JBASE WINDOWS SO FAR.ş*şFOR P=1 TO PARSED.FILEIO.PARTSş    THIS.PART=PARSED.FILEIO.PATH<P>ş    IF THIS.PART[1,1]='%' OR THIS.PART[1,1]="$" THENş        CONVERT '%$' TO '' IN THIS.PARTş * 9/4/2019 PAP Modified this to use mvdbtoolkit.wgetenvş ş *       IF GETENV(THIS.PART,NEW.THIS.PART) THENş *           PARSED.FILEIO.PATH<P>=NEW.THIS.PARTş *       ENDş         CALL MVDBTOOLKIT.WGETENV(THIS.PART,NEW.THIS.PART)ş         IF NEW.THIS.PART # "" THEN PARSED.FILEIO.PATH<P>=NEW.THIS.PARTş    ENDşNEXT PşşşPARSED.FILEIO.FILE.NAME=PARSED.FILEIO.PATH<PARSED.FILEIO.PARTS>şFILEIO.JUST.PATH=DELETE(PARSED.FILEIO.PATH,PARSED.FILEIO.PARTS)ş*FILEIO.JUST.PATH=EXCHANGE(FILEIO.JUST.PATH,@AM,PLATFORM.DELIM)şşCONVERT @AM TO PLATFORM.DELIM IN FILEIO.JUST.PATHşşşCALL @WOBJ.RTNE(INOBJ,"SET.OBJECT","work","{}","",RERR)şCALL @WOBJ.RTNE(INOBJ,"SET","work.parsed_fileio_file_name",PARSED.FILEIO.FILE.NAME,"",RERR)şşCALL @WOBJ.RTNE(INOBJ,"SET","work.fileio_just_path",FILEIO.JUST.PATH,"",RERR)şCALL @WOBJ.RTNE(INOBJ,"SET","work.platform",PLATFORM.TYPE,"",RERR)şCALL @WOBJ.RTNE(INOBJ,"SET","work.mvtype",PLATFORM.MV,"",RERR)şCALL @WOBJ.RTNE(INOBJ,"SET","work.filedelim",PLATFORM.DELIM,"",RERR)şşCALL @WOBJ.RTNE(INOBJ,"SET.OBJECT","response","{}","",RERR)ş* lets have a seperate routine for each platformşşBEGIN CASEş    CASE FILEIO.ACTION="READ"ş    CASE FILEIO.ACTION="WRITE"ş    CASE FILEIO.ACTION="DELETE"ş    CASE 1ş        FSTATUS=0ş        FSTATUSMSG="Invalid action"ş        CALL @WOBJ.RTNE(INOBJ,"SET.NUMBER", "response.status", FSTATUS,"",RERR)ş        CALL @WOBJ.RTNE(INOBJ,"SET.STRING", "response.statusmsg", FSTATUSMSG, "", RERR)ş        GOTO end.of.runşEND CASEşşBEGIN CASEş    CASE PLATFORM.MV="D3"ş        FILEIO.RTNE="MVDBTOOLKIT.WFILEIO.D3"ş        CALL MVDBTOOLKIT.WFILEIO.D3(INOBJ)ş    CASE PLATFORM.MV="JBASE"ş        FILEIO.RTNE="MVDBTOOLKIT.W.FILEIO.JBASE"ş        CALL MVDBTOOLKIT.WFILEIO.JBASE(INOBJ)ş    CASE PLATFORM.MV="UNIVERSE"ş        FILEIO.RTNE="MVDBTOOLKIT.WFILEIO.UNIVERSE"ş        CALL MVDBTOOLKIT.WFILEIO.UNIVERSE(INOBJ)ş    CASE PLATFORM.MV="UNIDATA"ş        FILEIO.RTNE="MVDBTOOLKIT.WFILEIO.UNIDATA"ş        CALL MVDBTOOLKIT.WFILEIO.UNIDATA(INOBJ)ş    CASE PLATFORM.MV="QM"ş        * QM SUPPORTS OPENPATHş        CALL MVDBTOOLKIT.WFILEIO.QM(INOBJ)ş   CASE 1ş        DEBUGş        FSTATUS=0ş        FSTATUSMSG="Invalid Platform ":PLATFORM.MVş        GOTO end.of.runşEND CASEşşend.of.run: *şşRETURN002BEFMVDBTOOLKIT.APP.INSTALLERş0c2*ş* Copyright (C) 2009 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Luke Bucklin, Sierra Bravo Corporationş* Date: 07/15/2009ş* Description: Application installerş*ş* Modified By: Dave Bucklin, Nerdery Interactive Labsş* Date: 02/04/2011ş* Description: Add overwrite flag, clashes handling specific to MVDashboardş*ş* Modified By: Mike Street, Zumasysş* Date: 07/17/2015ş* Description: Adapt for UniVerseş*ş*ş    BUFFER = ""ş*ş    INSTALL.LOG.ON = 0ş    INSTALL.LOG.ID = "INSTALL*":DATE():"*":TIME()ş    INSTALL.LOG = ""ş    PROCESS.STATUS = 0ş    OVR.FLAG = 0ş    PROMPT ""ş    PRINT "File path: ":    ş    INPUT PACKAGE.FILEş    IF PACKAGE.FILE = "VERSION" THENş        PRINTş        PRINT "Installer Version"ş        PRINT "1.0"ş        STOPş    ENDş*ş    returnCode = ""ş*ş    OPENSEQ PACKAGE.FILE TO HANDLE ELSEş        PRINT "Unable to open sequential file"ş        STOPş    ENDş*UV   HANDLE = %OPEN(PACKAGE.FILE,O$RDONLY+O$BINARY)ş*UV   IF NOT(HANDLE) THENş*UV       PRINT "Unable to open file." ; STOPş*UV   ENDş*ş    L = 0ş    PACKET = ""ş    LOOP    ş*UV     L = %READ(HANDLE,BUFFER,10000)ş*UVş        READBLK BUFFER FROM HANDLE, 10000 ELSEş   IF PACKET = '' THENş      CRT 'CANT READ BUFFER'ş      STOPş    ENDş   BUFFER=''ş ENDş        L=LEN(BUFFER)ş*END UV*ş    WHILE L > 0 DOş        PACKET := BUFFERş    REPEATş    IF PACKET = "" THENş        PRINT "No package."ş        STOPş    ENDş    INSTALL.ID = TIMEDATE()ş    KEEP.SOURCE = "1"ş*ş    PRINTş    PRINT "Installing..."ş*ş    OPEN '','MV.PACKED.FILE' TO F.PACKED.FILE ELSEş        CMD = "CREATE-FILE MV.PACKED.FILE 1 31"ş        GOSUB EXEC.CMDş        OPEN '','MV.PACKED.FILE' TO F.PACKED.FILE ELSEş            ERRFILE = "MV.PACKED.FILE"ş            GOSUB OPEN.ERRş            STOPş        ENDş    ENDş    WRITE PACKET ON F.PACKED.FILE, "PACKAGE"şş    OPEN '','VOC' TO F.MD ELSEş        ERRFILE = "VOC"ş        GOSUB OPEN.ERRş        STOPş    ENDş    OPEN "MV.INSTALL" TO F.INSTALL ELSEş        CMD = "CREATE-FILE MV.INSTALL 1 11"ş        GOSUB EXEC.CMDş        OPEN "MV.INSTALL" TO F.INSTALL ELSEş            ERRFILE = "MV.INSTALL"ş            GOSUB OPEN.ERRş            STOPş        ENDş    ENDş    OPEN "MV.INSTALL.CF" TO F.INSTALL.CF ELSEş        CMD = "CREATE-FILE MV.INSTALL.CF 1 11"ş        GOSUB EXEC.CMDş        OPEN "MV.INSTALL.CF" TO F.INSTALL.CF ELSEş            ERRFILE = "MV.INSTALL.CF"ş            GOSUB OPEN.ERRş            STOPş        ENDş    ENDş    OPEN "MVAPPS.INSTALLED" TO F.MVAPPS.INSTALLED ELSEş        CMD = "CREATE-FILE MVAPPS.INSTALLED 3 31"ş        GOSUB EXEC.CMDş        OPEN "MVAPPS.INSTALLED" TO F.MVAPPS.INSTALLED ELSEş            ERRFILE = "MVAPPS.INSTALLED"ş            GOSUB OPEN.ERRş            STOPş        ENDş    ENDş    OPEN "DICT","MVDB.CLASHES" TO FD.MVDB.CLASHES ELSEş        CMD = "CREATE-FILE DICT MVDB.CLASHES 3"ş        GOSUB EXEC.CMDş    ENDş    INSTALL.LOG.ON = 1ş*ş    CLEARFILE F.INSTALLş    DELETE F.INSTALL.CF, "MVAPPS-PRE-SCRIPT"      ;* Get rid of this just in case one is left overş    DELETE F.INSTALL.CF, "MVAPPS-POST-SCRIPT"ş    DELETE F.INSTALL.CF, "PACKAGE.INFO"ş    TARGET = F.INSTALLş    TARGET.NAME = "MV.INSTALL"ş    GOSUB UNPACKş* All individual file packages are now in INSTALLş* Unpack the MD scriptsş    READ PACKET FROM F.INSTALL, "MV.INSTALL.CF" THENş        TARGET = F.INSTALL.CFş        TARGET.NAME = "MV.INSTALL.CF"ş        GOSUB UNPACKş        DELETE F.INSTALL, "MV.INSTALL.CF"ş    ENDş*ş* Execute scripts that are required prior to compilationş*ş    READ CMD FROM F.INSTALL.CF, "MVAPPS-PRE-SCRIPT" THENş        LOG.LINE = TIMEDATE():": Processing PRE-INSTALL commands..."ş        INSTALL.LOG<-1> = LOG.LINEş* Execute commands that need to be run before the install process beginsş        GOSUB EXEC.CMDş        LOG.LINE = TIMEDATE():": Completed PRE-INSTALL commands."ş        INSTALL.LOG<-1> = LOG.LINEş    ENDş    READ PACKAGE.INFO FROM F.INSTALL.CF, "PACKAGE.INFO" ELSE PACKAGE.INFO = ""ş    PACKAGE.ID = PACKAGE.INFO<6>ş    PACKAGE.INFO<4> = DATE()ş    PACKAGE.INFO<5> = TIME()ş*ş    SELECT F.INSTALLş    LOOPş        READNEXT PKG.ID ELSE EXITş        IF PKG.ID # "" THENş            READ PACKET FROM F.INSTALL, PKG.ID THENş                TARGET.FILE = FIELD(PKG.ID," ",1)ş                IF TARGET.FILE[1,7] = "BINARY:" THEN TARGET.FILE=TARGET.FILE[8,999]        ;*UVş                DICT.MOD = FIELD( PKG.ID," ",2)ş                DATA.MOD = FIELD( PKG.ID," ",3)ş                DICT = ""ş                IF FIELD( PKG.ID,'_',1 ) = "DICT" THENş                    TARGET.FILE = FIELD( PKG.ID, '_', 2 )ş                    IF TARGET.FILE[1,7] = "BINARY:" THEN TARGET.FILE=TARGET.FILE[8,999]    ;*UVş                    DICT = "DICT"ş                ENDş                OPEN DICT,TARGET.FILE TO F.TARGET ELSEş                    IF NOT(INDEX(TARGET.FILE,':',1)) THENş                        IF DICT.MOD = "" THEN DICT.MOD = 3ş                        IF DATA.MOD = "" THEN DATA.MOD = 31ş                        CMD = "CREATE-FILE ":TARGET.FILE:" ":DICT.MOD:" ":DATA.MODş                        GOSUB EXEC.CMDş                    ENDş                    OPEN DICT,TARGET.FILE TO F.TARGET ELSEş                        PRINT "Unable to create file ":TARGET.FILEş                        GOSUB CLEANUPş                        STOPş                    ENDş                ENDş                TARGET = F.TARGETş                TARGET.NAME = TRIM(DICT:" ":TARGET.FILE)ş                GOSUB UNPACKş            ENDş        ENDş    REPEATş*ş* Execute script required post compilationş*ş    READ CMD FROM F.INSTALL.CF, "MVAPPS-POST-SCRIPT" THENş        LOG.LINE = TIMEDATE():": Processing POST-INSTALL commands..."ş        INSTALL.LOG<-1> = LOG.LINEş* Use compile options if they are present.ş        OPEN 'MVDB.CONTROL' TO F.MVDB.CONTROL THENş            READ COMPILE.SETUP FROM F.MVDB.CONTROL, 'COMPILE.SETUP' THENş                COMPILE.VERB = FIELD(COMPILE.SETUP<1>,' ',1)ş                IF COMPILE.VERB # '' THENş                    OPTS = FIELD(COMPILE.SETUP<1>,'(',2)ş                    IF OPTS # '' THEN OPTS = "(":OPTSş                    CMD.CNT = DCOUNT( CMD, @AM )ş                    FOR CMD.XX = 1 TO CMD.CNTş                        IF FIELD(CMD<CMD.XX>,' ',1) = 'BASIC' OR FIELD(CMD<CMD.XX>,' ',1) = 'COMPILE' THENş*make sure we use the right verb and options from the compile.setupş                            CMD<CMD.XX> = COMPILE.VERB:' ':CMD<CMD.XX>[INDEX(CMD<CMD.XX>,' ',1)+1,999]:' ':OPTSş                        ENDş                    NEXT CMD.XXş                ENDş            ENDş        ENDş* Execute commands that need to be run at the end of the install processş        GOSUB EXEC.CMDş        LOG.LINE = TIMEDATE():": Completed POST-INSTALL commands."ş        INSTALL.LOG<-1> = LOG.LINEş    ENDş*ş*UV*    IF NOT(KEEP.SOURCE) THENş*UV*        FOR X = 1 TO DCOUNT( SOURCE.FILES, @AM )ş*UV*            CMD = "CLEAR-FILE DATA ":SOURCE.FILES<X>ş*UV*            GOSUB EXEC.CMDş*UV*        NEXT Xş*UV*    ENDş    READ INSTALL.LIST FROM F.INSTALL.CF, "LAST.INSTALL" ELSE INSTALL.LIST = ""ş    INSTALL.LIST = INSERT( INSTALL.LIST, 1, 0, 0, INSTALL.ID )ş    WRITE INSTALL.LIST ON F.INSTALL.CF, "LAST.INSTALL"ş    GOSUB CLEANUPş    INSTALL.LOG<-1> = TIMEDATE():": Install complete."ş    WRITE INSTALL.LOG ON F.INSTALL.CF, INSTALL.LOG.IDş    WRITE PACKAGE.INFO ON F.MVAPPS.INSTALLED, PACKAGE.IDş    PROCESS.STATUS = 1ş    GOSUB SEND.DATAş    STOPş*********şUNPACK:   *ş*********ş    PRINT "Unpacking ":TARGET.NAME:"... ":ş*ş    BYTES = 0ş    CNT = 0ş    LOOPş        PLENGTH = OCONV( PACKET[1,6], 'MCXD' )ş        REC = PACKET[7,PLENGTH]ş        PACKET = PACKET[PLENGTH+7,9999999]ş        ID = REC<1>ş        REC = DELETE( REC, 1, 0, 0 )ş        TYP = REC[1,2]ş        OVR.FLAG = REC[3,1]ş        REC = REC[4,9999999]ş        IF TYP = "0x" THENş            REC = OCONV( REC, 'MY' )ş            END ELSE IF TYP # "0c" THENş                REC = TYP:RECş            ENDş*ş            CNT += 1ş            BYTES += LEN(REC)ş            IF OVR.FLAG THENş                IF DICT = "" THENş*If we're not installing DICT items, compare for CLASHESş                    READ CLASH FROM TARGET, ID THENş                        BEGIN CASEş*Preserve dashboard user passwordsş                        CASE TARGET.FILE = "MVDB.USERS"ş                            IF CLASH<1> # REC<1> THEN REC<1> = CLASH<1>ş*Preserve dashboard access profileş                        CASE TARGET.FILE = "MVDB.DEFS"ş                            IF CLASH<5> # REC<5> THEN REC<5> = CLASH<5>ş*Preserve widget access profileş                        CASE TARGET.FILE = "MVDB.WIDGETS"ş                            IF CLASH<2> # REC<2> THEN REC<2> = CLASH<2>ş*Preserve widget compile optionş                        CASE TARGET.FILE = "MVDB.CONTROL" AND ID = "COMPILE.SETUP"ş                            IF CLASH<1> # REC<1> THEN REC<1> = CLASH<1>ş                        END CASEş                        IF CLASH # '' AND REC # CLASH THENş                            CLASH.NAME = TARGET.NAMEş                            CONVERT " " TO "_" IN CLASH.NAMEş                            OPEN 'MVDB.CLASHES,':CLASH.NAME TO F.CLASHES ELSEş                                CMD = "CREATE-FILE DATA MVDB.CLASHES,":CLASH.NAME:" 7"ş                                GOSUB EXEC.CMDş                                OPEN 'MVDB.CLASHES,':CLASH.NAME TO F.CLASHES ELSEş                                    PRINT "Unable to create file MVDB.CLASHES,":CLASH.NAMEş                                    GOSUB CLEANUPş                                    STOPş                                ENDş                            ENDş                            WRITE CLASH ON F.CLASHES, IDş                            CLOSE F.CLASHESş                        ENDş                    ENDş                ENDş                WRITE REC ON TARGET, IDş            END ELSEş                READ TST FROM TARGET, ID ELSEş                    WRITE REC ON TARGET, IDş                ENDş            ENDş            IF NOT(MOD(CNT,500)) THEN PRINT "*":ş        UNTIL PACKET = "" DO REPEATş        IF CNT # 1 THEN PLURAL = "s" ELSE PLURAL = ""ş        PRINT CNT:" record":PLURAL:"."ş        LOG.LINE = TIMEDATE():": UNPACKED ":CNT:" RECORDS TO ":TARGET.NAMEş        INSTALL.LOG<-1> = LOG.LINEş        RETURNş**********şCLEANUP:  *ş**********ş        CLEARFILE F.INSTALLş        CLEARFILE F.PACKED.FILEş        RETURNş*şEXEC.CMD: *ş*ş        CMD.CNT = DCOUNT( CMD, @AM )ş        FOR CMD.XX = 1 TO CMD.CNTş            THIS.CMD = CMD<CMD.XX>ş            LOG.LINE = TIMEDATE():": EXEC: ":THIS.CMDş            INSTALL.LOG<-1> = LOG.LINEş            CRT "Executing   ":THIS.CMDş            EXECUTE THIS.CMDş            IF INSTALL.LOG.ON THENş                WRITE INSTALL.LOG ON F.INSTALL.CF, INSTALL.LOG.IDş            ENDş        NEXT CMD.XXş        RETURNş*şOPEN.ERR: *ş*ş        LOG.LINE = TIMEDATE():": FILE OPEN ERROR: ":ERRFILEş        INSTALL.LOG<-1> = LOG.LINEş        PRINT LOG.LINEş        GOSUB SEND.DATAş        RETURNş*şSEND.DATA:*ş*ş        PRINTş        IF PROCESS.STATUS = 1 THEN INSTALL.STATUS = "Success" ELSE INSTALL.STATUS = "Failed"ş        PRINT "Install process finished. Status: ":INSTALL.STATUSş        RETURNş    END000D13MVDBTOOLKIT.WFILEIO.UNIVERSEş0c2SUBROUTINE MVDBTOOLKIT.WFILEIO.UNIVERSE(FOBJ)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: June 7th 2018ş* Description: WFILEIO MULTI PLATFORM WORKING WITH O/S FILESş*ş**********************************************************************ş*ş* INOBJş*ş* { "ACTION":"READ,WRTE,DELETE",ş*   "PATH":"PATH TO THE FILE",ş*   "DATA":"DATA FOR A WRITE",ş*   "dosletter":"OPTIONAL DOS LETTER TO ADD TO PATH",ş*   "NEWLINE":"CR,LF,CRLF,DOS,UNIX",ş*   "PERMISSIONS":"TBD",ş*   "debug":"Y or N",ş*   "response": {ş*       "data":"responsedata",ş*       "status":1-ok, else no,ş*       "statusmsg":"statusmsg" ş*   }ş* }ş*ş* need to know the existing platformşş*PLATFORM.DELIM="\"ş*PLATFORM.TYPE="WINDOWS"ş*PLATFORM.MV="D3"şşINCLUDE MVDBTOOLKIT.WOBJ.CHOOSE.WOBJşşCALL @WOBJ.RTNE(FOBJ,"GET","debug",DO.DEBUG,"",RERR)şIF OCONV(DO.DEBUG[1,1],"MCU") = "Y" OR DO.DEBUG="1" THEN DO.DEBUG=1 ELSE DO.DEBUG=""şşCALL @WOBJ.RTNE(FOBJ,"GET","work.mvtype",PLATFORM.MV,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","work.filedelim",PLATFORM.DELIM,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","work.platform",PLATFORM.TYPE,"",RERR)şşFSTATUS=1şFSTATUSMSG="OK"şşCALL @WOBJ.RTNE(FOBJ,"GET","action",FILEIO.ACTION,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","path",FILEIO.PATH,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","data",FILEIO.DATA,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","dosletter",FILEIO.DOSLETTER,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","newline",FILEIO.NEWLINE,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","permissions",FILEIO.PERMISSIONS,"",RERR)şş*CALL @WOBJ.RTNE(OUTOBJ,"FROMSTRING","","{}","",RERR)şşFILEIO.ACTION=OCONV(FILEIO.ACTION,"MCU")şFILEIO.NEWLINE=OCONV(FILEIO.NEWLINE,"MCU")şşCALL @WOBJ.RTNE(FOBJ,"GET","work.parsed_fileio_file_name",PARSED.FILEIO.FILE.NAME,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","work.fileio_just_path",FILEIO.JUST.PATH,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","work.platform",PLATFORM.TYPE,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","work.mvtype",PLATFORM.MVTYPE,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"GET","work.filedelim",PLATFORM.FILEDELIM,"",RERR)şş* FOR RIGHT NOW ON JBASE WE WILL JUST OPEN THE FILE USING FULL PATHINGşIF PLATFORM.MV = "WINDOWS" THEN FILEIO.JUST.PATH = "."şşOPENPATH FILEIO.JUST.PATH TO FI ELSEş    FSTATUS=0ş    FSTATUSMSG="Could not open file ":FILEIO.JUST.PATHş    GOTO end.of.runşENDşşBEGIN CASEş    CASE FILEIO.ACTION="READ"ş        GOSUB fileio.readş    CASE FILEIO.ACTION="WRITE"ş        GOSUB fileio.writeş    CASE FILEIO.ACTION="DELETE"ş        GOSUB fileio.deleteş    CASE 1ş        FSTATUS=0ş        FSTATUSMSG="Invalid action"ş        GOTO end.of.runşEND CASEşşend.of.run: *şCALL @WOBJ.RTNE(FOBJ,"SET.NUMBER", "response.status", FSTATUS,"",RERR)şCALL @WOBJ.RTNE(FOBJ,"SET.STRING", "response.statusmsg", FSTATUSMSG, "", RERR)şşşRETURNşşfileio.read: *şşREC=""şşREAD REC FROM FI, PARSED.FILEIO.FILE.NAME ELSEş    FSTATUS=0ş    FSTATUSMSG="Could not find ":PARSED.FILEIO.FILE.NAMEşENDşşCALL @WOBJ.RTNE(FOBJ,"SET.STRING","response.data",REC,"",RERR)şşIF 0 THENş    PRINT "PATH   :":FILEIO.JUST.PATHş    PRINT "ID     :":PARSED.FILEIO.FILE.NAMEş    PRINT "REC    :":RECşENDşşRETURNşşfileio.write: *şşWRITE FILEIO.DATA ON FI, PARSED.FILEIO.FILE.NAMEşşRETURNşşfileio.delete: *şşDELETE FI, PARSED.FILEIO.FILE.NAMEşşRETURN0003AFMVDBTOOLKIT.WCALL.DEBUGş0c2SUBROUTINE MVDBTOOLKIT.WCALL.DEBUG(OBJ)şşCRT "Do you wish to debug wcall? ":; INPUT CONTşIF OCONV(CONT,"MCU")[1,1]="Y" THEN NULL ELSE RETURNşş* This will do typical debugging workşCALL WOBJ(OBJ,"GET","response.status",RESPONSE.STATUS,"",RERR)şCALL WOBJ(OBJ,"GET","response.statusmsg",RESPONSE.STATUS.MSG,"",RERR)şşCRT "Status = ":RESPONSE.STATUS:' ':RESPONSE.STATUS.MSGş* Show the actual Curl commandşşCALL WOBJ(OBJ,"GET","response.curl_cmnd",CURL.CMND,"",RERR)şşPRINT "Press return to see curl cmnd ":; INPUT CONTşşPRINT CURL.CMNDşşPRINT "Press return to see response ":; INPUT CONTşCALL WOBJ(OBJ,"GET","response.data",RESPONSE.DATA,"",RERR)şşPRINT "Response: "şPRINT RESPONSEşşPRINT "Press return to see response.log":; INPUT CONTşşCALL WOBJ(OBJ,"LENGTH","response.log",LOG.LENGTH,"",RERR)şşFOR X=1 TO LOG.LENGTHş    CALL WOBJ(OBJ,"GET","response.log[":X-1:"]",LOG.LINE,"",RERR)ş    PRINT LOG.LINEşNEXT XşşRETURNşş00005EMVDBTOOLKIT.SWAP.DEFAULTş0c2SUBROUTINE MVDBTOOLKIT.SWAP.DEFAULT(V,F,T)şşV=SWAP(V,F,T)şşRETURNş00033CMVDBTOOLKIT.WGETENVş0c2SUBROUTINE MVDBTOOLKIT.WGETENV(VAR.NAME,RETURN.VALUE)şşINCLUDE MVDBTOOLKIT.WOBJ.CHOOSE.WOBJşşCALL MVDBTOOLKIT.WPLATFORM(POBJ)şşCALL @WOBJ.RTNE(POBJ,"GET","mvtype",PLATFORM.MV,"",RERR)şCALL @WOBJ.RTNE(POBJ,"GET","filedelim",PLATFORM.DELIM,"",RERR)şCALL @WOBJ.RTNE(POBJ,"GET","platform",PLATFORM.TYPE,"",RERR)şş* THIS FUNCTION IS A CROSS PLATFORM WGET VAR FUNCTIONşşşBEGIN CASEş    CASE PLATFORM.MV="D3" AND PLATFORM.TYPE="LINUX"ş        FILEIO.RTNE="MVDBTOOLKIT.WGETENV.D3"ş        CALL MVDBTOOLKIT.WGETENV.D3(VAR.NAME,RETURN.VALUE)ş    CASE PLATFORM.MV="JBASE"ş        FILEIO.RTNE="MVDBTOOLKIT.WGETENV.JBASE"ş        CALL MVDBTOOLKIT.WGETENV.JBASE(VAR.NAME,RETURN.VALUE)ş    CASE 1ş        CALL MVDBTOOLKIT.WGETENV.GENERIC(VAR.NAME,RETURN.VALUE,PLATFORM.MV,PLATFORM.TYPE)şEND CASEşşend.of.run: *şşRETURNşş000156MVDBTOOLKIT.WEXECUTE.INCLUDEş0c2* COMMON FOR EXECUTE *şCOMMON /MVDBWEX/ EXECUTE.COMMANDşCOMMON /MVDBWEX/ EXECUTE.DIRECTORYşCOMMON /MVDBWEX/ EXECUTE.DOCAPTUREşCOMMON /MVDBWEX/ EXECUTE.RETURNINGşCOMMON /MVDBWEX/ EXECUTE.RTNDATAşCOMMON /MVDBWEX/ EXECUTE.PASSLISTşCOMMON /MVDBWEX/ MV.TYPEşCOMMON /MVDBWEX/ PLATFORMşCOMMON /MVDBWEX/ EXECUTE.DEBUGş0004E5MVDBTOOLKIT.WGETENV.GENERICş0c2SUBROUTINE MVDBTOOLKIT.WGETENV.GENERIC(VAR.NAME, RETURN.VALUE, MVTYPE, PLATFORM)şşRETURN.VALUE=""şş* WE ARE GOING TO JUST SHELL OUT AND GET THE ENVIRONMENT VARIABLE BASEDş* ON THE PLATFORMşşBEGIN CASEş    CASE MVTYPE="UNIVERSE" AND PLATFORM="LINUX"ş        CMND='sh -c "echo $':VAR.NAME:'"'ş    CASE MVTYPE="UNIVERSE" AND PLATFORM="WINDOWS"ş        CMND='dos /c "echo %':VAR.NAME:'%"'ş    CASE (MVTYPE="JBASE" OR MVTYPE="D3") AND PLATFORM="LINUX"ş        CMND='!echo $':VAR.NAMEş    CASE MVTYPE="JBASE" AND PLATFORM="WINDOWS"ş         CMND='echo %':VAR.NAME:'%'ş    CASE MVTYPE="D3" AND PLATFORM="WINDOWS"ş        CMND='!echo %':VAR.NAME:'%'ş    CASE MVTYPE='UNIDATA' AND PLATFORM="WINDOWS"ş        CMND='!echo %':VAR.NAME:'%'ş    CASE MVTYPE='UNIDATA' AND PLATFORM="LINUX"ş        CMND='!echo $':VAR.NAMEş    CASE MVTYPE='QM' AND PLATFORM="WINDOWS"ş        * QM DOES HAVE SYSTEM(1025) TO GET ENVIRONMENT STUFFş        * STICKING WITH THIS FOR NOWş        CMND='!echo %':VAR.NAME:'%'ş    CASE MVTYPE='QM' AND PLATFORM="LINUX"ş        CMND='!echo $':VAR.NAMEş    CASE 1ş        CMND=''şEND CASEşşEXECUTE CMND CAPTURING RETURN.VALUEşşIF MVTYPE='UNIDATA' THENş    RETURN.VALUE=RETURN.VALUE[1,LEN(RETURN.VALUE)-1]şENDşşRETURNş000322MVDBTOOLKIT.EXPAND.PATHş0c2SUBROUTINE MVDBTOOLKIT.EXPAND.PATH(PASSED.PATH)şşINCLUDE MVDBTOOLKIT.WOBJ.CHOOSE.WOBJşşCALL MVDBTOOLKIT.WPLATFORM(POBJ)şşCALL @WOBJ.RTNE(POBJ,"GET","mvtype",PLATFORM.MV,"",RERR)şCALL @WOBJ.RTNE(POBJ,"GET","filedelim",PLATFORM.DELIM,"",RERR)şCALL @WOBJ.RTNE(POBJ,"GET","platform",PLATFORM.TYPE,"",RERR)şşPARSED.PATH=PASSED.PATHşCONVERT PLATFORM.DELIM TO @AM IN PARSED.PATHşPARSED.PARTS=DCOUNT(PARSED.PATH,@AM)şşFOR P=1 TO PARSED.PARTSş    THIS.PART=PARSED.PATH<P>ş    IF THIS.PART[1,1]='%' OR THIS.PART[1,1]="$" THENş        CONVERT '%$' TO '' IN THIS.PARTş         CALL MVDBTOOLKIT.WGETENV(THIS.PART,NEW.THIS.PART)ş         IF NEW.THIS.PART # "" THEN PARSED.PATH<P>=NEW.THIS.PARTş    ENDşNEXT PşşCONVERT @AM TO PLATFORM.DELIM IN PARSED.PATHşşPASSED.PATH=PARSED.PATHşşRETURNşş00002EMVDBTOOLKIT.TEST.INCLUDEş0c2CMND = SENTENCE()ş0001E1MVDBTOOLKIT.SWAPş0c2SUBROUTINE MVDBTOOLKIT.SWAP(V,F,T)şş* MVDBTOOLKIT.SWAPşINCLUDE MVDBTOOLKIT.WOBJ.CHOOSE.WOBJşş* PLATFORM INDEPENDENT SWAP COMMANDşCALL MVDBTOOLKIT.WPLATFORM(PLATFORMOBJ)şşCALL @WOBJ.RTNE(PLATFORMOBJ,"GET","mvtype",MV.TYPE,"",RERR)şşBEGIN CASEş    CASE MV.TYPE='UNIVERSE'ş        CALL MVDBTOOLKIT.SWAP.UNIVERSE(V,F,T)ş    CASE MV.TYPE='UNIDATA'ş        CALL MVDBTOOLKIT.SWAP.UNIDATA(V,F,T)ş    CASE 1ş        CALL MVDBTOOLKIT.SWAP.DEFAULT(V,F,T)şEND CASEşşRETURNş000C9FMVDBTOOLKIT.PACKAGE.INSTALLERş0c2      * Install packagesşş      * first, get a list of packagesşş      CALL WOBJ(COBJ,"FROMJSON","","{}","",RERR)şş      CALL MVDBTOOLKIT.WPLATFORM(PLATFORM.OBJ)şş      CALL WOBJ(PLATFORM.OBJ,"GET","packagesurl",PACKAGES.URL,"",RERR)şş      IF PACKAGES.URL = "" THENş         PACKAGES.URL="https://raw.githubusercontent.com/zumasys/MVConnect/master/packages.json"ş      ENDşş      CALL WOBJ(PLATFORM.OBJ,"GET","mvtype",MVTYPE,"",RERR)ş      ş      MVTYPE=OCONV(MVTYPE,"MCU")ş      ş      BEGIN CASEş         CASE MVTYPE="D3"; MVTYPE2="d3"ş         CASE MVTYPE="JBASE"; MVTYPE2="jb"ş         CASE MVTYPE="QM"; MVTYPE2="qm"ş         CASE MVTYPE="UNIVERSE"; MVTYPE2="uv"ş         CASE MVTYPE="UNIDATA"; MVTYPE2="ud"ş         CASE 1ş             PRINT "Platform ":MVTYPE:" not supported"ş             STOPş      END CASEş      ş      CALL WOBJ(PLATFORM.OBJ,"GET","tmpdir",TMP.DIR,"",RERR)ş      ş      CALL WOBJ(PLATFORM.OBJ,"GET","filedelim",FILEDELIM,"",RERR)ş      ş      PRINT "Packages url: ":PACKAGES.URLşş      CALL WOBJ(COBJ,"SET","url",PACKAGES.URL,"",RERR)ş      CALL WOBJ(COBJ,"SET","method","GET","",RERR)şş      CRT "Getting package list...":şş      CALL MVDBTOOLKIT.WCALL(COBJ)şş      *CALL MVDBTOOLKIT.WCALL.DEBUG(COBJ)şşş      CALL WOBJ(COBJ,"GET","response.status",RESPONSE.STATUS,"",RERR)şş      CALL WOBJ(COBJ,"GET","response.statusmsg",RESPONSE.STATUS.MSG,"",RERR)ş      CALL WOBJ(COBJ,"GET","response.data",RESPONSE.DATA,"",RERR)şş      PRINT RESPONSE.STATUS:' ':RESPONSE.STATUS.MSGşş      CALL WOBJ(POBJ,"FROMJSON","",RESPONSE.DATA,"",RERR)şş      IF RERR>0 THENş         PRINT RERR<1>:" Error: ":RERR<2>ş         STOPş      ENDşş      CALL WOBJ(POBJ,"LENGTH","packages",NUMBER.PACKAGES,"",RERR)şş      PRINT "Number packages: ":NUMBER.PACKAGESşştop.of.packages: *şş      PACKAGES=""ş      STOP.PACKAGE.LIST=0ş      PACKAGE=""ş      ş      FOR P=1 TO NUMBER.PACKAGES UNTIL STOP.PACKAGE.LISTşş         CALL WOBJ(POBJ,"GET","packages[":P-1:"].name",PACKAGE.NAME,"",RERR)ş         CALL WOBJ(POBJ,"GET","packages[":P-1:"].version",PACKAGE.VERSION,"",RERR)ş         CALL WOBJ(POBJ,"GET","packages[":P-1:"].description",PACKAGE.DESCRIPTION,"",RERR)şşş         PRINT P"MR(#4)":ş         PRINT " ":ş         PRINT PACKAGE.NAME:ş         PACKAGES<P>=PACKAGE.NAMEş         ş         PRINT " ":ş         PRINT PACKAGE.VERSIONş         PRINT "     ":PACKAGE.DESCRIPTIONş         ş         IF NOT(MOD(P,10)) OR P=NUMBER.PACKAGES THENş             PRINT "Package # to install, return for more, q to quit ":; INPUT PACKAGEş             IF OCONV(PACKAGE,'MCU')='Q' THEN STOPş             IF NUM(PACKAGE) THEN STOP.PACKAGE.LIST=1ş         ENDş      NEXT Pş      ş      IF PACKAGE="" THEN STOPş      IF NOT(NUM(PACKAGE)) THENş           LOCATE PACKAGE IN PACKAGES SETTING PACKAGE ELSE STOPş      ENDş      ş      IF PACKAGE < 1 OR PACKAGE > NUMBER.PACKAGES THEN STOPşş      CALL WOBJ(POBJ,"GET","packages[":PACKAGE-1:"].name",PACKAGE.NAME,"",RERR)ş      CALL WOBJ(POBJ,"GET","packages[":PACKAGE-1:"].version",PACKAGE.VERSION,"",RERR)şş           ş      COBJ=""ş      CALL WOBJ(COBJ,"FROMSTRING","","{}","",RERR)ş      ş      CALL MVDB.PACKAGE.INSTALLER.SUB(PACKAGE.NAME,RESULT)ş      ş      şSTOPşş000778MVDBTOOLKIT.WPLATFORMş0c2      SUBROUTINE MVDBTOOLKIT.WPLATFORM(PLATFORMOBJ)ş      **********************************************************************ş      *ş      * Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş      *ş      * Written by: Patrick Payne, Zumasysş      * Date: June 12, 2018ş      * Description: WPLATFORM OBJş      *ş      **********************************************************************ş      *ş      *ş      * PLATFORMOBJş      *ş      * {ş      *   "platform":" WINDOWS OR LINUX",ş      *   "mvtype"  :" JBASE, D3, UNIDATA, UNIVERSE, OPENQM",ş      *   "tmpdir"  :"tmp dir"ş      * }şş      * nEW lINEşş      INCLUDE MVDBTOOLKIT.WOBJ.CHOOSE.WOBJş      ş      USE.DICT=1ş      OPEN "DICT","MVDBTOOLKIT.BP" TO DICT.MVDBTOOLKIT.BP ELSE USE.DICT=0şş      IF USE.DICT THENş         READ PLATFORMOBJ.JSON FROM DICT.MVDBTOOLKIT.BP, "MV.PLATFORM.JSON" ELSE PLATFORMOBJ.JSON=""ş      ENDşş      OPEN "MD" TO FI.MD ELSEş         OPEN "VOC" TO FI.MD ELSE RETURNş      ENDşş      * 02/06/2020 - Changed md item name to MV.PLATFORM.JSON to make it not tied to this packageş      ş      IF PLATFORMOBJ.JSON="" THENş         CRT "No MV.PLATFORM.JSON IN MD!!!"ş         STOPş      ENDşş      CONVERT CHAR(254) TO '' IN PLATFORMOBJ.JSONş      CALL @WOBJ.RTNE(PLATFORMOBJ,"FROMSTRING","",PLATFORMOBJ.JSON,"",RERR)şş      * 9/2/2019 PAP - We now figure out filedelim vs passing it in original config filedelimşş      CALL @WOBJ.RTNE(PLATFORMOBJ,"GET","platform",PLATFORM,"",RERR)ş      CALL @WOBJ.RTNE(PLATFORMOBJ,"GET","mvtype",MV.TYPE,"",RERR)ş      IF PLATFORM="WINDOWS" THEN DELIM = "\" ELSE DELIM = "/"ş      CALL @WOBJ.RTNE(PLATFORMOBJ,"SET","filedelim",DELIM,"",RERR)ş      CALL @WOBJ.RTNE(PLATFORMOBJ,"GET","tmpdir",TMP.DIR,"",RERR)şş      CALL @WOBJ.RTNE(PLATFORMOBJ,"TOSTRING","",OUT.JSON,"PRETTIFY",RERR)ş      WRITE OUT.JSON ON DICT.MVDBTOOLKIT.BP, "MV.PLATFORM.JSON"şş      RETURN0006D0MVDBTOOLKIT.ENCODEş0c2SUBROUTINE MVDBTOOLKIT.ENCODE(IN.STR,OUT.STR)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2017ş* Description: encode json stringş*ş**********************************************************************ş***ş* THIS PROGRAM WILL CONVERT ALL BAD CHARACTERS TO AN ESCAPED CHARACTERş***şEQU CR TO CHAR(13), LF TO CHAR(10), TB TO CHAR(9), BS TO CHAR(8), FF TO CHAR(12)şNL = CR:LFşşPRETTIFYCR=""ş*ş*OPEN 'RESULT.FILE' TO RFILE ELSE STOPş* WE NEED TO ENCODEş* " = \"   (34)ş* \ = \\    (92)ş* / = \/ş* CHAR(7) = \bş* CHAR(13) = \rş* char(10) = \nş* char(12) = \fş* char(9)  = \tşOUT.STR=''şL=LEN(IN.STR)şCONVERT @AM TO LF IN IN.STR; * LETS SWITCH 254 TO LF BE DEFAULTşFOR X=1 TO Lş    C=IN.STR[X,1]ş    SEQ.C=SEQ(C)ş    ENCODE=0ş    *IF SEQ.C < 32 THEN ENCODE=1; * BELOW SPACEş    *IF SEQ.C > 32 AND SEQ.C < 48 THEN ENCODE=1; * LETS ENCODE ALL OF THIS !@$%^&*()ş    IF SEQ.C=34 THEN ENCODE=1ş    IF SEQ.C=92 THEN ENCODE=1ş    * IF SEQ.C=47 THEN ENCODE=1ş    *IF SEQ.C > 126 THEN ENCODE = 1; * LETS ENCODE ALL THE HIGH ENTRIESş    *IF SEQ.C >= 91 AND SEQ.C <= 96 THEN ENCODE=1ş    IF ENCODE THENş        BEGIN CASEş            CASE SEQ.C=7; OUT.STR='\b'ş            CASE C='\'; OUT.STR:='\\'ş                *CASE C='/'; OUT.STR:='\/'ş            CASE C='"'; OUT.STR:='\"'ş            CASE SEQ.C=10ş                OUT.STR:='\n'ş                IF PRETTIFYCR THEN OUT.STR:=NLş            CASE SEQ.C=13; OUT.STR:='\r'ş            CASE SEQ.C=12; OUT.STR:='\f'ş            CASE 1; OUT.STR:='\u00':OCONV(C,'MX0C')ş        END CASEş    END ELSEş        OUT.STR=OUT.STR:Cş    ENDşNEXT XşRETURNşEND002ACDMVDBTOOLKIT.WCALLş0c2SUBROUTINE MVDBTOOLKIT.WCALL(PASSED.WOBJ)ş**********************************************************************ş*ş* Copyright (C) 2018 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: June 15, 2018ş* Description: WCALL Libraryşş**********************************************************************ş*ş* @WOBJ.RTNEş* { "method":"GET,PUT,POST,ETC",ş*    "url":"URL TO CALL",ş*    "headers": { "HEADERNAME":"VALUE", "HEADERNAME":"VALUE" },ş*    "outputfile: "Optional output file, wcall will write the output to this file vs response.data",ş*    "body":"BODY",ş*    "formfields": [ş*         {ş*            "name":"field name",ş*            "value":"field value",ş*            "fieldtype":"blank or file" for nowş*         }ş*     ],ş*    "datafields": [ş*         {ş*            "name":"field name",ş*            "value":"field value",ş*            "fieldtype":"blank or file" for nowş*         }ş*     ],ş*    "insecure":"Yes,Y,YES - Sets the -k on curl",ş*    "timeout": ## (default is 45),ş*    "options":"options to add to curl command",ş*    "debug":"Y or N",ş*    "response": {ş*        "result":"RESULT",ş*        "status":"STATUS",ş*        "statusmsg":"STATUS MSG",ş*        "http_type": "http type",ş*        "curl_cmnd":"Actual curl command created",ş*         "error": "error",ş*         "log": [ "log output line1", "log output line 2" ],ş*        "headers": { "headername":"header value","headername2":"headervalue" }ş*    }ş*  }şINCLUDE MVDBTOOLKIT.WOBJ.CHOOSE.WOBJşşCALL MVDBTOOLKIT.WPLATFORM(POBJ)şşCALL @WOBJ.RTNE(POBJ,"GET","mvtype",MV.TYPE,"",RERR)şCALL @WOBJ.RTNE(POBJ,"GET","platform",PLATFORM,"",RERR)şCALL @WOBJ.RTNE(POBJ,"GET","filedelim",FILE.DELIM,"",RERR)şCALL @WOBJ.RTNE(POBJ,"GET","curllocation",CURLLOCATION,"",RERR); * change #19şşIF MV.TYPE="" THENş   CALL @WOBJ.RTNE(POBJ,"GET","error",THIS.ERROR,"",RERR)ş   PRINT "NO MV TYPE: ":THIS.ERRORş   RETURNşENDşşITEMS.TO.DELETE=""; * PATH TO EACH FILE TO DELETEşşCALL @WOBJ.RTNE(POBJ,"GET","tmpdir",TMP.DIR,"",RERR)şşCALL @WOBJ.RTNE(PASSED.WOBJ,"GET","debug",DO.DEBUG,"",RERR)şIF OCONV(DO.DEBUG[1,1],"MCU")="Y" OR DO.DEBUG="1" THEN DO.DEBUG=1 ELSE DO.DEBUG=""şCALL @WOBJ.RTNE(PASSED.WOBJ,"GET","method",WEB.METHOD,"",RERR)ş* 7/22/2020 PAP Set default MethodşIF WEB.METHOD="" THEN WEB.METHOD="GET"şşCALL @WOBJ.RTNE(PASSED.WOBJ,"GET","url",WEB.URL,"",RERR)şCALL @WOBJ.RTNE(PASSED.WOBJ,"GET","body",WEB.BODY,"",RERR)şCALL @WOBJ.RTNE(PASSED.WOBJ,"GET","timeout",WEB.TIMEOUT,"",RERR)şCALL @WOBJ.RTNE(PASSED.WOBJ,"KEYS","headers",WEB.HEADERS,"",RERR)şIF NOT(WEB.TIMEOUT) THEN WEB.TIMEOUT=45şCALL @WOBJ.RTNE(PASSED.WOBJ,"GET","insecure",WEB.INSECURE,"",RERR)şIF OCONV(WEB.INSECURE[1,1],'MCU') = "Y" THEN WEB.INSECURE=1 ELSE WEB.INSECURE=0şşCALL @WOBJ.RTNE(PASSED.WOBJ,"SET.OBJECT","response","{}","",RERR)şşIF TMP.DIR="" THENş BEGIN CASEş    CASE PLATFORM="LINUX"ş       TMP.DIR="/tmp"ş    CASE INDEX(PLATFORM,"WINDOWS",1) AND MV.TYPE="JBASE"ş       TMP.DIR="%HOME%"ş    CASE INDEX(PLATFORM,"WINDOWS",1)ş       TMP.DIR="%USERPROFILE%\AppData\Local\Temp"ş    CASE 1ş       TMP.DIR="/tmp"ş END CASEşENDşşCALL MVDBTOOLKIT.EXPAND.PATH(TMP.DIR)şş* 4/6/2020 - Change #19.  şIF CURLLOCATION # "" THENş   CMND=CURLLOCATIONşEND ELSEş   CMND="curl"şENDşCMND:=" -s"şCMND:=' -m ':WEB.TIMEOUTşCMND:=' -X ':WEB.METHODşCALL @WOBJ.RTNE(PASSED.WOBJ,"GET","options",WEB.OPTIONS,"",RERR)şIF WEB.OPTIONS # "" THENş   CMND:=' ':WEB.OPTIONSşENDşşWEB.NUM.HEADERS=DCOUNT(WEB.HEADERS,@SVM)şşFOR H=1 TO WEB.NUM.HEADERSş   HEADER.NAME=WEB.HEADERS<1,1,H>ş   CALL @WOBJ.RTNE(PASSED.WOBJ,"GET","headers.":HEADER.NAME,HEADER.VALUE,"",RERR)ş   CALL MVDBTOOLKIT.ENCODE(HEADER.VALUE,ENCODED.HEADER.VALUE)ş   CMND:=' -H "':HEADER.NAME:': ':ENCODED.HEADER.VALUE:'"'şNEXT HşşUSER.NO=FIELD(OCONV('','U50BB'),' ',1)şSESSION.ID="WCALL-":USER.NOşşTMP.DIR:=FILE.DELIMşş* add in dumping of headersşCMND:=\ -D "\:TMP.DIR:SESSION.ID:\.headers"\şşITEMS.TO.DELETE<-1>=TMP.DIR:SESSION.ID:'.headers'şş* write out stderrşCMND:=\ -v --stderr "\:TMP.DIR:SESSION.ID:\.stderr"\şşITEMS.TO.DELETE<-1>=TMP.DIR:SESSION.ID:\.stderr\şşCALL @WOBJ.RTNE(FOBJ,"FROMSTRING","","{}","",RERR)şşSAVE.FOBJ=FOBJşşIF WEB.BODY # "" THENş   *CALL @WOBJ.RTNE(EOBJ,"SET.ARRAY","data","[]","",RERR)ş   *CALL @WOBJ.RTNE(EOBJ,"SET.STRING","data[0]",WEB.BODY,"",RERR)şşş   CALL @WOBJ.RTNE(FOBJ,"SET","action","WRITE","",RERR)ş   CALL @WOBJ.RTNE(FOBJ,"SET","data",WEB.BODY,"",RERR)ş   CALL @WOBJ.RTNE(FOBJ,"SET","path",TMP.DIR:SESSION.ID:'.body',"",RERR)ş   ITEMS.TO.DELETE<-1>=TMP.DIR:SESSION.ID:'.body'şş   CALL MVDBTOOLKIT.WFILEIO(FOBJ)ş   CMND:=' --data-binary "@':TMP.DIR:SESSION.ID:'.body"'ş   *CMND:='  --data-binary @-'şENDşş* form fields *şCALL @WOBJ.RTNE(PASSED.WOBJ,"LENGTH","formfields",NUM.FORMFIELDS,"",RERR)şşFOR X=1 TO NUM.FORMFIELDSş P="formfields[":X-1:"]"ş CALL @WOBJ.RTNE(PASSED.WOBJ,"GET",P:'.name',FIELD.NAME,"",RERR)ş CALL @WOBJ.RTNE(PASSED.WOBJ,"GET",P:'.value',FIELD.VALUE,"",RERR)ş CALL @WOBJ.RTNE(PASSED.WOBJ,"GET",P:'.fieldtype',FIELD.TYPE,"",RERR)ş IF TRIM(FIELD.NAME) # "" THENş    * < > @ ALL MEAN SPECIAL THINGS WITH A -F.  If that exists in the file you needş    * to use --form-stringş    BEGIN CASEş       CASE INDEX(FIELD.VALUE,CHAR(13),1) OR INDEX(FIELD.VALUE,CHAR(10),1)ş         * WE NEED TO WRITE THIS OUT!ş         TMP.CMND="-F "ş            CALL @WOBJ.RTNE(FOBJ,"SET","action","WRITE","",RERR)ş            CALL @WOBJ.RTNE(FOBJ,"SET","data",FIELD.VALUE,"",RERR)ş            CALL @WOBJ.RTNE(FOBJ,"SET","path",TMP.DIR:SESSION.ID:'.field':X-1,"",RERR)ş            ITEMS.TO.DELETE<-1>=TMP.DIR:SESSION.ID:'.field':X-1ş            FIELD.VALUE="@":TMP.DIR:SESSION.ID:'.field':X-1ş            CALL MVDBTOOLKIT.WFILEIO(FOBJ)ş         * NEED TO WRITE THE CONTENT OUT TO A TMP FILE *şş       CASE INDEX(FIELD.VALUE,'!',1) OR INDEX(FIELD.VALUE,'<',1) OR INDEX(FIELD.VALUE,'>',1) OR INDEX(FIELD.VALUE,'@',1) OR INDEX(FIELD.VALUE,'$',1) AND FIELD.TYPE # "file"ş         TMP.CMND="--form-string "ş       CASE 1ş         TMP.CMND="-F "ş    END CASEş    TMP.CMND:=FIELD.NAME:'="'ş    TMP.CMND:=FIELD.VALUE:'"'ş    CMND:=' ':TMP.CMNDş ENDşNEXT Xşş* form fields *şCALL @WOBJ.RTNE(PASSED.WOBJ,"LENGTH","datafields",NUM.FORMFIELDS,"",RERR)şşFOR X=1 TO NUM.FORMFIELDSş      P="datafields[":X-1:"]"ş      CALL @WOBJ.RTNE(PASSED.WOBJ,"GET",P:'.name',FIELD.NAME,"",RERR)ş      CALL @WOBJ.RTNE(PASSED.WOBJ,"GET",P:'.value',FIELD.VALUE,"",RERR)ş      CALL @WOBJ.RTNE(PASSED.WOBJ,"GET",P:'.fieldtype',FIELD.TYPE,"",RERR)ş      CALL MVDBTOOLKIT.SWAP(FIELD.VALUE,'@','%40')ş      CALL MVDBTOOLKIT.SWAP(FIELD.VALUE,'$','%24')ş      CALL MVDBTOOLKIT.SWAP(FIELD.VALUE,'/','%2F')ş      CALL MVDBTOOLKIT.SWAP(FIELD.VALUE,':','%3A')şş      IF TRIM(FIELD.NAME) # "" THENş         TMP.CMND="-d "ş         TMP.CMND:=FIELD.NAME:'="'ş         TMP.CMND:=FIELD.VALUE:'"'ş         CMND:=' ':TMP.CMNDş      ENDşNEXT Xş* NOW ADD THE URLşşCALL MVDBTOOLKIT.SWAP(WEB.URL,' ','%20')şCALL MVDBTOOLKIT.SWAP(WEB.URL,'@','%40')şCALL MVDBTOOLKIT.SWAP(WEB.URL,'$','%24')ş*WEB.URL=SWAP(WEB.URL,'/','%2F')şşCMND:=' "':WEB.URL:'"'şş* CALL WEXECUTEşşCALL @WOBJ.RTNE(EOBJ,"FROMSTRING","","{}","",RERR)ş şCALL @WOBJ.RTNE(EOBJ,"SET","command",CMND,"",RERR)şCALL @WOBJ.RTNE(EOBJ,"SET","debug",DO.DEBUG,"",RERR); * LAY IN DEBUGGING PARAMşşIF WEB.BODY # "" THENş   * CALL @WOBJ.RTNE(EOBJ,"SET","data[0]",WEB.BODY,"",RERR)şENDşşCALL MVDBTOOLKIT.WEXECUTE(EOBJ); * DO THE CALLşş* READ IN THE HEADERSşşCALL @WOBJ.RTNE(FOBJ,"FROMSTRING","","{}","",RERR)şCALL @WOBJ.RTNE(FOBJ,"SET","action","READ","",RERR)şCALL @WOBJ.RTNE(FOBJ,"SET","path",TMP.DIR:SESSION.ID:".headers","",RERR)şCALL MVDBTOOLKIT.WFILEIO(FOBJ)şşCALL @WOBJ.RTNE(FOBJ,"GET","response.data",RESPONSE.HEADERS,"",RERR)şşCALL @WOBJ.RTNE(PASSED.WOBJ,"SET.STRING","response.headers",RESPONSE.HEADERS,"",RERR)şş* Lets break the headers down into an arrayşşCALL @WOBJ.RTNE(PASSED.WOBJ,"SET.OBJECT","response.headers","{}","",RERR)şşNUM.HEADERS=DCOUNT(RESPONSE.HEADERS,@AM)şşHTTP.TYPE=''; HTTP.STATUS.CODE=''; HTTP.MSG=''şşFOR H=1 TO NUM.HEADERSş   HEADER.LINE=RESPONSE.HEADERS<H>şş   IF HEADER.LINE[1,4]="HTTP" AND NOT(INDEX(HEADER.LINE,":",1)) THENş      HTTP.TYPE=FIELD(HEADER.LINE,' ',1)ş      HTTP.STATUS.CODE=FIELD(HEADER.LINE,' ',2)ş      HTTP.STATUS.MSG=FIELD(HEADER.LINE,' ',3,99)ş   END ELSEş      HEADER.NAME=TRIM(FIELD(HEADER.LINE,':',1))ş      CONVERT CHAR(13):CHAR(10) TO '' IN HEADER.NAME; * CATCHES BLANK LINESş      HEADER.VALUE=FIELD(HEADER.LINE,':',2,999999)ş      IF  HEADER.VALUE[1,1]=' ' THEN HEADER.VALUE=HEADER.VALUE[2,LEN(HEADER.VALUE)]; * messy left trimş      CONVERT CHAR(13):CHAR(10) TO '' IN HEADER.VALUE; * STRIP AN NEW LINESş      IF HEADER.NAME # "" THENş         * NOW PUT THE HEADER INTO OUR ARRAYş         CALL @WOBJ.RTNE(PASSED.WOBJ,"SET.STRING","response.headers.":HEADER.NAME,HEADER.VALUE,"",RERR)ş      ENDş   ENDşNEXT HşşCALL @WOBJ.RTNE(PASSED.WOBJ,"SET.NUMBER","response.status",HTTP.STATUS.CODE,"",RERR)şCALL @WOBJ.RTNE(PASSED.WOBJ,"SET.STRING","response.http_type",HTTP.TYPE,"",RERR)şCALL @WOBJ.RTNE(PASSED.WOBJ,"SET.STRING","response.statusmsg",HTTP.STATUS.MSG,"",RERR)şş* READ IN STDERR (LOG) AND POST AS A ARRAYşşFOBJ=SAVE.FOBJşCALL @WOBJ.RTNE(FOBJ,"SET","action","READ","",RERR)şCALL @WOBJ.RTNE(FOBJ,"SET","path",TMP.DIR:SESSION.ID:'.stderr',"",RERR)şCALL MVDBTOOLKIT.WFILEIO(FOBJ)şCALL @WOBJ.RTNE(FOBJ,"GET","response.data",RESPONSE.STDERR,"",RERR)şşCALL @WOBJ.RTNE(PASSED.WOBJ,"SET.ARRAY","response.log","[]","",RERR)şşCONVERT CHAR(13) TO @AM IN RESPONSE.STDERRşCONVERT CHAR(10) TO "" IN RESPONSE.STDERRşNUM.LINES=DCOUNT(RESPONSE.STDERR,@AM)şş* 4/2/2020 pap  - Look for bad curl statement!!şşGOOD.CURL=1şCURL.BAD.MSG=""şşFOR L=1 TO NUM.LINESş    LINE=RESPONSE.STDERR<L>ş    BEGIN CASEş      CASE INDEX(LINE,'curl:',1)ş         * LETS CAPTURE THE FIRST ONEş         IF CURL.BAD.MSG = "" THEN CURL.BAD.MSG=TRIM(FIELD(LINE,':',2,999))ş         GOOD.CURL=0ş      CASE INDEX(LINE,'warning:',1)ş    END CASEş    CALL @WOBJ.RTNE(PASSED.WOBJ,"SET.STRING","response.log[-1]",LINE,"",RERR)şNEXT LşşIF NOT(GOOD.CURL) THENş   CALL @WOBJ.RTNE(PASSED.WOBJ,"SET.NUMBER","response.status","400","",RERR)ş   CALL @WOBJ.RTNE(PASSED.WOBJ,"SET.STRING","response.statusmsg",CURL.BAD.MSG,"",RERR)şENDşş*CALL @WOBJ.RTNE(EOBJ,"TOSTRING","",TEST.JSON,"PRETTIFY",RERR)şCALL @WOBJ.RTNE(EOBJ,"GET","result.result",EXECUTE.RESULT,"",RERR)şCALL @WOBJ.RTNE(PASSED.WOBJ,"SET.STRING","response.data",EXECUTE.RESULT,"",RERR)şşend.of.call: *şş* XDELETE REQUIRED FILESşşNUM.ITEMS.TO.DELETE=DCOUNT(ITEMS.TO.DELETE,@AM)şşFOR I=1 TO NUM.ITEMS.TO.DELETEş      ITEM.TO.DELETE=ITEMS.TO.DELETE<I>ş      FOBJ=SAVE.FOBJş      CALL @WOBJ.RTNE(FOBJ,"SET","action","DELETE","",RERR)ş      CALL @WOBJ.RTNE(FOBJ,"SET","path",ITEM.TO.DELETE,"",RERR)ş      IF DO.DEBUG THENş         CRT "Normally trying to delete: ":ITEM.TO.DELETEş      END ELSEş         CALL MVDBTOOLKIT.WFILEIO(FOBJ)ş      ENDşNEXT IşşCALL @WOBJ.RTNE(PASSED.WOBJ,"SET.STRING","response.curl_cmnd",CMND,"",RERR)şşRETURNşş000F60MVDB.PACKAGE.INSTALLER.SUBş0c2SUBROUTINE MVDB.PACKAGE.INSTALLER.SUB(PACKAGE,RESULT)şş      * Install packagesşş      * first, get a list of packagesşş      CALL WOBJ(COBJ,"FROMJSON","","{}","",RERR)şş      CALL MVDBTOOLKIT.WPLATFORM(PLATFORM.OBJ)şş      CALL WOBJ(PLATFORM.OBJ,"GET","packagesurl",PACKAGES.URL,"",RERR)şş      IF PACKAGES.URL = "" THENş         PACKAGES.URL="https://raw.githubusercontent.com/zumasys/MVConnect/master/packages.json"ş      ENDşş      CALL WOBJ(PLATFORM.OBJ,"GET","mvtype",MVTYPE,"",RERR)ş      ş      MVTYPE=OCONV(MVTYPE,"MCU")ş      ş      BEGIN CASEş         CASE MVTYPE="D3"; MVTYPE2="d3"ş         CASE MVTYPE="JBASE"; MVTYPE2="jb"ş         CASE MVTYPE="QM"; MVTYPE2="qm"ş         CASE MVTYPE="UNIVERSE"; MVTYPE2="uv"ş         CASE MVTYPE="UNIDATA"; MVTYPE2="ud"ş         CASE 1ş             PRINT "Platform ":MVTYPE:" not supported"ş             RETURNş      END CASEş      ş      CALL WOBJ(PLATFORM.OBJ,"GET","tmpdir",TMP.DIR,"",RERR)ş      ş      CALL WOBJ(PLATFORM.OBJ,"GET","filedelim",FILEDELIM,"",RERR)ş      ş      *PRINT "Packages url: ":PACKAGES.URLşş      CALL WOBJ(COBJ,"SET","url",PACKAGES.URL,"",RERR)ş      CALL WOBJ(COBJ,"SET","method","GET","",RERR)şş      *CRT "Getting package list...":şş      CALL MVDBTOOLKIT.WCALL(COBJ)şş      *CALL MVDBTOOLKIT.WCALL.DEBUG(COBJ)şşş      CALL WOBJ(COBJ,"GET","response.status",RESPONSE.STATUS,"",RERR)şş      CALL WOBJ(COBJ,"GET","response.statusmsg",RESPONSE.STATUS.MSG,"",RERR)ş      CALL WOBJ(COBJ,"GET","response.data",RESPONSE.DATA,"",RERR)şş      *PRINT RESPONSE.STATUS:' ':RESPONSE.STATUS.MSGşş      CALL WOBJ(POBJ,"FROMJSON","",RESPONSE.DATA,"",RERR)şş      IF RERR>0 THENş         PRINT RERR<1>:" Error: ":RERR<2>ş         RETURNş      ENDşş      CALL WOBJ(POBJ,"LENGTH","packages",NUMBER.PACKAGES,"",RERR)şş      *PRINT "Number packages: ":NUMBER.PACKAGESşştop.of.packages: *şş      PACKAGES=""ş      ş      FOR P=1 TO NUMBER.PACKAGESşş         CALL WOBJ(POBJ,"GET","packages[":P-1:"].name",PACKAGE.NAME,"",RERR)ş         CALL WOBJ(POBJ,"GET","packages[":P-1:"].version",PACKAGE.VERSION,"",RERR)şş       *  PRINT P"MR(#4)":ş       *  PRINT " ":ş       *  PRINT PACKAGE.NAME:ş         PACKAGES<P>=PACKAGE.NAMEş         ş       *  PRINT " ":ş       *  PRINT PACKAGE.VERSIONş      NEXT Pşş      *PRINT "Package # to install or return to quit ":; INPUT PACKAGEş      ş      IF PACKAGE="" THEN STOPş      IF NOT(NUM(PACKAGE)) THENş           LOCATE PACKAGE IN PACKAGES SETTING PACKAGE ELSE STOPş      ENDş      ş      IF PACKAGE < 1 OR PACKAGE > NUMBER.PACKAGES THEN STOPşş      CALL WOBJ(POBJ,"GET","packages[":PACKAGE-1:"].name",PACKAGE.NAME,"",RERR)ş      CALL WOBJ(POBJ,"GET","packages[":PACKAGE-1:"].version",PACKAGE.VERSION,"",RERR)şş      PRINT "Installing ":PACKAGE.NAME:" ":PACKAGE.VERSIONş      ş      PRINT "Platform ":MVTYPE:' ':MVTYPE2ş      PRINT "Temp Directory: ":TMP.DIRş      PRINT "O/S delim: ":FILEDELIMş      ş      COBJ=""ş      CALL WOBJ(COBJ,"FROMSTRING","","{}","",RERR)ş      ş      PACKAGE.FILE.NAME=PACKAGE.NAME:"-":MVTYPE2:".pkg"ş      ş      URL="https://raw.githubusercontent.com/zumasys/MVConnect/master/packages/":MVTYPE2ş      URL:="/":PACKAGE.FILE.NAMEş      ş      PRINT URLş      ş      FULL.PACKAGE.PATH=TMP.DIR:FILEDELIM:PACKAGE.FILE.NAMEş      ş      PRINT "Downloading ":URL:" to ":FULL.PACKAGE.PATHş      ş      CALL WOBJ(COBJ,"SET","url",URL,"",RERR)ş      CALL WOBJ(COBJ,"SET","method","GET","",RERR)ş      CALL WOBJ(COBJ,"SET","options"," -o ":TMP.DIR:FILEDELIM:PACKAGE.FILE.NAME,"",RERR)ş      ş      CALL MVDBTOOLKIT.WCALL(COBJ)ş      *CALL MVDBTOOLKIT.WCALL.DEBUG(COBJ)ş      ş      CALL WOBJ(COBJ,"GET","response.status",RESPONSE.STATUS,"",RERR)şş      CALL WOBJ(COBJ,"GET","response.statusmsg",RESPONSE.STATUS.MSG,"",RERR)ş      ş      PRINT "Response: ":RESPONSE.STATUS,RESPONSE.STATUS.MSGş      ş      DATA FULL.PACKAGE.PATHş      EXECUTE 'MVDBTOOLKIT.APP.INSTALLER'ş      ş      şRETURNşş000169MVDBTOOLKIT.SWAP.UNIVERSEş0c2SUBROUTINE MVDBTOOLKIT.SWAP.UNIVERSE(V,F,T)şşIF F=T THEN RETURNşIF F='' THEN RETURNşş* Let's do this manually since Universe Exchange does NOT workşCNTR=0şLOOPş   CNTR+=1ş   POS=INDEX(V,F,1)şUNTIL NOT(POS) OR CNTR > 100000 DOşş   PRE.STRING=V[1,POS-1]ş   AFT.STRING=V[POS+LEN(F),LEN(V)]ş   V=PRE.STRING:T:AFT.STRINGşşREPEATşşRETURNş00018CMVDBTOOLKIT.WOBJ.CHOOSE.WOBJş0c2* Code to determine default wobj library to useşş* This needs to change for MVDBTOOLKIT build, defaults to WOBJşşWOBJ.RTNE="WOBJ"şşNO.MD.FILE=0şşOPEN "MD" TO FILE.MD ELSEş    OPEN "VOC" TO FILE.MD ELSE NO.MD.FILE=1şENDşşIF NOT(NO.MD.FILE) THENş    READ WOBJ.CONF FROM FILE.MD, "WOBJ.CONF" ELSE WOBJ.CONF=""şş    IF WOBJ.CONF<3> # "" THEN WOBJ.RTNE=WOBJ.CONF<3>şEND003E86MVDBTOOLKIT.CONFIGş0c2      PRINT @(-1):"MVDBTOOLKIT.CONFIG"ş      PRINTşş      COMMON /MVMKCOM/ MVMAKE.SUB.COMMON.INFOşş      MVMAKE.SUB.COMMON.INFO=""; * DO NOT USE FOR THIS VERSIONşş      IF MVMAKE.SUB.COMMON.INFO="" OR MVMAKE.SUB.COMMON.INFO = "0" THENş         *    CRT "MVDBTOOLKIT.CONFIG MUST BE CALLED FROM MVMAKE"ş         *    STOPş      ENDşş      INCLUDE MVDBTOOLKIT.TEST.INCLUDEşş      INCLUDE MVDBTOOLKIT.WOBJ.CHOOSE.WOBJşş      OPEN "DICT","MVDBTOOLKIT.BP" TO DICT.MVDBTOOLKIT.BP ELSE STOPşş      * 4/29/2020 - pap - This entire excercise it to get MV.PLATFORM.JSON populated theş      *                   first time.  MVMAKE already asked the questions, if the file didş      *                   not exist those answers will be passed to use via the common.ş      *                   The reason mvmake cannot fix this is the file to the dictionaryş      *                   is created later.  If MVmake tries to write it out it has toş      *                   read it in properly due to items this process populates, such asş      *                   TMPDIR.  If the package does not properly install thenş      *                   WOBJ may not be available.  Better to do it all here.ş      *ş      *                   Therefore we manually read the file, update PLATFORM and MVTYPEş      *                   and write it back.  We then call WPLATFORM and move on as normalşş      READ PLATFORM.JSON FROM DICT.MVDBTOOLKIT.BP, "MV.PLATFORM.JSON" ELSE PLATFORM.JSON="{}"ş      IF TRIM(PLATFORM.JSON) = "" THEN PLATFORM.JSON="{}"şş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"FROMSTRING","",PLATFORM.JSON,"",RERR)şş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","platform",PLATFORM,"",RERR)ş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","mvtype",MVTYPE,"",RERR)şş      IF MVMAKE.SUB.COMMON.INFO<2> # "" THEN PLATFORM=MVMAKE.SUB.COMMON.INFO<2>ş      IF MVMAKE.SUB.COMMON.INFO<3> # "" THEN MVTYPE=MVMAKE.SUB.COMMON.INFO<3>şşşş      IF PLATFORM="" OR MVTYPE="" THENş         ** LETS FIGURE OUT THE PLATFORM **ş         EXECUTE 'jdiag' CAPTURING RESULTş         RESULT=OCONV(RESULT,"MCU")ş         IF INDEX(RESULT,'JBASE',1) THENş            MVTYPE="JBASE"ş            OS.POS=INDEX(RESULT,"OS RELEASE",1)ş            OS.TYPE=RESULT[OS.POS,9999]ş            OS.TYPE=OS.TYPE<1,1,1>ş            OS.TYPE=OCONV(OS.TYPE,"MCU")ş            IF INDEX(OS.TYPE,"WINDOWS",1) THENş               PLATFORM="WINDOWS"ş            END ELSEş               PLATFORM="LINUX"ş            ENDş            GOTO end.of.mvtypeş         ENDşş         EXECUTE 'WHICH' CAPTURING RESULTş         RESULT=OCONV(RESULT,"MCU")ş         IF INDEX(RESULT,"D3",1) THENş            MVTYPE="D3"ş            IF INDEX(RESULT,"WINDOWS",1) THENş               PLATFORM="WINDOWS"ş            END ELSEş               PLATFORM="LINUX"ş            ENDş            GOTO end.of.mvtypeş         ENDşş         EXECUTE 'CT ERRMSG 335 (N' CAPTURING RESULTş         IF INDEX(OCONV(RESULT,"MCU"),"MVBASE",1) THENş            MVTYPE="MVBASE"; * NOT SUPPORTEDş            GOTO end.of.mvtypeş         ENDşş         EXECUTE "VERSION" CAPTURING RESULTş         IF INDEX(OCONV(RESULT,"MCU"),"UNIDATA",1) THENş            MVTYPE="UNIDATA"ş            EXECUTE '!SET' CAPTURING OS.TYPEş            OS.TYPE=OCONV(OS.TYPE,'MCU')ş            IF INDEX(OS.TYPE,"WINDIR",1) THENş               PLATFORM="WINDOWS"ş            END ELSEş               PLATFORM="LINUX"ş            ENDş            GOTO end.of.mvtypeş         ENDşş         EXECUTE "CT VOC QM.ACCOUNTS" CAPTURING RESULTş         IF INDEX(OCONV(RESULT,"MCU"),"QMSYS",1) THENş            MVTYPE="QM"ş            EXECUTE '!SET' CAPTURING OS.TYPEş            OS.TYPE=OCONV(OS.TYPE,'MCU')ş            IF INDEX(OS.TYPE,"WINDIR",1) THENş               PLATFORM="WINDOWS"ş            END ELSEş               PLATFORM="LINUX"ş            ENDş            GOTO end.of.mvtypeş         ENDşş         EXECUTE 'CT VOC UVPROMPT' CAPTURING RESULTş         IF INDEX(OCONV(RESULT,"MCU"),"1 V",1) THENş            MVTYPE="UNIVERSE"ş            EXECUTE 'sh -c "pwd"' CAPTURING RESULTş            IF INDEX(OCONV(RESULT,"MCU"),"NOT AVAILABLE",1) THENş               PLATFORM="WINDOWS"ş            END ELSEş               PLATFORM="LINUX"ş            ENDş            GOTO end.of.mvtypeş         ENDşşend.of.mvtype: *şş         IF PLATFORM="" THENş            PRINT "NO PLATFORM FOUND"; STOPş            PRINT "ENTER PLATFORM (LINUX OR WINDOWS)[":PLATFORM:"]: ":; INPUT TMP.ANSş            IF TMP.ANS # "" THEN PLATFORM=TMP.ANSşş            PLATFORM=OCONV(PLATFORM,"MCU")şş            BEGIN CASEş               CASE PLATFORM="WINDOWS"ş                  D3.PREFIX="dos"ş                  PLATFORM.DELIM="\"ş               CASE PLATFORM="LINUX"ş                  D3.PREFIX="unix"ş                  PLATFORM.DELIM="/"ş               CASE 1ş                  CRT "Invalid Platform ":PLATFORM; STOPş            END CASEş         ENDşş         IF MVTYPE="" THENş            PRINT "NO MVTYPE FOUND"; STOPş            PRINT "ENTER MVTYPE (JBASE, QM, D3, UNIVERSE, UNIDATA)[":MVTYPE:"] ":; INPUT TMP.ANSş            IF TMP.ANS # "" THEN MVTYPE = TMP.ANSşş            MVTYPE=OCONV(MVTYPE,"MCU")şş            BEGIN CASEş               CASE MVTYPE="JBASE"ş               CASE MVTYPE="QM"ş               CASE MVTYPE="D3"ş               CASE MVTYPE="UNIVERSE"ş               CASE MVTYPE="UNIDATA"ş               CASE 1ş                  CRT "Invalid MVTYPE"; STOPş            END CASEş         ENDşş      ENDşş      MVMAKE.SUB.COMMON.INFO<1>='REBUILD'ş      MVMAKE.SUB.COMMON.INFO<2>=PLATFORMş      MVMAKE.SUB.COMMON.INFO<3>=MVTYPEşş      PRINT "Platform:      ":PLATFORMş      PRINT "MV type :      ":MVTYPEş      PRINTşş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"SET","platform",PLATFORM,"",RERR)ş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"SET","mvtype",MVTYPE,"",RERR)şş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"SET","platform",MVMAKE.SUB.COMMON.INFO<2>,"",RERR)ş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"SET","mvtype",MVMAKE.SUB.COMMON.INFO<3>,"",RERR)şş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"TOSTRING","",PLATFORM.JSON,"PRETTIFY",RERR)ş      CONVERT CHAR(13) TO @AM IN PLATFORM.JSONş      CONVERT CHAR(10) TO '' IN PLATFORM.JSONş      WRITE PLATFORM.JSON ON DICT.MVDBTOOLKIT.BP, "MV.PLATFORM.JSON"şş      CALL MVDBTOOLKIT.WPLATFORM(PLATFORM.OBJ)şş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","platform",PLATFORM,"",RERR)ş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","mvtype",MVTYPE,"",RERR)ş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","filedelim",FILEDELIM,"",RERR)şş      IF PLATFORM = "" THENş         CRT "No platform configured!!!"; STOPş      ENDşş      IF MVTYPE = "" THENş         CRT "No MVType configured!!!"; STOPş      ENDşş      * GET ENVIRONMENTşş      * Let get our current directoryş      TEST="pwd"; GOSUB start.testş      IF OCONV(PLATFORM,"MCU") = "WINDOWS" THENş         CMND='echo %CD%'ş      END ELSEş         CMND='pwd'ş      ENDşş      CALL @WOBJ.RTNE(COBJ,"FROMSTRING","","{}","",RERR)ş      CALL @WOBJ.RTNE(COBJ,"SET","command",CMND,"",RERR)ş      CALL MVDBTOOLKIT.WEXECUTE(COBJ)ş      CALL @WOBJ.RTNE(COBJ,"GET","result.result",CMND.RESULT,"",RERR)ş      CONVERT CHAR(13):CHAR(10) TO '' IN CMND.RESULTş      TEST.STATUS=1ş      TEST.MSG=CMND.RESULTş      GOSUB end.testşş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","tmpdir",TMP.PATH,"",RERR)şş      IF TMP.PATH="" THENşş         IF MVMAKE.SUB.COMMON.INFO<5>="" THEN MVMAKE.SUB.COMMON.INFO<5>="mvdbtoolkit"şşIF MVTYPE="QM" THENş    EXECUTE '!mkdir TMP'şENDş         BEGIN CASEş            CASE MVTYPE="D3" AND PLATFORM="LINUX"ş               * DANG D3 HAS IT'S OWN DANG FILE SYSTEM, LETS JUST CREATE A TMP DIR AND MOVEş               TMP.PATH="/tmp"ş            CASE MVTYPE="D3" AND PLATFORM="LINUX"ş               TMP.DATH="c:\tmp"ş               EXECUTE '!mkdir c:\tmp'ş            CASE OCONV(MVMAKE.SUB.COMMON.INFO<5>,"MCU") = "MVDBTOOLKIT"ş               * WE HAVE RELATIVE POSITIONINGş               TMP.PATH=CMND.RESULT:FILEDELIM:"TMP"ş               MVDBTOOLKIT.LOCATION=CMND.RESULTş            CASE 1ş               TMP.PATH=MVMAKE.SUB.COMMON.INFO<5>:FILEDELIM:"TMP"ş               MVDBTOOLKIT.LOCATION=MVMAKE.SUB.COMMON.INFO<5>ş         END CASEşş      ENDşşş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"SET","tmpdir",TMP.PATH,"",RERR)ş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"SET","mvdbtoolkitlocation",MVDBTOOLKIT.LOCATION,"",RERR)ş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","curllocation",CURLLOCATION,"",RERR)şş      TEST='tmpdir'; GOSUB start.testş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"GET","tmpdir",TMP.DIR,"",RERR)ş      TEST.MSG=TMP.DIRş      TEST.STATUS=1ş      IF TMP.DIR="" THEN TEST.STATUS=0ş      GOSUB end.testşşş      TEST='MVDBTOOLKIT.SWAP'ş      GOSUB start.testş      S='TEST LINE TEST LINE'ş      ORIG.STRING=Sş      CALL MVDBTOOLKIT.SWAP(S,"ES","XX")ş      IF S = "TXXT LINE TXXT LINE" THEN TEST.STATUS=1 ELSE TEST.STATUS=0ş      TEST.MSG=Sş      GOSUB end.testşş      * Test 1 Getenvşş      TEST="getenv"ş      GOSUB start.testş      CALL MVDBTOOLKIT.WGETENV("PATH",PATH)ş      IF PATH # "" THENş         TEST.MSG=PATH[1,60]ş         TEST.STATUS=1ş      END ELSEş         TEST.MSG=""ş         TEST.STATUS=0ş      ENDş      GOSUB end.testşş      * Test WEXECUTEşş      TEST="wexecute"; GOSUB start.testş      CMND='echo MVDBTOOLKIT.TEST'şş      CALL @WOBJ.RTNE(COBJ,"FROMSTRING","","{}","",RERR)ş      CALL @WOBJ.RTNE(COBJ,"SET","command",CMND,"",RERR)ş      CALL MVDBTOOLKIT.WEXECUTE(COBJ)ş      CALL @WOBJ.RTNE(COBJ,"GET","result.result",CMND.RESULT,"",RERR)şş      IF INDEX(CMND.RESULT,"MVDBTOOLKIT.TEST",1) THENş         TEST.MSG=CMND.RESULTş         TEST.STATUS=1ş      END ELSEş         TEST.MSG=CMND.RESULTş         TEST.STATUS=0ş      ENDş      CONVERT CHAR(13):CHAR(10) TO '' IN TEST.MSGş      GOSUB end.testşş      * Test WFILEIOşş      TEST="WFILEIO-WRITE"şş      USER.NO=FIELD(OCONV('','U50BB'),' ',1)ş      GOSUB start.testş      CALL @WOBJ.RTNE(FOBJ,"FROMSTRING","","{}","",RERR)ş      CALL @WOBJ.RTNE(FOBJ,"SET","action","WRITE","",RERR)ş      TMP.FILE.NAME=TMP.DIR:FILEDELIM:'TMP-':USER.NO:'.txt'ş      TEST.MSG=TMP.FILE.NAMEşş      CALL @WOBJ.RTNE(FOBJ,"SET","path",TMP.FILE.NAME,"",RERR)ş      SAVE.FOBJ=FOBJş      TMP.DATA=TIMEDATE()ş      CALL @WOBJ.RTNE(FOBJ,"SET","data",TMP.DATA,"",RERR)ş      CALL MVDBTOOLKIT.WFILEIO(FOBJ)ş      CALL @WOBJ.RTNE(FOBJ,"GET","response.status",RESPONSE.STATUS,"",RERR)ş      CALL @WOBJ.RTNE(FOBJ,"GET","response.statusmsg",RESPONSE.STATUS.MSG,"",RERR)ş      TEST.STATUS=RESPONSE.STATUSş      IF NOT(RESPONSE.STATUS) THEN TEST.MSG:=RESPONSE.STATUS.MSGş      GOSUB end.testşş      IF NOT(TEST.STATUS) THEN STOP "Test Failed, no reason to continue"şş      TEST='WFILEIO-READ'ş      GOSUB start.testşş      * NOW READ IT BACK INş      CALL @WOBJ.RTNE(FOBJ,"SET","action","READ","",RERR)ş      CALL MVDBTOOLKIT.WFILEIO(FOBJ)ş      CALL @WOBJ.RTNE(FOBJ,"GET","response.data",RESPONSE.DATA,"",RERR)şş      TEST.MSG="(":TMP.DATA:')=(':RESPONSE.DATA:")"ş      TEST.STATUS=1ş      IF TMP.DATA # RESPONSE.DATA THEN TEST.STATUS=0ş      GOSUB end.testşş      TEST="WFILEIO-DELETE"; GOSUB start.testş      FOBJ=SAVE.FOBJş      CALL @WOBJ.RTNE(FOBJ,"SET","action","DELETE","",RERR)ş      CALL MVDBTOOLKIT.WFILEIO(FOBJ)şş      FOBJ=SAVE.FOBJş      CALL @WOBJ.RTNE(FOBJ,"SET","action","READ","",RERR)ş      CALL MVDBTOOLKIT.WFILEIO(FOBJ)ş      RESPONSE.DATA=""şş      CALL @WOBJ.RTNE(FOBJ,"GET","response.data",RESPONSE.DATA,"",RERR)ş      CALL @WOBJ.RTNE(FOBJ,"GET","response.status",RESPONSE.STATUS,"",RERR)ş      CALL @WOBJ.RTNE(FOBJ,"GET","response.statusmsg",RESPONSE.STATUSMSG,"",RERR)ş      TEST.STATUS=1ş      TEST.MSG=TMP.FILE.NAME:' ':RESPONSE.STATUSş      IF RESPONSE.STATUS=0 AND RESPONSE.DATA="" THEN NULL ELSE TEST.STATUS=0ş      GOSUB end.testşş      * Let get our current directoryş      TEST="pwd"; GOSUB start.testş      IF OCONV(PLATFORM,"MCU") = "WINDOWS" THENş         CMND='echo %CD%'ş      END ELSEş         CMND='pwd'ş      ENDşş      CALL @WOBJ.RTNE(COBJ,"FROMSTRING","","{}","",RERR)ş      CALL @WOBJ.RTNE(COBJ,"SET","command",CMND,"",RERR)ş      CALL MVDBTOOLKIT.WEXECUTE(COBJ)ş      CALL @WOBJ.RTNE(COBJ,"GET","result.result",CMND.RESULT,"",RERR)şş      IF 1 THENş         TEST.MSG=CMND.RESULTş         TEST.STATUS=1ş      END ELSEş         TEST.MSG=CMND.RESULTş         TEST.STATUS=0ş      ENDş      CONVERT CHAR(13):CHAR(10) TO '' IN TEST.MSGş      GOSUB end.testşş      MVDBTOOLKIT.LOCATION = CMND.RESULTşş      * Lets verify we have curl!!!şş      IF CURLLOCATION="" THEN CURLLOCATION="curl"şş      TEST="default curl"; GOSUB start.testş      CMND=CURLLOCATION:' -V'şş      CALL @WOBJ.RTNE(COBJ,"FROMSTRING","","{}","",RERR)ş      CALL @WOBJ.RTNE(COBJ,"SET","command",CMND,"",RERR)ş      CALL MVDBTOOLKIT.WEXECUTE(COBJ)ş      CALL @WOBJ.RTNE(COBJ,"GET","result.result",CMND.RESULT,"",RERR)şş      BEGIN CASEş         CASE INDEX(CMND.RESULT,"libcurl",1) AND 1ş            TEST.MSG=CMND.RESULTş            TEST.STATUS=1ş         CASE OCONV(PLATFORM,"MCU")="WINDOWS"ş            TEST.MSG=CMND.RESULTş            CURLLOCATION=""ş            TEST.STATUS=2ş         CASE 1ş            TEST.MSG=0ş      END CASEşş      CONVERT CHAR(13):CHAR(10) TO '' IN TEST.MSGş      GOSUB end.testşş      * THIS IS SLOPPY CODEşş      IF CURLLOCATION="" AND PLATFORM="WINDOWS" THENş         * Start looking for curlş         IF TEST.STATUS=2 THENş            CURLLOCATION="C:\PROGRA~2\Zumasys\MVDASH~1\bin\curl.exe"ş            TEST="curl via mvconnect"; GOSUB start.testş            CMND=CURLLOCATION:' -V'şş            CALL @WOBJ.RTNE(COBJ,"FROMSTRING","","{}","",RERR)ş            CALL @WOBJ.RTNE(COBJ,"SET","command",CMND,"",RERR)ş            CALL MVDBTOOLKIT.WEXECUTE(COBJ)ş            CALL @WOBJ.RTNE(COBJ,"GET","result.result",CMND.RESULT,"",RERR)şş            BEGIN CASEş               CASE INDEX(CMND.RESULT,"libcurl",1) AND 1ş                  TEST.MSG=CMND.RESULTş                  TEST.STATUS=1ş               CASE OCONV(PLATFORM,"MCU")="WINDOWS"ş                  TEST.MSG=CMND.RESULTş                  TEST.STATUS=2ş               CASE 1ş                  TEST.MSG=CMND.RESULTş                  TEST.STATUS=0ş            END CASEşş            CONVERT CHAR(13):CHAR(10) TO '' IN TEST.MSGş            GOSUB end.testş         ENDşş         IF TEST.STATUS=2 THENş            CURLLOCATION="c:\progra~1\git\mingw64\bin\curl.exe"şş            TEST="curl via git"; GOSUB start.testş            CMND=CURLLOCATION:' -V'şş            CALL @WOBJ.RTNE(COBJ,"FROMSTRING","","{}","",RERR)ş            CALL @WOBJ.RTNE(COBJ,"SET","command",CMND,"",RERR)ş            CALL MVDBTOOLKIT.WEXECUTE(COBJ)ş            CALL @WOBJ.RTNE(COBJ,"GET","result.result",CMND.RESULT,"",RERR)şş            BEGIN CASEş               CASE INDEX(CMND.RESULT,"libcurl",1) AND 0ş                  TEST.MSG=CMND.RESULTş                  TEST.STATUS=1ş               CASE 1ş                  TEST.STATUS=0ş                  TEST.MSG=CMNDşş            END CASEşş            CONVERT CHAR(13):CHAR(10) TO '' IN TEST.MSGş            GOSUB end.testş         ENDşş         IF CURLLOCATION # "" THENş            CALL @WOBJ.RTNE(PLATFORM.OBJ,"SET","curllocation",CURLLOCATION,"",RERR)ş         ENDşş      ENDşşş      CALL @WOBJ.RTNE(PLATFORM.OBJ,"TOSTRING","",PLATFORM.JSON,"PRETTIFY",RERR)ş      CONVERT CHAR(13) TO @AM IN PLATFORM.JSONş      CONVERT CHAR(10) TO '' IN PLATFORM.JSONşş      WRITE PLATFORM.JSON ON DICT.MVDBTOOLKIT.BP, "MV.PLATFORM.JSON"şş      STOPş      *ş      RETURNş      *şprocess.error: *ş      IF RERR<1> THENş         TEST.STATUS=-1ş         TEST.MSG=RERR<1>ş      ENDş      RETURNş      *ş      *şstart.test: *ş      TEST.STATUS=0ş      TEST.MSG="Success"ş      PRINT "":TEST[1,15]"L(#15)":ş      RETURNş      *şend.test: *ş      PRINT "  ":TEST.MSG[1,50]"L(#50)":ş      PRINT " ":ş      PRE=''; AFT=''ş      BEGIN CASEş         CASE TEST.STATUS=2; ERROR="Warning"; PRE=''; AFT=''ş         CASE TEST.STATUS; ERROR="Passed"ş         CASE 1; ERROR="Failed"; PRE=@(-13); AFT=@(-14)ş      END CASEş      PRINT PRE:"[":ş      PRINT ERROR"L(#7)":ş      PRINT "]":AFTş      RETURNşşşş000CA7MVDBTOOLKIT.WEXECUTEş0c2SUBROUTINE MVDBTOOLKIT.WEXECUTE(EOBJ)şINCLUDE MVDBTOOLKIT.WEXECUTE.INCLUDEş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: June 12, 2018ş* Description: Execute libraryş*ş**********************************************************************ş*ş* EOBJş* { "command":"COMMAND TO USE",ş*    "directory":"OPTIONAL DIRECTORY TO RUN IN",ş*    "debug":"YES OR NO",ş*    "docapture":"YES OR NO, DEFAULT YES",ş*    "returning":"YES OR NO, DEFAULT YES",ş*    "rtndata":"YES OR NO, DEFAULT NO",ş*    "passlist":"ACTUAL PASSLIST"ş*    "data": ["ARRAY OF DATA STATEMENTS"],ş*    "result: {wş*                "result":"RESULT IF CAPTURED",ş*                "rtndata":"RESULT OF RTNDATA",ş*                "returning":"RESULT OF RETURNING",ş*                "debug":"DEBUG INFORMATION IF TURNED ON"ş*    }ş*    }şINCLUDE MVDBTOOLKIT.WOBJ.CHOOSE.WOBJşş* With native objects we cannot do this.  We will needş* a platform specific way of recognizing this.ş* Perhaps changes itself to WOBJ?şşIF ''="NEW" THENş    * CREATE A NEW OBJECT AND RETURN ITş    EJSON=\{ "command":"",\ş    EJSON:=\ "directory":"",\ş    EJSON:=\ "debug":"NO",\ş    EJSON:=\ "returning":"YES",\ş    EJSON:=\ "rtndata":"YES",\ş    EJSON:=\ "passlist":"",\ş    EJSON:=\ "data: []"\ş    EJSON:=\}\şş    CALL @WOBJ.RTNE(EOBJ,"FROMSTRING","",EJSON,"",RERR)ş    RETURNşENDşşCALL @WOBJ.RTNE(EOBJ,"GET","command"      ,EXECUTE.COMMAND        ,"",RERR)şCALL @WOBJ.RTNE(EOBJ,"GET","directory"    ,EXECUTE.DIRECTORY      ,"",RERR)şCALL @WOBJ.RTNE(EOBJ,"GET","docapture"    ,EXECUTE.DOCAPTURE      ,"",RERR)şCALL @WOBJ.RTNE(EOBJ,"GET","returning"    ,EXECUTE.RETURNING      ,"",RERR)şCALL @WOBJ.RTNE(EOBJ,"GET","rtndata"      ,EXECUTE.RTNDATA        ,"",RERR)şCALL @WOBJ.RTNE(EOBJ,"GET","passlist"     ,EXECUTE.PASSLIST       ,"",RERR)şCALL @WOBJ.RTNE(EOBJ,"GET","debug"        ,EXECUTE.DEBUG          ,"",RERR)şIF EXECUTE.DEBUG = "" THENş    CALL @WOBJ.RTNE(EOBJ,"GET","DEBUG",EXECUTE.DEBUG,"",RERR)şENDşşIF OCONV(EXECUTE.DEBUG[1,1],"MCU") = "Y" OR EXECUTE.DEBUG="1" THEN EXECUTE.DEBUG=1 ELSE EXECUTE.DEBUG=0şşIF EXECUTE.DEBUG THENş    *CRT "EXECUTE.COMMAND: ":EXECUTE.COMMANDş    *CRT "DIRECTORY      : ":EXECUTE.DIRECTORYş    *CRT "OCAPTURE       : ":EXECUTE.OCAPTUREş    *CRT "RETURNING      : ":EXECUTE.RETURNINGşENDşşCALL @WOBJ.RTNE(EOBJ,"TOSTRING","",TEST.JSON,"",RERR)şşş* ERROR HANDLING TODOşşCALL @WOBJ.RTNE(EOBJ,"SET.OBJECT","result","{}","",RERR)şşCALL MVDBTOOLKIT.WPLATFORM(PLATFORMOBJ)şşCALL @WOBJ.RTNE(PLATFORMOBJ,"GET","mvtype",MV.TYPE,"",RERR)şşBEGIN CASEş   CASE MV.TYPE='D3'ş       CALL MVDBTOOLKIT.WEXECUTE.D3(EOBJ)ş   CASE MV.TYPE='UNIDATA'ş       CALL MVDBTOOLKIT.WEXECUTE.UNIDATA(EOBJ)ş   CASE MV.TYPE="QM"ş       CALL MVDBTOOLKIT.WEXECUTE.QM(EOBJ)ş   CASE MV.TYPE="JBASE"ş       CALL MVDBTOOLKIT.WEXECUTE.JBASE(EOBJ)ş   CASE MV.TYPE="UNIVERSE"ş       CALL MVDBTOOLKIT.WEXECUTE.UNIVERSE(EOBJ)ş   CASE 1ş        CALL @WOBJ.RTNE(EOBJ,"SET","result.error","Invalid mvplatform=":MV.TYPE,"",RERR)şEND CASEş*ş*EXECUTE CHAR(255):'k':CMND CAPTURING RESULTş*CONVERT CHAR(0) TO '' IN RESULTş*CONVERT CHAR(255) TO '' IN RESULTşRETURNş0003F8MVDBTOOLKIT.WPLATFORM.SAVEş0c2      SUBROUTINE MVDBTOOLKIT.WPLATFORM.SAVE(PLATFORMOBJ)ş      **********************************************************************ş      *ş      * Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş      *ş      * Written by: Patrick Payne, Zumasysş      * Date: June 12, 2018ş      * Description: WPLATFORM OBJş      *ş      **********************************************************************ş      *ş      *ş      * PLATFORMOBJş      *ş      * {ş      *   "platform":" WINDOWS OR LINUX",ş      *   "mvtype"  :" JBASE, D3, UNIDATA, UNIVERSE, OPENQM",ş      *   "tmpdir"  :"tmp dir"ş      * }şş      * nEW lINEşş      INCLUDE MVDBTOOLKIT.WOBJ.CHOOSE.WOBJş      ş      USE.DICT=1ş      OPEN "DICT","MVDBTOOLKIT.BP" TO DICT.MVDBTOOLKIT.BP ELSE USE.DICT=0şş      CALL @WOBJ.RTNE(PLATFORMOBJ,"TOJSON","",OUT.JSON,"PRETTIFY",RERR)ş      ş      CALL MVDBTOOLKIT.SWAP(OUT.JSON,CHAR(13):CHAR(10),@AM)ş      ş      WRITE OUT.JSON ON DICT.MVDBTOOLKIT.BP, "MV.PLATFORM.JSON"şş      RETURN000A9FMVDBTOOLKIT.WEXECUTE.UNIVERSEş0c2SUBROUTINE MVDBTOOLKIT.WEXECUTE.UNIVERSE(EOBJ)şINCLUDE MVDBTOOLKIT.WEXECUTE.INCLUDEş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: June 12, 2018ş* Description: Execute library UNIVERSE VERSIONş*ş**********************************************************************şşINCLUDE MVDBTOOLKIT.WOBJ.CHOOSE.WOBJşşE.RESULTS=""şE.RETURNING=""şE.RTNDATA=""şşITEMS.TO.DELETE=''şşCALL @WOBJ.RTNE(EOBJ,"GET","debug",DO.DEBUG,"",RERR)şşIF OCONV(DO.DEBUG[1,1],"MCU") = "Y" OR DO.DEBUG="1" THEN DO.DEBUG=1 ELSE DO.DEBUG=""şşDO.DEBUG=1şCALL @WOBJ.RTNE(EOBJ,"LENGTH","data",NUM.DATA,"",RERR)şşFOR X=1 TO NUM.DATAş    CALL @WOBJ.RTNE(EOBJ,"GET","data[":X-1:"]",THIS.DATA,"",RERR)ş    *PRINT "DATA: ":THIS.DATAş    DATA THIS.DATAşNEXT XşşCALL MVDBTOOLKIT.WPLATFORM(PLATFORMOBJ)şşCALL @WOBJ.RTNE(PLATFORMOBJ,"GET","platform",PLATFORM,"",RERR)şşIF PLATFORM="WINDOWS" THEN PRE.CMND="dos /c" ELSE PRE.CMND="sh -c"şş*IF PLATFORM="WINDOWS" THENşIF INDEX(EXECUTE.COMMAND,'"',1) OR INDEX(EXECUTE.COMMAND,'$',1) THENş   *CALL MVDBTOOLKIT.SWAP.UNIVERSE(EXECUTE.COMMAND,'$','')ş   * LETS WRITE THIS OUT AND ADJUST THE COMMAND TO EXECUTE THAT BATCH FILEş   IF PLATFORM="WINDOWS" THEN EXTENSION=".bat" ELSE EXTENSION=".sh"ş   CALL @WOBJ.RTNE(PLATFORMOBJ,"GET","tmpdir",TMP.DIR,"",RERR)ş   CALL @WOBJ.RTNE(PLATFORMOBJ,"GET","filedelim",FILE.DELIM,"",RERR)ş   şş   CALL MVDBTOOLKIT.EXPAND.PATH(TMP.DIR)ş   TMP.DIR:=FILE.DELIMşş   USER.NO=FIELD(OCONV('','U50BB'),' ',1)ş   SESSION.ID="WEXECUTE-":USER.NOşş   CALL @WOBJ.RTNE(FOBJ,"FROMSTRING","","{}","",RERR)ş   CALL @WOBJ.RTNE(FOBJ,"SET","action","WRITE","",RERR)ş   CALL @WOBJ.RTNE(FOBJ,"SET","data",EXECUTE.COMMAND,"",RERR)ş   CALL @WOBJ.RTNE(FOBJ,"SET","path",TMP.DIR:SESSION.ID:EXTENSION,"",RERR)şş   ITEMS.TO.DELETE<-1>=TMP.DIR:SESSION.ID:EXTENSIONşş   CALL MVDBTOOLKIT.WFILEIO(FOBJ)ş   ş   ş   EXECUTE.COMMAND = TMP.DIR:SESSION.ID:EXTENSIONş   şENDşşBEGIN CASEş    CASE EXECUTE.DOCAPTURE="N"ş        EXECUTE PRE.CMND:\ "\:EXECUTE.COMMAND:\"\ ş    CASE 1ş        EXECUTE PRE.CMND:\ "\:EXECUTE.COMMAND:\"\ CAPTURING E.RESULTşEND CASEşşCONVERT CHAR(0) TO '' IN E.RESULTşCONVERT CHAR(255) TO '' IN E.RESULTşşL=LEN(E.RESULT)şIF E.RESULT[L,1] = CHAR(254) THEN E.RESULT=E.RESULT[1,L-1]şCALL @WOBJ.RTNE(EOBJ,"SET.STRING","result.result",E.RESULT,"",RERR)şşIF NOT(DO.DEBUG) THENş   IF ITEMS.TO.DELETE # "" THENş       CALL @WOBJ.RTNE(FOBJ,"SET","action","DELETE","",RERR)ş       CALL MVDBTOOLKIT.WFILEIO(FOBJ)ş   ENDşENDşşIF DO.DEBUG THENş   OPENPATH "/tmp" TO TMP.FILE ELSE RETURNş   WRITE EXECUTE.COMMAND ON TMP.FILE, "wexecute.sh"şENDşşşRETURN00012BMVDB.THEMESş0c0000045Theme 2ş0c2theme2.cssş#004489ş#e1e1d6ş#d3d9dfş#989898ş#565656ş#dbdbce000045Theme 3ş0c2theme3.cssş#557260ş#6A8B92ş#8A9875ş#34626Bş#eaeeeaş#3291b100003DTheme 1ş0c2theme1.cssş#2d3956ş#455372ş#616a7fş#e7e7e7ş#e0e9e900003DTheme 4ş0c2theme4.cssş#77bed2ş#d5e1ddş#999999ş#747e80ş#333333000218WDB.RESOURCEş0c0000036RSS.MAINTş0c2PşRSS MaintenanceşMVDB.INITşRSS.MAINTş1ş1000033MVPKG.MAINş0c2PşMV PackageşMVDB.INITşMVPKG.MAINş1ş000003FMVDB.WEB.EDş0c2PşMV Dashboard EditorşMVDB.INITşMVDB.WEB.EDş1ş1ş000043MVDB.ADMINş0c2PşMV Dashboard AdministratorşMVDB.INITşMVDB.ADMINş1ş100002DRSS.MAINş0c2PşRSS FeedşMVDB.INITşRSS.MAINş1ş1000047CONFIGş0c2CşDEFAULT_HANDLERıDBCşDEFAULT_RESOURCEıMVDB.MAINşAPIKEYı1234500003BAPI*WRESTTESTş0c2PşSample REST testşWRESTTESTşWRESTTESTş1ş100003EMVDB.MAINş0c2PşMV Dashboard ControllerşMVDB.INITşMVDB.MAINş1ş1000120DICT_MVDB.DEFSş0c0000022TEMPLATEş0c1Aş1şTEMPLATEşşşşşşLş15000022DISPLAYSş0c1Aş2şDISPLAYSşşşşşşLş30000024DISP.AREAş0c1Aş3şDISP AREAşşşşşşLş10000027DISP.ORDERş0c1Aş4şDISP ORDERşşşşşşşLş1000001CUSERSş0c1Aş5şUSERSşşşşşşLş2000001ADESCş0c1Aş6şDESCşşşşşşLş4000001FDB.SORTş0c1Aş8şDB.SORTşşşşşşRş70046DBWBPDş0c0000151FI.MVDB.DEFSş0c2DIM DB.ITEM(30)ş*şEQU DB.TEMPLATE         TO DB.ITEM(1)şEQU DB.WIDGETS          TO DB.ITEM(2)şEQU DB.WIDGET.AREA      TO DB.ITEM(3)şEQU DB.WIDGET.ORDER     TO DB.ITEM(4)şEQU DB.USERS.ALLOWED    TO DB.ITEM(5)şEQU DB.DESC             TO DB.ITEM(6)şEQU DB.THEME            TO DB.ITEM(7)şEQU DB.SORT             TO DB.ITEM(8)00012EFI.MVDB.USERSş0c2DIM USER.ITEM(20)ş*şEQU USER.PASSWORD     TO USER.ITEM(1)şEQU USER.DEFAULT.DB   TO USER.ITEM(2)şEQU USER.NAME         TO USER.ITEM(3)şEQU USER.LAST.LOGIN   TO USER.ITEM(4)şEQU USER.EMAIL        TO USER.ITEM(5)şEQU USER.ROLE         TO USER.ITEM(6)şEQU USER.ALT.LOGO     TO USER.ITEM(7)000100FI.MVDB.WIDGET.TYPESş0c2DIM WIDGET.TYPES(10)ş*şEQU WT$TYPE     TO WIDGET.TYPES(1)şEQU WT$SWF      TO WIDGET.TYPES(2)şEQU WT$HANDLER  TO WIDGET.TYPES(3)şEQU WT$ICON     TO WIDGET.TYPES(4)şEQU WT$GROUP    TO WIDGET.TYPES(5)şEQU WT$DESC     TO WIDGET.TYPES(6)000070FI.MVDB.WIDGETSş0c2DIM WIDGET.ITEM(20)ş*şEQU WIDGET.SUB    TO WIDGET.ITEM(1)şEQU WIDGET.USERS  TO WIDGET.ITEM(2)000166FI.WDB.RESOURCEş0c2DIM RSRC.ITEM(20)ş*şEQU RSRC.TYPE           TO RSRC.ITEM(1)şEQU RSRC.DESCRIPTION    TO RSRC.ITEM(2)şEQU RSRC.CONTROLLER     TO RSRC.ITEM(3)şEQU RSRC.PROGRAM        TO RSRC.ITEM(4)şEQU RSRC.PARSE.CGI      TO RSRC.ITEM(5)şEQU RSRC.ENABLED        TO RSRC.ITEM(6)şEQU RSRC.DEBUG.MODE     TO RSRC.ITEM(7)şEQU RSRC.ACCOUNT        TO RSRC.ITEM(8)000484FI.WDB.DEBUGş0c2*ş* WDB.DEBUG record layoutş*şEQU WDBG_DATE                TO 1şEQU WDBG_TIME                TO 2şEQU WDBG_DURATION            TO 3şEQU WDBG_PORT                TO 4şEQU WDBG_HANDLER             TO 5şEQU WDBG_RESOURCE            TO 6şEQU WDBG_CONTROLLER          TO 7şEQU WDBG_PROGRAM             TO 8şEQU WDBG_REQUEST_ID          TO 9şEQU WDBG_REQUEST             TO 10şEQU WDBG_METHOD              TO 11şEQU WDBG_PATH                TO 12şEQU WDBG_REMOTE_ADDR         TO 13şEQU WDBG_STATUS              TO 14şEQU WDBG_HEADER_VARS         TO 15şEQU WDBG_HEADER_VALS         TO 16şEQU WDBG_CGI_VARS            TO 17şEQU WDBG_CGI_VALS            TO 18şEQU WDBG_BODY                TO 19şEQU WDBG_RESPONSE_VARS       TO 20şEQU WDBG_RESPONSE_VALS       TO 21şEQU WDBG_RESPONSE_CONTENT    TO 22şEQU WDBG_RESERVED1           TO 23şEQU WDBG_RESERVED2           TO 24şEQU WDBG_SESSION_ID          TO 25şEQU WDBG_SESSION_VARS        TO 26şEQU WDBG_SESSION_VALS        TO 27şEQU WDBG_SESSION_DATE        TO 28şEQU WDBG_SESSION_TIME        TO 29şEQU WDBG_WARNING             TO 30şEQU WDBG_ERROR               TO 31şEQU WDBG_LINT                TO 3200323EMVDB.INCLUDEş0c2*şCOMMON /MVDB/ GLOBAL.INFO(100), GLOBAL.USER.DATA(20), GLOBAL.TEMP.DATA(20), WIDGET.INFO(200), WIDGET.USER.DATA(100)ş*ş* GLOBAL.INFO equates. GLOBAL.INFO is a place for variables that are ş* globally accessible to all view subroutines. This information is notş* written to disk - it is valid only for the duration of the execution.ş*şEQU G$USERID            TO GLOBAL.INFO(1) ;* UserID currently logged inşEQU G$CURRENT.DB        TO GLOBAL.INFO(2) ;* Current dashboard nameşEQU G$LOGIN.DATE        TO GLOBAL.INFO(3) ;* Date user logged in (from session)şEQU G$LOGIN.TIME        TO GLOBAL.INFO(4) ;* Time user logged in (from session)şEQU G$WIDGET.NAME       TO GLOBAL.INFO(5) ;* Current view being executedşEQU G$WIDGET.SUB        TO GLOBAL.INFO(6) ;* Current subruotine being calledşEQU G$WIDGET.NAME.LIST  TO GLOBAL.INFO(7) ;* List of views called/to be calledşEQU G$WIDGET.SUB.LIST   TO GLOBAL.INFO(8) ;* w/ G$WIDGET.NAME.LISTşEQU G$WIDGET.CALL.TIME  TO GLOBAL.INFO(9) ;* w/ G$WIDGET.NAME.LIST (timedate stamp)şEQU G$WIDGET.CALL.DUR   TO GLOBAL.INFO(10) ;* w/ G$WIDGET.NAME.LIST (duration in MS)şEQU G$QUERYMODE         TO GLOBAL.INFO(11) ;* Used to query subroutines without running themşEQU G$SUBMITTED         TO GLOBAL.INFO(12) ;* 1=User clicked submit on input area of this widgetşEQU G$ADMIN.USER        TO GLOBAL.INFO(14) ;* 1=User as an admin; 0=User is not an adminşEQU G$LICENSE.COUNT     TO GLOBAL.INFO(15) ;* Count of licenses (concurrent users)şEQU G$EDITION           TO GLOBAL.INFO(16) ;* Edition NameşEQU G$SYSTEM.ID         TO GLOBAL.INFO(17) ;* System IDş*ş* GLOBAL.INFO(90...100) reserved for internal use.ş*şEQU G$DRILLDOWN.MODE    TO GLOBAL.INFO(24)şEQU G$DD.REFERRER       TO GLOBAL.INFO(25)şEQU G$DD.FROM.DB        TO GLOBAL.INFO(26)ş*ş* GLOBAL.USER.DATA stores persistent variable data throughout the courseş* of a dashboard user's login session. This allows for persistent sharingş* of information between dashboard subroutines.ş*ş* GLOBAL.TEMP.DATA stores temporary variable data for the course of a singleş* execution. Data is not stored with the session and is destoryed after eachş* page load.ş*ş* WIDGET.INFO holds the information for a specific dashboard WIDGET.ş*şEQU W$TYPE           TO WIDGET.INFO(1)şEQU W$TITLE          TO WIDGET.INFO(2)şEQU W$LINK.LABEL     TO WIDGET.INFO(3)şEQU W$LINK.LOCATION  TO WIDGET.INFO(4)  ;* Quandrant(s) to show (1-4)şEQU W$LINK.UD.POS    TO WIDGET.INFO(5)  ;* WIDGET.USER.DATA(x)şEQU W$LINK.UD.VAL    TO WIDGET.INFO(6)  ;* ^^ = this_valueşEQU W$LINK.DD.WIDGET TO WIDGET.INFO(7)  ;* Drill-down widget nameşEQU W$LINK.DD.PARAMS TO WIDGET.INFO(8)  ;* Drill down params (UNUSED)şEQU W$LINK.URL       TO WIDGET.INFO(26) ;* Specific URL - UD/DD params ignoredşEQU W$LINK.URL.OPTS  TO WIDGET.INFO(27) ;* Specific URL - UD/DD params ignoredşEQU W$LINK.ICON      TO WIDGET.INFO(28) ;* Icon GIF name ("C" location only)şEQU W$LINK.ICON.TXT  TO WIDGET.INFO(29) ;* Hover text for imageşEQU W$WIDTH          TO WIDGET.INFO(9)  ;* 1, 2 or 3şEQU W$PRINTABLE      TO WIDGET.INFO(24) ;* 1=Add print function/icon to control barşEQU W$EXCELABLE        TO WIDGET.INFO(88) ;* 1=Add EXCEL function/icon to control barşEQU W$PDFABLE        TO WIDGET.INFO(87) ;* 1=Add PDF function/icon to control barşEQU W$HIDDEN         TO WIDGET.INFO(25) ;* 1=Do not display this widgetş*ş* Pie chart equatesş*şEQU W$PIE.LABELS     TO WIDGET.INFO(10)şEQU W$PIE.VALUES     TO WIDGET.INFO(11)şEQU W$PIE.COLORS     TO WIDGET.INFO(12) ;* #000000 - #FFFFFFş* Below settings are Fusion Charts onlyşEQU W$PIE.CAPTION    TO WIDGET.INFO(14)şEQU W$PIE.VALUE.OPTS TO WIDGET.INFO(15)ş*ş* Bar chart equatesş*şEQU W$BAR.LABELS      TO WIDGET.INFO(10) ;* Labels for each Series (AM)şEQU W$BAR.VALUES      TO WIDGET.INFO(11) ;* Values matrix (AM/VM)şEQU W$BAR.COLORS      TO WIDGET.INFO(12) ;* #000000 - #FFFFFFşEQU W$BAR.XLABELS     TO WIDGET.INFO(13) ;* Labels for each set (X Axis)şEQU W$BAR.XMEMO       TO WIDGET.INFO(14) ;* X-Axis TextşEQU W$BAR.YMEMO       TO WIDGET.INFO(15) ;* Y-Axis TextşEQU W$BAR.TYPE        TO WIDGET.INFO(16) ;* 'clustered', 'stacked', '100% stacked'ş* Below settings are Fusion Charts onlyşEQU W$BAR.TREND.BEG   TO WIDGET.INFO(17) ;* Trendline beginning valueşEQU W$BAR.TREND.END   TO WIDGET.INFO(18) ;* Trendline ending valueşEQU W$BAR.TREND.OPTS  TO WIDGET.INFO(19) ;* Options for the trendlineşEQU W$BAR.VALUE.OPTS  TO WIDGET.INFO(20)şEQU W$BAR.LABEL.OPTS  TO WIDGET.INFO(21)şEQU W$BAR.XLABEL.OPTS TO WIDGET.INFO(22)şEQU W$BAR.CAPTION     TO WIDGET.INFO(23)ş*ş* Table chart equtesş*şEQU W$TABLE.COL.LABELS     TO WIDGET.INFO(10)şEQU W$TABLE.COL.JUST       TO WIDGET.INFO(11)şEQU W$TABLE.DATA           TO WIDGET.INFO(12)şEQU W$TABLE.TOTALS         TO WIDGET.INFO(13)ş*ş* Text display equatesş*şEQU W$TEXT.DATA         TO WIDGET.INFO(10)ş*şEQU W$HTML.DATA         TO WIDGET.INFO(10) ;* HTML Blobş*ş* Global display equatesş*şEQU W$CHART.OPTIONS  TO WIDGET.INFO(30) ;* Fusion Charts OnlyşEQU W$CHART.HEIGHT   TO WIDGET.INFO(31) ;* Override (in pixels)ş*ş* WIDGET.USER.DATA holds widget-specific user information whichş* is persistent through the user's session. Values can be set inş* this by using the LINK.XXXX feature. This feature will create linksş* on the widget display that, when clicked, will set values inş* WIDGET.USER.DATA as perscribedş*şEQU W$INPUT.PROMPT   TO WIDGET.INFO(32) ;* Prompt Text (AM)şEQU W$INPUT.TYPE     TO WIDGET.INFO(33) ;* TEXT or SELECT (AM)şEQU W$INPUT.SELOPTS  TO WIDGET.INFO(34) ;* Text Options for SELECT (AM)(VM)şEQU W$INPUT.SELVALS  TO WIDGET.INFO(35) ;* Select Values for SELECT (AM)(VM)şEQU W$INPUT.DEFAULT  TO WIDGET.INFO(36) ;* Default Value (AM)şEQU W$INPUT.UDPOS    TO WIDGET.INFO(37) ;* User Data Pisition to store answer (AM)şEQU W$INPUT.PARAMS   TO WIDGET.INFO(38) ;* Additonal HTML in <input> or <select> tag (AM)şEQU W$INPUT.BUTTON   TO WIDGET.INFO(39) ;* Button Label for Submit (AM)ş*şEQU W$MAP.IDS         TO WIDGET.INFO(40) ;* ID for associated value. Ex. USA Map, this is a state Abbr.şEQU W$MAP.VALUES      TO WIDGET.INFO(41) ;* Value associtated with the ID (map segment)şEQU W$MAP.VALUE.OPTS  TO WIDGET.INFO(42) ;* Optional parameters to be inserted into the <entity> tag.şEQU W$MAP.RANGE.NAME  TO WIDGET.INFO(43) ;* Display Name of the range/group (VM)şEQU W$MAP.RANGE.LOW   TO WIDGET.INFO(44) ;* Range low limit (VM)şEQU W$MAP.RANGE.HIGH  TO WIDGET.INFO(45) ;* Range high limit (VM)şEQU W$MAP.RANGE.COLOR TO WIDGET.INFO(46) ;* Range color (optional override)şEQU W$MAP.RANGE.OPTS  TO WIDGET.INFO(47) ;* optional parameters to be inserted into the <color> tagş*ş* The following value is only relevant for map type USA - when the W$MAP.IDS are state abbreviations.ş* For each W$MAP.IDS entry, this value can be set to allow drill-down for this state. When used,ş* it will reload the same widget, providing it with the drill-down state info in WIDGET.USER.INFO(1).ş* The use of this feature precludes the use of the W$MAP.VALUE.LINK feature below.ş*ş* See also the FusionWidgets drill-down feature described later. This can be used to drill-down to aş* specific widget from a map position when the map drilldown features described here are NOT used.ş*şEQU W$MAP.VALUE.DD    TO WIDGET.INFO(48) ;* "1"=Enable Drill-Down for this State (from USA Map). If used, ş*                                           WIDGET.USER.INFO will contain the state map info:ş*                                           (1) = State Code (2-character)ş*                                           (2) = State Map Name (for use with MVDB.MAP.DATA)ş*şEQU W$MAP.VALUE.LINK  TO WIDGET.INFO(49) ;* Link URL (Ignored if Drill-Down state is used)şEQU W$MAP.LINK.MODE   TO WIDGET.INFO(50) ;* "N" = New Window, Blank = This Windowş*ş* Fusion Widgetsş*şEQU W$FW.CAPTION          TO WIDGET.INFO(51) ;* Widget captionşEQU W$FW.SUBCAPTION       TO WIDGET.INFO(52) ;* SubcaptionşEQU W$FW.LABELS           TO WIDGET.INFO(53) ;* (VM) Labels for each sectionşEQU W$FW.VALUES           TO WIDGET.INFO(54) ;* (VM) Values for each sectionşEQU W$FW.VALUE.OPTS       TO WIDGET.INFO(55) ;* (VM) XML attributes to be included in the <set> tagşEQU W$FW.COLORS           TO WIDGET.INFO(56) ;* (VM) Alternate array of colors to useşEQU W$FW.CHART.PALETTE    TO WIDGET.INFO(57) ;* 1-5 - Selects color theme for Spark Charts, Bullet Charts ş*ş* Fusion Widgets - Spark Chartsş*şEQU W$FW.SPARK.TREND.BEG  TO WIDGET.INFO(58) ;* Trendline begin valueşEQU W$FW.SPARK.TREND.END  TO WIDGET.INFO(59) ;* Trendline end valueşEQU W$FW.SPARK.TREND.OPTS TO WIDGET.INFO(60) ;* Trendline optionsş*ş* Linear charts (Bullet Charts, Guages)ş*şEQU W$FW.LOWER.LIMIT      TO WIDGET.INFO(61)şEQU W$FW.UPPER.LIMIT      TO WIDGET.INFO(62)şEQU W$FW.COLOR.RANGE      TO WIDGET.INFO(63) ;* <1> Range lower limitş*                                               <2> Range upper limitş*                                               <3> Range Color (This seems to be ignored on bullet charts)ş*                                               <4> Range options (attributes to appear in <color> tagşEQU W$FW.METER.VALUE       TO WIDGET.INFO(64) ;* The numeric value of the meter guageşEQU W$FW.METER.VALUE.OPTS  TO WIDGET.INFO(65) ;* Optional attributes to appear in the <value> tagşEQU W$FW.METER.TARGET      TO WIDGET.INFO(66) ;* Target value for the meter (where appropriate) (Bullet)şEQU W$FW.METER.TARGET.OPTS TO WIDGET.INFO(67) ;* Option attributes to appear in the <target> tagş*şEQU W$FW.NUMBER.PREFIX    TO WIDGET.INFO(68) ;* Such as "$"şEQU W$FW.NUMBER.SUFFIX    TO WIDGET.INFO(69) ;* Such as "K" or "MM"şEQU W$FW.TICKMARKS        TO WIDGET.INFO(70) ;* Tickmark Properties for Bullets, Gaugesş*                                               <1> 1 or 0 ; Show Tick Marks (1 = default)ş*                                               <2> 1 or 0 ; Show Tick Values next to the marks (1 = default)ş*                                               <3> A or B ; Show Above or Below graph (B = default)ş*                                               <4> Number of major tickmarks (default is calculated)ş*                                               <5> Number of minor tickmarks between major ones (default is none)ş*şEQU W$FW.LOWER.LIMIT.LABEL  TO WIDGET.INFO(71) ;* For gauges, these are the labels asssociated with theşEQU W$FW.UPPER.LIMIT.LABEL  TO WIDGET.INFO(72) ;* lower and upper limitsşEQU W$FW.DIAL.VALUES        TO WIDGET.INFO(73) ;* (VM) value associated with each dial on the gaugeşEQU W$FW.DIAL.OPTS          TO WIDGET.INFO(74) ;* Optional atributes to appear in the <dial> tagşEQU W$FW.TRENDPOINT.VALUES  TO WIDGET.INFO(75) ;* (VM) Trendpoints on gaugesş*                                               * Optionally, <2> may be used to specify an ending valueş*                                               * to plot an arc on a gauge between <1,X> and <2,X>şEQU W$FW.TRENDPOINT.LABELS  TO WIDGET.INFO(76) ;* (VM) Associated trendpoint label textşEQU W$FW.TRENDPOINT.OPTS    TO WIDGET.INFO(77) ;* Optional attributes to appear in the <point> tagş*şEQU W$FW.THERMOMETER.COLOR  TO WIDGET.INFO(78) ;* Fill color for Thermometer and Cylinder chartsş*ş* The values below allow you to set up drill-down parameters for most FusionWidgets and FusionChartsş* values. These values correspond with W$FW.VALUES, W$FW.METER.VALUE, W$FW.DIAL.VALUES, W$PIE.VALUES,ş* W$BAR.VALUES and also with W$FW.MAP.IDS when NOT using the built-in drill-down facilities in theş* USAMAP type. It may be used when a state map is being created.ş* şEQU W$FW.DD.UD.POS          TO WIDGET.INFO(79) ;* WIDGET.USER.DATA(x) location to store the user-defined valueşEQU W$FW.DD.UD.VAL          TO WIDGET.INFO(80) ;* ^^ = this_value - gets stored in WIDGET.USER.DATA(x) positionşEQU W$FW.DD.WIDGET          TO WIDGET.INFO(81) ;* Drill-down widget name to be invokedşEQU W$FW.DD.PARAMS          TO WIDGET.INFO(82) ;* Drill down params (UNUSED)ş*şEQU W$FW.BC.PLOT.COLOR      TO WIDGET.INFO(83) ;* Plot color of bullet-chart plot lineşEQU W$FW.BC.TARGET.COLOR    TO WIDGET.INFO(84) ;* Color of bullet-chart target lineşEQU W$MAP.VALUE.TOOLTEXT    TO WIDGET.INFO(85) ;* toolText value for mapşEQU W$INPUT.PROMPT.PARAMS   TO WIDGET.INFO(86) ;* Prompt text styling options. Goes into label tag.ş*ş* Color Namesş*şEQU COLOR$RED      TO "#FF0000"şEQU COLOR$MAROON   TO "#800000"şEQU COLOR$FUCHSIA  TO "#FF00FF"şEQU COLOR$MAGENTA  TO "#FF00FF"şEQU COLOR$ORANGE   TO "#FFA500"şEQU COLOR$YELLOW   TO "#FFFF00"şEQU COLOR$LIME     TO "#00FF00"şEQU COLOR$GREEN    TO "#008000"şEQU COLOR$OLIVE    TO "#808000"şEQU COLOR$CYAN     TO "#00FFFF"şEQU COLOR$AQUA     TO "#00FFFF"şEQU COLOR$TEAL     TO "#008080"şEQU COLOR$BLUE     TO "#0000FF"şEQU COLOR$NAVY     TO "#000080"şEQU COLOR$PURPLE   TO "#800080"şEQU COLOR$BLACK    TO "#000000"şEQU COLOR$SILVER   TO "#C0C0C0"şEQU COLOR$GRAY     TO "#808080"şEQU COLOR$GREY     TO "#808080"şEQU COLOR$WHITE    TO "#FFFFFF"000014SOURCE.VIEW.ICONş0c20005EBWWW.INCLUDEş0c2*ş* Standard web includeş*şşCOMMON /WWW/ WWW.INFO(50), F.WEB.SESSIONşşEQU SESSION$ID               TO WWW.INFO(1)şEQU SESSION$CONTENT.TYPE     TO WWW.INFO(2)şEQU SESSION$CONTENT.SENT     TO WWW.INFO(3)şEQU SESSION$OUTBUF           TO WWW.INFO(4)şEQU SESSION$HEADERS          TO WWW.INFO(5)şEQU SESSION$COOKIES          TO WWW.INFO(6)şEQU SESSION$OUTBUF.SIZE      TO WWW.INFO(7)şEQU SESSION$OUTBUF.FLAG      TO WWW.INFO(8)şEQU SESSION$TIME.OUT         TO WWW.INFO(9)şEQU SESSION$GLOBAL.DEBUG     TO WWW.INFO(10)şEQU SESSION$STATUS.CODE      TO WWW.INFO(11)şEQU SESSION$WDEBUG.MODE      TO WWW.INFO(12)şEQU CONFIG$WDB.RESOURCE      TO WWW.INFO(15)şEQU CGI$VARS                 TO WWW.INFO(25)şEQU CGI$VALS                 TO WWW.INFO(26)şEQU CGI$CVARS                TO WWW.INFO(27)şEQU CGI$CVALS                TO WWW.INFO(28)şEQU CGI$SERVER.NAME          TO WWW.INFO(29)şEQU CGI$PATH                 TO WWW.INFO(30)şEQU CGI$SERVER.PORT          TO WWW.INFO(31)şEQU CGI$BODY                 TO WWW.INFO(32)şEQU CGI$HEADERVALS           TO WWW.INFO(33)şEQU CGI$HEADERVARS           TO WWW.INFO(34)şEQU CGI$RESTPARAMS           TO WWW.INFO(35)şEQU CGI$CONFIG               TO WWW.INFO(36)şEQU F.WEB.FORMS              TO WWW.INFO(40)şEQU CGI$APPSVR.ID            TO WWW.INFO(45)şEQU CGI$RESERVED1            TO WWW.INFO(46)şEQU CGI$RESERVED2            TO WWW.INFO(47)şEQU CGI$RESERVED3            TO WWW.INFO(48)şEQU CGI$UNIQUE.ID            TO WWW.INFO(49)şEQU CGI$RESOURCE.NAME        TO WWW.INFO(50)000481WWW.INFOş0c2*ş* Element index for standard web common /WWW/ WWW.INFO arrayş*şEQU SESSION_ID               TO 1şEQU SESSION_CONTENT.TYPE     TO 2şEQU SESSION_CONTENT.SENT     TO 3şEQU SESSION_OUTBUF           TO 4şEQU SESSION_HEADERS          TO 5şEQU SESSION_COOKIES          TO 6şEQU SESSION_OUTBUF.SIZE      TO 7şEQU SESSION_OUTBUF.FLAG      TO 8şEQU SESSION_TIME.OUT         TO 9şEQU SESSION_GLOBAL.DEBUG     TO 10şEQU SESSION_STATUS.CODE      TO 11şEQU SESSION_WDEBUG_MODE      TO 12şEQU CONFIG_WDB.RESOURCE      TO 15şEQU CGI_VARS                 TO 25şEQU CGI_VALS                 TO 26şEQU CGI_CVARS                TO 27şEQU CGI_CVALS                TO 28 şEQU CGI_SERVER.NAME          TO 29şEQU CGI_PATH                 TO 30şEQU CGI_SERVER.PORT          TO 31şEQU CGI_BODY                 TO 32şEQU CGI_HEADERVALS           TO 33şEQU CGI_HEADERVARS           TO 34şEQU CGI_RESTPARAMS           TO 35şEQU CGI_CONFIG               TO 36şEQU CGI_APPSVR.ID            TO 45şEQU CGI_RESERVED1            TO 46şEQU CGI_RESERVED2            TO 47şEQU CGI_RESERVED3            TO 48şEQU CGI_UNIQUE.ID            TO 49şEQU CGI_RESOURCE.NAME        TO 500002CFUD.DICT.SALESş0c0000033CLOSE.DATE.YMOş0c0Aş0şşşşşşA;1(DY):1(D2-)(G-1)şRş10000028CLOSE.DATE.MMş0c0Dş1şDMşCLOSE MONTHş8RşS00002CCLOSE.DATE.YMş0c0Aş0şşşşşşA;1(DY):1(DM)şRş10000016BRANCHş0c0Dş13şşş15LşS000016REGIONş0c0Dş14şşş15LşS000018CNTş0c0Aş0şşşşşşF;C1şRş5000018ATT10ş0c0Dş10şMD2şş10RşS00001BCLOSE.DATEş0c0Dş1şD2-şş8RşS00003CCLOSE.DATE.YYYYş0c0IşOCONV(ATT1,'D4-')[7,4]şşCLOSE YEARş8LşS000018@IDş0c0Dş0şşSALESş10LşSş000016ATT8ş0c0Dş8şMD2şş10RşS000017REP.NAMEş0c0Dş5şşş25LşS000015PIPEş0c0Iş"|"şş|ş1LşS000016ATT9ş0c0Dş9şMD2şş10RşS000018ATT12ş0c0Dş12şMD2şş10RşS000012ATT1ş0c0Dş1şşş6RşS00001AEXT.COSTş0c0Dş9şMD2şş10RşS00003BGROSS.PROFITş0c0IşEXT.AMT - EXT.COSTşMD2şGROSS PROFITş10RşS000023EXT.AMTş0c0Dş8şMD2şEXT.AMOUNTş10RşS0000CDUD.DICT.APş0c0000023DATE.PAIDş0c0Dş8şD2-şDate Paidş8RşS000026INV.AMOUNTş0c0Dş6şMD2şInv.Amountş13RşS000022DUE.DATEş0c0Dş20şD2-şDue.Dateş8RşS000021BALANCEş0c0Dş50şMD2şBalanceş13RşS000015PIPEş0c0Iş"|"ş şş1LşS00023DUD.DICT.DASHBOARD.CLOSING.STATSş0c0000026SALESMANş0c0IşFIELD(@ID,'*',1)şşş20LşS000024BRANCHş0c0IşFIELD(@ID,'*',3)şşş10LşS000023YYYYMMş0c0IşFIELD(@ID,'*',2)şşş6LşS000013IDş0c0Iş@IDşşş10LşS000032GROSS.PROFITş0c0IşAMOUNT - COST.OF.SALEşMD2şş12RşS000026YYYYş0c0IşFIELD(@ID,'*',2)[1,4]şşş4RşS000015PIPEş0c0Iş"|"ş şş1LşS000022YYYYMM*BRANCHş0c0Iş@IDşG1*2şş10LşS000024REGIONş0c0IşFIELD(@ID,'*',4)şşş10LşS000018AMOUNTş0c0Dş1şMD2şş12RşS00001ECOST.OF.SALEş0c0Dş2şMD2şş12RşS000040REGION*YYYYMMş0c0IşFIELD(@ID,"*",4):"*":FIELD(@ID,"*",2)şşş10LşS000023SALESMAN*YYYYMMş0c0Iş@IDşG*2şş20LşS0000CEDICT_WDB.LOGş0c000001CDATEş0c1Aş2şDATEşşşşD2/şşRş800001CDURATIONş0c1Aş5şMSşşşşşşRş10000020PROGRAMş0c1Aş1şPROGRAMşşşşşşLş30000020AGEş0c1Aş2şAGEşşşşşA;(D)-(2)şRş8000028TIMEş0c1Aş3şTIMEşşşşMTSşA;(3)/"1000"şRş8000136UD.DICT.ARş0c0000028INVOICE.AMTş0c0Dş6şMD2şInvoice.Amtş13RşS000022DUE.DATEş0c0Dş20şD2-şDue.Dateş8RşS000021BALANCEş0c0Dş50şMD2şBalanceş13RşS000026DATES.PAIDş0c0Dş8şD2-şCheckıDatesş8RşS000017CUSTş0c0Dş1şşCustş25LşS00001BBIG.CUSTş0c0Dş1şşCustş40LşS000014PIPEş0c0Iş"|"şşş1LşS000021CUST.NAMEş0c0Dş1şşCust.Nameş25LşS000953MV.INSTALL.CFş0c0000641MVAPPS-PRE-SCRIPTş0c0PTERM CASE NOINVERTşCREATE-FILE WDB.LOG 1 1şDELETE-FILE DATA WDB.LOGşCREATE-FILE WDB.DEBUG 1 1şDELETE-FILE DATA WDB.DEBUGşCREATE-FILE RSS.BP 3,1,18 11,1,1şCREATE-FILE RSS.FEEDS 1,1,18 11,1,18şCREATE-FILE MV.WEB.ED.ARCHIVE 3,1,18 301,1,18şCREATE-FILE MVDB.CONTROL 1,1,18 11,1,18şCREATE-FILE MVDB.DEFS 3,1,18 17,1,18şCREATE-FILE MVDB.SUB.TEMPLATES 1,1,18 17,1,18şCREATE-FILE MVDB.SUBS 31,1,18 101,1,1şCREATE-FILE MVDB.WIDGET.TYPES 1,1,18 3,1,18şCREATE-FILE MVDB.WIDGETS 3,1,18 31,1,18şCREATE-FILE MVDB.MAP.DATA 3,1,18 181,1,18şCREATE-FILE MVDB.UDATA 3,1,18 101,1,18şCREATE-FILE MVDB.USERS 3,1,18 31,1,18şCREATE-FILE MVPC.CONTROL 1,1,18 3,1,18şCREATE-FILE WBPD 1,1,18 11,1,1şCREATE-FILE WDB.BP 11,1,18 31,1,1şCREATE-FILE WEB.FORMS 1,1,18 101,1,18şCREATE-FILE WDB.Q 3,1,18 31,1,18şCREATE-FILE WEB.SESSION 3,1,18 71,1,18şCREATE-FILE MVAPPS.INSTALLED 3,1,18 11,1,18şCREATE-FILE MVBP.FORMS 1,1,18 11,1,18şCREATE-FILE MVDB.THEMES 1,1,18 3,1,18şCREATE-FILE MVBP.BP 3,1,18 5,1,1şCREATE-FILE MVDB.EMAILED.HTML 1,1,18 79,1,18şCREATE-FILE WDB.RESOURCE 1,1,18 3,1,18şCREATE-FILE WREST.BP 3,1,18 5,1,1şCREATE-FILE WOBJ.BP 3,1,18 5,1,1şCREATE-FILE MVDBTOOLKIT.BP 3,1,18 5,1,1şCREATE-FILE MVMAKE.BP 3,1,18 5,1,1şCREATE-FILE DASHBOARD.CLOSING.STATS 3,1,18 97,1,18şCREATE-FILE DASHBOARD.BALANCES 3,1,18 97,1,18şCREATE-FILE PORTAL.SALES 3,1,18 997,1,18şCREATE-FILE PORTAL.AR 3,1,18 997,1,18şCREATE-FILE PORTAL.AP 3,1,18 997,1,18şCREATE-FILE UD.DICT.DASHBOARD.CLOSING.STATS 1,1,18 7,1,18şCREATE-FILE UD.DICT.SALES 1,1,18 1,1,18şCREATE-FILE UD.DICT.AR 1,1,18 1,1,18şCREATE-FILE UD.DICT.AP 1,1,18 1,1,1800029EMVAPPS-POST-SCRIPTş0c0DELETE VOC DOWNLOAD.XLS INIT.WWW MV.COMPILE MVAPPS.STATUS MVDB.ADMIN MVDB.MAIN MVDB.WEB.ED MVPKG.MAIN PACK-FILE RSS.MAIN RSS.MAINT WDB.INIT WDB.TEST WDB.VIEW XML.DATAşBASIC MVDB.SUBS *şCATALOG MVDB.SUBS *şBASIC RSS.BP *şCATALOG RSS.BP *şBASIC WDB.BP *şCATALOG WDB.BP *şBASIC WDB.BP MVDB.DEBUGşCATALOG WDB.BP MVDB.DEBUGş* COMPILE WDB.BP APP.INSTALLER (OWşBASIC MVBP.BP *şCATALOG MVBP.BP *şBASIC WOBJ.BP *şCATALOG WOBJ.BP *şBASIC WREST.BP *şCATALOG WREST.BP *şRUN WDB.BP USER.UPDATEşRUN MVDB.SUBS PURGE.NON.PLATFORM.WIDGETSşBASIC MVDBTOOLKIT.BP *şCATALOG MVDBTOOLKIT.BP *şCREATE-FILE TMP 1,1,19 1,1,19şMVDBTOOLKIT.CONFIGşMV.PACKAGE.INSTALLER.DEFAULTS000051PACKAGE.INFOş0c0MultiValue Dashboard/Portal Reports/MVConnectş2.0.1şdbşşşMVDBş21500052EDICT_WDB.DEBUGş0c000001CDATEş0c1Aş1şDATEşşşşD2/şşRş8000019PORTş0c1Aş4şPORTşşşşşşRş4000026REQUEST.IDş0c1Aş9şREQUEST IDşşşşşşLş2500001BPATHş0c1Aş12şPATHşşşşşşLş25000029REMOTE.ADDRş0c1Aş13şREMOTE ADDRşşşşşşLş1400001DTYPEş0c1Aş0şTYPEşşşşşG0/1şLş4000026CONTROLLERş0c1Aş7şCONTROLLERşşşşşşLş12000033RESPONSE.CONTENTş0c1Aş22şRESPONSE CONTENTşşşşşşTş6000002DSESSION.DATEş0c1Aş28şSESSION DATEşşşşD2/şşRş800002BSESSION.VARSş0c1Aş26şSESSION VARSşşşşşşLş1200002BSESSION.VALSş0c1Aş27şSESSION VALSşşşşşşLş20000017DURş0c1Aş3şDURşşşşşşRş7000019REQş0c1Aş10şREQşşşşşşLş40000020AGEş0c1Aş1şAGEşşşşşA;(D)-(1)şRş8000020PROGRAMş0c1Aş8şPROGRAMşşşşşşLş2500001ESTATUSş0c1Aş14şSTATUSşşşşşşRş600001BBODYş0c1Aş19şBODYşşşşşşTş60000027SESSION.IDş0c1Aş25şSESSION IDşşşşşşLş2500001BLINTş0c1Aş32şLINTşşşşşşTş6000001CTIMEş0c1Aş2şTIMEşşşşMTSşşRş8000020HANDLERş0c1Aş5şHANDLERşşşşşşLş10000022RESOURCEş0c1Aş6şRESOURCEşşşşşşLş1200001EMETHODş0c1Aş11şMETHODşşşşşşLş6000029HEADER.VARSş0c1Aş15şHEADER VARSşşşşşşLş12000029HEADER.VALSş0c1Aş16şHEADER VALSşşşşşşLş20000023CGI.VARSş0c1Aş17şCGI VARSşşşşşşLş12000023CGI.VALSş0c1Aş18şCGI VALSşşşşşşLş2000002DRESPONSE.VARSş0c1Aş20şRESPONSE VARSşşşşşşLş1200002DRESPONSE.VALSş0c1Aş21şRESPONSE VALSşşşşşşLş2000002DSESSION.TIMEş0c1Aş29şSESSION TIMEşşşşMTSşşRş8000021WARNINGş0c1Aş30şWARNINGşşşşşşTş6000001DERRORş0c1Aş31şERRORşşşşşşTş6001BD90WEB.FORMSş0c0000C4DPORTAL.DASHBOARD.SALES.AR.APş0c2  <br class="brClear" />ş  <div class="widget_content">ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<th width=38% align="left" bgcolor="red">Sales</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% bgcolor="white">&nbsp;</td>ş<td width=31% align="center">MTD ~1~</td>ş<td width=31% align="center">YTD ~2~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=PORTAL SALES REPORTS">Sales</a></td>ş<td width=31% align="right">~3~</td>ş<td width=31% align="right">~4~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="0" cellspacing=".01%" cellpadding=".01%">ş<td width="100%">&nbsp;</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<th width=38% align="left" bgcolor="red"><font color="#FF0000">Financials</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="left"><a href="/dbc/MVDB.MAIN?dbname=DISPLAY PORTAL BALANCE PIE CHART&udview=DISPLAY PORTAL BALANCE PIE CHART">Balances as of ~15~</a></td><td width="25%" align="center">AR Balance</td><td width="25%" align="center">AR Balance %</td><td width="25%" align="center">AP Balance</td>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">Current</td><td width="25%" align="right">~30~</td><td width="25%" align="center">~31~</td><td width="25%" align="right">~32~</td>ş</table>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">1 - 30</td><td width="25%" align="right">~16~</td><td width="25%" align="center">~17~</td><td width="25%" align="right">~18~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">31 - 60</td><td width="25%" align="right">~19~</td><td width="25%" align="center">~20~</td><td width="25%" align="right">~21~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">61 - 90</td><td width="25%" align="right">~22~</td><td width="25%" align="center">~23~</td><td width="25%" align="right">~24~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">90+</td><td width="25%" align="right">~25~</td><td width="25%" align="center">~26~</td><td width="25%" align="right">~27~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">Total</td><td width="25%" align="right">~28~</td><td width="25%" align="center"></td><td width="25%" align="right">~29~</td>ş</table>ş<table width="100%" border="0" cellspacing=".01%" cellpadding=".01%">ş<td width="100%">&nbsp;</td>ş</table>ş</div>000200outerTrackWrapperş0c2    <div id="outerTrackWrapper">ş		<div id="trackWrapper">ş			<div id="trackMsg" style="width: 165px; height: 34px; float: left;"><div id="dispRate">&nbsp;</div></div>ş			<div id="track1" style="width:200px; height:34px; float: right; margin: 0 10px 0 0; background: url(/db/images/trackSlider.png) 0px center no-repeat;">ş				<div id="handle1" style="width:12px; height:34px; margin: 6px 0 0 0; float: left;"><img src="/db/images/sliderHandle.png" alt="" /></div>ş			</div>ş		</div>ş	</div>0002E9ed_output.htmlş0c2<div class="ed_error"><!-- HEADER --><!-- FOOTER --></div>ş<div id="compile_output" class="compile_output"><!-- COMPILE_OUTPUT --></div>ş<div id="compile_errline"><!-- COMPILE_ERRLINE --></div>ş<div id="last_compile"><!-- LAST_COMPILE --></div>ş<div id="ed_content"><!-- ED_CONTENT --></div>ş<div id="num_calls"><!-- NUM_OF_CALLS --></div>ş<div id="num_includes"><!-- NUM_OF_INCLUDES --></div>ş<div id="num_files"><!-- NUM_OF_FILES --></div>ş<div id="num_archives"><!-- NUM_OF_FILES --></div>ş<div id="calls_content"><!-- EA_CALLS_CONTENT --></div>ş<div id="includes_content"><!-- EA_INCLUDES_CONTENT --></div>ş<div id="files_content"><!-- EA_FILES_CONTENT --></div>ş<div id="archive_content"><!-- EA_ARCHIVE_CONTENT --></div>ş000253FCF_template.htmlş0c2<!-- start FC script -->ş        <div id="<!-- chart_div_id -->">ş        </div>ş        <script type="text/javascript">ş        FusionCharts.ready(function () {ş            var myChart = new FusionCharts({ş              "type": "[FCF_MODULE]",ş              "renderAt": "<!-- chart_div_id -->",ş              "width": "<!-- chart_width -->",ş              "height": "<!-- chart_height -->",ş              "dataFormat": "xml",ş              "dataSource": "<!-- CHARTXML -->"ş            });ş          myChart.render();ş        });ş        </script>ş<!-- end of FC script -->000E8DPORTAL.DASHBOARDş0c2  <br class="brClear" />ş  <div class="widget_content">ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<th width=38% align="left" bgcolor="red">Sales</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% bgcolor="white">&nbsp;</td>ş<td width=31% align="center">MTD ~1~</td>ş<td width=31% align="center">YTD ~2~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=PORTAL SALES REPORTS">Sales</a></td>ş<td width=31% align="right">~3~</td>ş<td width=31% align="right">~4~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=PORTAL SALES REPORTS">Gross Profit (GP$)</a></td>ş<td width=31% align="right">~5~</td>ş<td width=31% align="right">~6~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=PORTAL MARGINS&udview=Portal Margins">Margin (GP%)</a></td>ş<td width=31% align="right">~7~</td>ş<td width=31% align="right">~8~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="0" cellspacing=".01%" cellpadding=".01%">ş<td width="100%">&nbsp;</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<th width=38% align="left" bgcolor="red"><font color="#FF0000">Financials</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="left"><a href="/dbc/MVDB.MAIN?dbname=DISPLAY PORTAL BALANCE PIE CHART&udview=DISPLAY PORTAL BALANCE PIE CHART">Balances as of ~15~</a></td><td width="25%" align="center">AR Balance</td><td width="25%" align="center">AR Balance %</td><td width="25%" align="center">AP Balance</td>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">Current</td><td width="25%" align="right">~30~</td><td width="25%" align="center">~31~</td><td width="25%" align="right">~32~</td>ş</table>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">1 - 30</td><td width="25%" align="right">~16~</td><td width="25%" align="center">~17~</td><td width="25%" align="right">~18~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">31 - 60</td><td width="25%" align="right">~19~</td><td width="25%" align="center">~20~</td><td width="25%" align="right">~21~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">61 - 90</td><td width="25%" align="right">~22~</td><td width="25%" align="center">~23~</td><td width="25%" align="right">~24~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">90+</td><td width="25%" align="right">~25~</td><td width="25%" align="center">~26~</td><td width="25%" align="right">~27~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">Total</td><td width="25%" align="right">~28~</td><td width="25%" align="center"></td><td width="25%" align="right">~29~</td>ş</table>ş<table width="100%" border="0" cellspacing=".01%" cellpadding=".01%">ş<td width="100%">&nbsp;</td>ş</table>ş</div>0010E6admin_template.htmlş0c2<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">ş<head>ş	<meta http-equiv="Content-Type" content="text/html; charset=<!--CHARACTER_SET-->"/>ş	<script src="/db/javascripts/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>	ş    <script src="/db/javascripts/jquery-ui-1.7.2.custom.min.js" type="text/javascript" charset="utf-8"></script>            	ş    <script src="/db/javascripts/jquery.form.js" type="text/javascript" charset="utf-8"></script>    	        ş	<script src="/db/javascripts/jquery.url.js" type="text/javascript" charset="utf-8"></script>ş	<script src="/db/javascripts/initAdminTemplate.js" type="text/javascript" charset="utf-8"></script>ş	<script src="/db/javascripts/sortable.js" type="text/javascript" charset="utf-8"></script>ş	<script src="/db/javascripts/tablesort.js" type="text/javascript" charset="utf-8"></script>ş		ş	<link rel="stylesheet" href="/db/css/reset-fonts-grids.css" type="text/css" charset="utf-8" />ş	<link rel="stylesheet" href="/db/css/application.css" type="text/css" charset="utf-8" />ş	<link rel="stylesheet" href="/db/css/ingrid.css" type="text/css" charset="utf-8" />ş    <link rel="StyleSheet" href="/db/css/jquery-ui.css" media="screen" type="text/css" />ş    <!--[if lte IE 7]><link href="/db/css/ie7.css" rel="stylesheet" type="text/css" media="screen" /><![endif]-->ş    <!-- SITE_THEME -->ş	ş	<title>MultiValue Dashboard Admin</title>ş	ş	<script type="text/javascript">ş	<!-- ADMIN_SCRIPTS -->ş	</script>ş</head>ş<body>ş<div id="header">ş<!-- HEADER -->ş</div>şş	<div id="logo">ş    	<img src="<!-- SITE_LOGO -->" alt="MultiValue Dashboard">ş	</div>ş<div id="mainWrapper">ş<div id="main">şş<!-- Add new user form -->ş<div id="new-user" title="New user" style="display:none;" >ş<form id="new-user-form" method="get" action="/dbc/MVDB.ADMIN">ş<div id="new-user-messages"></div>ş<table>ş<tbody><tr>ş <td align="right">User ID:</td>ş <td><input id="new-userid" type="text" value="" name="new_userid"/></td>ş</tr>ş<tr>ş <td align="right">Name:</td>ş <td><input id="username" type="text" value="" name="username"/></td>ş</tr>ş<tr id='default-dashboard'>ş <td align="right">Default Dashboard:</td>ş <td id="default-dashboard-container"><!-- default_dashboard --></td>ş <td/>ş</tr>ş<tr>ş <td align="right">Role:</td>ş <td>ş   <select id="user-role" name="user_role">ş      <option value="User">User</option>ş      <option value="Administrator">Administrator</option>ş   </select>ş </td>ş</tr>ş<tr>ş <td align="right">Optional Logo Path:</td>ş <td><input id="opt_logo_path" type="text" value="" name="opt_logo_path"/></td>ş</tr>ş<tr>ş <td align="right">Password:</td>ş <td><input id="user-password" type="password" value="" name="user_password"/></td>ş</tr>ş<tr>ş <td align="right">Confirm Password:</td>ş <td><input id="confirm-password" type="password" value="" name="confirm_password"/></td>ş</tr>şş</tbody></table>ş<input type="hidden" value="save_user" name="action"/>ş</form>ş</div>şş<!-- Add new widget form -->ş<div id="new-widget" title="New widget" style="display:none;" >ş<form id="new-widget-form" method="get" action="/dbc/MVDB.ADMIN">ş<div id="widget-messages"></div>ş<table>ş<tbody><tr>ş <td align="right">Widget Name: *</td>ş <td><input id="widget_id" type="text" value="" name="new_widgetid" /></td>ş</tr>ş<tr>ş <td align="right">Subroutine: *</td>ş <td><input id="widget_sub" type="text" value="" name="widget_sub" /><!-- edit_source_link --></td>ş</tr>ş<tr>ş <td align="right">Users:</td>ş <td><input id="widget_users" type="text" value="" name="widget_users" /><br/><font size="1">comma-separated</font></td>ş</tr>ş</tbody></table>ş<!--input type="submit" value="Delete Widget" name="delete_widget"/ -->ş<p>ş<input id="save_widgetid" type="hidden" value="" name="save_widgetid" />ş<input id="widget_action" type="hidden" value="save_widget" name="action" />ş<input id="save_widget" type="hidden" value="Save" name="save_widget" />ş</p>ş</form>şş</div>ş<a href="edit-sub" id="edit-sub-link" target="_blank" style="display: none;">Edit subroutine</a>ş<!-- ADMIN_MAIN -->ş</div>ş</div>şş<div id="footer">ş    <div id="signature">MultiValue Dashboard - Copyright &copy; 2020 <a href="http://http://www.zumasys.com/products/multivalue-dashboard">Zumasys</a>ş    </div>ş<!-- FOOTER -->ş</div>ş</body>ş</html>002E52PORTAL.REPORT.DOCUMENTATIONş0c2<html>şş<head>ş<meta http-equiv=Content-Type content="text/html; charset=windows-1252">ş<meta name=Generator content="Microsoft Word 15 (filtered)">ş<style>ş<!--ş /* Font Definitions */ş @font-faceş	{font-family:Wingdings;ş	panose-1:5 0 0 0 0 0 0 0 0 0;}ş@font-faceş	{font-family:"Cambria Math";ş	panose-1:2 4 5 3 5 4 6 3 2 4;}ş@font-faceş	{font-family:Calibri;ş	panose-1:2 15 5 2 2 2 4 3 2 4;}ş /* Style Definitions */ş p.MsoNormal, li.MsoNormal, div.MsoNormalş	{margin:0in;ş	margin-bottom:.0001pt;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}şp.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraphş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:0in;ş	margin-left:.5in;ş	margin-bottom:.0001pt;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}ş.MsoChpDefaultş	{font-family:"Calibri",sans-serif;}ş.MsoPapDefaultş	{margin-bottom:8.0pt;ş	line-height:107%;}ş@page WordSection1ş	{size:8.5in 11.0in;ş	margin:1.0in 1.0in 1.0in 1.0in;}şdiv.WordSection1ş	{page:WordSection1;}ş /* List Definitions */ş olş	{margin-bottom:0in;}şulş	{margin-bottom:0in;}ş-->ş</style>şş</head>şş<body lang=EN-US>şş<div class=WordSection1>şş<p class=MsoNormal><b><span style='font-size:14.0pt'>Portal Dashboard Reports</span></b></p>şş<p class=MsoNormal>&nbsp;</p>şş<p class=MsoNormal><b><span style='font-size:12.0pt'>High level dashboardşsummarizing Sales, Gross Profit, Margin, AR, and AP</span></b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Month to Date and Year to Date numbers</p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>AR Balance amounts and percentages for the aging periods of current,ş1-30, 31-60, 61-90, and 90+</p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>AP Balance amounts for the aging periods of current, 1-30, 31-60,ş61-90, and 90+</p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Drilldown functionality to see detail for Sales, Gross Profit,şMargin, and aging for AR and AP</p>şş<p class=MsoNormal><b>&nbsp;</b></p>şş<p class=MsoNormal><b><span style='font-size:12.0pt'>Sales, Gross Profit, andşMargin Reports:</span></b></p>şş<p class=MsoNormal><b><span style='font-size:12.0pt'>&nbsp;</span></b></p>şş<p class=MsoNormal><b>MTD Sales</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing daily activity broken out by Sales and GP</p>şş<p class=MsoNormal><b>YTD Sales</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing each month of the current year broken out by Salesşand GP</p>şş<p class=MsoNormal><b>Year to Year Sales and GP</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Sales and GP for each of the past few years</p>şş<p class=MsoNormal><b>Year to Year Sales by Month</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Sales by month, comparing each of the past fewşyears.</p>şş<p class=MsoNormal><b>Year to Year GP by Month</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing GP by month, comparing each of the past fewşyears.</p>şş<p class=MsoNormal><b>MTD Sales by Salesman</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Month to Date Sales and GP broken out by Salesperson.</p>şş<p class=MsoNormal><b>YTD Sales by Salesman</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Year to Date Sales and GP broken out by Salesperson.</p>şş<p class=MsoNormal><b>Year to Year Sales by Salesman</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Year to Year Sales broken out by Salesperson</p>şş<p class=MsoNormal><b>Year to Year GP by Salesman</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Year to Year GP broken out by Salesperson</p>şş<p class=MsoNormal><b>MTD Sales by Branch</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Month to Date Sales and GP broken out by Branch.</p>şş<p class=MsoNormal><b>YTD Sales by Branch</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Year to Date Sales and GP broken out by Branch.</p>şş<p class=MsoNormal><b>Year to Year Sales by Branch</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Year to Year Sales broken out by Branch.</p>şş<p class=MsoNormal><b>Year to Year GP by Branch</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Year to Year GP broken out by Branch.</p>şş<p class=MsoNormal><b>MTD Sales by Region</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Month to Date Sales and GP broken out by Region.</p>şş<p class=MsoNormal><b>YTD Sales by Region</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Year to Date Sales and GP broken out by Region.</p>şş<p class=MsoNormal><b>Year to Year Sales by Region</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Year to Year Sales broken out by Region.</p>şş<p class=MsoNormal><b>Year to Year GP by Region</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart showing Year to Year GP broken out by Region.</p>şş<p class=MsoListParagraph style='margin-left:0in'>&nbsp;</p>şş<p class=MsoListParagraph style='margin-left:0in'><b><span style='font-size:ş12.0pt'>AR Reports</span></b></p>şş<p class=MsoListParagraph style='margin-left:0in'><b><span style='font-size:ş12.0pt'>&nbsp;</span></b></p>şş<p class=MsoNormal><b>Current AR Aging</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Pie chart breaking out all receivables broken out by current, 0-30,ş31-60, 61-90, and 90+</p>şş<p class=MsoNormal><b>Average AR Aging Days by Year</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart comparing the average days to pay for the past fewşyears.</p>şş<p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><spanşstyle='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;ş</span></span>Drill down on a year to see a pie chart showing the AR aging forşthe year broken out by 0-30, 31-60, 61-90, and 90+.</p>şş<p class=MsoNormal><b>Average Days to Pay Last 12 Months</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart comparing the average days to pay, by month, for theşpast 12 months.</p>şş<p class=MsoNormal><b>Average Days by Month YYYY</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Bar chart comparing the average days to pay for each month inşyear YYYY. This option will appear for the past few years with YYYY showing theşyear.</p>şş<p class=MsoNormal><b>Customers Needing Aging Attention</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Table report showing the categories of:</p>şş<p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><spanşstyle='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;ş</span></span>50 Customers with the most amount owed</p>şş<p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><spanşstyle='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;ş</span></span>50 Customers with the most days aged.</p>şş<p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><spanşstyle='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;ş</span></span>50 Customers aged over 30 days where their average aging over theşpast 60 days is longer than it has been over the past 1000 days.</p>şş<p class=MsoNormal><b><span style='font-size:12.0pt'>&nbsp;</span></b></p>şş<p class=MsoNormal><b><span style='font-size:12.0pt'>AP Reports</span></b></p>şş<p class=MsoNormal><b>&nbsp;</b></p>şş<p class=MsoNormal><b>Current AP Aging</b></p>şş<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:şSymbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Pie chart breaking out all payables broken out by current, 0-30,ş31-60, 61-90, and 90+</p>şş<p class=MsoNormal>&nbsp;</p>şş<p class=MsoNormal>&nbsp;</p>şş</div>şş</body>şş</html>002160web_ed_settings.htmlş0c2ş<html xmlns="http://www.w3.org/1999/xhtml">ş  <head>ş    <title>D3 Web Editor Settings</title>ş    <meta http-equiv="content-type" content="text/html; charset=<!--CHARACTER_SET-->" />ş    <link rel="stylesheet" type="text/css" href="/db/css/reset.css" media="screen" />ş    <link rel="stylesheet" type="text/css" href="/db/css/screen.css" media="screen" />ş    <!--[if IE]>ş    <link rel="stylesheet" type="text/css" href="/db/css/screen_ie.css" media="screen" />ş    <![endif]-->ş    <script src="/db/javascripts/jquery.tools.min.js" type="text/javascript"></script>ş    <script src="/db/javascripts/global.js" type="text/javascript"></script>ş  </head>ş  <body>ş    <div id="header" class="group">ş      <div id="logo">D3 Web Editor Settings</div>ş    </div>    ş    <div id="main" class="group">ş      <div id="content" class="group">ş        <div id="section" class="group">ş          <ul class="tabs group"> ş            <li><a href="#">General Settings</a></li> ş            <li><a href="#">Accounts</a></li> ş            <li><a href="#">Program Files</a></li> ş          </ul>ş          <div class="panes"> ş            <div class="pane">ş              <form action="/dbc/WEB.ED.SETTINGS" method="POST">ş                <fieldset>ş                  <legend>Compiling Defaults</legend>ş                  <ul class="form">ş                    <li class="enable">ş                      <input type="checkbox" class="checkbox" id="enable_compiling" name="enable_compiling" [ENABLE_COMPILING] />ş                      <label for="enable_compiling">Enable Compiling</label>ş                    </li>ş                    <li>ş                      <label>Compile Verb:</label>ş                      <input type="text" class="text" name="compile_verb" value="[COMPILE_VERB]" />ş                    </li>ş                    <li>ş                      <label>Compile Options:</label>ş                      <input type="text" class="text" name="compile_opts" value="[COMPILE_OPTS]" />ş                    </li>ş                    <li>ş                      <label for="flash">Flash Compile (0 option)</label>ş                      <input type="checkbox" class="checkbox" id="flash" name="flash_compile" [FLASH_COMPILE] />ş                    </li>ş                    <li>ş                      <label for="catalog">Catalog after compile</label>ş                      <input type="checkbox" class="checkbox" id="catalog" name="catalog" [CATALOG] />ş                    </li>ş                  </ul>ş                </fieldset>ş                <fieldset>ş                  <legend>Options</legend>ş                  <ul class="form">ş                    <li>ş                      <label>Text Size:</label>ş                      <select name="text_size">ş                        [TEXT_SIZE_OPTS]ş                      </select>ş                    </li>ş                    <li>ş                      <label>Default Account:</label>ş                      <input type="text" class="text" name="default_account" value="[DEFAULT_ACCOUNT]" />ş                    </li>ş                    <li>ş                      <label>Default File:</label>ş                      <input type="text" class="text" name="default_file" value="[DEFAULT_FILE]"  />ş                    </li>ş                  </ul>ş                </fieldset>ş                <fieldset>ş                  <ul>ş                    <li>ş                      <input type="checkbox" class="checkbox" id="default" name="global_default" [GLOBAL_DEFAULT] />ş                      <label for="default">Set as default settings for all users</label>ş                    </li>ş                  </ul>ş                </fieldset>ş              </form>ş            </div> ş            <div class="pane">ş              <div class="table">ş                <table cellspacing="0">ş                  <thead>ş                    <tr>ş                      <th>Account</th>ş                      <th>Password</th>ş                      <th>Settings</th>ş                      <th>Options</th>ş                    </tr>ş                  </thead>ş                  <tbody>ş                  [ACCOUNT_LIST]ş                  </tbody>ş                </table>ş              </div>ş              <div>ş                <form action="/dbc/WEB.ED.SETTINGS" method="POST">ş                  <fieldset>ş                    <label for="account">Account</label>ş                    <input type="text" class="text" name="add_account" value="" />ş                    <input type="submit" value="Add" class="submit"/>ş                  </fieldset>ş                </form>ş              </div>ş            </div>ş            <div class="pane">ş              <div class="table">ş                <table cellspacing="0">ş                  <thead>ş                    <tr>ş                      <th>Account</th>ş                      <th>File</th>ş                      <th>Settings</th>ş                      <th>Options</th>ş                    </tr>ş                  </thead>ş                  <tbody>ş                  [FILE_LIST]ş                  </tbody>ş                </table>ş              </div>ş              <div class="footer_form">ş                <form action="#">ş                  <fieldset>ş                    <label for="account">Account</label>ş                    <input type="text" class="text" style="margin-right: 10px;"/>ş                    <label for="account">File</label>ş                    <input type="text" class="text"/>ş                    <input type="submit" value="Add" class="submit"/>ş                  </fieldset>ş                </form>ş              </div>ş            </div> ş          </div>ş        </div>ş      </div>ş    </div>ş    <!-- modals --> ş    <div class="modal" id="edit_account_settings"> ş      <form action="#">ş        <fieldset>ş          <legend>Settings for Account: 00000</legend>ş          <ul class="form">ş            <li>ş              <label>Password for LOGTO this account:</label>ş              <input type="password" class="text"/>ş            </li>ş            <li class="enable">ş              <input type="checkbox" class="checkbox" id="enable_compiling_edit_account_settings"/>ş              <label for="enable_compiling_edit_account_settings">Enable Compiling</label>ş            </li>ş            <li>ş              <label>Compile Verb:</label>ş              <input type="text" class="text"/>ş            </li>ş            <li>ş              <label>Compile Options:</label>ş              <input type="text" class="text"/>ş            </li>ş            <li>ş              <label for="flash_edit_account_settings">Flash Compile (0 option)</label>ş              <input type="checkbox" class="checkbox" id="flash_edit_account_settings"/>ş            </li>ş            <li>ş              <label for="catalog_edit_account_settings">Catalog after compile</label>ş              <input type="checkbox" class="checkbox" id="catalog_edit_account_settings"/>ş            </li>ş          </ul>ş        </fieldset>ş        <div class="buttons">ş          <input type="submit" value="Save"/>ş          <input type="submit" value="Cancel" class="close"/>ş        </div>ş      </form>ş    </div>ş    <div class="modal" id="edit_compile_settings"> ş      <form action="#">ş        <fieldset>ş          <legend>Compile Settings for 00000, 00000</legend>ş          <ul class="form">ş            <li class="enable">ş              <input type="checkbox" class="checkbox" id="enable_compiling_edit_compile_settings"/>ş              <label for="enable_compiling_edit_compile_settings">Enable Compiling</label>ş            </li>ş            <li>ş              <label>Compile Verb:</label>ş              <input type="text" class="text"/>ş            </li>ş            <li>ş              <label>Compile Options:</label>ş              <input type="text" class="text"/>ş            </li>ş            <li>ş              <label for="flash_edit_compile_settings">Flash Compile (0 option)</label>ş              <input type="checkbox" class="checkbox" id="flash_edit_compile_settings"/>ş            </li>ş            <li>ş              <label for="catalog_edit_compile_settings">Catalog after compile</label>ş              <input type="checkbox" class="checkbox" id="catalog_edit_compile_settings"/>ş            </li>ş          </ul>ş        </fieldset>ş        <div class="buttons">ş          <input type="submit" value="Save"/>ş          <input type="submit" value="Cancel" class="close"/>ş        </div>ş      </form>ş    </div>ş  </body>ş</html>00110Eadmin_dashboards.htmlş0c2<!-- Add new dashboard form -->ş<script type="text/javascript">şdashboard_ids = [<!-- list_of_dashboard_ids -->];şşş</script>ş<div id="dashboard-controls" class="ui-dialog">ş	<div class="button-pane-dialog">ş		<button id="save-dashboard" type="button" class="ui-state-default ui-corner-all">Save</button>ş		<button id="delete-dashboard" type="button" class="ui-state-default ui-corner-all">Delete</button>ş	</div>ş</div>şş<div id="dashboard-accordion" class="ui-accordion ui-widget ui-helper-reset">ş	<h3 id='dashboard-properties-header' class="ui-accordion-header ui-helper-reset ui-state-active ui-corner-top"><span class="ui-icon ui-icon-triangle-1-s"></span>Properties</h3>ş	<div id='dashboard-properties' title='New Dashboard' class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content-active" style="height: 350px;">ş			<div id="dashboard-messages"></div>ş		<form id="new-dashboard-form" method="post" action="/dbc/MVDB.ADMIN">ş		<div>	ş			<input id="old_dbid" type="hidden" value="<!-- save_dbid -->" name="save_dbid" />ş			<input type="hidden" value="save_db" name="action" />	ş			<input type="hidden" value="Save" name="save_db" />ş		</div>ş		ş		<table>ş		<tbody><tr>ş		 <td  align="right">Dashboard ID:</td>ş		 <td id="dbid-container">ş		 <!-- edit_dbid -->ş		 </td>ş		</tr>ş		<tr>ş		 <td align="right">Description:</td>ş		 <td><input id="db_desc" type="text" value="<!-- db_desc -->" name="db_desc" size="63" /></td>ş		</tr>ş		<tr>ş		 <td align="right">Layout:</td>ş		 <td><input type="hidden" id="db_layout" name="db_layout" value="<!-- " />ş		 	<ul class='db-layout'>ş		 	<!-- db_layout_opts -->ş			</ul> 	     	    ş		 </td>ş		</tr>ş		<tr>ş		 <td align="right">Allowed Users:</td>ş		 <td><input id="db_users" type="text" value="<!-- db_users -->" name="db_users" size="63" /></td>ş		</tr>ş		<tr>ş		<td> </td><td>Leave blank to allow all users. Separate user IDs with commas to restrict acces to specific users.</td>ş		</tr>ş		<tr>ş		 <td align="right">Theme:</td>ş		 <td><!-- db_theme --></td>ş		</tr>ş		<tr>ş		 <td align="right">Sort Value:</td>ş		 <td><input id="db_sort" type="text" value="<!-- db_sort -->" name="db_sort" size="8" /></td>ş		</tr>ş		</tbody></table>ş		</form>ş	</div>ş	ş    <h3 class="ui-accordion-header ui-helper-reset ui-state-active ui-corner-top"><span class="ui-icon ui-icon-triangle-1-s"></span> Dashboard</h3>ş    <div id="dashboard-content" class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content-active">ş    		<div id="layout-header" class="one-column area">ş    		  <h4>HEADER</h4>ş              <!-- AREA_1_WIDGETS -->ş    		</div>ş	    	<div id="layout-body">ş		    <div class="one-column active">ş		    	<div class="area">ş		    	  <h4>AREA 1</h4>ş                  <!-- AREA_2_WIDGETS -->ş		    	</div>ş		    </div>ş		    <div class="two-column">ş		    	<div class="area first">ş		    	  <h4>AREA 1</h4>ş                  <!-- AREA_2_WIDGETS -->ş		    	</div>ş		   	    <div class="area last">ş		   	      <h4>AREA 2</h4>ş                  <!-- AREA_3_WIDGETS -->ş		   	    </div>        ş		    </div>ş		    <div class="three-column">ş		       	<div class="area first">ş		       	  <h4>AREA 1</h4>ş                  <!-- AREA_2_WIDGETS -->ş		       	</div>ş		    	<div class="area middle">ş		    	  <h4>AREA 2</h4>ş                  <!-- AREA_3_WIDGETS -->ş		    	</div>        ş		       	<div class="area last">ş		       	  <h4>AREA 3</h4>ş                  <!-- AREA_4_WIDGETS -->ş		        </div>    	ş		    </div>            ş	    	</div>ş    		<div id="layout-footer" class="one-column area">ş    		  <h4>FOOTER</h4>ş              <!-- AREA_5_WIDGETS -->ş    		</div>ş    </div>ş</div>    şş<div id="widget-toolbox" class="ui-accordion">şş	<h3 class="widget-header ui-accordion-header ui-state-active ui-state-focus"><span class="ui-icon ui-icon-triangle-1-s"></span>Widgets (draggable)</h3>ş		<div id="widget-icons"  class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content-active">ş		<!-- widget_list -->ş		</div>şş</div>şş<div id='change-layout-message' title="Change layout?" style="display: none; text-align: left;">ş	<p>Your layout areas currently have one or more widgets. Clicking 'Change' will move these widgets to the first column area.</p>ş</div>000621login.htmlş0c2<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">ş<head>ş	<meta http-equiv="Content-Type" content="text/html; charset=<!--CHARACTER_SET-->"/>ş	<link rel="stylesheet" href="/db/css/reset-fonts-grids.css" type="text/css" charset="utf-8" />ş	<link rel="stylesheet" href="/db/css/application.css" type="text/css" charset="utf-8" />ş	<title>MultiValue Dashboard :: Login</title>ş</head>şş<body onLoad="document.loginform.loginid.focus();">şş	<div id="header">ş		<div id="logo">ş		  <BR /><img src="<!-- SITE_LOGO -->" alt="MultiValue Dashboard">ş	   </div>ş	<!-- HEADER -->ş	</div>şş	<div id="dashboard">ş		<b><!-- ERROR --></b>şş		<div style="text-align:center;">ş			<h1><img src="/db/images/graphic_lock.gif" style="vertical-align:bottom;"/> Please Login</h1>ş			<div style="width:180px;text-align:left;margin:10px auto" id="loginbox">ş				<form name="loginform" action="<!-- CGI$PATH -->/MVDB.MAIN?dblogin=1" method="post">şş					<div class="ctrl">ş						<label for="login">Login</label>ş						<input id="getlogin" type="text" name="loginid" value="" class="text">ş					</div>şş					<div class="ctrl">ş						<label for="password">Password</label>ş						<input type="password" name="password" value="" class="password">ş					</div>ş	ş					<div class="ctrl">ş						<input type="submit" value="Login" style="float:right">ş					</div>ş	ş				</form>ş			</div>ş		</div>ş	ş	</div>şş	<div id="signature">MultiValue Dashboard - Copyright &copy; 2020 <a href="http://www.zumasys.com/products/multivalue-dashboard">Zumasys</a></div>ş	ş</body>ş</html>000273FCMAP_template.htmlş0c2<!-- Fusion Chart Script -->ş	<div id="<!-- chart_div_id -->">ş	</div>ş	<input type="hidden" class="chartSource" value="/db/Maps/FCMap_[FCMAP_MODULE].swf" />ş	<input type="hidden" class="chartXML" value="<!-- CHARTXML -->" />ş	<input type="hidden" class="chartClass" value="fcmap" />ş	<script type="text/javascript">ş		// <![CDATA[ş		   var map = new FusionMaps("/db/Maps/FCMap_[FCMAP_MODULE].swf", "ChartId", "<!-- chart_width -->", "<!-- chart_height -->", "0", "1");ş		   map.setDataXML("<!-- CHARTXML -->");		   ş		   map.render("<!-- chart_div_id -->");ş		// ]]>ş	</script>ş<!-- end of FC script -->0010C9SAVE.PORTAL.DASHBOARDş0c2  <br class="brClear" />ş  <div class="widget_content">ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<th width=38% align="left" bgcolor="red">Sales</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% bgcolor="white">&nbsp;</td>ş<td width=31% align="center">MTD ~1~</td>ş<td width=31% align="center">YTD ~2~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=Portal Sales Reports">Sales</a></td>ş<td width=31% align="right">~3~</td>ş<td width=31% align="right">~4~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=Portal Sales Reports">Gross Profit (GP$)</a></td>ş<td width=31% align="right">~5~</td>ş<td width=31% align="right">~6~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=Portal Margins&udview=Portal Margins">Margin (GP%)</a></td>ş<td width=31% align="right">~7~</td>ş<td width=31% align="right">~8~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="0" cellspacing=".01%" cellpadding=".01%">ş<td width="100%">&nbsp;</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<th width=38% align="left" bgcolor="red">Financials</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="38%" bgcolor="white">&nbsp;</td><td width="31%" align="center">MDT ~9~</td><td width="31%" align="center">YTD ~10~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="38%" align="left"><a href="/dbc/MVDB.MAIN?dbname=DISPLAY NET INCOME CHART">Net Income</a></td><td width="31%" align="right">~11~</td><td width="31%" align="right">~12~</td>ş</table>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="38%" align="left"><a href="/dbc/MVDB.MAIN?dbname=DISPLAY AVERAGE DAYS CHART">Average Days To Pay</a></td><td width="31%" align="center">~13~</td><td width="31%" align="center">~14~</td>ş</table>ş<table width="100%" border="0" cellspacing=".01%" cellpadding=".01%">ş<td width="100%">&nbsp;</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="left"><a href="/dbc/MVDB.MAIN?dbname=Portal Margins&udview=Portal Margins">Balances as of ~15~</a></td><td width="25%" align="center">AR Balance</td><td width="25%" align="center">AR Balance %</td><td width="25%" align="center">AP Balance</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">1 - 30</td><td width="25%" align="right">~16~</td><td width="25%" align="center">~17~</td><td width="25%" align="right">~18~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">31 - 60</td><td width="25%" align="right">~19~</td><td width="25%" align="center">~20~</td><td width="25%" align="right">~21~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">61 - 90</td><td width="25%" align="right">~22~</td><td width="25%" align="center">~23~</td><td width="25%" align="right">~24~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">90+</td><td width="25%" align="right">~25~</td><td width="25%" align="center">~26~</td><td width="25%" align="right">~27~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">Total</td><td width="25%" align="right">~28~</td><td width="25%" align="center"></td><td width="25%" align="right">~29~</td>ş</table>ş<table width="100%" border="0" cellspacing=".01%" cellpadding=".01%">ş<td width="100%">&nbsp;</td>ş</table>ş</div>000251FW_template.htmlş0c2<!-- start FW script -->ş        <div id="<!-- chart_div_id -->">ş        </div>ş        <script type="text/javascript">ş        FusionCharts.ready(function () {ş            var myChart = new FusionCharts({ş              "type": "[FW_MODULE]",ş              "renderAt": "<!-- chart_div_id -->",ş              "width": "<!-- chart_width -->",ş              "height": "<!-- chart_height -->",ş              "dataFormat": "xml",ş              "dataSource": "<!-- CHARTXML -->"ş            });ş          myChart.render();ş        });ş        </script>ş<!-- end of FW script -->000603PORTAL.DASHBOARD.SALES.GPş0c2  <br class="brClear" />ş  <div class="widget_content">ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<th width=38% align="left" bgcolor="red">Sales</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% bgcolor="white">&nbsp;</td>ş<td width=31% align="center">MTD ~1~</td>ş<td width=31% align="center">YTD ~2~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=PORTAL SALES REPORTS">Sales</a></td>ş<td width=31% align="right">~3~</td>ş<td width=31% align="right">~4~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=PORTAL SALES REPORTS">Gross Profit (GP$)</a></td>ş<td width=31% align="right">~5~</td>ş<td width=31% align="right">~6~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=PORTAL MARGINS&udview=Portal Margins">Margin (GP%)</a></td>ş<td width=31% align="right">~7~</td>ş<td width=31% align="right">~8~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="0" cellspacing=".01%" cellpadding=".01%">ş<td width="100%">&nbsp;</td>ş</table>ş</div>000163db_inner_templateş0c2<div id="area1" class="area">ş <!-- AREA1 -->ş</div>ş<div class="content <!-- column_style -->">ş  <div id="area2" class="area">ş   <!-- AREA2 -->ş  </div>ş  <div id="area3" class="area">ş   <!-- AREA3 -->ş  </div>ş  <div id="area4" class="area">ş   <!-- AREA4 -->ş  </div>ş</div>ş<div id="area5" class="area">ş  <!-- AREA5 -->ş</div>000C40PORTAL.DASHBOARD.SALES.ARş0c2  <br class="brClear" />ş  <div class="widget_content">ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<th width=38% align="left" bgcolor="red">Sales</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% bgcolor="white">&nbsp;</td>ş<td width=31% align="center">MTD ~1~</td>ş<td width=31% align="center">YTD ~2~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=PORTAL SALES REPORTS">Sales</a></td>ş<td width=31% align="right">~3~</td>ş<td width=31% align="right">~4~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="0" cellspacing=".01%" cellpadding=".01%">ş<td width="100%">&nbsp;</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<th width=38% align="left" bgcolor="red"><font color="#FF0000">Financials</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="left"><a href="/dbc/MVDB.MAIN?dbname=DISPLAY PORTAL BALANCE PIE CHART&udview=DISPLAY PORTAL BALANCE PIE CHART">Balances as of ~15~</a></td><td width="25%" align="center">AR Balance</td><td width="25%" align="center">AR Balance %</td><td width="25%" align="center"></td>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">Current</td><td width="25%" align="right">~30~</td><td width="25%" align="center">~31~</td><td width="25%" align="right">~32~</td>ş</table>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">1 - 30</td><td width="25%" align="right">~16~</td><td width="25%" align="center">~17~</td><td width="25%" align="right">~18~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">31 - 60</td><td width="25%" align="right">~19~</td><td width="25%" align="center">~20~</td><td width="25%" align="right">~21~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">61 - 90</td><td width="25%" align="right">~22~</td><td width="25%" align="center">~23~</td><td width="25%" align="right">~24~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">90+</td><td width="25%" align="right">~25~</td><td width="25%" align="center">~26~</td><td width="25%" align="right">~27~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">Total</td><td width="25%" align="right">~28~</td><td width="25%" align="center"></td><td width="25%" align="right">~29~</td>ş</table>ş<table width="100%" border="0" cellspacing=".01%" cellpadding=".01%">ş<td width="100%">&nbsp;</td>ş</table>ş</div>0013E6DEMO.FINANCIALS.DASHBOARDş0c2  <br class="brClear" />ş  <div class="widget_content">ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<thead>ş<tr>ş<th width=24% align="left" bgcolor="red">Sales</th>ş<th width=19% bgcolor="white">&nbsp;</th>ş<th width=19% bgcolor="white">&nbsp;</th>ş<th width=19% bgcolor="white">&nbsp;</th>ş<th width=19% bgcolor="white">&nbsp;</th>ş</tr>ş</thead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<thead>ş<tr>ş<td width=24% bgcolor="white">&nbsp;</td>ş<td width=19% align="center">YTD~1~</td>ş<td width=19% align="center">YTD~2~</td>ş<td width=19% align="center">%(+/-)</td>ş<td width=19% align="center">FY~3~</td>ş</tr>ş</thead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<thead>ş<tr>ş<td width=24% align="left"><a href="/dbc/MVDB.MAIN?dbname=DEMO REV.GP SALES CHART&udview=DEMO REV.GP SALES CHART&dd=dd&udpos1=1&udval1=REVENUES">Sales</a></td>ş<td width=19% align="right">~4~</td>ş<td width=19% align="right">~5~</td>ş<td width=19% align="right">~6~</td>ş<td width=19% align="right">~7~</td>ş</tr>ş</thead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<thead>ş<tr>ş<td width=24% align="left"><a href="/dbc/MVDB.MAIN?dbname=DEMO REV.GP SALES CHART&udview=DEMO REV.GP SALES CHART&dd=dd&udpos1=1&udval1=GROSSPROFIT">Gross Profit (GP$)</a></td>ş<td width=19% align="right">~8~</td>ş<td width=19% align="right">~9~</td>ş<td width=19% align="right">~10~</td>ş<td width=19% align="right">~11~</td>ş</tr>ş</thead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<thead>ş<tr>ş<td width=24% align="left"><a href="/dbc/MVDB.MAIN?dbname=DEMO SALES CHART&udview=DEMO SALES CHART&dd=dd&udpos1=1&udval1=MARGIN">Margin (GP%)</a></td>ş<td width=19% align="right">~12~</td>ş<td width=19% align="right">~13~</td>ş<td width=19% align="right"></td>ş<td width=19% align="right">~14~</td>ş</tr>ş</thead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<thead>ş<tr>ş<td width=24% align="left"><a href="/dbc/MVDB.MAIN?dbname=DEMO SALES CHART&udview=DEMO SALES CHART&dd=dd&udpos1=1&udval1=PARTS$">Parts Revenue ($)</a></td>ş<td width=19% align="right">~15~</td>ş<td width=19% align="right">~16~</td>ş<td width=19% align="right">~17~</td>ş<td width=19% align="right">~18~</td>ş</tr>ş</thead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<thead>ş<tr>ş<td width=24% align="left"><a href="/dbc/MVDB.MAIN?dbname=DEMO SALES PERCENTS&udview=DEMO SALES PERCENTS&dd=dd&udpos1=1&udval1=PARTSPERCENT">Parts Revenue (%)</a></td>ş<td width=19% align="right">~19~</td>ş<td width=19% align="right">~20~</td>ş<td width=19% align="right"></td>ş<td width=19% align="right">~21~</td>ş</tr>ş</thead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<thead>ş<tr>ş<td width=24% align="left"><a href="/dbc/MVDB.MAIN?dbname=DEMO SALES CHART&udview=DEMO SALES CHART&dd=dd&udpos1=1&udval1=SERVICES$">Services Revenue ($)</a></td>ş<td width=19% align="right">~22~</td>ş<td width=19% align="right">~23~</td>ş<td width=19% align="right">~24~</td>ş<td width=19% align="right">~25~</td>ş</tr>ş</thead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<thead>ş<tr>ş<td width=24% align="left"><a href="/dbc/MVDB.MAIN?dbname=DEMO SALES PERCENTS&udview=DEMO SALES PERCENTS&dd=dd&udpos1=1&udval1=SERVICESPERCENT">Services Revenue (%)</a></td>ş<td width=19% align="right">~26~</td>ş<td width=19% align="right">~27~</td>ş<td width=19% align="right"></td>ş<td width=19% align="right">~28~</td>ş</tr>ş</thead>ş</table>ş<table width="100%" cols="4" border="0">ş<table width="100%" cols="4" border="0">ş<table width="100%" cols="4" border="0">ş<td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<thead>ş<tr>ş<th width=24% align="left" bgcolor="red">Financials</th>ş<th width=25% bgcolor="white">&nbsp;</th>ş<th width=25% bgcolor="white">&nbsp;</th>ş<th width=25% bgcolor="white">&nbsp;</th>ş</tr>ş</thead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" bgcolor="white">&nbsp;</td><td width="25%" align="center">~29~ thru ~30~</td><td width="25%" align="center">~31~</td><td width="25%" align="center">~32~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="left"><a href="/dbc/MVDB.MAIN?dbname=DEMO NET INCOME CHART&udview=DEMO NET INCOME CHART&dd=dd">Net Income</a></td><td width="25%" align="right">~33~</td><td width="25%" align="right">~34~</td><td width="25%" align="right">~35~</td>ş</table>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="left"><a href="/dbc/MVDB.MAIN?dbname=DEMO AVERAGE DAYS CHART&udview=DEMO AVERAGE DAYS CHART&dd=dd">Average Days To Pay</a></td><td width="25%" align="center">~44~</td><td width="25%" align="center">~45~</td><td width="25%" align="center">~46~</td>ş</table>0005A9admin_login.htmlş0c2ş<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">ş<head>ş	<meta http-equiv="Content-Type" content="text/html; charset=<!--CHARACTER_SET-->"/>ş	<link rel="stylesheet" href="/db/css/reset-fonts-grids.css" type="text/css" charset="utf-8" />ş	<link rel="stylesheet" href="/db/css/application.css" type="text/css" charset="utf-8" />ş    <!-- SITE_THEME -->ş	<title>MultiValue Dashboard :: Administrative Login</title>ş</head>şş<body onLoad="document.loginform.adminpass.focus();">şş	<div id="header">ş		<div id="logo">ş			<img src="<!-- SITE_LOGO -->" alt="MultiValue Dashboard">ş	   </div>ş	<!-- HEADER -->ş	</div>şş	<div id="dashboard">ş		<b><!-- ERROR --></b>şş		<div style="text-align:center;">ş			<h1><img src="/db/images/graphic_lock.gif" style="vertical-align:bottom;"/> Please Login</h1>ş			<div style="width:180px;text-align:left;margin:10px auto" id="loginbox">ş				<form name="loginform" action="<!-- CGI$PATH -->/MVDB.ADMIN" method="post">şş					<div class="ctrl">ş						<label for="password">Password</label>ş						<input type="password" name="adminpass" value="" class="password">ş					</div>ş	ş					<div class="ctrl">ş						<input type="submit" value="Login" style="float:right">ş					</div>ş	ş				</form>ş			</div>ş		</div>ş	ş	</div>şş	<div id="signature">MultiValue Dashboard - copyright &copy; 2020 <a href="http://www.zumasys.com/products/multivalue-dashboard">Zumasys</a></div>ş	ş</body>ş</html>000E90PORTAL.DASHBOARD.SALES.GP.ARş0c2  <br class="brClear" />ş  <div class="widget_content">ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<th width=38% align="left" bgcolor="red">Sales</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% bgcolor="white">&nbsp;</td>ş<td width=31% align="center">MTD ~1~</td>ş<td width=31% align="center">YTD ~2~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=PORTAL SALES REPORTS">Sales</a></td>ş<td width=31% align="right">~3~</td>ş<td width=31% align="right">~4~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=PORTAL SALES REPORTS">Gross Profit (GP$)</a></td>ş<td width=31% align="right">~5~</td>ş<td width=31% align="right">~6~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=PORTAL MARGINS&udview=Portal Margins">Margin (GP%)</a></td>ş<td width=31% align="right">~7~</td>ş<td width=31% align="right">~8~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="0" cellspacing=".01%" cellpadding=".01%">ş<td width="100%">&nbsp;</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<th width=38% align="left" bgcolor="red"><font color="#FF0000">Financials</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="left"><a href="/dbc/MVDB.MAIN?dbname=DISPLAY PORTAL BALANCE PIE CHART&udview=DISPLAY PORTAL BALANCE PIE CHART">Balances as of ~15~</a></td><td width="25%" align="center">AR Balance</td><td width="25%" align="center">AR Balance %</td><td width="25%" align="center"> </td>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">Current</td><td width="25%" align="right">~30~</td><td width="25%" align="center">~31~</td><td width="25%" align="right">~32~</td>ş</table>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">1 - 30</td><td width="25%" align="right">~16~</td><td width="25%" align="center">~17~</td><td width="25%" align="right">~18~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">31 - 60</td><td width="25%" align="right">~19~</td><td width="25%" align="center">~20~</td><td width="25%" align="right">~21~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">61 - 90</td><td width="25%" align="right">~22~</td><td width="25%" align="center">~23~</td><td width="25%" align="right">~24~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">90+</td><td width="25%" align="right">~25~</td><td width="25%" align="center">~26~</td><td width="25%" align="right">~27~</td>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<td width="25%" align="center">Total</td><td width="25%" align="right">~28~</td><td width="25%" align="center"></td><td width="25%" align="right">~29~</td>ş</table>ş<table width="100%" border="0" cellspacing=".01%" cellpadding=".01%">ş<td width="100%">&nbsp;</td>ş</table>ş</div>000E1Eed_template.htmlş0c2<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" >ş<head>ş    <meta http-equiv="Content-Type" content="text/html; charset=<!--CHARACTER_SET-->" />ş    <title>Editing <!-- ITEM --></title>ş    <script language="Javascript" type="text/javascript" src="/db/edit_area/edit_area_full.js"></script>ş    <script src="/db/javascripts/jquery-1.3.2.min.js" type="text/javascript" charset="<!--CHARACTER_SET-->"></script>	ş    <!--script src="/db/javascripts/jquery-ui-1.7.2.custom.min.js" type="text/javascript" charset="<!--CHARACTER_SET-->"></script-->şş<script src="/db/javascripts/jquery-ui-1.7.2.custom.min.js" type="text/javascript" charset="<!--CHARACTER_SET-->"></script>    	    ş    <script src="/db/javascripts/jquery.form.js" type="text/javascript" charset="<!--CHARACTER_SET-->"></script>    	    ş    <!--script src="/db/javascripts/shortcut.js" type="text/javascript" charset="<!--CHARACTER_SET-->"></script-->ş    <script language="Javascript" type="text/javascript">	    ş	    ş    	CALLS = <!-- NUM_OF_CALLS -->;ş        INCLUDES = <!-- NUM_OF_INCLUDES -->;ş        FILES = <!-- NUM_OF_FILES -->;                ş        ARCHIVES = <!-- NUM_OF_ARCHIVES -->;ş        CALLS_CONTENT = '<!-- EA_CALLS_CONTENT -->';ş        INCLUDES_CONTENT = '<!-- EA_INCLUDES_CONTENT -->';ş        FILES_CONTENT = '<!-- EA_FILES_CONTENT -->';ş        ARCHIVE_CONTENT = '<!-- EA_ARCHIVE_CONTENT -->';ş        LAST_COMPILE = '<!-- LAST_COMPILE -->';        ş       	<!-- ED_SCRIPTS -->şş        // initialisation        şş	editAreaLoader.init({ş            id: "file_1" // id of the textarea to transformş            ,start_highlight: true  // if start with highlightş            ,allow_resize: "both"ş            ,allow_toggle: falseş            ,word_wrap: trueş            ,language: "en"ş            ,begin_toolbar: "load, save"ş            ,toolbar: "search, go_to_line, |, undo, redo, |, select_font,|, change_smooth_selection, highlight, reset_highlight, word_wrap, |, help" ş            ,save_callback: 'saveCompileItem'ş            ,EA_load_callback: "editAreaLoadComplete" ş            ,load_callback: 'openItem'ş            ,fullscreen: trueş            ,closebottomtab_callback: 'closeActiveTab'ş            ,syntax: "<!-- SYNTAX -->"ş        });ş	ş    <!-- WINDOW_HEIGHT - Put this where it needs to go -->ş    </script>    şş    <script src="/db/javascripts/edit_area_init.js" type="text/javascript" charset="<!--CHARACTER_SET-->"></script> ş    <script language="javascript" type="text/javascript">ş       	<!-- ED_INIT_SCRIPT -->ş    </script>ş       <link rel="StyleSheet" href="/db/css/web_editor.css" media="screen" type="text/css" />ş       <link rel="StyleSheet" href="/db/css/jquery-ui.css" media="screen" type="text/css" />ş       <!--[if lte IE 8]>ş       <link rel="Stylesheet" href="/db/css/ie.css" media="screen" type="text/css" />ş       <![endif]-->ş</head>ş<body>şş<div id="open-item-container" title="Open Item" style="display:none;">ş<span id="messages"> </span>ş<form id="open-item-form" name="open-item-form" action="" method="post">ş<label>Account:</label>ş<input id="ed_acct" type="text" value="" name="ed_acct" />ş<label>File: </label>ş<input id="ed_file" type="text" value="" name="ed_file"/>ş<label>Item: </label>ş<input id="ed_item" type="text" value="" name="ed_item"/>ş<input id="open-action" type="hidden" name="action" value="open" />ş</form>ş</div>şş<div id="compile-output-container" title="Compile output">ş<div id="compile-content"></div>ş</div>ş<!-- HEADER -->ş<hr />ş<!-- BODY -->ş<hr />ş<!-- FOOTER -->ş<!-- COMPILE_OUTPUT -->ş<hr />ş</body>ş</html>000082pdf_inner_templateş0c2<div id="areas" class="area">ş <!-- AREA1 --><!-- AREA2 --><!-- AREA3 --><!-- AREA4 --><!-- AREA5 -->ş</div>002FAFJBASE.PORTAL.SETUP.DOCUMENTATIONş0c2<html>şş<head>ş<meta http-equiv=Content-Type content="text/html; charset=windows-1252">ş<meta name=Generator content="Microsoft Word 15 (filtered)">ş<style>ş<!--ş /* Font Definitions */ş @font-faceş	{font-family:Wingdings;ş	panose-1:5 0 0 0 0 0 0 0 0 0;}ş@font-faceş	{font-family:"Cambria Math";ş	panose-1:2 4 5 3 5 4 6 3 2 4;}ş@font-faceş	{font-family:Calibri;ş	panose-1:2 15 5 2 2 2 4 3 2 4;}ş /* Style Definitions */ş p.MsoNormal, li.MsoNormal, div.MsoNormalş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:8.0pt;ş	margin-left:0in;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}şp.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraphş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:8.0pt;ş	margin-left:.5in;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}şp.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirstş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:0in;ş	margin-left:.5in;ş	margin-bottom:.0001pt;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}şp.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddleş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:0in;ş	margin-left:.5in;ş	margin-bottom:.0001pt;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}şp.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLastş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:8.0pt;ş	margin-left:.5in;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}ş.MsoChpDefaultş	{font-family:"Calibri",sans-serif;}ş.MsoPapDefaultş	{margin-bottom:8.0pt;ş	line-height:107%;}ş@page WordSection1ş	{size:8.5in 11.0in;ş	margin:1.0in 1.0in 1.0in 1.0in;}şdiv.WordSection1ş	{page:WordSection1;}ş /* List Definitions */ş olş	{margin-bottom:0in;}şulş	{margin-bottom:0in;}ş-->ş</style>şş</head>şş<body lang=EN-US>şş<div class=WordSection1>şş<p class=MsoNormal><b><span style='font-size:14.0pt;line-height:107%'>PortalşSales Report Setup:</span></b></p>şş<p class=MsoNormal>This setup process identifies the fields necessary forşderiving sales, gross profit, and margin numbers.  It allows for sales numbersşto be broken out by sales person and, if applicable, by branch and/or region.</p>şş<p class=MsoNormal><b>Sales File Account Path</b>  Multi-value systems normallyşhave multiple accounts where data may reside. The sales reports will be drivenşby a file of sales.  This field needs the path to the account where that fileşresides.</p>şş<p class=MsoNormal><b>Name of Sales File</b>  The name of the file containingşthe sales information.</p>şş<p class=MsoNormal><b>Date of Sale Dict Name</b>  The name of the dictionaryşitem in the sales file that contains the date the sale was complete.</p>şş<p class=MsoNormal><b>Month of Sale Dict Name</b>  The name of the dictionaryşitem in the sales file that displays the numeric value of the month the saleşwas completed.  If the system doesnt have this dictionary item, there shouldşbe one created using the Date of Sale Dict Name as a guide.</p>şş<p class=MsoNormal><b>Year of Sale Dict Name </b> The name of the dictionaryşitem in the sales file that displays the 4 digit year the sale was completed.  Ifşthe system doesnt have this dictionary item, there should be one created usingşthe Date of Sale Dict Name as a guide.</p>şş<p class=MsoNormal><b>Amount of Sale Dict Name</b>  The name of the dictionaryşitem in the sales file that contains the total amount of the sales transaction.ş This dictionary </p>şş<p class=MsoNormal><b>Cost of Sale Dict Name</b>  The name of the dictionaryşitem in the sales file that contains the cost of the sales transaction.  Thisşis used for determining gross profit and margin.  If this information is notşavailable in the system, the field should be left blank, disabling reportsşassociated with gross profit and margin.</p>şş<p class=MsoNormal><b>Salesman Dict Name</b>  The name of the dictionary itemşin the sales file that contains the primary salesman on the transaction.  Mostşsystems will have a salesman code in the sales file and another file thatşcontains the actual names of the salesmen.  This dictionary item should be oneşthat displays the actual name.  </p>şş<p class=MsoNormal><b>Branch Dict Name</b>   The name of the dictionary itemşin the sales file that contains the branch being credited with theştransaction.  Most systems will have a branch code in the sales file andşanother file that contains the actual names of the branches.  This dictionaryşitem should be one that displays the actual name.  This field only applies ifşsales can be broken out by a branch.  </p>şş<p class=MsoNormal><b>Region Dict Name</b>   The name of the dictionary itemşin the sales file that contains the region being credited with theştransaction.  Most systems will have a region code in the sales file andşanother file that contains the actual names of the regions.  This dictionaryşitem should be one that displays the actual name.  This field only applies ifşsales can be broken out by a region.  </p>şş<p class=MsoNormal><b>Go</b>  No validation is made on Portal Sales ReportşSetup fields until this button is clicked.  When validating, checks are madeşfor:</p>şş<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Valid account</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Valid file name in the account</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Existence of each of the dictionary names entered</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Salesman Dict Name looking to another file for the actual name ofşthe salesman.  An ignorable warning is issued if that is not the case.</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Branch Dict Name looking to another file for the actual name ofşthe branch.  An ignorable warning is issued if that is not the case.</p>şş<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Region Dict Name looking to another file for the actual name ofşthe region.  An ignorable warning is issued if that is not the case.</p>şş<p class=MsoNormal>&nbsp;</p>şş<p class=MsoNormal><b><span style='font-size:14.0pt;line-height:107%'>Portal ARşReport Setup:</span></b></p>şş<p class=MsoNormal>This setup process identifies the fields necessary for evaluatingşaccount receivables.  It breaks out statistics by amounts, aging categories, percentages,şand periods for comparison purposes.  It also identifies by customer whenşviewing most amounts owed, most days aged, and accounts with significant changesşin payment patterns.</p>şş<p class=MsoNormal><b>AR File Account</b>  The AR reports will be driven by aşfile of receivables or invoices.  This field needs the name of the accountşwhere that file resides.</p>şş<p class=MsoNormal><b>Name of AR File</b>  The name of the file containing theşreceivables with amounts and payment information.</p>şş<p class=MsoNormal><b>Due Date Dict Name</b>  The name of the dictionary itemşin the AR file showing the due date of the receivable.</p>şş<p class=MsoNormal><b>Date Paid Dict Name</b>  The name of the dictionary itemşin the AR file showing the date the receivable was paid.</p>şş<p class=MsoNormal><b>Invoice Amount Dict Name</b>  The name of the dictionaryşitem in the AR file that contains the original amount owed. </p>şş<p class=MsoNormal><b>Remaining Balance Dict Name</b>  The name of theşdictionary item in the AR file that contains the remaining balance. </p>şş<p class=MsoNormal><b>Customer Dict Name</b>  The name of the dictionary itemşin the AR file that contains the customer.  Most systems will have a customerşcode in the AR file and another file that contains the actual names of the customers. şThis dictionary item should be one that displays the actual name.  </p>şş<p class=MsoNormal><b>Go</b>  No validation is made on Portal AR Report Setupşfields until this button is clicked.  When validating, checks are made for:</p>şş<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Valid account</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Valid file name in the account</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Existence of each of the dictionary names entered</p>şş<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Customer Dict Name looking to another file for the actual name ofşthe salesman.  An ignorable warning is issued if that is not the case.</p>şş<p class=MsoNormal>&nbsp;</p>şş<p class=MsoNormal><b><span style='font-size:14.0pt;line-height:107%'>Portal APşReport Setup:</span></b></p>şş<p class=MsoNormal>This setup process identifies the fields necessary for evaluatingşaccount payables.  It breaks out statistics by amounts, aging categories, and percentages.</p>şş<p class=MsoNormal><b>AP File Account</b>  The AP reports will be driven by aşfile of payables.  This field needs the name of the account where that fileşresides.</p>şş<p class=MsoNormal><b>Name of AP File</b>  The name of the file containing theşpayables with amounts and payment information.</p>şş<p class=MsoNormal><b>Due Date Dict Name</b>  The name of the dictionary itemşin the AP file showing the due date of the payable.</p>şş<p class=MsoNormal><b>Date Paid Dict Name</b>  The name of the dictionary itemşin the AP file showing the date the payable was paid.</p>şş<p class=MsoNormal><b>Invoice Amount Dict Name</b>  The name of the dictionaryşitem in the AP file that contains the original amount owed. </p>şş<p class=MsoNormal><b>Remaining Balance Dict Name</b>  The name of theşdictionary item in the AP file that contains the remaining balance. </p>şş<p class=MsoNormal><b>Go</b>  No validation is made on Portal AP Report Setupşfields until this button is clicked.  When validating, checks are made for:</p>şş<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Valid account</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Valid file name in the account</p>şş<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Existence of each of the dictionary names entered</p>şş<p class=MsoNormal>&nbsp;</p>şş<p class=MsoNormal>&nbsp;</p>şş<p class=MsoNormal>&nbsp;</p>şş<p class=MsoNormal>&nbsp;</p>şş</div>şş</body>şş</html>000202WIDGET.DIVş0c2<div class="widget">ş  <div class="widget_header">ş   <div class="widget_controls"><!-- CONTROLS --></div>ş   <h3 class="title"><!-- TITLE --></h3>ş   <!-- INPUT -->ş   <div class="widget_content_header"><!-- QUAD2 --><!-- QUAD1 -->ş        <div class="clear"></div>ş     </div>ş  </div>ş  <div class="widget_content"><div class="widget_content_padding"><!-- WIDGETDATA --></div></div>ş  <div class="widget_content_footer">ş   <!-- QUAD3 --><!-- QUAD4 -->ş  <div class="clear" ></div>ş </div>ş</div>ş000348PORTAL.DASHBOARD.SALESş0c2  <br class="brClear" />ş  <div class="widget_content">ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<th width=38% align="left" bgcolor="red">Sales</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş<th width=31% bgcolor="white">&nbsp;</th>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% bgcolor="white">&nbsp;</td>ş<td width=31% align="center">MTD ~1~</td>ş<td width=31% align="center">YTD ~2~</td>ş</tr>ş</tdead>ş</table>ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=38% align="left"><a href="/dbc/MVDB.MAIN?dbname=PORTAL SALES REPORTS">Sales</a></td>ş<td width=31% align="right">~3~</td>ş<td width=31% align="right">~4~</td>ş</tr>ş</tdead>ş</table>ş</div>001A1BPORTAL.REPORT.RUN.DOCUMENTATIONş0c2<html>şş<head>ş<meta http-equiv=Content-Type content="text/html; charset=windows-1252">ş<meta name=Generator content="Microsoft Word 15 (filtered)">ş<style>ş<!--ş /* Font Definitions */ş @font-faceş	{font-family:Wingdings;ş	panose-1:5 0 0 0 0 0 0 0 0 0;}ş@font-faceş	{font-family:"Cambria Math";ş	panose-1:2 4 5 3 5 4 6 3 2 4;}ş@font-faceş	{font-family:Calibri;ş	panose-1:2 15 5 2 2 2 4 3 2 4;}ş /* Style Definitions */ş p.MsoNormal, li.MsoNormal, div.MsoNormalş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:8.0pt;ş	margin-left:0in;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}şp.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraphş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:8.0pt;ş	margin-left:.5in;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}şp.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirstş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:0in;ş	margin-left:.5in;ş	margin-bottom:.0001pt;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}şp.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddleş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:0in;ş	margin-left:.5in;ş	margin-bottom:.0001pt;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}şp.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLastş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:8.0pt;ş	margin-left:.5in;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}ş.MsoChpDefaultş	{font-family:"Calibri",sans-serif;}ş.MsoPapDefaultş	{margin-bottom:8.0pt;ş	line-height:107%;}ş@page WordSection1ş	{size:8.5in 11.0in;ş	margin:1.0in 1.0in 1.0in 1.0in;}şdiv.WordSection1ş	{page:WordSection1;}ş /* List Definitions */ş olş	{margin-bottom:0in;}şulş	{margin-bottom:0in;}ş-->ş</style>şş</head>şş<body lang=EN-US>şş<div class=WordSection1>şş<p class=MsoNormal style='margin-bottom:12.0pt'><b><span style='font-size:14.0pt;şline-height:107%'>Running the Portal Dashboard Reports</span></b></p>şş<p class=MsoListParagraphCxSpFirst style='margin-bottom:12.0pt;text-indent:ş-.25in'><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Run the Portal Reports Setup to configure the elements necessaryşto run the reports.  See the Portal Reports Setup Documentation </p>şş<p class=MsoListParagraphCxSpMiddle style='margin-bottom:12.0pt;text-indent:ş-.25in'><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Run the Portal Dashboard to view the summary of sales andşfinancials.</p>şş<p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;şmargin-bottom:12.0pt;margin-left:1.0in;text-indent:-.25in'><spanşstyle='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;ş</span></span>The dashboard wants to have calculations refreshed within theşpast 15 minutes.  If, when starting the dashboard, it has been over 15 minutesşsince the last calculations, a temporary display will show that figures areşupdating.  After a satisfactory delay of a minute or so, click the Go buttonşand the summary of sales and financials page should display.  If not, repeatşuntil it displays.</p>şş<p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;şmargin-bottom:12.0pt;margin-left:1.0in;text-indent:-.25in'><spanşstyle='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;ş</span></span>Leaving the dashboard running with Auto-Refresh slider activated forşabout every 5 minutes will automatically refresh the dashboard display andştrigger a background recalculation of numbers when necessary.</p>şş<p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;şmargin-bottom:12.0pt;margin-left:1.0in;text-indent:-.25in'><spanşstyle='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;ş</span></span>The title section of each dashboard page shows the date and timeşthe last calculations were run.</p>şş<p class=MsoListParagraphCxSpMiddle style='margin-bottom:12.0pt;text-indent:ş-.25in'><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>On the summary of sales and financials, those labels underlinedşand displayed in a color can drilled down on to display additional dashboards.</p>şş<p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;şmargin-bottom:12.0pt;margin-left:1.0in;text-indent:-.25in'><spanşstyle='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;ş</span></span>Drill down on <u><span style='color:#C45911'>Sales</span></u> toşinitiate the Portal Sales Reports dashboard</p>şş<p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;şmargin-bottom:12.0pt;margin-left:1.0in;text-indent:-.25in'><spanşstyle='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;ş</span></span>Drill down on <u><span style='color:#C45911'>Gross Profit (GP$)</span></u><spanşstyle='color:#C45911'> </span>to initiate the same Portal Sales Reportsşdashboard</p>şş<p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;şmargin-bottom:12.0pt;margin-left:1.0in;text-indent:-.25in'><spanşstyle='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;ş</span></span>Drill down on <u><span style='color:#C45911'>Margin (GP%)</span></u><spanşstyle='color:#C45911'> </span>to initiate the Portal Year to Year Marginsşdashboard</p>şş<p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;şmargin-bottom:12.0pt;margin-left:1.0in;text-indent:-.25in'><spanşstyle='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;ş</span></span>Drill down on the <u><span style='color:#C45911'>Balances as ofşMM-DD-YY</span></u><span style='color:#C45911'> </span>to initiate the AR andşAP dashboard</p>şş<p class=MsoListParagraphCxSpLast style='margin-bottom:12.0pt;text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>After doing a drill downs, the browser back button can be used toşnavigate back to the previous dashboard, or simply clicking on the PortalşDashboard tab will re-initialize back to the summary of sales and financials.</p>şş</div>şş</body>şş</html>00015Cadmin_menu.htmlş0c2<ol class="admin_nav_links">ş  <li><a href="<!-- CGI$PATH -->/MVDB.ADMIN?action=users" class="bullet_link">Users</a>ş  <li><a href="<!-- CGI$PATH -->/MVDB.ADMIN?action=widgets" class="bullet_link">Widgets</a>ş  <li><a href="<!-- CGI$PATH -->/MVDB.ADMIN?action=dashboards" class="bullet_link">Dashboards</a>  ş  <!-- RSS -->ş</ol>000281message.htmlş0c2<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">ş<head>ş    <meta http-equiv="Content-Type" content="text/html; charset=<!--CHARACTER_SET-->"/>ş    <link rel="stylesheet" href="/db/css/reset-fonts-grids.css" type="text/css" charset="utf-8" />ş    <link rel="stylesheet" href="/db/css/application.css" type="text/css" charset="utf-8" />ş    <title>MultiValue Dashboard :: Login</title>ş</head>ş<body>ş<div id="header">ş<div id="logo">ş  <br /><img src="<!-- SITE_LOGO -->" alt="MultiValue Dashboard">ş</div>ş</div>ş<div id="dashboard">ş<h1><!-- MSG_TITLE --></h1>ş<!-- MSG_CONTENT -->ş</div>ş</body>ş</html>000C78dbtemplateş0c2<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">ş<head>ş    <meta http-equiv="Content-Type" content="text/html; charset=<!--CHARACTER_SET-->"/>ş    <meta http-equiv="X-UA-Compatible" content="IE=edge,IE=11,IE=10,IE=9,IE=8,IE=7" />ş    <link rel="stylesheet" href="/db/css/reset-fonts-grids.css" type="text/css" charset="utf-8" />ş    <link rel="stylesheet" href="/db/css/application.css" type="text/css" charset="utf-8" />ş    <link rel="stylesheet" href="/db/css/print.css" type="text/css" charset="utf-8" media="print" />ş    <!--[if lte IE 7]><link href="/db/css/ie7.css" rel="stylesheet" type="text/css" media="screen" /><![endif]-->ş        ş    <!-- SITE_THEME -->ş    ş    <!-- end styles -->ş    ş    ş    ş    <script type="text/javascript" src="/db/javascripts/prototype-1.6.1.js"></script>ş    <script type="text/javascript" src="/db/javascripts/jquery-1.3.2.min.js"></script>ş    <script type="text/javascript" src="/db/javascripts/jquery-ui-1.8.custom.min.js"></script>ş    <script type="text/javascript">jQuery.noConflict();</script>ş    <script type="text/javascript" src="/db/fw/fusioncharts.js"></script>ş    <script type="text/javascript" src="/db/javascripts/sortable.js"></script>ş    <script type="text/javascript" src="/db/javascripts/tablesort.js"></script>ş    <script type="text/javascript" src="/db/javascripts/grid-widget.js"></script>ş    <script type="text/javascript" src="/db/javascripts/printing.js"></script>ş    <script type="text/javascript" src="/db/javascripts/slider.js"></script>ş    ş    <link rel="StyleSheet" href="/db/css/jquery-ui.css" media="screen" type="text/css" />ş    <style type="text/css" media="screen" >ş            /* put the left rounded edge on the track */ş            #track1-left {ş                position: absolute;ş                width: 5px;ş                height: 9px;ş                background: transparent url(/db/images/bg_slider_track.png) no-repeat top left;ş            }ş            ş            /* put the track and the right rounded edge on the track */ş            #track1 {ş                background: transparent url(/db/images/bg_slider_track.png) no-repeat top right;ş            }ş    </style>şş    <script>ş            jQuery(function() {ş                    jQuery(".datepicker").datepicker();ş            });ş    </script>şş    <title>MultiValue Dashboard</title>ş    <!-- REFRESH -->şş    ş</head>ş<body>ş<div id="printFrame" class="printme"></div>ş<div id="header">ş<!-- HEADER -->şş</div>şş    <div style="clear:both"></div>ş    <div id="logo">ş        <img src="<!-- SITE_LOGO -->" alt="MultiValue Dashboard">ş    </div>ş    ş<!-- RefreshSlider -->şş<div id="dashboardWrapper">ş    <div id="dashboard">ş        <!-- DASHBOARD -->ş        <div class="clear"></div>ş    </div>ş    <div class="clear"></div>ş    <br/>ş</div>ş<div id="footer">ş    <!-- FOOTER -->ş    <div id="signature">MultiValue Dashboard - Copyright &copy; 2020 <a href="http://www.zumasys.com/products/multivalue-dashboard">Zumasys</a></div>ş</div>ş<script type="text/javascript">ş/*jQuery(document).ready(function(){ş       jQuery('.widgetized').tablesort();ş     });*/ş</script>şş    ş</body>ş</html>000548rss_edit.htmlş0c2<form action="<!-- CGI$PATH -->/RSS.MAINT" method="post">ş<input type="hidden" name="id" value="<!-- feed_id -->">ş<input type="hidden" name="action" value="save">ş<table>ş<tr>ş <td align="right">Feed ID:</td>ş <td><!-- edit_feed_id --></td>ş</tr>ş<tr>ş <td align="right">Name:</td>ş <td><input type="text" name="feed_name" value="<!-- feed_name -->"></td>ş</tr>ş<tr>ş <td align="right">Description:</td>ş <td><textarea name="feed_desc" rows="5" cols="50"><!-- feed_desc --></textarea></td>ş</tr>ş<tr>ş <td align="right">Select Subroutine:</td>ş <td><input type="text" name="sel_sub" value="<!-- sel_sub -->"> <!-- sel_sub_msg --> <a target="RSS.BP_<!-- sel_sub -->" href="/dbc/MVDB.WEB.ED?ed_file=RSS.BP&ed_item=<!-- sel_sub -->">Edit Source</a></td>ş</tr>ş<tr>ş <td align="right">Item Subroutine:</td>ş <td><input type="text" name="item_sub" value="<!-- item_sub -->"> <!-- item_sub_msg --> <a target="RSS.BP_<!-- item_sub -->" href="/dbc/MVDB.WEB.ED?ed_file=RSS.BP&ed_item=<!-- item_sub -->">Edit Source</a></td>ş</tr>ş<tr>ş  <td align="right">Modes:</td>ş  <td><textarea name="feed_modes" rows="10" cols="50"><!-- feed_modes --></textarea></td>ş</tr>ş<!-- EXTRA -->ş<tr>ş<td colspan="2"><input type="submit" name="save_feed" value="Save">ş&nbsp;ş<input type="submit" name="cancel_edit" value="Cancel"></td> ş</tr>ş</table>ş</form>ş000B5Frss_admin_template.htmlş0c2<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">ş<head>ş	<meta http-equiv="Content-Type" content="text/html; charset=<!--CHARACTER_SET-->"/>ş<link rel="stylesheet" href="/db/css/reset-fonts-grids.css" type="text/css" charset="utf-8" /> ş<link rel="stylesheet" href="/db/css/application.css" type="text/css" charset="utf-8" /> ş<link rel="StyleSheet" href="/db/css/jquery-ui.css" media="screen" type="text/css" /> ş ş<script src="/db/javascripts/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>	ş<script src="/db/javascripts/jquery-ui-1.7.2.custom.min.js" type="text/javascript" charset="utf-8"></script>            	ş<script src="/db/javascripts/jquery.form.js" type="text/javascript" charset="utf-8"></script>    	        ş<script src="/db/javascripts/jquery.url.js" type="text/javascript" charset="utf-8"></script> ş		ş<script src="/db/javascripts/rss_admin.js" type="text/javascript"></script>ş<!--[if lte IE 7]><link href="/db/css/ie7.css" rel="stylesheet" type="text/css" media="screen" /><![endif]-->ş<!-- SITE_THEME -->ş<title>RSS Feed Admin</title>ş</head>ş<body>ş<div id="header">ş<!-- HEADER -->ş  <div id="logo">ş  	<img src="<!-- SITE_LOGO -->" alt="MultiValue Dashboard">ş  </div>ş</div>şşş<div id="mainWrapper">ş	ş	<div id="rss-dialog" title="New RSS Feed">ş		<div id="rss-messages"></div>ş		<form id="rss-form" method="post" action="/dbc/RSS.MAINT">ş			<input id="feed_id" type="hidden" value="NEW" name="id"/>ş			<input type="hidden" value="save" name="action"/>ş			<input type="hidden" value="Save" name="save_feed"/>			ş			<table>ş			<tbody><tr>ş			 <td align="right">Feed ID:</td>ş			 <td><input id="new_id" type="text" value="" name="new_id"/></td>ş			</tr>ş			<tr>ş			 <td align="right">Name:</td>ş			 <td><input id="feed_name" type="text" value="" name="feed_name"/></td>ş			</tr>ş			<tr>ş			 <td align="right">Description:</td>ş			 <td><textarea id="feed_desc" cols="50" rows="5" name="feed_desc"></textarea></td>ş			</tr>ş			<tr>ş			 <td align="right">Select Subroutine:</td>ş			 <td><input id="select_sub" type="text" value="" name="sel_sub"/>  <a id="edit-sub-link" href="/dbc/MVDB.WEB.ED?ed_file=RSS.BP&amp;ed_item=" target="RSS.BP_">Edit Source</a></td>ş			</tr>ş			<tr>ş			 <td align="right">Item Subroutine:</td>ş			 <td><input id="item_sub" type="text" value="" name="item_sub"/>  <a id="edit-item-link" href="/dbc/MVDB.WEB.ED?ed_file=RSS.BP&amp;ed_item=" target="RSS.BP_">Edit Source</a></td>ş			</tr>ş			<tr>ş			  <td align="right">Modes:</td>ş			  <td><textarea id="feed_modes" cols="50" rows="10" name="feed_modes"></textarea></td>ş			</tr>ş			</tbody></table>şş		</form>ş	</div>şş<!-- ADMIN_MAIN -->ş</div>ş<div id="footer">ş    <div id="signature">MultiValue Dashboard - Copyright &copy; 2020 <a href="http://www.zumasys.com/products/multivalue-dashboard/?tldb">Zumasys</a>ş    </div>ş</div>ş</body>ş</html>0008E5RefreshSliderş0c2<!-- outerTrackWrapper -->ş    ş<script type="text/javascript" language="javascript">ş  // <![CDATA[ş  // horizontal slider controlş  var slider1 = new Control.Slider('handle1', 'track1', {ş    range: $R(0, 9),ş    values: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],ş    sliderValue: 1, // won't work if set to 0 due to a bug in script.aculo.usş    onSlide: function(v) { showRefresh(v); },ş    onChange: function(v) { if ($('horizontal-slider')) {ş                    $('horizontal-slider').value = v; $('slider-form').submit(); ş                    }ş    }ş  });ş  function setSliderValue(slider, value) {ş    // due to onChange code above we need this or ş    // a 0 will be put in the text box when you delete the valueş    //if (value == '') return;ş    if (isNaN(value)) {ş      slider.setValue(0.1);ş    } else {ş      slider.setValue(value);ş    }ş  }ş  function showRefresh(value) {ş    var dispRate = '';ş    switch (value) {ş      case 0:ş        dispRate = 'Auto-Refresh: Off';ş        break ;ş      case 1:ş        dispRate = 'Auto-Refresh: 15 seconds';ş        break ;ş      case 2:ş        dispRate = 'Auto-Refresh: 30 seconds';ş        break ;      ş      case 3:ş        dispRate = 'Auto-Refresh: 1 minute';ş        break ;ş      case 4:ş        dispRate = 'Auto-Refresh: 2 minutes';ş        break ;      ş      case 5:ş        dispRate = 'Auto-Refresh: 5 minutes';ş        break ;      ş      case 6:ş        dispRate = 'Auto-Refresh: 10 minutes';ş        break ;      ş      case 7:ş        dispRate = 'Auto-Refresh: 15 minutes';ş        break ;      ş      case 8:ş        dispRate = 'Auto-Refresh: 30 minutes';ş        break ;      ş      case 9:ş        dispRate = 'Auto-Refresh: 1 hour';ş        break ;      ş      default:ş        dispRate = 'Auto-Refresh: Off';ş        break ;ş    }ş    document.getElementById('dispRate').innerHTML = dispRate;ş  }ş  var refreshRate = '<!-- REFRESH_RATE -->';ş  showRefresh(parseInt(refreshRate));  ş  if (refreshRate != '') {ş    setSliderValue(slider1, refreshRate);ş  } else {ş    setSliderValue(slider1, 0.1);  ş  }ş  // ]]>ş</script>ş<form name="reForm" method="post" action="" id="slider-form">ş  <input type="hidden" id="horizontal-slider" name="refresh" value="<!-- REFRESH_RATE -->" />ş</form>         00026APORTAL.DOCUMENTATIONş0c2  <br class="brClear" />ş  <div class="widget_content">ş<table width="100%" border="1" cellspacing=".01%" cellpadding=".01%">ş<tdead>ş<tr>ş<td width=100% align="center"><a href="/dbc/MVDB.MAIN?dbname=PORTAL RUN DOCUMENTATION">Running the Portal Dashboard Reports</a></td>ş</tr>ş<tr>ş<td width=100% align="center"><a href="/dbc/MVDB.MAIN?dbname=PORTAL.SETUP.DOCUMENTATION">Portal Reports Setup Documentation</a></td>ş</tr>ş<tr>ş<td width=100% align="center"><a href="/dbc/MVDB.MAIN?dbname=PORTAL.REPORTS.DOCUMENTATION">Glossary of Portal Dashboard Reports</a></td>ş</tr>ş</tdead>ş</table>ş</div>002FA4PORTAL.SETUP.DOCUMENTATIONş0c2<html>şş<head>ş<meta http-equiv=Content-Type content="text/html; charset=windows-1252">ş<meta name=Generator content="Microsoft Word 15 (filtered)">ş<style>ş<!--ş /* Font Definitions */ş @font-faceş	{font-family:Wingdings;ş	panose-1:5 0 0 0 0 0 0 0 0 0;}ş@font-faceş	{font-family:"Cambria Math";ş	panose-1:2 4 5 3 5 4 6 3 2 4;}ş@font-faceş	{font-family:Calibri;ş	panose-1:2 15 5 2 2 2 4 3 2 4;}ş /* Style Definitions */ş p.MsoNormal, li.MsoNormal, div.MsoNormalş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:8.0pt;ş	margin-left:0in;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}şp.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraphş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:8.0pt;ş	margin-left:.5in;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}şp.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirstş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:0in;ş	margin-left:.5in;ş	margin-bottom:.0001pt;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}şp.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddleş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:0in;ş	margin-left:.5in;ş	margin-bottom:.0001pt;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}şp.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLastş	{margin-top:0in;ş	margin-right:0in;ş	margin-bottom:8.0pt;ş	margin-left:.5in;ş	line-height:107%;ş	font-size:11.0pt;ş	font-family:"Calibri",sans-serif;}ş.MsoChpDefaultş	{font-family:"Calibri",sans-serif;}ş.MsoPapDefaultş	{margin-bottom:8.0pt;ş	line-height:107%;}ş@page WordSection1ş	{size:8.5in 11.0in;ş	margin:1.0in 1.0in 1.0in 1.0in;}şdiv.WordSection1ş	{page:WordSection1;}ş /* List Definitions */ş olş	{margin-bottom:0in;}şulş	{margin-bottom:0in;}ş-->ş</style>şş</head>şş<body lang=EN-US>şş<div class=WordSection1>şş<p class=MsoNormal><b><span style='font-size:14.0pt;line-height:107%'>PortalşSales Report Setup:</span></b></p>şş<p class=MsoNormal>This setup process identifies the fields necessary forşderiving sales, gross profit, and margin numbers.  It allows for sales numbersşto be broken out by sales person and, if applicable, by branch and/or region.</p>şş<p class=MsoNormal><b>Sales File Account</b>  Multi-value systems normallyşhave multiple accounts where data may reside. The sales reports will be drivenşby a file of sales.  This field needs the name of the account where that fileşresides.</p>şş<p class=MsoNormal><b>Name of Sales File</b>  The name of the file containingşthe sales information.</p>şş<p class=MsoNormal><b>Date of Sale Dict Name</b>  The name of the dictionaryşitem in the sales file that contains the date the sale was complete.</p>şş<p class=MsoNormal><b>Month of Sale Dict Name</b>  The name of the dictionaryşitem in the sales file that displays the numeric value of the month the saleşwas completed.  If the system doesnt have this dictionary item, there shouldşbe one created using the Date of Sale Dict Name as a guide.</p>şş<p class=MsoNormal><b>Year of Sale Dict Name </b> The name of the dictionaryşitem in the sales file that displays the 4 digit year the sale was completed.  Ifşthe system doesnt have this dictionary item, there should be one created usingşthe Date of Sale Dict Name as a guide.</p>şş<p class=MsoNormal><b>Amount of Sale Dict Name</b>  The name of the dictionaryşitem in the sales file that contains the total amount of the sales transaction.ş This dictionary </p>şş<p class=MsoNormal><b>Cost of Sale Dict Name</b>  The name of the dictionaryşitem in the sales file that contains the cost of the sales transaction.  Thisşis used for determining gross profit and margin.  If this information is notşavailable in the system, the field should be left blank, disabling reportsşassociated with gross profit and margin.</p>şş<p class=MsoNormal><b>Salesman Dict Name</b>  The name of the dictionary itemşin the sales file that contains the primary salesman on the transaction.  Mostşsystems will have a salesman code in the sales file and another file thatşcontains the actual names of the salesmen.  This dictionary item should be oneşthat displays the actual name.  </p>şş<p class=MsoNormal><b>Branch Dict Name</b>   The name of the dictionary itemşin the sales file that contains the branch being credited with theştransaction.  Most systems will have a branch code in the sales file andşanother file that contains the actual names of the branches.  This dictionaryşitem should be one that displays the actual name.  This field only applies ifşsales can be broken out by a branch.  </p>şş<p class=MsoNormal><b>Region Dict Name</b>   The name of the dictionary itemşin the sales file that contains the region being credited with theştransaction.  Most systems will have a region code in the sales file andşanother file that contains the actual names of the regions.  This dictionaryşitem should be one that displays the actual name.  This field only applies ifşsales can be broken out by a region.  </p>şş<p class=MsoNormal><b>Go</b>  No validation is made on Portal Sales ReportşSetup fields until this button is clicked.  When validating, checks are madeşfor:</p>şş<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Valid account</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Valid file name in the account</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Existence of each of the dictionary names entered</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Salesman Dict Name looking to another file for the actual name ofşthe salesman.  An ignorable warning is issued if that is not the case.</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Branch Dict Name looking to another file for the actual name ofşthe branch.  An ignorable warning is issued if that is not the case.</p>şş<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Region Dict Name looking to another file for the actual name ofşthe region.  An ignorable warning is issued if that is not the case.</p>şş<p class=MsoNormal>&nbsp;</p>şş<p class=MsoNormal><b><span style='font-size:14.0pt;line-height:107%'>Portal ARşReport Setup:</span></b></p>şş<p class=MsoNormal>This setup process identifies the fields necessary for evaluatingşaccount receivables.  It breaks out statistics by amounts, aging categories, percentages,şand periods for comparison purposes.  It also identifies by customer whenşviewing most amounts owed, most days aged, and accounts with significant changesşin payment patterns.</p>şş<p class=MsoNormal><b>AR File Account</b>  The AR reports will be driven by aşfile of receivables or invoices.  This field needs the name of the accountşwhere that file resides.</p>şş<p class=MsoNormal><b>Name of AR File</b>  The name of the file containing theşreceivables with amounts and payment information.</p>şş<p class=MsoNormal><b>Due Date Dict Name</b>  The name of the dictionary itemşin the AR file showing the due date of the receivable.</p>şş<p class=MsoNormal><b>Date Paid Dict Name</b>  The name of the dictionary itemşin the AR file showing the date the receivable was paid.</p>şş<p class=MsoNormal><b>Invoice Amount Dict Name</b>  The name of the dictionaryşitem in the AR file that contains the original amount owed. </p>şş<p class=MsoNormal><b>Remaining Balance Dict Name</b>  The name of theşdictionary item in the AR file that contains the remaining balance. </p>şş<p class=MsoNormal><b>Customer Dict Name</b>  The name of the dictionary itemşin the AR file that contains the customer.  Most systems will have a customerşcode in the AR file and another file that contains the actual names of the customers. şThis dictionary item should be one that displays the actual name.  </p>şş<p class=MsoNormal><b>Go</b>  No validation is made on Portal AR Report Setupşfields until this button is clicked.  When validating, checks are made for:</p>şş<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Valid account</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Valid file name in the account</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Existence of each of the dictionary names entered</p>şş<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Customer Dict Name looking to another file for the actual name ofşthe salesman.  An ignorable warning is issued if that is not the case.</p>şş<p class=MsoNormal>&nbsp;</p>şş<p class=MsoNormal><b><span style='font-size:14.0pt;line-height:107%'>Portal APşReport Setup:</span></b></p>şş<p class=MsoNormal>This setup process identifies the fields necessary for evaluatingşaccount payables.  It breaks out statistics by amounts, aging categories, and percentages.</p>şş<p class=MsoNormal><b>AP File Account</b>  The AP reports will be driven by aşfile of payables.  This field needs the name of the account where that fileşresides.</p>şş<p class=MsoNormal><b>Name of AP File</b>  The name of the file containing theşpayables with amounts and payment information.</p>şş<p class=MsoNormal><b>Due Date Dict Name</b>  The name of the dictionary itemşin the AP file showing the due date of the payable.</p>şş<p class=MsoNormal><b>Date Paid Dict Name</b>  The name of the dictionary itemşin the AP file showing the date the payable was paid.</p>şş<p class=MsoNormal><b>Invoice Amount Dict Name</b>  The name of the dictionaryşitem in the AP file that contains the original amount owed. </p>şş<p class=MsoNormal><b>Remaining Balance Dict Name</b>  The name of theşdictionary item in the AP file that contains the remaining balance. </p>şş<p class=MsoNormal><b>Go</b>  No validation is made on Portal AP Report Setupşfields until this button is clicked.  When validating, checks are made for:</p>şş<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Valid account</p>şş<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Valid file name in the account</p>şş<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><spanşstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ş</span></span>Existence of each of the dictionary names entered</p>şş<p class=MsoNormal>&nbsp;</p>şş<p class=MsoNormal>&nbsp;</p>şş<p class=MsoNormal>&nbsp;</p>şş<p class=MsoNormal>&nbsp;</p>şş</div>şş</body>şş</html>000666pdftemplateş0c2<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">ş<head>ş    <meta http-equiv="Content-Type" content="text/html; charset=<!--CHARACTER_SET-->"/>ş    <link rel="stylesheet" href="/db/css/reset-fonts-grids.css" type="text/css" charset="utf-8" />ş    <link rel="stylesheet" href="/db/css/application.css" type="text/css" charset="utf-8" />ş    <!--[if lte IE 7]><link href="/db/css/ie7.css" rel="stylesheet" type="text/css" media="screen" /><![endif]-->ş        ş    <!-- SITE_THEME -->ş    ş    <!-- end styles -->ş    ş    ş    ş    <script type="text/javascript" src="/db/javascripts/prototype-1.6.1.js"></script>ş    <script type="text/javascript" src="/db/javascripts/jquery-1.3.2.min.js"></script>ş    <script type="text/javascript">jQuery.noConflict();</script>ş    <script type="text/javascript" src="/db/fw/fusioncharts.js"></script>ş    <script type="text/javascript" src="/db/javascripts/sortable.js"></script>ş    <script type="text/javascript" src="/db/javascripts/tablesort.js"></script>ş    <script type="text/javascript" src="/db/javascripts/grid-widget.js"></script>ş    <script type="text/javascript" src="/db/javascripts/printing.js"></script>ş    <script type="text/javascript" src="/db/javascripts/slider.js"></script>ş    ş    <title>MultiValue Dashboard</title>ş    ş</head>ş<body>ş<div style="clear:both"></div>ş<div id="logo">ş    <img src="<!-- SITE_LOGO -->" alt="MultiValue Dashboard">ş</div>ş<div id="dashboardWrapper">ş    <div id="dashboard">ş        <!-- DASHBOARD -->ş        <div class="clear"></div>ş    </div>ş    <div class="clear"></div>ş    <br/>ş</div>ş</body>ş</html>00022Bwidget_debug.htmlş0c2<table width="100%">ş<tr><td>Widget Name:</td><td><!-- WIDGET_NAME --></td></tr>ş<tr><td>Widget Subroutine:</td><td><!-- WIDGET_SUB_NAME --> <!-- WIDGET_EDIT_LINK --></td></tr>ş</table>ş<!-- DEBUG_REASON --><br />ş<!-- REMEDY -->şRuntime errors for <!-- WIDGET_SUB_NAME --><br />ş<table width="100%"><tr>ş<th>Date / Time</th><th>User</th><th>Error</th>ş</tr>ş<!-- RUNTIME_ERRORS -->ş<table width="100%">ş<tr><td colspan="2">WIDGET.USER.DATA values:</td></tr>ş<tr><th>Position</th><th>Value</th></tr>ş<!-- WIDGET_USER_DATA -->ş</table>000F48pkg_list_template.htmlş0c2<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">ş<head>ş<script src="/db/javascripts/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>	ş    <script src="http://alpha.bravo:83/db/javascripts/jquery-ui-1.7.2.custom.min.js" type="text/javascript" charset="utf-8"></script>            	ş    <script src="http://alpha.bravo:83/db/javascripts/jquery.form.js" type="text/javascript" charset="utf-8"></script>    	        ş	<script src="http://alpha.bravo:83/db/javascripts/jquery.url.js" type="text/javascript" charset="utf-8"></script> ş	<script src="http://alpha.bravo:83/db/javascripts/initAdminTemplate.js" type="text/javascript" charset="utf-8"></script> ş	<script src="http://alpha.bravo:83/db/javascripts/sortable.js" type="text/javascript" charset="utf-8"></script> ş	<script src="http://alpha.bravo:83/db/javascripts/tablesort.js" type="text/javascript" charset="utf-8"></script> ş	ş	<script type="text/javascript"> ş		$(function() {ş			$("#tabs").tabs();ş			$("#accordion").accordion({ autoHeight: false });ş			$('#edit_dialog').dialog({ autoOpen: false, modal: true });ş			$('#edit_form').click(function() {ş				$('#edit_dialog').dialog('open');ş			});ş			$('#delete_dialog').dialog({ autoOpen: false, modal: true });ş			$('#delete_form').click(function() {ş				$('#delete_dialog').dialog('open');ş			});ş		});ş		ş	</script> ş	ş	<link rel="stylesheet" href="http://alpha.bravo:83/db/css/reset-fonts-grids.css" type="text/css" charset="utf-8" /> ş	<link rel="stylesheet" href="http://alpha.bravo:83/db/css/application.css" type="text/css" charset="utf-8" /> ş	<link rel="stylesheet" href="http://alpha.bravo:83/db/css/ingrid.css" type="text/css" charset="utf-8" /> ş    <link rel="StyleSheet" href="http://alpha.bravo:83/db/css/jquery-ui.css" media="screen" type="text/css" /> ş    <!--[if lte IE 7]><link href="/db/css/ie7.css" rel="stylesheet" type="text/css" media="screen" /><![endif]--> ş	 ş<!-- SITE_THEME -->ş<title>Package Management</title>ş</head>ş<body>ş<div id="edit_dialog"><p>ş      <form id="new-file-form" method="get" action="/dbc/MVPKG.MAIN"> ş      <div id="new-file-messages"></div> ş      <table><tbody>ş      <tr> ş        <td colspan="2">File:<input id="file-name" type="text" value="" name="file_name"/></td> ş      </tr>ş      <tr>ş        <td><input type="radio" name="file_dict" value="DICT" id="file-dict"></td><td>DICT</td>ş      </tr>ş      <tr>ş        <td><input type="radio" name="file_dict" value="DATA" id="file-dict"></td><td>DATA</td>ş      </tr>ş      <tr> ş        <td><input type="radio" name="items_type" vaue="savedlist" id="items-type"></td><td>Saved List<br/>ş        file:<input type="text" name="savedlist_file" id="savedlist-file"><br/>ş        list:<input type="text" name="savedlist_id" id="savedlist-id"></td>ş      </tr> ş      <tr> ş        <td><input type="radio" name="items_type" value="all" id="items-type"></td><td>All Items</td>ş      </tr> ş      <tr> ş        <td><input type="radio" name="items_type" value="items" id="items-type"></td> ş        <td>Item: <input type="text" name="items_items" id="items-items"></td> ş      </tr> ş      </tbody></table> ş      <input type="hidden" value="save_user" name="action"/> ş      </form> ş      <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">ş        <button type="button" class="ui-state-default ui-corner-all">Cancel</button>ş        <button type="button" class="ui-state-default ui-corner-all">Save</button>ş      </div>ş</p></div>ş<div id="header">ş<!-- HEADER -->ş  <div id="logo">ş  	<img src="<!-- SITE_LOGO -->" alt="MultiValue Dashboard">ş  </div>ş</div>ş<div id="mainWrapper">ş<!-- ADMIN_MAIN -->ş</div>ş</div>ş<div id="footer">ş    <div id="signature">MultiValue Dashboard - Copyright &copy; 2020 <a href="http://www.zumasys.com/products/multivalue-dashboard">Zumasys</a>ş    </div>ş</div>ş</body>ş</html>0007E2MVDB.DEFSş0c00000B1Administratorş0c21şAdminConfigıPDFConfigıDashboard License UsageıCode TemplatesıD3 Runtime ErrorsıSystem - SessionıShow Varsış1ı1ı1ı2ı2ı5ı5ış1ı1ı2ı1ı2ı1ı2ışADMINıadminşAdminşş30000091Chart Demoş0c22şDemo-PieıDemo-SS LineıDemo-DoughnutıDemo-SS ColıDemo- MS Colş2ı2ı2ı3ı3ş1ı2ı3ı1ı2şADMINıguestıadminşDemonstration ChartsşTheme 1ş1000062Demo Financial Companyş0c21şDEMO FINANCIAL PICTUREış2ış1ışADMINıguestıadminşDemo Financial Company00005CDEMO AVERAGE DAYS CHARTş0c21şDEMO AVERAGE DAYS CHARTış2ış1ışdummyşdisplay average days chart00003DDEMO NET INCOME CHARTş0c21şDEMO NET INCOME CHARTış2ış1ışdummy00005BDEMO REV.GP SALES CHARTş0c21şDEMO REV.GP SALES CHARTş2ış1ışdummyşDisplay Rev.Gp Sales Chart000047DEMO SALES CHARTş0c21şDEMO SALES CHARTış2ış1ışdummyşDisplay Sales Chart000050DEMO SALES PERCENTSş0c21şDEMO SALES PERCENTSış2ış1ışdummyşDisplay Sales Percents000055Emailed Reportş0c21şEmailed Reportış2ış1ışşDisplay contents of an emailed report link000041Iconsş0c21şIcon Galleryış1ış1ışADMINıguestıadminşIcon Galleryşş50000085PORTAL REPORTS SETUPş0c21şPORTAL SALES REPORT SETUPıPORTAL AR REPORT SETUPıPORTAL AP REPORT SETUPş2ı2ı2ış1ı2ı3ışşPortal Reports Setup00003DPORTAL MARGINSş0c21şPORTAL MARGINSş2ış1ışdummyşPortal Margins000046PORTAL AR REPORTSş0c22şPORTAL AR REPORTSş3ış1ışdummyşPortal AR Reports00004FPORTAL SALES REPORTSş0c21şPORTAL SALES REPORTSş2ış1ışdummyşPortal Sales Reports00003EPORTAL DASHBOARDş0c21şPORTAL DASHBOARDş2ış1ışşPortal Dashboard000061PORTAL.SETUP.DOCUMENTATIONş0c21şPORTAL SETUP DOCUMENTATIONş2ış1ışdummyşPortal Setup Documentation000068PORTAL.REPORTS.DOCUMENTATIONş0c21şPORTAL.REPORTS.DOCUMENTATIONış2ış1ışdummyşPortal Reports Documentation00005FPORTAL DASHBOARD DOCUMENTATIONş0c23şPORTAL.DOCUMENTATIONış3ış1ışşPortal Dashboard Documentation00005CPORTAL RUN DOCUMENTATIONş0c21şPORTAL.RUN.DOCUMENTATIONış2ış1ışdummyşPortal Run Documentation00007FDISPLAY PORTAL BALANCE PIE CHARTş0c21şPORTAL AR REPORTSıPORTAL AP REPORTSş2ı2ış1ı2ışdummyşPie chart to display AR & AP balances0000B3DICT_MVDB.MAP.DATAş0c0000022NAMEş0c1Aş0şMap NameşşşşşG0*1şLş4000001FLONGş0c1Aş2şLong NameşşşşşşLş25000023INTERNAL.IDş0c1Aş0şIDşşşşşG1*1şLş10000021SHORTş0c1Aş1şShort NameşşşşşşLş10046BE6MVDB.MAP.DATAş0c0000023FrenchGuiana#GF.CY.CYş0c2CYşCayenne000018Fiji#FJ.CE.RWş0c2RWşRewa00001CMacau#MO.IL.COş0c2COşColoane00001CChina2#CN.GDş0c2GDşGuangdong000024FranceDepartment#FR.ESş0c2ESşEssonne000026FranceDepartment#FR.FIş0c2FIşFinistere000019Congo#CG.CUş0c2CUşCuvette000019Algeria#DZ.ARş0c2ARşAdrar00001AMacedonia#MK.STş0c2STşStip00001AIndiana#057ş0c2HAşHamilton000016NewYork#029ş0c2ERşErie00001FNorthCarolina#097ş0c2IRşIredell000018Georgia#249ş0c2SCşSchley00001BIreland#017ş0c2MEşM&iacute;00002CNorthAmerica#019ş0c2KNşSt. Kitts &amp; Nevis000016Kansas#051ş0c2ELşEllis00001FSouthCarolina#023ş0c2CSşChester00001AIllinois#087ş0c2JHşJohnson00001AMissouri#007ş0c2AUşAudrain000024WorldwithCountries#146ş0c2IRşIreland00001CNorthDakota#021ş0c2DIşDickey000018Texas#079ş0c2COCşCochran000017Ohio#041ş0c2DLşDelaware000023NewMexico#013ş0c2DAşDo&ntilde;a Ana000018Nebraska#011ş0c2BOşBoone00001AWyoming#033ş0c2SHşSheridan000024Europewithcountries#015ş0c2GRşGreece000018Malaysia#001ş0c2JOşJohor000019Tennessee#101ş0c2LEşLewis00001EScotland#018ş0c2LAşLanarkshire000017NewWorld#191ş0c2IZşIraq000018Oklahoma#053ş0c2GNşGrant000014Iowa#105ş0c2JNşJones00001DAlaska#270ş0c2WHşWade Hampton000017Texas#441ş0c2TAYşTaylor000025NewCaledonia#NC.NO.PTş0c2PTşPouembout000019Ontario#48ş0c2WAşWaterloo000019Montenegro#19ş0c2TIşTivat000019MiddleEast#14ş0c2SYşSyria000019Switzerland#26ş0c2JUşJura000023SouthEuropeanRegion#12ş0c2CSşSerbia000019NewWorld#39ş0c2DZşAlgeria00003AQuebec#11ş0c2GAşGasp&eacute;sie-&Icirc;les-de-la-Madeleine000014Kenya#02ş0c2COşCoast00001BPuertoRico#57ş0c2GMşGuayama00001ABahamas#15ş0c2HTşHope Town000017Japan#45ş0c2YAşYamagata000024NorwayRegion#13ş0c2OTş&Oslash;stfold000026PolandCounties#PL.DS.LMş0c2DLMşLegnica000027MarshallIsland#MH.MH.KWş0c2KWşKwajalein000021Macedonia#MK.SUş0c2SUşStudenicani00001FHongKong#HK.KIş0c2KIşKwai Tsing000019Palau#PW.PEş0c2PEşPeleliu000018Uganda#UG.BWş0c2BWşBukwa00001CVietnam#VN.HYş0c2HYşHung Yen00001EGambia#GM.URş0c2URşUpper River000034Nigeria#NG.FCş0c2FCşAbuja(Federal Capital Territory)00001BSenegal#SN.KLş0c2KLşKaolack000025Morocco#MA.COş0c2COşChaouia Ouardigha00001DBurma#MM.KNş0c2KNşKayin State00001CMissouri#189ş0c2SOşSt. Louis000024Ireland#018ş0c2MOşMuineach&aacute;in000020NorthAmerica#020ş0c2LCşSt. Lucia00001DCalifornia#093ş0c2SYşSiskiyou000025Alaska#090ş0c2FAşFairbanks North Star000017Texas#261ş0c2KEDşKenedy00001DLouisiana#005ş0c2ASşAscension000018Georgia#069ş0c2CFşCoffee000022WorldwithCountries#147ş0c2ITşItaly000018Minnesota#121ş0c2POşPope00001AKentucky#105ş0c2HKşHickman000019Michigan#115ş0c2MRşMonroe00001AFlorida#033ş0c2ESşEscambia00001DMississippi#015ş0c2CRşCarroll000025Europewithcountries#016ş0c2HUşHungary000018Malaysia#002ş0c2KEşKedah000019Arkansas#005ş0c2BAşBaxter00001EEngland#001ş0c2BEşBedfordshire00001FWestVirginia#033ş0c2HIşHarrison00001DScotland#019ş0c2MIşMidlothian000019NewWorld#192ş0c2IEşIsrael00001BAsia3#034ş0c2PHşPhilippines000018Virginia#181ş0c2SRşSurry00001AColorado#013ş0c2BOşBoulder00001BSouthDakota#051ş0c2GRşGrant00001AAlabama#029ş0c2CBşCleburne00001ENorwayRegion#14ş0c2ROşRogaland00001BAustralia#VIş0c2VIşVictoria00001BOntario#49ş0c2WEşWellington00001AMontenegro#20ş0c2ULşUlcinj00001EMiddleEast#15ş0c2TIşTajikistan000022SouthEuropeanRegion#13ş0c2ESşSpain000018NewWorld#40ş0c2AOşAngola00002BQuebec#12ş0c2CAşChaudi&egrave;re-Appalaches000016Kenya#03ş0c2EAşEastern000017Bahamas#16ş0c2INşInagua000018Japan#46ş0c2YMşYamaguchi00001DFiji#FJ.EA.LMş0c2LMşLomaiviti000027PolandCounties#PL.PK.PMş0c2PPMşPrzemysl00001CMacedonia#MK.TLş0c2TLşBitola00001ARwanda#RW.ESş0c2ESşEastern00001AUganda#UG.TYş0c2TYşMityana00001BMacedonia#MK.CAş0c2CAşCaska000026EquatorialGuinea#GQ.BSş0c2BSşBioko Sur000015Iran#IR.ILş0c2ILşIlam000021FranceDepartment#FR.EUş0c2EUşEure000021FranceDepartment#FR.GAş0c2GAşGard000023Mauritius#MU.PAş0c2PAşPamplemousses000019Nigeria#NG.ENş0c2ENşEnugu000022Algeria#DZ.ATş0c2ATşAin Temouchent00001AAlgeria#DZ.BJş0c2BJşBejaia000018Texas#443ş0c2TERşTerrell000019Indiana#059ş0c2HNşHancock000017NewYork#031ş0c2ESşEssex00001FNorthCarolina#099ş0c2JAşJackson00001BVirginia#001ş0c2ACşAccomack000019Georgia#251ş0c2SRşScreven000023Ireland#019ş0c2OFşUa F&aacute;ilghe000037NorthAmerica#021ş0c2VCşSt. Vincent &amp; the Grenadines00001AKansas#053ş0c2EWşEllsworth000024SouthCarolina#025ş0c2CTşChesterfield000017Illinois#089ş0c2KAşKane000018Missouri#009ş0c2BYşBarry000023WorldwithCountries#148ş0c2LVşLatvia00001CNorthDakota#023ş0c2DVşDivide000015Texas#081ş0c2COKşCoke000013Ohio#043ş0c2ERşErie000019Spain#001ş0c2ANşAndalucia000018NewMexico#015ş0c2EDşEddy00001CNebraska#013ş0c2BXşBox Butte00001AWyoming#035ş0c2SUşSublette000025Europewithcountries#017ş0c2ISşIceland00001BMalaysia#003ş0c2KLşKelantan00001BEngland#002ş0c2BRşBerkshire00001BTennessee#103ş0c2LIşLincoln000018Scotland#020ş0c2MOşMoray000019NewWorld#193ş0c2JOşJordan000018Oklahoma#055ş0c2GEşGreer000015Iowa#107ş0c2KEşKeokuk00001DColorado#014ş0c2BRşBroomfield000026NorwayRegion#15ş0c2SOşSogn og Fjordane000015Ontario#50ş0c2YOşYork000020Montenegro#21ş0c2ZAş&#381;abljak00001AMiddleEast#16ş0c2TUşTurkey000023SouthEuropeanRegion#14ş0c2TKşTurkey000026USACentralRegion#46ş0c2SDşSouth Dakota000017NewWorld#41ş0c2BJşBenin000015Quebec#13ş0c2LVşLaval00001EPuertoRico#59ş0c2GLşGuayanilla00001CBahamas#17ş0c2LIşLong Island000018Japan#47ş0c2YNşYamanashi000023MarshallIsland#MH.MH.MEş0c2MEşMejit000026Philippines#PH.SKş0c2SKşSultan Kudarat00001FCoteDivoire#CI.SVş0c2SVşSavanes000020Macedonia#MK.AVş0c2AVşKavadartsi00001ARussia#RU.IVş0c2IVşIvanovo000025Russia#RU.KBş0c2KBşKabardino-Balkaria00001AEurope2#EU.PLş0c2PLşPoland00001BQatar#QA.DAş0c2DAşAd Dawhah00001BAlgeria#DZ.TLş0c2TLşTlemcen000019Panama#PA.PNş0c2PNşPanama000022Uzbekistan#UZ.QAş0c2QAşKashkadarya000018Alabama#031ş0c2CFşCoffee000019Vermont#001ş0c2ADşAddison000022Ireland#020ş0c2ROşRos Com&aacute;n00002CNorthAmerica#022ş0c2TTşTrinidad &amp; Tobago00001BCalifornia#095ş0c2SOşSolano000015Texas#263ş0c2KETşKent00001ELouisiana#007ş0c2AUşAssumption00001AGeorgia#071ş0c2CQşColquitt00002AWorldwithCountries#149ş0c2LNşLiechtenstein00001AMinnesota#123ş0c2RMşRamsey00001AKentucky#107ş0c2HOşHopkins00001BMichigan#117ş0c2MNşMontcalm000019Florida#035ş0c2FLşFlagler000016Spain#002ş0c2ARşAragon00001FMississippi#017ş0c2CHşChickasaw000025Europewithcountries#018ş0c2IEşIreland000019Malaysia#004ş0c2MEşMelaka000019Arkansas#007ş0c2BEşBenton000021England#003ş0c2BUşBuckinghamshire00001EWestVirginia#035ş0c2JAşJackson00001DScotland#021ş0c2NAşNairnshire000019NewWorld#194ş0c2KUşKuwait000022Asia3#036ş0c2RUşRussian Federation000019Virginia#183ş0c2SSşSussex00001AColorado#015ş0c2CHşChaffee00001DSouthDakota#053ş0c2GEşGregory00001CWorld#NAş0c2NAşNorth America000031NorwayRegion#16ş0c2STşS&oslash;r-Tr&oslash;ndelag000024Australia#WAş0c2WAşWestern Australia000020MiddleEast#17ş0c2TXşTurkmenistan000023SouthEuropeanRegion#15ş0c2CYşCyprus00001ANewWorld#42ş0c2BWşBotswana000021Quebec#14ş0c2LAşLanaudi&egrave;re000016Kenya#05ş0c2NAşNairobi00001DBahamas#18ş0c2MCşMangrove Cay000019Jordan#JO.JAş0c2JAşJarash000029CentralAfricanRepublic#CF.MBş0c2MBşMbomou000026Philippines#PH.SLş0c2SLşSouthern Leyte00001DMongolia#MN.OGş0c2OGşOmnogovi00001DPhilippines#PH.AKş0c2AKşAklan00001EPhilippines#PH.BAş0c2BAşBataan000026Russia#RU.KCş0c2KCşKarachay-Cherkessia000024Libya#LY.HZş0c2HZşAl Hizam al Akhdar000020Algeria#DZ.TMş0c2TMşTamanghasset000019Algeria#DZ.BLş0c2BLşBlida000016Texas#445ş0c2TEYşTerry00001AIndiana#061ş0c2HRşHarrison00001ANewYork#033ş0c2FRşFranklin000020NorthCarolina#101ş0c2JOşJohnston00001CVirginia#003ş0c2ALşAlbemarle00001AGeorgia#253ş0c2SMşSeminole00001AIreland#021ş0c2SLşSligeach000024NorthAmerica#023ş0c2USşUnited States000017Kansas#055ş0c2FIşFinney000021SouthCarolina#027ş0c2CDşClarendon00001BIllinois#091ş0c2KNşKankakee000019Missouri#011ş0c2BRşBarton000026WorldwithCountries#150ş0c2LTşLithuania00001ANorthDakota#025ş0c2DNşDunn000018Texas#083ş0c2COLşColeman000018Ohio#045ş0c2FAşFairfield000018Spain#003ş0c2ASşAsturias000019NewMexico#017ş0c2GRşGrant000017Nebraska#015ş0c2BYşBoyd00001CWyoming#037ş0c2SWşSweetwater000023Europewithcountries#019ş0c2ITşItaly000022Malaysia#005ş0c2NSşNegeri Sembilan000020England#004ş0c2CAşCambridgeshire00001ATennessee#105ş0c2LOşLoudon000019Scotland#022ş0c2ORşOrkney00001ANewWorld#195ş0c2LBşLebanon000019Oklahoma#057ş0c2HAşHarmon000016Iowa#109ş0c2KOşKossuth00001ENorwayRegion#17ş0c2TEşTelemark000020Moldova#46ş0c2BAşB&#259;l&#355;i000026MiddleEast#18ş0c2AEşUnitedArabEmirates000029SouthEuropeanRegion#16ş0c2VAşVatican City00001FUSACentralRegion#48ş0c2TXşTexas00001ENewWorld#43ş0c2BFşBurkina Faso00001BQuebec#15ş0c2LUşLaurentides00001CKenya#06ş0c2NEşNorth Eastern00001CPuertoRico#61ş0c2GBşGuaynabo00001ABahamas#19ş0c2MGşMayaguana000022Macau#MO.MA.SAş0c2SAşSanto Antonio000019Fiji#FJ.CE.SRş0c2SRşSerua00001AMacau#MO.IL.CTş0c2CTşCotai000019Ghana#GH.AHş0c2AHşAshanti00001DPhilippines#PH.SMş0c2SMşSamar000020Mongolia#MN.OHş0c2OHşOvorkhangai00001EMacedonia#MK.BNş0c2BNşBrvenica00001DPhilippines#PH.ALş0c2ALşAlbay00001CRussia#RU.KDş0c2KDşKrasnodar00001CMicronesia#FM.CHş0c2CHşChuuk000019Guinea#GN.KAş0c2KAşKankan000017Benin#BJ.DOş0c2DOşDonga00001BAlgeria#DZ.TNş0c2TNşTindouf00001DAlgeria#DZ.BMş0c2BMşBoumerdes00001CSouthDakota#055ş0c2HAşHaakon000019Alabama#033ş0c2CRşColbert00001CVermont#003ş0c2BEşBennington000021Ireland#022ş0c2TIşTiobraid Arainn000020NorthAmerica#024ş0c2GLşGreenland00001BCalifornia#097ş0c2SMşSonoma000015Texas#265ş0c2KERşKerr00001DLouisiana#009ş0c2AVşAvoyelles00001AGeorgia#073ş0c2CUşColumbia000027WorldwithCountries#151ş0c2LUşLuxembourg00001CMinnesota#125ş0c2RLşRed Lake00001AKentucky#109ş0c2JAşJackson00001EMichigan#119ş0c2MOşMontmorency00001AFlorida#037ş0c2FRşFranklin00002BSpain#004ş0c2BAşBaleares (Balearic Islands)00001DMississippi#019ş0c2COşChoctaw000024Europewithcountries#020ş0c2LVşLatvia000019Malaysia#006ş0c2PAşPahang000018Arkansas#009ş0c2BOşBoone00001AEngland#005ş0c2CHşCheshire000020WestVirginia#037ş0c2JEşJefferson00001FScotland#023ş0c2PBşPeeblesshire000017NewWorld#196ş0c2MUşOman000019Asia3#038ş0c2SGşSingapore00001BVirginia#185ş0c2TAşTazewell00001BColorado#017ş0c2CEşCheyenne000020NewCaledonia#NC.NO.PYş0c2PYşPoya00001BNorwayRegion#18ş0c2TRşTroms000016Moldova#47ş0c2CAşCahul00001EMiddleEast#19ş0c2UZşUzbekistan000022USASouthWestRegion#15ş0c2HIşHawaii000019NewWorld#44ş0c2BIşBurundi000028Quebec#16ş0c2MOşMont&eacute;r&eacute;gie000015Kenya#07ş0c2NYşNyanza00001FBahamas#20ş0c2MIşMoore's Island00001FLiberia#LR.GBş0c2GBşGrand Bassa00001CMacedonia#MK.CEş0c2CEşCentar00001BRussia#RU.KEş0c2KEşKemerovo000019Guinea#GN.KBş0c2KBşKoubia00001FCameroon#CM.NWş0c2NWşNord-Ouest000021Lebanon#LE.JLş0c2JLşMount Lebanon000021FranceDepartment#FR.GEş0c2GEşGers000024Cambodia#KH.OCş0c2OCşOddar Meancheay00001EAlgeria#DZ.TOş0c2TOşTizi Ouzou000016Tonga#TO.EUş0c2EUş'Eua000026Kazakhstan#KZ.WKş0c2WKşWest Kazakhstan000019Senegal#SN.LGş0c2LGşLouga00001DTexas#447ş0c2THRşThrockmorton00001BIndiana#063ş0c2HDşHendricks000018NewYork#035ş0c2FUşFulton00001DNorthCarolina#103ş0c2JNşJones00001CVirginia#005ş0c2AEşAlleghany00001AGeorgia#255ş0c2SPşSpalding00001DIreland#023ş0c2WAşPort Lairge000022NorthAmerica#025ş0c2PRşPuerto Rico000015Kansas#057ş0c2FOşFord000020SouthCarolina#029ş0c2CLşColleton00001AIllinois#093ş0c2KDşKendall000018Missouri#013ş0c2BAşBates000026WorldwithCountries#152ş0c2MKşMacedonia00001ANorthDakota#027ş0c2EDşEddy000017Texas#085ş0c2CONşCollin000016Ohio#047ş0c2FYşFayette000015Spain#005ş0c2CEşCeuta00001DNewMexico#019ş0c2GUşGuadalupe000018Nebraska#017ş0c2BRşBrown000017Wyoming#039ş0c2TEşTeton00002BEuropewithcountries#021ş0c2LIşLiechtenstein000018Malaysia#007ş0c2PEşPerak00001AEngland#006ş0c2COşCornwall00001ATennessee#107ş0c2MCşMcMinn00001DScotland#024ş0c2PEşPerthshire000018NewWorld#197ş0c2OMşQatar000019Oklahoma#059ş0c2HRşHarper000012Iowa#111ş0c2LEşLee000019Asia3#039ş0c2LKşSri Lanka000019Wisconsin#001ş0c2ADşAdams000020NorwayRegion#19ş0c2VAşVest-Agder000023Moldova#48ş0c2CUşChi&#351;in&#259;u000019MiddleEast#20ş0c2YMşYemen00001ANewWorld#45ş0c2CMşCameroon000027Quebec#17ş0c2CQşCentre-du-Qu&eacute;bec00001AKenya#08ş0c2RVşRift Valley00001APuertoRico#63ş0c2GRşGurabo00001FBahamas#21ş0c2NWşNew Providence000021Macau#MO.MA.SCş0c2SCşSao Lourenco000022MarshallIsland#MH.MH.MIş0c2MIşMili00001CMacedonia#MK.UGş0c2UGşStruga00001CSudan#SD.UNş0c2UNşUpper Nile000026Kazakhstan#KZ.EKş0c2EKşEast Kazakhstan000028Philippines#PH.ANş0c2ANşAgusan del Norte000026Libya#LY.JIş0c2JIşAl Jifarah(Al Jfara)00001CBotswana#BW.KWş0c2KWşKweneng000019China2#CN.HAş0c2HAşHainan000016Nauru#NR.IJş0c2IJşIjuw00001AAlgeria#DZ.TPş0c2TPşTipaza00001CSouthDakota#057ş0c2HMşHamlin000019Alabama#035ş0c2CNşConecuh000020Australia2#QLDş0c2QLDşQueensland00001BVermont#005ş0c2CAşCaledonia000019Missouri#195ş0c2SAşSaline00001FIreland#024ş0c2WEşIarmh&iacute;000025NorthAmerica#026ş0c2KYşCayman Islands00001FCalifornia#099ş0c2SLşStanislaus000017Texas#267ş0c2KIMşKimble00001ELouisiana#011ş0c2BEşBeauregard000024Virginia#730ş0c2PBşPetersburg (City)000016Georgia#075ş0c2COşCook000022WorldwithCountries#153ş0c2MTşMalta00001BMinnesota#127ş0c2RWşRedwood00001CKentucky#111ş0c2JEşJefferson00001BMichigan#121ş0c2MUşMuskegon000019Florida#039ş0c2GAşGadsden000029Spain#006ş0c2CAşCanarias (Canary Islands)00001FMississippi#021ş0c2CLşClaiborne000027Europewithcountries#022ş0c2LTşLithuania000019Malaysia#008ş0c2PRşPerlis00001AArkansas#011ş0c2BRşBradley000019England#007ş0c2CUşCumbria00001EWestVirginia#039ş0c2KAşKanawha00001FScotland#025ş0c2REşRenfrewshire00001FNewWorld#198ş0c2SAşSaudi Arabia000019Virginia#187ş0c2WAşWarren00001EColorado#019ş0c2CLşClear Creek00001ENorwayRegion#20ş0c2VEşVestfold000027Moldova#49ş0c2SNşSt&acirc;nga Nistrului00001CNewWorld#46ş0c2CVşCape Verde000016Kenya#09ş0c2WEşWestern00001CBahamas#22ş0c2NBşNorth Abaco000025PolandCounties#PL.LU.LMş0c2LLMşLublin000024MarshallIsland#MH.MH.MJş0c2MJşMajuro00001FLiberia#LR.GDş0c2GDşGrand Gedeh00001DGhana#GH.BAş0c2BAşBrong-Ahafo000027Mauritania#MR.HCş0c2HCşHodh Ech Chargui00001CMacedonia#MK.TRş0c2TRşTearce00001AUganda#UG.UUş0c2UUşKanungu000019Uganda#UG.WAş0c2WAşWakiso000019Malawi#MW.SAş0c2SAşSalima000019Russia#RU.KGş0c2KGşKaluga000019Guinea#GN.KDş0c2KDşKindia000018China2#CN.HBş0c2HBşHebei00001AGambia#GM.WEş0c2WEşWestern000022Bhutan#BT.WPş0c2WPşWangdi Phodrang00001BWisconsin#003ş0c2ASşAshland000016Texas#449ş0c2TITşTitus000017Indiana#065ş0c2HYşHenry000019NewYork#037ş0c2GEşGenesee00001BNorthCarolina#105ş0c2LEşLee000021Maryland#510ş0c2BAşBaltimore City000019Virginia#007ş0c2AMşAmelia00001AGeorgia#257ş0c2SEşStephens00001DIreland#025ş0c2WXşLoch Garman000019Kansas#059ş0c2FRşFranklin000022SouthCarolina#031ş0c2DAşDarlington000017Illinois#095ş0c2KOşKnox000019Missouri#015ş0c2BTşBenton000024WorldwithCountries#154ş0c2MVşMoldova00001CNorthDakota#029ş0c2EMşEmmons00001ETexas#087ş0c2CSWşCollingsworth000024Virginia#550ş0c2CPşChesapeake (City)000017Ohio#049ş0c2FRşFranklin000019Spain#007ş0c2CNşCantabria00001BNewMexico#021ş0c2HAşHarding00001ANebraska#019ş0c2BFşBuffalo000017Wyoming#041ş0c2UIşUinta000028Europewithcountries#023ş0c2LUşLuxembourg00001FMalaysia#009ş0c2PPşPulau Pinang00001CEngland#008ş0c2DEşDerbyshire00001BTennessee#109ş0c2MYşMcNairy000026Scotland#026ş0c2RCşRoss &amp; Cromarty000018NewWorld#199ş0c2SYşSyria00001AOklahoma#061ş0c2HSşHaskell000013Iowa#113ş0c2LIşLinn00001ENorwayRegion#21ş0c2SVşSvalbard00001CMoldova#50ş0c2EDşEdine&#355;00002ANewWorld#47ş0c2CPşCentral African Republic00001BPuertoRico#65ş0c2HAşHatillo00001DBahamas#23ş0c2NNşNorth Andros000017Macau#MO.MA.SEş0c2SEşSe00001BFiji#FJ.CE.TLş0c2TLşTailevu000020Philippines#PH.SQş0c2SQşSiquijor00001CMacedonia#MK.BRş0c2BRşBerovo000027Macedonia#MK.CHş0c2CHşCesinovo Oblesevo00001EPhilippines#PH.APş0c2APşApayao00001DRussia#RU.KHş0c2KHşKhabarovsk000019China2#CN.YNş0c2YNşYunnan000029Guinea#GN.KEş0c2KEşK&eacute;rouan&eacute;00001ETurkmenistan#TM.LEş0c2LEşLebap00001AAlgeria#DZ.TRş0c2TRşTiaret00001ANamibia#NA.ERş0c2ERşErongo00001AColorado#021ş0c2COşConejos00001ASouthDakota#059ş0c2HNşHand000017Alabama#037ş0c2CSşCoosa00001CVermont#007ş0c2CHşChittenden00001BMissouri#197ş0c2SYşSchuyler000026Ireland#026ş0c2WIşCill Mhant&aacute;in00001BCalifornia#101ş0c2SUşSutter000015Texas#269ş0c2KINşKing00001DLouisiana#013ş0c2BIşBienville000018Georgia#077ş0c2CWşCoweta000023WorldwithCountries#155ş0c2MCşMonaco00001CMinnesota#129ş0c2REşRenville00001CKentucky#113ş0c2JSşJessamine00001AMichigan#123ş0c2NEşNewaygo00001BFlorida#041ş0c2GIşGilchrist000022Spain#008ş0c2CLşCastilla-La Mancha00001CMississippi#023ş0c2CKşClarke000027Europewithcountries#024ş0c2MKşMacedonia000018Malaysia#010ş0c2SAşSabah00001AArkansas#013ş0c2CAşCalhoun000017England#009ş0c2DVşDevon000020SouthAmerica#001ş0c2ARşArgentina00001CWestVirginia#041ş0c2LEşLewis000020Scotland#027ş0c2ROşRoxburghshire000025NewWorld#200ş0c2AEşUnitedArabEmirates000018Asia3#042ş0c2THşThailand000013USA#HIş0c2HIşHawaii00001FNorwayRegion#22ş0c2JMşJan Mayen000023Moldova#51ş0c2GAşG&#259;g&#259;uzia000016NewWorld#48ş0c2TDşChad000020Bahamas#24ş0c2NEşNorth Eleuthera000017Fiji#FJ.EA.LUş0c2LUşLau000026MarshallIsland#MH.MH.MLş0c2MLşMaloelap000019Algeria#DZ.CHş0c2CHşChlef00001DMauritania#MR.GOş0c2GOşGorgol000020Philippines#PH.SRş0c2SRşSorsogon00001EMacedonia#MK.BSş0c2BSşBosilovo00001AMacedonia#MK.CIş0c2CIşCair00001FPhilippines#PH.AQş0c2AQşAntique00001FPhilippines#PH.BGş0c2BGşBenguet00001ARussia#RU.KIş0c2KIşKarelia00001BQatar#QA.USş0c2USşUmm Salal000024FranceDepartment#FR.GIş0c2GIşGironde00001EAlgeria#DZ.TSş0c2TSşTissemsilt00002ASaoTomeandPrincipe#ST.AGş0c2AGşAgua Grande00001AWisconsin#005ş0c2BAşBarron000024Alaska#280ş0c2WPşWrangell-Petersburg00001ATexas#451ş0c2TOGşTom Green000018Indiana#067ş0c2HOşHoward000018NewYork#039ş0c2GRşGreene00001ENorthCarolina#107ş0c2LNşLenoir00001AVirginia#009ş0c2AHşAmherst000019Georgia#259ş0c2STşStewart000022Ireland#027ş0c2NLşNorthern Ireland000016Kansas#061ş0c2GEşGeary00001ESouthCarolina#033ş0c2DIşDillon000017Illinois#097ş0c2LAşLake00001CMissouri#017ş0c2BNşBollinger000027WorldwithCountries#156ş0c2MGşMontenegro00001CNorthDakota#031ş0c2FOşFoster000019Texas#089ş0c2CORşColorado000015Ohio#051ş0c2FUşFulton00001FSpain#009ş0c2CYşCastilla y Leon00001BNewMexico#023ş0c2HIşHidalgo000017Nebraska#021ş0c2BUşBurt00001AWyoming#043ş0c2WAşWashakie000023Europewithcountries#025ş0c2MTşMalta00001AMalaysia#011ş0c2SRşSarawak000018England#010ş0c2DOşDorset000019Tennessee#111ş0c2MAşMacon00001ESouthAmerica#002ş0c2BOşBolivia00001FScotland#028ş0c2SEşSelkirkshire000018NewWorld#201ş0c2YMşYemen000019Oklahoma#063ş0c2HUşHughes000015Iowa#115ş0c2LOşLouisa000030MadagascarRegions#MG.FI.HMş0c2HMşHaute Matsiatra00001EBahamas#25ş0c2RIşRagged Island00001FGuatemala#01ş0c2AVşAlta Verapaz000022Moldova#52ş0c2LAşL&#259;pu&#351;na00001AVenezuela#01ş0c2ZşAmazonas000019NewWorld#49ş0c2KMşComoros00001FPuertoRico#67ş0c2HOşHormigueros00001AAlgeria#DZ.BSş0c2BSşBiskra000023Burma#MM.MDş0c2MDşMandalay Division000018Jordan#JO.IRş0c2IRşIrbid00001FMacedonia#MK.VAş0c2VAşValandovo000027Philippines#PH.SSş0c2SSşSurigao del Sur000017Niger#NE.DFş0c2DFşDiffa000019China2#CN.XZş0c2XZşXizang000025CoteDivoire#CI.BSş0c2BSşBas-Sassandra000018China2#CN.HEş0c2HEşHenan000022Madagascar#MG.ASş0c2ASşAntsiranana00001CEurope2#EU.PTş0c2PTşPortugal00001DVirginia#191ş0c2WSşWashington00001BColorado#023ş0c2CSşCostilla00001CSouthDakota#061ş0c2HSşHanson00001BAlabama#039ş0c2CVşCovington000017Vermont#009ş0c2ESşEssex00001BMissouri#199ş0c2SLşScotland00001BCalifornia#103ş0c2TEşTehama000017Alaska#100ş0c2HAşHaines000017Texas#271ş0c2KIEşKinney00001BLouisiana#015ş0c2BOşBossier00001AGeorgia#079ş0c2CDşCrawford000028WorldwithCountries#157ş0c2NLşNetherlands000018Minnesota#131ş0c2RIşRice00001AKentucky#115ş0c2JOşJohnson00001AMichigan#125ş0c2OKşOakland000018Florida#043ş0c2GLşGlades000019Spain#010ş0c2CTşCatalonia00001AMississippi#025ş0c2CYşClay000025Europewithcountries#026ş0c2MDşMoldova00001BMalaysia#012ş0c2SLşSelangor00001AArkansas#015ş0c2CRşCarroll000018England#011ş0c2DUşDurham00001DSouthAmerica#003ş0c2BRşBrazil00001EWestVirginia#043ş0c2LIşLincoln00001BScotland#029ş0c2SHşShetland00001ENewWorld#202ş0c2PRşPuerto Rico000018Bahamas#26ş0c2RCşRum Cay000011USA#IAş0c2IAşIowa00001FGuatemala#02ş0c2BVşBaja Verapaz000016Moldova#53ş0c2ORşOrhei000020Mozambique#01ş0c2CDşCabo Delgado000023Venezuela#02ş0c2BşAnzo&aacute;tegui000023USACentralRegion#55ş0c2WIşWisconsin000018Portugal#02ş0c2AVşAveiro00001FNewWorld#50ş0c2CIşCote d Ivoire000019Algeria#DZ.BTş0c2BTşBatna000025Mauritania#MR.HGş0c2HGşHodh El Gharbi000029Philippines#PH.STş0c2STşSurigao del Norte00001EEastTimor#TL.MTş0c2MTşManatuto00001BMacedonia#MK.BUş0c2BUşButel00001EMacedonia#MK.DAş0c2DAşDebartsa000026Philippines#PH.ASş0c2ASşAgusan del Sur00001FPhilippines#PH.BIş0c2BIşBiliran00001CRussia#RU.KKş0c2KKşKhakassia000027EquatorialGuinea#GQ.CSş0c2CSşCentro Sur00001BQatar#QA.WAş0c2WAşAl Wakrah00002BIran#IR.KBş0c2KBşKohgiluyeh and Buyer Ahmed000029FranceDepartment#FR.HAş0c2HAşHautes Alpes00002AFalklandIsland#NA.FKş0c2FKşFalkland Island00001ACapeVerde#CV.PAş0c2PAşPaul00002ABrazilRegion#BR.NEş0c2NEşNorth East Region000014Iowa#117ş0c2LUşLucas00001CWisconsin#007ş0c2BYşBayfield000018Alaska#282ş0c2YAşYakutat000017Texas#453ş0c2TRAşTravis00001CIndiana#069ş0c2HUşHuntington00001ANewYork#041ş0c2HAşHamilton00001FNorthCarolina#109ş0c2LIşLincoln00001DVirginia#011ş0c2APşAppomattox000018Georgia#261ş0c2SUşSumter000015Kansas#063ş0c2GOşGove000022SouthCarolina#035ş0c2DOşDorchester000022Virginia#735ş0c2PQşPoquoson (City)00001BIllinois#099ş0c2LSşLa Salle000018Missouri#019ş0c2BOşBoone000023WorldwithCountries#158ş0c2NOşNorway000023NorthDakota#033ş0c2GVşGolden Valley000016Texas#091ş0c2COMşComal000015Ohio#053ş0c2GAşGallia000024Spain#011ş0c2CVşCommunidad Valencian000017NewMexico#025ş0c2LEşLea000019Nebraska#023ş0c2BLşButler000018Wyoming#045ş0c2WEşWeston000024Europewithcountries#027ş0c2MCşMonaco00001DMalaysia#013ş0c2TEşTerengganu000017England#012ş0c2ESşEssex00001BTennessee#113ş0c2MDşMadison00001CSouthAmerica#004ş0c2CLşChile000020Scotland#030ş0c2STşStirlingshire000021NewWorld#203ş0c2KYşCayman Islands00001AOklahoma#065ş0c2JAşJackson000029MadagascarRegions#MG.FI.HOş0c2HOşIhorombe000014World8#01ş0c2ASşAsia00001DBahamas#27ş0c2SSşSan Salvador000020Guatemala#03ş0c2CMşChimaltenango000017Moldova#54ş0c2SOşSoroca000018Mozambique#02ş0c2GAşGaza000017Venezuela#03ş0c2CşApure000020Chile#01ş0c2VSşValpara&iacute;so000016Portugal#03ş0c2BEşBeja000032NewWorld#51ş0c2CDşDemocratic Republic of the Congo00001BPuertoRico#69ş0c2HUşHumacao00001AAlgeria#DZ.BUş0c2BUşBouira00001EMacedonia#MK.UMş0c2UMşKumanovo000020Macedonia#MK.VCş0c2VCşVranestica00001CPhilippines#PH.SUş0c2SUşSulu000020Tanzania#TZ.PNş0c2PNşPemba North00001EHongKong#HK.KUş0c2KUşKwun Tong000029CoteDivoire#CI.VBş0c2VBşVallee du Bandama00001ALaos#LA.PHş0c2PHşPhongsali00001BMacedonia#MK.DBş0c2DBşDebar00001BRussia#RU.KLş0c2KLşKalmykia000019Uganda#UG.DOş0c2DOşDokolo00001EMadagascar#MG.TLş0c2TLşToliara00001EVietnam#VN.KGş0c2KGşKien Giang000020Mauritius#MU.PLş0c2PLşPort Louis00001FVirginia#193ş0c2WEşWestmoreland00001AColorado#025ş0c2CRşCrowley00001DSouthDakota#063ş0c2HDşHarding00001AAlabama#041ş0c2CWşCrenshaw00001AVermont#011ş0c2FRşFranklin000018Missouri#201ş0c2SCşScott00001CCalifornia#105ş0c2TRşTrinity000018Texas#273ş0c2KLEşKleberg000019Louisiana#017ş0c2CAşCaddo000017Georgia#081ş0c2CPşCrisp000023WorldwithCountries#159ş0c2PLşPoland000018Minnesota#133ş0c2RCşRock000019Kentucky#117ş0c2KEşKenton000019Michigan#127ş0c2OAşOceana000016Florida#045ş0c2GUşGulf00001BSpain#012ş0c2EXşExtremadura00001DMississippi#027ş0c2CMşCoahoma000028Europewithcountries#028ş0c2MOşMontenegro000019Arkansas#017ş0c2CHşChicot000021England#013ş0c2GLşGloucestershire00001FSouthAmerica#005ş0c2COşColombia00001CWestVirginia#045ş0c2LOşLogan00001DScotland#031ş0c2SUşSutherland000016World8#02ş0c2EUşEurope00001CBahamas#28ş0c2SBşSouth Abaco00001DGuatemala#04ş0c2CQşChiquimula000018Moldova#55ş0c2TIşTighina00001DMozambique#03ş0c2INşInhambane000018Venezuela#04ş0c2DşAragua000045Chile#02ş0c2AIşAis&eacute;n del General Carlos Iba&ntilde;ezdel Campo000017Portugal#04ş0c2BRşBraga00001ANewWorld#52ş0c2DJşDjibouti000021Burma#MM.MGş0c2MGşMagway Division000018Jordan#JO.KAş0c2KAşKarak000021Macedonia#MK.VDş0c2VDşKisela Voda000017Bhutan#BT.GAş0c2GAşGasa000025CentralAmerica2#CE.GTş0c2GTşGuatemala00001EPhilippines#PH.AUş0c2AUşAurora000020Philippines#PH.BKş0c2BKşBukidnon000021Russia#RU.KMş0c2KMşKhantia-Mansia000020Madagascar#MG.TMş0c2TMşToamasina00001BLibya#LY.KFş0c2KFşAl Kufrah00001ACameroon#CM.OUş0c2OUşOuest00001AIran#IR.KDş0c2KDşKordestan000028FranceDepartment#FR.HCş0c2HCşHaute Corse00001DVietnam#VN.KHş0c2KHşKhanh Hoa00001CSyria#SY.HAş0c2HAşAl Hasakah000023Madagascar#MG.AVş0c2AVşAntananarivo000039DemocraticRepublicoftheCongo#CD.KCş0c2KCşKasai Occidental00001DKyrgyzstan#KG.BAş0c2BAşBatken00001COklahoma#067ş0c2JEşJefferson000013Iowa#119ş0c2LYşLyon000017Asia3#047ş0c2VNşVietnam000019Wisconsin#009ş0c2BRşBrown000018Texas#455ş0c2TRIşTrinity000019Indiana#071ş0c2JAşJackson00001ANewYork#043ş0c2HEşHerkimer000020NorthCarolina#111ş0c2MDşMcDowell00001CVirginia#013ş0c2ARşArlington000018Georgia#263ş0c2TBşTalbot000017Kansas#065ş0c2GHşGraham000021SouthCarolina#037ş0c2EDşEdgefield00001BIllinois#101ş0c2LWşLawrence00001BMissouri#021ş0c2BCşBuchanan000025WorldwithCountries#160ş0c2PTşPortugal000021NorthDakota#035ş0c2GFşGrand Forks000019Texas#093ş0c2COAşComanche000015Ohio#055ş0c2GEşGeauga000017Spain#013ş0c2GAşGalicia00001BNewMexico#027ş0c2LIşLincoln000017Nebraska#025ş0c2CAşCass000029Europewithcountries#029ş0c2NLşNetherlands00001FMalaysia#015ş0c2KLşKuala Lumpur00001BEngland#014ş0c2HAşHampshire00001ATennessee#115ş0c2MRşMarion00001ESouthAmerica#006ş0c2ECşEcuador00001FScotland#032ş0c2WEşWest Lothian000016World8#03ş0c2AFşAfrica00001DBahamas#29ş0c2SNşSouth Andros00002FWorldwithCountries#01ş0c2AGşAntigua and Barbuda000012USA#IDş0c2IDşIdaho00001EGuatemala#05ş0c2PRşEl Progreso000018Moldova#56ş0c2UNşUngheni00001AMozambique#04ş0c2MPşMaputo000019Venezuela#05ş0c2EşBarinas00001AChile#03ş0c2ANşAntofagasta000021Portugal#05ş0c2BAşBragan&ccedil;a000017NewWorld#53ş0c2EGşEgypt000023Australia2#SAş0c2SAşSouth Australia00001FBarbados#01ş0c2CCşChrist Church00001BPuertoRico#71ş0c2ISşIsabela000028PolandCounties#PL.MZ.OMş0c2MOMşOstroleka00001DLiberia#LR.GKş0c2GKşGrand Kru00001BMacedonia#MK.VEş0c2VEşVeles000025Sudan#SD.WBş0c2WBşWest Bahr Al Ghazal00001BYemen#YE.MRş0c2MRşAl Mahrah00001CPhilippines#PH.CBş0c2CBşCebu00001EGabon#GA.MOş0c2MOşMoyen-Ogooue00001ERussia#RU.KNş0c2KNşKaliningrad00001BChina2#CN.ZJş0c2ZJşZhejiang000022FranceDepartment#FR.YOş0c2YOşYonne00001EGuinea#GN.LAş0c2LAşLab&eacute;000018China2#CN.GSş0c2GSşGansu000017Iran#IR.KEş0c2KEşKerman00002BFranceDepartment#FR.HDş0c2HDşHauts-de-Seine00001EPakistan#PK.ISş0c2ISşIslamabad00001DTurkmenistan#TM.MAş0c2MAşMary00001FEurope2#EU.RDş0c2RDşRhodes (Gr)000017Virginia#195ş0c2WIşWise000019Colorado#027ş0c2CUşCuster00001CSouthDakota#065ş0c2HGşHughes000019Alabama#043ş0c2CUşCullman00001CVermont#013ş0c2GIşGrand Isle00001AMissouri#203ş0c2SNşShannon00001BCalifornia#107ş0c2TUşTulare000015Texas#275ş0c2KNOşKnox00001DLouisiana#019ş0c2CLşCalcasieu000016Georgia#083ş0c2DAşDade000024WorldwithCountries#161ş0c2ROşRomania00001AMinnesota#135ş0c2ROşRoseau000018Kentucky#119ş0c2KNşKnott000019Michigan#129ş0c2OGşOgemaw00001AFlorida#047ş0c2HTşHamilton000018Spain#014ş0c2LAşLa Rioja00001ENewMexico#028ş0c2LAşLos Alamos00001CMississippi#029ş0c2CPşCopiah000024Europewithcountries#030ş0c2NOşNorway000019Malaysia#016ş0c2LAşLabuan000018Arkansas#019ş0c2CLşClark00001FEngland#015ş0c2HEşHerefordshire000027SouthAmerica#007ş0c2FKşFalkland Islands00001FWestVirginia#047ş0c2MDşMcDowell00001EScotland#033ş0c2WIşWigtonshire00001DWorld8#04ş0c2NAşNorth America000020Bahamas#30ş0c2SEşSouth Eleuthera000023WorldwithCountries#02ş0c2BSşBahamas00001CGuatemala#06ş0c2ESşEscuintla00001AMozambique#05ş0c2SOşSofala000020Venezuela#06ş0c2FşBol&iacute;var00001FChile#04ş0c2ARşAraucan&iacute;a000020Portugal#06ş0c2CBşCastelo Branco000023NewWorld#54ş0c2GQşEquatorial Guinea00001EBarbados#02ş0c2ANşSaint Andrew000017Fiji#FJ.NO.BUş0c2BUşBua00001EFiji#FJ.NO.CKş0c2CKşCakaudrova000019Laos#LA.OUş0c2OUşOudomxai00001DMacedonia#MK.DEş0c2DEşDolneni000017Sudan#SD.EBş0c2EBşLakes000019Serbia#RS.MRş0c2MRşMorava000017Russia#RU.KOş0c2KOşKomi000024FranceDepartment#FR.HEş0c2HEşHerault000025Cambodia#KH.OMş0c2OMşBanteay Meanchey000019Tonga#TO.HAş0c2HAşHa'apai00001BOklahoma#069ş0c2JOşJohnston000016Iowa#121ş0c2MAşMadison000016Asia3#049ş0c2TWşTaiwan00001BWisconsin#011ş0c2BUşBuffalo000016Texas#457ş0c2TYLşTyler000018Indiana#073ş0c2JSşJasper00001BNewYork#045ş0c2JEşJefferson00001DNorthCarolina#113ş0c2MAşMacon00001AVirginia#015ş0c2AUşAugusta00001CGeorgia#265ş0c2TAşTaliaferro000016Kansas#067ş0c2GTşGrant000021SouthCarolina#039ş0c2FAşFairfield000016Illinois#103ş0c2LEşLee000019Missouri#023ş0c2BUşButler000027WorldwithCountries#162ş0c2SMşSan Marino00001BNorthDakota#037ş0c2GRşGrant000017Texas#095ş0c2CCHşConcho000015Ohio#057ş0c2GRşGreene000016Spain#015ş0c2MAşMadrid000018NewMexico#029ş0c2LUşLuna000018Nebraska#027ş0c2CEşCedar000017Hawaii#001ş0c2HAşHawaii000024Europewithcountries#031ş0c2PLşPoland00001CMalaysia#017ş0c2PUşPutrajaya00001FEngland#016ş0c2HRşHertfordshire00001CTennessee#117ş0c2MSşMarshall000024SouthAmerica#008ş0c2GFşFrench Guiana00001DWorld8#05ş0c2SAşSouth America00001EBahamas#31ş0c2SWşSpanish Wells000024WorldwithCountries#03ş0c2BBşBarbados00001CGuatemala#07ş0c2GUşGuatemala00001BMozambique#06ş0c2NAşNampula00001AVenezuela#07ş0c2GşCarabobo000016Chile#05ş0c2ATşAtacama000019Portugal#07ş0c2COşCoimbra000019NewWorld#55ş0c2ERşEritrea00001EBarbados#03ş0c2GEşSaint George00001APuertoRico#73ş0c2JYşJayuya000029NewBrunswick#CA.NB.FCş0c2FCşFundy Coastal00001FAlgeria#DZ.COş0c2COşConstantine00001DSudan#SD.WDş0c2WDşWest Darfur000019Gabon#GA.NGş0c2NGşNgounie000020CoteDivoire#CI.DEş0c2DEşDenguele00001BChina2#CN.HKş0c2HKşHongKong00001BVietnam#VN.LAş0c2LAşLong An000021Pakistan#PK.JKş0c2JKşAzad Kashmir000024TrinidadandTobago#TT.MAş0c2MAşMayaro000020SaudiArabia#SA.QSş0c2QSşAl Qasim000020SaudiArabia#SA.RIş0c2RIşAr Riyad000019Asia3#050ş0c2HKşHong Kong000018Virginia#197ş0c2WYşWythe000018Colorado#029ş0c2DEşDelta000020SouthDakota#067ş0c2HTşHutchinson000016Alabama#045ş0c2DAşDale00001AVermont#015ş0c2LAşLamoille000019Missouri#205ş0c2SHşShelby00001DCalifornia#109ş0c2TOşTuolumne000016Texas#277ş0c2LAMşLamar00001CLouisiana#021ş0c2CDşCaldwell000024Virginia#740ş0c2PMşPortsmouth (City)000018Georgia#085ş0c2DWşDawson000023WorldwithCountries#163ş0c2CSşSerbia00001DMinnesota#137ş0c2SLşSt. Louis000017Kentucky#121ş0c2KOşKnox00001CMichigan#131ş0c2ONşOntonagon000018Florida#049ş0c2HAşHardee000017Spain#016ş0c2MEşMelilla00001FMississippi#031ş0c2CGşCovington000026Europewithcountries#032ş0c2PTşPortugal000017Arkansas#021ş0c2CYşClay00001DSouthAmerica#009ş0c2GYşGuyana00001DWestVirginia#049ş0c2MAşMarion000022NewCaledonia#NC.SU.LFş0c2LFşLa Foa000028Saskatchewan#CA.SK.NRş0c2NRşNorth Region00001FWorld8#06ş0c2CAşCentral America000022Bahamas#32ş0c2WBşWest Grand Bahama000022WorldwithCountries#04ş0c2BZşBelize000020Guatemala#08ş0c2HUşHuehuetenango00001AMozambique#07ş0c2NIşNiassa000019Venezuela#08ş0c2HşCojedes000024Chile#06ş0c2BIşB&iacute;o-B&iacute;o00001EPortugal#08ş0c2EVş&Eacute;vora00001ANewWorld#56ş0c2ETşEthiopia00001DBarbados#04ş0c2JMşSaint James000025PolandCounties#PL.WP.KMş0c2WKMşKalisz000021Morocco#MA.FBş0c2FBşFes-Boulemane00001FMacedonia#MK.VHş0c2VHşVrapciste000020Sudan#SD.WEş0c2WEşWest Equatoria00001DBhutan#BT.GEş0c2GEşGeylegphug000031CentralAfricanRepublic#CF.MPş0c2MPşOmbella-M'Poko000024CentralAmerica2#CE.HNş0c2HNşHonduras000020Tanzania#TZ.PSş0c2PSşPemba South00001DPhilippines#PH.BOş0c2BOşBohol000019Malawi#MW.RUş0c2RUşRumphi00001CRussia#RU.KQş0c2KQşKamchatka00001BGuinea#GN.KNş0c2KNşKoundara000023Kuwait#KW.MUş0c2MUşMubarak Al Kabir00001FChina2#CN.HLş0c2HLşHeilongjiang00002AFranceDepartment#FR.HGş0c2HGşHaute Garonne00001BNigeria#NG.ZAş0c2ZAşZamfara000019Togo#TG.MAş0c2MAşMaritime000016Oklahoma#071ş0c2KAşKay000016Iowa#123ş0c2MHşMahaska000015Asia3#051ş0c2MOşMacau00001BWisconsin#013ş0c2BNşBurnett000017Texas#459ş0c2UPSşUpshur000015Indiana#075ş0c2JYşJay000017NewYork#047ş0c2KIşKings00001FNorthCarolina#115ş0c2MSşMadison000017Virginia#017ş0c2BAşBath00001AGeorgia#267ş0c2TTşTattnall000015Kansas#069ş0c2GYşGray000020SouthCarolina#041ş0c2FLşFlorence00001DIllinois#105ş0c2LIşLivingston00001BMissouri#025ş0c2CAşCaldwell000025WorldwithCountries#164ş0c2SKşSlovakia00001CNorthDakota#039ş0c2GNşGriggs000016Texas#097ş0c2CKEşCooke000027Virginia#560ş0c2CFşClifton Forge (City)000017Ohio#059ş0c2GUşGuernsey000016Spain#017ş0c2MUşMurcia00001CNewMexico#031ş0c2MKşMcKinley000018Nebraska#029ş0c2CHşChase000019Hawaii#003ş0c2HOşHonolulu000025Europewithcountries#033ş0c2ROşRomania000016England#018ş0c2KEşKent000019Tennessee#119ş0c2MUşMaury00001FSouthAmerica#010ş0c2PYşParaguay000017World8#07ş0c2OCşOceania000022WorldwithCountries#05ş0c2CAşCanada000019Guatemala#09ş0c2IZşIzabal000018Mozambique#08ş0c2TEşTete00001FVenezuela#09ş0c2YşDelta Amacuro000017Chile#07ş0c2COşCoquimbo000016Portugal#09ş0c2FAşFaro000017NewWorld#57ş0c2GAşGabon00001DTurkey#02ş0c2ADşAd&#305;yaman00001CBarbados#05ş0c2JNşSaint John000025PuertoRico#75ş0c2JDşJuana D&iacute;az000025MarshallIsland#MH.MH.NKş0c2NKşNamorik000020Sudan#SD.EEş0c2EEşEast Equatoria00001CGuinea#GN.KOş0c2KOşKouroussa000021Guinea#GN.LEş0c2LEşL&eacute;louma00001BLibya#LY.JUş0c2JUşAl Jufrah000019Malawi#MW.BAş0c2BAşBalaka00001FBotswana#BW.NEş0c2NEşNorth East000027Singapore#SG.CSş0c2CSşCentral Singapore00001DBurkinaFaso#BF.YGş0c2YGşYagha000017Virginia#199ş0c2YOşYork000019Colorado#031ş0c2DNşDenver00001CMontana#001ş0c2BEşBeaverhead00001ASouthDakota#069ş0c2HYşHyde000018Alabama#047ş0c2DLşDallas000018Vermont#017ş0c2ORşOrange00001BMissouri#207ş0c2SDşStoddard00001CCalifornia#111ş0c2VEşVentura000015Texas#279ş0c2LABşLamb00001BLouisiana#023ş0c2CMşCameron000019Georgia#087ş0c2DEşDecatur000025WorldwithCountries#165ş0c2SIşSlovenia000019Minnesota#139ş0c2SCşScott000018Kentucky#123ş0c2LAşLarue00001AMichigan#133ş0c2OEşOsceola000018Florida#051ş0c2HEşHendry000017Spain#018ş0c2NAşNavarra00001CMississippi#033ş0c2DEşDeSoto000028Europewithcountries#034ş0c2SMşSan Marino00001BArkansas#023ş0c2CBşCleburne00001CEngland#019ş0c2LAşLancashire00001BSouthAmerica#011ş0c2PEşPeru00001FWestVirginia#051ş0c2MRşMarshall00001BWorld8#08ş0c2MEşMiddle East000026WorldwithCountries#06ş0c2CRşCosta Rica000019Guatemala#10ş0c2JAşJalapa000020Azerbaijan#01ş0c2ARşAb&#351;eron00001CMozambique#09ş0c2ZMşZambezia000018Chile#08ş0c2LIşO'Higgins000017NewWorld#58ş0c2GHşGhana00001ETurkey#03ş0c2AFşAfyonkarahisar00001EBarbados#06ş0c2JSşSaint Joseph000018Bahrain#01ş0c2CAşCapital000024PolandCounties#PL.WP.KOş0c2WKOşKonin000025PolandCounties#PL.WP.LEş0c2WLEşLeszno000025Uzbekistan#UZ.QRş0c2QRşKarakalpakstan00001EBurkinaFaso#BF.GGş0c2GGşGnagna00001CLiberia#LR.GPş0c2GPşGbarpolu00001FMacedonia#MK.VJş0c2VJşBogovinje00001AZambia#ZM.LPş0c2LPşLuapula00001EPhilippines#PH.TRş0c2TRşTarlac00001BYemen#YE.MWş0c2MWşMl Mahwit000023Macedonia#MK.CSş0c2CSşCucer Sandevo00001FPhilippines#PH.CGş0c2CGşCagayan000018Russia#RU.KSş0c2KSşKursk00002ACoteDivoire#CI.DHş0c2DHşDix-Huit Montagnes000021China2#CN.GXş0c2GXşGuangxi Zhuang000018China2#CN.HNş0c2HNşHunan00001FIran#IR.KJş0c2KJşSouth Khorasan00001CVietnam#VN.LDş0c2LDşLam Dong00001BCapeVerde#CV.PIş0c2PIşPraia00001DOklahoma#073ş0c2KIşKingfisher000015Iowa#125ş0c2MRşMarion00001BWisconsin#015ş0c2CAşCalumet00001EAlaska#290ş0c2YKşYukon-Koyukuk000016Texas#461ş0c2UPTşUpton00001BIndiana#077ş0c2JEşJefferson000017NewYork#049ş0c2LEşLewis00001ENorthCarolina#117ş0c2MTşMartin00001AVirginia#019ş0c2BEşBedford000018Georgia#269ş0c2TYşTaylor000018Kansas#071ş0c2GLşGreeley000022SouthCarolina#043ş0c2GEşGeorgetown000018Illinois#107ş0c2LOşLogan00001BMissouri#027ş0c2CWşCallaway000022WorldwithCountries#166ş0c2ESşSpain00001FNorthDakota#041ş0c2HEşHettinger000018Texas#099ş0c2CRYşCoryell000017Ohio#061ş0c2HAşHamilton00002BSpain#019ş0c2PAşPais Vasco (Basque Country)000018NewMexico#033ş0c2MOşMora000019Nebraska#031ş0c2CRşCherry000018Hawaii#005ş0c2KAşKalawao000024Europewithcountries#035ş0c2CSşSerbia000020England#020ş0c2LEşLeicestershire000019Tennessee#121ş0c2MIşMeigs00001FSouthAmerica#012ş0c2SRşSuriname000020WorldwithCountries#07ş0c2CUşCuba00001AGuatemala#11ş0c2JUşJutiapa000026Azerbaijan#02ş0c2ACşA&#287;cab&#601;di00001AMozambique#10ş0c2MNşManica00001FVenezuela#11ş0c2IşFalc&oacute;n000018Chile#09ş0c2LLşLos Lagos000018Portugal#11ş0c2GUşGuarda000018NewWorld#59ş0c2GNşGuinea00001ETurkey#04ş0c2AGşA&#287;r&#305;00001CBarbados#07ş0c2LUşSaint Lucy00001APuertoRico#77ş0c2JCşJuncos000018Bahrain#02ş0c2CEşCentral000024PolandCounties#PL.PD.LMş0c2PLMşLomza00001CPanama#PA.SBş0c2SBşKuna Yala000017Sudan#SD.WHş0c2WHşUnity00001BRussia#RU.KTş0c2KTşKostroma000018Tunisia#TN.SFş0c2SFşSfax00001EOman#OM.SHş0c2SHşAsh Sharqiyah000024Singapore#SG.EAş0c2EAşEast Singapore000021Cambodia#KH.PHş0c2PHşPreah Vihear00001CGhana#GH.UEş0c2UEşUpper East00001AColorado#033ş0c2DOşDolores00001AMontana#003ş0c2BHşBig Horn00001DSouthDakota#071ş0c2JAşJackson000018Alabama#049ş0c2DEşDekalb00001AAsia#001ş0c2AFşAfghanistan000019Vermont#019ş0c2OLşOrleans000018Missouri#209ş0c2STşStone000019California#113ş0c2YOşYolo000017Alaska#110ş0c2JUşJuneau000019Texas#281ş0c2LAPşLampasas00001DLouisiana#025ş0c2CTşCatahoula000018Georgia#089ş0c2DKşDeKalb000023WorldwithCountries#167ş0c2SEşSweden00001DMinnesota#141ş0c2SHşSherburne000019Kentucky#125ş0c2LUşLaurel000019Michigan#135ş0c2OCşOscoda00001AFlorida#053ş0c2HNşHernando00001DMississippi#035ş0c2FOşForrest00001CPennsylvania#001ş0c2ADşAdams000026Europewithcountries#036ş0c2SKşSlovakia00001CArkansas#025ş0c2CVşCleveland00001EEngland#021ş0c2LIşLincolnshire00001ESouthAmerica#013ş0c2UYşUruguay00001CWestVirginia#053ş0c2MSşMason000027Manitoba#CA.MB.NRş0c2NRşNorthern Region000019Bahrain#03ş0c2MUşMuharraq000024WorldwithCountries#08ş0c2DMşDominica00001FGuatemala#12ş0c2PEşPet&eacute;n00001EAzerbaijan#03ş0c2AMşA&#287;dam000020Mozambique#11ş0c2MTşMaputo(City)000019Venezuela#12ş0c2JşGuarico000037Chile#10ş0c2MAşMagallanes y la Ant&aacute;rtica Chilena00001FNewWorld#60ş0c2GWşGuinea-Bissau000016Turkey#05ş0c2AMşAmasya00001FBarbados#08ş0c2MIşSaint Michael000026PolandCounties#PL.PK.RMş0c2PRMşRzeszow00001ANamibia#NA.HAş0c2HAşHardap00001AAlgeria#DZ.DJş0c2DJşDjelfa00001BBurma#MM.MOş0c2MOşMon State00001EMacedonia#MK.VLş0c2VLşVasilevo000021Philippines#PH.TTş0c2TTşTawi-Tawi00001ATanzania#TZ.PWş0c2PWşPwani000022Macedonia#MK.DKş0c2DKşDemir Kapija00001FPhilippines#PH.BSş0c2BSşBasilan000019Russia#RU.KUş0c2KUşKurgan000025FranceDepartment#FR.YVş0c2YVşYvelines00001AChina2#CN.GZş0c2GZşGuizhou000018Nigeria#NG.YOş0c2YOşYobe000016Syria#SY.HIş0c2HIşHoms000025BrazilRegion#BR.NOş0c2NOşNorth Region000018Oklahoma#075ş0c2KOşKiowa000017Iowa#127ş0c2MSşMarshall00001CWisconsin#017ş0c2CHşChippewa000017Texas#463ş0c2UVAşUvalde000016Asia#002ş0c2AMşArmenia00001AIndiana#079ş0c2JNşJennings00001CNewYork#051ş0c2LIşLivingston000023NorthCarolina#119ş0c2MKşMecklenburg000018Virginia#021ş0c2BLşBland000019Georgia#271ş0c2TFşTelfair00001AKansas#073ş0c2GWşGreenwood000022SouthCarolina#045ş0c2GRşGreenville00001CIllinois#109ş0c2MUşMcDonough000019Missouri#029ş0c2CMşCamden000028WorldwithCountries#168ş0c2CHşSwitzerland00001CNorthDakota#043ş0c2KIşKidder000017Texas#101ş0c2COTşCottle000016Ohio#063ş0c2HNşHancock000019NewMexico#035ş0c2OTşOtero00001BNebraska#033ş0c2CYşCheyenne000016Hawaii#007ş0c2KUşKauai000026Europewithcountries#037ş0c2SLşSlovenia000018England#022ş0c2LOşLondon00001ATennessee#123ş0c2MOşMonroe000020SouthAmerica#014ş0c2VEşVenezuela000019Bahrain#04ş0c2NOşNorthern00002AWorldwithCountries#09ş0c2DOşDominican Rep.000015USA#ILş0c2ILşIllinois000021Guatemala#13ş0c2QZşQuetzaltenango000023Azerbaijan#04ş0c2ASşA&#287;da&#351;000016Venezuela#13ş0c2KşLara000014Chile#11ş0c2MLşMaule000022USASouthWestRegion#32ş0c2NVşNevada000018Portugal#13ş0c2LEşLeiria000017NewWorld#61ş0c2KEşKenya00001DBarbados#09ş0c2PEşSaint Peter000019PuertoRico#79ş0c2LJşLajas000019Nigeria#NG.GOş0c2GOşGombe000020Uzbekistan#UZ.SAş0c2SAşSamarkand000019Zambia#ZM.LSş0c2LSşLusaka00001DMacedonia#MK.DLş0c2DLşDelcevo000020Philippines#PH.BTş0c2BTşBatangas000018Russia#RU.KVş0c2KVşKirov00001EGuinea#GN.KSş0c2KSşKissidougou000028FranceDepartment#FR.HLş0c2HLşHaute Loire00001AColorado#035ş0c2DUşDouglas000018Montana#005ş0c2BLşBlaine00001DSouthDakota#073ş0c2JEşJerauld000018Alabama#051ş0c2ELşElmore000019Asia#003ş0c2AZşAzerbaijan000019Vermont#021ş0c2RUşRutland00001BMissouri#211ş0c2SUşSullivan000019California#115ş0c2YUşYuba000019Texas#283ş0c2LASşLa Salle00001DLouisiana#027ş0c2CBşClaiborne000017Georgia#091ş0c2DOşDodge000024WorldwithCountries#169ş0c2UAşUkraine00001AMinnesota#143ş0c2SBşSibley00001BKentucky#127ş0c2LWşLawrence000019Michigan#137ş0c2OSşOtsego00001BFlorida#055ş0c2HLşHighlands00001EMississippi#037ş0c2FRşFranklin000020Pennsylvania#003ş0c2ALşAllegheny000023Europewithcountries#038ş0c2ESşSpain00001BArkansas#027ş0c2CMşColumbia00001DWestVirginia#055ş0c2MEşMercer000019Bahrain#05ş0c2SOşSouthern000027WorldwithCountries#10ş0c2SVşEl Salvador000020Guatemala#14ş0c2QCşQuich&eacute;000020Azerbaijan#05ş0c2AFşA&#287;stafa000018Venezuela#14ş0c2LşMerida00002BChile#12ş0c2RMşSantiago Metropolitan Region000018Portugal#14ş0c2LIşLisboa000019NewWorld#62ş0c2LSşLesotho000017Turkey#07ş0c2ALşAntalya00001EBarbados#10ş0c2PHşSaint Philip000023WorldwithCountries#11ş0c2GDşGrenada000014USA#INş0c2INşIndiana00001DGuatemala#15ş0c2REşRetalhuleu00001DNewZealand#E7ş0c2AUKşAuckland00001DAzerbaijan#06ş0c2AUşA&#287;su000019Venezuela#15ş0c2MşMiranda00001EChile#13ş0c2TAşTarapac&aacute;000019NewWorld#63ş0c2LIşLiberia000016Turkey#08ş0c2AVşArtvin00001EBarbados#11ş0c2THşSaint Thomas000019PuertoRico#81ş0c2LRşLares000023PolandCounties#PL.LD.LOş0c2LLOşLodz00001DAlgeria#DZ.EBş0c2EBşEl Bayadh00001FSudan#SD.WKş0c2WKşWest Kurdufan000015Bhutan#BT.HAş0c2HAşHa000021CentralAmerica2#CE.HTş0c2HTşHaiti000021Macedonia#MK.DMş0c2DMşDemir Hisar00001FPhilippines#PH.BUş0c2BUşBulacan000017Niger#NE.DSş0c2DSşDosso00001ERussia#RU.MCş0c2MCşMoscow City000024Singapore#SG.WEş0c2WEşWest Singapore000028FranceDepartment#FR.HMş0c2HMşHaute Marne00001CKyrgyzstan#KG.TLş0c2TLşTalas000025Mauritius#MU.PWş0c2PWşPlaines Wilhems00001AOklahoma#077ş0c2LAşLatimer000014Iowa#129ş0c2MIşMills000019Wisconsin#019ş0c2CLşClark00001ATexas#465ş0c2VAVşVal Verde000019Indiana#081ş0c2JOşJohnson000019NewYork#053ş0c2MAşMadison000020NorthCarolina#121ş0c2MIşMitchell00001CVirginia#023ş0c2BOşBotetourt000019Georgia#273ş0c2TLşTerrell000019Kansas#075ş0c2HMşHamilton000021SouthCarolina#047ş0c2GWşGreenwood00001AIllinois#111ş0c2MHşMcHenry000021Missouri#031ş0c2CGşCape Girardeau00002BWorldwithCountries#170ş0c2UKşUnited Kingdom00001DNorthDakota#045ş0c2LMşLaMoure000016Texas#103ş0c2CRAşCrane000015Ohio#065ş0c2HRşHardin000018NewMexico#037ş0c2QUşQuay000017Nebraska#035ş0c2CLşClay000015Hawaii#009ş0c2MAşMaui000024Europewithcountries#039ş0c2SEşSweden000019England#024ş0c2NOşNorfolk00001ETennessee#125ş0c2MGşMontgomery000025WorldwithCountries#12ş0c2GTşGuatemala000026Guatemala#16ş0c2SAşSacatep&eacute;quez000022NewZealand#E8ş0c2BOPşBay of Plenty000025Azerbaijan#07ş0c2ABşAli Bayraml&#305;000019Venezuela#16ş0c2NşMonagas000025USASouthWestRegion#35ş0c2NMşNewMexico00001CPortugal#16ş0c2PAşPortalegre000017NewWorld#64ş0c2LRşLibya00001ATurkey#09ş0c2AYşAyd&#305;n000024PolandCounties#PL.MZ.PMş0c2MPMşPlock000036DemocraticRepublicoftheCongo#CD.KNş0c2KNşKinshasa City00002FCentralAfricanRepublic#CF.NMş0c2NMşNana-Mambere000029Philippines#PH.CLş0c2CLşCompostela Valley000019Malawi#MW.THş0c2THşThyolo00001ERussia#RU.KXş0c2KXşKrasnoyarsk00001CRussia#RU.LNş0c2LNşLeningrad000028FranceDepartment#FR.HNş0c2HNşHaute Saone00001CVietnam#VN.LIş0c2LIşLai Chau00001BOman#OM.BAş0c2BAşAl Batinah000018Syria#SY.HLş0c2HLşAleppo00001BCambodia#KH.PLş0c2PLşPailin000020CapeVerde#CV.PNş0c2PNşPorto Novo000018Colorado#037ş0c2EAşEagle00001CMontana#007ş0c2BRşBroadwater00001BSouthDakota#075ş0c2JOşJones00001AAlabama#053ş0c2ESşEscambia000019Asia#005ş0c2BDşBangladesh00001CVermont#023ş0c2WAşWashington000018Missouri#213ş0c2TAşTaney000017Texas#285ş0c2LAVşLavaca00001DLouisiana#029ş0c2COşConcordia000017Georgia#093ş0c2DLşDooly000029WorldwithCountries#171ş0c2VAşVatican City00001BMinnesota#145ş0c2SAşStearns000016Kentucky#129ş0c2LEşLee000019Michigan#139ş0c2OTşOttawa00001EFlorida#057ş0c2HBşHillsborough00001CMississippi#039ş0c2GOşGeorge000020Pennsylvania#005ş0c2ARşArmstrong000029Europewithcountries#040ş0c2CHşSwitzerland000019Arkansas#029ş0c2CWşConway000022England#025ş0c2NRşNorthamptonshire00001EWestVirginia#057ş0c2MIşMineral000025NewCaledonia#NC.SU.MDş0c2MDşMont-Dore000028NewCaledonia#NC.IL.OVş0c2OVşOuv&eacute;a000025PuertoRico#83ş0c2LMşLas Mar&iacute;as000021WorldwithCountries#13ş0c2HTşHaiti00001DGuatemala#17ş0c2SMşSan Marcos00001FNewZealand#E9ş0c2CANşCanterbury00001AAzerbaijan#08ş0c2AAşAstara00001FVenezuela#17ş0c2OşNueva Esparta000017Portugal#17ş0c2POşPorto00001CNewWorld#65ş0c2MSşMadagascar00001ETurkey#10ş0c2BKşBal&#305;kesir000027NovaScotia#CA.NS.STş0c2STşSunrise Trail000025SaudiArabia#SA.SHş0c2SHşAsh Sharqiyah00001BEurope2#EU.ADş0c2ADşAndorra00001EBurkinaFaso#BF.GMş0c2GMşGourma000024PapuaNewGuinea#PG.MBş0c2MBşMilne Bay00001DGuineaBissau#GW.GAş0c2GAşGabu000026EquatorialGuinea#GQ.WNş0c2WNşWele Nzas000020Philippines#PH.CMş0c2CMşCamiguin000029Tibet#TI.XPş0c2XPşXigaz&ecirc; Prefecture00001BRussia#RU.MEş0c2MEşMariy-El00001DTunisia#TN.TAş0c2TAşTataouine00001BVietnam#VN.KTş0c2KTşKon Tum000016Syria#SY.HMş0c2HMşHama00001BEurope2#EU.ROş0c2ROşRomania00001AEurope2#EU.SEş0c2SEşSweden00001BOklahoma#079ş0c2LFşLe Flore000017Iowa#131ş0c2MTşMitchell00001CWisconsin#021ş0c2COşColumbia00001ATexas#467ş0c2VAZşVan Zandt000015Asia#006ş0c2BTşBhutan000016Indiana#083ş0c2KNşKnox000018NewYork#055ş0c2MNşMonroe000022NorthCarolina#123ş0c2MGşMontgomery00001CVirginia#025ş0c2BRşBrunswick000018Georgia#275ş0c2THşThomas000017Kansas#077ş0c2HPşHarper00001FSouthCarolina#049ş0c2HAşHampton000019Illinois#113ş0c2MLşMcLean00001AMissouri#033ş0c2CRşCarroll000023WorldwithCountries#172ş0c2CYşCyprus00001BNorthDakota#047ş0c2LOşLogan000019Texas#105ş0c2CKTşCrockett000017Ohio#067ş0c2HIşHarrison00001ENewMexico#039ş0c2RAşRio Arriba000019Nebraska#037ş0c2COşColfax000025Europewithcountries#041ş0c2UAşUkraine000020England#026ş0c2NTşNorthumberland000019Tennessee#127ş0c2MEşMoore000028NewCaledonia#NC.NO.BEş0c2BEşB&eacute;lep000024WorldwithCountries#14ş0c2HNşHonduras00001DGuatemala#18ş0c2SRşSanta Rosa000018Azerbaijan#09ş0c2BAşBaki00001CVenezuela#18ş0c2PşPortuguesa000021Portugal#18ş0c2SAşSantar&eacute;m000018NewWorld#66ş0c2MWşMalawi000017Turkey#11ş0c2BCşBilecik00001CSudan#SD.WNş0c2WNşWhite Nile000021Macedonia#MK.CZş0c2CZşCentar Zupa000027Philippines#PH.CNş0c2CNşCamarines Norte000019Serbia#RS.NSş0c2NSşNisava00001ARussia#RU.LPş0c2LPşLipetsk00001BTunisia#TN.SLş0c2SLşSiliana00001AGuinea#GN.MCş0c2MCşMacenta000020SolomonIsland#SB.ISş0c2ISşIsabel000018China2#CN.HUş0c2HUşHubei00001DTunisia#TN.BAş0c2BAşBen Arous00002CFranceDepartment#FR.HPş0c2HPşHautes Pyrenees000017Syria#SY.IDş0c2IDşIdlib000024TrinidadandTobago#TT.NAş0c2NAşNariva000019Colorado#039ş0c2ELşElbert000018Montana#009ş0c2CAşCarbon00001FSouthDakota#077ş0c2KIşKingsbury000018Alabama#055ş0c2ETşEtowah000015Asia#007ş0c2BNşBrunei000019Vermont#025ş0c2WIşWindham000018Missouri#215ş0c2TEşTexas000014Texas#287ş0c2LEEşLee00001BLouisiana#031ş0c2DSşDe Soto000021Virginia#750ş0c2RAşRadford (City)00001BGeorgia#095ş0c2DUşDougherty000023WorldwithCountries#173ş0c2TKşTurkey00001AMinnesota#147ş0c2SEşSteele000019Kentucky#131ş0c2LSşLeslie00001FMichigan#141ş0c2PRşPresque Isle000018Florida#059ş0c2HMşHolmes00001CMississippi#041ş0c2GRşGreene00001DPennsylvania#007ş0c2BEşBeaver00002CEuropewithcountries#042ş0c2UKşUnited Kingdom00001CArkansas#031ş0c2CIşCraighead000021England#027ş0c2NGşNottinghamshire00001CWestVirginia#059ş0c2MNşMingo00001FPuertoRico#85ş0c2LPşLas Piedras000023WorldwithCountries#15ş0c2JMşJamaica000020Guatemala#19ş0c2SOşSolol&aacute;00001DNewZealand#F1ş0c2GISşGisborne00001BAzerbaijan#10ş0c2BLşBalakan000017Venezuela#19ş0c2RşSucre000020Portugal#19ş0c2SEşSet&uacute;bal000016NewWorld#67ş0c2MLşMali00001BTurkey#12ş0c2BGşBing&ouml;l000017Ghana#GH.TVş0c2TVşVolta000023Europe2#EU.AFş0c2AFşAland (Finland)00002CMorocco#MA.GBş0c2GBşGharb-Chrarda Beni Hssen00001DChad#TD.HDş0c2HDşHadjer-Lamis000021PapuaNewGuinea#PG.MDş0c2MDşMadang00001ARussia#RU.MGş0c2MGşMagadan00001BGuinea#GN.MDş0c2MDşMandiana00001BCambodia#KH.POş0c2POşPursat00001AOklahoma#081ş0c2LIşLincoln000015Iowa#133ş0c2MOşMonona00001CWisconsin#023ş0c2CRşCrawford000019Texas#469ş0c2VICşVictoria000016Asia#008ş0c2MMşBurma (00001BIndiana#085ş0c2KOşKosciusko00001CNewYork#057ş0c2MOşMontgomery00001DNorthCarolina#125ş0c2MOşMoore00001BVirginia#027ş0c2BUşBuchanan000016Georgia#277ş0c2TIşTift000017Kansas#079ş0c2HVşHarvey00001DSouthCarolina#051ş0c2HOşHorry000018Illinois#115ş0c2MAşMacon000019Missouri#035ş0c2CTşCarter00001DNorthDakota#049ş0c2MHşMcHenry000017Texas#107ş0c2CSBşCrosby00002AVirginia#570ş0c2COşColonial Heights (City)000014Ohio#069ş0c2HYşHenry00001DNewMexico#041ş0c2RSşRoosevelt000019Nebraska#039ş0c2CUşCuming00002AEuropewithcountries#043ş0c2VAşVatican City00001DEngland#028ş0c2OXşOxfordshire00001ATennessee#129ş0c2MNşMorgan000022WorldwithCountries#16ş0c2MXşMexico000020Guatemala#20ş0c2SUşSuchitepequez000020NewZealand#F2ş0c2HKBşHawke's Bay000020Egypt_346255#01ş0c2ALşAlexandria000019Azerbaijan#11ş0c2BRşBarda000019Venezuela#20ş0c2SşTachira000022Portugal#20ş0c2VCşViana do Castelo00001CNewWorld#68ş0c2MRşMauritania000016Turkey#13ş0c2BTşBitlis000022MarshallIsland#MH.MH.NUş0c2NUşNamu000025NovaScotia#CA.NS.CBş0c2CBşCape Breton000037DemocraticRepublicoftheCongo#CD.KRş0c2KRşKasai Oriental000019Senegal#SN.MTş0c2MTşMatam000024Morocco#MA.GCş0c2GCşGrand Casablanca00001EMauritania#MR.INş0c2INşInchiri00001DMacedonia#MK.DRş0c2DRşDrugovo00001DPhilippines#PH.CPş0c2CPşCapiz00001FGabon#GA.OIş0c2OIşOgooue-Ivindo000017Guinea#GN.LOş0c2LOşLola000020Swaziland#SZ.SHş0c2SHşShiselweni00001FIran#IR.KSş0c2KSşNorth Khorasan000026FranceDepartment#FR.HRş0c2HRşHaut Rhin00001FCambodia#KH.PPş0c2PPşPhnom Penh00001AColorado#041ş0c2EPşEl Paso000018Montana#011ş0c2CRşCarter00001ASouthDakota#079ş0c2LAşLake000019Alabama#057ş0c2FAşFayette000017Asia#009ş0c2KHşCambodia000019Vermont#027ş0c2WNşWindsor000019Missouri#217ş0c2VEşVernon000015Texas#289ş0c2LEOşLeon000024Louisiana#033ş0c2EBşEast Baton Rouge000019Georgia#097ş0c2DGşDouglas000026WorldwithCountries#175ş0c2AUşAustralia00001BMinnesota#149ş0c2STşStevens00001AKentucky#133ş0c2LTşLetcher00001CMichigan#143ş0c2ROşRoscommon00001EFlorida#061ş0c2IRşIndian river00001DMississippi#043ş0c2GEşGrenada00001EPennsylvania#009ş0c2BDşBedford000024Europewithcountries#044ş0c2CYşCyprus00001BArkansas#033ş0c2CFşCrawford000021WestVirginia#061ş0c2MLşMonongalia000020PuertoRico#87ş0c2LZşLo&iacute;za000025WorldwithCountries#17ş0c2NIşNicaragua000025Guatemala#21ş0c2TOşTotonicap&aacute;n000026NewZealand#F3ş0c2MWTşManawatu-Wanganui00001BEgypt_346255#02ş0c2ANşAswan000021Azerbaijan#12ş0c2BQşBeyl&#601;qan00001CSanMarino#01ş0c2ACşAcquaviva00001AVenezuela#21ş0c2TşTrujillo00001BPortugal#21ş0c2VRşVila Real000019NewWorld#69ş0c2MAşMorocco000014Turkey#14ş0c2BLşBolu000033NorthWestTerritories#CA.NT.NCş0c2NCşNahanni Country00001FMacau#MO.MA.SZş0c2SZşSao Lazaro000028SaoTomeandPrincipe#ST.CGş0c2CGşCantagalo00001DSaudiArabia#SA.TBş0c2TBşTabuk00001ASriLanka#LK.GLş0c2GLşGalle00001FSriLanka#LK.HBş0c2HBşHambantota000020SaudiArabia#SA.BAş0c2BAşAl Bahah00001ATanzania#TZ.RKş0c2RKşRukwa00001BLibya#LY.MBş0c2MBşAl Margab00001BMalawi#MW.BLş0c2BLşBlantyre00001ATunisia#TN.ANş0c2ANşAriana000029FranceDepartment#FR.HSş0c2HSşHaute Savoie000018Oklahoma#083ş0c2LOşLogan000015Iowa#135ş0c2MNşMonroe000018Wisconsin#025ş0c2DAşDane000017Texas#471ş0c2WAKşWalker000014Asia#010ş0c2CNşChina00001AIndiana#087ş0c2LAşLagrange000018NewYork#059ş0c2NAşNassau00001CNorthCarolina#127ş0c2NAşNash00001DVirginia#029ş0c2BCşBuckingham000018Georgia#279ş0c2TMşToombs000018Kansas#081ş0c2HSşHaskell00001ESouthCarolina#053ş0c2JAşJasper00001BIllinois#117ş0c2MPşMacoupin000017Missouri#037ş0c2CSşCass000021WorldwithCountries#176ş0c2FJşFiji00001ENorthDakota#051ş0c2MIşMcIntosh00001ATexas#109ş0c2CUBşCulberson000017Ohio#071ş0c2HGşHighland00001CNewMexico#043ş0c2SAşSandoval000019Nebraska#041ş0c2CSşCuster000024Europewithcountries#045ş0c2TKşTurkey00001CEngland#030ş0c2SHşShropshire000019Tennessee#131ş0c2OBşObion000026MadagascarRegions#MG.MA.SFş0c2SFşSofia000022WorldwithCountries#18ş0c2PAşPanama000019Guatemala#22ş0c2ZAşZacapa000020NewZealand#F4ş0c2MBHşMarlborough00001BEgypt_346255#03ş0c2ATşAsyut000022Azerbaijan#13ş0c2BSşBil&#601;suvar00001ESanMarino#02ş0c2CHşChiesanuova000019Venezuela#22ş0c2UşYaracuy000017Portugal#22ş0c2VIşViseu00001CNewWorld#70ş0c2MZşMozambique000016Turkey#15ş0c2BDşBurdur000030DemocraticRepublicoftheCongo#CD.KTş0c2KTşKatanga00001FUzbekistan#UZ.SIş0c2SIşSirdaryo000025Morocco#MA.GEş0c2GEşGuelmim Es Semara000017Sudan#SD.WRş0c2WRşWarab00001ASamoa #WS.PAş0c2PAşPalauli000019Serbia#RS.PCş0c2PCşPcinja00001BVietnam#VN.LOş0c2LOşLao Cai00001EThailand#TH.KKş0c2KKşKhon Kaen00001DWestVirginia#063ş0c2MOşMonroe00001EAustralia2#TASş0c2TASşTasmania00001AColorado#043ş0c2FRşFremont000019Montana#013ş0c2CSşCascade00001ESouthDakota#081ş0c2LWşLawrence00001AAlabama#059ş0c2FRşFranklin000019Missouri#219ş0c2WAşWarren000018Texas#291ş0c2LIBşLiberty000020Louisiana#035ş0c2ECşEast Carroll000017Georgia#099ş0c2EAşEarly000025WorldwithCountries#177ş0c2KIşKiribati000019Minnesota#151ş0c2SWşSwift000018Kentucky#135ş0c2LIşLewis00001AMichigan#145ş0c2SAşSaginaw000019Florida#063ş0c2JSşJackson00001DMississippi#045ş0c2HAşHancock00001CPennsylvania#011ş0c2BRşBerks000024Europewithcountries#046ş0c2RUşRussia00001DArkansas#035ş0c2CTşCrittenden00001AEngland#031ş0c2SOşSomerset000015Turkey#16ş0c2BUşBursa00001CPuertoRico#89ş0c2LQşLuquillo000031WorldwithCountries#19ş0c2KNşSt. Kitts &amp; Nevis00001BNewZealand#F5ş0c2NSNşNelson00001DEgypt_346255#04ş0c2BHşBeheira000026Azerbaijan#14ş0c2CBşC&#601;bray&#305;l00001CSanMarino#03ş0c2DOşDomagnano000017Venezuela#23ş0c2VşZulia000019NewWorld#71ş0c2NAşNamibia00001FBurkinaFaso#BF.YTş0c2YTşYatenga00001DMacedonia#MK.VVş0c2VVşVevcani000016Chad#TD.GRş0c2GRşGuera000025Philippines#PH.CSş0c2CSşCamarines Sur00001DGabon#GA.OLş0c2OLşOgooue-Lolo000019Serbia#RS.PDş0c2PDşDanube000020Iran#IR.KVş0c2KVşRazavi Khorasan00001CThailand#TH.KLş0c2KLşKalasin00001DThailand#TH.LBş0c2LBşLop Buri00001CEurope2#EU.SKş0c2SKşSlovakia00001AEurope2#EU.RUş0c2RUşRussia00001DMauritius#MU.SAş0c2SAşSavanne00001BTennessee#133ş0c2OVşOverton000017Oklahoma#085ş0c2LVşLove000019Iowa#137ş0c2MGşMontgomery000019Wisconsin#027ş0c2DOşDodge000017Texas#473ş0c2WALşWaller000019Asia#012ş0c2TPşEast Timor000016Indiana#089ş0c2LKşLake00001ANewYork#061ş0c2NYşNew York000023NorthCarolina#129ş0c2NHşNew Hanover00001BVirginia#031ş0c2CAşCampbell000017Georgia#281ş0c2TOşTowns000019Kansas#083ş0c2HGşHodgeman00001FSouthCarolina#055ş0c2KEşKershaw00001AIllinois#119ş0c2MIşMadison000018Missouri#039ş0c2CEşCedar00002DWorldwithCountries#178ş0c2MHşMarshall Islands00001ENorthDakota#053ş0c2MKşMcKenzie000017Texas#111ş0c2DALşDallam000016Ohio#073ş0c2HOşHocking00001CNewMexico#045ş0c2SJşSan Juan000019Nebraska#043ş0c2DAşDakota000026Europewithcountries#047ş0c2SCşScotland00001FEngland#032ş0c2STşStaffordshire000022NewCaledonia#NC.NO.CAş0c2CAşCanala000020Turkey#17ş0c2CKş&Ccedil;anakkale000025WorldwithCountries#20ş0c2LCşSt. Lucia00001ENewZealand#F6ş0c2NTLşNorthland00001FEgypt_346255#05ş0c2BNşBeni Suef000022Azerbaijan#15ş0c2CLşC&#601;lilabad00001ASanMarino#04ş0c2FAşFaetano000026Venezuela#24ş0c2WşDependencies Federal000017NewWorld#72ş0c2NEşNiger00002AEurope2#EU.BAş0c2BAşBosnia and Herzegovina00001FUzbekistan#UZ.TAş0c2TAşTashkent000019Ghana#GH.CPş0c2CPşCentral00001ALesotho#LS.LEş0c2LEşLeribe000021Panama#PA.BCş0c2BCşBocas del Toro00001CTanzania#TZ.SDş0c2SDşSingida000023Philippines#PH.CTş0c2CTşCatanduanes000021Gabon#GA.OMş0c2OMşOgooue-Maritime000018Serbia#RS.PEş0c2PEşPecki000029FranceDepartment#FR.HVş0c2HVşHaute Vienne00002BFranceDepartment#FR.ILş0c2ILşIndre et Loire00001CEurope2#EU.SLş0c2SLşSlovenia00001DWestVirginia#065ş0c2MGşMorgan00001BColorado#045ş0c2GAşGarfield00001AMontana#015ş0c2CHşChouteau00001DSouthDakota#083ş0c2LIşLincoln000018Alabama#061ş0c2GEşGeneva000016Asia#013ş0c2GEşGeorgia00001DMissouri#221ş0c2WSşWashington000020Alaska#122ş0c2KEşKenai Peninsula00001ATexas#293ş0c2LIMşLimestone000022Louisiana#037ş0c2EFşEast Feliciana000018Georgia#101ş0c2ECşEchols000027WorldwithCountries#179ş0c2FMşMicronesia000018Minnesota#153ş0c2TOşTodd00001AKentucky#137ş0c2LNşLincoln00001CMichigan#147ş0c2SCşSt. Clair00001BFlorida#065ş0c2JEşJefferson00001EMississippi#047ş0c2HRşHarrison00001CPennsylvania#013ş0c2BLşBlair000025Europewithcountries#048ş0c2ENşEngland000018Arkansas#037ş0c2CSşCross000019England#033ş0c2SUşSuffolk000019NewWorld#73ş0c2NGşNigeria000027USANorthEastRegion#09ş0c2CTşConnecticut000021PuertoRico#91ş0c2MTşManat&iacute;00003CWorldwithCountries#21ş0c2VCşSt. Vincent &amp; the Grenadines00001ANewZealand#F7ş0c2OTAşOtago00001BEgypt_346255#06ş0c2CAşCairo00002BAzerbaijan#16ş0c2DSşDa&#351;k&#601;s&#601;n00001DSanMarino#05ş0c2FIşFiorentino000022Venezuela#25ş0c2AşDistrito Capital00001EEurope2#EU.SMş0c2SMşSan Marino000021Kyrgyzstan#KG.DAş0c2DAşJalal Abad00001BEurope2#EU.ALş0c2ALşAlbania000019Jordan#JO.MAş0c2MAşMafraq00001BRussia#RU.MMş0c2MMşMurmansk00001ATunisia#TN.SSş0c2SSşSousse000021Thailand#TH.KNş0c2KNşKanchanaburi000018England#034ş0c2SRşSurrey000019Tennessee#135ş0c2PEşPerry00001AOklahoma#087ş0c2MCşMcClain000018Iowa#139ş0c2MUşMuscatine000018Wisconsin#029ş0c2DRşDoor000015Texas#475ş0c2WARşWard000014Asia#014ş0c2INşIndia00001AIndiana#091ş0c2LPşLa Porte000019NewYork#063ş0c2NIşNiagara000023NorthCarolina#131ş0c2NTşNorthampton00001BVirginia#033ş0c2CRşCaroline00001AGeorgia#283ş0c2TEşTreutlen000018Kansas#085ş0c2JAşJackson000021SouthCarolina#057ş0c2LAşLancaster000019Illinois#121ş0c2MSşMarion00001BMissouri#041ş0c2CNşChariton000022WorldwithCountries#180ş0c2NRşNauru00001CNorthDakota#055ş0c2MLşMcLean000017Texas#113ş0c2DASşDallas000015Ohio#075ş0c2HLşHolmes00001ENewMexico#047ş0c2SMşSan Miguel000018Nebraska#045ş0c2DWşDawes000023Europewithcountries#049ş0c2WAşWales000034NewfoundlandandLabrador#CA.NF.AVş0c2AVşAvalon Region000018NewWorld#74ş0c2RWşRwanda00001CTurkey#19ş0c2CMş&Ccedil;orum000024USANorthEastRegion#10ş0c2DEşDelaware000031WorldwithCountries#22ş0c2TTşTrinidad &amp; Tobago00001ENewZealand#F8ş0c2STLşSouthland00001EEgypt_346255#07ş0c2DAşDakahlia00002BAzerbaijan#17ş0c2DVşD&#601;v&#601;&ccedil;i000021SanMarino#06ş0c2BMşBorgo Maggiore000018Venezuela#26ş0c2XşVargas00001FBurkinaFaso#BF.ZMş0c2ZMşZondoma00001CSriLanka#LK.GQş0c2GQşGampaha000019Somalia#SO.MUş0c2MUşMudug000017Nepal#NP.RAş0c2RAşRapti000024Kiribati#KI.PIş0c2PIşPhoenix Islands00001EPhilippines#PH.CVş0c2CVşCavite000018Gabon#GA.NYş0c2NYşNyanga000020Lebanon#LE.NAş0c2NAşAn Nabatiyah000019Iran#IR.LOş0c2LOşLorestan000022FranceDepartment#FR.INş0c2INşIndre00001CVietnam#VN.LSş0c2LSşLang Son000019Thailand#TH.LEş0c2LEşLoei00002BEuropewithcountries#050ş0c2NIşNorth Ireland000019Arkansas#039ş0c2DAşDallas00001AEngland#035ş0c2ESşE.Sussex00001FWestVirginia#067ş0c2NIşNicholas000019Colorado#047ş0c2GIşGilpin000018Montana#017ş0c2CUşCuster00001BSouthDakota#085ş0c2LYşLyman000018Alabama#063ş0c2GRşGreene000018Asia#015ş0c2IDşIndonesia000018Missouri#223ş0c2WYşWayne000019Texas#295ş0c2LIPşLipscomb00001ELouisiana#039ş0c2EVşEvangeline00001BGeorgia#103ş0c2EFşEffingham000028WorldwithCountries#181ş0c2NZşNew Zealand00001CMinnesota#155ş0c2TRşTraverse00001DKentucky#139ş0c2LGşLivingston00001DMichigan#149ş0c2SJşSt. Joseph00001BFlorida#067ş0c2LYşLafayette00001BMississippi#049ş0c2HIşHinds00001FPennsylvania#015ş0c2BFşBradford000021NewCaledonia#NC.NO.TOş0c2TOşTouho000027NewWorld#75ş0c2STşSao Tome and Principe000017Turkey#20ş0c2DNşDenizli000030USANorthEastRegion#11ş0c2DCşDistrict of Columbia00001BPuertoRico#93ş0c2MRşMaricao000029WorldwithCountries#23ş0c2USşUnited States00001DNewZealand#F9ş0c2TKIşTaranaki00001EEgypt_346255#08ş0c2DMşDamietta00001FAzerbaijan#18ş0c2FUşF&uuml;zuli00001DSanMarino#07ş0c2SMşSan Marino00001DAsiaGeorgia#01ş0c2ABşAbkhazia00001ABelgium#01ş0c2ANşAntwerpen000016Mali#ML.KDş0c2KDşKidal000017Guinea#GN.MLş0c2MLşMali000018Tunisia#TN.BJş0c2BJşBeja00001AIran#IR.KZş0c2KZşKhuzestan000023Thailand#TH.KPş0c2KPşKamphaeng Phet000028Eritrea#ER.SKş0c2SKşSemenawi Keyih Bahri00001EEngland#036ş0c2WAşWarwickshire00001BTennessee#137ş0c2PIşPickett00001COklahoma#089ş0c2MTşMcCurtain000016Iowa#141ş0c2OBşO'Brien00001BWisconsin#031ş0c2DUşDouglas00001BTexas#477ş0c2WASşWashington000013Asia#016ş0c2IRşIran00001AIndiana#093ş0c2LWşLawrence000018NewYork#065ş0c2ONşOneida00001ENorthCarolina#133ş0c2ONşOnslow00001AVirginia#035ş0c2CLşCarroll000017Georgia#285ş0c2TRşTroup00001AKansas#087ş0c2JFşJefferson00001FSouthCarolina#059ş0c2LUşLaurens00001BIllinois#123ş0c2MNşMarshall00001CMissouri#043ş0c2CHşChristian000022WorldwithCountries#182ş0c2PWşPalau00001CNorthDakota#057ş0c2MEşMercer000017Texas#115ş0c2DAWşDawson000014Ohio#077ş0c2HUşHuron00001CNewMexico#049ş0c2SFşSanta Fe000019Nebraska#047ş0c2DSşDawson000023NewCaledonia#NC.SU.MOş0c2MOşMoindou000026Manitoba#CA.MB.PMş0c2PMşPembina Region000019NewWorld#76ş0c2SNşSenegal00001FTurkey#21ş0c2DYşDiyarbak&#305;r000025WorldwithCountries#24ş0c2GLşGreenland00001CEgypt_346255#09ş0c2FYşFaiyum00002AAzerbaijan#19ş0c2GDşG&#601;d&#601;b&#601;y000019Ukraine#01ş0c2CKşCherkasy000020SanMarino#08ş0c2MGşMontegiardino00001BAsiaGeorgia#02ş0c2AJşAdjara000018Belgium#02ş0c2HAşHainaut00001BEurope2#EU.BEş0c2BEşBelgium00001BAlgeria#DZ.EOş0c2EOşEl Oued000019Jordan#JO.MDş0c2MDşMadaba000023CentralAmerica2#CE.JMş0c2JMşJamaica00001ETanzania#TZ.SHş0c2SHşShinyanga000034PapuaNewGuinea#PG.NCş0c2NCşNational Capital District00001EUzbekistan#UZ.ANş0c2ANşAndijon00001AHongKong#HK.NOş0c2NOşNorth00001AMicronesia#FM.YAş0c2YAşYap000018Serbia#RS.PIş0c2PIşPirot000018Guinea#GN.MMş0c2MMşMamou00001ALibya#LY.MIş0c2MIşMisratah00001FBotswana#BW.NWş0c2NWşNorth West00001BVietnam#VN.NAş0c2NAşNghe An00001CThailand#TH.LGş0c2LGşLampang000018Arkansas#041ş0c2DEşDesha00001BWestVirginia#069ş0c2OHşOhio000018Colorado#049ş0c2GRşGrand000019Montana#019ş0c2DAşDaniels00001CSouthDakota#087ş0c2MCşMcCook000016Alabama#065ş0c2HAşHale00001FVirginia#036ş0c2CCşCharles City00001AMissouri#225ş0c2WBşWebster000015Utah#001ş0c2BVşBeaver000019Texas#297ş0c2LIVşLive Oak00001CLouisiana#041ş0c2FRşFranklin000022Virginia#760ş0c2RIşRichmond (City)000018Georgia#105ş0c2ELşElbert00002DWorldwithCountries#183ş0c2PGşPapua New Guinea00001BMinnesota#157ş0c2WBşWabasha000018Kentucky#141ş0c2LOşLogan00001AMichigan#151ş0c2SNşSanilac000016Florida#069ş0c2LAşLake00001CMississippi#051ş0c2HOşHolmes00001CPennsylvania#017ş0c2BUşBucks000035NewfoundlandandLabrador#CA.NF.CEş0c2CEşCentral Region00001BNewWorld#77ş0c2SCşSeycelles000016Turkey#22ş0c2EDşEdirne00001BPuertoRico#95ş0c2MBşMaunabo000020SaintLucia#01ş0c2ARşAnse-la-Raye000025WorldwithCountries#25ş0c2ARşArgentina00001CNewZealand#G1ş0c2WKOşWaikato00001DEgypt_346255#10ş0c2GHşGharbia000023Azerbaijan#20ş0c2GAşG&#601;nc&#601;00001AUkraine#02ş0c2CHşChernihiv00001DSanMarino#09ş0c2SEşSerravalle00001AAsiaGeorgia#03ş0c2GUşGuria000016Belgium#03ş0c2LIşLiege000022SouthAfrica#02ş0c2NLşKwaZulu-Natal000023Hungary#01ş0c2BKşB&aacute;cs-Kiskun00001ECambodia#KH.PYş0c2PYşPrey Veng000024CapeVerde#CV.RGş0c2RGşRibeira Grande00001DCameroon#CM.ADş0c2ADşAdamaoua00001EKazakhstan#KZ.ZMş0c2ZMşZhambyl00001DBurkinaFaso#BF.HOş0c2HOşHouet00001CSaudiArabia#SA.ASş0c2ASşAsir00002ECentralAfricanRepublic#CF.OPş0c2OPşOuham-Pende000020PapuaNewGuinea#PG.MNş0c2MNşManus00001ABurundi#BI.RTş0c2RTşRutana000026Sudan#SD.GDş0c2GDşAl Qadarif (Gedarif)000026Philippines#PH.DOş0c2DOşDavao Oriental00001BRussia#RU.NGş0c2NGşNovgorod000019Libya#LY.MJş0c2MJşAl Marj000018China2#CN.JLş0c2JLşJilin00001DVietnam#VN.NBş0c2NBşNinh Binh00001AThailand#TH.KRş0c2KRşKrabi00001BEngland#038ş0c2WIşWiltshire000018Tennessee#139ş0c2POşPolk000017France#002ş0c2ALşAlsace00001BOklahoma#091ş0c2MLşMcIntosh000016Iowa#143ş0c2OSşOsceola000018Wisconsin#033ş0c2DNşDunn000015Texas#479ş0c2WEBşWebb000019Indiana#095ş0c2MAşMadison00001ANewYork#067ş0c2OOşOnondaga00001ENorthCarolina#135ş0c2ORşOrange00001CVirginia#037ş0c2CHşCharlotte000018Georgia#287ş0c2TUşTurner000017Kansas#089ş0c2JWşJewell00001BSouthCarolina#061ş0c2LEşLee000018Illinois#125ş0c2MOşMason000018Missouri#045ş0c2CKşClark000022WorldwithCountries#184ş0c2WSşSamoa00001CNorthDakota#059ş0c2MOşMorton00001BTexas#117ş0c2DESşDeaf Smith000023Virginia#580ş0c2CIşCovington (City)000016Ohio#079ş0c2JAşJackson00001ANewMexico#051ş0c2SIşSierra000018Nebraska#049ş0c2DEşDeuel000020USASouthWestRegion#49ş0c2UTşUtah00001ENewWorld#78ş0c2SLşSierra Leone000020Turkey#23ş0c2EGşElaz&#305;&#287;00001BSaintLucia#02ş0c2DAşDauphin000023WorldwithCountries#26ş0c2BOşBolivia00001FNewZealand#G2ş0c2WGNşWellington00001AEgypt_346255#11ş0c2GZşGiza00001CAzerbaijan#21ş0c2GRşGoranboy00001BUkraine#03ş0c2CVşChernivtsi00001AGreenland#01ş0c2NGşAvannaa00001CAsiaGeorgia#04ş0c2IMşImereti000018Belgium#04ş0c2LMşLimburg00001FSouthAfrica#03ş0c2FSşFree State000018Hungary#02ş0c2BAşBaranya000034NorthWestTerritories#CA.NT.MVş0c2MVşMackenzie Valley00002AFrenchGuiana#GL.SL.AYş0c2AYşAwala Yalimapo000028Mauritius#MU.RRş0c2RRşRiviere Du Rempart00001CGhana#GH.UWş0c2UWşUpper West00001CEurope2#EU.BGş0c2BGşBulgaria000022BurkinaFaso#BF.GZş0c2GZşGanzourgou00001BZambia#ZM.NOş0c2NOşNorthern00001FMongolia#MN.SBş0c2SBşSukhbaatar000022CoteDivoire#CI.WRş0c2WRşWorodougou00001BRussia#RU.MRş0c2MRşMordovia00001BMalawi#MW.CKş0c2CKşChikwawa000017Arkansas#043ş0c2DRşDrew000020England#039ş0c2WOşWorcestershire000020WestVirginia#071ş0c2PEşPendleton00001AFrance#003ş0c2AQşAquitaine00001BColorado#051ş0c2GUşGunnison000018Montana#021ş0c2DWşDawson00001FSouthDakota#089ş0c2MPşMcPherson000017Alabama#067ş0c2HEşHenry000014Asia#019ş0c2JPşJapan000018Missouri#227ş0c2WOşWorth000018Utah#003ş0c2BEşBox Elder000016Texas#299ş0c2LANşLlano000019Louisiana#043ş0c2GRşGrant000019Georgia#107ş0c2EMşEmanuel00002CWorldwithCountries#185ş0c2SBşSolomon Islands00001AMinnesota#159ş0c2WDşWadena000017Kentucky#143ş0c2LYşLyon00001EMichigan#153ş0c2SHşSchoolcraft000015Florida#071ş0c2LEşLee00001FMississippi#053ş0c2HUşHumphreys00001DPennsylvania#019ş0c2BTşButler00002BMadagascarRegions#MG.AV.AGş0c2AGşAnalamanga000019NewWorld#79ş0c2SOşSomalia000018Turkey#24ş0c2ENşErzincan000021PuertoRico#97ş0c2MGşMayag&uuml;ez00001CSaintLucia#03ş0c2CAşCastries000022WorldwithCountries#27ş0c2BRşBrazil00001FNewZealand#G3ş0c2WTCşWest Coast00001EEgypt_346255#12ş0c2ISşIsmailia000026Azerbaijan#22ş0c2GYşG&ouml;y&ccedil;ay00001FUkraine#04ş0c2DPşDnipropetrovsk000017Greenland#02ş0c2EGşTunu00001CAsiaGeorgia#05ş0c2KAşKakheti00001BBelgium#05ş0c2LUşLuxembourg000016Greece#01ş0c2ATşAttica000024Hungary#03ş0c2BEşB&eacute;k&eacute;s000025PolandCounties#PL.PM.SLş0c2PSLşSlupsk00001CBurkinaFaso#BF.ZRş0c2ZRşZiro00001FQatar#QA.GHş0c2GHşAl Ghuwariyah00001AEritrea#ER.ANş0c2ANşAnseba00001DUK7#UK.NIş0c2NIşNorth Ireland000019Russia#RU.MSş0c2MSşMoscow00001ATunisia#TN.TOş0c2TOşTozeur000017Uganda#UG.GLş0c2GLşGulu000022FranceDepartment#FR.ISş0c2ISşIsere00001CVietnam#VN.NDş0c2NDşNam Dinh00001APalau#PW.AMş0c2AMşAimeliik00001EEngland#040ş0c2NYşN. Yorkshire00001ATennessee#141ş0c2PUşPutnam000019France#004ş0c2AUşAuvergne000018Oklahoma#093ş0c2MAşMajor000013Iowa#145ş0c2PAşPage00001EWisconsin#035ş0c2ECşEau Claire000018Texas#481ş0c2WHAşWharton000018Indiana#097ş0c2MRşMarion000019NewYork#069ş0c2OTşOntario00001FNorthCarolina#137ş0c2PAşPamlico000018Georgia#289ş0c2TWşTwiggs000018Kansas#091ş0c2JOşJohnson000021SouthCarolina#063ş0c2LXşLexington000019Illinois#127ş0c2MCşMassac000017Missouri#047ş0c2CYşClay000022WorldwithCountries#186ş0c2TOşTonga00001FNorthDakota#061ş0c2MUşMountrail000016Texas#119ş0c2DELşDelta000018Ohio#081ş0c2JEşJefferson00001BNewMexico#053ş0c2SOşSocorro000018Nebraska#051ş0c2DIşDixon00002AMadagascarRegions#MG.MA.BEş0c2BEşBetsiboka00003APrinceEdwardIsland#CA.PE.NCş0c2NCşNorth Cape Coastal Drive000027Manitoba#CA.MB.PRş0c2PRşParkland Region00002BMadagascarRegions#MG.TM.AIş0c2AIşAtsinanana00001ENewWorld#80ş0c2ZAşSouth Africa000017Turkey#25ş0c2EMşErzurum00001CSaintLucia#04ş0c2CHşChoiseul000021WorldwithCountries#28ş0c2CLşChile000016USA#LAş0c2LAşLouisiana000024Egypt_346255#13ş0c2KSşKafr el-Sheikh000022Azerbaijan#23ş0c2HAşHac&#305;qabul000018Ukraine#05ş0c2DTşDonetsk00001ALatvia#01ş0c2AIşAizkraukle000018Greenland#03ş0c2VGşKitaa000021AsiaGeorgia#06ş0c2KKşKvemo Kartli000019Haiti#03ş0c2NOşNord-Ouest000016Belgium#06ş0c2NAşNamur00001EGreece#02ş0c2CGşCentral Greece000021SouthAfrica#05ş0c2ECşEastern Cape000033Hungary#04ş0c2BOşBorsod-Aba&uacute;j-Zempl&eacute;n000017Nigeria#NG.IMş0c2IMşImo00001BTanzania#TZ.RVş0c2RVşRuvuma00001BTanzania#TZ.TBş0c2TBşTabora00001CMacedonia#MK.ETş0c2ETşTetovo00001DSerbia#RS.PMş0c2PMşPomoravlje00001BBurundi#BI.BBş0c2BBşBubanza000020Tunisia#TN.SZş0c2SZşSidi Bou Zid00001APalau#PW.SOş0c2SOşSonsorol000018Iran#IR.MKş0c2MKşMarkazi000018Palau#PW.ANş0c2ANşAngaur00001EPennsylvania#021ş0c2CAşCambria00001BArkansas#045ş0c2FAşFaulkner00001FEngland#041ş0c2TWşTyne And Wear000020WestVirginia#073ş0c2PLşPleasants000019France#005ş0c2BRşBretagne00001BColorado#053ş0c2HIşHinsdale00001CMontana#023ş0c2DLşDeer Lodge00001ESouthDakota#091ş0c2MAşMarshall000019Alabama#069ş0c2HOşHouston000019Asia#021ş0c2KZşKazakhstan000019Missouri#229ş0c2WRşWright000022Alaska#130ş0c2KGşKetchikan Gateway000014Utah#005ş0c2CAşCache000017Texas#301ş0c2LOVşLoving00001ALouisiana#045ş0c2IBşIberia000017Georgia#109ş0c2EVşEvans000023WorldwithCountries#187ş0c2TVşTuvalu00001AMinnesota#161ş0c2WSşWaseca00001CKentucky#145ş0c2MKşMcCracken00001DMichigan#155ş0c2SWşShiawassee000016Florida#073ş0c2LOşLeon00001FMississippi#055ş0c2ISşIssaquena000017NewWorld#81ş0c2SDşSudan00001ETurkey#26ş0c2ESşEski&#351;ehir000018PuertoRico#99ş0c2MCşMoca00001BSaintLucia#05ş0c2DEşDennery000024WorldwithCountries#29ş0c2COşColombia00001CEgypt_346255#14ş0c2MTşMatruh000024Azerbaijan#24ş0c2IMş&#304;mi&#351;li000020Ukraine#06ş0c2IFşIvano-Frankivsk00001CLatvia#02ş0c2ALşAl&#363;ksne000026AsiaGeorgia#07ş0c2MMşMtskheta-Mtianeti000020Belgium#07ş0c2OVşOost-Vlaanderen000021Greece#03ş0c2CMşCentral Macedonia00001CSouthAfrica#06ş0c2GTşGauteng000019Hungary#05ş0c2BUşBudapest000029PolandCounties#PL.PK.TMş0c2PTMşTarnobrzeg000018Nauru#NR.MEş0c2MEşMeneng00001BEurope2#EU.UAş0c2UAşUkraine00001AEurope2#EU.TKş0c2TKşTurkey00001BEurope2#EU.ATş0c2ATşAustria00001BAlgeria#DZ.ETş0c2ETşEl Tarf000021PapuaNewGuinea#PG.MRş0c2MRşMorobe000025Philippines#PH.DSş0c2DSşDavao del Sur00002FHungaryRegions#HU.SGş0c2SGşSouthern Great Plain000018England#042ş0c2MSşMersey000018Tennessee#143ş0c2RHşRhea00001BMaryland#001ş0c2ALşAllegany00001AFrance#006ş0c2BUşBourgogne00001BOklahoma#095ş0c2MRşMarshall000018Iowa#147ş0c2PLşPalo Alto00001CWisconsin#037ş0c2FLşFlorence000018Texas#483ş0c2WHEşWheeler00001CAsia#022ş0c2KPşKorea (north)00001AIndiana#099ş0c2MSşMarshall000018NewYork#071ş0c2ORşOrange000022NorthCarolina#139ş0c2PSşPasquotank00001FVirginia#041ş0c2CSşChesterfield000017Georgia#291ş0c2UNşUnion000017Kansas#093ş0c2KEşKearny000021SouthCarolina#065ş0c2MCşMcCormick000019Illinois#129ş0c2MDşMenard00001AMissouri#049ş0c2CIşClinton000024WorldwithCountries#188ş0c2VUşVanuatu00001CNorthDakota#063ş0c2NEşNelson000017Texas#121ş0c2DENşDenton000013Ohio#083ş0c2KNşKnox000018NewMexico#055ş0c2TAşTaos000018Nebraska#053ş0c2DOşDodge00001BNewWorld#82ş0c2SZşSwaziland000023USANorthEastRegion#18ş0c2INşIndiana00001ESaintLucia#06ş0c2GIşGros Islet000023WorldwithCountries#30ş0c2ECşEcuador00001BEgypt_346255#15ş0c2MNşMinya00002CAzerbaijan#25ş0c2ISş&#304;smay&#305;ll&#305;000018Ukraine#07ş0c2KKşKharkiv000015Latvia#03ş0c2BLşBalvi000036AsiaGeorgia#08ş0c2RLşRacha-Lechkhumi and Kvemo Svaneti000020Belgium#08ş0c2WVşWest-Vlaanderen000015Greece#04ş0c2CRşCrete00001FSouthAfrica#07ş0c2MPşMpumalanga000020Hungary#06ş0c2CSşCsongr&aacute;d000025PolandCounties#PL.MA.TMş0c2MTMşTarnow00001AMali#ML.KKş0c2KKşKoulikoro000022Uzbekistan#UZ.SUş0c2SUşSurxondaryo000024Uzbekistan#UZ.TKş0c2TKşTashkent City000018Panama#PA.CCş0c2CCşCocle000026PapuaNewGuinea#PG.NIş0c2NIşNew Ireland00001ABurundi#BI.RYş0c2RYşRuyigi00001FMacedonia#MK.GBş0c2GBşGazi Baba00001BRussia#RU.OBş0c2OBşOrenburg000018Malawi#MW.DEş0c2DEşDedza00002CFranceDepartment#FR.IVş0c2IVşIlle et Vilaine00001EPennsylvania#023ş0c2CMşCameron00001BArkansas#047ş0c2FRşFranklin00001EEngland#043ş0c2GMşG.Manchester000021WestVirginia#075ş0c2POşPocahontas000017France#007ş0c2CEşCentre00001BColorado#055ş0c2HUşHuerfano000018Montana#025ş0c2FAşFallon00001BSouthDakota#093ş0c2MEşMeade000019Alabama#071ş0c2JAşJackson00001CAsia#023ş0c2KRşKorea (south)000015Utah#007ş0c2CRşCarbon000018Texas#303ş0c2LUBşLubbock00001DLouisiana#047ş0c2IEşIberville000018Georgia#111ş0c2FAşFannin00002AWorldwithCountries#189ş0c2NCşNew Caledonia00001EMinnesota#163ş0c2WAşWashington00001BKentucky#147ş0c2MRşMcCreary00001AMichigan#157ş0c2TUşTuscola000016Florida#075ş0c2LVşLevy00001EMississippi#057ş0c2ITşItawamba00001ANewWorld#83ş0c2TZşTanzania000017Turkey#28ş0c2GIşGiresun00001BSaintLucia#07ş0c2LBşLaborie00002CWorldwithCountries#31ş0c2FKşFalkland Islands00001DEgypt_346255#16ş0c2MFşMonufia00002BAzerbaijan#26ş0c2KAşK&#601;lb&#601;c&#601;r000018Ukraine#08ş0c2KSşKherson000016Latvia#04ş0c2BUşBauska000024NorthEuropeanRegion#01ş0c2DKşDenmark000027AsiaGeorgia#09ş0c2SJşSamtskhe-Javakheti000019Haiti#06ş0c2ARşArtibonite00001FBelgium#09ş0c2BWşBrabant Wallon000029Greece#05ş0c2EMşEast Macedonia and Thrace000022SouthAfrica#08ş0c2NCşNorthern Cape00001CThailand#TH.LNş0c2LNşLamphun00001DThailand#TH.MDş0c2MDşMukdahan000024CapeVerde#CV.SCş0c2SCşSanta Catarina000023SaoTomeandPrincipe#ST.CUş0c2CUşCaue00001BKyrgyzstan#KG.CUş0c2CUşChuy00001CLesotho#LS.MFş0c2MFşMefeteng00001FZimbabwe#ZW.MAş0c2MAşManicaland000015Benin#BJ.ZOş0c2ZOşZou00001BIran#IR.MNş0c2MNşMazandaran00001CEngland#044ş0c2WMşW.Midlands000019Tennessee#145ş0c2ROşRoane00001FMaryland#003ş0c2ANşAnne Arundel000022France#008ş0c2CHşChampagne-Ardenne000018Oklahoma#097ş0c2MYşMayes000017Iowa#149ş0c2PYşPlymouth00001FWisconsin#039ş0c2FDşFond du Lac000018Texas#485ş0c2WICşWichita000018Indiana#101ş0c2MTşMartin000019NewYork#073ş0c2OLşOrleans00001ENorthCarolina#141ş0c2PEşPender000019Virginia#043ş0c2CKşClarke000017Georgia#293ş0c2UPşUpson000018Kansas#095ş0c2KMşKingman00001ESouthCarolina#067ş0c2MAşMarion000019Illinois#131ş0c2MRşMercer000017Missouri#051ş0c2CLşCole000024WorldwithCountries#190ş0c2BAşBahrain00001CNorthDakota#065ş0c2OLşOliver000017Texas#123ş0c2DEWşDewitt000013Ohio#085ş0c2LAşLake00001CNewMexico#057ş0c2TRşTorrance00001ANebraska#055ş0c2DUşDouglas00001DHungary#08ş0c2FEşFej&eacute;r000016NewWorld#84ş0c2TGşTogo00001ASaintLucia#08ş0c2MIşMicoud000029WorldwithCountries#32ş0c2GFşFrench Guiana000020Egypt_346255#17ş0c2NVşNew Valley000026Azerbaijan#27ş0c2KUşK&uuml;rd&#601;mir00001DUkraine#09ş0c2KMşKhmelnytskyi00001ALatvia#05ş0c2CEşC&#275;sis000024NorthEuropeanRegion#02ş0c2EEşEstonia000021AsiaGeorgia#10ş0c2SKşShida Kartli000015Haiti#07ş0c2CEşCentre000016Greece#06ş0c2EPşEpirus00001CSouthAfrica#09ş0c2LPşLimpopo000024PolandCounties#PL.MZ.RMş0c2MRMşRadom000024SierraLeone#SL.NO.PLş0c2PLşPort Loko000017Palau#PW.ARş0c2ARşAirai00001EOman#OM.DAş0c2DAşAd Dakhiliyah000022CapeVerde#CV.SDş0c2SDşSao Domingos000029BurkinaFaso#BF.ZWş0c2ZWşZoundw&eacute;ogo000030DemocraticRepublicoftheCongo#CD.MNş0c2MNşManiema00001ASomalia#SO.NUş0c2NUşNugaal00001CNepal#NP.SAş0c2SAşSagarmatha000027Philippines#PH.DVş0c2DVşDavao del Norte00001BRussia#RU.NNş0c2NNşNenetsia000018Libya#LY.MQş0c2MQşMurzuq00001AChina2#CN.JSş0c2JSşJiangsu00001DPennsylvania#025ş0c2CRşCarbon000019Arkansas#049ş0c2FUşFulton000019England#045ş0c2RNşRutland00001EWestVirginia#077ş0c2PRşPreston000016France#009ş0c2COşCorse00001AColorado#057ş0c2JAşJackson000018Montana#027ş0c2FEşFergus00001ESouthDakota#095ş0c2MLşMellette00001BAlabama#073ş0c2JEşJefferson00002BIndia#001ş0c2ANşAndaman and Nicobar Islands000019Asia#025ş0c2KGşKyrgyzstan000016Utah#009ş0c2DAşDaggett000015Texas#305ş0c2LYNşLynn00001BLouisiana#049ş0c2JAşJackson000019Georgia#113ş0c2FYşFayette000021WorldwithCountries#191ş0c2IZşIraq00001CMinnesota#165ş0c2WTşWatonwan000019Kentucky#149ş0c2MLşMcLean00001CMichigan#159ş0c2VBşVan Buren000019Florida#077ş0c2LIşLiberty00001DMississippi#059ş0c2JAşJackson000029NewCaledonia#NC.SU.NOş0c2NOşNoum&eacute;a00002DMadagascarRegions#MG.TM.ANş0c2ANşAnalanjirofo000027Hungary#09ş0c2GMşGy&#337;r-Moson-Sopron000019NewWorld#85ş0c2TNşTunisia000024USANorthEastRegion#21ş0c2KYşKentucky000026DominicanRepublic#01ş0c2AZş&Aacute;zua000024SaintLucia#09ş0c2SOşSoufri&egrave;re000022WorldwithCountries#33ş0c2GYşGuyana000021Egypt_346255#18ş0c2NSşNorth Sinai000025Azerbaijan#28ş0c2LCşLa&ccedil;&#305;n00001BUkraine#10ş0c2KHşKirovohrad00001ALatvia#06ş0c2DAşDaugavpils000024NorthEuropeanRegion#03ş0c2FIşFinland00002BAsiaGeorgia#11ş0c2SZşSamegrelo-Zemo Svaneti00001EGreece#07ş0c2IOşIonian Islands00001FSouthAfrica#10ş0c2NWşNorth West000013Japan#1ş0c2AIşAichi000021Lesotho#LS.MHş0c2MHşMohale's Hoek000028Zimbabwe#ZW.MCş0c2MCşMashonaland Central000020Russia#RU.NOş0c2NOşNorth Ossetia000019Tunisia#TN.TUş0c2TUşTunis00001DMalawi#MW.CRş0c2CRşChiradzulu00001FEngland#046ş0c2IWşIsle of Wight00001DTennessee#147ş0c2RBşRobertson00001CMaryland#005ş0c2BLşBaltimore000025France#010ş0c2FRşFranche-Comt&eacute;000019Oklahoma#099ş0c2MUşMurray000019Iowa#151ş0c2PCşPocahontas00001AWisconsin#041ş0c2FOşForest00001ATexas#487ş0c2WIBşWilbarger00001EIndia#002ş0c2APşAndhra Pradesh00001AWashington#001ş0c2ADşAdams000013Asia#026ş0c2LAşLaos000017Indiana#103ş0c2MIşMiami000018NewYork#075ş0c2OSşOswego000022NorthCarolina#143ş0c2PRşPerquimans000018Virginia#045ş0c2CGşCraig000018Georgia#295ş0c2WKşWalker000016Kansas#097ş0c2KWşKiowa000020SouthCarolina#069ş0c2MRşMarlboro000019Illinois#133ş0c2MEşMonroe000019Missouri#053ş0c2COşCooper000023WorldwithCountries#192ş0c2IEşIsrael00001DNorthDakota#067ş0c2PEşPembina000018Texas#125ş0c2DICşDickens000017Ohio#087ş0c2LWşLawrence000019NewMexico#059ş0c2UNşUnion000018Nebraska#057ş0c2DNşDundy00002AYukonTerritory#CA.YT.STş0c2STşSilver Trail000030MadagascarRegions#MG.TM.AOş0c2AOşAlaotra-Mangoro000023Hungary#10ş0c2HBşHajd&uacute;-Bihar000018NewWorld#86ş0c2UGşUganda000015Turkey#31ş0c2HTşHatay000023DominicanRepublic#02ş0c2BRşBahoruco00001ESaintLucia#10ş0c2VFşVieux Fort000024WorldwithCountries#34ş0c2PYşParaguay000020Afghanistan#01ş0c2BDSşBadakhshan00001FEgypt_346255#19ş0c2PSşPort Said000026Azerbaijan#29ş0c2LNşL&#601;nk&#601;ran000017Ukraine#11ş0c2KRşCrimea000022Latvia#07ş0c2DGVşDaugavpils (city)000024NorthEuropeanRegion#04ş0c2ISşIceland00001CAsiaGeorgia#12ş0c2TBşTbilisi000013Haiti#09ş0c2NDşNord00001CGreece#08ş0c2NAşNorth Aegean000021SouthAfrica#11ş0c2WCşWestern Cape000013Japan#2ş0c2AKşAkita000023Pakistan#PK.NAş0c2NAşNorthern Areas000020CapeVerde#CV.SFş0c2SFşSao Filipe00001ANigeria#NG.JIş0c2JIşJigawa000017Jordan#JO.MNş0c2MNşMaan000020Zambia#ZM.NWş0c2NWşNorth-Western000025CentralAmerica2#CE.LCş0c2LCşSt. Lucia000018Laos#LA.SLş0c2SLşSalavan00001DPennsylvania#027ş0c2CEşCentre00001AArkansas#051ş0c2GAşGarland00001AEngland#047ş0c2WSşW.Sussex00001DWestVirginia#079ş0c2PUşPutnam00001EFrance#011ş0c2LLşIle-de-France00001CColorado#059ş0c2JEşJefferson00001AMontana#029ş0c2FLşFlathead00001BSouthDakota#097ş0c2MIşMiner000017Alabama#075ş0c2LAşLamar000021India#003ş0c2ARşArunachal Pradesh000014Utah#011ş0c2DVşDavis00001ATexas#307ş0c2MCUşMcCulloch00001DLouisiana#051ş0c2JEşJefferson000021Virginia#770ş0c2ROşRoanoke (City)000017Georgia#115ş0c2FLşFloyd000023WorldwithCountries#193ş0c2JOşJordan00001AMinnesota#167ş0c2WLşWilkin00001CNevada#510ş0c2CAşCarson City00001AKentucky#151ş0c2MIşMadison00001CMichigan#161ş0c2WAşWashtenaw000019Florida#079ş0c2MSşMadison00001CMississippi#061ş0c2JSşJasper000016Hungary#11ş0c2HEşHeves000020NewWorld#87ş0c2WAşWestern Sahara000016Turkey#32ş0c2ICşMersin000021USANorthEastRegion#23ş0c2MEşMaine000023DominicanRepublic#03ş0c2BHşBarahona00001BSaintLucia#11ş0c2PRşPraslin000020WorldwithCountries#35ş0c2PEşPeru00001DAfghanistan#02ş0c2BDGşBadghis00001EEgypt_346255#20ş0c2QAşQalyubia00002DAzerbaijan#30ş0c2LAşL&#601;nk&#601;ran (City)000016Latvia#08ş0c2DOşDobele000024NorthEuropeanRegion#05ş0c2IEşIreland000017Haiti#10ş0c2NEşNord-Est00001BArmenia#01ş0c2AGşAragatsotn00001BGreece#09ş0c2PEşPeloponnese000014Japan#3ş0c2AOşAomori000021Thailand#TH.MHş0c2MHşMae Hong Son00001FCambodia#KH.ROş0c2ROşRatanakiri00001CBurkinaFaso#BF.IOş0c2IOşIoba00001BPanama#PA.CHş0c2CHşChiriqui000031CentralAmerica2#CE.KNş0c2KNşSt. Kitts &amp; Nevis00001BAngola#AO.BGş0c2BGşBenguela000018Uganda#UG.YUş0c2YUşYumbe000025Zimbabwe#ZW.MEş0c2MEşMashonaland East00001AMalawi#MW.CTş0c2CTşChitipa00001DEngland#048ş0c2EYşE.Yorkshire00001ETennessee#149ş0c2RUşRutherford000025France#012ş0c2LAşLanguedoc-Roussillon00001BOklahoma#101ş0c2MKşMuskogee000013Iowa#153ş0c2POşPolk000019Wisconsin#043ş0c2GRşGrant000018Texas#489ş0c2WIAşWillacy000015India#004ş0c2ASşAssam00001BWashington#003ş0c2ASşAsotin000017Asia#028ş0c2MYşMalaysia000018Indiana#105ş0c2MOşMonroe000018NewYork#077ş0c2OGşOtsego00001ENorthCarolina#145ş0c2POşPerson00001BVirginia#047ş0c2CUşCulpeper000018Georgia#297ş0c2WNşWalton000018Kansas#099ş0c2LBşLabette000020SouthCarolina#071ş0c2NBşNewberry00001DIllinois#135ş0c2MYşMontgomery00001BMissouri#055ş0c2CFşCrawford000023WorldwithCountries#194ş0c2KUşKuwait00001CNorthDakota#069ş0c2PIşPierce000017Texas#127ş0c2DIMşDimmit00001DDenmark#001ş0c2ARş&Aring;rhus000022Virginia#590ş0c2DAşDanville (City)000016Ohio#089ş0c2LIşLicking00001CNewMexico#061ş0c2VAşValencia00001BNebraska#059ş0c2FIşFillmore000026YukonTerritory#CA.YT.CAş0c2CAşCampbell000029Hungary#12ş0c2KEşKom&aacute;rom-Esztergom000018NewWorld#88ş0c2ZMşZambia000017Turkey#33ş0c2IPşIsparta000024USANorthEastRegion#24ş0c2MDşMaryland000029DominicanRepublic#04ş0c2DAşDajab&oacute;n000016UAE#01ş0c2AZşAbu Dhabi000024WorldwithCountries#36ş0c2SRşSuriname000013USA#KSş0c2KSşKansas00001DAfghanistan#03ş0c2BGLşBaghlan00001AEgypt_346255#21ş0c2QEşQena000019Azerbaijan#31ş0c2LEşLerik00001CUkraine#13ş0c2KVşKiev Oblast000017Latvia#09ş0c2GUşGulbene000023NorthEuropeanRegion#06ş0c2LVşLatvia000014Haiti#11ş0c2OUşOuest000017Armenia#02ş0c2ARşArarat00001CGreece#10ş0c2SAşSouth Aegean000026PolandCounties#PL.WN.OMş0c2WOMşOlsztyn000013Japan#4ş0c2CHşChiba00001BSriLanka#LK.JAş0c2JAşJaffna00001ELesotho#LS.MKş0c2MKşMokhotlong000016Nepal#NP.SEş0c2SEşSeti000023PapuaNewGuinea#PG.NOş0c2NOşNorthern00001CMongolia#MN.SLş0c2SLşSelenge00001BTanzania#TZ.ASş0c2ASşArusha00001EPennsylvania#029ş0c2CHşChester000018Arkansas#053ş0c2GRşGrant00001DEngland#049ş0c2SYşS.Yorkshire00001EWestVirginia#081ş0c2RAşRaleigh000019France#013ş0c2LIşLimousin000018Colorado#061ş0c2KIşKiowa00001AMontana#031ş0c2GAşGallatin00001FSouthDakota#099ş0c2MNşMinnehaha00001CAlabama#077ş0c2LUşLauderdale000015India#005ş0c2BIşBihar000017Utah#013ş0c2DUşDuchesne000019Texas#309ş0c2MCLşMcLennan000023Louisiana#053ş0c2JDşJefferson Davis000019Georgia#117ş0c2FOşForsyth000024WorldwithCountries#195ş0c2LBşLebanon00001AMinnesota#169ş0c2WIşWinona00001ADenmark#002ş0c2BOşBornholm00001BKentucky#153ş0c2MGşMagoffin000018Michigan#163ş0c2WYşWayne000019Florida#081ş0c2MNşManatee00001FMississippi#063ş0c2JEşJefferson000026MadagascarRegions#MG.MA.BOş0c2BOşBoeny00001ANewWorld#89ş0c2ZWşZimbabwe00001DTurkey#34ş0c2IBş&#304;stanbul000029USANorthEastRegion#25ş0c2MAşMassachusetts000012UAE#02ş0c2AJşAjman000023WorldwithCountries#37ş0c2UYşUruguay00001ECentralAmerica#01ş0c2BHşBelize00001DEgypt_346255#22ş0c2RSşRed Sea000020Azerbaijan#32ş0c2MAşMasall&#305;000018Ukraine#14ş0c2LHşLuhansk00001ELatvia#10ş0c2JKşJ&#275;kabpils000026NorthEuropeanRegion#07ş0c2LTşLithuania000012Haiti#12ş0c2SDşSud000018Armenia#03ş0c2AVşArmavir000018Greece#11ş0c2THşThessaly000013Japan#5ş0c2EHşEhime00001AChina2#CN.JXş0c2JXşJiangxi00001FEurope2#EU.CHş0c2CHşSwitzerland000016Angola#AO.BIş0c2BIşBie00001BBurundi#BI.CAş0c2CAşCankuzo00001ERussia#RU.NSş0c2NSşNovosibirsk000020CoteDivoire#CI.FRş0c2FRşFromager000019Uganda#UG.IBş0c2IBşIbanda000017Libya#LY.NLş0c2NLşNalut00001DEngland#050ş0c2WYşW.Yorkshire000019Tennessee#151ş0c2SCşScott00001AMaryland#009ş0c2CAşCalvert000019France#014ş0c2LOşLorraine000018Oklahoma#103ş0c2NOşNoble00001CIowa#155ş0c2PTşPottawattamie000019Wisconsin#045ş0c2GEşGreen00001BTexas#491ş0c2WIMşWilliamson00001BWashington#005ş0c2BEşBenton000017Asia#030ş0c2MNşMongolia00001CIndiana#107ş0c2MNşMontgomery000018NewYork#079ş0c2PUşPutnam00001CNorthCarolina#147ş0c2PIşPitt00001DVirginia#049ş0c2CMşCumberland000016Georgia#299ş0c2WAşWare000015Kansas#101ş0c2LEşLane00001ESouthCarolina#073ş0c2OCşOconee000019Illinois#137ş0c2MGşMorgan000017Missouri#057ş0c2DDşDade000021WorldwithCountries#196ş0c2OMşOman00001CNorthDakota#071ş0c2RAşRamsey000017Texas#129ş0c2DONşDonley00001FDenmark#003ş0c2FRşFrederiksberg000014Ohio#091ş0c2LOşLogan00001BNebraska#061ş0c2FRşFranklin000025Hungary#14ş0c2NOşN&oacute;gr&aacute;d000018NewWorld#90ş0c2GMşGambia00001ATurkey#35ş0c2IZş&#304;zmir000024USANorthEastRegion#26ş0c2MIşMichigan000021DominicanRepublic#06ş0c2DUşDuarte000012UAE#03ş0c2DUşDubai000025WorldwithCountries#38ş0c2VEşVenezuela00001AUSA#MAş0c2MAşMassachusetts000022CentralAmerica#02ş0c2CSşCosta Rica00001CAfghanistan#05ş0c2BAMşBamyan00001DEgypt_346255#23ş0c2SQşSharqia00002AAzerbaijan#33ş0c2MIşMing&#601;&ccedil;evir000015Ukraine#15ş0c2LVşLviv000017Latvia#11ş0c2JLşJelgava000023NorthEuropeanRegion#08ş0c2NOşNorway000016Haiti#13ş0c2SEşSud-Est00001CCzechRepublic#52ş0c2PRşPraha00001CArmenia#04ş0c2GRşGegharkunik00001BGreece#12ş0c2WGşWest Greece000013Japan#6ş0c2FUşFukui000018Thailand#TH.NAş0c2NAşNan000023Madagascar#MG.FIş0c2FIşFianarantsoa00001BMacedonia#MK.ZAş0c2ZAşZajas000025Mississippi#065ş0c2JDşJefferson Davis00001EPennsylvania#031ş0c2CIşClarion000019Arkansas#055ş0c2GEşGreene00001FWestVirginia#083ş0c2RNşRandolph00002CFrance#015ş0c2MIşMidi-Pyr&eacute;n&eacute;es00001DColorado#063ş0c2KCşKit Carson00001AMontana#033ş0c2GRşGarfield00001BSouthDakota#101ş0c2MOşMoody00001AAlabama#079ş0c2LWşLawrence00001CIndia#007ş0c2CAşChhattisgarh000014Asia#031ş0c2NPşNepal000014Utah#015ş0c2EMşEmery000019Texas#311ş0c2MCMşMcMullen00001DLouisiana#055ş0c2LAşLafayette00001AGeorgia#119ş0c2FRşFranklin000022WorldwithCountries#197ş0c2QAşQatar00001AMinnesota#171ş0c2WRşWright00001FDenmark#004ş0c2FEşFrederiksborg000019Kentucky#155ş0c2MHşMarion00001AMichigan#165ş0c2WEşWexford000018Florida#083ş0c2MRşMarion000026NewCaledonia#NC.SU.PAş0c2PAşPa&iuml;ta000017NewWorld#91ş0c2CGşCongo000015UAE#04ş0c2FUşFujairah000023WorldwithCountries#39ş0c2DZşAlgeria000023CentralAmerica#03ş0c2ESşEl Salvador00001BAfghanistan#06ş0c2FRAşFarah00001BEgypt_346255#24ş0c2SHşSohag000021Azerbaijan#34ş0c2NAşNaftalan city000019Ukraine#16ş0c2MYşMykolaiv00001FLatvia#12ş0c2JELşJelgava (city)00002BNorthEuropeanRegion#09ş0c2UKşUnited Kingdom000019Haiti#14ş0c2GAşGrand'Anse000017Armenia#05ş0c2KTşKotayk00001EGreece#13ş0c2WMşWest Macedonia000027PolandCounties#PL.ZP.SMş0c2ZSMşSzczecin000015Japan#7ş0c2FKşFukuoka00001BTunisia#TN.BZş0c2BZşBizerte000021FranceDepartment#FR.JUş0c2JUşJura00002DFranceDepartment#FR.LAş0c2LAşLoire Atlantique000025Thailand#TH.NBş0c2NBşNong Bua Lam Phu000022Europe2#EU.UKş0c2UKşUnited Kingdom000020Europe2#EU.VAş0c2VAşVatican City00001ECambodia#KH.SIş0c2SIşSiem Reap000019Ghana#GH.WPş0c2WPşWestern000032DemocraticRepublicoftheCongo#CD.NKş0c2NKşNord-Kivu000019Namibia#NA.KAş0c2KAşKaras00001ANigeria#NG.KDş0c2KDşKaduna00001BComoros #KM.MOş0c2MOşMoheli000018Panama#PA.CLş0c2CLşColon00001ECoteDivoire#CI.ZAş0c2ZAşZanzan00001DZimbabwe#ZW.MIş0c2MIşMidlands000025Philippines#PH.ESş0c2ESşEastern Samar000024Burundi#BI.BMş0c2BMşBujumbura Mairie00001BNebraska#063ş0c2FOşFrontier00001ETennessee#153ş0c2SQşSequatchie00001BMaryland#011ş0c2CRşCaroline000023France#016ş0c2NOşNord-Pas-de-Calais000019Oklahoma#105ş0c2NWşNowata000018Iowa#157ş0c2PWşPoweshiek00001EWisconsin#047ş0c2GLşGreen Lake000017Texas#493ş0c2WILşWilson00001BWashington#007ş0c2CHşChelan000018Indiana#109ş0c2MGşMorgan000018NewYork#081ş0c2QUşQueens00001CNorthCarolina#149ş0c2PLşPolk00001CVirginia#051ş0c2DIşDickenson000018Georgia#301ş0c2WRşWarren00001CKansas#103ş0c2LVşLeavenworth000022SouthCarolina#075ş0c2ORşOrangeburg00001FVirginia#775ş0c2SAşSalem (City)00001BIllinois#139ş0c2MTşMoultrie000019Missouri#059ş0c2DLşDallas000029WorldwithCountries#198ş0c2SAşSaudi Arabia00001CNorthDakota#073ş0c2RNşRansom000016Texas#131ş0c2DUVşDuval000015Denmark#005ş0c2FYşFyn000015Ohio#093ş0c2LRşLorain000015Hungary#16ş0c2PEşPest00001BNewWorld#92ş0c2MIşMauritius000019Turkey#37ş0c2KSşKastamonu000024DominicanRepublic#08ş0c2ESşEspaillat00001BUAE#05ş0c2RKşRas Al Khaimah000022WorldwithCountries#40ş0c2AOşAngola000021CentralAmerica#04ş0c2GTşGuatemala00001CWorld#SAş0c2SAşSouth America000018Andorra#02ş0c2CAşCanillo00001CAfghanistan#07ş0c2FYBşFaryab000021Egypt_346255#25ş0c2SSşSouth Sinai00003DAzerbaijan#35ş0c2NXşNax&ccedil;&#305;van &#350;&#601;h&#601;r000017Ukraine#17ş0c2ODşOdessa000024Latvia#13ş0c2JURşJ&#363;rmala (city)000023NorthEuropeanRegion#10ş0c2SEşSweden000015Haiti#15ş0c2NIşNippes000015Armenia#06ş0c2LOşLori000024FrenchGuiana#GF.CY.IRş0c2IRşIracoubo000017Japan#8ş0c2FSşFukushima000019CapeVerde#CV.SLş0c2SLşSal000019Nigeria#NG.KEş0c2KEşKebbi000019Ghana#GH.EPş0c2EPşEastern000018Niger#NE.ZIş0c2ZIşZinder00001ATanzania#TZ.TNş0c2TNşTanga000029PapuaNewGuinea#PG.NSş0c2NSşNorth Solomons00001AAngola#AO.CBş0c2CBşCabinda000018Russia#RU.OLş0c2OLşOryal000018Uganda#UG.HOş0c2HOşHoima000017Malawi#MW.DOş0c2DOşDowa000021Virginia#595ş0c2EMşEmporia (City)000018Florida#085ş0c2MAşMartin00001BMississippi#067ş0c2JOşJones000021Pennsylvania#033ş0c2CLşClearfield00001CArkansas#057ş0c2HEşHempstead00001EWestVirginia#085ş0c2RIşRitchie000020France#017ş0c2NRşBasse-Normandie000017Colorado#065ş0c2LAşLake000019Montana#035ş0c2GCşGlacier000020SouthDakota#103ş0c2PEşPennington000015Alabama#081ş0c2LEşLee000017Asia#033ş0c2PKşPakistan000017Utah#017ş0c2GAşGarfield000018Texas#313ş0c2MADşMadison00001BOceania#001ş0c2AUşAustralia00001DLouisiana#057ş0c2LFşLafourche000018Georgia#121ş0c2FUşFulton000022WorldwithCountries#199ş0c2SYşSyria000023Minnesota#173ş0c2YMşYellow Medicine000027Denmark#006ş0c2KOşK&oslash;benhavns Amt00001BKentucky#157ş0c2MSşMarshall00002DSaskatchewan#CA.SK.SEş0c2SEşSouth East Region000017Hungary#17ş0c2SOşSomogy00001DNewWorld#93ş0c2AFşAfghanistan000017Turkey#38ş0c2KYşKayseri000025Australia2#WAş0c2WAşWestern Australia000028DominicanRepublic#09ş0c2INşIndependencia000014UAE#06ş0c2SHşSharjah000021WorldwithCountries#41ş0c2BJşBenin000015USA#MDş0c2MDşMaryland000020CentralAmerica#05ş0c2HOşHonduras000017Andorra#03ş0c2ENşEncamp00001CAfghanistan#08ş0c2GHAşGhazni00001AEgypt_346255#26ş0c2SZşSuez000023Azerbaijan#36ş0c2NEşNeft&ccedil;ala000018Ukraine#18ş0c2PLşPoltava00001DLatvia#14ş0c2KRşKr&#257;slava00001ABolivia#01ş0c2HşChuquisaca000017Armenia#07ş0c2SHşShirak00002CDistrictofColumbia#US.DC.NEş0c2NEşNorth East000012Japan#9ş0c2GIşGifu000018Cameroon#CM.SUş0c2SUşSud000029FranceDepartment#FR.LCş0c2LCşLoir et Cher000019Syria#SY.LAş0c2LAşLatakia00001ACambodia#KH.TAş0c2TAşTakeo000020CapeVerde#CV.SMş0c2SMşSao Miguel000021Mauritius#MU.BLş0c2BLşBlack River00001FBurkinaFaso#BF.KAş0c2KAşKadiogo00001AAlgeria#DZ.GLş0c2GLşGuelma000021Angola#AO.CCş0c2CCşCuando Cubango00001DUzbekistan#UZ.BUş0c2BUşBuxoro00001DSerbia#RS.PZş0c2PZşPrizrenski000017Russia#RU.OMş0c2OMşOmsk000018Libya#LY.MZş0c2MZşMizdah000014Ohio#095ş0c2LUşLucas00001CFlorida#086ş0c2DAşMiami-Dade000019Nebraska#065ş0c2FUşFurnas00001ATennessee#155ş0c2SBşSevier000014UK#001ş0c2ENşEngland00001AMaryland#013ş0c2COşCarroll000021France#018ş0c2PDşPays de la Loire00001BOklahoma#107ş0c2OKşOkfuskee000017Iowa#159ş0c2RGşRinggold000018Wisconsin#049ş0c2IOşIowa000018Texas#495ş0c2WINşWinkler000015India#010ş0c2DEşDelhi00001CWashington#009ş0c2CMşClallam00001AAsia#034ş0c2PHşPhilippines000018Indiana#111ş0c2NEşNewton00001CNewYork#083ş0c2REşRensselaer000020NorthCarolina#151ş0c2RAşRandolph00001CVirginia#053ş0c2DNşDinwiddie00001CGeorgia#303ş0c2WGşWashington000018Kansas#105ş0c2LCşLincoln00001FSouthCarolina#077ş0c2PIşPickens000016Oceania#002ş0c2FJşFiji000017Illinois#141ş0c2OGşOgle00001AMissouri#061ş0c2DAşDaviess00002FWorldwithCountries#200ş0c2AEşUnitedArabEmirates00001ENorthDakota#075ş0c2RVşRenville000019Texas#133ş0c2EASşEastland000022Denmark#007ş0c2KBşK&oslash;benhavn00001FNewCaledonia#NC.NO.VOş0c2VOşVoh00002EHungary#18ş0c2SZşSzabolcs-Szatm&aacute;r-Bereg000019NewWorld#94ş0c2AMşArmenia00001FTurkey#39ş0c2KLşK&#305;rklareli000028DominicanRepublic#10ş0c2ALşLa Altagracia00001AUAE#07ş0c2UQşUmm Al Quwain000024WorldwithCountries#42ş0c2BWşBotswana000015USA#KYş0c2KYşKentucky000012USA#MEş0c2MEşMaine000021CentralAmerica#06ş0c2NUşNicaragua00001BAndorra#04ş0c2LMşLa Massana00001BAfghanistan#09ş0c2GHOşGhowr00001BEgypt_346255#27ş0c2LXşLuxor00001DAzerbaijan#37ş0c2OGşO&#287;uz000016Ukraine#19ş0c2RVşRivne00001CLatvia#15ş0c2KUşKuld&#299;ga00001ABolivia#02ş0c2CşCochabamba000017Armenia#08ş0c2SUşSyunik000026PolandCounties#PL.MZ.SMş0c2MSMşSiedlce000023FranceDepartment#FR.LDş0c2LDşLandes000021CapeVerde#CV.SNş0c2SNşSao Nicolau00001FCambodia#KH.BAş0c2BAşBattambang00001CMacedonia#MK.ZEş0c2ZEşZelino000016Chad#TD.KAş0c2KAşKanem000022Guyana#GY.MAş0c2MAşMahaica-Berbice000030HungaryRegions#HU.STş0c2STşSouthern Transdanubia000023Libya#LY.NQş0c2NQşAn Nuqat al Khams000018Florida#087ş0c2MOşMonroe00001CMississippi#069ş0c2KEşKemper00001EPennsylvania#035ş0c2CNşClinton00001DArkansas#059ş0c2HSşHot Spring00001CWestVirginia#087ş0c2ROşRoane000015UK#002ş0c2SCşScotland000019France#019ş0c2PIşPicardie00001BColorado#067ş0c2LPşLa Plata00001FMontana#037ş0c2GVşGolden Valley00001DSouthDakota#105ş0c2PRşPerkins00001BAlabama#083ş0c2LIşLimestone000013India#011ş0c2GOşGoa000014Utah#019ş0c2GRşGrand000017Texas#315ş0c2MARşMarion00001AOceania#003ş0c2KIşKiribati00001CLouisiana#059ş0c2LSşLa Salle000018Georgia#123ş0c2GIşGilmer000022WorldwithCountries#201ş0c2YMşYemen00001DDenmark#008ş0c2NOşNordjylland000019Kentucky#159ş0c2MTşMartin00002AMadagascarRegions#MG.AV.BNş0c2BNşBongolava000017Armenia#09ş0c2TVşTavush00001CNewWorld#95ş0c2AZşAzerbaijan000022Turkey#40ş0c2KHşK&#305;r&#351;ehir000033DominicanRepublic#11ş0c2EPşEl&iacute;as Pi&ntilde;a000028WorldwithCountries#43ş0c2BFşBurkina Faso000017Sweden#02ş0c2KşBlekinge00001ECentralAmerica#07ş0c2PMşPanama000017Andorra#05ş0c2ORşOrdina00001DAfghanistan#10ş0c2HELşHelmand00001CEgypt_346255#28ş0c2HWşHelwan000029Azerbaijan#38ş0c2QAşQ&#601;b&#601;l&#601;00001CLatvia#16ş0c2LEşLiep&#257;ja000017Bolivia#03ş0c2BşEl Beni00001ECameroon#CM.SWş0c2SWşSud-Ouest00001EVietnam#VN.NTş0c2NTşNinh Thuan000017Nauru#NR.NIş0c2NIşNibok000022Thailand#TH.NFş0c2NFşNakhon Phanom000018Angola#AO.BOş0c2BOşBengo000019Nepal#NP.BAş0c2BAşBagmati000017Russia#RU.PEş0c2PEşPerm00001EMongolia#MN.ARş0c2ARşArkhangai000021Mongolia#MN.BHş0c2BHşBayankhongor000017Laos#LA.ATş0c2ATşAttapu000016Denmark#009ş0c2RIşRibe000016Ohio#097ş0c2MAşMadison000017Nebraska#067ş0c2GAşGage00001ATennessee#157ş0c2SHşShelby00001AUK#003ş0c2NIşNorth Ireland000018Maryland#015ş0c2CEşCecil000021France#020ş0c2PCşPoitou-Charentes00001BOklahoma#109ş0c2OLşOklahoma000012Iowa#161ş0c2SAşSac000018Wisconsin#051ş0c2IRşIron000015Texas#497ş0c2WISşWise000017India#012ş0c2GUşGujarat00001AWashington#011ş0c2CAşClark000021Asia#036ş0c2RUşRussian Federation000017Indiana#113ş0c2NOşNoble00001ANewYork#085ş0c2RIşRichmond000020NorthCarolina#153ş0c2RIşRichmond000017Georgia#305ş0c2WYşWayne000015Kansas#107ş0c2LNşLinn000020SouthCarolina#079ş0c2RIşRichland000022Oceania#004ş0c2MHşMarshall Islands000019Illinois#143ş0c2PEşPeoria000019Missouri#063ş0c2DKşDeKalb000028WorldwithCountries#202ş0c2PRşPuerto Rico00001ENorthDakota#077ş0c2RIşRichland000016Texas#135ş0c2ECTşEctor00001CArmenia#10ş0c2VDşVayots Dzor00002CCentralAmericawithCaribbeans#01ş0c2BHşBelize00002CHungary#20ş0c2JNşJ&aacute;sz-Nagykun-Szolnok00001CNewWorld#96ş0c2BDşBangladesh000017Turkey#41ş0c2KCşKocaeli000024DominicanRepublic#12ş0c2ROşLa Romana000023WorldwithCountries#44ş0c2BIşBurundi00001DSweden#03ş0c2XşG&auml;vleborg000032Andorra#06ş0c2SJşSant Juli&agrave; de L&ograve;ria00001BAfghanistan#11ş0c2HERşHerat000024Egypt_346255#29ş0c2SOş6th of October000017Azerbaijan#39ş0c2QXşQax000015Ukraine#21ş0c2SMşSumy000024Latvia#17ş0c2LPXşLiep&#257;ja (city)000016Bolivia#04ş0c2LşLa Paz000018China2#CN.MAş0c2MAşMacao00001ECapeVerde#CV.TFş0c2TFşTarrafal000016Mali#ML.KYş0c2KYşKayes00001BEurope2#EU.BYş0c2BYşBelarus00001BEurope2#EU.DEş0c2DEşGermany00001ALesotho#LS.MSş0c2MSşMaseru00001CLaos#LA.SVş0c2SVşSavannakhet000023Macedonia#MK.GPş0c2GPşGjorce Petrov000027Zimbabwe#ZW.MNş0c2MNşMatabeleland North00001ABurundi#BI.BRş0c2BRşBururi00001DRussia#RU.NZş0c2NZşNizhegorod000016Laos#LA.BKş0c2BKşBokeo000024Denmark#010ş0c2RNşRingkj&oslash;bing000018Kentucky#161ş0c2MOşMason000018Florida#089ş0c2NAşNassau00001FMississippi#071ş0c2LAşLafayette00001FPennsylvania#037ş0c2COşColumbia000019Arkansas#061ş0c2HWşHoward00001EWestVirginia#089ş0c2SUşSummers000012UK#004ş0c2WAşWales000031France#021ş0c2PRşProvence-Alpes-C&ocirc;te D'Azur00001AColorado#069ş0c2LRşLarimer000019Montana#039ş0c2GNşGranite00001CSouthDakota#107ş0c2POşPotter000019Alabama#085ş0c2LOşLowndes000017India#013ş0c2HAşHaryana000013Utah#021ş0c2IRşIron000017Texas#317ş0c2MATşMartin00001COceania#005ş0c2FMşMicronesia00001BLouisiana#061ş0c2LIşLincoln00001AGeorgia#125ş0c2GLşGlascock00002BWorldwithCountries#203ş0c2KYşCayman Islands000018Armenia#11ş0c2ERşYerevan000030CentralAmericawithCaribbeans#02ş0c2CSşCosta Rica000016Hungary#21ş0c2TOşTolna000018NewWorld#97ş0c2BTşBhutan000029USANorthEastRegion#33ş0c2NHşNew Hampshire000024WorldwithCountries#45ş0c2CMşCameroon000021Andorra#07ş0c2ALşAndorra la Vella000019Azerbaijan#40ş0c2QZşQazax000019Ukraine#22ş0c2TPşTernopil00001CLatvia#18ş0c2LMşLimba&#382;i000015Bolivia#05ş0c2OşOruro00002BFranceDepartment#FR.LGş0c2LGşLot et Garonne000025DenmarkRegion#DK.HSş0c2HSşHovenstaden00001FBurma#MM.RAş0c2RAşRakhine State00001CBurundi#BI.CIş0c2CIşCibitoke00001CLaos#LA.BLş0c2BLşBolikhamxai00001ADenmark#011ş0c2ROşRoskilde000021Virginia#600ş0c2FAşFairfax (City)000017Ohio#099ş0c2MHşMahoning000019Nebraska#069ş0c2GRşGarden000019Tennessee#159ş0c2SMşSmith00001AMaryland#017ş0c2CHşCharles000022France#022ş0c2RHşRh&ocirc;ne-Alpes000021SpainProvinces#001ş0c2ABşAlbacete00001BOklahoma#111ş0c2OMşOkmulgee000014Iowa#163ş0c2SCşScott00001BWisconsin#053ş0c2JAşJackson000015Texas#499ş0c2WODşWood000020India#014ş0c2HPşHimachal Pradesh00001DWashington#013ş0c2CLşColumbia000018Asia#038ş0c2SGşSingapore000016Indiana#115ş0c2OHşOhio00001ANewYork#087ş0c2ROşRockland00001FNorthCarolina#155ş0c2ROşRobeson000018Virginia#057ş0c2ESşEssex000019Georgia#307ş0c2WSşWebster000016Kansas#109ş0c2LGşLogan00001ESouthCarolina#081ş0c2SAşSaluda000017Oceania#006ş0c2NRşNauru000018Illinois#145ş0c2PRşPerry000017Missouri#065ş0c2DEşDent00001DNorthDakota#079ş0c2ROşRolette000018Texas#137ş0c2EDWşEdwards000026Denmark#012ş0c2SOşS&oslash;nderjylland000018Kentucky#163ş0c2MDşMeade00001AFlorida#091ş0c2OLşOkaloosa00001BMississippi#073ş0c2LMşLamar00001FPennsylvania#039ş0c2CWşCrawford00001FArkansas#063ş0c2INşIndependence00001DWestVirginia#091ş0c2TAşTaylor000020France#023ş0c2HNşHaute-Normandie000025SpainProvinces#002ş0c2ALş&Aacute;lava00001DColorado#071ş0c2LSşLas Animas000016Montana#041ş0c2HIşHill00001DSouthDakota#109ş0c2ROşRoberts000017Alabama#087ş0c2MAşMacon000021India#015ş0c2JKşJammu and Kashmir000018Asia#039ş0c2LKşSri Lanka000013Utah#023ş0c2JUşJuab000016Texas#319ş0c2MASşMason00001DOceania#007ş0c2NZşNew Zealand00001ELouisiana#063ş0c2LVşLivingston000017Georgia#127ş0c2GYşGlynn000024Germany#001ş0c2BAşBaden-Wuerttemberg000031CentralAmericawithCaribbeans#03ş0c2ESşEl Salvador000014Hungary#22ş0c2VAşVas000025EuropeRegion#01ş0c2NRşNorthern Region000018NewWorld#98ş0c2BNşBrunei00001CTurkey#43ş0c2KUşK&uuml;tahya000026USANorthEastRegion#34ş0c2NJşNew Jersey00003FDominicanRepublic#14ş0c2MTşMar&iacute;a Trinidad S&aacute;nchez000026WorldwithCountries#46ş0c2CVşCape Verde000015USA#MIş0c2MIşMichigan000016Sweden#05ş0c2IşGotland000023Andorra#08ş0c2EEşEscaldes-Engordany00001BAfghanistan#13ş0c2KABşKabul00001CAzerbaijan#41ş0c2QOşQobustan00001AUkraine#23ş0c2VIşVinnytsia000015Latvia#19ş0c2LUşLudza000015World#AFş0c2AFşAfrica000015Bolivia#06ş0c2NşPando000020SolomonIsland#SB.MKş0c2MKşMakira000022Thailand#TH.MSş0c2MSşMaha Sarakham000019Togo#TG.PLş0c2PLşPlateaux00001BCameroon#CM.CEş0c2CEşCentre00001ANamibia#NA.KHş0c2KHşKhomas000019Nigeria#NG.LAş0c2LAşLagos000017Angola#AO.UIş0c2UIşUige00002ACentralAmerica2#CE.KYş0c2KYşCayman Islands00001FMongolia#MN.UBş0c2UBşUlan Bator00001DMacedonia#MK.GRş0c2GRşGradsko000022Denmark#013ş0c2STşStorstr&oslash;m000015Ohio#101ş0c2MRşMarion00001BNebraska#071ş0c2GFşGarfield00001BTennessee#161ş0c2STşStewart00001DMaryland#019ş0c2DOşDorchester000021SpainProvinces#003ş0c2AIşAlicante000018Oklahoma#113ş0c2OSşOsage000015Iowa#165ş0c2SHşShelby00001DWisconsin#055ş0c2JEşJefferson000017Texas#501ş0c2YOAşYoakum000019India#016ş0c2JHşJharkhand00001CWashington#015ş0c2COşCowlitz000018Indiana#117ş0c2ORşOrange00001ENewYork#089ş0c2SLşSt. Lawrence000022NorthCarolina#157ş0c2RCşRockingham00001AVirginia#059ş0c2FIşFairfax000019Georgia#309ş0c2WEşWheeler000015Kansas#111ş0c2LYşLyon000023SouthCarolina#083ş0c2SPşSpartanburg000017Oceania#008ş0c2PWşPalau000018Illinois#147ş0c2PIşPiatt00001AMissouri#067ş0c2DOşDouglas000018Germany#002ş0c2BYşBayern00001DNorthDakota#081ş0c2SAşSargent000016Texas#139ş0c2ELIşEllis00003BPrinceEdwardIsland#CA.PE.PCş0c2PCşPoints East Coastal Drive00002FCentralAmericawithCaribbeans#04ş0c2GTşGuatemala000020Hungary#23ş0c2VEşVeszpr&eacute;m000025EuropeRegion#02ş0c2SRşSouthern Region000021NewWorld#99ş0c2MMşBurma (Myanmar)000017Turkey#44ş0c2MLşMalatya000027DominicanRepublic#15ş0c2MCşMonte Cristi000034WorldwithCountries#47ş0c2CPşCentral African Republic000016Sweden#06ş0c2NşHalland00001CAfghanistan#14ş0c2KAPşKapisa000018Azerbaijan#42ş0c2QBşQuba000016Ukraine#24ş0c2VOşVolyn000016Latvia#20ş0c2MAşMadona00001DBolivia#07ş0c2PşPotos&iacute;000024PolandCounties#PL.OP.OMş0c2OOMşOpole000026MarshallIsland#MH.MH.RLş0c2RLşRongelap000021SolomonIsland#SB.MLş0c2MLşMalaita00001BChina2#CN.LNş0c2LNşLiaoning00001CAlgeria#DZ.GRş0c2GRşGhardaia000018Liberia#LR.LFş0c2LFşLofa000025Sudan#SD.GZş0c2GZşAl Jazirah (Gezira)000017Yemen#YE.ABş0c2ABşAbyan000023Burundi#BI.BUş0c2BUşBujumbura Rural000031Guinea#GN.NZş0c2NZşNz&eacute;r&eacute;kor&eacute;000017Denmark#014ş0c2VEşVejle00001AKentucky#165ş0c2MEşMenifee00001CFlorida#093ş0c2OKşOkeechobee000020Mississippi#075ş0c2LUşLauderdale000021Pennsylvania#041ş0c2CUşCumberland000018Arkansas#065ş0c2IZşIzard00001DWestVirginia#093ş0c2TUşTucker000027SpainProvinces#004ş0c2AMşAlmer&iacute;a00001AColorado#073ş0c2LIşLincoln00001BMontana#043ş0c2JEşJefferson00001DSouthDakota#111ş0c2SAşSanborn000019Alabama#089ş0c2MDşMadison000019India#017ş0c2KAşKarnataka000019Asia#041ş0c2TJşTajikistan00001EAlaska#150ş0c2KOşKodiak Island000013Utah#025ş0c2KAşKane00001ATexas#321ş0c2MAGşMatagorda000022Oceania#009ş0c2PGşPapua New Guinea00001BLouisiana#065ş0c2MAşMadison000018Georgia#129ş0c2GOşGordon000018Germany#003ş0c2BEşBerlin00002ECentralAmericawithCaribbeans#05ş0c2HOşHonduras000015Hungary#24ş0c2ZAşZala000024EuropeRegion#03ş0c2WRşWestern Region000016Turkey#45ş0c2MNşManisa000024USANorthEastRegion#36ş0c2NYşNew York000025DominicanRepublic#16ş0c2PNşPedernales000020WorldwithCountries#48ş0c2TDşChad00001CSweden#07ş0c2ZşJ&auml;mtland000020Azerbaijan#43ş0c2QDşQubadl&#305;00001CUkraine#25ş0c2ZKşZakarpattia000014Latvia#21ş0c2OGşOgre00001ABolivia#08ş0c2SşSanta Cruz00001EThailand#TH.NKş0c2NKşNong Khai00001FCambodia#KH.SRş0c2SRşSvay Rieng00001AEurope2#EU.CSş0c2CSşSerbia000020Macedonia#MK.ZKş0c2ZKşZelenikovo000017Yemen#YE.SDş0c2SDşSadah00001DSamoa #WS.SAş0c2SAşSatupaitea00001EMacedonia#MK.GTş0c2GTşGostivar00001ESerbia#RS.SCş0c2SCşNorth Backa00001ENorthDakota#083ş0c2SHşSheridan000018Texas#141ş0c2ELPşEl Paso000024Denmark#015ş0c2VSşVestsj&aelig;lland000015Ohio#103ş0c2MEşMedina000019Nebraska#073ş0c2GOşGosper00001AMinnesota#001ş0c2AIşAitkin00001FConnecticut#001ş0c2FAşFairfield00001CTennessee#163ş0c2SLşSullivan00001CMaryland#021ş0c2FRşFrederick000021SpainProvinces#005ş0c2ASşAsturias000019Oklahoma#115ş0c2OTşOttawa000014Iowa#167ş0c2SIşSioux00001AWisconsin#057ş0c2JUşJuneau000016Texas#503ş0c2YOUşYoung000016India#018ş0c2KEşKerala00001CWashington#017ş0c2DOşDouglas000017Asia#042ş0c2THşThailand000016Indiana#119ş0c2OWşOwen00001ANewYork#091ş0c2SAşSaratoga00001DNorthCarolina#159ş0c2RWşRowan00001BVirginia#061ş0c2FUşFauquier000017Georgia#311ş0c2WTşWhite00001AKansas#113ş0c2MPşMcpherson00001ESouthCarolina#085ş0c2SUşSumter000017Oceania#010ş0c2WSşSamoa000017Illinois#149ş0c2PKşPike00001AMissouri#069ş0c2DUşDunklin00001DGermany#004ş0c2BRşBrandenburg000027MadagascarRegions#MG.TL.MEş0c2MEşMenabe00002FMadagascarRegions#MG.AV.VAş0c2VAşVakinankaratra00002FCentralAmericawithCaribbeans#06ş0c2NUşNicaragua000024EuropeRegion#04ş0c2ERşEastern Region000022Turkey#46ş0c2KMşKahramanmara&#351;000023WorldwithCountries#49ş0c2KMşComoros000022Sweden#08ş0c2FşJ&ouml;nk&ouml;ping000019Azerbaijan#44ş0c2QRşQusar00001BUkraine#26ş0c2ZPşZaporizhia00001BLatvia#22ş0c2PRşPrei&#316;i000016Bolivia#09ş0c2TşTarija000022SierraLeone#SL.SO.MOş0c2MOşMoyamba000027FrenchGuiana#GF.SL.GSş0c2GSşGrand Santi000033PolandCounties#PL.LD.PMş0c2LPMşPiotrkow Trybunalski000017Samoa #WS.AAş0c2AAşAana00002ABrazilRegion#BR.SEş0c2SEşSouth East Region00001ATuvalu#TV.NAş0c2NAşNanumea000018Nigeria#NG.KNş0c2KNşKano000018Mongolia#MN.TOş0c2TOşTov000027Zimbabwe#ZW.MSş0c2MSşMatabeleland South000020Serbia#RS.SDş0c2SDşCentral Banat000019Serbia#RS.RNş0c2RNşRasina000016Yemen#YE.ADş0c2ADşAdan000019Uganda#UG.INş0c2INşIganga000018Germany#005ş0c2BMşBremen000018Denmark#016ş0c2VIşViborg000019Kentucky#167ş0c2MCşMercer000018Florida#095ş0c2ORşOrange00001EMississippi#077ş0c2LWşLawrence00001EPennsylvania#043ş0c2DAşDauphin00001AArkansas#067ş0c2JAşJackson00001CWestVirginia#095ş0c2TYşTyler00001ESpainProvinces#006ş0c2AVşAvila000018Colorado#075ş0c2LOşLogan00001EMontana#045ş0c2JBşJudith Basin00001DSouthDakota#113ş0c2SHşShannon000019Alabama#091ş0c2MRşMarengo00001BIndia#019ş0c2LAşLakshadweep000016Utah#027ş0c2MIşMillard000019Texas#323ş0c2MAVşMaverick000021Oceania#011ş0c2SBşSolomon Islands00001DLouisiana#067ş0c2MOşMorehouse000017Georgia#131ş0c2GRşGrady00002CCentralAmericawithCaribbeans#07ş0c2PMşPanama000024EuropeRegion#05ş0c2CRşCentral Region000027DominicanRepublic#18ş0c2PPşPuerto Plata000029WorldwithCountries#50ş0c2CIşCote d Ivoire00001BUSA#NCş0c2NCşNorth Carolina000015Sweden#09ş0c2HşKalmar00001CAfghanistan#17ş0c2LOWşLowgar00001FAzerbaijan#45ş0c2STşSaatl&#305;000019Ukraine#27ş0c2ZTşZhytomyr00001CLatvia#23ş0c2REşR&#275;zekne000021SierraLeone#SL.EA.KEş0c2KEşKenema000025FranceDepartment#FR.MBş0c2MBşMorbihan000020Cambodia#KH.STş0c2STşStung Treng000021CapeVerde#CV.SVş0c2SVşSao Vicente00001CSriLanka#LK.KEş0c2KEşKegalle000018Nigeria#NG.KOş0c2KOşKogi00001BEurope2#EU.DKş0c2DKşDenmark000022BurkinaFaso#BF.KJş0c2KJşKomondjari00001FMacedonia#MK.GVş0c2GVşGevgelija000017Nepal#NP.BHş0c2BHşBheri000020Mongolia#MN.BOş0c2BOşBayan Olgii000017Guinea#GN.PIş0c2PIşPita000019Germany#006ş0c2HAşHamburg00001BNorthDakota#085ş0c2SIşSioux000016Texas#143ş0c2ERAşErath000014Ohio#105ş0c2MIşMeigs000018Nebraska#075ş0c2GTşGrant000019Minnesota#003ş0c2ANşAnoka00001EConnecticut#003ş0c2HAşHartford00001ATennessee#165ş0c2SUşSumner00001AMaryland#023ş0c2GAşGarrett000020SpainProvinces#007ş0c2BAşBadajoz000019Oklahoma#117ş0c2PAşPawnee000014Iowa#169ş0c2STşStory00001BWisconsin#059ş0c2KEşKenosha000017Texas#505ş0c2ZAPşZapata00001EIndia#020ş0c2MPşMadhya Pradesh00001AWashington#019ş0c2FEşFerry00001BAsia#044ş0c2TMşTurkmenistan000017Indiana#121ş0c2PAşParke00001DNewYork#093ş0c2SCşSchenectady000022NorthCarolina#161ş0c2RUşRutherford000018Virginia#063ş0c2FLşFloyd00001BGeorgia#313ş0c2WHşWhitfield000017Kansas#115ş0c2MNşMarion00001DSouthCarolina#087ş0c2UNşUnion000017Oceania#012ş0c2TOşTonga000017Illinois#151ş0c2POşPope00001BMissouri#071ş0c2FRşFranklin00002ACentralAmericawithCaribbeans#08ş0c2CUşCuba00001ATurkey#48ş0c2MGşMu&#287;la000020USANorthEastRegion#39ş0c2OHşOhio000022DominicanRepublic#19ş0c2SCşSalcedo00003CWorldwithCountries#51ş0c2CDşDemocratic Republic of the Congo000016USA#MNş0c2MNşMinnesota000019USA#NDş0c2NDşNorth Dakota000017Sweden#10ş0c2WşDalarnas00001FAfghanistan#18ş0c2NANşNangarhar00001DAzerbaijan#46ş0c2SBşSabirabad000024Latvia#24ş0c2REZşR&#275;zekne (city)000024Paraguay#01ş0c2AAşAlto Paran&aacute;000023PolandCounties#PL.WP.PIş0c2WPIşPila00001ALaos#LA.CHş0c2CHşChampasak000021Thailand#TH.NNş0c2NNşNakhon Nayok00002AHungaryRegions#HU.CHş0c2CHşCentral Hungary000023Qatar#QA.JBş0c2JBşJariyan Al Batnah000018Germany#007ş0c2HEşHessen00001BKentucky#169ş0c2MFşMetcalfe000019Florida#097ş0c2OSşOsceola00001BMississippi#079ş0c2LKşLeake00001FPennsylvania#045ş0c2DLşDelaware00001CArkansas#069ş0c2JEşJefferson00001DWestVirginia#097ş0c2UPşUpshur000021SpainProvinces#008ş0c2BLşBaleares000017Colorado#077ş0c2MEşMesa000016Montana#047ş0c2LAşLake00001BSouthDakota#115ş0c2SPşSpink000018Alabama#093ş0c2MIşMarion00001BIndia#021ş0c2MAşMaharashtra000015Utah#029ş0c2MOşMorgan000017Texas#325ş0c2MEDşMedina000018Oceania#013ş0c2TVşTuvalu000020Louisiana#069ş0c2NAşNatchitoches000018Georgia#133ş0c2GEşGreene00002DCentralAmericawithCaribbeans#09ş0c2BSşBahamas000018Turkey#49ş0c2MSşMu&#351;000028DominicanRepublic#20ş0c2SMşSaman&aacute;000024WorldwithCountries#52ş0c2DJşDjibouti000015USA#MOş0c2MOşMissouri000015USA#NEş0c2NEşNebraska00001CAfghanistan#19ş0c2NIMşNimruz000022Azerbaijan#47ş0c2SKş&#350;&#601;ki000019Latvia#25ş0c2RIşR&#299;ga000019Paraguay#02ş0c2AMşAmambay00001BEastTimor#TL.ALş0c2ALşAileu00001EEastTimor#TL.BBş0c2BBşBobonaro00001FThailand#TH.NOş0c2NOşNonthaburi00001FSriLanka#LK.KGş0c2KGşKurunegala00001EKyrgyzstan#KG.GBş0c2GBşBishkek000029BurkinaFaso#BF.KLş0c2KLşKoulp&eacute;logo00001ERwanda#RW.KVş0c2KVşKigali City000019Yemen#YE.SHş0c2SHşShabwah00001FAngola#AO.CNş0c2CNşCuanza Norte00001DZimbabwe#ZW.MVş0c2MVşMasvingo000028Germany#008ş0c2MEşMecklenburg-Vorpommern00001BNorthDakota#087ş0c2SLşSlope000016Texas#145ş0c2FALşFalls000015Ohio#107ş0c2MCşMercer00001ANebraska#077ş0c2GEşGreeley00001AMinnesota#005ş0c2BEşBecker000020Connecticut#005ş0c2LIşLitchfield00001ATennessee#167ş0c2TIşTipton00001AMaryland#025ş0c2HAşHarford000022SpainProvinces#009ş0c2BRşBarcelona000018Oklahoma#119ş0c2PYşPayne000013Iowa#171ş0c2TAşTama00001CWisconsin#061ş0c2KWşKewaunee000017Texas#507ş0c2ZAVşZavala000017India#022ş0c2MNşManipur00001DWashington#021ş0c2FRşFranklin000019Asia#046ş0c2UZşUzbekistan000017Indiana#123ş0c2PEşPerry00001BNewYork#095ş0c2SHşSchoharie00001FNorthCarolina#163ş0c2SAşSampson00001BVirginia#065ş0c2FVşFluvanna000018Georgia#315ş0c2WCşWilcox000019Kansas#117ş0c2MSşMarshall000024SouthCarolina#089ş0c2WIşWilliamsburg000019Oceania#014ş0c2VUşVanuatu00001AIllinois#153ş0c2PUşPulaski00001CMissouri#073ş0c2GAşGasconade000034CentralAmericawithCaribbeans#10ş0c2KYşCayman Islands00001DTurkey#50ş0c2NVşNev&#351;ehir000038DominicanRepublic#21ş0c2SZşS&aacute;nchez Ram&iacute;rez000021WorldwithCountries#53ş0c2EGşEgypt000018Sweden#12ş0c2GşKronoberg000029Azerbaijan#48ş0c2SAş&#350;&#601;ki (City)000021Latvia#26ş0c2RIXşR&#299;ga (city)000025MarshallIsland#MH.MH.RRş0c2RRşRongrik00001CEastTimor#TL.AMş0c2AMşAmbeno00001CEastTimor#TL.BCş0c2BCşBaucau000020FranceDepartment#FR.LOş0c2LOşLot000022Thailand#TH.NPş0c2NPşNakhon Pathom00001CKuwait#KW.AHş0c2AHşAl Ahmadi000024BurkinaFaso#BF.KMş0c2KMşKomo&eacute;000025Zimbabwe#ZW.MWş0c2MWşMashonaland West000028CentralAfricanRepublic#CF.ACş0c2ACşOuham00001FGermany#009ş0c2NIşNiedersachsen000019Kentucky#171ş0c2MNşMonroe00001CFlorida#099ş0c2PBşPalm beach000019Mississippi#081ş0c2LEşLee00001APennsylvania#047ş0c2ELşElk00001AArkansas#071ş0c2JOşJohnson00001CWestVirginia#099ş0c2WAşWayne000020SpainProvinces#010ş0c2BIşBizkaia00001AColorado#079ş0c2MIşMineral000021Montana#049ş0c2LCşLewis and Clark00001DSouthDakota#117ş0c2STşStanley00001AAlabama#095ş0c2MSşMarshall000019India#023ş0c2MEşMeghalaya000016Asia#047ş0c2VNşVietnam000014Utah#031ş0c2PIşPiute000017Texas#327ş0c2MENşMenard00001FOceania#015ş0c2NCşNew Caledonia00001BLouisiana#071ş0c2ORşOrleans000022Virginia#790ş0c2SNşStaunton (City)00001AGeorgia#135ş0c2GWşGwinnett00002DCentralAmericawithCaribbeans#11ş0c2JMşJamaica000028USANorthEastRegion#42ş0c2PAşPennsylvania00002DWorldwithCountries#54ş0c2GQşEquatorial Guinea00001AAzerbaijan#49ş0c2SLşSalyan000016Latvia#27ş0c2SAşSaldus000021Paraguay#04ş0c2CGşCaaguaz&uacute;00002ANovaScotia#CA.NS.ETş0c2ETşEvangeline Trail00001CEastTimor#TL.ANş0c2ANşAinaro00001BUganda#UG.ISş0c2ISşIsingiro000018Uganda#UG.JIş0c2JIşJinja000024CaymanIslands#KY.NSş0c2NSşNorth Side00001BEthiopia#ET.ORş0c2ORşOromia000020CapeVerde#CV.SZş0c2SZşSanta Cruz00001CTuvalu#TV.NFş0c2NFşNukufetau000028Eritrea#ER.DKş0c2DKşDebubawi Keyih Bahri000016Mali#ML.MOş0c2MOşMopti00001BPanama#PA.VRş0c2VRşVeraguas00001BEurope2#EU.EEş0c2EEşEstonia00001AEurope2#EU.CYş0c2CYşCyprus000030BurkinaFaso#BF.KNş0c2KNşK&eacute;n&eacute;dougou000030CentralAfricanRepublic#CF.SEş0c2SEşSangha-Mbaere000014Chad#TD.LCş0c2LCşLac000018Serbia#RS.RSş0c2RSşRaska000025Germany#010ş0c2NOşNordrhein-Westfalen00001BNorthDakota#089ş0c2STşStark000017Texas#147ş0c2FANşFannin000026Virginia#610ş0c2FCşFalls Church (City)000014Ohio#109ş0c2MMşMiami000017Nebraska#079ş0c2HAşHall00001CMinnesota#007ş0c2BLşBeltrami00001FConnecticut#007ş0c2MIşMiddlesex000019Michigan#001ş0c2ALşAlcona00001DTennessee#169ş0c2TRşTrousdale000019Maryland#027ş0c2HOşHoward00001FSpainProvinces#011ş0c2BUşBurgos00001COklahoma#121ş0c2PIşPittsburg000015Iowa#173ş0c2TYşTaylor00001DWisconsin#063ş0c2LCşLa Crosse000017India#024ş0c2MIşMizoram00001DWashington#023ş0c2GFşGarfield000016Indiana#125ş0c2PIşPike00001ANewYork#097ş0c2SUşSchuyler000020NorthCarolina#165ş0c2SCşScotland00001BVirginia#067ş0c2FKşFranklin000018Georgia#317ş0c2WLşWilkes000016Kansas#119ş0c2MEşMeade00001CSouthCarolina#091ş0c2YOşYork000019Illinois#155ş0c2PTşPutnam000019Missouri#075ş0c2GNşGentry00002BCentralAmericawithCaribbeans#12ş0c2HTşHaiti000019Estonia#01ş0c2HAşHarjumaa000014Turkey#52ş0c2ORşOrdu000023DominicanRepublic#23ş0c2JUşSan Juan000023WorldwithCountries#55ş0c2ERşEritrea00001AUSA#NHş0c2NHşNew Hampshire00001ASweden#14ş0c2BDşNorrbotten000024Azerbaijan#50ş0c2SIş&#350;amax&#305;000015Latvia#28ş0c2TAşTalsi000020Paraguay#05ş0c2CZşCaazap&aacute;000025PolandCounties#PL.WP.PMş0c2WPMşPoznan00002BMarshallIsland#MH.MH.AIş0c2AIşAilinglapalap00001EVietnam#VN.QBş0c2QBşQuang Binh000026Thailand#TH.NRş0c2NRşNakhon Ratchasima00001BPakistan#PK.PBş0c2PBşPunjab00001CTuvalu#TV.NGş0c2NGşNanumanga00001BNigeria#NG.KTş0c2KTşKatsina000022Europe2#EU.CZş0c2CZşCzech Republic000025BurkinaFaso#BF.LEş0c2LEşL&eacute;raba000022Burma#MM.SAş0c2SAşSagaing Division00001DMacedonia#MK.ZRş0c2ZRşZrnovci000019Panama#PA.DRş0c2DRşDarien000017Yemen#YE.TAş0c2TAşTaizz000021Germany#011ş0c2RHşRheinland-Pfalz00001DKentucky#173ş0c2MYşMontgomery000017Florida#101ş0c2PAşPasco00001DMississippi#083ş0c2LFşLeflore00001BPennsylvania#049ş0c2ERşErie00001CArkansas#073ş0c2LAşLafayette00001EWestVirginia#101ş0c2WEşWebster000027SpainProvinces#012ş0c2CAşC&aacute;ceres000019Colorado#081ş0c2MOşMoffat000019Montana#051ş0c2LBşLiberty00001BSouthDakota#119ş0c2SUşSully000018Alabama#097ş0c2MOşMobile000018India#025ş0c2NAşNagaland000015Asia#049ş0c2TWşTaiwan000013Utah#033ş0c2RIşRich000018Texas#329ş0c2MIDşMidland00001CLouisiana#073ş0c2OUşOuachita00001BGeorgia#137ş0c2HAşHabersham000038CentralAmericawithCaribbeans#13ş0c2DOşDominican Republic000018Estonia#02ş0c2HIşHiiumaa000014Turkey#53ş0c2RIşRize000028USANorthEastRegion#44ş0c2RIşRhode Island000036DominicanRepublic#24ş0c2PMşSan Pedro de Macor&iacute;s000024WorldwithCountries#56ş0c2ETşEthiopia000018USA#MSş0c2MSşMississippi00001ASweden#15ş0c2Tş&Ouml;rebro00001EAfghanistan#23ş0c2KANşKandahar000024Azerbaijan#51ş0c2SMş&#350;&#601;mkir000016Latvia#29ş0c2TUşTukums000019Paraguay#06ş0c2CEşCentral000024MarshallIsland#MH.MH.TAş0c2TAşTaongi00001CRussia#RU.PRş0c2PRşPrimorsky00001BMongolia#MN.BUş0c2BUşBulgan000020Mongolia#MN.DAş0c2DAşDarkhan Uul000019Uganda#UG.KAş0c2KAşKabale00001FBotswana#BW.SEş0c2SEşSouth East000022FranceDepartment#FR.LRş0c2LRşLoire000023FranceDepartment#FR.MHş0c2MHşManche000021Thailand#TH.NSş0c2NSşNakhon Sawan000028Pakistan#PK.NWş0c2NWşNorth West Frontier000021BurkinaFaso#BF.KPş0c2KPşKompienga00003ATajikistan#TJ.RRş0c2RRşRegions of Republican Subordination00001AYemen#YE.BAş0c2BAşAl Bayda000019Missouri#077ş0c2GEşGreene00001AGermany#012ş0c2SAşSaarland00001CNorthDakota#091ş0c2SEşSteele000018Texas#149ş0c2FAYşFayette000015Ohio#111ş0c2MOşMonroe00001BNebraska#081ş0c2HMşHamilton00001AMinnesota#009ş0c2BNşBenton00001FConnecticut#009ş0c2NHşNew Haven000018Michigan#003ş0c2AGşAlger00001ATennessee#171ş0c2UIşUnicoi000017Maryland#029ş0c2KEşKent000025SpainProvinces#013ş0c2CDşC&aacute;diz00001BOklahoma#123ş0c2POşPontotoc000014Iowa#175ş0c2UNşUnion00001DWisconsin#065ş0c2LAşLafayette000016India#026ş0c2ORşOrissa00001AWashington#025ş0c2GAşGrant000018Asia#050ş0c2HKşHong Kong000018Indiana#127ş0c2POşPorter000018NewYork#099ş0c2SEşSeneca00001ENorthCarolina#167ş0c2STşStanly00001CVirginia#069ş0c2FDşFrederick00001BGeorgia#319ş0c2WIşWilkinson000016Kansas#121ş0c2MIşMiami00001BIllinois#157ş0c2RAşRandolph000035NewfoundlandandLabrador#CA.NF.WSş0c2WSşWestern Region000031CentralAmericawithCaribbeans#14ş0c2PRşPuerto Rico00001CEstonia#03ş0c2IVşIda-Virumaa000017Turkey#54ş0c2SKşSakarya000023DominicanRepublic#25ş0c2STşSantiago000021WorldwithCountries#57ş0c2GAşGabon000014USA#MTş0c2MTşMontana000017USA#NJş0c2NJşNew Jersey000025Sweden#16ş0c2Eş&Ouml;sterg&ouml;tland00001CAfghanistan#24ş0c2KDZşKondoz000019Azerbaijan#52ş0c2SXşSamux000015Latvia#30ş0c2VKşValka000023Paraguay#07ş0c2CNşConcepci&oacute;n000023SierraLeone#SL.EA.KLş0c2KLşKailahun000018Russia#RU.PSş0c2PSşPskov00001BLibya#LY.QBş0c2QBşAl Qubbah000028Thailand#TH.NTş0c2NTşNakhon Si Thammarat00001CTuvalu#TV.NIş0c2NIşNiulakita000020SriLanka#LK.KLş0c2KLşKilinochchi00001BCapeVerde#CV.BRş0c2BRşBrava00001DAngola#AO.CSş0c2CSşCuanza Sul000016Georgia#139ş0c2HLşHall000019Germany#013ş0c2SCşSachsen000019Kentucky#175ş0c2MAşMorgan00001AFlorida#103ş0c2PLşPinellas00001DMississippi#085ş0c2LNşLincoln00001EPennsylvania#051ş0c2FAşFayette00001BArkansas#075ş0c2LWşLawrence00001DWestVirginia#103ş0c2WTşWetzel000022SpainProvinces#014ş0c2CNşCantabria00001CColorado#083ş0c2MNşMontezuma000019Montana#053ş0c2LIşLincoln00001ASouthDakota#121ş0c2TOşTodd000018Alabama#099ş0c2MNşMonroe000014Asia#051ş0c2MOşMacau000018Utah#035ş0c2SLşSalt Lake000016Texas#331ş0c2MILşMilam00001FLouisiana#075ş0c2PLşPlaquemines000035NewfoundlandandLabrador#CA.NF.ESş0c2ESşEastern Region000038CentralAmericawithCaribbeans#15ş0c2KNşSt.Kitts and Nevis00001EEstonia#04ş0c2JRşJ&auml;rvamaa000016Turkey#55ş0c2SSşSamsun000034DominicanRepublic#26ş0c2SRşSantiago Rodr&iacute;guez000021WorldwithCountries#58ş0c2GHşGhana000025Azerbaijan#53ş0c2SYşSiy&#601;z&#601;n000018Latvia#31ş0c2VMşValmiera00001CParaguay#08ş0c2CRşCordillera000017Serbia#RS.SMş0c2SMşSrem000017Yemen#YE.AMş0c2AMşAmran000023FranceDepartment#FR.LTş0c2LTşLoiret000019Nigeria#NG.KWş0c2KWşKwara000022BurkinaFaso#BF.KRş0c2KRşKouritenga00001BLiberia#LR.MGş0c2MGşMargibi00001BBhutan#BT.LHş0c2LHşLhuntshi000016Yemen#YE.SNş0c2SNşSana000019Sudan#SD.JGş0c2JGşJungoli00001BIllinois#159ş0c2RIşRichland000019Missouri#079ş0c2GRşGrundy000020Germany#014ş0c2SHşSachsen-Anhalt00001ENorthDakota#093ş0c2SUşStutsman000017Texas#151ş0c2FISşFisher000019Ohio#113ş0c2MGşMontgomery000019Nebraska#083ş0c2HRşHarlan00001DMinnesota#011ş0c2BSşBig Stone000020Connecticut#011ş0c2NLşNew London00001AMichigan#005ş0c2AEşAllegan000019Tennessee#173ş0c2UNşUnion00001DMaryland#031ş0c2MOşMontgomery000029SpainProvinces#015ş0c2CSşCastell&oacute;n00001FOklahoma#125ş0c2PWşPottawatomie000018Iowa#177ş0c2VBşVan Buren00001CWisconsin#067ş0c2LNşLanglade000016India#028ş0c2PUşPunjab000021Washington#027ş0c2GRşGrays Harbor000017Indiana#129ş0c2PSşPosey000019NewYork#101ş0c2STşSteuben00001ENorthCarolina#169ş0c2SOşStokes000018Virginia#071ş0c2GIşGiles000017Georgia#321ş0c2WOşWorth000018Africa#001ş0c2DZşAlgeria000019Kansas#123ş0c2MCşMitchell00002DSaskatchewan#CA.SK.SWş0c2SWşSouth West Region00002DCentralAmericawithCaribbeans#16ş0c2AGşAntigua000021Estonia#05ş0c2JNşJ&otilde;gevamaa000015Romania#01ş0c2ABşAlba000023DominicanRepublic#27ş0c2VAşValverde000022WorldwithCountries#59ş0c2GNşGuinea000020Sweden#18ş0c2DşS&ouml;dermanland00001CAfghanistan#26ş0c2TAKşTakhar000021Azerbaijan#54ş0c2SQşSumqay&#305;t000019Latvia#32ş0c2VEşVentspils000013World#ASş0c2ASşAsia00001FSierraLeone#SL.EA.KNş0c2KNşKono00002CDistrictofColumbia#US.DC.NWş0c2NWşNorth West000028PolandCounties#PL.MZ.CIş0c2MCIşCieckanow00001ESerbia#RS.SNş0c2SNşNorth Banat00001BMongolia#MN.DDş0c2DDşDornod000026CoteDivoire#CI.HTş0c2HTşHaut-Sassandra00001EUganda#UG.KDş0c2KDşKaberamaido000025BrazilRegion#BR.SOş0c2SOşSouth Region00001ANamibia#NA.KUş0c2KUşKunene00001DBurkinaFaso#BF.KSş0c2KSşKossi000019Angola#AO.CUş0c2CUşCunene000019Georgia#141ş0c2HNşHancock000024Germany#015ş0c2SSşSchleswig-Holstein00001DKentucky#177ş0c2MBşMuhlenberg000016Florida#105ş0c2POşPolk00001DMississippi#087ş0c2LDşLowndes00001DPennsylvania#053ş0c2FOşForest000016Arkansas#077ş0c2LEşLee00001BWestVirginia#105ş0c2WIşWirt00001ESpainProvinces#016ş0c2CEşCeuta00001BColorado#085ş0c2MTşMontrose000018Montana#055ş0c2MCşMcCone00001BSouthDakota#123ş0c2TRşTripp00001CAlabama#101ş0c2MTşMontgomery000019India#029ş0c2RAşRajasthan000017Africa#002ş0c2AOşAngola000017Utah#037ş0c2SJşSan Juan000016Texas#333ş0c2MISşMills000021Louisiana#077ş0c2PCşPointe Coupee000018Arizona#001ş0c2APşApache00002ECentralAmericawithCaribbeans#17ş0c2DMşDominica000015Romania#02ş0c2ARşArad000015Turkey#57ş0c2SPşSinop000023DominicanRepublic#28ş0c2SEşEl Seibo000029WorldwithCountries#60ş0c2GWşGuinea-Bissau000017USA#NMş0c2NMşNew Mexico00001CAfghanistan#27ş0c2WARşWardak000022Azerbaijan#55ş0c2SUş&#350;u&#351;a000021Latvia#33ş0c2VENşVentspils (city)00001FParaguay#10ş0c2GUşGuair&aacute;000022FrenchGuiana#GF.CY.KRş0c2KRşKourou00001BUganda#UG.KEş0c2KEşKamwenge000020Samoa #WS.ALş0c2ALşAiga-i-le-Tai00002BFranceDepartment#FR.MLş0c2MLşMaine et Loire00001EVietnam#VN.QGş0c2QGşQuang Ngai00001FKyrgyzstan#KG.YKş0c2YKşYsyk Kol00001FThailand#TH.NWş0c2NWşNarathiwat00001CThailand#TH.PCş0c2PCşPhichit00001DTuvalu#TV.NLş0c2NLşNukulaelae000019Panama#PA.EMş0c2EMşEmbera000025CentralAmerica2#CE.NIş0c2NIşNicaragua00001DMacedonia#MK.ILş0c2ILşIlinden00001EIllinois#161ş0c2ROşRock Island00001BMissouri#081ş0c2HAşHarrison00001CGermany#016ş0c2THşThueringen00001CNorthDakota#095ş0c2TOşTowner000016Texas#153ş0c2FLOşFloyd000015Ohio#115ş0c2MNşMorgan000018Nebraska#085ş0c2HYşHayes00001EMinnesota#013ş0c2BUşBlue Earth00001DConnecticut#013ş0c2TOşTolland000019Michigan#007ş0c2APşAlpena00001DTennessee#175ş0c2VBşVan Buren000022Maryland#033ş0c2PGşPrince George's000024SpainProvinces#017ş0c2CRşCiudad Real00001DOklahoma#127ş0c2PUşPushmataha000016Iowa#179ş0c2WAşWapello00001BWisconsin#069ş0c2LIşLincoln000016India#030ş0c2SIşSikkim00001BWashington#029ş0c2ISşIsland000019Indiana#131ş0c2PUşPulaski000019NewYork#103ş0c2SFşSuffolk00001DNorthCarolina#171ş0c2SUşSurry00001DVirginia#073ş0c2GLşGloucester000016Africa#003ş0c2BJşBenin00001BKansas#125ş0c2MGşMontgomery00002ECentralAmericawithCaribbeans#18ş0c2LCşSt.Lucia000023Estonia#07ş0c2LNşL&auml;&auml;nemaa00001BRomania#03ş0c2AGşArge&#351;000015Turkey#58ş0c2SVşSivas000025DominicanRepublic#29ş0c2HMşHato Mayor000021WorldwithCountries#61ş0c2KEşKenya00001BAfghanistan#28ş0c2ZABşZabol000029Azerbaijan#56ş0c2SSş&#350;u&#351;a (City)000018World#AUş0c2AUşAustralia00001FParaguay#11ş0c2ITşItap&uacute;a000019Uganda#UG.KFş0c2KFşKotido000019Oman#OM.WUş0c2WUşAl Wusta00002FFranceDepartment#FR.MMş0c2MMşMeurthe et Moselle000019Congo#CG.KOş0c2KOşKouilou00001ACongo#CG.LEş0c2LEşLekoumou00001FCapeVerde#CV.BVş0c2BVşBoa Vista00001AAlgeria#DZ.ILş0c2ILşIllizi00001EUzbekistan#UZ.FAş0c2FAşFargona000023Laos#LA.VIş0c2VIşVientiane Province000020Philippines#PH.GUş0c2GUşGuimaras00001AGeorgia#143ş0c2HRşHaralson000019Kentucky#179ş0c2NEşNelson000018Florida#107ş0c2PNşPutnam00001DMississippi#089ş0c2MAşMadison00001FPennsylvania#055ş0c2FRşFranklin00001AArkansas#079ş0c2LIşLincoln00001BWestVirginia#107ş0c2WOşWood000027SpainProvinces#018ş0c2COşC&oacute;rdoba000019Colorado#087ş0c2MGşMorgan000019Montana#057ş0c2MAşMadison00001CSouthDakota#125ş0c2TUşTurner000018Alabama#103ş0c2MGşMorgan00001AIndia#031ş0c2TNşTamil Nadu000019Africa#004ş0c2BWşBotswana000023Alaska#164ş0c2PLşPeninsula and Lake000016Utah#039ş0c2SAşSanpete000019Texas#335ş0c2MITşMitchell00001BLouisiana#079ş0c2RAşRapides000019Arizona#003ş0c2COşCochise000028YukonTerritory#CA.YT.WHş0c2WHşWhitehorse000018Nicaragua#01ş0c2BOşBoaco000044CentralAmericawithCaribbeans#19ş0c2VCşSt.Vincent and the Grenadlines000028Estonia#08ş0c2LVşL&auml;&auml;ne-Virumaa00001BRomania#04ş0c2BCşBac&#259;u00001DTurkey#59ş0c2TGşTekirda&#287;000023USANorthEastRegion#50ş0c2VTşVermont00001BAustria#01ş0c2BUşBurgenland000022DominicanRepublic#30ş0c2VEşLa Vega000023WorldwithCountries#62ş0c2LSşLesotho000016Sweden#21ş0c2CşUppsala00001DAfghanistan#29ş0c2PKAşPaktika000024Azerbaijan#57ş0c2TAşT&#601;rt&#601;r00001AParaguay#12ş0c2MIşMisiones00001BTanzania#TZ.DOş0c2DOşDodoma00001EMongolia#MN.DGş0c2DGşDornogovi000019Uganda#UG.KGş0c2KGşKiboga000020Thailand#TH.PEş0c2PEşPhetchaburi00001ASomalia#SO.SAş0c2SAşSanaag00001CBurma#MM.SHş0c2SHşShan State000020Philippines#PH.ZMş0c2ZMşZambales000018Chad#TD.MAş0c2MAşMandoul000019Sudan#SD.KAş0c2KAşKassala000034CentralAfricanRepublic#CF.BBş0c2BBşBamingui-Bangoran00001FPhilippines#PH.IBş0c2IBşIsabela00001CIllinois#163ş0c2SCşSt. Clair000018Missouri#083ş0c2HEşHenry00001CNorthDakota#097ş0c2TRşTraill000016Texas#155ş0c2FOAşFoard000015Ohio#117ş0c2MWşMorrow00001CNebraska#087ş0c2HTşHitchcock000019Minnesota#015ş0c2BWşBrown00001DConnecticut#015ş0c2WIşWindham000019Michigan#009ş0c2ANşAntrim00001ATennessee#177ş0c2WRşWarren00001FMaryland#035ş0c2QAşQueen Anne's00001FSpainProvinces#019ş0c2CUşCuenca00001EOklahoma#129ş0c2RMşRoger Mills000015Iowa#181ş0c2WRşWarren00001DWisconsin#071ş0c2MAşManitowoc000017India#032ş0c2TRşTripura00001EWashington#031ş0c2JEşJefferson000018Indiana#133ş0c2PTşPutnam00001ANewYork#105ş0c2SVşSullivan00001DNorthCarolina#173ş0c2SWşSwain00001CVirginia#075ş0c2GOşGoochland00001DAfrica#005ş0c2BFşBurkina Faso000017Kansas#127ş0c2MRşMorris000019Nicaragua#02ş0c2CAşCarazo00002ECentralAmericawithCaribbeans#20ş0c2BBşBarbados000016Romania#05ş0c2BHşBihor000015Turkey#60ş0c2TTşTokat000024USANorthEastRegion#51ş0c2VAşVirginia00001DAustria#02ş0c2KAşK&auml;rnten000030DominicanRepublic#31ş0c2MNşMonse&ntilde;or Nouel000023WorldwithCountries#63ş0c2LIşLiberia00001CSweden#22ş0c2SşV&auml;rmland00001BAfghanistan#30ş0c2BALşBalkh000019Azerbaijan#58ş0c2TOşTovuz000028Paraguay#13ş0c2NEş&Ntilde;eembuc&uacute;00001BUganda#UG.KHş0c2KHşKiruhura00001BSerbia#RS.BGş0c2BGşBelgrade000024FranceDepartment#FR.MOş0c2MOşMoselle00001BVietnam#VN.PTş0c2PTşPhu Tho00002FHungaryRegions#HU.CTş0c2CTşCentral Transdanubia000027Europe2#EU.FDş0c2FDşFaroe Islands (Den)000028BurkinaFaso#BF.KWş0c2KWşKourw&eacute;ogo00002BPhilippines#PH.ZNş0c2ZNşZamboanga del Norte00001DLouisiana#081ş0c2REşRed River00001AArizona#005ş0c2CCşCoconino000021Virginia#800ş0c2SFşSuffolk (City)000018Georgia#145ş0c2HIşHarris00001BKentucky#181ş0c2NIşNicholas00001BFlorida#109ş0c2SJşSt. Johns00001CMississippi#091ş0c2MRşMarion00001CPuertoRico#101ş0c2MVşMorovis00001DPennsylvania#057ş0c2FUşFulton00001FArkansas#081ş0c2LRşLittle River00001EWestVirginia#109ş0c2WYşWyoming000029SpainProvinces#020ş0c2GUşGuip&uacute;zcoa000018Colorado#089ş0c2OTşOtero000019Montana#059ş0c2MEşMeagher00001BSouthDakota#127ş0c2UNşUnion000017Alabama#105ş0c2PEşPerry00001DIndia#033ş0c2UPşUttar Pradesh000014Iowa#001ş0c2ADşAdair000018Africa#006ş0c2BIşBurundi000015Utah#041ş0c2SEşSevier000019Texas#337ş0c2MONşMontague000019Cyprus#01ş0c2FAşFamagusta00001DNicaragua#03ş0c2CIşChinandega00002ACzechRepublic#78ş0c2JMşJihomoravsk&yacute;00002DCentralAmericawithCaribbeans#21ş0c2GDşGrenada00002FRomania#06ş0c2BNşBistri&#355;a-N&#259;s&#259;ud000017Turkey#61ş0c2TBşTrabzon00001EDominica#02ş0c2ANşSaint Andrew000026Austria#03ş0c2NIşNieder&ouml;sterreich000026DominicanRepublic#32ş0c2MPşMonte Plata000021WorldwithCountries#64ş0c2LRşLibya000021Sweden#23ş0c2ACşV&auml;sterbotten00001DAfghanistan#31ş0c2JOWşJowzjan000018Azerbaijan#59ş0c2UCşUcar00001EAntigua#03ş0c2SGEşSaint George000022MarshallIsland#MH.MH.ARş0c2ARşArno000018Russia#RU.PZş0c2PZşPenza000019Uganda#UG.KIş0c2KIşKibale000023FranceDepartment#FR.LZş0c2LZşLozere00001DThailand#TH.PGş0c2PGşPhangnga00002ATrinidadandTobago#TT.SAş0c2SAşSaint Andrew000019Eritrea#ER.DUş0c2DUşDebub000019Illinois#165ş0c2SAşSaline00001AMissouri#085ş0c2HKşHickory00001BNorthDakota#099ş0c2WAşWalsh00001ATexas#157ş0c2FBEşFort Bend000022Virginia#620ş0c2FRşFranklin (City)000018Ohio#119ş0c2MKşMuskingum000017Nebraska#089ş0c2HOşHolt00001BMinnesota#017ş0c2CAşCarlton000018Kentucky#001ş0c2ADşAdair000019Michigan#011ş0c2ARşArenac00001ETennessee#179ş0c2WSşWashington00001DMaryland#037ş0c2SMşSt. Mary's00001FSpainProvinces#021ş0c2GIşGirona000019Oklahoma#131ş0c2ROşRogers000019Iowa#183ş0c2WSşWashington00001CWisconsin#073ş0c2MRşMarathon00001BIndia#034ş0c2UTşUttaranchal000019Washington#033ş0c2KGşKing00001AIndiana#135ş0c2RAşRandolph000017NewYork#107ş0c2TIşTioga000024NorthCarolina#175ş0c2TRşTransylvania00001AVirginia#077ş0c2GRşGrayson000019Africa#007ş0c2CMşCameroon000017Kansas#129ş0c2MTşMorton000017Cyprus#02ş0c2KYşKyrenia00001CNicaragua#04ş0c2COşChontales00002CCzechRepublic#79ş0c2JCşJiho&#269;esk&yacute;00003BCentralAmericawithCaribbeans#22ş0c2TTşTrinidad &amp; Tobago00001EEstonia#11ş0c2PRşP&auml;rnumaa00001ERomania#07ş0c2BTşBoto&#351;ani000017Turkey#62ş0c2TCşTunceli00001DDominica#03ş0c2DAşSaint David000024Austria#04ş0c2OBşOber&ouml;sterreich00002FDominicanRepublic#33ş0c2CRşSan Crist&oacute;bal000026WorldwithCountries#65ş0c2MSşMadagascar000011USA#OHş0c2OHşOhio000022Sweden#24ş0c2YşV&auml;sternorrland00001EAfghanistan#32ş0c2SAMşSamangan000021Azerbaijan#60ş0c2XZşXa&ccedil;maz00001CAntigua#04ş0c2SJOşSaint John000022Paraguay#15ş0c2PGşParaguar&iacute;000024FrenchGuiana#GF.CY.MCş0c2MCşMacouria00001BUganda#UG.KJş0c2KJşKyenjojo000019Tunisia#TN.GBş0c2GBşGabes00001FThailand#TH.PHş0c2PHşPhetchabun000018Togo#TG.SAş0c2SAşSavanes00001DSriLanka#LK.KTş0c2KTşKalutara000025Somalia#SO.SDş0c2SDşShabeellaha Dhexe00001ACongo#CG.LIş0c2LIşLikouala00001EBurkinaFaso#BF.LOş0c2LOşLoroum000034Morocco#MA.LBş0c2LBşLaayoune Boujdour Sakia El Hamra000020Macedonia#MK.JGş0c2JGşJegunovtse00001CLouisiana#083ş0c2RIşRichland000016Arizona#007ş0c2GIşGila000016Georgia#147ş0c2HTşHart000017Kentucky#183ş0c2OHşOhio00001BFlorida#111ş0c2SLşSt. Lucie00001EMississippi#093ş0c2MSşMarshall000021PuertoRico#103ş0c2NGşNag&uuml;abo00001DPennsylvania#059ş0c2GRşGreene000018Arkansas#083ş0c2LOşLogan000020SpainProvinces#022ş0c2GRşGranada000018Colorado#091ş0c2OUşOuray000019Montana#061ş0c2MIşMineral00001ESouthDakota#129ş0c2WAşWalworth000019Alabama#107ş0c2PIşPickens00001BIndia#035ş0c2WBşWest Bengal000014Iowa#003ş0c2AAşAdams00001BAfrica#008ş0c2CVşCape Verde000015Utah#043ş0c2SUşSummit00001BTexas#339ş0c2MOTşMontgomery00003EYukonTerritory#CA.YT.WLş0c2WLşWatson Lake &amp; Southern Lakes000017Cyprus#03ş0c2LAşLarnaca000020Nicaragua#05ş0c2ESşEstel&iacute;000024CzechRepublic#80ş0c2VYşVyso&#269;ina000020Estonia#12ş0c2PLşP&otilde;lvamaa00001CRomania#08ş0c2BRşBr&#259;ila000023Turkey#63ş0c2SUş&#350;anl&#305;urfa00001EDominica#04ş0c2GOşSaint George000029USANorthEastRegion#54ş0c2WVşWest Virginia000019Austria#05ş0c2SAşSalzburg00002CDominicanRepublic#34ş0c2NCşDistrito Nacional000022WorldwithCountries#66ş0c2MWşMalawi00001FSweden#25ş0c2UşV&auml;stmanland00001FAfghanistan#33ş0c2SARşSar-e Pol000021Azerbaijan#61ş0c2XAşXank&#601;ndi00001CAntigua#05ş0c2SMAşSaint Mary000022Paraguay#16ş0c2PHşPresidente Hayes00001EPhilippines#PH.IFş0c2IFşIfugao000022Tanzania#TZ.DSş0c2DSşDar es Salaam00001BSerbia#RS.SUş0c2SUşSumadija00001AUganda#UG.KKş0c2KKşKatakwi00001ABenin#BJ.LIş0c2LIşLittoral00001DBotswana#BW.SOş0c2SOşSouthern00001DChina2#CN.NMş0c2NMşNei Mongol000022FranceDepartment#FR.MRş0c2MRşMarne00001DVietnam#VN.QMş0c2QMşQuang Nam00001CThailand#TH.PIş0c2PIşPattani00001DNigeria#NG.NAş0c2NAşNassarawa00001FLiberia#LR.MOş0c2MOşMontserrado000022Chad#TD.LOş0c2LOşLogone Occidental00001FChad#TD.MEş0c2MEşMayo-Kebbi Est000018Mongolia#MN.UVş0c2UVşUvs00001FBurma#MM.BAş0c2BAşBago Division00001BIllinois#167ş0c2SNşSangamon000017Missouri#087ş0c2HLşHolt00001ANorthDakota#101ş0c2WRşWard000019Texas#159ş0c2FRAşFranklin000014Ohio#121ş0c2NOşNoble000019Nebraska#091ş0c2HKşHooker00001AMinnesota#019ş0c2CRşCarver000018Kentucky#003ş0c2ALşAllen000019Michigan#013ş0c2BAşBaraga000019Tennessee#181ş0c2WAşWayne00001BMaryland#039ş0c2SOşSomerset000024SpainProvinces#023ş0c2GAşGuadalajara00001BOklahoma#133ş0c2SEşSeminole000014Iowa#185ş0c2WYşWayne00001DWisconsin#075ş0c2MIşMarinette00001BWashington#035ş0c2KTşKitsap000018Indiana#137ş0c2RIşRipley00001ANewYork#109ş0c2TOşTompkins00001FNorthCarolina#177ş0c2TYşTyrrell000019Virginia#079ş0c2GEşGreene000029Africa#009ş0c2CRşCentral African Republic000017Kansas#131ş0c2NMşNemaha000023USASouthEastRegion#01ş0c2ALşAlabama000017Cyprus#04ş0c2NIşNicosia00001ANicaragua#06ş0c2GRşGranada000029CzechRepublic#81ş0c2KAşKarlovarsk&yacute;000019Estonia#13ş0c2RAşRaplamaa00001CRomania#09ş0c2BVşBra&#351;ov000019Turkey#64ş0c2USşU&#351;ak00001CDominica#05ş0c2JNşSaint John00001BAustria#06ş0c2STşSteiermark000022DominicanRepublic#35ş0c2PVşPeravia000020WorldwithCountries#67ş0c2MLşMali000019Sweden#26ş0c2ABşStockholm000029Iceland#03ş0c2ARş&Aacute;rness&yacute;sla00001BAfghanistan#34ş0c2KNRşKonar00001AAzerbaijan#62ş0c2XRşXanlar00001CAntigua#06ş0c2SPAşSaint Paul00001BParaguay#17ş0c2SPşSan Pedro000029CentralAfricanRepublic#CF.BGş0c2BGşBangui000022FranceDepartment#FR.MSş0c2MSşMeuse000023FranceDepartment#FR.NIş0c2NIşNievre00001EVietnam#VN.QNş0c2QNşQuang Ninh000029TrinidadandTobago#TT.SDş0c2SDşSaint David00001AQatar#QA.KHş0c2KHşAl Khawr00001BSriLanka#LK.MBş0c2MBşMannar000021Mauritania#MR.NOş0c2NOşNouakchott00001ALouisiana#085ş0c2SAşSabine000018Arizona#009ş0c2GRşGraham000017Georgia#149ş0c2HEşHeard000019Kentucky#185ş0c2OLşOldham00001CFlorida#113ş0c2SRşSanta rosa00001CMississippi#095ş0c2MOşMonroe00001EPuertoRico#105ş0c2NRşNaranjito000021Pennsylvania#061ş0c2HUşHuntingdon000019Arkansas#085ş0c2LKşLonoke00001FSpainProvinces#024ş0c2HUşHuelva00001CTennessee#001ş0c2ANşAnderson000017Colorado#093ş0c2PAşPark00001AMontana#063ş0c2MSşMissoula000016Alabama#109ş0c2PKşPike00001ANevada#001ş0c2CHşChurchill000018Iowa#005ş0c2ALşAllamakee000015Africa#010ş0c2TDşChad000022Alaska#170ş0c2MAşMatanuska-Susitna000015Utah#045ş0c2TOşTooele000016Texas#341ş0c2MORşMoore000018Cyprus#05ş0c2LIşLimassol00001BNicaragua#07ş0c2JIşJinotega00003BCzechRepublic#82ş0c2KRşKr&aacute;lov&eacute;hradeck&yacute;000019Estonia#14ş0c2SAşSaaremaa00001ARomania#10ş0c2BIşBucharest000013Turkey#65ş0c2VAşVan00001EDominica#06ş0c2JHşSaint Joseph000016Austria#07ş0c2TIşTirol000032DominicanRepublic#36ş0c2JOşSan Jos&eacute; de Ocoa000026WorldwithCountries#68ş0c2MRşMauritania000015USA#OKş0c2OKşOklahoma000019USA#PAş0c2PAşPennsylvania00001ASweden#27ş0c2MşSk&aring;ne000035Iceland#04ş0c2ABşAustur-Bar&eth;astrandars&yacute;sla00001DAfghanistan#35ş0c2LAGşLaghman000022Azerbaijan#63ş0c2XIşX&#305;z&#305;00001DAntigua#07ş0c2SPEşSaint Peter00001BEurope2#SOME ISLANDSş0c2ş000030NorthWestTerritories#CA.NT.ACş0c2ACşArctic Coast00002BNovaScotia#CA.NS.HDş0c2HDşHalifax Dartmouth00001AUganda#UG.KMş0c2KMşKampala000017Samoa #WS.ATş0c2ATşAtua00001BVietnam#VN.PYş0c2PYşPhu Yen000028Thailand#TH.PKş0c2PKşPrachuap Khiri Khan000019Tuvalu#TV.NTş0c2NTşNiutao00001BEurope2#EU.FIş0c2FIşFinland000019Europe2#EU.ESş0c2ESşSpain000029Philippines#PH.ZSş0c2ZSşZamboanga del Sur000017Kansas#133ş0c2NOşNeosho00001BIllinois#169ş0c2SHşSchuyler000019Missouri#089ş0c2HWşHoward00001BNorthDakota#103ş0c2WEşWells00001ATexas#161ş0c2FRSşFreestone000015Ohio#123ş0c2OTşOttawa000019Nebraska#093ş0c2HWşHoward000018Minnesota#021ş0c2CSşCass00001BKentucky#005ş0c2ANşAnderson000018Michigan#015ş0c2BRşBarry00001BTennessee#183ş0c2WEşWeakley000019Maryland#041ş0c2TAşTalbot00001FSpainProvinces#025ş0c2HEşHuesca00001BOklahoma#135ş0c2SQşSequoyah000016Iowa#187ş0c2WEşWebster00001DWisconsin#077ş0c2MQşMarquette00001DWashington#037ş0c2KIşKittitas000016Indiana#139ş0c2RUşRush000018NewYork#111ş0c2ULşUlster00001DNorthCarolina#179ş0c2UNşUnion00001EVirginia#081ş0c2GVşGreensville000018Africa#011ş0c2KMşComoros00002BNewCaledonia#NC.SU.SAş0c2SAşSarram&eacute;a000022Paraguay#19ş0c2CYşCanindey&uacute;000016Cyprus#06ş0c2PAşPaphos00001ENicaragua#08ş0c2LEşLe&oacute;n000027CzechRepublic#83ş0c2LIşLibereck&yacute;00001BRomania#11ş0c2BZşBuz&#259;u000016Turkey#66ş0c2YZşYozgat00001CDominica#07ş0c2LUşSaint Luke00001BAustria#08ş0c2VOşVorarlberg000028DominicanRepublic#37ş0c2SDşSanto Domingo000023WorldwithCountries#69ş0c2MAşMorocco000013USA#NVş0c2NVşNevada000028Sweden#28ş0c2OşV&auml;stra G&ouml;taland000034Iceland#05ş0c2AHşAustur-H&uacute;navatnss&yacute;sla00001CAfghanistan#36ş0c2PIAşPaktia00001FAzerbaijan#64ş0c2XCşXocal&#305;00001EAntigua#08ş0c2SPHşSaint Philip000020Nunavut#CA.NU.KTş0c2KTşKitikmeot00001ASudan#SD.KHş0c2KHşKhartoum00001EPhilippines#PH.IIş0c2IIşIloilo000019Russia#RU.SAş0c2SAşSamara00001CUganda#UG.KNş0c2KNşKalangala000019Tunisia#TN.GFş0c2GFşGafsa000020Thailand#TH.PLş0c2PLşPhatthalung000016Tuvalu#TV.NUş0c2NUşNui000025Somalia#SO.SHş0c2SHşShabeellaha Hoose00001FSenegal#SN.TCş0c2TCşTambacounda000019Algeria#DZ.JJş0c2JJşJijel000020Chad#TD.LRş0c2LRşLogone Oriental000017Texas#343ş0c2MOIşMorris00001FLouisiana#087ş0c2SBşSt. Bernard00001AArizona#011ş0c2GEşGreenlee000017Georgia#151ş0c2HYşHenry000017Kentucky#187ş0c2OWşOwen00001AFlorida#115ş0c2SSşSarasota000020Mississippi#097ş0c2MTşMontgomery00001DPuertoRico#107ş0c2ORşOrocovis00001EPennsylvania#063ş0c2INşIndiana00001AArkansas#087ş0c2MAşMadison000024SpainProvinces#026ş0c2JAşJa&eacute;n000016Oregon#001ş0c2BAşBaker00001BTennessee#003ş0c2BDşBedford00001DWisconsin#078ş0c2MNşMenominee00001BColorado#095ş0c2PHşPhillips00001DMontana#065ş0c2MUşMusselshell00001AAlabama#111ş0c2RAşRandolph000016Nevada#003ş0c2CLşClark000018Iowa#007ş0c2APşAppanoose00001EAfrica#012ş0c2CIşCote d Ivoire000015Utah#047ş0c2UIşUintah000019Nicaragua#09ş0c2MDşMadriz000027CzechRepublic#84ş0c2OLşOlomouck&yacute;000023Romania#12ş0c2CSşCara&#351;-Severin00001CDominica#08ş0c2MAşSaint Mark000015Austria#09ş0c2WIşWien000026WorldwithCountries#70ş0c2MZşMozambique00002FIceland#06ş0c2ASşAustur-Skaftafellss&yacute;sla00001BAfghanistan#37ş0c2KHOşKhost000021Azerbaijan#65ş0c2XDşXocav&#601;nd000022MarshallIsland#MH.MH.TOş0c2TOşToke000027PolandCounties#PL.MZ.WAş0c2MWAşWarszawa000024MarshallIsland#MH.MH.BNş0c2BNşBikini00001EMacedonia#MK.KBş0c2KBşKarbinci00001DNepal#NP.DHş0c2DHşDhawalagiri00001ASerbia#RS.TOş0c2TOşToplica000027Tajikistan#TJ.BKş0c2BKşBadakhshoni Kuni00001CEastTimor#TL.BTş0c2BTşLautem000014Iran#IR.QMş0c2QMşQom00002ATrinidadandTobago#TT.SGş0c2SGşSaint George00001EQatar#QA.JUş0c2JUşAl Jumaliyah00001ASriLanka#LK.KYş0c2KYşKandy000019Liberia#LR.NIş0c2NIşNimba000022Kazakhstan#KZ.MGş0c2MGşMangghystau00001DHongKong#HK.SKş0c2SKşSai Kung000015Kansas#135ş0c2NSşNess000018Arizona#012ş0c2LPşLa Paz000018Illinois#171ş0c2STşScott000019Missouri#091ş0c2HOşHowell00001ENorthDakota#105ş0c2WIşWilliams000015Texas#163ş0c2FRIşFrio000017Ohio#125ş0c2PAşPaulding00001CNebraska#095ş0c2JEşJefferson00001CMinnesota#023ş0c2CHşChippewa00001AKentucky#007ş0c2BAşBallard000016Michigan#017ş0c2BYşBay000019Tennessee#185ş0c2WHşWhite00001DMaryland#043ş0c2WAşWashington000029SpainProvinces#027ş0c2LCşLa Coru&ntilde;a00001BOklahoma#137ş0c2STşStephens000018Iowa#189ş0c2WIşWinnebago00001DWisconsin#079ş0c2MEşMilwaukee00001EWashington#039ş0c2KLşKlickitat00001CIndiana#141ş0c2SJşSt. Joseph000018NewYork#113ş0c2WAşWarren00001DNorthCarolina#181ş0c2VAşVance00001AVirginia#083ş0c2HLşHalifax000031Africa#013ş0c2CDşDemocratic Republic of the Congo000024USASouthEastRegion#05ş0c2ARşArkansas00001ANicaragua#10ş0c2MNşManagua00002DCzechRepublic#85ş0c2MOşMoravskoslezsk&yacute;000015Romania#13ş0c2CJşCluj000016Turkey#68ş0c2ANşAnkara00001FDominica#09ş0c2PKşSaint Patrick000023WorldwithCountries#71ş0c2NAşNamibia00002EIceland#07ş0c2BOşBorgarfjar&eth;ars&yacute;sla000014China#01ş0c2AHşAnhui00001EAfghanistan#38ş0c2NURşNurestan000026Azerbaijan#66ş0c2YRşYard&#305;ml&#305;00001FNunavut#CA.NU.KVş0c2KVşKeewatin00002ECentralAfricanRepublic#CF.BKş0c2BKşBasse-Kotto00001CUganda#UG.KPş0c2KPşKapchorwa00001DOman#OM.ZAş0c2ZAşAdh Dhahirah000016Serbia#RS.BOş0c2BOşBor000018UK7#UK.SCş0c2SCşScotland000017Texas#345ş0c2MOEşMotley00001FLouisiana#089ş0c2SCşSt. Charles00001AArizona#013ş0c2MAşMaricopa000020NorthCarolina#001ş0c2ALşAlamance000019Georgia#153ş0c2HOşHouston000019Kentucky#189ş0c2OSşOwsley00001AFlorida#117ş0c2SOşSeminole00001DMississippi#099ş0c2NEşNeshoba00001DPuertoRico#109ş0c2PTşPatillas000020Pennsylvania#065ş0c2JEşJefferson000013Idaho#001ş0c2ADşAda000019Arkansas#089ş0c2MRşMarion000021SpainProvinces#028ş0c2LRşLa Rioja000017Oregon#003ş0c2BEşBenton00001ATennessee#005ş0c2BEşBenton000019Colorado#097ş0c2PIşPitkin000016Montana#067ş0c2PAşPark00001DSouthDakota#135ş0c2YAşYankton000019Alabama#113ş0c2RUşRussell000018Nevada#005ş0c2DOşDouglas000016Iowa#009ş0c2AUşAudubon000019Africa#014ş0c2DJşDjibouti000013Utah#049ş0c2UTşUtah000032Paraguay#22ş0c2ASşAsunci&oacute;n Capitol District000019Nicaragua#11ş0c2MSşMasaya000028CzechRepublic#86ş0c2PAşPardubick&yacute;000019Estonia#18ş0c2TAşTartumaa00001FRomania#14ş0c2CTşConstan&#355;a000028Turkey#69ş0c2GUşG&uuml;m&uuml;&#351;hane00001CDominica#10ş0c2PLşSaint Paul000021WorldwithCountries#72ş0c2NEşNiger000015USA#NYş0c2NYşNew York000021Iceland#08ş0c2DAşDalas&yacute;sla000017China#02ş0c2ZJşZhejiang00001DAfghanistan#39ş0c2ORUşOruzgan00001AAzerbaijan#67ş0c2YVşYevlax000025Laos#LA.VTş0c2VTşVientiane Prefecture00001FEastTimor#TL.CLş0c2CLşCova-Lima000018Uganda#UG.KQş0c2KQşAmuru000020BurkinaFaso#BF.NBş0c2NBşNoumbiel000022CentralAmerica2#CE.PAş0c2PAşPanama000022PapuaNewGuinea#PG.SAş0c2SAşSanduan000017Kansas#137ş0c2NTşNorton000019Illinois#173ş0c2SEşShelby000017Missouri#093ş0c2IRşIron000017Texas#165ş0c2GAIşGaines000014Ohio#127ş0c2PEşPerry00001ANebraska#097ş0c2JOşJohnson00001BMinnesota#025ş0c2CGşChisago000019Kentucky#009ş0c2BRşBarren000019Michigan#019ş0c2BEşBenzie00001ETennessee#187ş0c2WLşWilliamson00001BMaryland#045ş0c2WIşWicomico000023SpainProvinces#029ş0c2LPşLas Palmas000018Oklahoma#139ş0c2TEşTexas000019Iowa#191ş0c2WNşWinneshiek00001AWisconsin#081ş0c2MOşMonroe00001AWashington#041ş0c2LEşLewis000017Indiana#143ş0c2SCşScott00001CNewYork#115ş0c2WSşWashington00001CNorthCarolina#183ş0c2WAşWake00001AVirginia#085ş0c2HNşHanover000016Africa#015ş0c2EGşEgypt00001FParaguay#23ş0c2AGşAlto Paraguay00001CNicaragua#12ş0c2MTşMatagalpa00002BCzechRepublic#87ş0c2PLşPlze&#328;sk&yacute;000019Estonia#19ş0c2VGşValgamaa00001CWales#01ş0c2BGşBlaenau Gwent000018Romania#15ş0c2CVşCovasna000020Ecuador#01ş0c2WşGal&aacute;pagos000017Turkey#70ş0c2HKşHakkari00001DDominica#11ş0c2PRşSaint Peter000023WorldwithCountries#73ş0c2NGşNigeria00002CIceland#09ş0c2EYşEyjafjar&eth;ars&yacute;sla000016China#03ş0c2JXşJiangxi00001CAfghanistan#40ş0c2PARşParvan000021Azerbaijan#68ş0c2YEşYevlax (City)00001CLaos#LA.XAş0c2XAşXaignabouli000019Russia#RU.ROş0c2ROşRostov00001CTunisia#TN.ZAş0c2ZAşZaghouan000019Uganda#UG.KRş0c2KRşKisoro00001ARussia#RU.ADş0c2ADşAdygaya000024FranceDepartment#FR.MYş0c2MYşMayenne000021FranceDepartment#FR.NOş0c2NOşNord00001DVietnam#VN.QTş0c2QTşQuang Tri00001BSriLanka#LK.MHş0c2MHşMatara00001FTurkmenistan#TM.BAş0c2BAşBalkan000016Utah#051ş0c2WAşWasatch00001CTexas#347ş0c2NACşNacogdoches00001ELouisiana#091ş0c2SHşSt. Helena000018Arizona#015ş0c2MOşMohave000028Virginia#810ş0c2VBşVirginia Beach (City)000021NorthCarolina#003ş0c2AEşAlexander000017Georgia#155ş0c2IRşIrwin00001CKentucky#191ş0c2PEşPendleton000018Florida#119ş0c2STşSumter00001CMississippi#101ş0c2NWşNewton000024PuertoRico#111ş0c2PNşPe&ntilde;uelas00001EPennsylvania#067ş0c2JUşJuniata000015Idaho#003ş0c2AAşAdams000019Arkansas#091ş0c2MIşMiller000024SpainProvinces#030ş0c2LEşLe&oacute;n00001AOregon#005ş0c2CLşClackamas00001BTennessee#007ş0c2BLşBledsoe00001AColorado#099ş0c2PRşProwers00001BMontana#069ş0c2PEşPetroleum00001DSouthDakota#137ş0c2ZIşZiebach00001BAlabama#115ş0c2SCşSt. Clair000015Nevada#007ş0c2ELşElko000015Iowa#011ş0c2BEşBenton000022Africa#016ş0c2GQşEquatorial Guinea00001CNorthIreland#01ş0c2ANşAntrim000021Paraguay#24ş0c2BQşBoquer&oacute;n000020Nicaragua#13ş0c2NSşNueva Segovia000033CzechRepublic#88ş0c2STşSt&#345;edo&#269;esk&yacute;00001CEstonia#20ş0c2VDşViljandimaa000017Wales#02ş0c2BBşBridgend000025Romania#16ş0c2DBşD&acirc;mbovi&#355;a000015Ecuador#02ş0c2AşAzuay000015Turkey#71ş0c2KOşKonya000022WorldwithCountries#74ş0c2RWşRwanda000027Iceland#10ş0c2GUşGullbringus&yacute;sla000016China#04ş0c2JSşJiangsu00001EAfghanistan#41ş0c2DAYşDaykundi000021Azerbaijan#69ş0c2ZGşZ&#601;ngilan000028NovaScotia#CA.NS.GTş0c2GTşGlooscap Trail000025PolandCounties#PL.SK.KMş0c2SKMşKielce000023MarshallIsland#MH.MH.BRş0c2BRşBikar000022SierraLeone#SL.NO.BMş0c2BMşBombali000024Philippines#PH.INş0c2INşIlocos Norte000019Uganda#UG.KSş0c2KSşKasese000017Uganda#UG.LIş0c2LIşLira000025EquatorialGuinea#GQ.KNş0c2KNşKie Ntem000022Tibet#TI.LPş0c2LPşLhasa Prefecture00001CSerbia#RS.BRş0c2BRşBranicevo00001DTurkmenistan#TM.ALş0c2ALşAhal000019Nigeria#NG.NIş0c2NIşNiger000019Senegal#SN.THş0c2THşThies000020Gambia#GM.MCş0c2MCşCentral River000029Philippines#PH.ZYş0c2ZYşZamboanga Sibugay00001DHongKong#HK.SOş0c2SOşSouthern000016Kansas#139ş0c2OSşOsage000018Illinois#175ş0c2SRşStark00001AMissouri#095ş0c2JKşJackson00001ATexas#167ş0c2GALşGalveston000028Virginia#630ş0c2FEşFredericksburg (City)000017Ohio#129ş0c2PIşPickaway00001ANebraska#099ş0c2KEşKearney000018Minnesota#027ş0c2CLşClay000017Kentucky#011ş0c2BTşBath00001AMichigan#021ş0c2BIşBerrien00001ATennessee#189ş0c2WIşWilson00001DMaryland#047ş0c2WOşWorchester00001FSpainProvinces#031ş0c2LIşLleida00001AOklahoma#141ş0c2TIşTillman000017Iowa#193ş0c2WOşWoodbury00001AWisconsin#083ş0c2OCşOconto00001CWashington#043ş0c2LIşLincoln000018Indiana#145ş0c2SHşShelby000017NewYork#117ş0c2WYşWayne00001ENorthCarolina#185ş0c2WRşWarren00001AVirginia#087ş0c2HCşHenrico000018Africa#017ş0c2ERşEritrea00001CAzerbaijan#70ş0c2ZQşZaqatala00001ANorthIreland#02ş0c2ADşArds000026Nicaragua#14ş0c2SJşR&iacute;o San Juan00002CCzechRepublic#89ş0c2USş&Uacute;steck&yacute;00001FEstonia#21ş0c2VRşV&otilde;rumaa000019Wales#03ş0c2CPşCaerphilly000015Romania#17ş0c2DJşDolj00001EEcuador#03ş0c2BşBol&iacute;var000016Turkey#72ş0c2MRşMardin000031WorldwithCountries#75ş0c2STşSao Tome and Principe000013USA#ORş0c2ORşOregon000014China#05ş0c2JLşJilin00001EAfghanistan#42ş0c2PANşPanjshir000026Alberta#CA.AB.ACş0c2ACşAlberta Central000026PolandCounties#PL.LD.SIş0c2LSIşSieradz000022MarshallIsland#MH.MH.UJş0c2UJşUjae000024SierraLeone#SL.NO.TOş0c2TOşTonkolili000022Macedonia#MK.KGş0c2KGşKrivogastani00001BVanuatu#VU.MLş0c2MLşMalampa00001AThailand#TH.PRş0c2PRşPhrae000021Cameroon#CM.ENş0c2ENşExtreme-Nord00001FSriLanka#Lk.MJş0c2MJşMoneragala00001EEritrea#ER.GBş0c2GBşGash-Barka00001FBurkinaFaso#BF.MOş0c2MOşMouhoun000019Bhutan#BT.MOş0c2MOşMongar00001BRwanda#RW.NOş0c2NOşNorthern000019Utah#053ş0c2WSşWashington000018Texas#349ş0c2NAVşNavarro00001DLouisiana#093ş0c2SJşSt. James000018Arizona#017ş0c2NAşNavajo000021NorthCarolina#005ş0c2AGşAlleghany000019Georgia#157ş0c2JAşJackson000018Kentucky#193ş0c2PRşPerry00001AFlorida#121ş0c2SNşSuwannee00001DMississippi#103ş0c2NOşNoxubee00001APuertoRico#113ş0c2POşPonce000021Pennsylvania#069ş0c2LAşLackawanna000017Idaho#005ş0c2BAşBannock00001EArkansas#093ş0c2MSşMississippi00001DSpainProvinces#032ş0c2LUşLugo000018Oregon#007ş0c2CAşClatsop00001ATennessee#009ş0c2BUşBlount000019Colorado#101ş0c2PUşPueblo00001AMontana#071ş0c2PHşPhillips000018Alabama#117ş0c2SHşShelby00001ANevada#009ş0c2ESşEsmeralda000019Iowa#013ş0c2BHşBlack Hawk000019Africa#018ş0c2ETşEthiopia00001FAzerbaijan#71ş0c2ZRşZ&#601;rdab00001CNorthIreland#03ş0c2AMşArmagh000018Nicaragua#15ş0c2RIşRivas00002CCzechRepublic#90ş0c2ZLşZl&iacute;nsk&yacute;000016Wales#04ş0c2CAşCardiff00001CRomania#18ş0c2GLşGala&#355;i00001CEcuador#04ş0c2FşCa&ntilde;ar00001ATurkey#73ş0c2NGşNi&#287;de000023WorldwithCountries#76ş0c2SNşSenegal000016China#06ş0c2QHşQinghai00002DPolandCounties#PL.LU.BMş0c2LBMşBiala-Podlaska00001CMacedonia#MK.KHş0c2KHşKicevo00001DMongolia#MN.DUş0c2DUşDundgovi000017Uganda#UG.KUş0c2KUşKumi000019Uganda#UG.MAş0c2MAşMasaka000020Thailand#TH.PSş0c2PSşPhitsanulok000018Somalia#SO.SOş0c2SOşSool00001FSenegal#SN.STş0c2STşSaint-Louis00001CLiberia#LR.MYş0c2MYşMaryland00001BZambia#ZM.SOş0c2SOşSouthern00001CChad#TD.MOş0c2MOşMoyen Chari000016Africa#019ş0c2GAşGabon000018Kansas#141ş0c2OBşOsborne00001DIllinois#177ş0c2SPşStephenson000019Missouri#097ş0c2JAşJasper00001CCalifornia#001ş0c2ALşAlameda000016Texas#169ş0c2GARşGarza000013Ohio#131ş0c2PKşPike000018Nebraska#101ş0c2KIşKeith00001EMinnesota#029ş0c2CWşClearwater000017Kentucky#013ş0c2BEşBell000019Michigan#023ş0c2BNşBranch00001FSpainProvinces#033ş0c2MAşMadrid000018Oklahoma#143ş0c2TUşTulsa000014Iowa#195ş0c2WHşWorth00001AWisconsin#085ş0c2ONşOneida00001BNewWorld#100ş0c2KHşCambodia00001AWashington#045ş0c2MAşMason000019Indiana#147ş0c2SPşSpencer00001DNewYork#119ş0c2WEşWestchester000022NorthCarolina#187ş0c2WSşWashington000018Virginia#089ş0c2HYşHenry00002CNewCaledonia#NC.NO.HIş0c2HIşHiengh&egrave;ne00001EAzerbaijan#72ş0c2BBşBab&#601;k00001FNorthIreland#04ş0c2BLşBallymena00001EWales#05ş0c2CIşCarmarthenshire000015Romania#19ş0c2GJşGorj000016Ecuador#05ş0c2CşCarchi000015Turkey#74ş0c2SIşSiirt000025WorldwithCountries#77ş0c2SCşSeycelles000015China#07ş0c2FJşFujian000025MarshallIsland#MH.MH.ULş0c2ULşUjelang000017Laos#LA.XEş0c2XEşXekong000017Libya#LY.SBş0c2SBşSabha00001EChina2#CN.NXş0c2NXşNingxia Hui000021FranceDepartment#FR.OIş0c2OIşOise000021Thailand#TH.PTş0c2PTşPathum Thani00001CBotswana#BW.CEş0c2CEşCentral00001AEurope2#EU.FRş0c2FRşFrance00001DAlgeria#DZ.KHş0c2KHşKhenchela00001CSaudiArabia#SA.HAş0c2HAşHail000016Africa#020ş0c2GHşGhana000015Alaska#180ş0c2NOşNome000014Utah#055ş0c2WYşWayne000017Texas#351ş0c2NEWşNewton000028Louisiana#095ş0c2STşSt. John the Baptist000016Arizona#019ş0c2PIşPima00001DNorthCarolina#007ş0c2ANşAnson000018Georgia#159ş0c2JSşJasper000017Kentucky#195ş0c2PIşPike000018Florida#123ş0c2TAşTaylor00001FMississippi#105ş0c2OKşOktibbeha000021PuertoRico#115ş0c2QBşQuebradillas000020Pennsylvania#071ş0c2LNşLancaster000019Idaho#007ş0c2BEşBear Lake000019Arkansas#095ş0c2MNşMonroe000026SpainProvinces#034ş0c2MLşM&aacute;laga000019Oregon#009ş0c2COşColumbia00001BTennessee#011ş0c2BRşBradley00001DColorado#103ş0c2RBşRio Blanco000019Montana#073ş0c2POşPondera000018Alabama#119ş0c2SUşSumter000018NewWorld#101ş0c2CNşChina000017Nevada#011ş0c2EUşEureka000014Iowa#015ş0c2BOşBoone000019Azerbaijan#73ş0c2CFşCulfa000020NorthIreland#05ş0c2BYşBallymoney000023USASouthEastRegion#12ş0c2FLşFlorida00004BNicaragua#17ş0c2ANşRegi&oacute;n Aut&oacute;noma del Atl&aacute;ntico Norte000019Wales#06ş0c2CGşCeredigion000019Romania#20ş0c2HRşHarghita00001AEcuador#06ş0c2HşChimborazo000017Turkey#75ş0c2AKşAksaray000028WorldwithCountries#78ş0c2SLşSierra Leone00001BChina#08ş0c2HLşHeilongjiang000026PolandCounties#PL.PD.SMş0c2PSMşSuwalki000021HongKong#HK.SSş0c2SSşSham Shui Po00001CSamoa #WS.TUş0c2TUşTuamasaga00001AUganda#UG.MCş0c2MCşMasindi00001BThailand#TH.PUş0c2PUşPhuket000020Ethiopia#ET.AAş0c2AAşAddis Ababa000022Europe2#EU.GIş0c2GIşGibraltar (UK)000026Burma#MM.TNş0c2TNşTanintharyi Division00001BVirginia#091ş0c2HIşHighland000017Africa#021ş0c2GNşGuinea000017Kansas#143ş0c2OTşOttawa00001BIllinois#179ş0c2TAşTazewell00001CMissouri#099ş0c2JEşJefferson00001BCalifornia#003ş0c2APşAlpine00001ATexas#171ş0c2GIEşGillespie000016Ohio#133ş0c2POşPortage00001CNebraska#103ş0c2KPşKeya Paha000018Minnesota#031ş0c2COşCook000018Kentucky#015ş0c2BNşBoone00001AMichigan#025ş0c2CAşCalhoun000020SpainProvinces#035ş0c2MEşMelilla00001AOklahoma#145ş0c2WAşWagoner000015Iowa#197ş0c2WGşWright00001DWisconsin#087ş0c2OUşOutagamie00001DNewWorld#102ş0c2TPşEast Timor00001DWashington#047ş0c2OKşOkanogan000018Indiana#149ş0c2STşStarke000019NewYork#121ş0c2WOşWyoming00001FNorthCarolina#189ş0c2WTşWatauga00002FSaskatchewan#CA.SK.WCş0c2WCşWest Central Region000026Manitoba#CA.MB.CRş0c2CRşCentral Region000026Azerbaijan#74ş0c2KNşK&#601;ng&#601;rli00001FNorthIreland#06ş0c2BBşBanbridge000023USASouthEastRegion#13ş0c2GAşGeorgia000049Nicaragua#18ş0c2ASşRegi&oacute;n Aut&oacute;noma del Atl&aacute;ntico Sur000014Wales#07ş0c2CWşConwy00001ARomania#21ş0c2HDşHunedoara000018Ecuador#07ş0c2XşCotopaxi000016Turkey#76ş0c2BMşBatman000023WorldwithCountries#79ş0c2SOşSomalia00002AIceland#15ş0c2KJşKj&oacute;sars&yacute;sla000014China#09ş0c2HEşHenan00002CPolandCounties#PL.SL.BMş0c2SBMşBielsko-Biala00002BPolandCounties#PL.LD.SMş0c2LSMşSkierniewice00002DPapuaNewGuinea#PG.SHş0c2SHşSouthern Highlands00001CHongKong#HK.STş0c2STşSha Tin000022Philippines#PH.ISş0c2ISşIlocos Sur000018Malawi#MW.ZOş0c2ZOşZomba000018Russia#RU.SKş0c2SKşSakha00001DMicronesia#FM.KOş0c2KOşKosrae000019Uganda#UG.KXş0c2KXşKamuli00001AUganda#UG.MDş0c2MDşMubende000024EquatorialGuinea#GQ.LIş0c2LIşLitoral000022Tibet#TI.NAş0c2NAşNgari Prefecture000027Iran#IR.SBş0c2SBşSistan and Baluchestan000031FranceDepartment#FR.PAş0c2PAşPyrenees Atlantiques00002BTrinidadandTobago#TT.SPş0c2SPşSaint Patrick00001EGambia#GM.LRş0c2LRşLower River00001FLesotho#LS.QNş0c2QNşQacha's Nek000015Iowa#017ş0c2BRşBremer00001EAfrica#022ş0c2GWşGuinea-Bissau000014Utah#057ş0c2WEşWeber000016Texas#353ş0c2NOLşNolan00001ELouisiana#097ş0c2SLşSt. Landry000017Arizona#021ş0c2PNşPinal00001CNorthCarolina#009ş0c2ASşAshe00001CGeorgia#161ş0c2JDşJeff Davis000019Kentucky#197ş0c2POşPowell000017Florida#125ş0c2UNşUnion00001CMississippi#107ş0c2PAşPanola000022PuertoRico#117ş0c2RCşRinc&oacute;n00001FPennsylvania#073ş0c2LWşLawrence000017Idaho#009ş0c2BNşBenewah00001DArkansas#097ş0c2MTşMontgomery00001FSpainProvinces#036ş0c2MUşMurcia000015Oregon#011ş0c2CSşCoos000018Israel#001ş0c2CEşCentral00001CTennessee#013ş0c2CAşCampbell00001DColorado#105ş0c2RGşRio Grande00001EMontana#075ş0c2PRşPowder River00001BAlabama#121ş0c2TAşTalladega00001ANewWorld#103ş0c2GEşGeorgia000019Nevada#013ş0c2HUşHumboldt00002FSaskatchewan#CA.SK.ECş0c2ECşEast Central Region00001BAzerbaijan#75ş0c2ORşOrdubad00001DNorthIreland#07ş0c2BFşBelfast00001BWales#08ş0c2DBşDenbighshire00001ERomania#22ş0c2ILşIalomi&#355;a000016Ecuador#08ş0c2OşEl Oro000017Turkey#77ş0c2BBşBayburt000028WorldwithCountries#80ş0c2ZAşSouth Africa000014China#10ş0c2HBşHebei000025Burma#MM.AYş0c2AYşAyeyarwady Division00001BRussia#RU.SLş0c2SLşSakhalin000019Russia#RU.TBş0c2TBşTambov00001AGuinea#GN.SIş0c2SIşSiguiri00001AUganda#UG.KYş0c2KYşKayunga000018Uganda#UG.MEş0c2MEşMbale000018Cameroon#CM.ESş0c2ESşEst000028CentralAfricanRepublic#CF.UKş0c2UKşOuaka00001DNorthCarolina#191ş0c2WYşWayne000020Virginia#093ş0c2IWşIsle of Wight000016Africa#023ş0c2KEşKenya000017Kansas#145ş0c2PNşPawnee000018Illinois#181ş0c2UNşUnion00001AMissouri#101ş0c2JOşJohnson00001BCalifornia#005ş0c2AMşAmador00001ATexas#173ş0c2GLAşGlasscock000015Ohio#135ş0c2PRşPreble00001ANebraska#105ş0c2KMşKimball00001EMinnesota#033ş0c2CTşCottonwood00001AKentucky#017ş0c2BOşBourbon000017Michigan#027ş0c2CSşCass000020SpainProvinces#037ş0c2NAşNavarra000016Israel#002ş0c2HAşHaifa00001DOklahoma#147ş0c2WSşWashington00001BWisconsin#089ş0c2OZşOzaukee000018NewWorld#104ş0c2INşIndia00001CWashington#049ş0c2PAşPacific000019Indiana#151ş0c2SUşSteuben000017NewYork#123ş0c2YAşYates00002AAzerbaijan#76ş0c2SDşS&#601;d&#601;r&#601;k000023NorthIreland#08ş0c2CFşCarrickfergus000019Wales#09ş0c2FLşFlintshire00001ARomania#23ş0c2ISşIa&#351;i00001AEcuador#09ş0c2EşEsmeraldas000017Turkey#78ş0c2KRşKaraman000021WorldwithCountries#81ş0c2SDşSudan000028Iceland#17ş0c2MYşM&yacute;ras&yacute;sla000014China#11ş0c2HNşHunan00001CLaos#LA.XIş0c2XIşXiangkhoang00001FPhilippines#PH.KAş0c2KAşKalinga00001BRussia#RU.SMş0c2SMşSmolensk00001CMongolia#MN.DZş0c2DZşZavkhan00001AUganda#UG.MFş0c2MFşManafwa000018Russia#RU.ALş0c2ALşAltai00002AFranceDepartment#FR.PCş0c2PCşPas de Calais00001CVietnam#VN.AGş0c2AGşAn Giang00001FSriLanka#LK.MPş0c2MPşMullailivu00001BMauritius#MU.FLş0c2FLşFlacq000022Chad#TD.NJş0c2NJşVille De Ndjamena000017Nevada#015ş0c2LAşLander000017Iowa#019ş0c2BUşBuchanan000018Africa#024ş0c2LSşLesotho000017Texas#355ş0c2NUEşNueces00001ELouisiana#099ş0c2SMşSt. Martin00001CArizona#023ş0c2SCşSanta Cruz00001DNorthCarolina#011ş0c2AVşAvery00001BGeorgia#163ş0c2JEşJefferson00001AKentucky#199ş0c2PUşPulaski000019Florida#127ş0c2VOşVolusia000018Illinois#001ş0c2ADşAdams000021Mississippi#109ş0c2PRşPearl River000026PuertoRico#119ş0c2RGşR&iacute;o Grande00001EPennsylvania#075ş0c2LEşLebanon000017Idaho#011ş0c2BIşBingham000019Arkansas#099ş0c2NEşNevada000020SpainProvinces#038ş0c2OUşOurense000016Oregon#013ş0c2CRşCrook00001AIsrael#003ş0c2JEşJerusalem00001ATennessee#015ş0c2CNşCannon000018Colorado#107ş0c2ROşRoutt000018Montana#077ş0c2PWşPowell00001CAlabama#123ş0c2TLşTallapoosa00001CNewWorld#105ş0c2IDşIndonesia00001FAzerbaijan#77ş0c2SHş&#350;ahbuz000021NorthIreland#09ş0c2CSşCastlereagh000016Wales#10ş0c2GDşGwynedd000016Ecuador#10ş0c2GşGuayas000023Turkey#79ş0c2KKşK&#305;r&#305;kkale000025WorldwithCountries#82ş0c2SZşSwaziland000014China#12ş0c2HUşHubei000032FrenchGuiana#GF.CY.MTş0c2MTşMontsinery Tonnegrande00001APanama#PA.HEş0c2HEşHerrera00001DHongKong#HK.TMş0c2TMşTuen Mun00001BMacedonia#MK.KNş0c2KNşKonce00001CCoteDivoire#CI.LCş0c2LCşLacs00001AEastTimor#TL.DLş0c2DLşDili000019Uganda#UG.MGş0c2MGşMayuge000016Benin#BJ.MOş0c2MOşMono00002FHungaryRegions#HU.WTş0c2WTşWestern Transdanubia000017Russia#RU.AMş0c2AMşAmur000028FranceDepartment#FR.PDş0c2PDşPuy de Dome00001BThailand#TH.PYş0c2PYşPhayao00001BThailand#TH.REş0c2REşRoi Et000020Namibia#NA.ODş0c2ODşOtjozondjupa000018Nigeria#NG.OGş0c2OGşOgun000022BurkinaFaso#BF.OBş0c2OBşOubritenga00001ENorthCarolina#193ş0c2WIşWilkes00001DVirginia#095ş0c2JCşJames City000018Africa#025ş0c2LIşLiberia00001CAlaska#185ş0c2NSşNorth Slope000019Kansas#147ş0c2PLşPhillips00001CIllinois#183ş0c2VEşVermilion000017Missouri#103ş0c2KNşKnox00001ACalifornia#007ş0c2BUşButte000017Texas#175ş0c2GOLşGoliad000015Ohio#137ş0c2PUşPutnam000017Nebraska#107ş0c2KNşKnox00001DMinnesota#035ş0c2CIşCrow Wing000017Kentucky#019ş0c2BYşBoyd00001DMichigan#029ş0c2CHşCharlevoix000021SpainProvinces#039ş0c2PAşPalencia000019Israel#004ş0c2NRşNorthern00001AOklahoma#149ş0c2WHşWashita000019Wisconsin#091ş0c2PEşPepin000017NewWorld#106ş0c2IAşIran000021Washington#051ş0c2PEşPend Oreille00001AIndiana#153ş0c2SLşSullivan000029NewCaledonia#NC.NO.HOş0c2HOşHoua&iuml;lou000023Azerbaijan#78ş0c2SRş&#350;&#601;rur00001FNorthIreland#10ş0c2CLşColeraine00001FWales#11ş0c2AYşIsle of Anglesey00001FRomania#25ş0c2MMşMaramure&#351;000018Ecuador#11ş0c2IşImbabura00001FNorthKorea#01ş0c2CHAşChagang-do000020Turkey#80ş0c2SRş&#350;&#305;rnak000024WorldwithCountries#83ş0c2TZşTanzania00003DIceland#19ş0c2NIşNor&eth;ur-&Iacute;safjar&eth;ars&yacute;sla000017China#13ş0c2XJşXinjiang00001ASomalia#SO.BKş0c2BKşBakool00001CBurma#MM.CHş0c2CHşChin State00001ESamoa #WS.VFş0c2VFşVaao Fonoti000018Niger#NE.MAş0c2MAşMaradi000018Yemen#YE.DHş0c2DHşDhamar00001BMongolia#MN.ERş0c2ERşOrkhon00001AUganda#UG.MHş0c2MHşMaracha00001BLibya#LY.SHş0c2SHşAsh Shati000017Iran#IR.QZş0c2QZşQazvin00001ALebanon#LE.BAş0c2BAşBeirut000019Ethiopia#ET.AFş0c2AFşAfar000022BurkinaFaso#BF.NMş0c2NMşNamentenga00001DGambia#GM.NBş0c2NBşNorth Bank000018Nevada#017ş0c2LIşLincoln00001AIowa#021ş0c2BVşBuena Vista000016Africa#026ş0c2LRşLibya00001ATexas#357ş0c2OCHşOchiltree00001CLouisiana#101ş0c2SRşSt. Mary000019Arizona#025ş0c2YAşYavapai000024Virginia#820ş0c2WBşWaynesboro (City)000020NorthCarolina#013ş0c2BEşBeaufort000019Georgia#165ş0c2JKşJenkins00001CKentucky#201ş0c2ROşRobertson000019Florida#129ş0c2WKşWakulla00001CIllinois#003ş0c2ALşAlexander00001BMississippi#111ş0c2PEşPerry000022PuertoRico#121ş0c2SBşSabana Grande00001DPennsylvania#077ş0c2LHşLehigh000016Idaho#013ş0c2BLşBlaine000019Arkansas#101ş0c2NWşNewton000023SpainProvinces#040ş0c2POşPontevedra000016Oregon#015ş0c2CUşCurry000019Israel#005ş0c2SOşSouthern00001BTennessee#017ş0c2CRşCarroll00001BColorado#109ş0c2SAşSaguache000019Montana#079ş0c2PIşPrairie00001CAlabama#125ş0c2TUşTuscaloosa000018NewWorld#107ş0c2JPşJapan00001FNorthIreland#11ş0c2CKşCookstown00001CWales#12ş0c2MMşMonmouthshire00001FRomania#26ş0c2MHşMehedin&#355;i000014Ecuador#12ş0c2LşLoja000015Turkey#81ş0c2AAşAdana000020WorldwithCountries#84ş0c2TGşTogo000033Iceland#20ş0c2NMşNor&eth;ur-M&uacute;las&yacute;sla00001FFiji#FJ.TH.NOş0c2NOşTholo North000027Kazakhstan#KZ.NKş0c2NKşNorth Kazakhstan00001ADjibouti#DJ.OBş0c2OBşObock000024Guyana#GY.PMş0c2PMşPomeroon-Supenaam000019Russia#RU.RZş0c2RZşRyazan000026Russia#RU.SPş0c2SPşSt. Petersburg City000018Uganda#UG.MIş0c2MIşMpigi00001AQatar#QA.MEş0c2MEşMesaieed00001FBurkinaFaso#BF.ODş0c2ODşOudalan00002EMorocco#MA.MKş0c2MKşMarrakech Tensift Al Haouz000021Chad#TD.MWş0c2MWşMayo-Kebbi Ouest00001DIndiana#155ş0c2SWşSwitzerland00001ENorthCarolina#195ş0c2WLşWilson000021Virginia#097ş0c2KQşKing and Queen00001BAfrica#027ş0c2MGşMadagascar00001DKansas#149ş0c2PTşPottawatomie000019Illinois#185ş0c2WAşWabash00001AMissouri#105ş0c2LDşLaclede00001ECalifornia#009ş0c2CAşCalaveras000019Texas#177ş0c2GONşGonzales00001FVirginia#640ş0c2GAşGalax (City)000017Ohio#139ş0c2RIşRichland00001CNebraska#109ş0c2LAşLancaster00001AMinnesota#037ş0c2DAşDakota000018Kentucky#021ş0c2BLşBoyle00001CMichigan#031ş0c2CEşCheboygan000022SpainProvinces#041ş0c2SAşSalamanca000019Israel#006ş0c2TAşTel Aviv000018Oklahoma#151ş0c2WOşWoods00001AWisconsin#093ş0c2PIşPierce00001DNewWorld#108ş0c2KZşKazakhstan00001BWashington#053ş0c2PIşPierce000014China#15ş0c2GSşGansu00001FNorthIreland#12ş0c2CRşCraigavon00001DWales#13ş0c2MTşMerthyr Tydfil00001BRomania#27ş0c2MSşMure&#351;00001FEcuador#13ş0c2RşLos R&iacute;os000028NorthKorea#03ş0c2HANşHamgy&#335;ng-namdo000028Turkey#82ş0c2CIş&Ccedil;ank&#305;r&#305;000023WorldwithCountries#85ş0c2TNşTunisia000037Iceland#21ş0c2NOşNor&eth;ur-&THORN;ingeyjars&yacute;sla000022SierraLeone#SL.SO.PUş0c2PUşPujehun000024MarshallIsland#MH.MH.UTş0c2UTşUtirik000018Chad#TD.ODş0c2ODşOuaddai000019Somalia#SO.AWş0c2AWşAwdal00001BHongKong#HK.TPş0c2TPşTai Po00001ABurundi#BI.GIş0c2GIşGitega000022Tibet#TI.NGş0c2NGşNagqu Prefecture00001AVietnam#VN.SLş0c2SLşSon La00001DVietnam#VN.TBş0c2TBşThai Binh00001BPalau#PW.HAş0c2HAşHatohobei00001BSriLanka#LK.MTş0c2MTşMatale000017Congo#CG.NIş0c2NIşNiari000024TrinidadandTobago#TT.CAş0c2CAşCaroni00001BLesotho#LS.QTş0c2QTşQuthing000015Nevada#019ş0c2LYşLyon000015Iowa#023ş0c2BTşButler000017Africa#028ş0c2MWşMalawi000021Alaska#188ş0c2NAşNorthwest Arctic000017Texas#359ş0c2OLDşOldham00001FLouisiana#103ş0c2SYşSt. Tammany000016Arizona#027ş0c2YUşYuma00001ENorthCarolina#015ş0c2BRşBertie000019Georgia#167ş0c2JOşJohnson00001DKentucky#203ş0c2RCşRockcastle000018Florida#131ş0c2WTşWalton000017Illinois#005ş0c2BOşBond00001AMississippi#113ş0c2PIşPike00001CPuertoRico#123ş0c2SAşSalinas00001EPennsylvania#079ş0c2LZşLuzerne000015Idaho#015ş0c2BOşBoise00001BArkansas#103ş0c2OUşOuachita00002FSpainProvinces#042ş0c2SCşSanta Cruz de Tenerife00001AOregon#017ş0c2DEşDeschutes00001ATennessee#019ş0c2CTşCarter00001BColorado#111ş0c2SJşSan Juan000019Montana#081ş0c2RAşRavalli000018Alabama#127ş0c2WAşWalker000020NewWorld#109ş0c2KPşKorea (north)000020NewCaledonia#NC.SU.THş0c2THşThio000016China#16ş0c2GXşGuangxi00001BNorthIreland#13ş0c2LDşDerry00001CLuxembourg#02ş0c2CAşCapellen000020Wales#14ş0c2NPşNeath Port Talbot00001BRomania#28ş0c2NTşNeam&#355;00001DEcuador#14ş0c2MşManab&iacute;000019Turkey#83ş0c2GAşGaziantep000022WorldwithCountries#86ş0c2UGşUganda000024PolandCounties#PL.LU.CMş0c2LCMşChelm000024Alberta#CA.AB.ANş0c2ANşAlberta North00001CSomalia#SO.BNş0c2BNşBanaadir00001EEastTimor#TL.VQş0c2VQşViqueque00001ARussia#RU.SRş0c2SRşSaratov00001FMongolia#MN.GAş0c2GAşGovi Altai00001FCoteDivoire#CI.LGş0c2LGşLagunes000030Guinea#GN.TEş0c2TEşT&eacute;lim&eacute;l&eacute;00001EUganda#UG.NAş0c2NAşNakasongola000021FranceDepartment#FR.ORş0c2ORşOrne00001ALibya#LY.AJş0c2AJşAjdabiya000019Monaco#EU.MNş0c2MNşMonaco000025DenmarkRegion#DK.MJş0c2MJşMidtjylland00001BNamibia#NA.OHş0c2OHşOmaheke00001CSomalia#SO.TOş0c2TOşTogdheer00001CAlgeria#DZ.LGş0c2LGşLaghouat00001CIndiana#157ş0c2TIşTippecanoe00001ENorthCarolina#197ş0c2YAşYadkin00001EVirginia#099ş0c2KGşKing George000015Africa#029ş0c2MLşMali000016Kansas#151ş0c2PRşPratt000019Illinois#187ş0c2WRşWarren00001CMissouri#107ş0c2LFşLafayette00001BCalifornia#011ş0c2COşColusa000015Texas#179ş0c2GRAşGray000013Ohio#141ş0c2ROşRoss00001ANebraska#111ş0c2LIşLincoln000019Minnesota#039ş0c2DDşDodge00001AKentucky#023ş0c2BKşBracken00001BMichigan#033ş0c2CIşChippewa000020SpainProvinces#043ş0c2SEşSegovia00001BOklahoma#153ş0c2WDşWoodward000018Wisconsin#095ş0c2POşPolk000020NewWorld#110ş0c2KRşKorea (south)00001DWashington#055ş0c2SJşSan Juan00002DPrinceEdwardIsland#CA.PE.ALş0c2ALşAnne's Land000016Belarus#01ş0c2BRşBrest00001ANorthIreland#14ş0c2DWşDown000024Luxembourg#03ş0c2ESşEsch-sur-Alzette000016Wales#15ş0c2NOşNewport000014Romania#29ş0c2OTşOlt00001BColombia#01ş0c2AMAşAmazonas00001FEcuador#15ş0c2SşMorona-Santiago000014Turkey#84ş0c2KAşKars00002AWorldwithCountries#87ş0c2WAşWestern Sahara00002FIceland#23ş0c2RAşRang&aacute;rvallas&yacute;sla000023FrenchGuiana#GF.CY.MYş0c2MYşMatoury000033NorthWestTerritories#CA.NT.BLş0c2BLşBigLake Country00001DMacedonia#MK.KSş0c2KSşKrusevo00001DMacedonia#MK.LIş0c2LIşLipkovo00001AZambia#ZM.CEş0c2CEşCentral000019Yemen#YE.DLş0c2DLşAl Dali00001BLibya#LY.TBş0c2TBşTarabulus00002DSolomonIsland#SB.RBş0c2RBşRennell and Bellona00001ERussia#RU.ARş0c2ARşArkhangelsk000018Guinea#GN.BEş0c2BEşBeyla00001APakistan#PK.SDş0c2SDşSindh00001CSwaziland#SZ.HHş0c2HHşHhohho00001ALibya#LY.BAş0c2BAşBenghazi000018Nauru#NR.ABş0c2ABşAnabar00001AEurope2#EU.GRş0c2GRşGreece00001DNewWorld#111ş0c2KGşKyrgyzstan000018Nevada#021ş0c2MIşMineral000016Iowa#025ş0c2CAşCalhoun00001BAfrica#030ş0c2MRşMauritania000017Texas#361ş0c2ORAşOrange00001ELouisiana#105ş0c2TAşTangipahoa00001ENorthCarolina#017ş0c2BLşBladen000017Georgia#169ş0c2JNşJones000018Kentucky#205ş0c2RWşRowan00001CFlorida#133ş0c2WGşWashington000018Illinois#007ş0c2BNşBoone00001EMississippi#115ş0c2POşPontotoc000026PuertoRico#125ş0c2SGşSan Germ&aacute;n00001FPennsylvania#081ş0c2LYşLycoming000016Idaho#017ş0c2BRşBonner000018Arkansas#105ş0c2PEşPerry000020SpainProvinces#044ş0c2SVşSevilla000018Oregon#019ş0c2DOşDouglas00001CTennessee#021ş0c2CHşCheatham00001DColorado#113ş0c2SMşSan Miguel00001AMontana#083ş0c2RIşRichland00001CAlabama#129ş0c2WSşWashington000016China#18ş0c2GZşGuizhou000017Belarus#02ş0c2HOşHomyel000030NorthIreland#15ş0c2DNşDungannon and South Tyrone000025USASouthEastRegion#22ş0c2LAşLouisiana00001ELuxembourg#04ş0c2LUşLuxembourg00001CWales#16ş0c2PEşPembrokeshire000018Romania#30ş0c2PHşPrahova00001AJamacia#01ş0c2CLşClarendon00001CColombia#02ş0c2ANTşAntioquia000023NorthKorea#06ş0c2HWNşHwanghae-namdo000019Turkey#85ş0c2ZOşZonguldak000022WorldwithCountries#88ş0c2ZMşZambia00001ELiechtenstein#01ş0c2BAşBalzers000022MarshallIsland#MH.MH.EBş0c2EBşEbon00001CRussia#RU.STş0c2STşStavropol000019Uganda#UG.LWş0c2LWşLuwero00001CRussia#RU.ASş0c2ASşAstrakhan000018Guinea#GN.BFş0c2BFşBoffa00001AThailand#TH.SAş0c2SAşSatun000024TrinidadandTobago#TT.TOş0c2TOşTobago00001DVietnam#VN.BDş0c2BDşBinh Dinh000018Angola#AO.ZAş0c2ZAşZaire00002CBrazilRegion#BR.CWş0c2CWşCentral West Region00001FBurkinaFaso#BF.NRş0c2NRşNahouri000017NewWorld#112ş0c2LAşLaos00001BWashington#057ş0c2SAşSkagit000018Indiana#159ş0c2TPşTipton00001ENorthCarolina#199ş0c2YNşYancey00001FVirginia#101ş0c2KWşKing William00001DRhodeIsland#001ş0c2BRşBristol000018Kansas#153ş0c2RAşRawlins00001DIllinois#189ş0c2WSşWashington00001BMissouri#109ş0c2LAşLawrence000021California#013ş0c2CNşContra costa000018Texas#181ş0c2GRYşGrayson000017Ohio#143ş0c2SAşSandusky000018Nebraska#113ş0c2LOşLogan00001BMinnesota#041ş0c2DUşDouglas00001CKentucky#025ş0c2BHşBreathitt000018Michigan#035ş0c2CLşClare00001ESpainProvinces#045ş0c2SOşSoria00001BWisconsin#097ş0c2PRşPortage000027Manitoba#CA.MB.WIş0c2WIşWinnipeq Region000017China#19ş0c2LNşLiaoning000017Belarus#03ş0c2HRşHrodna00001FNorthIreland#16ş0c2FEşFermanagh00001ALuxembourg#05ş0c2MEşMersch000014Wales#17ş0c2POşPowys00001BRomania#31ş0c2SJşS&#259;laj000018Jamacia#02ş0c2HAşHanover000019Colombia#03ş0c2ARAşArauca000017Ecuador#17ş0c2YşPastaza000023NorthKorea#07ş0c2HWBşHwanghae-bukto000017Turkey#86ş0c2ARşArdahan000018SouthKorea#01ş0c2CJşJeju000024WorldwithCountries#89ş0c2ZWşZimbabwe00001DLiechtenstein#02ş0c2ESşEschen00002BNewBrunswick#CA.NB.MRş0c2MRşMiramichi River00002APolandCounties#PL.SL.CMş0c2SCMşCzestochowa000025PolandCounties#PL.PM.GMş0c2PGMşGdansk000028PolandCounties#PL.PD.BMş0c2PBMşBialystok000027CentralAmerica2#CE.PRş0c2PRşPuerto Rico00001CSenegal#SN.DBş0c2DBşDiourbel000019Uganda#UG.MNş0c2MNşMukono00001EThailand#TH.SBş0c2SBşSing Buri000031DemocraticRepublicoftheCongo#CD.SKş0c2SKşSud-Kivu00001CNamibia#NA.OKş0c2OKşOkavango000018Nigeria#NG.ONş0c2ONşOndo000018Alabama#131ş0c2WIşWilcox00001BNewWorld#113ş0c2MYşMalaysia000014Nevada#023ş0c2NYşNye000016Iowa#027ş0c2CRşCarroll000018Africa#032ş0c2MAşMorocco00001BTexas#363ş0c2PALşPalo Pinto00001ALouisiana#107ş0c2TEşTensas000021NorthCarolina#019ş0c2BSşBrunswick000017Georgia#171ş0c2LAşLamar00001AKentucky#207ş0c2RSşRussell000018Illinois#009ş0c2BRşBrown00001EMississippi#117ş0c2PSşPrentiss000027PuertoRico#127ş0c2SJşSan Juan (capital)00001DPennsylvania#083ş0c2MKşMcKean000019Texas#001ş0c2ANDşAnderson00001AIdaho#019ş0c2BVşBonneville00001BArkansas#107ş0c2PHşPhillips000022SpainProvinces#046ş0c2TAşTarragona000018Oregon#021ş0c2GIşGilliam00001BTennessee#023ş0c2CSşChester00001BColorado#115ş0c2SEşSedgwick00001BMontana#085ş0c2ROşRoosevelt00001ELiechtenstein#03ş0c2GAşGamprin000019China#20ş0c2NMşNei Mongol000019Belarus#04ş0c2MAşMahilyow00001BNorthIreland#17ş0c2LRşLarne00001BMalta#01ş0c2GHşG&#295;awdex00001CLuxembourg#06ş0c2CLşClervaux000018Taiwan#01ş0c2CGşChanghua000021Wales#18ş0c2RTşRhondda Cynon Taff00001ARomania#32ş0c2SMşSatu Mare000023Colombia#04ş0c2ATLşAtl&aacute;ntico000019Ecuador#18ş0c2PşPichincha000021NorthKorea#08ş0c2KAEşKaes&#335;ng00001BTurkey#87ş0c2BRşBart&#305;n000022WorldwithCountries#90ş0c2GMşGambia000029CentralAfricanRepublic#CF.VKş0c2VKşVakaga000018Somalia#SO.BRş0c2BRşBari00001DRussia#RU.SVş0c2SVşSverdlovsk000017Russia#RU.TLş0c2TLşTula000018Uganda#UG.NEş0c2NEşNebbi000020Russia#RU.BKş0c2BKşBashkortostan000017Iran#IR.SMş0c2SMşSemnan00001EVietnam#VN.TGş0c2TGşTien Giang000049Ethiopia#ET.SNş0c2SNşSouthern (Nations,Nationalities and People's Region)000025DenmarkRegion#DK.NDş0c2NDşNordjylland000028WesternSahara#AF.WSş0c2WSşWestern Sahara00001BEthiopia#ET.AMş0c2AMşAmhara000017Togo#TG.CEş0c2CEşCentre00001BEurope2#EU.GUş0c2GUşGuersey00001BNewWorld#114ş0c2MNşMongolia00001DWashington#059ş0c2SKşSkamania000017Indiana#161ş0c2UNşUnion00001CVirginia#103ş0c2LAşLancaster00001BAfrica#033ş0c2MZşMozambique00001ARhodeIsland#003ş0c2KEşKent000015Kansas#155ş0c2RNşReno000018Illinois#191ş0c2WYşWayne000018Missouri#111ş0c2LEşLewis00001ECalifornia#015ş0c2DEşDel Norte000016Texas#183ş0c2GREşGregg000015Ohio#145ş0c2SCşScioto000017Nebraska#115ş0c2LUşLoup00001DMinnesota#043ş0c2FAşFaribault00001FKentucky#027ş0c2BGşBreckinridge00001AMichigan#037ş0c2CNşClinton00001FSpainProvinces#047ş0c2TEşTeruel000019Wisconsin#099ş0c2PCşPrice00001DLiechtenstein#04ş0c2MAşMauren00001AChina#21ş0c2NXşNingxia Hui00001ENorthIreland#18ş0c2LMşLimavady00001CFinland#01ş0c2ALş&Aring;land000016Malta#02ş0c2KEşKemmuna00001CLuxembourg#07ş0c2DIşDiekirch000016Taiwan#02ş0c2CHşChiayi000019Lithuania#56ş0c2ALşAlytus000016Wales#19ş0c2SWşSwansea000016Romania#33ş0c2SBşSibiu00001BJamacia#04ş0c2MAşManchester00001AEcuador#19ş0c2TşTungurahua000024NorthKorea#09ş0c2KANşKangw&#335;n-do00001FTurkey#88ş0c2IGşI&#287;d&#305;r000020SouthKorea#03ş0c2CBşJeollabuk-do000021WorldwithCountries#91ş0c2CGşCongo000023MarshallIsland#MH.MH.EEş0c2EEşEbeya000024Alberta#CA.AB.ASş0c2ASşAlberta South00002CDistrictofColumbia#US.DC.SEş0c2SEşSouth East00001ARwanda#RW.OUş0c2OUşWestern00001BLaos#LA.XSş0c2XSşXaisomboun000022Guyana#GY.PTş0c2PTşPotaro-Siparuni000018Jordan#JO.AJş0c2AJşAjlun00001BRussia#RU.BLş0c2BLşBelgorod00001AChina2#CN.QHş0c2QHşQinghai00001DVietnam#VN.THş0c2THşThanh Hoa00001BThailand#TH.RNş0c2RNşRanong00001BEthiopia#ET.SOş0c2SOşSomali000019Lebanon#LE.BIş0c2BIşBeqaa000021Lebanon#LE.ASş0c2ASşNorth Lebanon00001DVietnam#VN.BGş0c2BGşBac Giang000022Thailand#TH.ACş0c2ACşAmnat Charoen000026BurkinaFaso#BF.PAş0c2PAşPassor&eacute;000019Montana#087ş0c2RSşRosebud000019Alabama#133ş0c2WNşWinston000018NewWorld#115ş0c2NPşNepal000013Iowa#029ş0c2CSşCass000018Africa#034ş0c2NAşNamibia000017Texas#365ş0c2PANşPanola00001ELouisiana#109ş0c2TRşTerrebonne000020NorthCarolina#021ş0c2BUşBuncombe000018Georgia#173ş0c2LNşLanier00001FAlaska#013ş0c2AEşAleutians East000018Kentucky#209ş0c2SCşScott000019Illinois#011ş0c2BUşBureau00001DMississippi#119ş0c2QUşQuitman000020PuertoRico#129ş0c2SLşSan Lorenzo00001DPennsylvania#085ş0c2MEşMercer000018Texas#003ş0c2ANRşAndrews000018Idaho#021ş0c2BUşBoundary000017Arkansas#109ş0c2PIşPike00001FSpainProvinces#048ş0c2TOşToledo000016Oregon#023ş0c2GRşGrant00001DTennessee#025ş0c2CBşClaiborne000019Colorado#117ş0c2SUşSummit00002DIceland#28ş0c2SKşSkagafjar&eth;ars&yacute;sla00001ELiechtenstein#05ş0c2PLşPlanken000016Belarus#06ş0c2MIşMinsk00002FSaintVincentandtheGrenadines#01ş0c2CHşCharlotte00001DNorthIreland#19ş0c2LBşLisburn000014Malta#03ş0c2MAşMalta00001BLuxembourg#08ş0c2REşRedange00001DTaiwan#03ş0c2CSşChiayi (City)000019Lithuania#57ş0c2KUşKaunas000016Wales#20ş0c2TFşTorfaen000018Romania#34ş0c2SVşSuceava000020Ecuador#20ş0c2ZşZamora-Chinchipe00001CTurkey#89ş0c2KBşKarab&uuml;k000025WorldwithCountries#92ş0c2MIşMauritius000032DemocraticRepublicoftheCongo#CD.BCş0c2BCşBas-Congo00001EHongKong#HK.TWş0c2TWşTsuen Wan000018Jordan#JO.BAş0c2BAşBalqa00001CMacedonia#MK.KXş0c2KXşKarpos000025Macedonia#MK.MDş0c2MDşMakedonski Brod00001BRussia#RU.UDş0c2UDşUdmurtia000023CoteDivoire#CI.MCş0c2MCşMoyen-Comoe000017Oman#OM.JAş0c2JAşDhofar00001ANamibia#NA.ONş0c2ONşOshana000026Ethiopia#ET.BEş0c2BEşBenshangul- Gumaz00001BAlgeria#DZ.MCş0c2MCşMascara00001BNewWorld#116ş0c2PKşPakistan00001EWashington#061ş0c2SNşSnohomish00001DIndiana#163ş0c2VAşVanderburgh000016Virginia#105ş0c2LEşLee000016Africa#035ş0c2NEşNiger00001DRhodeIsland#005ş0c2NPşNewport000019Kansas#157ş0c2RPşRepublic000018Illinois#193ş0c2WHşWhite00001AMissouri#113ş0c2LCşLincoln00001ECalifornia#017ş0c2ELşEl Dorado000017Texas#185ş0c2GRIşGrimes000015Ohio#147ş0c2SEşSeneca00001CNebraska#117ş0c2MPşMcPherson00001CMinnesota#045ş0c2FIşFillmore00001AKentucky#029ş0c2BIşBullitt00001BMichigan#039ş0c2CRşCrawford000021SpainProvinces#049ş0c2VAşValencia00001AWisconsin#101ş0c2RAşRacine000027WorldwithCountries#93ş0c2AFşAfghanistan00003CIceland#29ş0c2SHşSn&aelig;fellsnes-og Hnappadalss&yacute;sla00001ELiechtenstein#06ş0c2RUşRuggell000019Belarus#07ş0c2VIşVitsebsk000032SaintVincentandtheGrenadines#02ş0c2ANşSaint Andrew000021NorthIreland#20ş0c2MFşMagherafelt000019Luxembourg#09ş0c2WIşWiltz000017Taiwan#04ş0c2HHşHsinchu000020Lithuania#58ş0c2KLşKlaip&#279;da000020Wales#21ş0c2VGşVale of Glamorgan00001ARomania#35ş0c2TRşTeleorman000028NorthKorea#11ş0c2PYBşP'y&#335;ngan-bukto000015Turkey#90ş0c2KIşKilis000025SouthKorea#05ş0c2GBşChungcheongbuk-do000027Alberta#CA.AB.CAş0c2CAşCalgary and Area000023MarshallIsland#MH.MH.WHş0c2WHşWotho00001DMacedonia#MK.KYş0c2KYşKratovo00001CMacedonia#MK.LOş0c2LOşLozovo000026Sudan#SD.NBş0c2NBşNorth Bahr Al Ghazal000019Nepal#NP.GAş0c2GAşGandaki000018Russia#RU.TOş0c2TOşTomsk000016Libya#LY.SRş0c2SRşSurt000030FranceDepartment#FR.POş0c2POşPyrenees Orientales00001DVietnam#VN.STş0c2STşSoc Trang00001EGuinea#GN.BKş0c2BKşBok&eacute;00001EVietnam#VN.BIş0c2BIşBinh Duong000021Turkmenistan#TM.DAş0c2DAşDashoguz000024Morocco#MA.MTş0c2MTşMeknes-Tafilalet000019Algeria#DZ.MDş0c2MDşMedea000019Montana#089ş0c2SAşSanders00001ENewWorld#117ş0c2PHşPhilippines000019Nevada#027ş0c2PEşPershing000014Iowa#031ş0c2CEşCedar000018Africa#036ş0c2NGşNigeria000017Texas#367ş0c2PARşParker000019Louisiana#111ş0c2UNşUnion000026Virginia#830ş0c2WLşWilliamsburg (City)00001DNorthCarolina#023ş0c2BKşBurke000019Georgia#175ş0c2LUşLaurens000019Kentucky#211ş0c2SHşShelby00001AIllinois#013ş0c2CAşCalhoun00001CMississippi#121ş0c2RAşRankin000018Europe#001ş0c2ALşAlbania000029PuertoRico#131ş0c2SSşSan Sebasti&aacute;n00001EPennsylvania#087ş0c2MIşMifflin000019Texas#005ş0c2ANGşAngelina000015Idaho#023ş0c2BTşButte00001BArkansas#111ş0c2POşPoinsett000023SpainProvinces#050ş0c2VLşValladolid000017Oregon#025ş0c2HAşHarney000018Tennessee#027ş0c2CYşClay000019Colorado#119ş0c2TEşTeller000023WorldwithCountries#94ş0c2AMşArmenia000024Iceland#30ş0c2STşStrandas&yacute;sla00001DLiechtenstein#07ş0c2SNşSchaan000015China#24ş0c2SXşShanxi000031SaintVincentandtheGrenadines#03ş0c2DAşSaint David00001BNorthIreland#21ş0c2MYşMoyle000027USASouthEastRegion#28ş0c2MSşMississippi00001BLuxembourg#10ş0c2VIşVianden00001ETaiwan#05ş0c2HSşHsinchu (City)000023Lithuania#59ş0c2MRşMarijampol&#279;000016Wales#22ş0c2WXşWrexham00001BRomania#36ş0c2TMşTimi&#351;000019Jamacia#07ş0c2POşPortland000021Colombia#08ş0c2CAQşCaquet&aacute;000020Ecuador#22ş0c2UşSucumb&iacute;os000024NorthKorea#12ş0c2PYOşP'y&#335;ngyang000018Turkey#91ş0c2OSşOsmaniye00001ESouthKorea#06ş0c2KWşGangwon-do00001FKazakhstan#KZ.PAş0c2PAşPavlodar000018Jordan#JO.AMş0c2AMşAmman000023Macedonia#MK.KZş0c2KZşKriva Palanka000021Libya#LY.SSş0c2SSşSabratah Surman000024Tibet#TI.NPş0c2NPşNyinchi Prefecture00001DThailand#TH.SGş0c2SGşSongkhla000038Pakistan#PK.TAş0c2TAşFederally Administered Tribal Areas000016Nauru#NR.AIş0c2AIşAiwo000018Nigeria#NG.OSş0c2OSşOsun00001BEurope2#EU.IEş0c2IEşIreland00002FSaudiArabia#SA.HSş0c2HSşAl Hudud Ash Shamaliyah00001CMacedonia#MK.MGş0c2MGşMogila00001ESudan#SD.NDş0c2NDşNorth Darfur00001DPhilippines#PH.LEş0c2LEşLeyte000019Uganda#UG.MTş0c2MTşMoroto000017Iran#IR.THş0c2THşTehran000020Thailand#TH.SHş0c2SHşSuphan Buri00001BEthiopia#ET.TIş0c2TIşTigray00001BVietnam#VN.BKş0c2BKşBac Can000020Pakistan#PK.BAş0c2BAşBalochistan000020Mauritius#MU.GPş0c2GPşGrand Port00001EBurkinaFaso#BF.NYş0c2NYşNayala000025NewWorld#118ş0c2RUşRussian Federation00001CWashington#063ş0c2SPşSpokane00001CIndiana#165ş0c2VEşVermillion00001AVirginia#107ş0c2LOşLoudoun000020RhodeIsland#007ş0c2PRşProvidence000015Kansas#159ş0c2RCşRice00001CIllinois#195ş0c2WTşWhiteside000017Missouri#115ş0c2LNşLinn00001BCalifornia#019ş0c2FRşFresno00001FAlaska#016ş0c2AWşAleutians West00001ATexas#187ş0c2GUAşGuadalupe000021Virginia#650ş0c2HAşHampton (City)000015Ohio#149ş0c2SHşShelby00001ANebraska#119ş0c2MAşMadison000018Europe#002ş0c2ADşAndorra00001CMinnesota#047ş0c2FRşFreeborn000019Kentucky#031ş0c2BUşButler000018Michigan#041ş0c2DEşDelta00001FSpainProvinces#051ş0c2ZAşZamora00001CWisconsin#103ş0c2RIşRichland000027NewCaledonia#NC.SU.BPş0c2BPşBoulouparis000026WorldwithCountries#95ş0c2AZşAzerbaijan000032Iceland#31ş0c2SMşSu&eth;ur-M&uacute;las&yacute;sla000023Liechtenstein#08ş0c2SBşSchellenberg000017China#25ş0c2SDşShandong000032SaintVincentandtheGrenadines#04ş0c2GEşSaint George000026NorthIreland#22ş0c2NMşNewry and Mourne00001ELuxembourg#11ş0c2ECşEchternach000017Taiwan#06ş0c2HLşHualien000026Lithuania#60ş0c2PNşPanev&#279;&#382;ys000017Romania#37ş0c2TLşTulcea00001DJamacia#08ş0c2SDşSaint Andrew000018Colombia#09ş0c2CAUşCauca000014Ecuador#23ş0c2NşNapo000020NorthKorea#13ş0c2YANşYanggang-do000016Turkey#92ş0c2YLşYalova00001BFiji#FJ.NO.MCş0c2MCşMacuata000023MarshallIsland#MH.MH.WJş0c2WJşWotje00001EAlgeria#DZ.MGş0c2MGşMostaganem00001CSamoa #WS.VSş0c2VSşVaisigano000020Guinea#GN.TOş0c2TOşTougu&eacute;00001BUganda#UG.NKş0c2NKşNakaseke00001EThailand#TH.SIş0c2SIşSi Sa Ket000020Kuwait#KW.FAş0c2FAşAl Farwaniyah000018Iran#IR.ARş0c2ARşArdebil00001CVietnam#VN.BLş0c2BLşBac Lieu00001CVietnam#VN.CBş0c2CBşCao Bang000017Nauru#NR.BAş0c2BAşBaiti00001DColorado#121ş0c2WAşWashington00001AMontana#091ş0c2SHşSheridan00001CNewWorld#119ş0c2SGşSingapore000017Nevada#029ş0c2STşStorey00001AIowa#033ş0c2CGşCerro Gordo000017Africa#038ş0c2RWşRwanda000017Texas#369ş0c2PAMşParmer00001DLouisiana#113ş0c2VEşVermilion000020NorthCarolina#025ş0c2CAşCabarrus000015Georgia#177ş0c2LEşLee00001AKentucky#213ş0c2SIşSimpson00001AIllinois#015ş0c2CRşCarroll00001BMississippi#123ş0c2SCşScott000018Europe#003ş0c2ATşAustria000021PuertoRico#133ş0c2SIşSanta Isabel00001DPennsylvania#089ş0c2MOşMonroe000018Texas#007ş0c2ARAşAransas000015Idaho#025ş0c2CAşCamas000017Arkansas#113ş0c2PLşPolk000021SpainProvinces#052ş0c2ZRşZaragoza00001BOregon#027ş0c2HRşHood River000019Tennessee#029ş0c2CKşCocke000032MadagascarRegions#MG.FI.AAş0c2AAşAtsimo-Atsinanana000026WorldwithCountries#96ş0c2BDşBangladesh000019USA#RIş0c2RIşRhode Island000036Iceland#32ş0c2SUşSu&eth;ur-&THORN;ingeyjars&yacute;sla00001ELiechtenstein#09ş0c2TNşTriesen000016China#26ş0c2SAşShaanxi000033SaintVincentandtheGrenadines#05ş0c2PAşSaint Patrick000022NorthIreland#23ş0c2NWşNewtownabbey000018Finland#06ş0c2LAşLapland000020Luxembourg#12ş0c2GRşGrevenmacher00001FTaiwan#07ş0c2KHşKaohsiung(City)000022Lithuania#61ş0c2SAş&Scaron;iauliai000017Indonesia#01ş0c2ACşAceh000017Romania#38ş0c2VSşVaslui00001AJamacia#09ş0c2SNşSaint Ann000018Colombia#10ş0c2CESşCesar000018Ecuador#24ş0c2DşOrellana00001ANorthKorea#14ş0c2NAMşNampo00001ATurkey#93ş0c2DUşD&uuml;zce000017Somalia#SO.BYş0c2BYşBay00001DZambia#ZM.COş0c2COşCopperbelt00001EPhilippines#PH.LGş0c2LGşLaguna000022PapuaNewGuinea#PG.CEş0c2CEşCentral00001ARussia#RU.BRş0c2BRşBryansk00001CVietnam#VN.TNş0c2TNşTay Ninh00001FThailand#TH.RTş0c2RTşRatchaburi00001BNamibia#NA.OSş0c2OSşOmusati00001BNigeria#NG.PLş0c2PLşPlateau000018Wisconsin#105ş0c2ROşRock00001CNewWorld#120ş0c2LKşSri Lanka00001CWashington#065ş0c2STşStevens000016Indiana#167ş0c2VIşVigo000019Virginia#109ş0c2LUşLouisa000020RhodeIsland#009ş0c2WAşWashington000016Kansas#161ş0c2RLşRiley000017Illinois#197ş0c2WIşWill00001DMissouri#117ş0c2LIşLivingston00001ACalifornia#021ş0c2GLşGlenn000015Texas#189ş0c2HAEşHale000014Ohio#151ş0c2STşStark00001ANebraska#121ş0c2MEşMerrick000018Europe#004ş0c2BYşBelarus00001BMinnesota#049ş0c2GOşGoodhue00001BKentucky#033ş0c2CAşCaldwell00001CMichigan#043ş0c2DIşDickinson000023NewCaledonia#NC.SU.BRş0c2BRşBourail000022WorldwithCountries#97ş0c2BTşBhutan000022Liechtenstein#10ş0c2TBşTriesenberg000030SaintVincentandtheGrenadines#06ş0c2GTşGrenadines000020NorthIreland#24ş0c2NDşNorth Down00001ALuxembourg#13ş0c2RMşRemich000019Taiwan#08ş0c2KCşKaohsiung00001FLithuania#62ş0c2TAşTaurag&#279;000017Indonesia#02ş0c2BAşBali00001DRomania#39ş0c2VLşV&acirc;lcea000020Jamacia#10ş0c2SCşSaint Catherine00001FColombia#11ş0c2CHOşChoc&oacute;000028NorthKorea#15ş0c2PYNşP'y&#335;ngan-namdo000016Iraq#01ş0c2ANşAl-Anbar000019Senegal#SN.DKş0c2DKşDakar00001FLesotho#LS.BBş0c2BBşButha-Buthe000018Jordan#JO.AQş0c2AQşAqaba00001CRussia#RU.TTş0c2TTşTatarstan00001FUK7#UK.CIş0c2CIşChannel Islands00001CEastTimor#TL.ERş0c2ERşErmera00001CUganda#UG.NMş0c2NMşNamutumba000025Libya#LY.TMş0c2TMşTarhunah Masallatah00001CTunisia#TN.JEş0c2JEşJendouba00001CThailand#TH.SKş0c2SKşSa Kaeo000024Qatar#QA.MSş0c2MSşMadinat Ach Shamal00001CVietnam#VN.BNş0c2BNşBac Ninh000021SriLanka#LK.NWş0c2NWşNuwara Eliya00001CNamibia#NA.OTş0c2OTşOshikoto000017Colorado#123ş0c2WLşWeld00001CMontana#093ş0c2SBşSilver Bow00001DNewWorld#121ş0c2TJşTajikistan000017Nevada#031ş0c2WAşWashoe000017Iowa#035ş0c2CHşCherokee000026Africa#040ş0c2STşSao Tome and Principe000016Texas#371ş0c2PECşPecos00001ALouisiana#115ş0c2VNşVernon000020NorthCarolina#027ş0c2CLşCaldwell000019Georgia#179ş0c2LIşLiberty00001AKentucky#215ş0c2SPşSpencer000017Illinois#017ş0c2CSşCass00001DMississippi#125ş0c2SHşSharkey000018Europe#005ş0c2BEşBelgium00001DPuertoRico#135ş0c2TAşToa Alta000021Pennsylvania#091ş0c2MTşMontgomery000017Texas#009ş0c2ARCşArcher000016Idaho#027ş0c2CNşCanyon000017Arkansas#115ş0c2PPşPope000018Oregon#029ş0c2JAşJackson00001ATennessee#031ş0c2CFşCoffee000026Manitoba#CA.MB.WRş0c2WRşWestern Region000022WorldwithCountries#98ş0c2BNşBrunei000035Iceland#34ş0c2VBşVestur-Bar&eth;astrandars&yacute;sla00001CLiechtenstein#11ş0c2VAşVaduz00001BNorthIreland#25ş0c2OMşOmagh000015Finland#08ş0c2OUşOulu00001ETaiwan#09ş0c2CLşKeelung (City)000021Lithuania#63ş0c2TEşTel&scaron;iai00001BIndonesia#03ş0c2BEşBengkulu00002ABritishColumbia#01ş0c2ACşAlberni-Clayoquot000018Romania#40ş0c2VNşVrancea000020Jamacia#11ş0c2SEşSaint Elizabeth000021Colombia#12ş0c2CORşC&oacute;rdoba000017Iraq#02ş0c2BAşAl-Basrah000019SouthKorea#10ş0c2PUşBusan000033NorthWestTerritories#CA.NT.DCş0c2DCşDiamond Capital000028PolandCounties#PL.DS.WMş0c2DWMşWalbrzych000029Macedonia#MK.MKş0c2MKşMakedonska Kamenica000026Macedonia#MK.NAş0c2NAşStaro Nagoricane00001CComoros #KM.ANş0c2ANşAnjouan000017Russia#RU.TUş0c2TUşTuva00001AMongolia#MN.HDş0c2HDşKhovd00001FSamoa #WS.FAş0c2FAşFaasaleleaga00002DLibya#LY.TNş0c2TNşTajura wa an Nawahi Al Arba00001BIran#IR.BKş0c2BKşKermanshah000018Wisconsin#107ş0c2RUşRusk00001BNewWorld#122ş0c2THşThailand00001DWashington#067ş0c2THşThurston000018Indiana#169ş0c2WAşWabash00001CVirginia#111ş0c2LNşLunenburg000018Africa#041ş0c2SNşSenegal00002FAlaska#201ş0c2PWşPrince of Wales-Outer Ketchika000016Kansas#163ş0c2ROşRooks00001DIllinois#199ş0c2WLşWilliamson00001BMissouri#119ş0c2MNşMcDonald00001DCalifornia#023ş0c2HUşHumboldt00001AAlaska#020ş0c2ANşAnchorage000015Texas#191ş0c2HALşHall000015Ohio#153ş0c2SUşSummit00001ANebraska#123ş0c2MOşMorrill000027Europe#006ş0c2BAşBosnia and Herzegovina000019Minnesota#051ş0c2GRşGrant00001BKentucky#035ş0c2CLşCalloway000018Michigan#045ş0c2EAşEaton000026Manitoba#CA.MB.ERş0c2ERşEastern Region000023NewCaledonia#NC.NO.KAş0c2KAşKouaoua00002BWorldwithCountries#99ş0c2MMşBurma (Myanmar)000034Iceland#35ş0c2VHşVestur-H&uacute;navatnss&yacute;sla000015China#29ş0c2YNşYunnan00001ENorthIreland#26ş0c2SBşStrabane000019Bangladesh#81ş0c2DAşDhaka00001CSuriname#10ş0c2BRşBrokopondo000016Taiwan#10ş0c2KMşKinmen000018Lithuania#64ş0c2UTşUtena00001AIndonesia#04ş0c2JKşJakarta000028BritishColumbia#02ş0c2BNşBulkley-Nechako000028Romania#41ş0c2CLşC&#259;l&#259;ra&#351;i00001CJamacia#12ş0c2SJşSaint James000028NorthKorea#17ş0c2HABşHamgy&#335;ng-bukto00001EIraq#03ş0c2MUşAl-Muthann&#257;000019SouthKorea#11ş0c2SOşSeoul000028PolandCounties#PL.KP.BMş0c2KBMşBydgoszcz000019Algeria#DZ.NAş0c2NAşNaama000023Tanzania#TZ.ZNş0c2ZNşZanzibar North000018Angola#AO.HLş0c2HLşHuila000021PapuaNewGuinea#PG.CHş0c2CHşChimbu000017Russia#RU.TVş0c2TVşTver00001CRussia#RU.ULş0c2ULşUlyanovsk000017Uganda#UG.MYş0c2MYşMoyo00001BRussia#RU.BUş0c2BUşBuryatia00001BRussia#RU.CKş0c2CKşChukotka00001BRussia#RU.DAş0c2DAşDagestan00001FVietnam#VN.TQş0c2TQşTuyen Quang000027CaymanIslands#KY.SOş0c2SOşLittle Cayman000024Thailand#TH.SMş0c2SMşSamut Songkhram000020Madagascar#MG.MAş0c2MAşMahajanga00001EVietnam#VN.BPş0c2BPşBinh Phuoc000017Nigeria#NG.OYş0c2OYşOyo00001BEurope2#EU.HUş0c2HUşHungary00001CTennessee#033ş0c2COşCrockett000017Colorado#125ş0c2YUşYuma00001CMontana#095ş0c2SWşStillwater00001FNewWorld#123ş0c2TMşTurkmenistan00001BNevada#033ş0c2WPşWhite Pine000018Iowa#037ş0c2CKşChickasaw00001AAfrica#042ş0c2SYşSeycelles000015Texas#373ş0c2POLşPolk00001ELouisiana#117ş0c2WAşWashington00001ENorthCarolina#029ş0c2CMşCamden000019Georgia#181ş0c2LCşLincoln000019Kentucky#217ş0c2TAşTaylor00001CIllinois#019ş0c2CHşChampaign00001DMississippi#127ş0c2SIşSimpson000019Europe#007ş0c2BGşBulgaria00001DPuertoRico#137ş0c2TBşToa Baja00001EPennsylvania#093ş0c2MUşMontour00001ATexas#011ş0c2ARSşArmstrong000017Idaho#029ş0c2CRşCaribou00001AArkansas#117ş0c2PRşPrairie00001AOregon#031ş0c2JEşJefferson00001BUSA#SCş0c2SCşSouth Carolina000039Iceland#36ş0c2VIşVestur-&Iacute;safjar&eth;ars&yacute;sla000018China#30ş0c2GDşGuangdong00001ABangladesh#82ş0c2KHşKhulna000025Australia#NTş0c2NTşNorthern Territory00001CSuriname#11ş0c2CMşCommewijne00001ATaiwan#11ş0c2LKşLienchiang00001ALithuania#65ş0c2VLşVilnius000018Indonesia#05ş0c2JAşJambi000020BritishColumbia#03ş0c2CAşCapital000018Romania#42ş0c2GRşGiurgiu00001BJamacia#13ş0c2SMşSaint Mary00001BColombia#14ş0c2GUVşGuaviare00001FNorthKorea#18ş0c2NAJşRas&#335;n000020Iraq#04ş0c2QAşAl-Q&#257;disiyyah00001BSouthKorea#12ş0c2INşIncheon000026MarshallIsland#MH.MH.ENş0c2ENşEnewetak000024PolandCounties#PL.KP.TOş0c2KTOşTorun00001BFiji#FJ.WE.LTş0c2LTşLautoka000018Algeria#DZ.MLş0c2MLşMila000019Angola#AO.HMş0c2HMşHuambo00001CGuineaBissau#GW.OIş0c2OIşOio000019Lesotho#LS.BEş0c2BEşBerea00001AJordan#JO.ATş0c2ATşTafilah000023Philippines#PH.MAş0c2MAşMaguindanao00001CGabon#GA.WNş0c2WNşWoleu-Ntem000018Niger#NE.NIş0c2NIşNiamey00001CHongKong#HK.EAş0c2EAşEastern000020Uganda#UG.NPş0c2NPşNakapiripirit00001ERussia#RU.CLş0c2CLşChelyabinsk000021Thailand#TH.SNş0c2SNşSakon Nakhon00001BSyria#SY.RAş0c2RAşAr Raqqah00001DNamibia#NA.OWş0c2OWşOhangwena00001DWisconsin#109ş0c2SCşSt. Croix00001DNewWorld#124ş0c2UZşUzbekistan00001EWashington#069ş0c2WKşWahkiakum000018Indiana#171ş0c2WRşWarren00001AVirginia#113ş0c2MAşMadison00001DAfrica#043ş0c2SLşSierra Leone000015Kansas#165ş0c2RHşRush00001CIllinois#201ş0c2WBşWinnebago000018Missouri#121ş0c2MOşMacon00001DCalifornia#025ş0c2IMşImperial000019Texas#193ş0c2HAMşHamilton000017Ohio#155ş0c2TRşTrumbull000018Nebraska#125ş0c2NAşNance000019Georgia#001ş0c2APşAppling000018Europe#008ş0c2HYşCroatia00001CMinnesota#053ş0c2HEşHennepin00001EAustralia2#VICş0c2VICşVictoria00001BKentucky#037ş0c2CBşCampbell000018Michigan#047ş0c2EMşEmmet000019USA#SDş0c2SDşSouth Dakota00002FIceland#37ş0c2VSşVestur-Skaftafellss&yacute;sla000023USARegion#01ş0c2NEşNorthEast Region000015China#31ş0c2HAşHainan000015World#EUş0c2EUşEurope00001CBangladesh#83ş0c2RJşRajshahi000019Suriname#12ş0c2CRşCoronie000016Taiwan#12ş0c2MLşMiaoli000020BritishColumbia#04ş0c2CRşCariboo000016Romania#43ş0c2IFşIlfov00001DJamacia#14ş0c2STşSaint Thomas000021Colombia#15ş0c2GUAşGuain&iacute;a000023Iraq#05ş0c2SUşAs-Sulaym&#257;niyyah00001FArgentina#01ş0c2BAşBuenos Aires00001FSouthKorea#13ş0c2KGşGyeonggi-do000020Europe2#EU.IMş0c2IMşIsles of Man00001FSaudiArabia#SA.JFş0c2JFşAl Jawf00001DHongKong#HK.WCş0c2WCşWan Chai000020Sudan#SD.NKş0c2NKşNorth Kurdufan00001FPhilippines#PH.MBş0c2MBşMasbate00001DMongolia#MN.HGş0c2HGşKhovsgol000022CoteDivoire#CI.NCş0c2NCşN'zi-Comoe000022Cyprus2#CY.TCş0c2TCşTurkish Cyprus00001BThailand#TH.RYş0c2RYşRayong00001EThailand#TH.SOş0c2SOşSukhothai000026TrinidadandTobago#TT.VIş0c2VIşVictoria00001BVietnam#VN.BRş0c2BRşBen Tre00001ETennessee#035ş0c2CMşCumberland00001DMontana#097ş0c2SGşSweet Grass00001ANewWorld#125ş0c2VNşVietnam000015Iowa#039ş0c2CLşClarke000018Africa#044ş0c2SOşSomalia000017Texas#375ş0c2POTşPotter00001BLouisiana#119ş0c2WEşWebster000020NorthCarolina#031ş0c2CRşCarteret000016Georgia#183ş0c2LOşLong000017Kentucky#219ş0c2TOşTodd00001CIllinois#021ş0c2CIşChristian00001BMississippi#129ş0c2SMşSmith00001FEurope#009ş0c2CZşCzech Republic000022PuertoRico#139ş0c2TJşTrujillo Alto000022Pennsylvania#095ş0c2NOşNorthampton000019Texas#013ş0c2ATAşAtascosa000016Idaho#031ş0c2CSşCassia00001AArkansas#119ş0c2PUşPulaski00001AOregon#033ş0c2JOşJosephine000027NorthAmerica_WOCentral#005ş0c2CAşCanada000023USARegion#02ş0c2NWşNorthWest Region000016China#32ş0c2SCşSichuan00001EBangladesh#84ş0c2CGşChittagong00001BSuriname#13ş0c2MAşMarowijne000016Taiwan#13ş0c2NTşNantou00001FIndonesia#07ş0c2JTşCentral Java000026BritishColumbia#05ş0c2CNşCentral Coast000019Jamacia#15ş0c2TRşTrelawny000018Colombia#16ş0c2HUIşHuila000018Norway#01ş0c2AKşAkershus000018Iraq#06ş0c2BBşB&#257;bil00001CArgentina#02ş0c2CTşCatamarca000024SouthKorea#14ş0c2KBşGyeongsangbuk-do00001DBhutan#BT.PMş0c2PMşPemagatsel000031DemocraticRepublicoftheCongo#CD.BNş0c2BNşBandundu00001AZambia#ZM.EAş0c2EAşEastern00002APhilippines#PH.MCş0c2MCşOccidental Mindoro000019Russia#RU.TYş0c2TYşTyumen000028HongKong#HK.CWş0c2CWşCentral and Western00001BRussia#RU.CNş0c2CNşChechnya000022Vietnam#VN.TTş0c2TTşThua Thien Hue00001AGuinea#GN.CKş0c2CKşConakry000021Thailand#TH.SPş0c2SPşSamut Prakan000019Nauru#NR.ARş0c2ARşAnibare000018Wisconsin#111ş0c2SAşSauk000019NewWorld#126ş0c2TWşTaiwan000020Washington#071ş0c2WLşWalla walla000019Indiana#173ş0c2WIşWarrick00001AVirginia#115ş0c2MTşMathews00001DAfrica#045ş0c2ZAşSouth Africa000018Kansas#167ş0c2RSşRussell00001BIllinois#203ş0c2WFşWoodford00001AMissouri#123ş0c2MDşMadison000019California#027ş0c2INşInyo000019Texas#195ş0c2HANşHansford000019Ohio#157ş0c2TUşTuscarawas000019Nebraska#127ş0c2NEşNemaha00001AGeorgia#003ş0c2ATşAtkinson000018Europe#010ş0c2DKşDenmark00001BMinnesota#055ş0c2HUşHouston00001BKentucky#039ş0c2CRşCarlisle00001AMichigan#049ş0c2GEşGenesee000019SouthKorea#15ş0c2TGşDaegu000023USARegion#03ş0c2SEşSouthEast Region00002AUSASouthEastRegion#37ş0c2NCşNorth Carolina00001BBangladesh#85ş0c2BAşBarisal000021Finland#13ş0c2SFşSouthern Finland00001ASuriname#14ş0c2NIşNickerie000016Taiwan#14ş0c2PHşPenghu00001CIndonesia#08ş0c2JIşEast Java000029BritishColumbia#06ş0c2CKşCentral Kootenay000016Albania#40ş0c2BRşBerat00001DJamacia#16ş0c2WEşWestmoreland00001DColombia#17ş0c2LAGşLa Guajira00001ANorway#02ş0c2AAşAust-Agder00001AIraq#07ş0c2BGşBaghd&#257;d000018Argentina#03ş0c2CCşChaco000026PolandCounties#PL.DS.WRş0c2DWRşWroclaw000023FrenchGuiana#GF.CY.OUş0c2OUşOuanary00001BEurope2#EU.HYş0c2HYşCroatia00001AEurope2#EU.JEş0c2JEşJersey00001CBrunei#BN.TEş0c2TEşTemburong00001ABhutan#BT.PNş0c2PNşPunakha000027Philippines#PH.LNş0c2LNşLanao del Norte00002APhilippines#PH.MDş0c2MDşMisamis Occidental00001FMongolia#MN.GSş0c2GSşGovisumber00001AChina2#CN.SAş0c2SAşShaanxi000019Guinea#GN.DBş0c2DBşDabola00001AThailand#TH.TGş0c2TGşTrang00001DSyria#SY.RDş0c2RDşRif Dimashq00001CTennessee#037ş0c2DAşDavidson000017Montana#099ş0c2TEşTeton00001CNewWorld#127ş0c2HKşHong Kong000013Iowa#041ş0c2CYşClay000016Africa#046ş0c2SDşSudan000019Texas#377ş0c2PREşPresidio000024Louisiana#121ş0c2WBşWest Baton Rouge000024Virginia#840ş0c2WTşWinchester (City)00001FNorthCarolina#033ş0c2CSşCaswell000019Georgia#185ş0c2LWşLowndes000018Kentucky#221ş0c2TRşTrigg000018Illinois#023ş0c2CLşClark00001BMississippi#131ş0c2STşStone000018Europe#011ş0c2EEşEstonia00001BPuertoRico#141ş0c2UTşUtuado000025Pennsylvania#097ş0c2NTşNorthumberland000017Texas#015ş0c2AUSşAustin000015Idaho#033ş0c2CLşClark00001BArkansas#121ş0c2RAşRandolph000018Oregon#035ş0c2KLşKlamath000020SouthKorea#16ş0c2CNşJeollanam-do000023USARegion#04ş0c2SWşSouthWest Region000017Peru#01ş0c2AMAşAmazonas000018Uruguay#01ş0c2ARşArtigas00001ABangladesh#86ş0c2SYşSylhet000020Finland#14ş0c2EFşEastern Finland000016Suriname#15ş0c2PRşPara000018Taiwan#15ş0c2PTşPingtung000029BritishColumbia#07ş0c2COşCentral Okanagan00001BAlbania#41ş0c2DIşDib&euml;r000019Jamacia#17ş0c2KIşKingston000018Iraq#08ş0c2DAşDah&#363;k000019Argentina#04ş0c2CHşChubut000019Fiji#FJ.WE.NDş0c2NDşNandi000024MarshallIsland#MH.MH.ERş0c2ERşErikub000020FrenchGuiana#GF.SL.MNş0c2MNşMana00001CBurkinaFaso#BF.POş0c2POşPoni00002AMorocco#MA.OLş0c2OLşOued Ed Dahab-Lagouira00002FTanzania#TZ.ZSş0c2ZSşZanzibar Central and South000019Brunei#BN.BEş0c2BEşBelait00001EMacedonia#MK.NGş0c2NGşNegotino00001CRussia#RU.VGş0c2VGşVolgograd00001BUganda#UG.NTş0c2NTşNtungamo00001ATunisia#TN.KBş0c2KBşKebili00001CVietnam#VN.TVş0c2TVşTra Vinh000017Nauru#NR.UAş0c2UAşUaboe00001DThailand#TH.SRş0c2SRşSaraburi00001EVietnam#VN.BUş0c2BUşBinh Thuan00001BVietnam#VN.DAş0c2DAşDa Nang000024SaoTomeandPrincipe#ST.LEş0c2LEşLemba000018Nauru#NR.ATş0c2ATşAnetan00001AWisconsin#113ş0c2SWşSawyer000018NewWorld#128ş0c2MOşMacau00001CWashington#073ş0c2WAşWhatcom00001CIndiana#175ş0c2WSşWashington00001EVirginia#117ş0c2MEşMecklenburg00001AAfrica#047ş0c2SZşSwaziland000017Kansas#169ş0c2SAşSaline000019Missouri#125ş0c2MEşMaries000019California#029ş0c2KEşKern000019Texas#197ş0c2HARşHardeman000026Virginia#660ş0c2HRşHarrisonburg (City)000014Ohio#159ş0c2UNşUnion00001BNebraska#129ş0c2NUşNuckolls000017Georgia#005ş0c2BAşBacon000018Europe#012ş0c2FIşFinland00001BMinnesota#057ş0c2HBşHubbard00001AKentucky#041ş0c2COşCarroll00001AMichigan#051ş0c2GLşGladwin000027NewCaledonia#NC.NO.KGş0c2KGşKaala-Gomen000036SaintKittsandNevis#01ş0c2CCşChrist Church Nichola Town000021Argentina#05ş0c2CBşC&oacute;rdoba000025SouthKorea#17ş0c2GNşChungcheongnam-do000021USARegion#05ş0c2CRşCentral Region000015Peru#02ş0c2ANCşAncash00001AUruguay#02ş0c2CAşCanelones000020Finland#15ş0c2WFşWestern Finland00001CSuriname#16ş0c2PMşParamaribo000018Taiwan#16ş0c2THşTaichung00001DIndonesia#10ş0c2YOşYogyakarta000029BritishColumbia#08ş0c2CSşColumbia-Shuswap00001CAlbania#42ş0c2DRşDurr&euml;s000017Colombia#19ş0c2METşMeta000018Norway#04ş0c2BUşBuskerud00001FIraq#09ş0c2DQşDh&#299; Q&#257;r000016Mali#ML.SGş0c2SGşSegou00001AZambia#ZM.WEş0c2WEşWestern000029Macedonia#MK.MRş0c2MRşMavrovo and Rostusa00001ASudan#SD.NOş0c2NOşNorthern000019Uganda#UG.OKş0c2OKşKoboko00001AVanuatu#VU.PMş0c2PMşPenama00001AChina2#CN.SCş0c2SCşSichuan000022FranceDepartment#FR.RHş0c2RHşRhone00001DVietnam#VN.VCş0c2VCşVinh Phuc000021Thailand#TH.SSş0c2SSşSamut Sakhon000021Vietnam#VN.BVş0c2BVşBaRia-VungTau00001DVietnam#VN.DBş0c2DBşDien Bien00001BTennessee#039ş0c2DEşDecatur000017Montana#101ş0c2TOşToole00001ANewWorld#129ş0c2ALşAlbania000016Iowa#043ş0c2CTşClayton000019Africa#048ş0c2TZşTanzania000016Texas#379ş0c2RAIşRains000020Louisiana#123ş0c2WCşWest Carroll00001FNorthCarolina#035ş0c2CTşCatawba000019Georgia#187ş0c2LPşLumpkin00001AKentucky#223ş0c2TIşTrimble000017Illinois#025ş0c2CYşClay00001FMississippi#133ş0c2SUşSunflower000017Europe#013ş0c2FRşFrance00001EPuertoRico#143ş0c2VAşVega Alta00001CPennsylvania#099ş0c2PEşPerry000017Texas#017ş0c2BAIşBailey00001AIdaho#035ş0c2CWşClearwater00001EArkansas#123ş0c2SFşSt. Francis000015Oregon#037ş0c2LAşLake000032SaintKittsandNevis#02ş0c2ASşSaint Anne Sandy Point00001DArgentina#06ş0c2CNşCorrientes00001BSouthKorea#18ş0c2KJşGwangju000014China#36ş0c2TBşTibet000017Peru#03ş0c2APUşApurimac00001CUruguay#03ş0c2CLşCerro Largo00001BSuriname#17ş0c2SAşSaramacca000022USANorthWestRegion#02ş0c2AKşAlaska00001FTaiwan#17ş0c2TGşTaichung (City)000022Indonesia#11ş0c2KBşWest Kalimantan000029BritishColumbia#09ş0c2CMşComox-Strathcona000018Albania#43ş0c2ELşElbasan000020Colombia#20ş0c2NARşNari&ntilde;o000018Norway#05ş0c2FIşFinnmark00001EIraq#10ş0c2DIşDiy&#257;l&#257;00002DSierraLeone#SL.WE.WRş0c2WRşWestern Area Rural000027FrenchGuiana#GF.SL.MPş0c2MPşMaripasoula000038NorthWestTerritories#CA.NT.WBş0c2WBşWood Buffalo Country00001CMauritania#MR.ADş0c2ADşAdrar000018Jordan#JO.AZş0c2AZşZarqa00001DMacedonia#MK.NIş0c2NIşVinitsa000020CoteDivoire#CI.MRş0c2MRşMarahoue00001AGabon#GA.ESş0c2ESşEstuaire00001BChina2#CN.SDş0c2SDşShandong000018Guinea#GN.COş0c2COşCoyah000020Thailand#TH.STş0c2STşSurat Thani00001BLibya#LY.BUş0c2BUşAl Butnan000018Iran#IR.BSş0c2BSşBushehr00001AVietnam#VN.CMş0c2CMşCa Mau00001BVietnam#VN.DCş0c2DCşDac Lac00001BWisconsin#115ş0c2SHşShawano00001ANewWorld#130ş0c2ADşAndorra00001CWashington#075ş0c2WHşWhitman000017Indiana#177ş0c2WYşWayne00001CVirginia#119ş0c2MIşMiddlesex000015Africa#049ş0c2TGşTogo000016Kansas#171ş0c2SCşScott000019Missouri#127ş0c2MAşMarion00001ACalifornia#031ş0c2KIşKings000017Texas#199ş0c2HADşHardin000017Ohio#161ş0c2VWşVan Wert00001CNetherland#001ş0c2DRşDrenthe000017Nebraska#131ş0c2OTşOtoe000017Georgia#007ş0c2BKşBaker000018Europe#014ş0c2DEşGermany00001AMinnesota#059ş0c2ISşIsanti000019Kentucky#043ş0c2CTşCarter00001AMichigan#053ş0c2GOşGogebic000033SaintKittsandNevis#03ş0c2GBşSaint George Basseterre000023Argentina#07ş0c2DFşDistrito Federal00001BSouthKorea#19ş0c2TJşDaejeon000017Peru#04ş0c2AREşArequipa000018Uruguay#04ş0c2COşColonia00001CSuriname#18ş0c2SIşSipaliwini000016Taiwan#18ş0c2TAşTainan000023Indonesia#12ş0c2KSşSouth Kalimantan000028BritishColumbia#10ş0c2CVşCowichan Valley000015Albania#44ş0c2FRşFier000025Colombia#21ş0c2NSAşNorte de Santander000017Norway#06ş0c2HEşHedmark000018Iraq#11ş0c2ARşArb&#299;l000025CaymanIslands#KY.CBş0c2CBşCayman Brac00001EThailand#TH.ATş0c2ATşAng Thong00001ACongo#CG.PLş0c2PLşPlateaux00001BEurope2#EU.ISş0c2ISşIceland000019Algeria#DZ.MSş0c2MSşMsila00001DLiberia#LR.RGş0c2RGşRiver Gee000017Bhutan#BT.PRş0c2PRşParo000019Laos#LA.HOş0c2HOşHouaphan000017Benin#BJ.OUş0c2OUşOueme00001FVietnam#VN.TYş0c2TYşThai Nguyen00001AThailand#TH.SUş0c2SUşSurin000018Thailand#TH.TKş0c2TKşTak00001BVietnam#VN.CNş0c2CNşCan Tho00001ATennessee#041ş0c2DKşDeKalb00001AMontana#103ş0c2TRşTreasure00001ANewWorld#131ş0c2ATşAustria000016Iowa#045ş0c2CNşClinton000018Texas#381ş0c2RANşRandall000022Louisiana#125ş0c2WFşWest Feliciana00001FNorthCarolina#037ş0c2CHşChatham00001AGeorgia#189ş0c2MCşMcduffie000018Kentucky#225ş0c2UNşUnion00001ENetherland#002ş0c2FLşFlevoland00001AIllinois#027ş0c2CNşClinton000022Mississippi#135ş0c2TAşTallahatchie000017Europe#015ş0c2GRşGreece00001EPuertoRico#145ş0c2VBşVega Baja000023Pennsylvania#101ş0c2PHşPhiladelphia000018Texas#019ş0c2BANşBandera000016Idaho#037ş0c2CUşCuster000019Arkansas#125ş0c2SAşSaline000015Oregon#039ş0c2LEşLane00002FMadagascarRegions#MG.FI.AMş0c2AMşAmoron'i Mania000033SaintKittsandNevis#04ş0c2GGşSaint George Gingerland000024Argentina#08ş0c2ERşEntre R&iacute;os000024SouthKorea#20ş0c2KNşGyeongsangnam-do000017Peru#05ş0c2AYAşAyacucho000018Uruguay#05ş0c2DUşDurazno000018Suriname#19ş0c2WAşWanica00001DTaiwan#19ş0c2TNşTainan (City)000025Indonesia#13ş0c2KTşCentral Kalimantan000026BritishColumbia#11ş0c2EKşEast Kootenay000021Albania#45ş0c2GJşGjirokast&euml;r00001BColombia#22ş0c2PUTşPutumayo000019Norway#07ş0c2HOşHordaland000015Iraq#12ş0c2KAşKarbala000019Europe2#EU.ITş0c2ITşItaly000022Tanzania#TZ.ZWş0c2ZWşZanzibar West00001DUzbekistan#UZ.JIş0c2JIşJizzax000015UK7#UK.WAş0c2WAşWales000025Philippines#PH.LSş0c2LSşLanao del Sur00002FCentralAmerica2#CE.AGş0c2AGşAntigua and Barbuda00001CMongolia#MN.HNş0c2HNşKhentii000018Uganda#UG.PDş0c2PDşPader000019Benin#BJ.PLş0c2PLşPlateau000017Tunisia#TN.KFş0c2KFşKef00001CLibya#LY.BWş0c2BWşBani Walid00001DWisconsin#117ş0c2SEşSheboygan00001ANewWorld#132ş0c2BYşBelarus00001BWashington#077ş0c2YAşYakima000017Indiana#179ş0c2WEşWells00001DVirginia#121ş0c2MOşMontgomery000018Africa#051ş0c2TNşTunisia000019Kansas#173ş0c2SGşSedgwick000019Missouri#129ş0c2MCşMercer000019California#033ş0c2LAşLake000017Texas#201ş0c2HASşHarris000015Ohio#163ş0c2VIşVinton00001ENetherland#003ş0c2FRşFriesland000019Nebraska#133ş0c2PAşPawnee000019Georgia#009ş0c2BDşBaldwin000018Europe#016ş0c2HUşHungary00001AMinnesota#061ş0c2ITşItasca000018Kentucky#045ş0c2CSşCasey000021Michigan#055ş0c2GTşGrand Traverse000027MadagascarRegions#MG.TL.ADş0c2ADşAndroy000030SaintKittsandNevis#05ş0c2JWşSaint James Windward00001AArgentina#09ş0c2FMşFormosa000019SouthKorea#21ş0c2ULşUlsan000018Peru#06ş0c2CAJşCajamarca000017Uruguay#06ş0c2FSşFlores000013USA#AKş0c2AKşAlaska000016Taiwan#20ş0c2TPşTaipei000022Indonesia#14ş0c2KIşEast Kalimantan000026BritishColumbia#12ş0c2FVşFraser Valley000022Albania#46ş0c2KOşKor&ccedil;&euml;000021Colombia#23ş0c2QUIşQuind&iacute;o000026Norway#08ş0c2MRşM&oslash;re og Romsdal000017Iraq#13ş0c2TSşAt-Ta'mim00002DSierraLeone#SL.WE.WUş0c2WUşWestern Area Urban00002CDistrictofColumbia#US.DC.SWş0c2SWşSouth West000015Nauru#NR.BOş0c2BOşBoe00001EThailand#TH.CBş0c2CBşChon Buri000018Mali#ML.SKş0c2SKşSikasso00001DLiberia#LR.RIş0c2RIşRivercess000021Kazakhstan#KZ.QGş0c2QGşQaraghandy00001BRussia#RU.VLş0c2VLşVladimir000020SolomonIsland#SB.TEş0c2TEşTemotu00001BTennessee#043ş0c2DIşDickson000018Montana#105ş0c2VAşValley00001ANewWorld#133ş0c2BEşBelgium000017Iowa#047ş0c2CFşCrawford000017Africa#052ş0c2UGşUganda000017Texas#383ş0c2REAşReagan000018Louisiana#127ş0c2WIşWinn000020NorthCarolina#039ş0c2CEşCherokee00001AGeorgia#191ş0c2MIşMcintosh000019Kentucky#227ş0c2WAşWarren00001FNetherland#004ş0c2GEşGelderland000018Illinois#029ş0c2COşColes00001AMississippi#137ş0c2TEşTate000018Europe#017ş0c2ISşIceland00001CPuertoRico#147ş0c2VQşVieques00001BPennsylvania#103ş0c2PIşPike000018Texas#021ş0c2BASşBastrop000016Idaho#039ş0c2ELşElmore000018Arkansas#127ş0c2SCşScott000018Oregon#041ş0c2LIşLincoln000036NewfoundlandandLabrador#CA.NF.LAş0c2LAşLabrador Region000031SaintKittsandNevis#06ş0c2JCşSaint John Capesterre000018Argentina#10ş0c2JYşJujuy000015Peru#07ş0c2CALşCallao000018Uruguay#07ş0c2FDşFlorida000014USA#ALş0c2ALşAlabama00001DTaiwan#21ş0c2TCşTaipei (City)00001AIndonesia#15ş0c2LAşLampung00002BBritishColumbia#13ş0c2FGşFraser-Fort George00001BAlbania#47ş0c2KUşKuk&euml;s00001CColombia#24ş0c2RISşRisaralda000021EnglandRegion#01ş0c2NEşNorth East000018Norway#09ş0c2NOşNordland000019Iraq#14ş0c2MAşMays&#257;n000027Alberta#CA.AB.CRş0c2CRşCanadian Rockies000021Thailand#TH.CCş0c2CCşChachoengsao00001BMali#ML.TBş0c2TBşTombouctou00001EEthiopia#ET.DDş0c2DDşDire Dawa000016Congo#CG.POş0c2POşPool00001CMorocco#MA.ORş0c2ORşOriental000022Algeria#DZ.OBş0c2OBşOum el-Bouaghi000017Mali#ML.BAş0c2BAşBamako00001CMacedonia#MK.OCş0c2OCşKocani000020Philippines#PH.LUş0c2LUşLa Union000025CoteDivoire#CI.MVş0c2MVşMoyen-Cavally00001CRussia#RU.CVş0c2CVşChuvashia00001BChina2#CN.SHş0c2SHşShanghai00001DGuinea#GN.DIş0c2DIşDinguiraye00001EThailand#TH.UDş0c2UDşUttaradit00001ASyria#SY.QUş0c2QUşQuneitra00002CIran#IR.CMş0c2CMşChahar Mahall and Bakhtiari000021FranceDepartment#FR.ABş0c2ABşAube00001AWisconsin#119ş0c2TAşTaylor000029NewWorld#134ş0c2BHşBosnia and Herzegovina000017Indiana#181ş0c2WHşWhite00001FAfrica#053ş0c2WSşWestern Sahara000017Kansas#175ş0c2SWşSeward000019Missouri#131ş0c2MLşMiller00001BCalifornia#035ş0c2LSşLassen000019Texas#203ş0c2HRSşHarrison000015Ohio#165ş0c2WAşWarren00001ENetherland#005ş0c2GRşGroningen00001ANebraska#135ş0c2PEşPerkins000017Georgia#011ş0c2BNşBanks000018Europe#018ş0c2IEşIreland00001BMinnesota#063ş0c2JAşJackson00001CKentucky#047ş0c2CHşChristian00001AMichigan#057ş0c2GAşGratiot000022NewCaledonia#NC.NO.KMş0c2KMşKoumac000031MadagascarRegions#MG.TL.AFş0c2AFşAtsimo-Andrefana00002ESaintKittsandNevis#07ş0c2JFşSaint John Figtree00001BArgentina#11ş0c2LPşLa Pampa000014Peru#08ş0c2CUSşCusco00001AUruguay#08ş0c2LAşLavalleja00002AUSASouthEastRegion#45ş0c2SCşSouth Carolina000017Taiwan#22ş0c2TTşTaitung00002ABritishColumbia#14ş0c2GVşGreater Vancouver00001BAlbania#48ş0c2LEşLezh&euml;000034Colombia#25ş0c2SAPşSan Andr&eacute;s and Providencia000021EnglandRegion#02ş0c2NWşNorth West00001ENorway#10ş0c2NTşNord-Trondelag00001EIraq#15ş0c2NIşN&#299;naw&#257;00001BMacedonia#MK.ODş0c2ODşOhrid000025Singapore#SG.NOş0c2NOşNorth Singapore000018China2#CN.AHş0c2AHşAnhui000015Oregon#043ş0c2LNşLinn000018Tennessee#045ş0c2DYşDyer00001BMontana#107ş0c2WHşWheatland00001BNewWorld#135ş0c2BGşBulgaria00001CMaine#001ş0c2ANşAndroscoggin000015Iowa#049ş0c2DAşDallas000017Africa#054ş0c2ZMşZambia000015Texas#385ş0c2RELşReal000017Indiana#001ş0c2ADşAdams00001ENorthCarolina#041ş0c2COşChowan000017Georgia#193ş0c2MAşMacon00001DKentucky#229ş0c2WSşWashington00001CNetherland#006ş0c2LIşLimburg000017Illinois#031ş0c2CKşCook00001CMississippi#139ş0c2TPşTippah000016Europe#019ş0c2ITşItaly00001DPuertoRico#149ş0c2VLşVillalba00001DPennsylvania#105ş0c2POşPotter000017Texas#023ş0c2BAYşBaylor000018Idaho#041ş0c2FRşFranklin000019Arkansas#129ş0c2SEşSearcy000027NewCaledonia#NC.NO.KNş0c2KNşKon&eacute;00002CSaintKittsandNevis#08ş0c2MCşSaint Mary Cayon00001BArgentina#12ş0c2LRşLa Rioja00001CPuertoRico#01ş0c2AJşAdjuntas00001BPeru#09ş0c2HUVşHuancavelica00001AUruguay#09ş0c2MAşMaldonado000017Taiwan#23ş0c2TYşTaoyuan000025Indonesia#17ş0c2NBşWest Nusa Tenggara000028BritishColumbia#15ş0c2KSşKitimat-Stikine00001DAlbania#49ş0c2SHşShkod&euml;r00001CColombia#26ş0c2SANşSantander00001FScotlandRegion#78ş0c2BOşBorders00002FEnglandRegion#03ş0c2YHşYorkshire and the Humber000017Norway#11ş0c2OPşOppland000025ElSalvador#01ş0c2AHşAhuachap&aacute;n000018Iraq#16ş0c2WAşW&#257;sit000028Alberta#CA.AB.EAş0c2EAşEdmonton and Area000021FranceDepartment#FR.ADş0c2ADşAude000020SriLanka#LK.PRş0c2PRşPolonnaruwa000023Brunei#BN.BMş0c2BMşBrunei and Muara000020Philippines#PH.NCş0c2NCşCotabato00001ARussia#RU.VOş0c2VOşVologda00001DSamoa #WS.GEş0c2GEşGagaemauga000024Kiribati#KI.GIş0c2GIşGilbert Islands00001FGuyana#GY.BAş0c2BAşBarima-Waini00001AMalawi#MW.KRş0c2KRşKaronga00002BFranceDepartment#FR.SEş0c2SEşSeine et Marne000027NorthAmerica_WOCentral#016ş0c2MXşMexico00001FWisconsin#121ş0c2TRşTrempealeau00001ANewWorld#136ş0c2HYşCroatia000019Indiana#183ş0c2WLşWhitley000019Virginia#125ş0c2NEşNelson000019Africa#055ş0c2ZWşZimbabwe000018Kansas#177ş0c2SNşShawnee00001FMexico#001ş0c2AGşAguascalientes00001EMissouri#133ş0c2MSşMississippi000020California#037ş0c2LOşLos Angeles000018Texas#205ş0c2HRTşHartley000019Ohio#167ş0c2WSşWashington000022Netherland#007ş0c2NOşNoord-Brabant000019Nebraska#137ş0c2PHşPhelps000018Georgia#013ş0c2BWşBarrow000017Europe#020ş0c2LVşLatvia00001BMinnesota#065ş0c2KAşKanabec000018Kentucky#049ş0c2CKşClark00001CMichigan#059ş0c2HIşHillsdale000016Iraq#17ş0c2NAşAn-Najaf000031SaintKittsandNevis#09ş0c2PPşSaint Paul Capesterre00001AArgentina#13ş0c2MZşMendoza00001DGrenada#01ş0c2ANşSaint Andrew000016Peru#10ş0c2HUCşHuanuco00001BUruguay#10ş0c2MOşMontevideo000025USASouthEastRegion#47ş0c2TNşTennessee000015Taiwan#24ş0c2ILşYilan000025Indonesia#18ş0c2NTşEast Nusa Tenggara00002ABritishColumbia#16ş0c2KBşKootenay Boundary00001CAlbania#50ş0c2TRşTiran&euml;000018Colombia#27ş0c2SUCşSucre00001FScotlandRegion#79ş0c2CEşCentral000024EnglandRegion#04ş0c2EMşEast Midlands000014Norway#12ş0c2OSşOslo000022ElSalvador#02ş0c2CAşCaba&ntilde;as000022Fiji#FJ.WE.NNş0c2NNşNadroga-Navosa00001ANigeria#NG.RIş0c2RIşRivers000028Philippines#PH.MNş0c2MNşMisamis Oriental000029Philippines#PH.NDş0c2NDşNegros Occidental000024CentralAmerica2#CE.BBş0c2BBşBarbados00001AMalawi#MW.KSş0c2KSşKasungu00001BMalawi#MW.LIş0c2LIşLilongwe000019China2#CN.TAş0c2TAşTaiwan000019Guinea#GN.DLş0c2DLşDalaba000018Oregon#045ş0c2MAşMalheur00001BTennessee#047ş0c2FAşFayette000018Montana#109ş0c2WIşWibaux000021NewWorld#137ş0c2CZşCzech Republic000019Maine#003ş0c2ARşAroostook000014Iowa#051ş0c2DVşDavis000017Africa#056ş0c2GMşGambia00001ATexas#387ş0c2REDşRed River000017Indiana#003ş0c2ALşAllen000020Mexico#002ş0c2BAşBaja California00001CNorthCarolina#043ş0c2CYşClay000019Georgia#195ş0c2MDşMadison000018Kentucky#231ş0c2WYşWayne000022Netherland#008ş0c2NHşNoord-Holland00001BIllinois#033ş0c2CFşCrawford000020Mississippi#141ş0c2TIşTishomingo00001EEurope#021ş0c2LIşLiechtenstein00001CPuertoRico#151ş0c2YBşYabucoa000021Pennsylvania#107ş0c2SCşSchuylkill000014Texas#025ş0c2BEEşBee000017Idaho#043ş0c2FEşFremont00001CArkansas#131ş0c2SBşSebastian000033PrinceEdwardIsland#CA.PE.CSş0c2CSşCharlotte's Shore000020ElSalvador#03ş0c2CHşChalatenango000024Iraq#18ş0c2SDşSal&#257;h ad-D&#299;n000032SaintKittsandNevis#10ş0c2PLşSaint Paul Charlestown00001BArgentina#14ş0c2MNşMisiones00001APuertoRico#03ş0c2ADşAguada00001CGrenada#02ş0c2DAşSaint David000012Peru#11ş0c2ICAşIca000020Uruguay#11ş0c2PAşPaysand&uacute;000016Taiwan#25ş0c2YLşYunlin000029BritishColumbia#17ş0c2MWşMount Waddington00001BAlbania#51ş0c2VLşVlor&euml;000019Colombia#28ş0c2TOLşTolima00002DScotlandRegion#80ş0c2DGşDumfries and Galloway000024EnglandRegion#05ş0c2WMşWest Midlands00001ENorway#13ş0c2OTş&Oslash;stfold000025SaoTomeandPrincipe#ST.LOş0c2LOşLobata000021Burma#MM.YAş0c2YAşYangon Division00001FLesotho#LS.TTş0c2TTşThaba-Tseka000023Philippines#PH.NEş0c2NEşNueva Ecija00001BTanzania#TZ.IRş0c2IRşIringa00001DVietnam#VN.VLş0c2VLşVinh Long00001APalau#PW.KAş0c2KAşKayangel00001AWisconsin#123ş0c2VEşVernon00001ANewWorld#138ş0c2DKşDenmark00001BVirginia#127ş0c2NKşNew Kent000016Africa#057ş0c2CGşCongo000019Kansas#179ş0c2SDşSheridan000024Mexico#003ş0c2BCşBaja California Sur00001BMissouri#135ş0c2MIşMoniteau00001BCalifornia#039ş0c2MAşMadera000018Texas#207ş0c2HSKşHaskell000022Virginia#670ş0c2HOşHopewell (City)000014Ohio#169ş0c2WYşWayne00001FNetherland#009ş0c2OVşOverijssel000019Nebraska#139ş0c2PIşPierce000018Georgia#015ş0c2BTşBartow00001AEurope#022ş0c2LTşLithuania00001DMinnesota#067ş0c2KNşKandiyohi000017Kentucky#051ş0c2CYşClay00001BMichigan#061ş0c2HOşHoughton000018Norway#14ş0c2ROşRogaland000024ElSalvador#04ş0c2CUşCuscatl&aacute;n000032SaintKittsandNevis#11ş0c2PBşSaint Peter Basseterre000021Argentina#15ş0c2NQşNeuqu&eacute;n00001DGrenada#03ş0c2GEşSaint George000014Peru#12ş0c2JUNşJunin00001AUruguay#12ş0c2RNşRio Negro000020BritishColumbia#18ş0c2NAşNanaimo000022Colombia#29ş0c2VACşValle del Cauca00001CScotlandRegion#81ş0c2FIşFife00001BEnglandRegion#06ş0c2EAşEast000023FranceDepartment#FR.AGş0c2AGşAriege000017Nauru#NR.BUş0c2BUşBuada000025CaymanIslands#KY.BTş0c2BTşBodden Town00001DThailand#TH.BRş0c2BRşBuri Ram000023Somalia#SO.WOş0c2WOşWoqooyi Galbeed00001BAlgeria#DZ.OGş0c2OGşOuargla000022PapuaNewGuinea#PG.WEş0c2WEşWestern00001BRussia#RU.VRş0c2VRşVoronezh00001ALibya#LY.WAş0c2WAşAl Wahah000019Malawi#MW.LKş0c2LKşLikoma00001BMalawi#MW.MAş0c2MAşMachinga000022Massachusetts#001ş0c2BAşBarnstable000017Oregon#047ş0c2MRşMarion00001CTennessee#049ş0c2FEşFentress00001DMontana#111ş0c2YSşYellowstone00001ANewWorld#139ş0c2EEşEstonia00001AMaine#005ş0c2CUşCumberland000018Oklahoma#001ş0c2ADşAdair000016Iowa#053ş0c2DEşDecatur00001AAfrica#058ş0c2MUşMauritius000017Texas#389ş0c2REVşReeves00001DIndiana#005ş0c2BAşBartholomew000019Mexico#004ş0c2CAşCampeche000021NorthCarolina#045ş0c2CVşCleveland000018Georgia#197ş0c2MRşMarion00001AKentucky#233ş0c2WBşWebster00001CNetherland#010ş0c2UTşUtrecht00001DIllinois#035ş0c2CMşCumberland00001CMississippi#143ş0c2TUşTunica00001BEurope#023ş0c2LUşLuxembourg00001APuertoRico#153ş0c2YUşYauco00001DPennsylvania#109ş0c2SNşSnyder000015Texas#027ş0c2BELşBell00001ENewHampshire#001ş0c2BEşBelknap000013Idaho#045ş0c2GEşGem000019Arkansas#133ş0c2SVşSevier00001DEnglandRegion#07ş0c2LOşLondon000020Norway#15ş0c2SOşSogn og Fjordane00001FElSalvador#05ş0c2LIşLa Libertad000030SaintKittsandNevis#12ş0c2TLşSaint Thomas Lowland00001CArgentina#16ş0c2RNşRio Negro00001DPuertoRico#05ş0c2ALşAguadilla00001BGrenada#04ş0c2JOşSaint John00001APeru#13ş0c2LALşLa Libertad000017Uruguay#13ş0c2RVşRivera000015USA#ARş0c2ARşArkansas000023Indonesia#21ş0c2STşCentral Sulawesi000027BritishColumbia#19ş0c2NOşNorth Okanagan000020Colombia#30ş0c2VAUşVaup&eacute;s000020ScotlandRegion#82ş0c2GPşGrampian000025PolandCounties#PL.WN.EMş0c2WEMşElblag000024FranceDepartment#FR.AHş0c2AHşArdeche00001FMacedonia#MK.NSş0c2NSşNovo Selo000022Philippines#PH.MQş0c2MQşMarinduque00001AUganda#UG.PLş0c2PLşPallisa00001FSamoa #WS.GIş0c2GIşGagaifomauga000019Thailand#TH.TTş0c2TTşTrat000019Wisconsin#125ş0c2VIşVilas00001ANewWorld#140ş0c2FIşFinland000018Kansas#181ş0c2SHşSherman000018Mexico#005ş0c2CHşChiapas000019Missouri#137ş0c2MRşMonroe00001ACalifornia#041ş0c2MRşMarin000015Texas#209ş0c2HYSşHays000017Ohio#171ş0c2WIşWilliams00001CNetherland#011ş0c2ZEşZeeland000019Nebraska#141ş0c2PLşPlatte00001AGeorgia#017ş0c2BHşBen hill00001AEurope#024ş0c2MKşMacedonia00001BMinnesota#069ş0c2KIşKittson00001AKentucky#053ş0c2CNşClinton000018Michigan#063ş0c2HUşHuron000025MadagascarRegions#MG.AS.SVş0c2SVşSava000021EnglandRegion#08ş0c2SEşSouth East00002BNorway#16ş0c2STşS&oslash;r-Tr&oslash;ndelag00001AElSalvador#06ş0c2PAşLa Paz000036SaintKittsandNevis#13ş0c2TMşSaint Thomas Middle Island000018Argentina#17ş0c2SAşSalta00001BGrenada#05ş0c2MAşSaint Mark000019Peru#14ş0c2LAMşLambayeque000016Uruguay#14ş0c2ROşRocha000026Indonesia#22ş0c2SGşSouth East Sulawesi000029BritishColumbia#20ş0c2NRşNorthern Rockies00001AColombia#31ş0c2CIDşVichada000020ScotlandRegion#83ş0c2HIşHighland000026NovaScotia#CA.NS.MDş0c2MDşMarine Drive00001AFiji#FJ.CE.NMş0c2NMşNamosi000020FranceDepartment#FR.AIş0c2AIşAin00001CVietnam#VN.DNş0c2DNşDong Nai000020Kazakhstan#KZ.QOş0c2QOşQyzylorda000018Nigeria#NG.ABş0c2ABşAbia00001ASenegal#SN.FKş0c2FKşFatick00001DUzbekistan#UZ.KHş0c2KHşXorazm000028Philippines#PH.MRş0c2MRşOriental Mindoro00001DSerbia#RS.ZCş0c2ZCşWest Backa00001AMalawi#MW.MCş0c2MCşMchinji000020Iran#IR.WAş0c2WAşWest Azarbaijan000021Massachusetts#003ş0c2BEşBerkshire000017Oregon#049ş0c2MOşMorrow00001CTennessee#051ş0c2FRşFranklin000019NewWorld#141ş0c2FRşFrance000018Maine#007ş0c2FRşFranklin00001AOklahoma#003ş0c2ALşAlfalfa000017Iowa#055ş0c2DLşDelaware000016Alaska#220ş0c2SIşSitka000017Delaware#001ş0c2KEşKent000018Texas#391ş0c2REFşRefugio000018Indiana#007ş0c2BEşBenton00001AMexico#006ş0c2CIşChihuahua000020NorthCarolina#047ş0c2CUşColumbus00001CGeorgia#199ş0c2MEşMeriwether000016Kansas#001ş0c2ALşAllen00001AKentucky#235ş0c2WHşWhitley000021Netherland#012ş0c2ZUşZuid-Holland000019Illinois#037ş0c2DEşDeKalb00001BMississippi#145ş0c2UNşUnion000016Europe#025ş0c2MTşMalta00001FPennsylvania#111ş0c2SOşSomerset000016Texas#029ş0c2BEXşBexar00001ENewHampshire#003ş0c2CAşCarroll000017Idaho#047ş0c2GOşGooding000018Arkansas#135ş0c2SHşSharp000021EnglandRegion#09ş0c2SWşSouth West000018Norway#17ş0c2TEşTelemark000023ElSalvador#07ş0c2UNşLa Uni&oacute;n00001BArgentina#18ş0c2SJşSan Juan000020PuertoRico#07ş0c2ABşAguas Buenas00001EGrenada#06ş0c2PAşSaint Patrick000013Peru#15ş0c2LIMşLima000016Uruguay#15ş0c2SAşSalto000022Honduras#01ş0c2ATşAtl&aacute;ntida00002DBritishColumbia#21ş0c2OSşOkanagan-Similkameen00001BColombia#32ş0c2CASşCasanare00001FScotlandRegion#84ş0c2LOşLothian000021SierraLeone#SL.SO.BNş0c2BNşBonthe000020Iran#IR.EAş0c2EAşEast Azarbaijan00001CVietnam#VN.DOş0c2DOşDac Nong00001DSriLanka#LK.PXş0c2PXşPuttalam00001DMauritania#MR.TGş0c2TGşTagant00002CPapuaNewGuinea#PG.WHş0c2WHşWestern Highlands000021HongKong#HK.WTş0c2WTşWong Tai Sin00001FPapuaNewGuinea#PG.EGş0c2EGşEnga00001BYemen#YE.HDş0c2HDşHadramawt00001FLibya#LY.WDş0c2WDşWadi al Hayat000021FranceDepartment#FR.TAş0c2TAşTarn00001CWisconsin#127ş0c2WAşWalworth00001ANewWorld#142ş0c2DEşGermany00001EVirginia#131ş0c2NTşNorthampton000016Kansas#183ş0c2SMşSmith000025Mexico#007ş0c2COşCoahuila de Zaragoza00001DMissouri#139ş0c2MYşMontgomery00001DCalifornia#043ş0c2MIşMariposa000019Texas#211ş0c2HEPşHemphill000013Ohio#173ş0c2WOşWood000017Nebraska#143ş0c2POşPolk000019Georgia#019ş0c2BIşBerrien000018Europe#026ş0c2MDşMoldova00001FMinnesota#071ş0c2KOşKoochiching00001DKentucky#055ş0c2CDşCrittenden000019Michigan#065ş0c2INşIngham000026MadagascarRegions#MG.AV.ITş0c2ITşItasy000015Norway#18ş0c2TRşTroms000022ElSalvador#08ş0c2MOşMoraz&aacute;n000032SaintKittsandNevis#15ş0c2TPşTrinity Palmetto Point00001BArgentina#19ş0c2SLşSan Luis000015Peru#16ş0c2LORşLoreto000019Uruguay#16ş0c2SJşSan Jose000017USA#CAş0c2CAşCalifornia000027Croatia#01ş0c2BBşBjelovarsko-Bilogorska00001BHonduras#02ş0c2CHşCholuteca00001FIndonesia#24ş0c2SBşWest Sumatra000024BritishColumbia#22ş0c2PRşPeace River00001FColombia#33ş0c2CUNşCundinamarca00001DSierraLeone#SL.SO.BOş0c2BOşBo000025PolandCounties#PL.PK.KMş0c2PKMşKrosno00001DNunavut#CA.NU.QKş0c2QKşBaffin00001BBotswana#BW.GHş0c2GHşGhanzi00001CNauru#NR.DEş0c2DEşDenigomodu000019Brunei#BN.TUş0c2TUşTutong000019Liberia#LR.SIş0c2SIşSinoe00001BNigeria#NG.ADş0c2ADşAdamawa000025Panama#PA.KMş0c2KMşKuna de Madungandi00001DMacedonia#MK.NVş0c2NVşNovatsi000029Philippines#PH.MTş0c2MTşMountain Province00002CPapuaNewGuinea#PG.EHş0c2EHşEastern Highlands000017Uganda#UG.OYş0c2OYşOyam00002BFranceDepartment#FR.SLş0c2SLşSaone et Loire000032FranceDepartment#FR.TBş0c2TBşTerritoire de Belfort00001FMassachusetts#005ş0c2BRşBristol00001AOregon#051ş0c2MUşMultnomah00002ENorthAmerica_WOCentral#023ş0c2USşUnited States00001ATennessee#053ş0c2GIşGibson000019NewWorld#143ş0c2GRşGreece000017Maine#009ş0c2HAşHancock000018Oklahoma#005ş0c2ATşAtoka000019Iowa#057ş0c2DMşDes Moines00001DDelaware#003ş0c2NEşNew castle000018Texas#393ş0c2ROBşRoberts00001BIndiana#009ş0c2BLşBlackford000017Mexico#008ş0c2CLşColima00001ENorthCarolina#049ş0c2CNşCraven000018Georgia#201ş0c2MLşMiller000019Kansas#003ş0c2ANşAnderson000018Kentucky#237ş0c2WOşWolfe00001AIllinois#039ş0c2DWşDe Witt00001EMississippi#147ş0c2WAşWalthall000017Europe#027ş0c2MCşMonaco00001FPennsylvania#113ş0c2SUşSullivan000017Texas#031ş0c2BLAşBlanco00001FNewHampshire#005ş0c2CHşCheshire000015Idaho#049ş0c2IDşIdaho000018Arkansas#137ş0c2STşStone000029NewCaledonia#NC.SU.DUş0c2DUşDumb&eacute;a000022NewCaledonia#NC.SU.FAş0c2FAşFarino00001ANorway#19ş0c2VAşVest-Agder00001EElSalvador#09ş0c2SMşSan Miguel00001DArgentina#20ş0c2SCşSanta Cruz00001CPuertoRico#09ş0c2AIşAibonito00001CPeru#17ş0c2MDDşMadre de Dios000018Uruguay#17ş0c2SOşSoriano000021Croatia#02ş0c2SPşBrodsko-Posavska00001EHonduras#03ş0c2CLşCol&oacute;n000021USANorthWestRegion#16ş0c2IDşIdaho000025BritishColumbia#23ş0c2POşPowell River000032Colombia#34ş0c2DCşBogot&aacute; (Distrito Capital)000025PolandCounties#PL.MA.KMş0c2MKMşKrakow000026FrenchGuiana#GF.SL.PAş0c2PAşPapaichton000023FranceDepartment#FR.ALş0c2ALşAllier00001CKyrgyzstan#KG.NAş0c2NAşNaryn00001FThailand#TH.CMş0c2CMşChiang Mai00001CTunisia#TN.KRş0c2KRşKairouan00002BFranceDepartment#FR.SMş0c2SMşSeine Maritime00001FThailand#TH.UNş0c2UNşUdon Thani000018Syria#SY.TAş0c2TAşTartus000018Michigan#067ş0c2IOşIonia00002ANorthAmerica_WOCentral#024ş0c2GLşGreenland00001CWisconsin#129ş0c2WSşWashburn00001ANewWorld#144ş0c2HUşHungary000021Virginia#133ş0c2NHşNorthumberland00001CSouthDakota#003ş0c2AUşAurora000019Kansas#185ş0c2SFşStafford000018Mexico#009ş0c2DUşDurango000019Missouri#141ş0c2MGşMorgan00001ECalifornia#045ş0c2MEşMendocino00001ATexas#213ş0c2HNDşHenderson000016Ohio#175ş0c2WDşWyandot00001DNebraska#145ş0c2RWşRed Willow000016Georgia#021ş0c2BBşBibb00001BEurope#028ş0c2MOşMontenegro000021Minnesota#073ş0c2LQşLac Qui Parle00001DKentucky#057ş0c2CMşCumberland000018Norway#20ş0c2VEşVestfold000020ElSalvador#10ş0c2SSşSan Salvador00001BArgentina#21ş0c2SFşSanta Fe000016USA#TNş0c2TNşTennessee000017Peru#18ş0c2MOQşMoquegua000022Uruguay#18ş0c2TAşTacuaremb&oacute;00002CCroatia#03ş0c2DNşDubrova&#269;ko-Neretvanska00001BHonduras#04ş0c2CMşComayagua000017Ontario#01ş0c2ALşAlgoma000020Indonesia#26ş0c2SUşNorth Sumatra00002FBritishColumbia#24ş0c2SQşSkeena-Queen Charlotte000021Colombia#35ş0c2BOLşBol&iacute;var000023ScotlandRegion#87ş0c2SCşStrathclyde00003DNorthWestTerritories#CA.NT.WRş0c2WRşWaterfalls Valley (Route)00002ANovaScotia#CA.NS.LRş0c2LRşLighthouse Route00002CFranceDepartment#FR.AMş0c2AMşAlpes Maritimes00001DThailand#TH.CNş0c2CNşChai Nat00001DSaudiArabia#SA.JZş0c2JZşJizan000018Chad#TD.SAş0c2SAşSalamat00001FKazakhstan#KZ.QSş0c2QSşQostanay00001DMauritania#MR.ASş0c2ASşAssaba00001DZimbabwe#ZW.BUş0c2BUşBulawayo00001BMalawi#MW.MGş0c2MGşMangochi00001DTunisia#TN.KSş0c2KSşKasserine000017Oman#OM.MAş0c2MAşMuscat000018Arkansas#139ş0c2UNşUnion00001DMassachusetts#007ş0c2DUşDukes000015Oregon#053ş0c2POşPolk000019Tennessee#055ş0c2GLşGiles00001ANewWorld#145ş0c2ISşIceland000018Maine#011ş0c2KEşKennebec000019Oklahoma#007ş0c2BEşBeaver000018Iowa#059ş0c2DIşDickinson000019Delaware#005ş0c2SUşSussex00001ATexas#395ş0c2ROEşRobertson00001CNewJersey#001ş0c2ATşAtlantic000017Indiana#011ş0c2BOşBoone00001BMexico#010ş0c2GUşGuanajuato000022NorthCarolina#051ş0c2CBşCumberland000019Kansas#005ş0c2ATşAtchison00001BKentucky#239ş0c2WDşWoodford00001AIllinois#041ş0c2DOşDouglas00001CMississippi#149ş0c2WRşWarren000025WorldwithCountries#100ş0c2KHşCambodia00001CEurope#029ş0c2NLşNetherlands000022Pennsylvania#115ş0c2SQşSusquehanna000017Texas#033ş0c2BORşBorden00001BNewHampshire#007ş0c2COşCoos000019Idaho#051ş0c2JEşJefferson00001DElSalvador#11ş0c2SAşSanta Ana000026Argentina#22ş0c2SEşSantiago del Estero000021PuertoRico#11ş0c2ANşA&ntilde;asco000014Peru#19ş0c2PASşPasco00001FUruguay#19ş0c2TTşTreinta y Tres000019Croatia#04ş0c2ISşIstarska00001EHonduras#05ş0c2CPşCop&aacute;n000016Ontario#02ş0c2BRşBrant000026Poland#72ş0c2DSşDolno&#347;l&#261;skie000022Cuba#01ş0c2PRşPinar del R&iacute;o00002ABritishColumbia#25ş0c2SLşSquamish-Lillooet000020Colombia#36ş0c2BOYşBoyac&aacute;00001FScotlandRegion#88ş0c2TAşTayside000022FrenchGuiana#GF.CY.RKş0c2RKşRegina000025FranceDepartment#FR.ANş0c2ANşArdennes00002DFranceDepartment#FR.BDş0c2BDşBouches du Rhone00001DSomalia#SO.GAş0c2GAşGalguduud000027CentralAmerica2#CE.SVş0c2SVşEl Salvador00001EMacedonia#MK.PEş0c2PEşPetrovec00001ANepal#NP.JAş0c2JAşJanakpur000017UK7#UK.ENş0c2ENşEngland00001AChina2#CN.TJş0c2TJşTianjin000022FranceDepartment#FR.SOş0c2SOşSomme000021Guinea#GN.DUş0c2DUşDubr&eacute;ka00001AGuinea#GN.FAş0c2FAşFaranah00001AKentucky#059ş0c2DAşDaviess000018Michigan#069ş0c2ISşIosco00001EWisconsin#131ş0c2WHşWashington00001ANewWorld#146ş0c2IRşIreland00001BVirginia#135ş0c2NWşNottoway00001CSouthDakota#005ş0c2BEşBeadle000018Kansas#187ş0c2STşStanton000019Mexico#011ş0c2GEşGuerrero00001DMissouri#143ş0c2NMşNew Madrid00001BCalifornia#047ş0c2MCşMerced000018Texas#215ş0c2HIDşHidalgo000023Virginia#678ş0c2LXşLexington (City)00001DNebraska#147ş0c2RIşRichardson00001AGeorgia#023ş0c2BLşBleckley000022WorldwithCountries#101ş0c2CNşChina000017Europe#030ş0c2NOşNorway000018Minnesota#075ş0c2LAşLake00001FElSalvador#12ş0c2SVşSan Vicente000023Argentina#23ş0c2TFşTierra del Fuego000014Peru#20ş0c2PIUşPiura000020Croatia#05ş0c2KAşKarlova&#269;ka00001FHonduras#06ş0c2CRşCort&eacute;s000016Ontario#03ş0c2BUşBruce000022Poland#73ş0c2KPşKujawsko-Pomorskie000021Cuba#02ş0c2CHşCiudad de La Habana000019Indonesia#28ş0c2MAşMaluku000020BritishColumbia#26ş0c2STşStikine000019Colombia#37ş0c2CALşCaldas000025ScotlandRegion#89ş0c2WIşWestern Isles000018Libya#LY.DRş0c2DRşDarnah000022SolomonIsland#SB.CHş0c2CHşChoiseul00001AChina2#CN.BJş0c2BJşBeijing00001DVietnam#VN.DTş0c2DTşDong Thap00001DThailand#TH.CPş0c2CPşChumphon00001AEurope2#EU.KOş0c2KOşKosovo000022Tibet#TI.QPş0c2QPşQamdo Prefecture00001ENewHampshire#009ş0c2GRşGrafton000016Idaho#053ş0c2JRşJerome00001CArkansas#141ş0c2VBşVan Buren00001DMassachusetts#009ş0c2ESşEssex000018Oregon#055ş0c2SHşSherman00001CTennessee#057ş0c2GRşGrainger000018NewWorld#147ş0c2ITşItaly000014Maine#013ş0c2KNşKnox00001AOklahoma#009ş0c2BCşBeckham000016Iowa#061ş0c2DUşDubuque000019Texas#397ş0c2ROCşRockwall00001ANewJersey#003ş0c2BEşBergen000017Indiana#013ş0c2BRşBrown000018Mexico#012ş0c2HIşHidalgo000021NorthCarolina#053ş0c2CKşCurrituck00001AGeorgia#205ş0c2MTşMitchell000017Kansas#007ş0c2BAşBarber000019Illinois#043ş0c2DPşDuPage000020Mississippi#151ş0c2WSşWashington000027WorldwithCountries#102ş0c2TPşEast Timor000017Europe#031ş0c2PLşPoland00001CPennsylvania#117ş0c2TIşTioga000017Texas#035ş0c2BOSşBosque00001DElSalvador#13ş0c2SOşSonsonate000021Argentina#24ş0c2TMşTucum&aacute;n00001BPuertoRico#13ş0c2ACşArecibo000013Peru#21ş0c2PUNşPuno000014USA#AZş0c2AZşArizona000036Croatia#06ş0c2KKşKoprivni&#269;ko-Kri&#382;eva&#269;ka000023Honduras#07ş0c2EPşEl Para&iacute;so00001DOntario#04ş0c2CKşChatham-Kent000023Poland#74ş0c2LDş&#321;&oacute;dzkie000016Cuba#03ş0c2MAşMatanzas00001FIndonesia#29ş0c2MUşNorth Maluku000027BritishColumbia#27ş0c2SCşSunshine Coast00001CColombia#38ş0c2MAGşMagdalena00002BFrenchGuiana#GF.CY.RMş0c2RMşRemire Montjoly00001DFiji#FJ.CE.NTş0c2NTşNaitasiri000034FranceDepartment#FR.APş0c2APşAlpes de Haute Provence000023BurkinaFaso#BF.SEş0c2SEşS&eacute;no00002BPapuaNewGuinea#PG.WNş0c2WNşWest New Britain000029Guyana#GY.UDş0c2UDşUpper Demerara-Berbice00001DKazakhstan#KZ.AAş0c2AAşAlmaty00001ASerbia#RS.ZJş0c2ZJşZajecar000018Yemen#YE.HJş0c2HJşHajjah00001BBurundi#BI.KIş0c2KIşKirundo00001AMalawi#MW.MJş0c2MJşMulanje00002CFranceDepartment#FR.TGş0c2TGşTarn et Garonne000025Thailand#TH.URş0c2URşUbon Ratchathani00001BKentucky#061ş0c2EDşEdmonson000017Michigan#071ş0c2IRşIron00001CWisconsin#133ş0c2WUşWaukesha000019NewWorld#148ş0c2LVşLatvia000019Virginia#137ş0c2ORşOrange00001DSouthDakota#007ş0c2BNşBennett000018Kansas#189ş0c2SVşStevens000018Mexico#013ş0c2JAşJalisco000019Missouri#145ş0c2NEşNewton00001ACalifornia#049ş0c2MOşModoc000015Texas#217ş0c2HILşHill000023Virginia#680ş0c2LYşLynchburg (City)000017Nebraska#149ş0c2ROşRock00001AGeorgia#025ş0c2BEşBrantley000024WorldwithCountries#103ş0c2GEşGeorgia000019Europe#032ş0c2PTşPortugal000025Minnesota#077ş0c2LWşLake of the Woods000023ElSalvador#14ş0c2USşUsulut&aacute;n000019Peru#22ş0c2SAMşSan Martin000023Croatia#07ş0c2KZşKrapinsko-Zagorska00002AHonduras#08ş0c2FMşFrancisco Moraz&aacute;n000019Ontario#05ş0c2COşCochrane000019Poland#75ş0c2LUşLubelskie000021Cuba#04ş0c2IJşIsla de la Juventud00001CIndonesia#30ş0c2JRşWest Java000028BritishColumbia#28ş0c2TNşThompson-Nicola00001FThailand#TH.CRş0c2CRşChiang Rai00001ANigeria#NG.TAş0c2TAşTaraba00001DMacedonia#MK.PHş0c2PHşPehcevo00002BPapuaNewGuinea#PG.ENş0c2ENşEast New Britain000018Uganda#UG.RAş0c2RAşRakai00001DMalawi#MW.NAş0c2NAşNkhata Bay000023NewHampshire#011ş0c2HBşHillsborough000018Idaho#055ş0c2KOşKootenai00001DArkansas#143ş0c2WAşWashington000020Massachusetts#011ş0c2FRşFranklin00001AOregon#057ş0c2TIşTillamook00001ATennessee#059ş0c2GEşGreene000020NewWorld#149ş0c2LNşLiechtenstein000017Maine#015ş0c2LIşLincoln000019Oklahoma#011ş0c2BLşBlaine000014Iowa#063ş0c2EMşEmmet000018Texas#399ş0c2RUNşRunnels00001ENewJersey#005ş0c2BUşBurlington000019Indiana#015ş0c2CAşCarroll000017Mexico#014ş0c2MEşMexico00001CNorthCarolina#055ş0c2DAşDare000018Georgia#207ş0c2MOşMonroe000017Kansas#009ş0c2BTşBarton000018Illinois#045ş0c2EDşEdgar00001BMississippi#153ş0c2WYşWayne000022WorldwithCountries#104ş0c2INşIndia000018Europe#033ş0c2ROşRomania00001CPennsylvania#119ş0c2UNşUnion000016Texas#037ş0c2BOIşBowie00001APuertoRico#15ş0c2ARşArroyo000014Peru#23ş0c2TACşTacna000023Croatia#08ş0c2LSşLi&#269;ko-Senjska000020Honduras#09ş0c2GDşGracias a Dios000019Ontario#06ş0c2DUşDufferin000018Poland#76ş0c2LBşLubuskie00001BCuba#05ş0c2CMşCamag&uuml;ey000021Indonesia#31ş0c2SAşNorth Sulawesi000028PolandCounties#PL.KP.WLş0c2KWLşWloclawek000021FrenchGuiana#GF.CY.ROş0c2ROşRoura000026FrenchGuiana#GF.CY.SEş0c2SEşSaint Elie000022CaymanIslands#KY.WBş0c2WBşWest Bay000020Thailand#TH.UTş0c2UTşUthai Thani000018Congo#CG.SAş0c2SAşSangha000026BurkinaFaso#BF.SGş0c2SGşSangui&eacute;000018Algeria#DZ.ORş0c2ORşOran00001BBhutan#BT.SGş0c2SGşShemgang00001DNigeria#NG.AKş0c2AKşAkwa Ibom00001ANigeria#NG.BAş0c2BAşBauchi000018Somalia#SO.GEş0c2GEşGedo00001DMacedonia#MK.OSş0c2OSşOslomej000022Kazakhstan#KZ.ACş0c2ACşAlmaty City00001BSerbia#RS.ZLş0c2ZLşZlatibor000015Yemen#YE.IBş0c2IBşIbb000019China2#CN.SXş0c2SXşShanxi00002EFranceDepartment#FR.SSş0c2SSşSeine-Saint-Denis00001AKentucky#063ş0c2ELşElliott00001BMichigan#073ş0c2IAşIsabella00001BWisconsin#135ş0c2WPşWaupaca00001CNewWorld#150ş0c2LTşLithuania000017Virginia#139ş0c2PAşPage00001FSouthDakota#009ş0c2BHşBon Homme000017Kansas#191ş0c2SUşSumner000024Mexico#015ş0c2MIşMichoacan de Ocampo00001AMissouri#147ş0c2NOşNodaway000019California#051ş0c2MNşMono000018Texas#219ş0c2HOCşHockley000019Nebraska#151ş0c2SAşSaline000018Georgia#027ş0c2BOşBrooks000015Brazil#001ş0c2ACşAcre000026WorldwithCountries#105ş0c2IDşIndonesia00001BEurope#034ş0c2SMşSan Marino00001CMinnesota#079ş0c2LSşLe Sueur000026YukonTerritory#CA.YT.KLş0c2KLşKlondike000015Peru#24ş0c2TUMşTumbes000020Croatia#09ş0c2MEşMe&#273;imurska000021Honduras#10ş0c2INşIntibuc&aacute;000017Ontario#07ş0c2DRşDurham000020Poland#77ş0c2MAşMa&#322;opolskie000020Indonesia#32ş0c2SLşSouth Sumatra00002CMacau#MO.MA.NFş0c2NFşNossa Senhora de Fatima000022FranceDepartment#FR.ASş0c2ASşAisne000020Thailand#TH.CTş0c2CTşChanthaburi000021Europe2#EU.LIş0c2LIşLiechtenstein000027Philippines#PH.NRş0c2NRşNegros Oriental000019Vanuatu#VU.SEş0c2SEşShefa00001CTunisia#TN.MEş0c2MEşMedenine000023FranceDepartment#FR.STş0c2STşSarthe00001EPennsylvania#121ş0c2VEşVenango000019Texas#039ş0c2BRZşBrazoria000020NewHampshire#013ş0c2MEşMerrimack000015Idaho#057ş0c2LAşLatah000018Arkansas#145ş0c2WHşWhite000014Ohio#001ş0c2ADşAdams00001FMassachusetts#013ş0c2HAşHampden000019Oregon#059ş0c2UMşUmatilla00001ATennessee#061ş0c2GUşGrundy00001DNewWorld#151ş0c2LUşLuxembourg000016Maine#017ş0c2OXşOxford000018Oklahoma#013ş0c2BRşBryan000016Iowa#065ş0c2FAşFayette000015Texas#401ş0c2RUSşRusk00001ANewJersey#007ş0c2CAşCamden000016Indiana#017ş0c2CSşCass000018Mexico#016ş0c2MOşMorelos000020NorthCarolina#057ş0c2DVşDavidson00001CGeorgia#209ş0c2MGşMontgomery000018Kansas#011ş0c2BBşBourbon000022Virginia#683ş0c2MNşManassas (City)00001AIllinois#047ş0c2EWşEdwards00001DMississippi#155ş0c2WBşWebster000018Brazil#002ş0c2ALşAlagoas000021WorldwithCountries#106ş0c2IAşIran000017Europe#035ş0c2CSşSerbia00001ASlovenia#01ş0c2PMşPomurska000015USA#VAş0c2VAşVirginia00001FPuertoRico#17ş0c2BCşBarceloneta000016Peru#25ş0c2UCAşUcayali000027Croatia#10ş0c2OBşOsje&#269;ko-Baranjska00002AHonduras#11ş0c2IBşIslas de la Bah&iacute;a000016Ontario#08ş0c2ELşElgin00001BPoland#78ş0c2MZşMazowieckie000023Cuba#07ş0c2CAşCiego de &Aacute;vila000019Indonesia#33ş0c2BTşBanten000029FrenchGuiana#GF.CY.SGş0c2SGşSaint Georges000015Iran#IR.FAş0c2FAşFars00001ESriLanka#LK.RNş0c2RNşRatnapura000018Liberia#LR.BGş0c2BGşBong000026Philippines#PH.NSş0c2NSşNorthern Samar000020Tanzania#TZ.KLş0c2KLşKilimanjaro00001EMicronesia#FM.POş0c2POşPohnpei000017Palau#PW.KOş0c2KOşKoror000019Kentucky#065ş0c2ESşEstill00001AMichigan#075ş0c2JAşJackson00001CWisconsin#137ş0c2WRşWaushara00001CNewWorld#152ş0c2MKşMacedonia00001AVirginia#141ş0c2PTşPatrick00001FSouthDakota#011ş0c2BRşBrookings000017Kansas#193ş0c2THşThomas000018Mexico#017ş0c2NAşNayarit000019Missouri#149ş0c2ORşOregon00001DCalifornia#053ş0c2MTşMonterey000017Alaska#050ş0c2BEşBethel000015Texas#221ş0c2HODşHood000018Nebraska#153ş0c2SRşSarpy000017Georgia#029ş0c2BRşBryan000016Brazil#003ş0c2APşAmapa000022WorldwithCountries#107ş0c2JPşJapan000019Europe#036ş0c2SKşSlovakia00001BMinnesota#081ş0c2LIşLincoln000027NewCaledonia#NC.SU.YAş0c2YAşYat&eacute;00001BSlovenia#02ş0c2PDşPodravska00001FPeru#26ş0c2LPşLima Metropolitan00002ECroatia#11ş0c2PSşPo&#382;e&scaron;ko-Slavonska000018Honduras#12ş0c2LPşLa Paz000016Ontario#09ş0c2ESşEssex000018Poland#79ş0c2OPşOpolskie000018Cuba#08ş0c2CFşCienfuegos00001CIndonesia#34ş0c2GOşGorontalo00001DSwaziland#SZ.MAş0c2MAşManzini000021SolomonIsland#SB.CNş0c2CNşCentral00001BQatar#QA.RAş0c2RAşAr Rayyan00002AFranceDepartment#FR.CAş0c2CAşCotes d'Armor00001ANigeria#NG.SOş0c2SOşSokoto00001AGhana#GH.NPş0c2NPşNorthern00001DMauritania#MR.TRş0c2TRşTrarza000022SaudiArabia#SA.MDş0c2MDşAl Madinah000023Bhutan#BT.SJş0c2SJşSamdrup Jongkhar000021SriLanka#LK.ADş0c2ADşAnuradhapura00001BNigeria#NG.ANş0c2ANşAnambra000023Panama#PA.KWş0c2KWşKuna de Wargandi00001BTanzania#TZ.KMş0c2KMşKigoma000023FranceDepartment#FR.SVş0c2SVşSavoie00001DPennsylvania#123ş0c2WAşWarren000017Texas#041ş0c2BAZşBrazos000021NewHampshire#015ş0c2RGşRockingham000015Idaho#059ş0c2LEşLemhi00001BArkansas#147ş0c2WOşWoodruff000014Ohio#003ş0c2ALşAllen000021Massachusetts#015ş0c2HPşHampshire000016Oregon#061ş0c2UNşUnion00001BTennessee#063ş0c2HAşHamblen000018NewWorld#153ş0c2MTşMalta000019Maine#019ş0c2PEşPenobscot000018Oklahoma#015ş0c2CAşCaddo000032Australia2#ACTş0c2ACTşAustralian Capital Territory000014Iowa#067ş0c2FLşFloyd000026Alaska#232ş0c2SHşSkagway-Hoonah-Angoon000017Texas#403ş0c2SABşSabine00001CNewJersey#009ş0c2CMşCape May000017Indiana#019ş0c2CLşClark00001BMexico#018ş0c2NUşNuevo Leon00001DNorthCarolina#059ş0c2DIşDavie000018Georgia#211ş0c2MNşMorgan000016Kansas#013ş0c2BRşBrown000027Virginia#685ş0c2MPşManassas Park (City)00001CIllinois#049ş0c2EFşEffingham00001FMississippi#157ş0c2WLşWilkinson000019Brazil#004ş0c2AMşAmazonas000027WorldwithCountries#108ş0c2KZşKazakhstan000019Europe#037ş0c2SLşSlovenia000026MadagascarRegions#MG.TL.AYş0c2AYşAnosy000034MadagascarRegions#MG.FI.VFş0c2VFşVatovavy Fitovinany000020Slovenia#03ş0c2KOşKoro&scaron;ka000025NewWorld#01ş0c2AGşAntigua and Barbuda000020PuertoRico#19ş0c2BQşBarranquitas000023Croatia#12ş0c2PGşPrimorsko-Goranska000019Honduras#13ş0c2LEşLempira00001AOntario#10ş0c2FRşFrontenac00001CPoland#80ş0c2PKşPodkarpackie000014Cuba#09ş0c2GRşGranma000022Indonesia#35ş0c2BBşBangka-Belitung000032PolandCounties#PL.LB.GMş0c2LGMşGorzow Wielkopolski000025FrenchGuiana#GF.CY.SIş0c2SIşSinnamary00001CSyria#SY.SUş0c2SUşAs Suwayda000024FranceDepartment#FR.AVş0c2AVşAveyron000022CaymanIslands#KY.EEş0c2EEşEast End00001DBurkinaFaso#BF.TAş0c2TAşTapoa00001CBhutan#BT.TAş0c2TAşTashigang00001BRwanda#RW.SUş0c2SUşSouthern000019Nigeria#NG.BEş0c2BEşBenue000031CentralAmerica2#CE.TTş0c2TTşTrinidad &amp; Tobago00001EHongKong#HK.YLş0c2YLşYuen Long00001DMauritania#MR.BRş0c2BRşBrakna00002FCentralAfricanRepublic#CF.HKş0c2HKşHaute -Kotto000023CentralAmerica2#CE.BSş0c2BSşBahamas000025PapuaNewGuinea#PG.ESş0c2ESşEast Sepik00001ALaos#LA.KHş0c2KHşKhammouan00001ATunisia#TN.MHş0c2MHşMahdia000018Minnesota#083ş0c2LYşLyon00001AKentucky#067ş0c2FAşFayette00001CMichigan#077ş0c2KMşKalamazoo00001DWisconsin#139ş0c2WNşWinnebago00001ANewWorld#154ş0c2MVşMoldova00001FVirginia#143ş0c2PIşPittsylvania00001BSouthDakota#013ş0c2BWşBrown000016Kansas#195ş0c2TRşTrego000017Mexico#019ş0c2OAşOaxaca000018Missouri#151ş0c2OSşOsage000019California#055ş0c2NAşNapa000018Texas#223ş0c2HOPşHopkins00001BNebraska#155ş0c2SUşSaunders000019Georgia#031ş0c2BCşBulloch000016Brazil#005ş0c2BAşBahia00002AWorldwithCountries#109ş0c2KPşKorea (north)000016Europe#038ş0c2ESşSpain00001BSlovenia#04ş0c2SAşSavinjska000019NewWorld#02ş0c2BSşBahamas000012USA#TXş0c2TXşTexas000021USA#DCş0c2DCşDistrict of Columbia000028Croatia#13ş0c2SBş&Scaron;ibensko-Kninska00001CHonduras#14ş0c2OCşOcotepeque00001DAustralia#QUş0c2QUşQueensland000022Australia#SAş0c2SAşSouth Australia000020Ontario#11ş0c2GSşGreater Sudbury000019Poland#81ş0c2PDşPodlaskie00001FCuba#10ş0c2GUşGuant&aacute;namo000018Indonesia#36ş0c2PAşPapua00001AEurope2#EU.MCş0c2MCşMonaco000022Cambodia#KH.KAş0c2KAşSihanoukville000019Chad#TD.TAş0c2TAşTandjile000023BurkinaFaso#BF.BAş0c2BAşBal&eacute;00001EMacedonia#MK.PNş0c2PNşPlasnica000025Philippines#PH.NVş0c2NVşNueva Vizcaya00002AWorldwithCountries#110ş0c2KRşKorea (south)000017Europe#039ş0c2SEşSweden000021Pennsylvania#125ş0c2WSşWashington000019Texas#043ş0c2BREşBrewster000020NewHampshire#017ş0c2STşStrafford000015Idaho#061ş0c2LWşLewis000017Arkansas#149ş0c2YEşYell000016Ohio#005ş0c2ASşAshland000021Massachusetts#017ş0c2MIşMiddlesex000018Oregon#063ş0c2WAşWallowa00001CTennessee#065ş0c2HMşHamilton000017Italy#001ş0c2ABşAbruzzo000019NewWorld#155ş0c2MCşMonaco00001BMaine#021ş0c2PIşPiscataquis00001BOklahoma#017ş0c2CNşCanadian000017Iowa#069ş0c2FRşFranklin00001ETexas#405ş0c2SAUşSan Augustine00001ENewJersey#011ş0c2CUşCumberland000016Indiana#021ş0c2CYşClay000017Mexico#020ş0c2PUşPuebla00001ENorthCarolina#061ş0c2DUşDuplin000018Georgia#213ş0c2MUşMurray000017Kansas#015ş0c2BUşButler00001AIllinois#051ş0c2FAşFayette00001DMississippi#159ş0c2WNşWinston000016Brazil#006ş0c2CEşCeara00001ASlovenia#05ş0c2ZSşZasavska00001ANewWorld#03ş0c2BBşBarbados000022PuertoRico#21ş0c2BYşBayam&oacute;n00002DCroatia#14ş0c2SMşSisa&#269;ko-Moslava&#269;ka000019Honduras#15ş0c2OLşOlancho00001BCostaRica#01ş0c2ALşAlajuela000015Ontario#12ş0c2GRşGrey000019Poland#82ş0c2PMşPomorskie000017Cuba#11ş0c2LHşLa Habana000017Indonesia#37ş0c2RIşRiau000019Guinea#GN.GAş0c2GAşGaoual00001FThailand#TH.CYş0c2CYşChaiyaphum00001BEurope2#EU.MDş0c2MDşMoldova00001ESenegal#SN.ZGş0c2ZGşZiguinchor000018Cambodia#KH.KBş0c2KBşKep00001CBurkinaFaso#BF.SMş0c2SMşSoum000019Bhutan#BT.SMş0c2SMşSamchi000020GuineaBissau#GW.QUş0c2QUşQuinara000022BurkinaFaso#BF.BBş0c2BBşBougouriba00001EDjibouti#DJ.TAş0c2TAşTadjourah00002ECentralAfricanRepublic#CF.HMş0c2HMşHaut-Mbomou000016Chad#TD.BAş0c2BAşBatha000019Nepal#NP.KAş0c2KAşKarnali00001DGabon#GA.HOş0c2HOşHaut-Ogooue000027WorldwithCountries#111ş0c2KGşKyrgyzstan00001CEurope#040ş0c2CHşSwitzerland00001AMinnesota#085ş0c2MLşMcLeod00001AKentucky#069ş0c2FLşFleming00001BMichigan#079ş0c2KAşKalkaska000018Wisconsin#141ş0c2WOşWood00001AItaly#002ş0c2BAşBasilicata00001DNewWorld#156ş0c2MGşMontenegro00001BVirginia#145ş0c2POşPowhatan00001BSouthDakota#015ş0c2BUşBrule00001AKansas#197ş0c2WBşWabaunsee000025Mexico#021ş0c2QUşQueretaro de Arteaga000018Missouri#153ş0c2OZşOzark00001BCalifornia#057ş0c2NEşNevada000018Texas#225ş0c2HOUşHouston00001FNebraska#157ş0c2SBşScotts Bluff000017Georgia#033ş0c2BUşBurke000021Brazil#007ş0c2DFşDistrito Federal000021Slovenia#06ş0c2PSşSpodnjeposavska000018NewWorld#04ş0c2BZşBelize000015USA#COş0c2COşColorado000015USA#DEş0c2DEşDelaware000014Japan#10ş0c2GUşGumma000025Croatia#15ş0c2SDşSplitsko-Dalmatinska000026Honduras#16ş0c2SBşSanta B&aacute;rbara00001ACostaRica#02ş0c2CAşCartago00001AOntario#13ş0c2HAşHaldimand000021Poland#83ş0c2SLş&#346;l&#261;skie00001CCuba#12ş0c2HOşHolgu&iacute;n000021Indonesia#38ş0c2SNşSouth Sulawesi00001AEritrea#ER.MAş0c2MAşMaekel000027Kazakhstan#KZ.SKş0c2SKşSouth Kazakhstan00003CCentralAmerica2#CE.VCş0c2VCşSt. Vincent &amp; the Grenadines00001CMacedonia#MK.PPş0c2PPşPrilep00001ABurundi#BI.KRş0c2KRşKaruzi00001AMalawi#MW.NIş0c2NIşNtchisi000021WorldwithCountries#112ş0c2LAşLaos000018Europe#041ş0c2UAşUkraine00001CPennsylvania#127ş0c2WYşWayne000018Texas#045ş0c2BRIşBriscoe00001FNewHampshire#019ş0c2SUşSullivan000017Idaho#063ş0c2LIşLincoln000018Ohio#007ş0c2AHşAshtabula000021Massachusetts#019ş0c2NTşNantucket000016Oregon#065ş0c2WSşWasco00001BTennessee#067ş0c2HNşHancock000018Italy#003ş0c2CAşCalabria00001ENewWorld#157ş0c2NLşNetherlands000019Maine#023ş0c2SAşSagadahoc000019Oklahoma#019ş0c2CRşCarter000016Iowa#071ş0c2FEşFremont00001CTexas#407ş0c2SAJşSan Jacinto000019NewJersey#013ş0c2ESşEssex000019Indiana#023ş0c2CIşClinton00001DMexico#022ş0c2QRşQuintana Roo00001ENorthCarolina#063ş0c2DRşDurham00001AGeorgia#215ş0c2MSşMuscogee00001CNewZealand#F10ş0c2TASşTasman000016Kansas#017ş0c2CSşChase000017Illinois#053ş0c2FOşFord00001FMississippi#161ş0c2YAşYalobusha00001FBrazil#008ş0c2ESşEspirito Santo000027Slovenia#07ş0c2DOşJugovzhodna Slovenija000018NewWorld#05ş0c2CAşCanada00001DPuertoRico#23ş0c2CRşCabo Rojo000018Japan#11ş0c2HIşHiroshima000021Croatia#16ş0c2VAşVara&#382;dinska000017Honduras#17ş0c2VAşValle00001CBulgaria#38ş0c2EşBlagoevgrad00001DCostaRica#03ş0c2GUşGuanacaste00001BOntario#14ş0c2HLşHaliburton000023USANorthWestRegion#30ş0c2MTşMontana000028Poland#84ş0c2SKş&#346;wi&#281;tokrzyskie000017Cuba#13ş0c2LTşLas Tunas000022Indonesia#39ş0c2IBşWest Irian Jaya000025PolandCounties#PL.LU.ZMş0c2LZMşZamosc00002BNewBrunswick#CA.NB.ACş0c2ACşAcadian Coastal00001ATunisia#TN.NBş0c2NBşNabeul00001BVietnam#VN.YBş0c2YBşYen Bai000018Liberia#LR.BMş0c2BMşBomi00001BTanzania#TZ.KRş0c2KRşKagera000016Brazil#009ş0c2GOşGoias000025WorldwithCountries#113ş0c2MYşMalaysia00001FEurope#042ş0c2UKşUnited Kingdom00001CMinnesota#087ş0c2MAşMahnomen000018Kentucky#071ş0c2FOşFloyd000017Michigan#081ş0c2KNşKent000018Italy#004ş0c2CMşCampania000019NewWorld#158ş0c2NOşNorway000020Virginia#147ş0c2PEşPrince Edward00001DSouthDakota#017ş0c2BFşBuffalo000018Kansas#199ş0c2WAşWallace000020Mexico#023ş0c2SAşSan Luis Potosi00001BMissouri#155ş0c2PMşPemiscot00001BCalifornia#059ş0c2ORşOrange000017Texas#227ş0c2HOWşHoward000026Virginia#690ş0c2MVşMartinsville (City)000019Nebraska#159ş0c2SEşSeward000017Georgia#035ş0c2BSşButts000026MadagascarRegions#MG.AS.DIş0c2DIşDiana000023WestEuropeanRegion#01ş0c2BEşBelgium000023Slovenia#08ş0c2LJşOsrednjeslovenska00001CNewWorld#06ş0c2CRşCosta Rica000017Japan#12ş0c2HOşHokkaido00002BCroatia#17ş0c2VPşViroviti&#269;ko-Podravska000016Honduras#18ş0c2YOşYoro000017Bulgaria#39ş0c2AşBurgas00001ACostaRica#04ş0c2HEşHeredia000017Ontario#15ş0c2HTşHalton000028Poland#85ş0c2WNşWarmi&#324;sko-Mazurskie000024Cuba#14ş0c2SSşSancti Sp&iacute;ritus00001FIndonesia#40ş0c2KRşRiau Islands00001CKuwait#KW.JAş0c2JAşAl Jahrah000026SaoTomeandPrincipe#ST.MZş0c2MZşMe Zoxi000031DemocraticRepublicoftheCongo#CD.EQş0c2EQşEquateur00001DPanama#PA.LSş0c2LSşLos Santos00001ATanzania#TZ.LIş0c2LIşLindi00001DYemen#YE.HUş0c2HUşAl Hudaydah000019Yemen#YE.JAş0c2JAşAl Jawf00001CUganda#UG.RKş0c2RKşRukungiri00001DMalawi#MW.NKş0c2NKşNkhotakota000019Brazil#010ş0c2MAşMaranhao000025WorldwithCountries#114ş0c2MNşMongolia00001DEurope#043ş0c2VAşVatican City000023Pennsylvania#129ş0c2WEşWestmoreland000017Texas#047ş0c2BROşBrooks000017Idaho#065ş0c2MAşMadison000024Virginia#510ş0c2AXşAlexandria (City)000015Ohio#009ş0c2ATşAthens00001FMassachusetts#021ş0c2NOşNorfolk000018Wyoming#001ş0c2ALşAlbany00001BOregon#067ş0c2WHşWashington00001CTennessee#069ş0c2HRşHardeman00001EItaly#005ş0c2EMşEmilia-Romagna000019NewWorld#159ş0c2PLşPoland000018Maine#025ş0c2SOşSomerset00001BOklahoma#021ş0c2CHşCherokee000015Iowa#073ş0c2GRşGreene00001DTexas#409ş0c2SAPşSan Patricio00001ENewJersey#015ş0c2GLşGloucester00001AIndiana#025ş0c2CRşCrawford000018Mexico#024ş0c2SIşSinaloa000021NorthCarolina#065ş0c2EDşEdgecombe000018Georgia#217ş0c2NEşNewton00001BKansas#019ş0c2CQşChautauqua00001BIllinois#055ş0c2FRşFranklin00001BMississippi#163ş0c2YZşYazoo000024YukonTerritory#CA.YT.KUş0c2KUşKluane000020Indonesia#41ş0c2SRşWest Sulawesi000022WestEuropeanRegion#02ş0c2FRşFrance00001BSlovenia#09ş0c2GOşGorenjska000016NewWorld#07ş0c2CUşCuba00001APuertoRico#25ş0c2CGşCaguas000014Japan#13ş0c2HYşHyogo000025Croatia#18ş0c2VSşVukovarsko-Srijemska000019Bulgaria#40ş0c2TXşDobrich000019Ontario#16ş0c2HMşHamilton00001DPoland#86ş0c2WPşWielkopolskie00001ECuba#15ş0c2SCşSantiago de Cuba00001CSerbia#RS.JAş0c2JAşJablanica000019Vanuatu#VU.SNş0c2SNşSanma00001BTunisia#TN.MNş0c2MNşManouba000024Guinea#GN.FOş0c2FOşFor&eacute;cariah00001ATuvalu#TV.VIş0c2VIşVaitupu000018Iran#IR.ESş0c2ESşEsfahan000025FranceDepartment#FR.BRş0c2BRşBas Rhin000021FranceDepartment#FR.CHş0c2CHşCher00001ESaudiArabia#SA.MKş0c2MKşMakkah00001DKazakhstan#KZ.AMş0c2AMşAqmola00001BBurundi#BI.MAş0c2MAşMakamba000023Guyana#GY.DEş0c2DEşDemerara-Mahaica000019Georgia#037ş0c2CLşCalhoun00001CBrazil#011ş0c2MTşMato Grosso000022WorldwithCountries#115ş0c2NPşNepal000017Europe#044ş0c2CYşCyprus00001CMinnesota#089ş0c2MRşMarshall00001BKentucky#073ş0c2FRşFranklin00001BMichigan#083ş0c2KEşKeweenaw000019Florida#001ş0c2ALşAlachua00001EWestVirginia#001ş0c2BAşBarbour000025Italy#006ş0c2FIşFriuli-Venezia Giulia00001BNewWorld#160ş0c2PTşPortugal000017Asia3#002ş0c2AMşArmenia000020Virginia#149ş0c2PGşPrince George00001BSouthDakota#019ş0c2BTşButte00001BKansas#201ş0c2WSşWashington000017Mexico#025ş0c2SOşSonora000018Missouri#157ş0c2PRşPerry00001BCalifornia#061ş0c2PLşPlacer000019Texas#229ş0c2HUDşHudspeth00001BNebraska#161ş0c2SHşSheridan000026WestEuropeanRegion#03ş0c2LUşLuxembourg00002ASlovenia#10ş0c2NOşNotranjsko-kra&scaron;ka00001ANewWorld#08ş0c2DMşDominica000011USA#UTş0c2UTşUtah000016Japan#14ş0c2IBşIbaraki000019Croatia#19ş0c2ZDşZadarska000019Bulgaria#41ş0c2EBşGabrovo00001FCostaRica#06ş0c2LIşLim&oacute;n000019Ontario#17ş0c2HSşHastings000022Poland#87ş0c2ZPşZachodniopomorskie000019Cuba#16ş0c2VCşVilla Clara000015Iran#IR.YAş0c2YAşYazd00001AUganda#UG.ABş0c2ABşKaabong00001AKuwait#KW.HWş0c2HWşHawalli000020SriLanka#LK.TCş0c2TCşTrincomalee000024Ethiopia#ET.GAş0c2GAşGambela peoples000024Cambodia#KH.KGş0c2KGşKampong Chhnang00001EBurkinaFaso#BF.SRş0c2SRşSourou000024Mauritania#MR.TZş0c2TZşTiris Zemmour000033CentralAmerica2#CE.VGş0c2VGşVirgin Islands, British00001FMacedonia#MK.PTş0c2PTşProbistip000022CentralAmerica2#CE.BZş0c2BZşBelize000019Tanzania#TZ.MAş0c2MAşMara000019Malawi#MW.MWş0c2MWşMwanza000023Brazil#012ş0c2MSşMato Grosso do Sul000025WorldwithCountries#116ş0c2PKşPakistan000017Europe#045ş0c2TKşTurkey00001EPennsylvania#131ş0c2WOşWyoming000016Texas#049ş0c2BOWşBrown000018Idaho#067ş0c2MIşMinidoka000017Ohio#011ş0c2AUşAuglaize000020Massachusetts#023ş0c2PLşPlymouth00001AWyoming#003ş0c2BHşBig Horn000018Oregon#069ş0c2WEşWheeler00001ATennessee#071ş0c2HDşHardin000015Italy#007ş0c2LAşLazio00001ANewWorld#161ş0c2ROşRomania000015Maine#027ş0c2WAşWaldo00001AOklahoma#023ş0c2COşChoctaw000015Iowa#075ş0c2GUşGrundy00001AAsia3#003ş0c2AZşAzerbaijan000024Alaska#240ş0c2SFşSoutheast Fairbanks000019Texas#411ş0c2SASşSan Saba00001ANewJersey#017ş0c2HUşHudson000019Indiana#027ş0c2DAşDaviess000018Mexico#026ş0c2TAşTabasco00001FNorthCarolina#067ş0c2FOşForsyth000018Georgia#219ş0c2OCşOconee000019Kansas#021ş0c2CKşCherokee000019Illinois#057ş0c2FUşFulton000022WestEuropeanRegion#04ş0c2MCşMonaco000020Slovenia#11ş0c2SPşGori&scaron;ka000020NewWorld#09ş0c2DOşDominican Rep.000017USA#WAş0c2WAşWashington000019PuertoRico#27ş0c2CAşCamuy000018USA#CTş0c2CTşConnecticut000017Japan#15ş0c2ISşIshikawa000020Croatia#20ş0c2ZGşZagreba&#269;ka00001DBulgaria#42ş0c2COşGrad Sofiya00001DCostaRica#07ş0c2PUşPuntarenas000016Ontario#18ş0c2HUşHuron00001ESerbia#RS.JCş0c2JCşSouth Backa000019Vanuatu#VU.TFş0c2TFşTafea00001APalau#PW.MEş0c2MEşMelekeok000017Uganda#UG.ACş0c2ACşApac000019Benin#BJ.AKş0c2AKşAtacora000021Seychelles#SC.SYş0c2SYşSeychelles00001DEurope2#EU.LTş0c2LTşLithuania00001BCambodia#KH.KHş0c2KHşKratie00001FBurkinaFaso#BF.SSş0c2SSşSissili00001FSriLanka#LK.BCş0c2BCşBatticaloa00001EPanama#PA.NBş0c2NBşNgobe Bugle000022HongKong#HK.YTş0c2YTşYan Tsim Mong000030CentralAfricanRepublic#CF.HSş0c2HSşMambere-Kadei00001ATanzania#TZ.MBş0c2MBşMbeya00001ANebraska#163ş0c2SMşSherman000018Georgia#039ş0c2CMşCamden00001DBrazil#013ş0c2MGşMinas Gerais000028WorldwithCountries#117ş0c2PHşPhilippines000017Europe#046ş0c2RUşRussia00001AMinnesota#091ş0c2MTşMartin000019Kentucky#075ş0c2FUşFulton000017Michigan#085ş0c2LKşLake000017Florida#003ş0c2BAşBaker00001FWestVirginia#003ş0c2BEşBerkeley000017Italy#008ş0c2LIşLiguria00001DNewWorld#162ş0c2SMşSan Marino00001ESouthDakota#021ş0c2CAşCampbell000018Kansas#203ş0c2WHşWichita00001BMexico#027ş0c2TMşTamaulipas000019Missouri#159ş0c2PTşPettis00001BCalifornia#063ş0c2PUşPlumas00001CAlaska#060ş0c2BRşBristol Bay000015Texas#231ş0c2HUNşHunt000028Manitoba#CA.MB.IRş0c2IRşInterlake Region000027WestEuropeanRegion#05ş0c2NLşNetherlands000026Slovenia#12ş0c2JPşObalno-kra&scaron;ka00001DNewWorld#10ş0c2SVşEl Salvador000014Japan#16ş0c2IWşIwate00001CCroatia#21ş0c2GZşGrad Zagreb000018Bulgaria#43ş0c2XşHaskovo000022CostaRica#08ş0c2SJşSan Jos&eacute;00001FOntario#19ş0c2KLşKawartha Lakes00002BPolandCounties#PL.LB.ZMş0c2BZMşZielona Gora000027PolandCounties#PL.ZP.KMş0c2ZKMşKoszalin000017Guinea#GN.FRş0c2FRşFria00001BUganda#UG.ADş0c2ADşAdjumani000019Benin#BJ.ALş0c2ALşAlibori00001DSwaziland#SZ.LUş0c2LUşLubombo00001ALibya#LY.GDş0c2GDşGhadamis000024DenmarkRegion#DK.SDş0c2SDşSyddanmark00001EEurope2#EU.LUş0c2LUşLuxembourg00001DEurope2#EU.MKş0c2MKşMacedonia000022BurkinaFaso#BF.STş0c2STşSanmatenga00001CSriLanka#LK.BDş0c2BDşBadulla00001BNamibia#NA.CAş0c2CAşCaprivi000030CentralAmerica2#CE.VIş0c2VIşVirgin Islands, U.S.000026CentralAmerica2#CE.CRş0c2CRşCosta Rica00001DRussia#RU.ZBş0c2ZBşZabaykalsk000019Uganda#UG.ROş0c2ROşKaliro00001CUganda#UG.SEş0c2SEşSembabule000021SolomonIsland#SB.WEş0c2WEşWestern00001BIllinois#059ş0c2GAşGallatin000015Brazil#014ş0c2PAşPara000023WorldwithCountries#118ş0c2RUşRussia00001BPennsylvania#133ş0c2YOşYork000019Texas#051ş0c2BUSşBurleson000019Idaho#069ş0c2NPşNez perce000016Ohio#013ş0c2BEşBelmont00001FMassachusetts#025ş0c2SUşSuffolk00001AWyoming#005ş0c2CMşCampbell000018Oregon#071ş0c2YAşYamhill00001BTennessee#073ş0c2HWşHawkins000019Italy#009ş0c2LOşLombardia000019NewWorld#163ş0c2CSşSerbia00001AMaine#029ş0c2WSşWashington00001BOklahoma#025ş0c2CIşCimarron000016Iowa#077ş0c2GTşGuthrie00001AAsia3#005ş0c2BDşBangladesh00001BTexas#413ş0c2SCHşSchleicher00001DNewJersey#019ş0c2HTşHunterdon00001AIndiana#029ş0c2DEşDearborn000018NewYork#001ş0c2ALşAlbany000019Mexico#028ş0c2TLşTlaxcala000020NorthCarolina#069ş0c2FRşFranklin00001CGeorgia#221ş0c2OGşOglethorpe000019Kansas#023ş0c2CNşCheyenne000019NewWorld#11ş0c2GDşGrenada000024PuertoRico#29ş0c2CVşCan&oacute;vanas00002DBosniaHerzegovina#01ş0c2BOşBosanskopodrinjski000015Japan#17ş0c2KAşKagawa00001ABulgaria#44ş0c2KşKurdzhali000017Ontario#20ş0c2KEşKenora000016Fiji#FJ.WE.RAş0c2RAşRa000025FranceDepartment#FR.VCş0c2VCşVaucluse00001CChina2#CN.CQş0c2CQşChongqing000023FranceDepartment#FR.CLş0c2CLşCantal000022FranceDepartment#FR.DBş0c2DBşDoubs000024SaoTomeandPrincipe#ST.PAş0c2PAşPague00001AEurope2#EU.LVş0c2LVşLatvia000019Nigeria#NG.BOş0c2BOşBorno00001BSomalia#SO.HIş0c2HIşHiiraan00002FGuyana#GY.UTş0c2UTşUpper Takutu-Upper Essequibo00001AChad#TD.BIş0c2BIşWadi Fira00001BBurundi#BI.KYş0c2KYşKayanza000019Djibouti#DJ.ARş0c2ARşArta000019Malawi#MW.MZş0c2MZşMzimba000018Nebraska#165ş0c2SIşSioux000018Brazil#015ş0c2PBşParaiba000026WorldwithCountries#119ş0c2SGşSingapore00001AMinnesota#093ş0c2MKşMeeker00001BKentucky#077ş0c2GAşGallatin000019Michigan#087ş0c2LPşLapeer000021Virginia#515ş0c2BFşBedford (City)000015Florida#005ş0c2BYşBay00001CWestVirginia#005ş0c2BOşBoone000016Italy#010ş0c2MAşMarche00001BNewWorld#164ş0c2SKşSlovakia000016Asia3#006ş0c2BTşBhutan000021Virginia#153ş0c2PWşPrince William000021SouthDakota#023ş0c2CMşCharles Mix000019Alabama#001ş0c2AUşAutauga000017Kansas#205ş0c2WLşWilson00001FMexico#029ş0c2VEşVeracruz-Llave000019Missouri#161ş0c2PHşPhelps00001ECalifornia#065ş0c2RIşRiverside00001BTexas#233ş0c2HUTşHutchinson000022USACentralRegion#17ş0c2ILşIllinois00001BNewWorld#12ş0c2GTşGuatemala000038BosniaHerzegovina#02ş0c2HNşHercegova&#269;ko-neretvanski000018Japan#18ş0c2KGşKagoshima00001BAustralia#TAş0c2TAşTasmania00001CBulgaria#45ş0c2KHşKyustendil000018Ontario#21ş0c2LAşLambton00001CTunisia#TN.MSş0c2MSşMonastir000023FranceDepartment#FR.VDş0c2VDşVendee000019Oman#OM.MUş0c2MUşMusandam00002EFranceDepartment#FR.CMş0c2CMşCharente Maritime00001BTonga#TO.TTş0c2TTşTongatapu00001DCambodia#KH.KKş0c2KKşKoh Kong00001BSriLanka#LK.APş0c2APşAmpara00001EAngola#AO.LNş0c2LNşLunda Norte000029BurkinaFaso#BF.BKş0c2BKşBoulkiemd&eacute;00001FPhilippines#PH.PLş0c2PLşPalawan00001DKazakhstan#KZ.ARş0c2ARşAtyrau00001ARussia#RU.YNş0c2YNşYamalia00001FDjibouti#DJ.ASş0c2ASşAli Sabieh000019Illinois#061ş0c2GRşGreene000017Brazil#016ş0c2PRşParana000026WorldwithCountries#120ş0c2LKşSri Lanka000017Texas#053ş0c2BUNşBurnet000016Idaho#071ş0c2ONşOneida000014Ohio#015ş0c2BRşBrown000021Massachusetts#027ş0c2WOşWorcester000018Wyoming#007ş0c2CAşCarbon00001BTennessee#075ş0c2HYşHaywood000016Italy#011ş0c2MOşMolise00001BNewWorld#165ş0c2SIşSlovenia000014Maine#031ş0c2YOşYork00001COklahoma#027ş0c2CEşCleveland000017Iowa#079ş0c2HAşHamilton000016Asia3#007ş0c2BNşBrunei000017Texas#415ş0c2SCUşScurry00001ANewJersey#021ş0c2MEşMercer000019Indiana#031ş0c2DCşDecatur00001ANewYork#003ş0c2AEşAllegany000018Mexico#030ş0c2YUşYucatan00001ENorthCarolina#071ş0c2GAşGaston00001AGeorgia#223ş0c2PDşPaulding000016Kansas#025ş0c2CAşClark000017NewWorld#13ş0c2HTşHaiti00001CPuertoRico#31ş0c2CNşCarolina00002ABosniaHerzegovina#03ş0c2KSşKanton Sarajevo000017Japan#19ş0c2KNşKanagawa000018Bulgaria#46ş0c2OBşLovech000017Ontario#22ş0c2LNşLanark000026CentralEuropeanRegion#01ş0c2ATşAustria00001AMacau#MO.IL.TAş0c2TAşTaipa000028NewBrunswick#CA.NB.RVş0c2RVşRiver Valley000025FranceDepartment#FR.DDş0c2DDşDordogne000018Tonga#TO.VAş0c2VAşVava'u00001ABhutan#BT.TMş0c2TMşThimphu00001FBurkinaFaso#BF.BLş0c2BLşBoulgou00001BMacedonia#MK.REş0c2REşResen000020Philippines#PH.PMş0c2PMşPampanga00001DKazakhstan#KZ.ASş0c2ASşAstana000020CentralAmerica2#CE.CUş0c2CUşCuba00001AUganda#UG.RRş0c2RRşMbarara000022Guyana#GY.CUş0c2CUşCuyuni-Mazaruni00001ANebraska#167ş0c2STşStanton000019Georgia#043ş0c2CNşCandler00001BBrazil#017ş0c2PEşPernambuco000027WorldwithCountries#121ş0c2TJşTajikistan00001EMinnesota#095ş0c2MIşMille Lacs00001AKentucky#079ş0c2GRşGarrard00001BMichigan#089ş0c2LLşLeelanau00001AFlorida#007ş0c2BFşBradford00001EWestVirginia#007ş0c2BRşBraxton000018Italy#012ş0c2PIşPiemonte000018NewWorld#166ş0c2ESşSpain000017Asia3#008ş0c2MMşBurma (00001AVirginia#155ş0c2PUşPulaski00001BSouthDakota#025ş0c2CLşClark000019Alabama#003ş0c2BAşBaldwin000018Kansas#207ş0c2WOşWoodson00001AMexico#031ş0c2ZAşZacatecas000017Missouri#163ş0c2PIşPike00001FCalifornia#067ş0c2SAşSacramento000016Texas#235ş0c2IRIşIrion00001EUSACentralRegion#19ş0c2IAşIowa00001ANewWorld#14ş0c2HNşHonduras00002ABosniaHerzegovina#04ş0c2SRşSrednjebosanski000014Japan#20ş0c2KOşKochi000018Bulgaria#47ş0c2MşMontana000024Ontario#23ş0c2LGşLeeds and Grenville00002CCentralEuropeanRegion#02ş0c2CZşCzechRepublic00001BSwitzerland#01ş0c2AAşAargau000037NorthWestTerritories#CA.NT.GSş0c2GSşGreat Slave Gateway000019Malawi#MW.NSş0c2NSşNsanje000024Tibet#TI.SPş0c2SPşShannan Prefecture000026FranceDepartment#FR.COş0c2COşCote d'Or00001EEurope2#EU.MOş0c2MOşMontenegro000021Cambodia#KH.KMş0c2KMşKampong Cham00001CAlgeria#DZ.REş0c2REşRelizane00001BBurkinaFaso#BF.BMş0c2BMşBam000022Philippines#PH.PNş0c2PNşPangasinan00001DKazakhstan#KZ.ATş0c2ATşAqtobe00001FGuineaBissau#GW.BAş0c2BAşBafata00001AUganda#UG.SIş0c2SIşSironko000029Guyana#GY.EBş0c2EBşEast Berbice-Corentyne000019Illinois#063ş0c2GUşGrundy000016Brazil#018ş0c2PIşPiaui000025WorldwithCountries#122ş0c2THşThailand000019Texas#055ş0c2CALşCaldwell000016Idaho#073ş0c2OWşOwyhee000015Ohio#017ş0c2BTşButler00001AWyoming#009ş0c2COşConverse00001DTennessee#077ş0c2HSşHenderson000016Italy#013ş0c2PUşPuglia000019NewWorld#167ş0c2SEşSweden000017Oklahoma#029ş0c2CLşCoal000016Iowa#081ş0c2HNşHancock000018Asia3#009ş0c2KHşCambodia00001CTexas#417ş0c2SHAşShackelford00001DNewJersey#023ş0c2MIşMiddlesex000019Indiana#033ş0c2DKşDe Kalb000017NewYork#005ş0c2BRşBronx000021Mexico#032ş0c2DIşDistrito Federal00001DNorthCarolina#073ş0c2GTşGates000017Georgia#225ş0c2PAşPeach000015Kansas#027ş0c2CYşClay000027MadagascarRegions#MG.MA.MLş0c2MLşMelaky000022Switzerland#02ş0c2ARşAusser-Rhoden000020USACentralRegion#20ş0c2KSşKansas000019NewWorld#15ş0c2JMşJamaica000021PuertoRico#33ş0c2CTşCata&ntilde;o000024BosniaHerzegovina#05ş0c2TUşTuzlanski000017Japan#21ş0c2KUşKumamoto00001CBulgaria#48ş0c2PAşPazardzhik000025Ontario#24ş0c2LEşLennox and Addington000026CentralEuropeanRegion#03ş0c2DEşGermany00001DLibya#LY.YJş0c2YJşYafran-Jadu000023FranceDepartment#FR.VGş0c2VGşVosges000017Uganda#UG.AIş0c2AIşAbim000017Nauru#NR.YAş0c2YAşYaren00001CBenin#BJ.AQş0c2AQşAtlantique00001AVietnam#VN.HAş0c2HAşHa Tay00001BCambodia#KH.KNş0c2KNşKandal000019Bhutan#BT.TOş0c2TOşTongsa000024Liberia#LR.CMş0c2CMşGrand Cape Mount00001CSudan#SD.RNş0c2RNşRiver Nile00001ESudan#SD.SDş0c2SDşSouth Darfur000024CentralAmerica2#CE.DMş0c2DMşDominica000026Virginia#700ş0c2NNşNewport News (City)000019Nebraska#169ş0c2THşThayer000019Georgia#045ş0c2CRşCarroll00001FBrazil#019ş0c2RJşRio de Janeiro000029WorldwithCountries#123ş0c2TMşTurkmenistan00001CMinnesota#097ş0c2MSşMorrison000018Kentucky#081ş0c2GNşGrant00001AMichigan#091ş0c2LEşLenawee000019Florida#009ş0c2BVşBrevard00001DWestVirginia#009ş0c2BKşBrooke000018Italy#014ş0c2SAşSardegna00001ENewWorld#168ş0c2CHşSwitzerland000015Asia3#010ş0c2CNşChina00001FVirginia#157ş0c2RPşRappahannock00001ASouthDakota#027ş0c2CYşClay000019Alabama#005ş0c2BRşBarbour00001AKansas#209ş0c2WYşWyandotte000019Missouri#165ş0c2PAşPlatte00001FCalifornia#069ş0c2SNşSan Benito000015Texas#237ş0c2JACşJack000025Australia2#NSWş0c2NSWşNew South Wales000029NewCaledonia#NC.NO.OGş0c2OGşOu&eacute;goa000025Switzerland#03ş0c2BLşBasel-Landschaft000018NewWorld#16ş0c2MXşMexico000027BosniaHerzegovina#06ş0c2USşUnsko-sanski000014Japan#22ş0c2KYşKyoto000018Bulgaria#49ş0c2PKşPernik00001BOntario#25ş0c2MAşManitoulin000022USANorthWestRegion#41ş0c2ORşOregon000028Slovakia#01ş0c2BCşBansk&aacute; Bystrica000026CentralEuropeanRegion#04ş0c2HUşHungary00001CLibya#LY.ZAş0c2ZAşAz Zawiyah000019Malawi#MW.NUş0c2NUşNtcheu00001BVietnam#VN.GLş0c2GLşGia Lai000024Morocco#MA.SMş0c2SMşSouss Massa Draa00001ESaudiArabia#SA.NJş0c2NJşNajran000018Guinea#GN.YOş0c2YOşYomou00001ELaos#LA.LMş0c2LMşLouang Namtha00001BIllinois#065ş0c2HAşHamilton000024Brazil#020ş0c2RNşRio Grande do Norte000027WorldwithCountries#124ş0c2UZşUzbekistan000018Texas#057ş0c2CAHşCalhoun000017Idaho#075ş0c2PAşPayette000021Virginia#520ş0c2BSşBristol (City)000016Ohio#019ş0c2CAşCarroll000017Wyoming#011ş0c2CRşCrook000019Tennessee#079ş0c2HEşHenry000017Italy#015ş0c2SIşSicilia00001ANewWorld#169ş0c2UAşUkraine00001BOklahoma#031ş0c2CMşComanche000015Iowa#083ş0c2HRşHardin000017Texas#419ş0c2SHEşShelby00001CNewJersey#025ş0c2MOşMonmouth00001AIndiana#035ş0c2DLşDelaware000018NewYork#007ş0c2BOşBroome00001ENorthCarolina#075ş0c2GRşGraham000019Georgia#227ş0c2PCşPickens000016Kansas#029ş0c2CDşCloud000021SouthCarolina#001ş0c2ABşAbbeville000020Switzerland#04ş0c2BSşBasel-Stadt00001BNewWorld#17ş0c2NIşNicaragua000016USA#WIş0c2WIşWisconsin000019PuertoRico#35ş0c2CYşCayey000038BosniaHerzegovina#07ş0c2ZAşZapadnobosanska &#381;upanija000012Japan#23ş0c2MIşMie000018Bulgaria#50ş0c2EHşPleven00001AOntario#26ş0c2MIşMiddlesex00001CSlovakia#02ş0c2BLşBratislava00002CCentralEuropeanRegion#05ş0c2LIşLiechtenstein00001DPalau#PW.NCş0c2NCşNgarchelong000016Iran#IR.GIş0c2GIşGilan000023FranceDepartment#FR.CRş0c2CRşCreuse00001FVietnam#VN.HCş0c2HCşHo Chi Minh00001BCambodia#KH.KPş0c2KPşKampot000020Morocco#MA.TDş0c2TDşTadla Azilal00001CAngola#AO.LSş0c2LSşLunda Sul00001FUzbekistan#UZ.NGş0c2NGşNamangan000029Mauritania#MR.DNş0c2DNşDakhlet Nouadhibou00002ECentralAmerica2#CE.DOş0c2DOşDominican Republic000016Nepal#NP.KOş0c2KOşKosi00001CRussia#RU.YSş0c2YSşYaroslavl000019Nebraska#171ş0c2TOşThomas000019Georgia#047ş0c2CSşCatoosa000022Brazil#021ş0c2RSşRio Grande do Sul000024WorldwithCountries#125ş0c2VNşVietnam000019Minnesota#099ş0c2MWşMower000019Kentucky#083ş0c2GVşGraves00001DMichigan#093ş0c2LIşLivingston000019Florida#011ş0c2BWşBroward00001DWestVirginia#011ş0c2CAşCabell000017Italy#016ş0c2TOşToscana000021NewWorld#170ş0c2UKşUnited Kingdom00001AAsia3#012ş0c2TPşEast Timor00001BVirginia#159ş0c2RCşRichmond00001FSouthDakota#029ş0c2COşCodington000016Alabama#007ş0c2BIşBibb000017Missouri#167ş0c2POşPolk000023California#071ş0c2SBşSan Bernardino00001FAlaska#068ş0c2DEşDenali Borough000018Texas#239ş0c2JAKşJackson000019Switzerland#05ş0c2BEşBern000018NewWorld#18ş0c2PAşPanama000014USA#VTş0c2VTşVermont000030BosniaHerzegovina#08ş0c2ZDşZeni&#269;ko-Dobojski000015Japan#24ş0c2MYşMiyagi000019Bulgaria#51ş0c2PBşPlovdiv000018Ontario#27ş0c2MUşMuskoka00001FSlovakia#03ş0c2KIşKo&scaron;ice000025CentralEuropeanRegion#06ş0c2PLşPoland000024MarshallIsland#MH.MH.JLş0c2JLşJaluit00001BSerbia#RS.KBş0c2KBşKolubara000017Iran#IR.ZAş0c2ZAşZanjan00001APalau#PW.NDş0c2NDşNgaraard000029FranceDepartment#FR.CSş0c2CSşCorse du Sud00001DVietnam#VN.HDş0c2HDşHai Duong000015Nauru#NR.EWş0c2EWşEwa000028DenmarkRegion#DK.SLş0c2SLşSj&aelig;lland000022Ethiopia#ET.HAş0c2HAşHarari people000022Comoros #KM.GCş0c2GCşGrande Comore00001AIllinois#067ş0c2HCşHancock000019Brazil#022ş0c2ROşRondonia000023WorldwithCountries#126ş0c2TWşTaiwan00001BNorthDakota#001ş0c2ADşAdams000019Texas#059ş0c2CANşCallahan000015Idaho#077ş0c2POşPower000018Ohio#021ş0c2CHşChampaign000019Wyoming#013ş0c2FRşFremont00001BTennessee#081ş0c2HIşHickman000023Italy#017ş0c2TRşTrentino-Alto Adige00001FNewWorld#171ş0c2VAşVatican City000019Oklahoma#033ş0c2CTşCotton000017Iowa#085ş0c2HIşHarrison000017Asia3#013ş0c2GEşGeorgia000018Texas#421ş0c2SHRşSherman00001ANewJersey#027ş0c2MRşMorris000018Indiana#037ş0c2DUşDubois00001DNewYork#009ş0c2CAşCattaraugus000021NorthCarolina#077ş0c2GNşGranville000018Georgia#229ş0c2PEşPierce000017Kansas#031ş0c2CFşCoffey00001DSouthCarolina#003ş0c2AIşAiken00001DSwitzerland#06ş0c2FRşFribourg000027NewWorld#19ş0c2KNşSt. Kitts &amp; Nevis000019PuertoRico#37ş0c2CBşCeiba000031BosniaHerzegovina#09ş0c2ZPş&#381;upanija Posavska000017Japan#25ş0c2MAşMiyazaki000019Bulgaria#52ş0c2PPşRazgrad000018Ontario#28ş0c2NIşNiagara000017Slovakia#04ş0c2NIşNitra000027CentralEuropeanRegion#07ş0c2SKşSlovakia00002BPolandCounties#PL.DS.JMş0c2DJMşJelenia Gora000019Uganda#UG.AMş0c2AMşAmuria000025FranceDepartment#FR.CTş0c2CTşCharente00001AKyrgyzstan#KG.OSş0c2OSşOsh000019Europe2#EU.MTş0c2MTşMalta00002BMorocco#MA.RZş0c2RZşRabat Sale Zemmour Zaer000019Angola#AO.LUş0c2LUşLuanda000019Angola#AO.NAş0c2NAşNamibe00001FChad#TD.CGş0c2CGşChari-Baguirmi00001ELaos#LA.LPş0c2LPşLouangphabang000017Texas#241ş0c2JASşJasper00001BNebraska#173ş0c2TUşThurston00001AGeorgia#049ş0c2CHşCharlton000018Brazil#023ş0c2RRşRoraima000026WorldwithCountries#127ş0c2HKşHong Kong00001AMinnesota#101ş0c2MUşMurray00001AKentucky#085ş0c2GYşGrayson000017Michigan#095ş0c2LUşLuce000019Florida#013ş0c2CAşCalhoun00001EWestVirginia#013ş0c2CHşCalhoun000016Italy#018ş0c2UMşUmbria000019NewWorld#172ş0c2CYşCyprus000015Asia3#014ş0c2INşIndia00001AVirginia#161ş0c2RNşRoanoke00001CSouthDakota#031ş0c2CSşCorson000018Alabama#009ş0c2BLşBlount00001AMissouri#169ş0c2PLşPulaski00001ECalifornia#073ş0c2SDşSan Diego00001BAlaska#070ş0c2DIşDillingham00001BSwitzerland#07ş0c2GEşGeneve00001BNewWorld#20ş0c2LCşSt. Lucia000041BosniaHerzegovina#10ş0c2ZZş&#381;upanija Zapadnohercegova&#269;ka000015Japan#26ş0c2NAşNagano000015Bulgaria#53ş0c2PşRuse00001AOntario#29ş0c2NPşNipissing00001FSlovakia#05ş0c2PVşPre&scaron;ov000027CentralEuropeanRegion#08ş0c2SLşSlovenia00002DNewBrunswick#CA.NB.ARş0c2ARşAppalachian Range000018Niger#NE.AGş0c2AGşAgadez00001ESerbia#RS.JNş0c2JNşSouth Banat000019Uganda#UG.BDş0c2BDşBudaka00001ASyria#SY.DIş0c2DIşDamascus000020Cambodia#KH.KSş0c2KSşKampong Spe00001ACapeVerde#CV.MAş0c2MAşMaio00001EAlgeria#DZ.SAş0c2SAşSouk Ahras00001AAngola#AO.MLş0c2MLşMalanje000019Sudan#SD.RSş0c2RSşRed Sea000018Sudan#SD.SIş0c2SIşSennar000019Kansas#033ş0c2CMşComanche000021SouthCarolina#005ş0c2ALşAllendale000019Illinois#069ş0c2HRşHardin00001FBrazil#024ş0c2SCşSanta Catarina000022WorldwithCountries#128ş0c2MOşMacau00001CNorthDakota#003ş0c2BAşBarnes000018Texas#061ş0c2CAMşCameron000018Idaho#079ş0c2SHşShoshone000014Ohio#023ş0c2CLşClark000018Wyoming#015ş0c2GOşGoshen00001BTennessee#083ş0c2HOşHouston00001DItaly#019ş0c2VAşValle d'Aosta000019NewWorld#173ş0c2TKşTurkey000018Oklahoma#035ş0c2CGşCraig000014Iowa#087ş0c2HEşHenry000019Asia3#015ş0c2IDşIndonesia000016Texas#423ş0c2SMIşSmith000019NewJersey#029ş0c2OCşOcean000019Indiana#039ş0c2ELşElkhart000018NewYork#011ş0c2CYşCayuga00001ENorthCarolina#079ş0c2GEşGreene000016Georgia#231ş0c2PIşPike00002ANorthAmerica#001ş0c2AGşAntigua and Barbuda000021NewCaledonia#NC.IL.LIş0c2LIşLifou000029NewCaledonia#NC.NO.PBş0c2PBşPou&eacute;bo00001BSwitzerland#08ş0c2GLşGlarus000022USACentralRegion#26ş0c2MIşMichigan000032NewWorld#21ş0c2VCşSt. Vincent &amp; the Grenadines00001APuertoRico#39ş0c2CLşCiales00002BBosniaHerzegovina#11ş0c2RSşRepublika Srpska000017Japan#27ş0c2NGşNagasaki000017Bulgaria#54ş0c2HşShumen000018Ontario#30ş0c2NOşNorfolk00001FMontenegro#01ş0c2ANşAndrijevica000025Slovakia#06ş0c2TCşTren&#269;&iacute;n00002ACentralEuropeanRegion#09ş0c2CHşSwitzerland000020FrenchGuiana#GF.SL.SAş0c2SAşSaul000028PolandCounties#PL.MA.NMş0c2MNMşNowy Sacz00001AFiji#FJ.EA.KDş0c2KDşKadavu000019Vanuatu#VU.TRş0c2TRşTorba000029FranceDepartment#FR.VMş0c2VMşVal-de-Marne00001DCameroon#CM.LTş0c2LTşLittoral000025FranceDepartment#FR.CVş0c2CVşCalvados00001CVietnam#VN.HGş0c2HGşHa Giang00001FEurope2#EU.NLş0c2NLşNetherlands000021Cambodia#KH.KTş0c2KTşKampong Thom00001BBurkinaFaso#BF.TUş0c2TUşTuy00002CMorocco#MA.THş0c2THşTaza Al Hoceima Taounate000022Algeria#DZ.SBş0c2SBşSidi Bel Abbes00001BNigeria#NG.BYş0c2BYşBayelsa000019Nigeria#NG.DEş0c2DEşDelta00001DMacedonia#MK.RMş0c2RMşRosoman000023CoteDivoire#CI.SBş0c2SBşSud-Bandama00001BTexas#243ş0c2JEDşJeff Davis000019Nebraska#175ş0c2VAşValley000019Georgia#051ş0c2CAşChatham00001ABrazil#025ş0c2SPşSao Paulo000024WorldwithCountries#129ş0c2ALşAlbania00001CMinnesota#103ş0c2NIşNicollet000018Kentucky#087ş0c2GEşGreen00001BMichigan#097ş0c2MKşMackinac00001BFlorida#015ş0c2CHşCharlotte00001BWestVirginia#015ş0c2CLşClay000020Scotland#001ş0c2ABşAberdeenshire000016Italy#020ş0c2VEşVeneto000019NewWorld#174ş0c2RUşRussia00001DVirginia#163ş0c2RKşRockbridge00001CSouthDakota#033ş0c2CUşCuster000019Alabama#011ş0c2BUşBullock000019Missouri#171ş0c2PUşPutnam00001ENorthAmerica#002ş0c2BSşBahamas000022California#075ş0c2SFşSan Francisco000024Switzerland#09ş0c2GRşGraub&uuml;nden000023USACentralRegion#27ş0c2MNşMinnesota000027NewWorld#22ş0c2TTşTrinidad &amp; Tobago000026Australia2#NTş0c2NTşNorthern Territory000013Japan#28ş0c2NRşNara00001ABulgaria#55ş0c2CCşSilistra00001FOntario#31ş0c2NRşNorthumberland000017Montenegro#02ş0c2BAşBar000018Slovakia#07ş0c2TAşTrnava000019Uganda#UG.TGş0c2TGşKitgum000023FranceDepartment#FR.VNş0c2VNşVienne000018Iran#IR.HDş0c2HDşHamadan000022FranceDepartment#FR.DMş0c2DMşDrome000032DemocraticRepublicoftheCongo#CD.HCş0c2HCşOrientale000019Congo#CG.BOş0c2BOşBouenza000019Gambia#GM.BJş0c2BJşBanjul00001CMacedonia#MK.SDş0c2SDşDojran00001EMacedonia#MK.RNş0c2RNşRankovce000020Sudan#SD.SKş0c2SKşSouth Kurdufan00001BBhutan#BT.BUş0c2BUşBumthang00001ABhutan#BT.CKş0c2CKşChhukha000017Bhutan#BT.DAş0c2DAşDaga00002FCentralAfricanRepublic#CF.KBş0c2KBşNana-Grebizi000026Chad#TD.BTş0c2BTşBorkou-Ennedi-Tibesti00001DTanzania#TZ.MOş0c2MOşMorogoro000021CoteDivoire#CI.SCş0c2SCşSud-Comoe000017Kansas#035ş0c2CLşCowley000020SouthCarolina#007ş0c2ANşAnderson00001CIllinois#071ş0c2HEşHenderson000018Brazil#026ş0c2SEşSergipe000024WorldwithCountries#130ş0c2ADşAndorra00001CNorthDakota#005ş0c2BEşBenson000015Texas#063ş0c2CAPşCamp000015Idaho#081ş0c2TEşTeton000017Ohio#025ş0c2CEşClermont00001DWyoming#017ş0c2HSşHot Springs00001DTennessee#085ş0c2HPşHumphreys000018Scotland#002ş0c2ANşAngus000019Italy#021ş0c2SMşSanmarino00001CNewWorld#175ş0c2AUşAustralia000018Oklahoma#037ş0c2CKşCreek000015Iowa#089ş0c2HOşHoward00001ATexas#425ş0c2SOMşSomervell00001BNewJersey#031ş0c2PAşPassaic000019Indiana#041ş0c2FAşFayette00001CNewYork#013ş0c2CHşChautauqua000020NorthCarolina#081ş0c2GUşGuilford000016Georgia#233ş0c2POşPolk00001DIreland#001ş0c2CAşCeatharlach00001FNorthAmerica#003ş0c2BBşBarbados000027NewCaledonia#NC.IL.MAş0c2MAşMar&eacute;00002CNewCaledonia#NC.NO.PDş0c2PDşPoindimi&eacute;000021Switzerland#10ş0c2IRşInner-Rhoden000017Canada#01ş0c2ABşAlberta00001FNewWorld#23ş0c2USşUnited States000019PuertoRico#41ş0c2CDşCidra000016Japan#29ş0c2NIşNiigata000018Bulgaria#56ş0c2CHşSliven000017Ontario#32ş0c2OTşOttawa00001AMontenegro#03ş0c2BEşBerane00001DSlovakia#08ş0c2ZIş&#381;ilina000019Uganda#UG.SRş0c2SRşSoroti00001EMacedonia#MK.ADş0c2ADşAerodrom00001BMalawi#MW.PHş0c2PHşPhalombe000027FranceDepartment#FR.VOş0c2VOşVal d'Oise00002AGuinea#GN.GUş0c2GUşGu&eacute;ck&eacute;dou000019Uganda#UG.BGş0c2BGşBugiri000018Benin#BJ.BOş0c2BOşBorgou000020Cyprus2#CY.GCş0c2GCşGreek Cyprus000019Iran#IR.GOş0c2GOşGolestan000019Algeria#DZ.SDş0c2SDşSaida00001ANepal#NP.MAş0c2MAşMahakali00001FPapuaNewGuinea#PG.GUş0c2GUşGulf000019Burundi#BI.NGş0c2NGşNgozi00001ATexas#245ş0c2JEFşJefferson00001DNebraska#177ş0c2WAşWashington00001FGeorgia#053ş0c2CCşChattahoochee00001ABrazil#027ş0c2TOşTocantins000024WorldwithCountries#131ş0c2ATşAustria00001AMinnesota#105ş0c2NOşNobles00001AKentucky#089ş0c2GUşGreenup000019Michigan#099ş0c2MBşMacomb000018Florida#017ş0c2CIşCitrus000020WestVirginia#017ş0c2DOşDoddridge000019Scotland#003ş0c2ARşArgyll000017NewWorld#176ş0c2FJşFiji00001DVirginia#165ş0c2RGşRockingham00001DSouthDakota#035ş0c2DAşDavison000018Alabama#013ş0c2BTşButler000018Missouri#173ş0c2RSşRalls00001FIreland#002ş0c2CVşCabh&aacute;n00001DNorthAmerica#004ş0c2BZşBelize000020California#077ş0c2SJşSan Joaquin00001BSwitzerland#11ş0c2LUşLuzern000020Canada#02ş0c2BCşBritish Columbia000022USACentralRegion#29ş0c2MOşMissouri00001BNewWorld#24ş0c2GLşGreenland000013Japan#30ş0c2OIşOita000022Australia#SWş0c2SWşNew South Wales000019Bulgaria#57ş0c2CMşSmolyan000017Ontario#33ş0c2OXşOxford000020Montenegro#04ş0c2BPşBijelo Polje00002BFranceDepartment#FR.VPş0c2VPşVille de Paris000018Benin#BJ.CFş0c2CFşCouffo000019Libya#LY.GRş0c2GRşGharyan00001AEurope2#EU.NOş0c2NOşNorway00001AMauritius#MU.MOş0c2MOşMoka00001FNigeria#NG.CRş0c2CRşCross River00001DBurkinaFaso#BF.BWş0c2BWşBanwa00001DAlgeria#DZ.ADş0c2ADşAin Defla00001FGuineaBissau#GW.CAş0c2CAşCacheu000019Kansas#037ş0c2CRşCrawford00001FSouthCarolina#009ş0c2BAşBamberg000018Illinois#073ş0c2HNşHenry00001ABelgium#010ş0c2BRşBrussels000024WorldwithCountries#132ş0c2BYşBelarus00001ENorthDakota#007ş0c2BIşBillings000017Texas#065ş0c2CARşCarson00001AIdaho#083ş0c2TFşTwin falls000016Ohio#027ş0c2CIşClinton000019Wyoming#019ş0c2JOşJohnson000025Europewithcountries#001ş0c2ALşAlbania00001BTennessee#087ş0c2JAşJackson00001BScotland#004ş0c2AYşAyrshire00001BNewWorld#177ş0c2KIşKiribati000019Oklahoma#039ş0c2CSşCuster000017Iowa#091ş0c2HUşHumboldt000015Asia3#019ş0c2JPşJapan000016Texas#427ş0c2STAşStarr000019NewJersey#033ş0c2SAşSalem000017Indiana#043ş0c2FLşFloyd000019NewYork#015ş0c2CEşChemung00001FNorthCarolina#083ş0c2HAşHalifax000019Georgia#235ş0c2PLşPulaski00001DIreland#003ş0c2CLşCl&aacute;r00001DNorthAmerica#005ş0c2CAşCanada000019Montenegro#05ş0c2BUşBudva000024Switzerland#12ş0c2NEşNeuch&acirc;tel000018Canada#03ş0c2MBşManitoba00001BNewWorld#25ş0c2ARşArgentina000019PuertoRico#43ş0c2COşCoamo000018Bahamas#01ş0c2AKşAcklins000016Japan#31ş0c2OKşOkayama000017Bulgaria#58ş0c2CşSofiya00001COntario#34ş0c2PSşParry Sound000024SierraLeone#SL.NO.KDş0c2KDşKoinadugu00001DDjibouti#DJ.DBş0c2DBşDjibouti000024EquatorialGuinea#GQ.ANş0c2ANşAnnobon00001AIran#IR.HGş0c2HGşHormozgan000024FranceDepartment#FR.CZş0c2CZşCorreze000019Algeria#DZ.SFş0c2SFşSetif000020Bhutan#BT.TYş0c2TYşTashi Yangtse00001DCongo#CG.BRş0c2BRşBrazzaville00001FGuineaBissau#GW.BLş0c2BLşBolama000019Texas#247ş0c2JIHşJim Hogg000021Virginia#710ş0c2NOşNorfolk (City)000018Nebraska#179ş0c2WYşWayne00001BGeorgia#055ş0c2CGşChattooga000020Belgium#011ş0c2VBşVlaams-Brabant000024WorldwithCountries#133ş0c2BEşBelgium00001AMinnesota#107ş0c2NRşNorman00001AKentucky#091ş0c2HAşHancock00001BMichigan#101ş0c2MSşManistee000016Florida#019ş0c2CLşClay00001BMississippi#001ş0c2ADşAdams000025Europewithcountries#002ş0c2ADşAndorra00001EWestVirginia#019ş0c2FAşFayette00001DScotland#005ş0c2BAşBanffshire000023NewWorld#178ş0c2MHşMarshall Islands00001AVirginia#167ş0c2RUşRussell000019SouthDakota#037ş0c2DYşDay000019Alabama#015ş0c2CAşCalhoun00001BMissouri#175ş0c2ROşRandolph00001AIreland#004ş0c2COşCorcaigh000021NorthAmerica#006ş0c2CRşCosta Rica000024California#079ş0c2SPşSan Luis Obispo00001BMontenegro#06ş0c2CEşCetinje00001FMiddleEast#01ş0c2AFşAfghanistan00001ESwitzerland#13ş0c2NIşNidwalden00001DCanada#04ş0c2NBşNew Brunswick000022USACentralRegion#31ş0c2NEşNebraska000019NewWorld#26ş0c2BOşBolivia00001EBahamas#02ş0c2BRşBerry Islands000016Japan#32ş0c2ONşOkinawa00001EBulgaria#59ş0c2CTşStara Zagora000015Ontario#35ş0c2PEşPeel000022FrenchGuiana#GF.CY.CMş0c2CMşCamopi000020FranceDepartment#FR.VRş0c2VRşVar00001EPalau#PW.NLş0c2NLşNgeremlengui00001BUganda#UG.ATş0c2ATşAmolatar00001BUganda#UG.BJş0c2BJşButaleja000016Libya#LY.GTş0c2GTşGhat00001DSriLanka#LK.VAş0c2VAşVavuniya000021Somalia#SO.JDş0c2JDşJubbada Dhexe000017Yemen#YE.LAş0c2LAşLahij00001FGuineaBissau#GW.BMş0c2BMşBiombo000018Kansas#039ş0c2DCşDecatur000020SouthCarolina#011ş0c2BRşBarnwell00001BIllinois#075ş0c2IRşIroquois000033WorldwithCountries#134ş0c2BHşBosnia and Herzegovina00001FNorthDakota#009ş0c2BOşBottineau000015Texas#067ş0c2CASşCass000016Idaho#085ş0c2VAşValley000025Virginia#530ş0c2BVşBuena Vista (City)000019Ohio#029ş0c2COşColumbiana00001ENewMexico#001ş0c2BEşBernalillo000019Wyoming#021ş0c2LAşLaramie000025Europewithcountries#003ş0c2ATşAustria00001DTennessee#089ş0c2JEşJefferson00001FScotland#006ş0c2BEşBerwickshire00001DNewWorld#179ş0c2FMşMicronesia00001BOklahoma#041ş0c2DEşDelaware000012Iowa#093ş0c2IDşIda00001AAsia3#021ş0c2KZşKazakhstan000019Texas#429ş0c2STEşStephens00001CNewJersey#035ş0c2SOşSomerset00001AIndiana#045ş0c2FOşFountain00001ANewYork#017ş0c2CNşChenango00001FNorthCarolina#085ş0c2HRşHarnett000018Georgia#237ş0c2PUşPutnam000025Ireland#005ş0c2DOşD&uacute;n na nGall00001BNorthAmerica#007ş0c2CUşCuba00002ENewCaledonia#NC.NO.PHş0c2PHşPon&eacute;rihouen00001FMontenegro#07ş0c2DAşDanilovgrad00001BMiddleEast#02ş0c2BAşBahrain00001DSwitzerland#14ş0c2OBşObwalden000023EastEuropeanRegion#01ş0c2BYşBelarus000029Canada#05ş0c2NLşNewfoundland and Labrador000018NewWorld#27ş0c2BRşBrazil000022PuertoRico#45ş0c2CMşComer&iacute;o000016Belize#01ş0c2BZşBelize000017Bahamas#03ş0c2BIşBimini000014Japan#33ş0c2OSşOsaka00001ENorwayRegion#01ş0c2AKşAkershus00001CBulgaria#60ş0c2TşTurgovishte000016Ontario#36ş0c2PRşPerth000027PolandCounties#PL.SL.KAş0c2SKAşKatowice00001ECoteDivoire#CI.AGş0c2AGşAgneby00001APalau#PW.NMş0c2NMşNgardmau00001AVietnam#VN.HMş0c2HMşHa Nam000020GuineaBissau#GW.TOş0c2TOşTombali000025BurkinaFaso#BF.BZş0c2BZşBaz&egrave;ga000027CentralAfricanRepublic#CF.KGş0c2KGşKemo00001BTanzania#TZ.MTş0c2MTşMtwara000017Nepal#NP.MEş0c2MEşMechi00001FNorthAmerica#008ş0c2DMşDominica00001ECalifornia#081ş0c2SEşSan Mateo00001ATexas#249ş0c2JIWşJim Wells00001ANebraska#181ş0c2WBşWebster00001AGeorgia#057ş0c2CEşCherokee000025WorldwithCountries#135ş0c2BGşBulgaria00001BMinnesota#109ş0c2OLşOlmsted000019Kentucky#093ş0c2HRşHardin00001CMichigan#103ş0c2MQşMarquette000019Florida#021ş0c2COşCollier00001CMississippi#003ş0c2ALşAlcorn000025Europewithcountries#004ş0c2BYşBelarus00001DWestVirginia#021ş0c2GIşGilmer000017Scotland#007ş0c2BUşBute000018NewWorld#180ş0c2NRşNauru00001DAsia3#022ş0c2KPşKorea (north)000018Virginia#169ş0c2SCşScott000018Colorado#001ş0c2ADşAdams00001BSouthDakota#039ş0c2DUşDeuel00001AAlabama#017ş0c2CHşChambers000016Missouri#177ş0c2RAşRay00002AIreland#006ş0c2DUşBaile &Aacute;tha Cliath000026USANorthWestRegion#53ş0c2WAşWashington00001FMontenegro#08ş0c2HNşHerceg Novi000018MiddleEast#03ş0c2INşIran000021Switzerland#15ş0c2SGşSankt Gallen000024SouthEuropeanRegion#01ş0c2ALşAlbania000024EastEuropeanRegion#02ş0c2BGşBulgaria000017NewWorld#28ş0c2CLşChile000014Belize#02ş0c2CYşCayo00001CBahamas#04ş0c2BPşBlack Point000013Japan#34ş0c2SAşSaga000020NorwayRegion#02ş0c2AAşAust-Agder000016Bulgaria#61ş0c2BşVarna00001DOntario#37ş0c2PTşPeterborough00001CBurundi#BI.MVş0c2MVşMuramvya000019Uganda#UG.BLş0c2BLşBulisa000028FranceDepartment#FR.DSş0c2DSşDeux Sevres000019Vietnam#VN.HNş0c2HNşHanoi000022Morocco#MA.TOş0c2TOşTanger Tetouan00001ANigeria#NG.EBş0c2EBşEbonyi00001EBurma#MM.KCş0c2KCşKachin State00001FPhilippines#PH.QRş0c2QRşQuirino000019Georgia#239ş0c2QUşQuitman00001AIreland#007ş0c2GAşGaillimh000025NorthAmerica#009ş0c2DOşDominican Rep.00001AKansas#041ş0c2DKşDickinson000020SouthCarolina#013ş0c2BEşBeaufort00001AIllinois#077ş0c2JAşJackson000024WorldwithCountries#136ş0c2HYşCroatia00001CNorthDakota#011ş0c2BWşBowman000017Texas#069ş0c2CATşCastro00001AIdaho#087ş0c2WAşWashington000018Ohio#031ş0c2CSşCoshocton00001ANewMexico#003ş0c2CAşCatron000018Nebraska#001ş0c2ADşAdams000019Wyoming#023ş0c2LIşLincoln000025Europewithcountries#005ş0c2BEşBelgium00001BTennessee#091ş0c2JOşJohnson00001CScotland#008ş0c2CAşCaithness00001ENewWorld#181ş0c2NZşNew Zealand000018Oklahoma#043ş0c2DWşDewey000013Iowa#095ş0c2IWşIowa00001DAsia3#023ş0c2KRşKorea (south)000019Texas#431ş0c2STRşSterling00001ANewJersey#037ş0c2SUşSussex00001AIndiana#047ş0c2FRşFranklin000019NewYork#019ş0c2CLşClinton00001FNorthCarolina#087ş0c2HWşHaywood000022Montenegro#09ş0c2KLşKola&scaron;in000018MiddleEast#04ş0c2IZşIraq000021Switzerland#16ş0c2SCşSchaffhausen000024SouthEuropeanRegion#02ş0c2ADşAndorra000023EastEuropeanRegion#03ş0c2MDşMoldova00001BCanada#07ş0c2NSşNova Scotia00001ANewWorld#29ş0c2COşColombia000021Quebec#01ş0c2BSşBas-Saint-Laurent00001BPuertoRico#47ş0c2CZşCorozal000017Belize#03ş0c2CZşCorozal00001BBahamas#05ş0c2CIşCat Island000016Japan#35ş0c2SIşSaitama000020Bulgaria#62ş0c2BTşVeliko Turnovo000025Ontario#38ş0c2PCşPrescott and Russell000019Burundi#BI.MWş0c2MWşMwaro00001CHongKong#HK.ISş0c2ISşIslands00001BMacedonia#MK.AJş0c2AJşSaraj000023Sudan#SD.BGş0c2BGşCentral Equatoria000026Serbia#RS.KMş0c2KMşKosovsko Mitrovacki000017Uganda#UG.AWş0c2AWşArua000019Thailand#TH.YLş0c2YLşYala000025SolomonIsland#SB.GCş0c2GCşGuadalcanal00001EBotswana#BW.KGş0c2KGşKgalagadi00001CVietnam#VN.HOş0c2HOşHoa Binh000016Syria#SY.DRş0c2DRşDara00001FMacedonia#MK.RUş0c2RUşStrumitsa00001ABhutan#BT.CRş0c2CRşChirang00001DPhilippines#PH.RIş0c2RIşRizal00001FKazakhstan#KZ.BYş0c2BYşBayqonyr00001BMissouri#179ş0c2REşReynolds000020Ireland#008ş0c2KEşCiarra&iacute;000022NorthAmerica#010ş0c2SVşEl Salvador000022California#083ş0c2SRşSanta Barbara000018Texas#251ş0c2JOHşJohnson00001ANebraska#183ş0c2WHşWheeler000018Georgia#059ş0c2CKşClarke00002BWorldwithCountries#137ş0c2CZşCzech Republic00001EMinnesota#111ş0c2OTşOtter Tail000019Kentucky#095ş0c2HLşHarlan000018Michigan#105ş0c2MAşMason00001AFlorida#023ş0c2CUşColumbia00001BMississippi#005ş0c2AMşAmite000034Europewithcountries#006ş0c2BAşBosnia and Herzegovina00001CWestVirginia#023ş0c2GRşGrant000023Scotland#009ş0c2CLşClackmannanshire000018NewWorld#182ş0c2PWşPalau00001DVirginia#171ş0c2SHşShenandoah00001AColorado#003ş0c2ALşAlamosa00001FAlaska#261ş0c2VCşValdez-Cordova00001BSouthDakota#041ş0c2DEşDewey00001AAlabama#019ş0c2CEşCherokee000019Montenegro#10ş0c2KTşKotor00001AMiddleEast#05ş0c2ISşIsrael00001BSwitzerland#17ş0c2SHşSchwyz000035SouthEuropeanRegion#03ş0c2BAşBosnia &amp; Herzegovina000023EastEuropeanRegion#04ş0c2ROşRomania000017Canada#08ş0c2ONşOntario000019NewWorld#30ş0c2ECşEcuador000027Quebec#02ş0c2SLşSaguenay-Lac-Saint-Jean00001AUSA#WVş0c2WVşWest Virginia00001BBelize#04ş0c2OWşOrange Walk00001EBahamas#06ş0c2CBşCentral Abaco000014USA#GAş0c2GAşGeorgia000014Japan#36ş0c2SHşShiga00001ENorwayRegion#04ş0c2BUşBuskerud000017Bulgaria#63ş0c2BHşVidin00001EOntario#39ş0c2PNşPrince Edward000022MarshallIsland#MH.MH.KNş0c2KNşKnox00001BTanzania#TZ.MWş0c2MWşMwanza00001ARussia#RU.IKş0c2IKşIrkutsk00001APalau#PW.NPş0c2NPşNgatpang00001DUganda#UG.BNş0c2BNşBundibugyo00001ABenin#BJ.CLş0c2CLşCollines00002FHungaryRegions#HU.NGş0c2NGşNorthern Great Plain00001CVietnam#VN.HPş0c2HPşHaiPhong00001AAlgeria#DZ.SKş0c2SKşSkikda000017Nigeria#NG.EDş0c2EDşEdo000021Somalia#SO.JHş0c2JHşJubbada Hoose00001DMacedonia#MK.RVş0c2RVşRadovis000022Macedonia#MK.SLş0c2SLşSveti Nikole000018Niger#NE.THş0c2THşTahoua000021NorthCarolina#089ş0c2HDşHenderson000017Georgia#241ş0c2RBşRabun00001BIreland#009ş0c2KIşCill Dara00001ENorthAmerica#011ş0c2GDşGrenada000019Kansas#043ş0c2DPşDoniphan000020SouthCarolina#015ş0c2BKşBerkeley000019Illinois#079ş0c2JSşJasper000024WorldwithCountries#138ş0c2DKşDenmark00001BNorthDakota#013ş0c2BUşBurke000019Texas#071ş0c2CHAşChambers000017Ohio#033ş0c2CWşCrawford00001ANewMexico#005ş0c2CHşChaves00001BNebraska#003ş0c2ANşAntelope000019Wyoming#025ş0c2NAşNatrona000026Europewithcountries#007ş0c2BGşBulgaria000018Tennessee#093ş0c2KNşKnox000021Scotland#010ş0c2DMşDumbartonshire000023NewWorld#183ş0c2PGşPapua New Guinea000018Oklahoma#045ş0c2ELşEllis000016Iowa#097ş0c2JAşJackson00001ATexas#433ş0c2STOşStonewall000019NewJersey#039ş0c2UNşUnion000018Indiana#049ş0c2FUşFulton00001ANewYork#021ş0c2COşColumbia000029YukonTerritory#CA.YT.NOş0c2NOşNorth Yukon000023USANorthWestRegion#56ş0c2WYşWyoming00001CMontenegro#11ş0c2MKşMojkovac00001AMiddleEast#06ş0c2JOşJordan00001ESwitzerland#18ş0c2SOşSolothurn000024SouthEuropeanRegion#04ş0c2HYşCroatia000023EastEuropeanRegion#05ş0c2UAşUkraine000024Canada#09ş0c2PEşPrince Edward Island000022NewWorld#31ş0c2FKşFalkland Islands000022Quebec#03ş0c2CNşCapitale-Nationale00001BPuertoRico#49ş0c2CUşCulebra00001BBelize#05ş0c2SCşStann Creek00001FBahamas#07ş0c2CNşCentral Andros000014USA#FLş0c2FLşFlorida000016Japan#37ş0c2SMşShimane00001ENorwayRegion#05ş0c2FIşFinnmark000018Bulgaria#64ş0c2BPşVratsa00001COntario#40ş0c2RAşRainy River000024MarshallIsland#MH.MH.KOş0c2KOşKosrae00001EFiji#FJ.TH.EAş0c2EAşTholo East00001ETajikistan#TJ.KLş0c2KLşKhatlon00001BBurundi#BI.MYş0c2MYşMuyinga000032Guyana#GY.ESş0c2ESşEssequibo Islands-West Demerara00001BSerbia#RS.KOş0c2KOşKosovski00002BHungaryRegions#HU.NHş0c2NHşNorthern Hungary000029FranceDepartment#FR.ELş0c2ELşEure et Loir00001BAlgeria#DZ.TBş0c2TBşTebessa00001CSriLanka#LK.COş0c2COşColombo000014Mali#ML.GAş0c2GAşGao000019Senegal#SN.KDş0c2KDşKolda000019Missouri#181ş0c2RIşRipley000020Ireland#010ş0c2KLşCill Chainnigh000020NorthAmerica#012ş0c2GTşGuatemala000020California#085ş0c2STşSanta Clara000016Texas#253ş0c2JONşJones000017Nebraska#185ş0c2YOşYork000016Georgia#061ş0c2CYşClay000024WorldwithCountries#139ş0c2EEşEstonia00001EMinnesota#113ş0c2PEşPennington00001BKentucky#097ş0c2HIşHarrison00001AMichigan#107ş0c2MCşMecosta00001ANewMexico#006ş0c2CIşCibola00001CMississippi#007ş0c2ATşAttala000025Europewithcountries#008ş0c2HYşCroatia000021WestVirginia#025ş0c2GEşGreenbrier000020Scotland#011ş0c2DUşDumfriesshire000018NewWorld#184ş0c2WSşSamoa000014Asia3#026ş0c2LAşLaos000018Virginia#173ş0c2SMşSmyth00001BColorado#005ş0c2ARşArapahoe00001DSouthDakota#043ş0c2DOşDouglas000019Alabama#021ş0c2CIşChilton000020NewCaledonia#NC.NO.PMş0c2PMşPoum000017Bulgaria#65ş0c2YşYambol000018Ontario#41ş0c2REşRenfrew000026Montenegro#12ş0c2NKşNik&scaron;i&#263;00001AMiddleEast#07ş0c2KUşKuwait00001CSwitzerland#19ş0c2THşThurgau000023SouthEuropeanRegion#05ş0c2GRşGreece000022EastEuropeanRegion#06ş0c2RUşRussia000016Canada#10ş0c2QCşQuebec00001FNewWorld#32ş0c2GFşFrench Guiana000018Quebec#04ş0c2MAşMauricie000016Belize#06ş0c2TOşToledo000022Bahamas#08ş0c2CEşCentral Eleuthera000017Japan#38ş0c2SZşShizouka00001DNorwayRegion#06ş0c2HEşHedmark000029FrenchGuiana#GF.SL.SLş0c2SLşSaint Laurent000016Fiji#FJ.WE.BAş0c2BAşBa00001CTanzania#TZ.MYş0c2MYşManyara00001FGuineaBissau#GW.BSş0c2BSşBissau00001BUK7#UK.IMş0c2IMşIsle of Man00001BZimbabwe#ZW.HAş0c2HAşHarare000026Serbia#RS.KPş0c2KPşKosovsko Pomoravski000025Singapore#SG.SOş0c2SOşSouth Singapore00001FCambodia#KH.MKş0c2MKşMondulkiri00001FCongo#CG.COş0c2COşCuvette Ouest000019Angola#AO.MXş0c2MXşMoxico000019Algeria#DZ.ALş0c2ALşAlger000026Algeria#DZ.BBş0c2BBşBordj Bou Arreridj000029CentralAfricanRepublic#CF.LBş0c2LBşLobaye000020NorthCarolina#091ş0c2HTşHertford00001AGeorgia#243ş0c2RAşRandolph000017Ireland#011ş0c2LAşLaois00001CNorthAmerica#013ş0c2HTşHaiti000018Kansas#045ş0c2DGşDouglas00001FSouthCarolina#017ş0c2CAşCalhoun00001CIllinois#081ş0c2JEşJefferson000018Missouri#001ş0c2ADşAdair000024WorldwithCountries#140ş0c2FIşFinland00001ENorthDakota#015ş0c2BRşBurleigh000019Texas#073ş0c2CHEşCherokee000017Ohio#035ş0c2CUşCuyahoga00001ANewMexico#007ş0c2COşColfax000019Nebraska#005ş0c2ARşArthur00001AWyoming#027ş0c2NIşNiobrara00002CEuropewithcountries#009ş0c2CZşCzech Republic000018Tennessee#095ş0c2LAşLake00001FScotland#012ş0c2EAşEast Lothian000022NewWorld#185ş0c2SBşSolomon Islands00001BOklahoma#047ş0c2GAşGarfield000015Iowa#099ş0c2JSşJasper000017Texas#435ş0c2SUTşSutton00001ANewJersey#041ş0c2WAşWarren000018Indiana#051ş0c2GIşGibson00001ANewYork#023ş0c2CTşCortland000017Ontario#42ş0c2SIşSimcoe000018Montenegro#13ş0c2PVşPlav00001EMiddleEast#08ş0c2KGşKyrgyzstan00001BSwitzerland#20ş0c2TIşTicino000022SouthEuropeanRegion#06ş0c2ITşItaly00001CCanada#11ş0c2SKşSaskatchewan000026USACentralRegion#38ş0c2NDşNorth Dakota000023USASouthWestRegion#04ş0c2AZşArizona000018NewWorld#33ş0c2GYşGuyana000016Quebec#05ş0c2ESşEstrie000014USA#WYş0c2WYşWyoming00001APuertoRico#51ş0c2DOşDorado000021Bahamas#09ş0c2FPşCity of Freeport000016Japan#39ş0c2TOşTochigi00001FNorwayRegion#07ş0c2HOşHordaland000019Nepal#NP.LUş0c2LUşLumbini00001ANepal#NP.NAş0c2NAşNarayani000021HongKong#HK.KCş0c2KCşKowloon City000019Uganda#UG.TRş0c2TRşTororo000021Kiribati#KI.LIş0c2LIşLine Islands00001CPhilippines#PH.ABş0c2ABşAbra00001DRussia#RU.INş0c2INşIngushetia000021China2#CN.XJş0c2XJşXinjiang Uygur00001APalau#PW.NSş0c2NSşNgchesar000021Lebanon#LE.JAş0c2JAşSouth Lebanon00001BTuvalu#TV.FNş0c2FNşFunafuti00001CUzbekistan#UZ.NWş0c2NWşNavoi00001AAlgeria#DZ.BCş0c2BCşBechar00001DBurma#MM.KHş0c2KHşKayah State000022Macedonia#MK.SOş0c2SOşSuto Orizari000026Philippines#PH.SCş0c2SCşSouth Cotabato00001EMissouri#183ş0c2SRşSt. Charles00001AIreland#012ş0c2LEşLiatroim00001FNorthAmerica#014ş0c2HNşHonduras00001FCalifornia#087ş0c2SCşSanta Cruz000017Texas#255ş0c2KARşKarnes000019Georgia#063ş0c2CTşClayton000023WorldwithCountries#141ş0c2FRşFrance000018Minnesota#115ş0c2PIşPine000017Kentucky#099ş0c2HTşHart00001CMichigan#109ş0c2MMşMenominee000018Florida#027ş0c2DEşDesoto00001CMississippi#009ş0c2BEşBenton000025Europewithcountries#010ş0c2DKşDenmark000020WestVirginia#027ş0c2HAşHampshire000017Scotland#013ş0c2FIşFife000018NewWorld#186ş0c2TOşTonga000018Asia3#028ş0c2MYşMalaysia00001EVirginia#175ş0c2SUşSouthampton00001CColorado#007ş0c2ACşArchuleta00001DSouthDakota#045ş0c2EDşEdmunds000019Alabama#023ş0c2COşChoctaw00002EOntario#43ş0c2STşStormont, Dundas and Glengary000020Montenegro#14ş0c2PLşPlu&#382;ine00001BMiddleEast#09ş0c2LEşLebanon000018Switzerland#21ş0c2URşUri000026SouthEuropeanRegion#07ş0c2MKşMacedonia00001FCanada#12ş0c2YTşYukon Territory00001ANewWorld#34ş0c2PYşParaguay00001FQuebec#06ş0c2MNşMontr&eacute;al00001FBahamas#10ş0c2CKşCrooked Island000018Japan#40ş0c2TKşTokushima00002CNorwayRegion#08ş0c2MRşM&oslash;re og Romsdal00001EFiji#FJ.TH.WEş0c2WEşTholo West000021SierraLeone#SL.NO.KMş0c2KMşKambia00001BNiger#NE.TLş0c2TLşTillabery00001BTajikistan#TJ.LEş0c2LEşSogd00001BDjibouti#DJ.DKş0c2DKşDikhil00002BRussia#RU.JEş0c2JEşJewish Autonomous Region00001BUganda#UG.BRş0c2BRşKabarole00001DBotswana#BW.KLş0c2KLşKgatleng000019China2#CN.FJş0c2FJşFujian00001BVietnam#VN.HTş0c2HTşHa Tinh00001FCapeVerde#CV.MOş0c2MOşMosteiros00001AAlgeria#DZ.ANş0c2ANşAnnaba00001ANewYork#025ş0c2DEşDelaware00001CNorthCarolina#093ş0c2HOşHoke00001AGeorgia#245ş0c2RIşRichmond00001BIreland#013ş0c2LIşLuimneach00001ENorthAmerica#015ş0c2JMşJamaica000018Kansas#047ş0c2EDşEdwards000022SouthCarolina#019ş0c2CHşCharleston000019Illinois#083ş0c2JRşJersey000019Missouri#003ş0c2ANşAndrew000024WorldwithCountries#142ş0c2DEşGermany00001ANorthDakota#017ş0c2CAşCass00001ATexas#075ş0c2CHIşChildress000014Ohio#037ş0c2DAşDarke000019NewMexico#009ş0c2CUşCurry000019Nebraska#007ş0c2BAşBanner000016Wyoming#029ş0c2PAşPark000025Europewithcountries#011ş0c2EEşEstonia00001ETennessee#097ş0c2LUşLauderdale000022Scotland#014ş0c2ISşInverness-shire000019NewWorld#187ş0c2TVşTuvalu000019Oklahoma#049ş0c2GRşGarvin000018Iowa#101ş0c2JEşJefferson000018Texas#437ş0c2SWIşSwisher000017Indiana#053ş0c2GRşGrant000018Ontario#44ş0c2SUşSudbury00001CMontenegro#15ş0c2PUşPljevlja000018MiddleEast#10ş0c2MUşOman00001BSwitzerland#22ş0c2VAşValais000022SouthEuropeanRegion#08ş0c2MTşMalta000025Canada#13ş0c2NTşNorthwest Territories000022USACentralRegion#40ş0c2OKşOklahoma000026USASouthWestRegion#06ş0c2CAşCalifornia000016NewWorld#35ş0c2PEşPeru000019Quebec#07ş0c2OUşOutaouais00001BPuertoRico#53ş0c2FJşFajardo000022Bahamas#11ş0c2EBşEast Grand Bahama000014Japan#41ş0c2TYşTokyo00001ENorwayRegion#09ş0c2NOşNordland00001FPhilippines#PH.ROş0c2ROşRomblon00001BUganda#UG.BSş0c2BSşBushenyi000028EquatorialGuinea#GQ.BNş0c2BNşBioko Norte00001DVietnam#VN.HUş0c2HUşHau Giang000021Morocco#MA.DAş0c2DAşDoukkala Abda00001CMissouri#185ş0c2SIşSt. Clair00001AIreland#014ş0c2LOşLongfort00001DNorthAmerica#016ş0c2MXşMexico00001BCalifornia#089ş0c2SHşShasta000018Texas#257ş0c2KAUşKaufman00001ALouisiana#001ş0c2ACşAcadia000020Virginia#720ş0c2NRşNorton (City)000018Georgia#065ş0c2CIşClinch000023WorldwithCountries#143ş0c2GRşGreece00001DMinnesota#117ş0c2PSşPipestone00001CKentucky#101ş0c2HEşHenderson00001AMichigan#111ş0c2MDşMidland000017Florida#029ş0c2DIşDixie00001DMississippi#011ş0c2BOşBolivar000025Europewithcountries#012ş0c2FIşFinland00001BArkansas#001ş0c2ARşArkansas00001EWestVirginia#029ş0c2HNşHancock000022Scotland#015ş0c2KCşKincardineshire00001ANewWorld#188ş0c2VUşVanuatu000018Asia3#030ş0c2MNşMongolia00001FVirginia#177ş0c2SPşSpotsylvania000017Colorado#009ş0c2BAşBaca000020SouthDakota#047ş0c2FRşFall River000018Alabama#025ş0c2CLşClarke000030NewCaledonia#NC.SU.IPş0c2IPşL'&Icirc;le-des-Pins00001COntario#45ş0c2TBşThunder Bay00001DMontenegro#16ş0c2PGşPodgorica00001CMiddleEast#11ş0c2PKşPakistan000019Switzerland#23ş0c2VUşVaud000027SouthEuropeanRegion#09ş0c2MOşMontenegro000017Canada#14ş0c2NUşNunavut00001ANewWorld#36ş0c2SRşSuriname00002CQuebec#08ş0c2ATşAbitibi-T&eacute;miscamingue00001BPuertoRico#54ş0c2FLşFlorida000016Bahamas#12ş0c2EMşExuma000016Japan#42ş0c2TTşTottori00002BNorwayRegion#10ş0c2NTşNord-Tr&oslash;ndelag00001EPhilippines#PH.QZş0c2QZşQuezon000029Philippines#PH.SFş0c2SFşShariff Kabunsuan000023CentralAmerica2#CE.GDş0c2GDşGrenada000017Yemen#YE.MAş0c2MAşMarib00001EEastTimor#TL.MFş0c2MFşManufahi00001EMacedonia#MK.BGş0c2BGşBogdanci00001BSudan#SD.BNş0c2BNşBlue Nile00001ECoteDivoire#CI.BFş0c2BFşBafing00001DThailand#TH.YSş0c2YSşYasothon00001CKuwait#KW.KUş0c2KUşAl Kuwayt000019Cameroon#CM.NOş0c2NOşNord000025CaymanIslands#KY.GTş0c2GTşGeorge Town00001ESyria#SY.DYş0c2DYşDayr az Zawr000015Togo#TG.KAş0c2KAşKara00001FGhana#GH.AAş0c2AAşGreater Accra000018Indiana#055ş0c2GEşGreene00001ANewYork#027ş0c2DUşDutchess00001CNorthCarolina#095ş0c2HYşHyde00001AGeorgia#247ş0c2ROşRockdale000021Missouri#186ş0c2SGşSte. Genevieve00001BIreland#015ş0c2LUşL&uacute;000020NorthAmerica#017ş0c2NIşNicaragua000014Kansas#049ş0c2EKşElk000020SouthCarolina#021ş0c2CEşCherokee00001DIllinois#085ş0c2JDşJo Daviess00001BMissouri#005ş0c2ATşAtchison000024WorldwithCountries#144ş0c2HUşHungary00001ENorthDakota#019ş0c2CVşCavalier000015Texas#077ş0c2CLAşClay000029Virginia#540ş0c2CVşCharlottesville (City)000017Ohio#039ş0c2DEşDefiance00001BNewMexico#011ş0c2DBşDe Baca000019Nebraska#009ş0c2BLşBlaine000018Wyoming#031ş0c2PLşPlatte000024Europewithcountries#013ş0c2FRşFrance00001CTennessee#099ş0c2LWşLawrence000020Scotland#016ş0c2KNşKinross-shire000020NewWorld#189ş0c2NCşNew Caledonia000018Oklahoma#051ş0c2GDşGrady000016Iowa#103ş0c2JOşJohnson000015Asia3#031ş0c2NPşNepal000018Texas#439ş0c2TARşTarrant00001COntario#46ş0c2TIşTimiskaming00001FMontenegro#17ş0c2ROşRo&#382;aje000019MiddleEast#12ş0c2QAşQatar000018Switzerland#24ş0c2ZUşZug000025SouthEuropeanRegion#10ş0c2PTşPortugal000024USASouthWestRegion#08ş0c2COşColorado000019NewWorld#37ş0c2UYşUruguay00001FQuebec#09ş0c2COşC&ocirc;te-Nord000022PuertoRico#55ş0c2GCşGu&aacute;nica00001ABahamas#13ş0c2GCşGrand Cay000015Japan#43ş0c2TAşToyama00001DNorwayRegion#11ş0c2OPşOppland000022FrenchGuiana#GF.SL.APş0c2APşApatou000024MarshallIsland#MH.MH.LKş0c2LKşLikiep000021Philippines#PH.SGş0c2SGşSarangani00001DEastTimor#TL.LQş0c2LQşLiquica00001FMacedonia#MK.ARş0c2ARşAracinovo000018Serbia#RS.MAş0c2MAşMacva000018Palau#PW.NWş0c2NWşNgiwal000018Uganda#UG.BUş0c2BUşBusia000024Libya#LY.JAş0c2JAşAl Jabal al Akhdar000019Nigeria#NG.EKş0c2EKşEkiti000020Mauritania#MR.GDş0c2GDşGuidimaka00001DMacedonia#MK.SSş0c2SSşSopiste00001FMissouri#187ş0c2SFşSt. Francois00001AIreland#016ş0c2MAşMaigh Eo00001DNorthAmerica#018ş0c2PAşPanama00001BCalifornia#091ş0c2SIşSierra000018Texas#259ş0c2KENşKendall000019Louisiana#003ş0c2ALşAllen000016Georgia#067ş0c2CBşCobb000024WorldwithCountries#145ş0c2ISşIceland000018Minnesota#119ş0c2PLşPolk000018Kentucky#103ş0c2HYşHenry00001CMichigan#113ş0c2MIşMissaukee000017Florida#031ş0c2DUşDuval00001DMississippi#013ş0c2CAşCalhoun000025Europewithcountries#014ş0c2DEşGermany000019Arkansas#003ş0c2ASşAshley00001CWestVirginia#031ş0c2HRşHardy000025Scotland#017ş0c2KIşKirkcudbrightshire00001ANewWorld#190ş0c2BAşBahrain00001BVirginia#179ş0c2STşStafford000017Colorado#011ş0c2BEşBent00001BSouthDakota#049ş0c2FAşFaulk000016Alabama#027ş0c2CYşClay000018Ontario#47ş0c2TOşToronto000021Montenegro#18ş0c2SAş&Scaron;avnik00001FMiddleEast#13ş0c2SAşSaudiArabia00001BSwitzerland#25ş0c2ZRşZurich000027SouthEuropeanRegion#11ş0c2SMşSan Marino00001BNewWorld#38ş0c2VEşVenezuela000025Quebec#10ş0c2NOşNord-du-Qu&eacute;bec000016Kenya#01ş0c2CEşCentral00001FBahamas#14ş0c2HBşHarbour Island000017Japan#44ş0c2WAşWakayama00001ANorwayRegion#12ş0c2OSşOslo000032DICT_RSS.FEEDSş0c000001ANAMEş0c1Aş1şNameşşşşşşLş4000371BMVBP.BPş0c00006B3SBBP.SB.GETJOBş0c0SUBROUTINE SBBP.SB.GETJOB(entry,startpos,bytes)ş*ş* Copyright (C) 2006 Sierra Bravo Corporation, All Rights Reservedş*ş* Programm: SBBP.SB.LISTPEQSş* Written by: Luke Bucklin, Sierra Bravoş* Date: 04/24/06ş* Description: Send an XML document of the print queue (LISTPEQS)ş*şCOMMON /SBPRINT/ LINK.LIST, LINK.LIST.JOBş*şEQU P.JOB      TO 1şEQU P.PORT     TO 2şEQU P.STATUS   TO 3şEQU P.QUEUE    TO 4şEQU P.BYTES    TO 5şEQU P.DATE     TO 6şEQU P.TIME     TO 7şEQU P.OWNER    TO 8şEQU P.PREVIEW  TO 9ş*şLINK.LIST = "" ; LINK.LIST.JOB = ""ş*şCHUNKSIZE = 50000ş*şFRAMESIZE = SYSTEM(32) ;* D3-onlyş*şIF NOT(startpos MATCHES "1N0N") THEN startpos = 1şIF NOT( bytes MATCHES "1N0N") THEN bytes=99999999ş*şEXECUTE "LISTPEQS ":entry CAPTURING PEQS.OUTşLINES = DCOUNT( PEQS.OUT, @AM )şGOOD.LINE = 0şPINFO = ""şFOR PL = 1 TO LINES-1 UNTIL GOOD.LINEş  LINE = PEQS.OUT<PL>ş  GOOD.LINE = 1ş  previewsize = 0; GET.PREVIEW = 0ş  CALL SUB.SB.PARSEPEQS(LINE,PINFO,previewsize,GET.PREVIEW,GOOD.LINE)şNEXT PLş*ş*CRT '<job id="':entry:'">'ş*CRT ' <date>':OCONV(PINFO<P.DATE>,'D2/'):'</date>'ş*CRT ' <time>':OCONV(PINFO<P.TIME>,'MTS'):'</time>'ş*CRT "<data><![CDATA[":şCHUNKS = 0şNO.PAGES = 1şLOOPş  IF bytes > CHUNKSIZE THENş    sendbytes = CHUNKSIZEş    bytes -= CHUNKSIZEş  END ELSEş    sendbytes = bytesş    bytes = 0ş  ENDş  OUTPUT = ""ş  CALL SUB.SB.GET.ENTRY(entry,startpos,sendbytes,OUTPUT,ERR)ş  CHUNKS += 1ş  IF NOT(ERR) THENş    CONVERT CHAR(0) TO "" IN OUTPUTş    CALL SWAP(OUTPUT,CHAR(12),'[0x12]')ş    NO.PAGES = NO.PAGES + COUNT( OUTPUT, CHAR(12) )ş    CRT OUTPUT:ş  END ELSE EXITş  startpos += sendbytesşWHILE bytes AND OUTPUT # "" DO REPEATş*CRT ']]></data><pages>':NO.PAGES:'</pages>'ş*CRT '</job>'şSTOP000A12SUB.SB.GET.ENTRYş0c0SUBROUTINE SUB.SB.GET.ENTRY(JOB,START.POS,BYTES,OUTPUT,ERR)ş*ş* Copyright (C) 2006 Sierra Bravo Corporation, All Rights Reservedş*ş* Programm: SUB.SB.GET.ENTRYş* Written by: Luke Bucklin, Sierra Bravoş* Date: 04/24/06ş* Description: Extract a segment of print queue contentş*şCOMMON /SBPRINT/ LINK.LIST, LINK.LIST.JOBş*şFRAMESIZE = SYSTEM(32) ;* D3-onlyşOUTPUT = ""şERR = ""şBYTES.TO.GET = BYTESş*şEXECUTE "LISTPEQS ":JOB:" E" CAPTURING JOB.LINEşJOB.LINE = JOB.LINE<5>	şFID = JOB.LINE[34,8]şIF FID # "" THENş  * Get full sequential list of frame IDsş  FSIZE = FRAMESIZE-1ş  IF START.POS > 1 OR BYTES > FSIZE THENş    IF LINK.LIST.JOB # JOB THENş      * We didn't just build this recently, so go ahead and build it nowş      * associate the LINK.LIST (in common) with the job so if we are askedş      * to build this linked list again for this job, we can skip this partş      * and just pull it from commonş      LINK.LIST = FIDş      LINK.LIST.JOB = JOBş      EXECUTE "DUMP .":FID:" L" CAPTURING LINKAGEş      START.ROW = INDEX(LINKAGE,'+',1)ş      START.ROW = DCOUNT(LINKAGE[1,START.ROW],@AM)ş      MAX.ROWS = DCOUNT( LINKAGE, @AM )ş      FOR LX = START.ROW TO MAX.ROWSş        ROW = LINKAGE<LX>ş        IF TRIM(ROW) # "" THENş          XFRAME = TRIM(FIELD( ROW,'(',2))ş          XFRAME = FIELD(XFRAME,' ',1)ş          LINK.LIST<-1> = XFRAMEş        ENDş      NEXT LXş    ENDş    *ş    * First frame is FRAMESIZE-1 bytes because the firstş    * byte is a throwaway.ş    *ş    START.TEMP = START.POSş    SKIP.FRAMES = 0ş    LOOP UNTIL START.TEMP <= FSIZE DOş      SKIP.FRAMES += 1ş      START.TEMP -= FSIZEş      FSIZE = FRAMESIZEş    REPEATş    IF SKIP.FRAMES THEN OFFSET = START.TEMP-1 ELSE OFFSET = START.TEMPş    IF SKIP.FRAMES = 0 AND OFFSET = 0 THEN OFFSET = 1ş  END ELSEş    LINK.LIST = FIDş    OFFSET = 1ş    SKIP.FRAMES = 0ş  ENDş  MAX.FRAMES = DCOUNT( LINK.LIST, @AM )ş  FX.START = 1 + SKIP.FRAMESş  FOR FX = FX.START TO MAX.FRAMES WHILE BYTES.TO.GET ş    FID = LINK.LIST<FX>ş    EXECUTE "DUMP .":FID:" SX" CAPTURING PREVX.OUTş    IF LEN(PREVX.OUT) # FRAMESIZE*2 THENş      ERR = 1ş      EXITş    ENDş    IF OFFSET THENş      PREVX.OUT = PREVX.OUT[(OFFSET*2)+1,FRAMESIZE*2]ş    ENDş    DATLEN = LEN(PREVX.OUT) / 2ş    PREVX.OUT = OCONV( PREVX.OUT, 'MY' )ş    IF DATLEN > BYTES.TO.GET THENş      PREVX.OUT = PREVX.OUT[1,BYTES.TO.GET]ş      BYTES.TO.GET = 0ş    END ELSEş      BYTES.TO.GET -= DATLENş    ENDş    OUTPUT := PREVX.OUTş    CONVERT CHAR(0) TO "" IN OUTPUTş    CONVERT @AM TO "^" IN OUTPUTş    OFFSET = 0ş  NEXT FXşEND ELSE ERR = 1şRETURN000703SUB.SB.PARSEPEQSş0c0SUBROUTINE SUB.SB.PARSEPEQS(LINE,PINFO,previewsize,GET.PREVIEW,GOOD.LINE)ş*şEQU P.JOB      TO 1şEQU P.PORT     TO 2şEQU P.STATUS   TO 3şEQU P.QUEUE    TO 4şEQU P.BYTES    TO 5şEQU P.DATE     TO 6şEQU P.TIME     TO 7şEQU P.OWNER    TO 8şEQU P.PREVIEW  TO 9ş*şFRAMESIZE = SYSTEM(32) ;* D3-onlyşIF NOT(FRAMESIZE MATCHES "1N0N") THEN FRAMESIZE = 4000ş*şPINFO = ""ş*şJOB = TRIM(LINE[1,4])şIF JOB MATCHES "1N0N" THENş  PINFO<P.JOB> = JOBş  *ş  L.PORT = TRIM(LINE[15,5])ş  PINFO<P.PORT> = L.PORTş  *ş  L.STATUS = TRIM(LINE[23,15])ş  STATUS.MSG = ""ş  IF INDEX(L.STATUS,'h',1) THENş    STATUS.MSG := 'Hold,'ş  ENDş  IF INDEX(L.STATUS,'l',1) THENş    STATUS.MSG := 'Locked,'ş  ENDş  IF INDEX(L.STATUS,'o',1) THENş    STATUS.MSG := 'Generating,'ş  ENDş  IF INDEX(L.STATUS,'s',1) THENş    STATUS.MSG := 'Spooled,'ş  END ELSE IF INDEX(L.STATUS,'p',1) THENş    STATUS.MSG := 'To print,'ş  END ELSE IF INDEX(L.STATUS,'x',1) THENş    STATUS.MSG := 'Canceled,'ş  ENDş  IF STATUS.MSG # "" THEN STATUS.MSG = STATUS.MSG[1,LEN(STATUS.MSG)-1] ;* Get rid of the trailing commaş  PINFO<P.STATUS> = STATUS.MSGş  *ş  L.QUEUE = TRIM(LINE[42,5])ş  PINFO<P.QUEUE> = L.QUEUEş  *ş  L.BYTES = TRIM(LINE[47,7])ş  L.BYTES = L.BYTES * FRAMESIZEş  PINFO<P.BYTES> = L.BYTESş  *ş  L.DATE = TRIM(LINE[55,8])ş  L.DATE = ICONV( L.DATE,'D' )ş  PINFO<P.DATE> = L.DATEş  *ş  L.TIME = TRIM(LINE[64,8])ş  L.TIME = ICONV( L.TIME, 'MTS' )ş  PINFO<P.TIME> = L.TIMEş  *ş  L.OWNER = TRIM(LINE[73,20])ş  PINFO<P.OWNER> = L.OWNERş  *ş  IF GET.PREVIEW THENş    *ş    * Get preview unless we are searching -that's a whole different process.ş    *ş    L.PREVIEW = ""ş    CALL SUB.SB.GET.ENTRY(JOB,1,previewsize,L.PREVIEW,ERR)ş    IF ERR # "" THEN GOOD.LINE = 0ş    PINFO<P.PREVIEW> = L.PREVIEWş  ENDşEND ELSE GOOD.LINE = 0şRETURNş001F30SBBP.SB.LISTPEQSş0c0*ş* Copyright (C) 2008 Sierra Bravo Corporation, All Rights Reservedş*ş* Programm: SBBP.SB.LISTPEQSş* Written by: Luke Bucklin, Sierra Bravoş* Adapted by: David Bucklin, Sierra Bravoş*             CGI Version of the Bravo Print XML APIş* Date: 04/24/06ş* Description: Send an XML document of the print queue (LISTPEQS)ş*şCOMMON /SBPRINT/ LINK.LIST, LINK.LIST.JOBşINCLUDE WBPD WWW.INCLUDEş*şLINK.LIST = "" ; LINK.LIST.JOB = ""ş*şEQU P.JOB      TO 1şEQU P.PORT     TO 2şEQU P.STATUS   TO 3şEQU P.QUEUE    TO 4şEQU P.BYTES    TO 5şEQU P.DATE     TO 6şEQU P.TIME     TO 7şEQU P.OWNER    TO 8şEQU P.PREVIEW  TO 9ş*şOPEN '','SBBP.FORMS' TO F.SBBP.FORMS ELSE STOP 201, 'SBBP.FORMS'ş*şCALL WDB.VARS(VARS,VALS)ş*şFRAMESIZE = SYSTEM(32) ;* D3-onlyş*şLOCATE "entrystart" IN VARS SETTING POS THENş  entrystart = VALS<POS>şEND ELSE entrystart = ""şLOCATE "entries" IN VARS SETTING POS THENş  entries = VALS<POS>şEND ELSE entries = ""şLOCATE "begindate" IN VARS SETTING POS THENş  begindate = VALS<POS>ş  begindate = ICONV(begindate,'D')şEND ELSE begindate = ""şLOCATE "enddate" IN VARS SETTING POS THENş  enddate = VALS<POS>ş  enddate = ICONV(enddate,'D')şEND ELSE enddate = ""şLOCATE "owner" IN VARS SETTING POS THENş  owner = VALS<POS>şEND ELSE owner = ""şLOCATE "queue" IN VARS SETTING POS THENş  queue = VALS<POS>şEND ELSE queue = ""şLOCATE "previewsize" IN VARS SETTING POS THENş  previewsize = VALS<POS>şEND ELSE previewsize = ""şLOCATE "port" IN VARS SETTING POS THENş  port = VALS<POS>şEND ELSE port = ""şLOCATE "searchstring" IN VARS SETTING POS THENş  searchstring = VALS<POS>şEND ELSE searchstring = ""şIF searchstring # "" THEN GET.PREVIEW = 0 ELSE GET.PREVIEW = 1şIF NOT(previewsize MATCHES "1N0N") THENş  previewsize = 500şENDşLOCATE "entry" IN VARS SETTING POS THENş  entry = VALS<POS>şEND ELSE entry = ""şLOCATE "action" IN VARS SETTING POS THENş  action = VALS<POS>şEND ELSE action = ""ş*ş*ERROR = ""şALL.ENTRIES.FOUND = 0şENTRY.LIST = ''şLOOPş  LOCATE "entries[]" IN VARS SETTING POS THENş    ENTRY.LIST<-1> = VALS<POS>ş    VARS<POS> = "XXX"ş  END ELSE ALL.ENTRIES.FOUND = 1şUNTIL ALL.ENTRIES.FOUND DO REPEATşIF entry # "" THEN ENTRY.LIST<-1> = entryşECNT = DCOUNT( ENTRY.LIST, @AM )şFOR EX = 1 TO ECNTş  entry = ENTRY.LIST<EX>ş  BEGIN CASEş    CASE entry = ""ş      CMD = ''ş    CASE action = "delete"ş      CMD = "SP-KILL ":entry:"F"ş      EXECUTE CMD CAPTURING JUNKş      CMD = "SP-EDIT ":entry:" MUD"ş    CASE action = "print"ş      EXECUTE "SP-KILL ":entry:"F" CAPTURING JUNKş      IF queue # "" THENş        EXECUTE "SP-ASSIGN F":queue CAPTURING JUNKş      ENDş      CMD = "SP-EDIT ":entry:" MSRU"ş    CASE action = "release"ş      CMD = "SP-KILL ":entry:"F"ş    CASE action = "downloadtxt"ş      CRT "Content-Type: text/plain"ş      CRT "Content-Disposition: attachment;filename=":entry:".txt"ş      CRTş      SESSION$CONTENT.SENT = 1ş      CALL SBBP.SB.GETJOB(entry,1,"")ş      STOP  ş    CASE 1ş      CMD = ''ş  END CASEş  IF CMD # "" THENş    EXECUTE CMD CAPTURING JUNKş  ENDşNEXT EXş*şCMD.SUFF = ""şIF entrystart # "" THENş  CMD.SUFF = entrystart:"-9999 "şENDşIF owner # "" THENş  CMD.SUFF := "'":owner:"' "şENDş*şEXECUTE "LISTPEQS ":CMD.SUFF CAPTURING PEQS.OUTş*şCRT "Content-Type: text/html"şCRTşSESSION$CONTENT.SENT = 1ş*şREAD FORM.DATA FROM F.SBBP.FORMS, 'listpeqs.html' ELSE FORM.DATA = ''şFORM.HDR.POS = INDEX( FORM.DATA, '[QUEUE]', 1 )-1şPART1 = FORM.DATA[1,FORM.HDR.POS]şCONVERT @AM TO CHAR(13) IN PART1şCRT PART1şPART2 = FORM.DATA[FORM.HDR.POS+7,99999]şXML = ""ş*şLINES.SENT = 0şLINES = DCOUNT( PEQS.OUT, @AM )şFOR PL = 1 TO LINES-1ş  LINE = PEQS.OUT<PL>ş  GOOD.LINE = 1ş  CALL SUB.SB.PARSEPEQS(LINE,PINFO,previewsize,GET.PREVIEW,GOOD.LINE)ş  * Filteringş  BEGIN CASEş    CASE NOT(GOOD.LINE) ; NULLş    CASE PINFO<P.JOB> = "" ; GOOD.LINE = 0ş    CASE begindate # "" AND enddate # ""ş      IF PINFO<P.DATE> < begindate OR PINFO<P.DATE> > enddate THEN GOOD.LINE = 0ş    CASE port # "" AND PINFO<P.PORT> # port ; GOOD.LINE = 0ş    CASE queue # "" AND	 PINFO<P.QUEUE> # queue ; GOOD.LINE = 0ş    CASE 1ş      NULLş  END CASEş  IF GOOD.LINE THENş    * ş    IF searchstring # "" THENş      JOB = PINFO<P.JOB>ş      GOSUB SEARCH.JOBş    ENDş  ENDş  IF GOOD.LINE THENş    LINES.SENT += 1ş    *ş    PDATE = OCONV(PINFO<P.DATE>,'D2/')ş    PTIME = OCONV(PINFO<P.TIME>,'MTS')ş    *ş    IF LINES.SENT / 2 = INT(LINES.SENT/2) THENş      XML<-1> = '<tr class="even">'ş    END ELSEş      XML<-1> = '<tr class="odd">'ş    ENDş    XML<-1> = '<td><input type="checkbox" name="entries[]" value="':PINFO<P.JOB>:'" /></td>'ş    XML<-1> = '<td><a href="/dbc/SBBP.SB.LISTPEQS?entry=':PINFO<P.JOB>:'&action=downloadtxt">':PINFO<P.JOB>:'</a></td>'ş    XML<-1> = '<td><a href="/dbc/SBBP.SB.LISTPEQS?queue=':PINFO<P.QUEUE>:'">':PINFO<P.QUEUE>:'</a></td>'ş    XML<-1> = '<td><a href="/dbc/SBBP.SB.LISTPEQS?owner=':PINFO<P.OWNER>:'">':PINFO<P.OWNER>:'</a></td>'ş    XML<-1> = '<td><a href="/dbc/SBBP.SB.LISTPEQS?port=':PINFO<P.PORT>:'">':PINFO<P.PORT>:'</a></td>'ş    XML<-1> = '<td align="right">':OCONV(PINFO<P.BYTES>/1000,'MD,'):'</td>'ş    XML<-1> = '<td>':OCONV(PINFO<P.DATE>,'D2/'):' ':OCONV(PINFO<P.TIME>,'MTS'):'</td>'ş    XML<-1> = '<td>':PINFO<P.STATUS>:'</td>'ş    XML<-1> = \<td><a href="#" title="Print Job" onclick="Effect.SlideDown('printDialog\:PINFO<P.JOB>:\',{duration:0.25}); return false;"><img src="/db/images/button_print.gif"/></a>\ş*    XML<-1> = \<a href="/viewjob.php?entry=\:PINFO<P.JOB>:\&date=\:PDATE:\&time=\:PTIME:\" title="View Job"><img src="/db/images/button_preview.gif"/></a>\ş    XML<-1> = \<a href="/dbc/SBBP.SB.LISTPEQS?action=downloadtxt&entry=\:PINFO<P.JOB>:\&date=\:PDATE:\&time=\:PTIME:\" title="Download Job as TXT File"><img src="/db/images/button_downloadtxt.gif"/></a>\ş    XML<-1> = \<a href="/dbc/SBBP.SB.LISTPEQS?action=delete&entry=\:PINFO<P.JOB>:\&queue=&port=&owner=&searchstring=&begindate=&enddate=&search_type=" title="Delete Job" class="deletejob" onclick="return confirm('Are you sure you want to delete this job?')"><img src="/db/images/button_delete.gif"/></a>\ş    XML<-1> = '<div style="position:relative;">'ş    XML<-1> = '<div class="printDialog" id="printDialog':PINFO<P.JOB>:'" style="display:none;">'ş    XML<-1> = \<div> Queue <input type="text" value="0" style="width:40px;" maxlength="4" id="overrideQueue\:PINFO<P.JOB>:\"/>\ş    XML<-1> = \<span class="button"><button type="button" onclick="document.location='/dbc/SBBP.SB.LISTPEQS?action=print&entry=\:PINFO<P.JOB>:\&overridequeue='+$F('overrideQueue\:PINFO<P.JOB>:\')+'&queue=&port=&owner=&searchstring=&begindate=&enddate=&search_type='">Print</button></span>\ş    XML<-1> = \<span class="button"><button type="button" onclick="Effect.SlideUp('printDialog\:PINFO<P.JOB>:\',{duration:0.25});return false;">Cancel</button></span>\ş    XML<-1> = '</div> </div>'ş    XML<-1> = '<pre class="preview">'ş    XML<-1> = PINFO<P.PREVIEW>ş    XML<-1> = '</pre> </div> </td> </tr>'ş    CALL WEB.SEND(XML)ş    XML = ''ş    *ş    *IF LINES.SENT >= entries AND entries # "" THEN EXITş  ENDşNEXT PLşCALL WEB.SEND(PART2)şSTOPş*şSEARCH.JOB: * Search the job for the stringş*şSTART.POS = 1şGOOD.LINE = 0şSEARCHBUFFSIZE = 15000şLOOPş  BUFFER = ""ş*  PRINT "Searching job # ":JOB:" ":START.POS:",":SEARCHBUFFSIZEş  CALL SUB.SB.GET.ENTRY(JOB,START.POS,SEARCHBUFFSIZE,BUFFER,ERR)ş  IF NOT(ERR) THENş    FOUND.POS = INDEX( BUFFER, searchstring, 1 )ş    IF FOUND.POS THENş      BACK.UP = FOUND.POS - INT(previewsize/2) - 140ş      START.POS = START.POS + BACK.UPş      CALL SUB.SB.GET.ENTRY(JOB,START.POS,previewsize,L.PREVIEW,ERR)ş      FOUND.NL = 0ş      FOR NL = 1 TO 250 UNTIL FOUND.NLş      	CH = L.PREVIEW[NL,1]ş      	IF CH = CHAR(10) OR CH = CHAR(13) THENş      	  L.PREVIEW = L.PREVIEW[NL,previewsize]ş      	  FOUND.NL = 1ş      	ENDş      NEXT NLş      PINFO<P.PREVIEW> = L.PREVIEWş      GOOD.LINE = 1ş    END ELSEş      START.POS = START.POS + SEARCHBUFFSIZE - LEN(searchstring)ş    ENDş  END ELSE EXITşUNTIL ERR OR GOOD.LINE OR BUFFER = "" DO REPEATşRETURN04EA07MVDB.SUBSş0c0000BE6SUB.TABLE.LIC.USEDş0c2SUBROUTINE SUB.TABLE.LIC.USEDş*ş* Dashboard Widgetş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEş*ş* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*ş* Modified by Peter Schellenbach of Zumasys 06-08-15:ş*  Changed test of ENUM after EXECUTE to test SYSTEM(11) instead.ş*şW$TITLE = "Dashboard Users Logged On"     ;* Title for widget title barşW$TYPE = "TABLE"                ;* Filled in by editorşW$WIDTH = 2                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*şOPEN 'WEB.SESSION' TO F.WEB.SESSION ELSE RETURNş*şIF WIDGET.USER.DATA(1) # "" THEN DELETE F.WEB.SESSION, WIDGET.USER.DATA(1)şWIDGET.USER.DATA(1) = ""ş*şTBL=""şEXECUTE 'SELECT WEB.SESSION' RETURNING ENUM CAPTURING ETXTş*PJS 06-08-15*IF ENUM[1,3]="404" ELSE RETURNşIF SYSTEM(11) = 0 THEN RETURN ; *PJS 06-08-15*şLOOPş READNEXT ID ELSE ID="\\EOF"şUNTIL ID="\\EOF" DOş READ REC FROM F.WEB.SESSION,ID THENş   LOCATE "userid" IN REC<1> SETTING IX THENş     UID=REC<2,IX>ş     LOCATE "LastSessionAccess" IN REC<1> SETTING IX THENş       LSA=REC<2,IX>ş     END ELSEş       LSA=00000*00000ş     ENDş     LSA.DT=FIELD(LSA,"*",1)ş     LSA.TM=FIELD(LSA,"*",2)ş     LGN.DT=REC<3>ş     LGN.TM=REC<4>ş     LOCARG=LGN.DT:"*":LGN.TM:"*":LSAş     LOCATE LOCARG IN TBL<1> BY "AR" SETTING IX ELSE NULLş     TBL=INSERT(TBL,1,IX;LOCARG)ş     TBL=INSERT(TBL,2,IX;UID)ş     TBL=INSERT(TBL,3,IX;ID)ş   ENDş ENDşREPEATş*ş* Set up column labelsşW$TABLE.COL.LABELS<1,1> = "User Login ID"şW$TABLE.COL.LABELS<1,2> = "Session#"şW$TABLE.COL.LABELS<1,3> = "Login Date"şW$TABLE.COL.LABELS<1,4> = "Login Time"şW$TABLE.COL.LABELS<1,5> = "Last Act Date"şW$TABLE.COL.LABELS<1,6> = "Last Act Time"ş*ş* Column justification = left, right, centerşW$TABLE.COL.JUST<1,1> = "left"şW$TABLE.COL.JUST<1,2> = "right"şW$TABLE.COL.JUST<1,3> = "right"şW$TABLE.COL.JUST<1,4> = "right"şW$TABLE.COL.JUST<1,5> = "right"şW$TABLE.COL.JUST<1,6> = "right"ş*ş* Table RowsşTBL.MAX = DCOUNT(TBL<1>,CHAR(253))şFOR ROW = 1 TO TBL.MAXş W$TABLE.DATA<ROW,1> = TBL<2,ROW>ş IF TBL<3,ROW> = SESSION$ID THEN W$TABLE.DATA<ROW,2> = "*":ROW ELSE W$TABLE.DATA<ROW,2> = ROWş W$TABLE.DATA<ROW,3> = OCONV(FIELD(TBL<1,ROW>,"*",1),"D2/")ş W$TABLE.DATA<ROW,4> = OCONV(FIELD(TBL<1,ROW>,"*",2),"MTS")ş W$TABLE.DATA<ROW,5> = OCONV(FIELD(TBL<1,ROW>,"*",3),"D2/")ş W$TABLE.DATA<ROW,6> = OCONV(FIELD(TBL<1,ROW>,"*",4),"MTS")şNEXT ROWş*ş* TotalsşW$TABLE.TOTALS<1,3> = TBL.MAXşW$TABLE.TOTALS<1,4> = "Consumed"şLIC.AVAIL = "Unlimited"şIF ASSIGNED(G$LICENSE.COUNT) THENş IF NUM(G$LICENSE.COUNT) THENş   LIC.AVAIL = G$LICENSE.COUNT - TBL.MAXş ENDşENDşW$TABLE.TOTALS<1,5> = LIC.AVAILşW$TABLE.TOTALS<1,6> = "Available"ş*şW$INPUT.PROMPT<1> = "Sessions"şW$INPUT.TYPE<1> = "SELECT"şW$INPUT.DEFAULT<1> = 0şW$INPUT.UDPOS<1> = 1şW$INPUT.BUTTON<1> = "Log Off"şW$INPUT.SELOPTS<1> = "Nobody"şW$INPUT.SELVALS<1> = 0şFOR ROW = 1 TO TBL.MAXş IF SESSION$ID = TBL<3,ROW> ELSEş   W$INPUT.SELOPTS<1,-1> = ROW:" ":TBL<2,ROW>ş   W$INPUT.SELVALS<1,-1> = TBL<3,ROW>ş ENDşNEXT ROWş*şRETURN002FD3MV.DEMO.MAPş0c2    SUBROUTINE MV.DEMO.MAPş* @(#) MV.DEMO.MAP Ported to jBASE 17:55:31  08 JUL 2015ş*  The following variable names were convertedş*   TABLEş* ş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş*ş* 6-1-15 ZUMASYS CHANGED MAP ID DELIMITER TO # INSTEAD OF *ş    INCLUDE WBPD MVDB.INCLUDEş*ş    W$TITLE = "Data Evolution - Demographics"ş    W$TYPE = "MAP:USASouthWestRegion"ş    W$WIDTH = 3ş*ş    IF G$QUERYMODE THEN RETURNş*ş    TYPE.ID=WIDGET.USER.DATA(1)ş    BEGIN CASEş    CASE TYPE.ID="04"ş        W$TYPE="MAP:Arizona"ş        WIDGET.USER.DATA(6)="Arizona"ş        ACT.FACT=.08ş    CASE TYPE.ID="06"ş        W$TYPE="MAP:California"ş        WIDGET.USER.DATA(6)="California"ş        ACT.FACT=.08ş    CASE TYPE.ID="32"ş        W$TYPE="MAP:Nevada"ş        WIDGET.USER.DATA(6)="Nevada"ş        ACT.FACT=.08ş    CASE TYPE.ID="49"ş        W$TYPE="MAP:Utah"ş        WIDGET.USER.DATA(6)="Utah"ş        ACT.FACT=.08ş    CASE 1ş        ACT.FACT=1ş    END CASEş*ş*ş*_____Set Widget Variables_____ş    IF WIDGET.USER.DATA(4)="" THEN WIDGET.USER.DATA(4)="ALL"ş    IF WIDGET.USER.DATA(5)="" THEN WIDGET.USER.DATA(5)="Inquiry"ş*ş*_____Open Files_____ş    OPEN 'Territories' TO F.TERR ELSE ABORT 201,'Territories'ş    OPEN 'SalesSum' TO F.SSUM ELSE ABORT 201,'SalesSum'ş    OPEN 'SalesReps' TO F.SREP ELSE ABORT 201,'SalesReps'ş*ş*_____Set Period_____ş    WYR=OCONV(DATE(),"DY")ş    WMO=OCONV(DATE(),"DM") - 1ş    IF WMO<1 THEN WYR-=1;WMO=12ş    CAL.PERIOD=WYR'R%4':WMO'R%2'ş    IF WIDGET.USER.DATA(3) MATCHES "6N" THENş        END.PERIOD=WIDGET.USER.DATA(3)ş        WYR=END.PERIOD[1,4]ş        WMO=END.PERIOD[5,2]ş    END ELSEş        END.PERIOD=CAL.PERIODş        WIDGET.USER.DATA(3)=END.PERIODş    ENDş    WMO-=5ş    IF WMO<1 THEN WYR-=1; WMO+=12ş    BEG.PERIOD=WYR'R%4':WMO'R%2'ş*ş*_____Set Up Input Prompts_____ş    W$INPUT.PROMPT<1>="Region"ş    W$INPUT.TYPE<1>="SELECT"ş    W$INPUT.SELOPTS<1,1>="SouthWest"ş    W$INPUT.SELVALS<1,1>=""ş    W$INPUT.SELOPTS<1,2>="California"ş    W$INPUT.SELVALS<1,2>="06"ş    W$INPUT.SELOPTS<1,3>="Nevada"ş    W$INPUT.SELVALS<1,3>="32"ş    W$INPUT.SELOPTS<1,4>="Utah"ş    W$INPUT.SELVALS<1,4>="49"ş    W$INPUT.SELOPTS<1,5>="Arizona"ş    W$INPUT.SELVALS<1,5>="04"ş    W$INPUT.UDPOS<1>=1ş    W$INPUT.DEFAULT<1>=WIDGET.USER.DATA(1)ş    W$INPUT.PROMPT<3>="Ending Period"ş    W$INPUT.TYPE<3>="SELECT"ş    WYR=CAL.PERIOD[1,4]-2ş    WMO=CAL.PERIOD[5,2]+1ş    IF WMO>12 THEN WYR+=1; WMO=1ş    SEL.PERIOD=WYR'R%4':WMO'R%2'ş    FOR PERIOD=CAL.PERIOD TO SEL.PERIOD STEP -1ş        WYR=PERIOD[1,4]ş        WMO=PERIOD[5,2]ş        IF WMO<1 THENş            WYR-=1ş            WMO=12ş            PERIOD=WYR'R%4':WMO'R%2'ş        ENDş        WMO=OCONV(WMO*30-15,"DMA")[1,3]ş        WPERIOD=WMO:" ":WYRş        W$INPUT.SELOPTS<3,-1>=WPERIODş        W$INPUT.SELVALS<3,-1>=PERIODş    NEXT PERIODş    W$INPUT.UDPOS<3>=3ş    W$INPUT.DEFAULT<3>=WIDGET.USER.DATA(3)ş    W$INPUT.PROMPT<4>="Sales Rep"ş    W$INPUT.TYPE<4>="SELECT"ş    W$INPUT.SELOPTS<4>="Everyone"ş    W$INPUT.SELVALS<4>="ALL"ş    SELECT F.SREPş    SALESREPS=""ş    LOOPş        READNEXT SREPINIT ELSE SREPINIT="\\EOF"ş    UNTIL SREPINIT="\\EOF" DOş        READ SREPITEM FROM F.SREP,SREPINIT THENş            LOCATE SREPINIT IN SALESREPS<1> BY "AL" SETTING IX ELSEş                SALESREPS=INSERT(SALESREPS,1,IX;SREPINIT)ş                SALESREPS=INSERT(SALESREPS,2,IX;SREPITEM<1>)ş            ENDş        ENDş    REPEATş    SREP.MAX=DCOUNT(SALESREPS<1>,CHAR(253))ş    FOR RVX=1 TO SREP.MAXş        W$INPUT.SELOPTS<4,-1>=SALESREPS<2,RVX>ş        W$INPUT.SELVALS<4,-1>=SALESREPS<1,RVX>ş    NEXT RVXş    W$INPUT.UDPOS<4>=4ş    W$INPUT.DEFAULT<4>=WIDGET.USER.DATA(4)ş    W$INPUT.PROMPT<5>="Demographic"ş    W$INPUT.TYPE<5>="SELECT"ş    W$INPUT.SELOPTS<5,1>="Inquiries"ş    W$INPUT.SELVALS<5,1>="Inquiry"ş    W$INPUT.SELOPTS<5,2>="Demos"ş    W$INPUT.SELVALS<5,2>="Demo"ş    W$INPUT.SELOPTS<5,3>="Quotes"ş    W$INPUT.SELVALS<5,3>="Quote"ş    W$INPUT.SELOPTS<5,4>="Orders"ş    W$INPUT.SELVALS<5,4>="Order"ş    W$INPUT.UDPOS<5>=5ş    W$INPUT.DEFAULT<5>=WIDGET.USER.DATA(5)ş    W$INPUT.BUTTON="Apply"ş*ş*ş    STATES<1,1>="USASouthWestRegion*04"ş    STATES<1,2>="USASouthWestRegion*06"ş    STATES<1,3>="USASouthWestRegion*32"ş    STATES<1,4>="USASouthWestRegion*49"ş    COUNTIES=""ş*ş    W$TITLE = "Data Evolution - ":WIDGET.USER.DATA(5):" Demographics"ş    BEGIN CASEş    CASE WIDGET.USER.DATA(5)="Inquiry"; AX=6 ;ACTIVE=1000*ACT.FACTş    CASE WIDGET.USER.DATA(5)="Demo"   ; AX=7 ;ACTIVE=500*ACT.FACTş    CASE WIDGET.USER.DATA(5)="Quote"  ; AX=8 ;ACTIVE=300*ACT.FACTş    CASE WIDGET.USER.DATA(5)="Order"  ; AX=9 ;ACTIVE=100*ACT.FACTş    END CASEş*ş    TERRITORIES = ""ş    SELECT F.TERRş    LOOPş        READNEXT TERR ELSE TERR="\\EOF"ş    UNTIL TERR="\\EOF" DOş        READ TERRITEM FROM F.TERR,TERR THENş            IF WIDGET.USER.DATA(4)="ALL" OR WIDGET.USER.DATA(4)=TERRITEM<2> THENş                LOCATE TERR IN TERRITORIES<1> BY "AR" SETTING IX ELSEş                    TERRITORIES=INSERT(TERRITORIES,1,IX;TERR)ş                    TERRITORIES=INSERT(TERRITORIES,2,IX;TERRITEM<1>)ş                    TERRITORIES=INSERT(TERRITORIES,3,IX;TERRITEM<2>)ş                    TERRITORIES=INSERT(TERRITORIES,4,IX;TERRITEM<3>)ş                    IF TYPE.ID="" THENş                        MAP.IDS=FIELD(TERRITEM<4,1>,"*",1)[1,2]ş                        BEGIN CASEş                        CASE MAP.IDS="Ar"; MAP.IDS="USASouthWestRegion*04"ş                        CASE MAP.IDS="Ca"; MAP.IDS="USASouthWestRegion*06"ş                        CASE MAP.IDS="Ne"; MAP.IDS="USASouthWestRegion*32"ş                        CASE MAP.IDS="Ut"; MAP.IDS="USASouthWestRegion*49"ş                        END CASEş                        TERRITORIES=INSERT(TERRITORIES,5,IX;MAP.IDS)ş                    END ELSEş                        CMAX=DCOUNT(TERRITEM<4>,CHAR(253))ş                        FOR CX=1 TO CMAXş                            IF WIDGET.USER.DATA(6)=FIELD(TERRITEM<4,CX>,"*",1) THENş                                COUNTIES<1,-1>=TERRITEM<4,CX>ş                            ENDş                        NEXT CXş                    ENDş                ENDş            ENDş        ENDş    REPEATş*ş    TERR.MAX=DCOUNT(TERRITORIES<1>,CHAR(253))ş    IF WIDGET.USER.DATA(4)="ALL" THENş        SNAME="Everyone"ş    END ELSEş        READV SNAME FROM F.SREP,WIDGET.USER.DATA(4),1 ELSEş            SNAME="Unknown"ş        ENDş    ENDş*ş    QTYS=""ş    FOR PERIOD=BEG.PERIOD TO END.PERIODş        WYR=PERIOD[1,4]ş        WMO=PERIOD[5,2]ş        IF WMO>12 THEN PERIOD=(WYR+1)'R%4':"01"ş        FOR TERRX=1 TO TERR.MAXş            TERR=TERRITORIES<1,TERRX>ş            READ SALES FROM F.SSUM,TERR:"*":PERIOD THENş                IF TYPE.ID="" THENş                    Table=TERRITORIES<5,TERRX>ş                    Table<2>=SUM(SALES<AX>)ş                    TBL.MAX=DCOUNT(Table<1>,CHAR(253))ş                    FOR TBLX=1 TO TBL.MAXş                        LOCATE Table<1,TBLX> IN STATES<1> SETTING TX THENş                            QTYS<TX>+=Table<2,TBLX>ş                        ENDş                    NEXT TBLXş                END ELSEş                    Table=SALES<10>ş                    Table<2>=SALES<AX>ş                    TBL.MAX=DCOUNT(Table<1>,CHAR(253))ş                    FOR TBLX=1 TO TBL.MAXş                        LOCATE Table<1,TBLX> IN COUNTIES<1> SETTING TX THENş                            QTYS<TX>+=Table<2,TBLX>ş                        ENDş                    NEXT TBLXş                ENDş            ENDş        NEXT TERRXş    NEXT PERIODş*ş    OPEN 'MVDB.MAP.DATA' TO F.MVDB.MAP.DATA ELSE STOP 201, 'MVDB.MAP.DATA'ş*ş    IF TYPE.ID="" THENş        MAX=DCOUNT(STATES,CHAR(253))ş        FOR X=1 TO MAXş            ID=STATES<1,X>ş            CONVERT '*' TO '#' IN ID    ;*6-1-15*ş            READ I FROM F.MVDB.MAP.DATA,ID THENş*6-1-15*      W$MAP.IDS<1,-1> = FIELD(ID,'*',2)ş                W$MAP.IDS<1,-1> = FIELD(ID,'#',2) ;*6-1-15*ş                W$MAP.VALUES<1,-1> = QTYS<X>+0ş                W$MAP.VALUE.TOOLTEXT<1,-1> := I<2>:' (':(QTYS<X>+0):')'ş                W$MAP.VALUE.DD<1,-1> = 1ş            ENDş        NEXT Xş    END ELSEş        MAX=DCOUNT(COUNTIES,CHAR(253))ş        FOR X=1 TO MAXş            ID=COUNTIES<1,X>ş            CONVERT '*' TO '#' IN ID    ;*6-1-15*ş            READ I FROM F.MVDB.MAP.DATA,ID THENş*6-1-15*      W$MAP.IDS<1,-1> = FIELD(ID,'*',2)ş                W$MAP.IDS<1,-1> = FIELD(ID,'#',2) ;*6-1-15*ş                W$MAP.VALUES<1,-1> = QTYS<X>+0ş                W$MAP.VALUE.TOOLTEXT<1,-1> := I<2>:' (':(QTYS<X>+0):')'ş            ENDş        NEXT Xş    ENDş*ş    W$MAP.RANGE.NAME<1,1> = "No Activity"ş    W$MAP.RANGE.COLOR<1,1> = "#404040"ş    W$MAP.RANGE.NAME<1,2> = "Light Activity"ş    W$MAP.RANGE.COLOR<1,2> = "#4682B4"ş    W$MAP.RANGE.NAME<1,3> = "Moderate Activity"ş    W$MAP.RANGE.COLOR<1,3> = "#FF8C00"ş    W$MAP.RANGE.NAME<1,4> = "Heavy Activity"ş    W$MAP.RANGE.COLOR<1,4> = "#FF0000"ş*ş    W$MAP.RANGE.LOW<1,1> = 0ş    W$MAP.RANGE.HIGH<1,1> = 1ş    W$MAP.RANGE.LOW<1,2> = 1ş    W$MAP.RANGE.HIGH<1,2> = ACTIVEş    W$MAP.RANGE.LOW<1,3> = ACTIVEş    W$MAP.RANGE.HIGH<1,3> = ACTIVE*3ş    W$MAP.RANGE.LOW<1,4> = ACTIVE*3ş    W$MAP.RANGE.HIGH<1,4> = "999999"ş*ş    W$CHART.OPTIONS<-1> = 'animation="0"'ş    W$CHART.OPTIONS<-1> = 'showShadow="1"'ş* 10-17-16 deprecated * W$CHART.OPTIONS<-1> = 'showBevel="1"'ş    W$CHART.OPTIONS<-1> = 'legendShadow="1"'ş    W$CHART.OPTIONS<-1> = 'legendAllowDrag="1"'ş*ş    W$LINK.LABEL<1,1> = "California"ş    W$LINK.UD.VAL<1,1,1> = "06"ş    W$LINK.UD.POS<1,1,1> = "1"ş    W$LINK.UD.VAL<1,1,2> = WIDGET.USER.DATA(2)ş    W$LINK.UD.POS<1,1,2> = "2"ş    W$LINK.UD.VAL<1,1,3> = WIDGET.USER.DATA(3)ş    W$LINK.UD.POS<1,1,3> = "3"ş    W$LINK.UD.VAL<1,1,4> = WIDGET.USER.DATA(4)ş    W$LINK.UD.POS<1,1,4> = "4"ş    W$LINK.UD.VAL<1,1,5> = WIDGET.USER.DATA(5)ş    W$LINK.UD.POS<1,1,5> = "5"ş    W$LINK.UD.VAL<1,1,6> = "California"ş    W$LINK.UD.POS<1,1,6> = "6"ş    W$LINK.LOCATION<1,1> = "2"ş    W$LINK.DD.WIDGET<1,1> = "MV Demo Map"ş*ş    W$LINK.LABEL<1,2> = "Nevada"ş    W$LINK.UD.VAL<1,2,1> = "32"ş    W$LINK.UD.POS<1,2,1> = "1"ş    W$LINK.UD.VAL<1,2,2> = WIDGET.USER.DATA(2)ş    W$LINK.UD.POS<1,2,2> = "2"ş    W$LINK.UD.VAL<1,2,3> = WIDGET.USER.DATA(3)ş    W$LINK.UD.POS<1,2,3> = "3"ş    W$LINK.UD.VAL<1,2,4> = WIDGET.USER.DATA(4)ş    W$LINK.UD.POS<1,2,4> = "4"ş    W$LINK.UD.VAL<1,2,5> = WIDGET.USER.DATA(5)ş    W$LINK.UD.POS<1,2,5> = "5"ş    W$LINK.UD.VAL<1,2,6> = "Nevada"ş    W$LINK.UD.POS<1,2,6> = "6"ş    W$LINK.LOCATION<1,2> = "2"ş    W$LINK.DD.WIDGET<1,2> = "MV Demo Map"ş*ş    W$LINK.LABEL<1,3> = "Utah"ş    W$LINK.UD.VAL<1,3,1> = "49"ş    W$LINK.UD.POS<1,3,1> = "1"ş    W$LINK.UD.VAL<1,3,2> = WIDGET.USER.DATA(2)ş    W$LINK.UD.POS<1,3,2> = "2"ş    W$LINK.UD.VAL<1,3,3> = WIDGET.USER.DATA(3)ş    W$LINK.UD.POS<1,3,3> = "3"ş    W$LINK.UD.VAL<1,3,4> = WIDGET.USER.DATA(4)ş    W$LINK.UD.POS<1,3,4> = "4"ş    W$LINK.UD.VAL<1,3,5> = WIDGET.USER.DATA(5)ş    W$LINK.UD.POS<1,3,5> = "5"ş    W$LINK.UD.VAL<1,3,6> = "Utah"ş    W$LINK.UD.POS<1,3,6> = "6"ş    W$LINK.LOCATION<1,3> = "2"ş    W$LINK.DD.WIDGET<1,3> = "MV Demo Map"ş*ş    W$LINK.LABEL<1,4> = "Arizona"ş    W$LINK.UD.VAL<1,4,1> = "04"ş    W$LINK.UD.POS<1,4,1> = "1"ş    W$LINK.UD.VAL<1,4,2> = WIDGET.USER.DATA(2)ş    W$LINK.UD.POS<1,4,2> = "2"ş    W$LINK.UD.VAL<1,4,3> = WIDGET.USER.DATA(3)ş    W$LINK.UD.POS<1,4,3> = "3"ş    W$LINK.UD.VAL<1,4,4> = WIDGET.USER.DATA(4)ş    W$LINK.UD.POS<1,4,4> = "4"ş    W$LINK.UD.VAL<1,4,5> = WIDGET.USER.DATA(5)ş    W$LINK.UD.POS<1,4,5> = "5"ş    W$LINK.UD.VAL<1,4,6> = "Arizona"ş    W$LINK.UD.POS<1,4,6> = "6"ş    W$LINK.LOCATION<1,4> = "2"ş    W$LINK.DD.WIDGET<1,4> = "MV Demo Map"ş*ş    W$LINK.LABEL<1,5> = "SouthWest Region"ş    W$LINK.UD.VAL<1,5,1> = ""ş    W$LINK.UD.POS<1,5,1> = "1"ş    W$LINK.UD.VAL<1,5,2> = WIDGET.USER.DATA(2)ş    W$LINK.UD.POS<1,5,2> = "2"ş    W$LINK.UD.VAL<1,5,3> = WIDGET.USER.DATA(3)ş    W$LINK.UD.POS<1,5,3> = "3"ş    W$LINK.UD.VAL<1,5,4> = WIDGET.USER.DATA(4)ş    W$LINK.UD.POS<1,5,4> = "4"ş    W$LINK.UD.VAL<1,5,5> = WIDGET.USER.DATA(5)ş    W$LINK.UD.POS<1,5,5> = "5"ş    W$LINK.UD.VAL<1,5,6> = ""ş    W$LINK.UD.POS<1,5,6> = "6"ş    W$LINK.LOCATION<1,5> = "2"ş    W$LINK.DD.WIDGET<1,5> = "MV Demo Map"ş*ş    INCLUDE WBPD SOURCE.VIEW.ICONş*ş    RETURN000365SUB.SOURCE.VIEWş0c2SUBROUTINE SUB.SOURCE.VIEWş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: View BASIC Source Codeş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "TEXT"şW$TITLE = "Source: ":WIDGET.USER.DATA(1):", ":WIDGET.USER.DATA(2)şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şOPEN WIDGET.USER.DATA(1) TO F.FILEVAR THENş  READ REC FROM F.FILEVAR, WIDGET.USER.DATA(2) ELSE REC = '"':WIDGET.USER.DATA(2):'" not on file.'şEND ELSE REC = '"':WIDGET.USER.DATA(1):'" is not a valid file name.'ş*şW$TEXT.DATA = RECş*şW$LINK.ICON<1> = "script_edit.png"şW$LINK.ICON.TXT<1> = "Edit BASIC Source"şW$LINK.URL<1> = "/dbc/MVDB.WEB.ED?ed_file=":WIDGET.USER.DATA(1):"&ed_item=":WIDGET.USER.DATA(2)şW$LINK.URL.OPTS<1> = 'target="ED_':WIDGET.USER.DATA(1):"_":WIDGET.USER.DATA(2):'"'şW$LINK.LOCATION<1> = "C"ş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURNş000405SUB.DEMO.DAYS.TO.PAY.PIEş0c2SUBROUTINE SUB.DEMO.DAYS.TO.PAY.PIEş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "FC2DPIE"şW$WIDTH = 3şW$TITLE = 'Chart - Days To Pay 'ş*şIF G$QUERYMODE THEN RETURNş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEşYEAR=WIDGET.USER.DATA(1)şOPEN '','MVDB.CONTROL' TO FILE.CONTROL ELSE STOPşREAD REC FROM FILE.CONTROL, 'DEMO.FINANCIAL.PICTURE' ELSE REC=''şLOCATE YEAR IN REC<67> SETTING YEAR.POS ELSE YEAR.POS=1şYEAR.POS=4-YEAR.POS;   * NEED TO INVERT TO YYYY, YYYY-1, YYYY-2şDAYS.POS=YEAR.POS+53şW$TITLE:=YEARşDAYS.TYPES='0 - 30 Days,31 - 60 Days,61 - 90 Days,Over 90 Days'şCONVERT ',' TO CHAR(253) IN DAYS.TYPESşPERIOD.PCTS=REC<DAYS.POS>şMAX.DAYS.TYPES=DCOUNT(DAYS.TYPES,CHAR(253))şFOR DAYS.CNTR = 1 TO MAX.DAYS.TYPESş   PCT=PERIOD.PCTS<1,DAYS.CNTR>ş   W$PIE.LABELS<1,DAYS.CNTR>=DAYS.TYPES<1,DAYS.CNTR>ş   W$PIE.VALUES<1,DAYS.CNTR>=PCTş NEXT DAYS.CNTRşW$PIE.CAPTION='Days To Pay By Period For ':YEARş*ş*ş*şRETURN00106BSUB.DEMO.AGAUGEş0c2SUBROUTINE SUB.DEMO.AGAUGEş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Angular Gauge widget demoş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Angular Gauge Chart Demo - Sales Volume"şW$TYPE = "HLINEARGAUGE"şW$WIDTH = 2ş*şIF G$QUERYMODE THEN RETURNş*şIF WIDGET.USER.DATA(1) # "" THENş  W$TYPE = WIDGET.USER.DATA(1)şEND ELSE WIDGET.USER.DATA(1) = "HLINEARGAUGE"şIF WIDGET.USER.DATA(2) = "" THEN WIDGET.USER.DATA(2) = 1şPALETTE = WIDGET.USER.DATA(2)şIF WIDGET.USER.DATA(3) = "" THEN WIDGET.USER.DATA(3) = 725000şCHART.VALUE = WIDGET.USER.DATA(3)şIF WIDGET.USER.DATA(4) = "" THEN WIDGET.USER.DATA(4) = W$WIDTHşW$WIDTH = WIDGET.USER.DATA(4)şIF WIDGET.USER.DATA(5) = "" THEN WIDGET.USER.DATA(5) = 1şNUM.CHARTS = WIDGET.USER.DATA(5);* Number of single-value meter style charts to produceş*şBEGIN CASEş  CASE W$TYPE = "HLINEARGAUGE"ş    W$TITLE = "Linear"ş  CASE W$TYPE = "ANGULARGAUGE"ş    W$TITLE = "Angular"ş  CASE W$TYPE = "HLED"ş    W$TITLE = "Horizontal LED"ş  CASE W$TYPE = "VLED"ş    W$TITLE = "Vertical LED"ş  CASE W$TYPE = "THERMOMETER"ş    W$TITLE = "Thermometer"ş  CASE W$TYPE = "CYLINDER"ş    W$TITLE = "Cylinder"ş  CASE W$TYPE = "BULB"ş    W$TITLE = "Bulb"şEND CASEşW$TITLE := " Gauge Chart Demo - Sales Volume"şW$FW.LOWER.LIMIT = 0şW$FW.UPPER.LIMIT = 800000ş*şW$FW.COLOR.RANGE<1,1> = 0şW$FW.COLOR.RANGE<2,1> = 300000şW$FW.COLOR.RANGE<3,1> = COLOR$REDş*şW$FW.COLOR.RANGE<1,2> = 300000şW$FW.COLOR.RANGE<2,2> = 550000şW$FW.COLOR.RANGE<3,2> = COLOR$YELLOWş*şW$FW.COLOR.RANGE<1,3> = 550000şW$FW.COLOR.RANGE<2,3> = 600000şW$FW.COLOR.RANGE<3,3> = COLOR$GREENş*şW$FW.COLOR.RANGE<1,4> = 600000şW$FW.COLOR.RANGE<2,4> = 800000şW$FW.COLOR.RANGE<3,4> = COLOR$SILVERş*şIF WIDGET.USER.DATA(1) # "HLINEARGAUGE" AND WIDGET.USER.DATA(1) # "ANGULARGAUGE" THENş  * Create multiple values to make an array of chartsş  FOR N = 1 TO NUM.CHARTSş    W$FW.METER.VALUE<1,N> = INT(CHART.VALUE*(N/NUM.CHARTS))ş  NEXT Nş  W$FW.THERMOMETER.COLOR = COLOR$REDşEND ELSEş  W$FW.DIAL.VALUES<1> = CHART.VALUEş  W$FW.TRENDPOINT.VALUES<1,1> = 675000 ;* Low-limit of trendpointş  W$FW.TRENDPOINT.VALUES<2,1> = 685000 ;* High-limit of trendpointş  W$FW.TRENDPOINT.LABELS<1,1> = "Last Year"ş  W$FW.TRENDPOINT.OPTS<1,1> = 'color="':COLOR$GREEN:'" useMarker="1"'ş  *ş  W$FW.TRENDPOINT.VALUES<1,2> = 475000ş  W$FW.TRENDPOINT.LABELS<1,2> = "2 yrs ago"ş  W$FW.TRENDPOINT.OPTS<1,2> = 'color="':COLOR$BLACK:'" useMarker="1"'ş  *şENDş*ş* Set up a drill-down widget callş*şW$FW.DD.WIDGET<1,1> = "Drilldown Demo"şW$FW.DD.UD.POS<1,1,1> = 1şW$FW.DD.UD.VAL<1,1,1> = W$FW.METER.VALUE:W$FW.DIAL.VALUES<1>şW$FW.DD.UD.POS<1,1,2> = 2şW$FW.DD.UD.VAL<1,1,2> = WIDGET.USER.DATA(1)ş*şW$FW.LOWER.LIMIT.LABEL = "Poor"şW$FW.UPPER.LIMIT.LABEL = "Great"ş*şW$FW.NUMBER.PREFIX = "$"şW$FW.NUMBER.SUFFIX = ""ş*şW$FW.CHART.PALETTE = PALETTEş*şW$FW.TICKMARKS<1> = 1 ;* Display tickmarksşW$FW.TICKMARKS<2> = 1 ;* Display values by tickmarksşW$FW.TICKMARKS<3> = "B" ;* Show tickmarks below the graphşW$FW.TICKMARKS<4> = "" ;* Let it calculate thisşW$FW.TICKMARKS<5> = 4 ;* 4 minor tickmarks between the major onesş*şW$INPUT.PROMPT = "Gauge Chart Style"şW$INPUT.TYPE = "SELECT"şW$INPUT.SELOPTS = "Linear":@VM:"Angular":@VM:"Horizontal LED":@VM:"Vertical LED":@VM:"Thermometer":@VM:"Cylinder":@VM:"Bulb"şW$INPUT.SELVALS = "HLINEARGAUGE":@VM:"ANGULARGAUGE":@VM:"HLED":@VM:"VLED":@VM:"THERMOMETER":@VM:"CYLINDER":@VM:"BULB"şW$INPUT.UDPOS = 1şW$INPUT.DEFAULT = WIDGET.USER.DATA(1)ş*şW$INPUT.PROMPT<2> = "Palette"şW$INPUT.TYPE<2> = "SELECT"şW$INPUT.SELOPTS<2> = "1":@VM:"2":@VM:"3":@VM:"4":@VM:"5"şW$INPUT.SELVALS<2> = "1":@VM:"2":@VM:"3":@VM:"4":@VM:"5"şW$INPUT.UDPOS<2> = 2şW$INPUT.DEFAULT<2> = WIDGET.USER.DATA(2)ş*şW$INPUT.PROMPT<3> = "Chart Value"şW$INPUT.TYPE<3> = "TEXT"şW$INPUT.UDPOS<3> = 3şW$INPUT.DEFAULT<3> = CHART.VALUEş*şW$INPUT.PROMPT<4> = "Widget Width"şW$INPUT.TYPE<4> = "SELECT"şW$INPUT.SELOPTS<4> = "1 - Narrow":@VM:"2 - Medium":@VM:"3 - Full Width"şW$INPUT.SELVALS<4> = "1":@VM:"2":@VM:"3"şW$INPUT.UDPOS<4> = 4şW$INPUT.DEFAULT<4> = W$WIDTHş*ş*W$INPUT.PROMPT<5> = "# of Charts"ş*W$INPUT.TYPE<5> = "TEXT"ş*W$INPUT.UDPOS<5> = 5ş*W$INPUT.DEFAULT<5> = NUM.CHARTSş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN0003E1SUB.DEMO.PYRAMIDş0c2SUBROUTINE SUB.DEMO.PYRAMIDş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Pyramid widget demoş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Pyramid Demo - Errors by Reason"şW$TYPE = "PYRAMID"şW$WIDTH = 1ş*şIF G$QUERYMODE THEN RETURNş*şCATEG = ""şCATEG<1> = 19şCATEG<2> = 20şCATEG<3> = 36şCATEG<4> = 44ş*şCATEG.NAMES = ''şCATEG.NAMES<1> = "Shipping"şCATEG.NAMES<2> = "Bad Choices"şCATEG.NAMES<3> = "Errors"şCATEG.NAMES<4> = "Bad Material"ş*şW$FW.CAPTION = "Errors by Reason"şW$FW.SUBCAPTION = "2008 Shipments"şW$CHART.OPTIONS<-1> = "isSliced='1'"ş*şFOR N = 1 TO DCOUNT(CATEG.NAMES,@AM)ş  W$FW.LABELS<1,N> = CATEG.NAMES<N>ş  W$FW.VALUES<1,N> = CATEG<N>ş  *ş  * Set up a drill-down widget call for each categoryş  *ş  W$FW.DD.WIDGET<1,N> = "Drilldown Demo"ş  W$FW.DD.UD.POS<1,N,1> = 1ş  W$FW.DD.UD.VAL<1,N,1> = CATEG.NAMES<N>ş  W$FW.DD.UD.POS<1,N,2> = 2ş  W$FW.DD.UD.VAL<1,N,2> = CATEG<N>şNEXT Nş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN0007E7SUB.SHOW.VARSş0c2SUBROUTINE SUB.SHOW.VARSş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Display global valuesş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "TABLE"şW$TITLE = "Variables"ş*şIF G$QUERYMODE = 1 THEN RETURNş*şW$LINK.LOCATION<1,1> = 2şW$LINK.LOCATION<1,2> = 1ş*şW$LINK.LABEL<1,2> = "Do Nothing"şW$LINK.UD.POS<1,2> = "5"şW$LINK.UD.VAL<1,2> = "XXX"ş*şIF WIDGET.USER.DATA(1) = "1" THENş  W$LINK.LABEL<1,1> = "Show"ş  W$LINK.UD.POS<1,1> = "1"ş  W$LINK.UD.VAL<1,1> = "0"ş  RETURNşENDşW$LINK.LABEL<1,1> = "Hide"şW$LINK.UD.POS<1,1> = "1"şW$LINK.UD.VAL<1,1> = "1"ş*şW$TABLE.COL.LABELS<1,1> = "Variable"şW$TABLE.COL.LABELS<1,2> = "Type"şW$TABLE.COL.LABELS<1,3> = "Value"ş*şW$TABLE.COL.JUST<1,1> = "left"şW$TABLE.COL.JUST<1,2> = "left"şW$TABLE.COL.JUST<1,3> = "left"ş*şTYPE = "GLOBAL"şROW = 0şNAME = "G$USERID" ; VAL = G$USERID ; GOSUB ADDVARşNAME = "G$CURRENT.DB" ; VAL = G$CURRENT.DB ; GOSUB ADDVARşNAME = "G$LOGIN.DATE" ; VAL = G$LOGIN.DATE ; GOSUB ADDVARşNAME = "G$LOGIN.TIME" ; VAL = G$LOGIN.TIME ; GOSUB ADDVARşNAME = "G$WIDGET.NAME" ; VAL = G$WIDGET.NAME ; GOSUB ADDVARşNAME = "G$WIDGET.SUB" ; VAL = G$WIDGET.SUB ; GOSUB ADDVARşNAME = "G$WIDGET.NAME.LIST" ; VAL = G$WIDGET.NAME.LISTşCONVERT @VM TO "," IN VALşGOSUB ADDVARşNAME = "G$WIDGET.SUB.LIST" ; VAL = G$WIDGET.SUB.LISTşCONVERT @VM TO "," IN VALşGOSUB ADDVARşNAME = "G$WIDGET.CALL.TIME" ; VAL = G$WIDGET.CALL.TIMEşCONVERT @VM TO "," IN VALşGOSUB ADDVARşNAME = "G$WIDGET.CALL.DUR" ; VAL = G$WIDGET.CALL.DURşCONVERT @VM TO "," IN VALşGOSUB ADDVARşNAME = "G$LICENSE.COUNT" ; VAL = G$LICENSE.COUNT; GOSUB ADDVARşNAME = "G$EDITION" ; VAL = G$EDITION; GOSUB ADDVARşNAME = "G$SYSTEM.ID" ; VAL = G$SYSTEM.ID; GOSUB ADDVARş*şTYPE = "CGI"şFOR X = 1 TO DCOUNT( CGI$VARS, @AM )ş  NAME = CGI$VARS<X>ş  VAL = CGI$VALS<X>ş  GOSUB ADDVARşNEXT Xş*şW$PRINTABLE = 1ş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURNş*şADDVAR: *ş*şROW += 1şW$TABLE.DATA<ROW,1> = NAMEşW$TABLE.DATA<ROW,2> = TYPEşW$TABLE.DATA<ROW,3> = VALşRETURN000EFFSUB.ICON.GALLERYş0c2SUBROUTINE SUB.ICON.GALLERYş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Icon Galleryş*şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Icon Gallery"şW$TYPE = "HTML"şW$WIDTH = 3şW$PDFABLE = 1ş*şIF G$QUERYMODE THEN RETURN ;* Dont process, just provide title, type & widthş*şOPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSEş  W$TYPE = "TEXT"ş  W$TEXT.DATA = "UNABLE TO OPEN MVDB.CONTROL"ş  RETURNşENDşREAD ICON.LIST FROM F.MVDB.CONTROL, 'ICON.LIST' ELSEş  W$TYPE = "TEXT"ş  W$TEXT.DATA = "UNABLE TO READ ICON.LIST FROM MVDB.CONTROL"ş  RETURNşENDşCONVERT @AM TO @VM IN ICON.LISTş*ş* WIDGET.USER.DATA(1) = User specified search stringş* WIDGET.USER.DATA(2) = Search string used to make filtered list (previous string)ş* WIDGET.USER.DATA(3) = Filtered listş* WIDGET.USER.DATA(4) = Current page #ş*şICNT = DCOUNT( ICON.LIST, @VM )şIF WIDGET.USER.DATA(2) # WIDGET.USER.DATA(1) THENş  NEW.FILTER = 1şEND ELSE NEW.FILTER = 0şPAGENO = WIDGET.USER.DATA(4)şIF NOT(PAGENO MATCHES "1N0N") THEN PAGENO = ""şIF PAGENO = "" THEN PAGENO = 1şIF NEW.FILTER THENş  WIDGET.USER.DATA(2) = WIDGET.USER.DATA(1)ş  SEARCH.STR = WIDGET.USER.DATA(1)ş  SEARCH.STR = OCONV( SEARCH.STR, 'MCU')ş  FILTERED.LIST = ""ş  FOR IX = 1 TO ICNTş    IF INDEX(OCONV(ICON.LIST<1,IX>,'MCU'),SEARCH.STR,1) THENş      FILTERED.LIST<1,-1> = ICON.LIST<1,IX>ş    ENDş  NEXT IXş  WIDGET.USER.DATA(3) = FILTERED.LISTş  WIDGET.USER.DATA(4) = 1 ;* Page 1ş  ICON.LIST = FILTERED.LISTş  ICNT = DCOUNT( ICON.LIST, @VM )ş  WIDGET.USER.DATA(5) = "" ;* Next/Prev action not processed here.ş  WIDGET.USER.DATA(4) = 1 ;* Start on page 1 with a new filterş  PAGENO = 1şEND ELSEş  IF WIDGET.USER.DATA(2) # "" THENş    ICON.LIST = WIDGET.USER.DATA(3)ş    ICNT = DCOUNT( ICON.LIST, @VM) ş  ENDşENDşIF WIDGET.USER.DATA(5) = "NEXT" THENş  PAGENO += 1şEND ELSE IF WIDGET.USER.DATA(5) = "PREV" THENş  PAGENO -= 1ş  IF PAGENO < 1 THEN PAGENO = 1şENDşWIDGET.USER.DATA(5) = ""şWIDGET.USER.DATA(4) = PAGENOşPER.ROW = 7şROWS.PER.PAGE = 10şCALL GET.CGI('generatepdf',IS.PDF)şIF IS.PDF THENş  * If generating a PDF, place all items on a singleş  * page, letting the PDF renderer handle pagination.ş  ROWS.PER.PAGE = (INT((ICNT-1)/PER.PAGE)+1)*PER.PAGEşENDşPER.PAGE = ROWS.PER.PAGE * PER.ROWşMAX.NAME.CHARS = 22şMAX.PAGE = INT( (ICNT-1) / PER.PAGE )+ 1şIF PAGENO > MAX.PAGE THENş  PAGENO = 1ş  WIDGET.USER.DATA(4) = PAGENOşENDşSTART.POS = ((PAGENO-1) * PER.PAGE) ;* This is an offset, not an actual starting positionşIF ICON.LIST = "" THENş  W$HTML.DATA = '<table><tr><td>No Results</td></tr></table>'şEND ELSEş  W$HTML.DATA = '<table><tr><td colspan="':PER.ROW:'">Page ':PAGENO:' of ':MAX.PAGE:'</td></tr><tr>'ş  W$HTML.DATA := ''ş  IX = 1ş  LOOPş    SHOW.NAME = ICON.LIST<1,IX+START.POS>ş    IF LEN(SHOW.NAME) > MAX.NAME.CHARS THENş      SHOW.NAME = SHOW.NAME[1,MAX.NAME.CHARS-3]:"..."ş    ENDş    W$HTML.DATA := '<td align="center" width="115px" style="font-size:10px;"><img title="':ICON.LIST<1,IX+START.POS>:'" class="icon" src="/db/icons/':ICON.LIST<1,IX+START.POS>:'" /><br />':SHOW.NAME:'<br />':IX+START.POS:'</td>'ş  UNTIL IX = (PER.PAGE) OR (IX+START.POS) >= ICNT DOş    IF NOT(MOD(IX,PER.ROW)) THENş      W$HTML.DATA := '</tr><tr>'ş    ENDş    IX += 1ş  REPEATş  W$HTML.DATA := '</tr></table>'şENDş*W$HTML.DATA := '<br />'ş*FOR N = 1 TO 5ş*  W$HTML.DATA := 'WIDGET.USER.DATA(':N:') = ':WIDGET.USER.DATA(N):'<br />'ş*NEXT Nş*şW$INPUT.PROMPT<1> = "Search"şW$INPUT.TYPE<1> = "TEXT"şW$INPUT.DEFAULT<1> = WIDGET.USER.DATA(1)şW$INPUT.UDPOS<1> = 1şW$INPUT.BUTTON = "Search"ş*şIF PAGENO > 1 THENş  W$LINK.LABEL<1,-1> = "Prev Page"ş  W$LINK.LOCATION<1,-1> = 23ş  W$LINK.UD.POS<1,-1> = 5ş  W$LINK.UD.VAL<1,-1> = "PREV"şENDş*şIF PAGENO < MAX.PAGE THENş  W$LINK.LABEL<1,-1> = "Next Page"ş  W$LINK.LOCATION<1,-1> = 14ş  W$LINK.UD.POS<1,-1> = 5ş  W$LINK.UD.VAL<1,-1> = "NEXT"şENDş*şRETURN000436PURGE.NON.PLATFORM.WIDGETSş0c2*ş** 6-22-15 TPARKER ş** Purge all platform specific widgets not for this platformş*ş** run by the post install command processş*şOPEN '','MVDB.CONTROL' TO FILE ELSE STOPşREAD PLATFORM FROM FILE, 'PLATFORM' ELSE PLATFORM=''şIF PLATFORM = '' THEN STOPş*PJS 07-13-15 - comment out this line: IF LEN(PLATFORM) = 2 THEN PLATFORM=PLATFORM:' 'ş*şOPEN '','MVDB.WIDGETS' TO FI.MVDB.WIDGETS ELSE STOPş*şSELECT FI.MVDB.WIDGETSş*şLOOPş   READNEXT ID ELSE ID='DONE'şUNTIL ID = 'DONE' DOş   WIDGET.PLATFORM=FIELD(ID,' ',1)ş   DELETE.IT=0ş   BEGIN CASEş      CASE PLATFORM = WIDGET.PLATFORM; NULLş      CASE WIDGET.PLATFORM = 'D3'; DELETE.IT=1ş      CASE WIDGET.PLATFORM = 'UV'; DELETE.IT=1ş      CASE WIDGET.PLATFORM = 'UD'; DELETE.IT=1ş      CASE WIDGET.PLATFORM = 'QM'; DELETE.IT=1ş      CASE WIDGET.PLATFORM = 'OI'; DELETE.IT=1ş      CASE WIDGET.PLATFORM = 'RL'; DELETE.IT=1ş      CASE WIDGET.PLATFORM = 'JB'; DELETE.IT=1ş      CASE WIDGET.PLATFORM = 'D3'; DELETE.IT=1ş      CASE 1; NULLş   END CASEş   IF DELETE.IT THEN DELETE FI.MVDB.WIDGETS, IDşREPEATşEND000C95SUB.DEMO.SPARKş0c2SUBROUTINE SUB.DEMO.SPARKş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Spark widget demoş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Spark Chart Demo - My Stock Price"şW$TYPE = "SPARKLINE"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şIF WIDGET.USER.DATA(1) # "" THENş  W$TYPE = WIDGET.USER.DATA(1)şEND ELSE WIDGET.USER.DATA(1) = "SPARKLINE"şIF WIDGET.USER.DATA(2) = "" THEN WIDGET.USER.DATA(2) = 1şPALETTE = WIDGET.USER.DATA(2)ş*şVALUES = ""şW$FW.VALUES<1,-1> = "2726"şW$FW.VALUES<1,-1> = "3788"şW$FW.VALUES<1,-1> = "3888"şW$FW.VALUES<1,-1> = "2290"şW$FW.VALUES<1,-1> = "3902"şW$FW.VALUES<1,-1> = "2331"şW$FW.VALUES<1,-1> = "3085"şW$FW.VALUES<1,-1> = "2701"şW$FW.VALUES<1,-1> = "3320"şW$FW.VALUES<1,-1> = "2193"şW$FW.VALUES<1,-1> = "3451"şW$FW.VALUES<1,-1> = "2484"şW$FW.VALUES<1,-1> = "3932"şW$FW.VALUES<1,-1> = "3704"şW$FW.VALUES<1,-1> = "2781"şW$FW.VALUES<1,-1> = "2295"şW$FW.VALUES<1,-1> = "2473"şW$FW.VALUES<1,-1> = "3763"şW$FW.VALUES<1,-1> = "2975"şW$FW.VALUES<1,-1> = "2235"şW$FW.VALUES<1,-1> = "3435"şW$FW.VALUES<1,-1> = "2760"şW$FW.VALUES<1,-1> = "2797"şW$FW.VALUES<1,-1> = "3236"şW$FW.VALUES<1,-1> = "2256"şW$FW.VALUES<1,-1> = "2415"şW$FW.VALUES<1,-1> = "2493"şW$FW.VALUES<1,-1> = "3582"şW$FW.VALUES<1,-1> = "2345"şW$FW.VALUES<1,-1> = "3764"şW$FW.VALUES<1,-1> = "2699"şW$FW.VALUES<1,-1> = "2948"şW$FW.VALUES<1,-1> = "3663"şW$FW.VALUES<1,-1> = "3558"şW$FW.VALUES<1,-1> = "3219"şW$FW.VALUES<1,-1> = "2759"şW$FW.VALUES<1,-1> = "2694"şW$FW.VALUES<1,-1> = "3235"şW$FW.VALUES<1,-1> = "2263"şW$FW.VALUES<1,-1> = "2597"şW$FW.VALUES<1,-1> = "2528"şW$FW.VALUES<1,-1> = "2673"şW$FW.VALUES<1,-1> = "2347"şW$FW.VALUES<1,-1> = "2055"şW$FW.VALUES<1,-1> = "3458"şW$FW.VALUES<1,-1> = "2916"şW$FW.VALUES<1,-1> = "3497"şW$FW.VALUES<1,-1> = "2457"şW$FW.VALUES<1,-1> = "2070"şW$FW.VALUES<1,-1> = "3261"ş*şIF WIDGET.USER.DATA(1) = "SPARKWINLOSS" THENş  VAL.LIST = W$FW.VALUESş  FOR N = 2 TO DCOUNT( W$FW.VALUES<1>, @VM )ş    VAL = INT(W$FW.VALUES<1,N>)ş    IF VAL > INT(VAL.LIST<1,N-1>) THENş      VAL = "W" ;* Winş    END ELSE IF VAL = INT(VAL.LIST<1,N-1>) THENş      VAL = "D" ;* Drawş    END ELSE VAL = "L"ş    W$FW.VALUES<1,N> = VALş  NEXT Nş  W$FW.VALUES<1,1> = "W" ;* First month was a win.şEND ELSEş  FOR N = 1 TO DCOUNT( W$FW.VALUES<1>, @VM )ş    W$FW.VALUES<1,N> = OCONV(W$FW.VALUES<1,N>,"MD2")ş  NEXT NşENDş*ş*ş* Set up a drill-down widget callş*şW$FW.DD.WIDGET<1,1> = "Drilldown Demo"şW$FW.DD.UD.POS<1,1> = 1şW$FW.DD.UD.VAL<1,1> = W$FW.VALUES<1,1>ş*şW$FW.SPARK.TREND.BEG<1,1> = W$FW.VALUES<1,1>şW$FW.SPARK.TREND.END<1,1> = W$FW.VALUES<1,DCOUNT(W$FW.VALUES<1>,@VM)>ş*şW$FW.CAPTION = "Cisco"şW$FW.SUBCAPTION = "12 Months"şW$FW.CHART.PALETTE = PALETTEş*şW$INPUT.PROMPT = "Spark Chart Style"şW$INPUT.TYPE = "SELECT"şW$INPUT.SELOPTS = "Column":@VM:"Line":@VM:"Win/Loss"şW$INPUT.SELVALS = "SPARKCOLUMN":@VM:"SPARKLINE":@VM:"SPARKWINLOSS"şW$INPUT.UDPOS = 1şW$INPUT.DEFAULT = WIDGET.USER.DATA(1)ş*şW$INPUT.PROMPT<2> = "Palette"şW$INPUT.TYPE<2> = "SELECT"şW$INPUT.SELOPTS<2> = "1":@VM:"2":@VM:"3":@VM:"4":@VM:"5"şW$INPUT.SELVALS<2> = "1":@VM:"2":@VM:"3":@VM:"4":@VM:"5"şW$INPUT.UDPOS<2> = 2şW$INPUT.DEFAULT<2> = WIDGET.USER.DATA(2)ş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN0006D0SUB.DEMO.PIEş0c2SUBROUTINE SUB.DEMO.PIEş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: PIE Chart Demonstration widgetş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Chart - Fuel Sales by Type"şW$TYPE = "FC2DPIE"şW$WIDTH = 1ş*şIF G$QUERYMODE THEN RETURNş*şIF WIDGET.USER.DATA(1) = "3D" THENş  W$TYPE = "FC3DPIE"şENDş*şSALES = ""şSALES<1> = "28452536"şSALES<2> = "31208425"şSALES<3> = "30245519"şSALES<4> = "40425111"şSALES<5> = "36515188"şSALES<6> = "39144100"şSALES<7> = "41655215"şSALES<8> = "36615152"şSALES<9> = "43944161"şSALES<10> = "42251594"şSALES<11> = "48833151"şSALES<12> = "50122415"ş*şTOT.SALES = SUM(SALES)şCATEG = ""şCATEG<1> = INT(TOT.SALES*.4)şCATEG<2> = INT(TOT.SALES*.2)şCATEG<3> = INT(TOT.SALES*.3)şCATEG<4> = INT(TOT.SALES*.1)ş*şCATEG.NAMES = ''şCATEG.NAMES<1> = "Regular"şCATEG.NAMES<2> = "Mid-Grade"şCATEG.NAMES<3> = "Premium"şCATEG.NAMES<4> = "Ethanol"ş*şFOR N = 1 TO DCOUNT(CATEG.NAMES,@AM)ş  W$PIE.LABELS<1,N> = CATEG.NAMES<N>ş  W$PIE.VALUES<1,N> = CATEG<N>ş  *ş  * Set up a drill-down widget call for each categoryş  *ş  W$FW.DD.WIDGET<1,N> = "Drilldown Demo"ş  W$FW.DD.UD.POS<1,N,1> = 1ş  W$FW.DD.UD.VAL<1,N,1> = CATEG.NAMES<N>ş  W$FW.DD.UD.POS<1,N,2> = 2ş  W$FW.DD.UD.VAL<1,N,2> = CATEG<N>şNEXT NşIF WIDGET.USER.DATA(1) # "3D" THENş  W$PIE.VALUE.OPTS<1,3> = 'isSliced="1"'şENDş*şIF WIDGET.USER.DATA(1) = "3D" THENş*  W$LINK.LABEL<1> = "2D"ş  W$LINK.ICON.TXT<1> = "2D Chart"ş  W$LINK.UD.VAL<1> = "2D"ş  W$PIE.CAPTION = "3D Chart"şEND ELSEş*  W$LINK.LABEL<1> = "3D"ş  W$LINK.ICON.TXT<1> = "3D Chart"ş  W$LINK.UD.VAL<1> = "3D"ş  W$PIE.CAPTION = "2D Chart"şENDşW$LINK.ICON<1> = "chart_pie.png"şW$LINK.UD.POS<1> = "1"şW$LINK.LOCATION<1> = "C"ş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN00045DSUB.DEMO.FUNNELş0c2SUBROUTINE SUB.DEMO.FUNNELş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Funnel widget demoş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Funnel Demo - Website Conversion Ratio"şW$TYPE = "FUNNEL"şW$WIDTH = 1ş*şIF G$QUERYMODE THEN RETURNş*şCATEG = ""şCATEG<1> = 385634şCATEG<2> = 175631şCATEG<3> = 84564şCATEG<4> = 35654şCATEG<5> = 12342ş*şCATEG.NAMES = ''şCATEG.NAMES<1> = "Website Visits"şCATEG.NAMES<2> = "Downloads"şCATEG.NAMES<3> = "Interested to buy"şCATEG.NAMES<4> = "Contract finalized"şCATEG.NAMES<5> = "Purchased"ş*şW$FW.CAPTION = "Conversion Ratio"şW$FW.SUBCAPTION = "May 2007"şW$CHART.OPTIONS<-1> = "isSliced='1'"şW$CHART.OPTIONS<-1> = "showPercentValues='1'"ş*şFOR N = 1 TO DCOUNT(CATEG.NAMES,@AM)ş  W$FW.LABELS<1,N> = CATEG.NAMES<N>ş  W$FW.VALUES<1,N> = CATEG<N>ş  *ş  * Set up a drill-down widget call for each categoryş  *ş  W$FW.DD.WIDGET<1,N> = "Drilldown Demo"ş  W$FW.DD.UD.POS<1,N,1> = 1ş  W$FW.DD.UD.VAL<1,N,1> = CATEG.NAMES<N>ş  W$FW.DD.UD.POS<1,N,2> = 2ş  W$FW.DD.UD.VAL<1,N,2> = CATEG<N>şNEXT Nş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN0005B8SUB.PORTAL.AP.REPORTSş0c2SUBROUTINE SUB.PORTAL.AP.REPORTSş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = 'AP Reporting'şW$TYPE = "FC2DPIE"şW$WIDTH = 2ş*şIF G$QUERYMODE THEN RETURNş*şOPEN 'DICT','DASHBOARD.BALANCES' TO FI.DICT.DASHBOARD.BALANCES ELSEş   W$TYPE='TEXT'ş   W$TEXT='UNABLE TO OPEN DICT DASHBOARD.BALANCES'ş   RETURNş ENDşREAD AP.AMOUNTS FROM FI.DICT.DASHBOARD.BALANCES, '*CURRENT.AP.STATS' ELSE AP.AMOUNTS=''şBEGIN CASEş   CASE 1ş      W$TITLE = "Chart - AP Balances by Days Due"; CALL PORTAL.SHOW.LAST.UPDATED('AP')ş      AMTS=AP.AMOUNTSş      W$PIE.CAPTION='Total AP Balance of 'ş**   CASE WIDGET.USER.DATA(1) = 'AR'ş**      W$TITLE = "Chart - AR Balances by Days Due"ş**      AMTS=AR.AMOUNTSş**      W$PIE.CARTION='Total AR Balance of 'şEND CASEş*şTOT.AMT=SUM(AMTS)şW$PIE.CAPTION:=OCONV(TOT.AMT,'MD02,$')ş*şCATEGORIES='Current'şCATEGORIES<2>='1 - 30 Days'şCATEGORIES<3>='31 - 60 Days'şCATEGORIES<4>='61 - 90 Days'şCATEGORIES<5>='Over 90 Days'ş*şCATEGORY.AMTS=AMTSş*ş*şW$CHART.OPTIONS<-1>='showValues="1"'şW$CHART.OPTIONS<-1>='showPercentageValues="0"'şW$CHART.OPTIONS<-1>='showPercentageInLabel="1"'şW$CHART.OPTIONS<-1>='formatNumber="1"'şW$CHART.OPTIONS<-1>='formatNumberScale="0"'şW$CHART.OPTIONS<-1>='decimalPrecision="0"'şW$CHART.OPTIONS<-1>='thousandSeparator=","'şW$CHART.OPTIONS<-1>='pieradius="150"'şFOR N = 1 TO 5ş  W$PIE.LABELS<1,N> = CATEGORIES<N>ş  W$PIE.VALUES<1,N> = INT(CATEGORY.AMTS<N>/100 + .5)şNEXT Nş*ş*şRETURNşEND000101WEB.FORMSş0c2SUBROUTINE WEB.FORMSş*ş* Dashboard Widgetş*şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Untitled HTML"şW$TYPE = "HTML"şW$WIDTH = 3 ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*şW$HTML.DATA = '<h2>HTML Widget Content</h2>'şRETURN000278CHECK.PASSWORDş0c2* 07-17-15 PETER SCHELLENBACH OF ZUMASYS - MODIFIED FOR UVş*          CHANGE OCONV(X,'U3060') TO DIGEST('MD5'...)ş*ş*#MAKE# RL $OPTIONS D3şOPEN 'MVDB.USERS' TO FILE ELSE STOPşSELECT FILEşLOOPş   READNEXT ID ELSE ID ='DONE'şUNTIL ID = 'DONE' DOş   READ REC FROM FILE, ID ELSE REC=''ş   IF DIGEST('MD5',REC<1>,1,ENCR.REC) = 0 THENş     ENCR.REC = OCONV(ENCR.REC,'MX0C')ş   END ELSEş     ENCR.REC = 'MD5 digest failed for ':REC<1>ş   ENDş   IF DIGEST('MD5',ID,1,ENCR.ID) = 0 THENş     ENCR.ID = OCONV(ENCRD.ID,'MX0C')ş   END ELSEş     ENCR.ID = 'MD5 digest failed for ':IDş   ENDş   CRT ID,ENCR.REC,ENCR.IDşREPEATşEND0010F6SUB.DEMO.REV.GP.SALES.CHARTş0c2SUBROUTINE SUB.DEMO.REV.GP.SALES.CHARTş*ş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "FCCOLUMN3D"şW$WIDTH = 2şW$PDFABLE = 1ş*şIF G$QUERYMODE THEN RETURNş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEşEQU ANNUAL.OR.MONTHLY TO WIDGET.USER.DATA(2)şIF ANNUAL.OR.MONTHLY = '' THEN ANNUAL.OR.MONTHLY='By Year'şW$CHART.OPTIONS<-1>='decimals="2"'şW$CHART.OPTIONS<-1>='DecimalPrecision="2"'şW$CHART.OPTIONS<-1>='divLineDecimalPrecision="2"'şW$CHART.OPTIONS<-1>='limitsDecimalPrecision="2"'şW$CHART.OPTIONS<-1>='formatNumberScale="1"'şOPEN '','MVDB.CONTROL' TO FILE.CONTROL ELSE STOPşREAD REC FROM FILE.CONTROL, 'DEMO.FINANCIAL.PICTURE' ELSE REC=''şYEARS=REC<67>şMAX.YEARS=DCOUNT(YEARS,CHAR(253))şREVENUE.OR.GP=WIDGET.USER.DATA(1)şIF INDEX(ANNUAL.OR.MONTHLY,'By Month',1) THEN GOTO DO.MONTHLYş*şBEGIN CASEş   CASE REVENUE.OR.GP = 'REVENUES'ş      W$TITLE='YTD Sales'ş      W$BAR.YMEMO = "YTD Sales"ş      SALES.AMTS=REC<68>ş   CASE REVENUE.OR.GP = 'GROSSPROFIT'ş      W$TITLE='YTD Gross Profit'ş      W$BAR.YMEMO = "YTD Gross Profit"ş      SALES.AMTS=REC<69>ş   CASE 1ş      REC = ''ş      SALES.AMTS = ''şEND CASEş*ş*ş*şMAX.SALES.AMT=0şN=0şFIRST.YEAR=''şCURRENT.YEAR=''şMO.NO=DCOUNT(REC<68,3>,CHAR(252))şFOR NN = 1 TO MAX.YEARSş   SALES.AMT=0ş   FOR NNN = 1 TO MO.NOş      SALES.AMT+=SALES.AMTS<1,NN,NNN>ş    NEXT NNNş   SALES.AMT=OCONV(SALES.AMT,'MD02')ş  IF SALES.AMT THENş     N+=1ş     IF SALES.AMT > MAX.SALES.AMT THEN MAX.SALES.AMT=SALES.AMTş     W$BAR.VALUES<1,N> = SALES.AMTş     YEAR=YEARS<1,NN>ş     IF NOT(FIRST.YEAR) THEN FIRST.YEAR=YEARş     CURRENT.YEAR=YEARş     W$BAR.XLABELS<1,N> = YEARş     W$FW.DD.WIDGET<1,N> = "DEMO ANNUAL SALES BY REP"ş     W$FW.DD.UD.POS<1,N,1> = 1ş     W$FW.DD.UD.VAL<1,N,1> = REVENUE.OR.GP; * REVENUE OR GPş     W$FW.DD.UD.POS<1,N,2> = 2ş     W$FW.DD.UD.VAL<1,N,2> = YEARş   ENDşNEXT NNşW$BAR.XMEMO = "Year (drilldown for ":W$BAR.YMEMO:" by Rep)"şW$BAR.CAPTION=W$BAR.YMEMO:' From ':FIRST.YEAR:' to ':CURRENT.YEARş* ROUND MAX AMOUNT UP TO THE NEXT 250000şMAX.SALES.AMT+=250000şMAX.SALES.AMT=INT(MAX.SALES.AMT/250000) * 250000şW$CHART.OPTIONS<-1>='yAxisMaxValue="':MAX.SALES.AMT:'"'ş*W$CHART.OPTIONS<-1>='yAxisMaxValue="1500000"'ş*şDO.PROMPT:ş*şW$INPUT.PROMPT<1> = "Display By"şW$INPUT.TYPE<1> = "SELECT"şW$INPUT.UDPOS<1> = 2şOPTIONS='By Year':CHAR(253):'By Month Using Column Chart':CHAR(253):'By Month Using Line Chart'şW$INPUT.SELOPTS<1>=OPTIONSşW$INPUT.SELVALS<1>=OPTIONSşLOCATE ANNUAL.OR.MONTHLY IN OPTIONS<1> SETTING DEFAULT.POS ELSE DEFAULT.POS=1şW$INPUT.DEFAULT<1>=ANNUAL.OR.MONTHLYşW$INPUT.BUTTON<1> = "GO"ş*şRETURNş*şDO.MONTHLY:ş*şIF INDEX(ANNUAL.OR.MONTHLY,'Column',1) THENş   W$TYPE='FCMSCOLUMN2D'ş END ELSEş   W$TYPE='FCMSLINE'ş ENDşW$WIDTH = 3şW$CHART.OPTIONS<-1>='showValues="0"'şBEGIN CASEş   CASE REVENUE.OR.GP = 'REVENUES'ş      W$TITLE='Monthly Sales'ş      W$BAR.YMEMO = "Monthly Sales"ş      W$BAR.CAPTION='Monthly Sales by Year'ş      SALES.ATT=68ş   CASE REVENUE.OR.GP = 'GROSSPROFIT'ş      W$TITLE='Monthly Gross Profit'ş      W$BAR.YMEMO = "Monthly Gross Profit"ş      W$BAR.CAPTION='Monthly Gross Profit by Year'ş      SALES.ATT=69ş   CASE 1ş      SALES.ATT=68ş      REC=''şEND CASEşTODAY=OCONV(DATE(),'D4-')şMM=TODAY[1,2]+0şYYYY=TODAY[7,4]şIF MM = 1 THEN YYYY=YYYY-1şYYYY.SELECT=''şYEARS=''şW$BAR.VALUES=''şFOR N = 1 TO 12ş  W$BAR.XLABELS<1,N> = OCONV(N*30-15,'DMA')[1,3]şNEXT NşIF MAX.YEARS > 5 THEN MAX.DISPLAY.YEARS=5 ELSE MAX.DISPLAY.YEARS=MAX.YEARSşMS.VAL.CNTR=0şFOR I = 1 TO MAX.DISPLAY.YEARSş   YEAR=YYYY-MAX.DISPLAY.YEARS+Iş   YEARS<-1>=YEARş   W$BAR.LABELS<I>=YEARş   YYYY.SELECT:=' "':YEAR:'"'ş   SALES.AMTS=REC<SALES.ATT>ş   FOR MO.NO = 1 TO 12ş      MS.VAL.CNTR+=1ş      SALE.AMT=SALES.AMTS<1,I,MO.NO>ş      W$BAR.VALUES<I,MO.NO>=OCONV(SALE.AMT,'MD02')ş      W$FW.DD.WIDGET<1,MS.VAL.CNTR> = "DEMO SINGLE MONTH SALES BY REP"ş      W$FW.DD.UD.POS<1,MS.VAL.CNTR,1>=1ş      W$FW.DD.UD.VAL<1,MS.VAL.CNTR,1>=REVENUE.OR.GPş      W$FW.DD.UD.POS<1,MS.VAL.CNTR,2>=2ş      W$FW.DD.UD.VAL<1,MS.VAL.CNTR,2> = 'MS.SERIES'ş      W$FW.DD.UD.POS<1,MS.VAL.CNTR,3> = 3ş      W$FW.DD.UD.VAL<1,MS.VAL.CNTR,3>='MS.LABEL'ş    NEXT MO.NOş NEXT Iş**WRITE W$BAR.VALUES ON FILE.CONTROL, 'BAR.VALUES'şW$BAR.XMEMO='Month (drilldown for month by Rep)'şGOSUB DO.PROMPTşRETURNşEND000509SUB.RSS.FEEDSş0c2SUBROUTINE SUB.RSS.FEEDSş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Display a list of available RSS feedsş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEşINCLUDE WBPD WWW.INCLUDEş*şW$TITLE = "RSS Feeds"şW$TYPE = "TABLE"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şOPEN '','RSS.FEEDS' TO F.RSS.FEEDS ELSEş  W$TYPE = "TEXT"ş  W$TEXT.DATA = "Cannot open RSS.FEEDS"ş  RETURNşENDşOPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSEş  W$TYPE = "TEXT"ş  W$TEXT.DATA = "Cannot open MVDB.CONTROL"ş  RETURNşENDş*şW$TABLE.COL.LABELS<1,1> = "ID"şW$TABLE.COL.LABELS<1,2> = "Name / Description"şW$TABLE.COL.LABELS<1,3> = "Subscribe"ş*şEXECUTE "SSELECT RSS.FEEDS BY NAME" CAPTURING JUNKşROW = 1şLOOPş  READNEXT FID ELSE EXITş  READ FEED.REC FROM F.RSS.FEEDS, FID ELSE CONTINUEş  FEED.NAME = FEED.REC<1>ş  CALL RSS.XML.ENCODE(FEED.NAME,"")ş  FEED.DESC = FEED.REC<3>ş  FEED.URL = "http://":CGI$SERVER.NAME:CGI$PATH:'/RSS.MAIN?feed=':FIDş  W$TABLE.DATA<ROW,1> = FIDş  W$TABLE.DATA<ROW,2> = '<b>':FEED.NAME:'</b><br />':FEED.DESCş  W$TABLE.DATA<ROW,3> = \<a href="\:FEED.URL:\">Standard Feed</a>\ş  FOR N = 1 TO DCOUNT( FEED.REC<6>, @VM )ş    W$TABLE.DATA<ROW,3> := '<br /><a href="':FEED.URL:'&':FEED.REC<7,N>:'">':FEED.REC<6,N>:'</a>'ş  NEXT Nş  ROW += 1şREPEATşRETURN00008BCALL.CREATE.WEBSERVICE.PASSWORDş0c2CALL CREATE.WEBSERVICE.PASSWORD(PASSWORD,PASSTIME)şCRT 'PASSTIME=':PASSTIMEşCRT 'PASSWORD=':PASSWORDşEND000988SUB.CODE.TEMPLATESş0c2SUBROUTINE SUB.CODE.TEMPLATESş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: ş* Description: List code templatesş*şINCLUDE WBPD MVDB.INCLUDEşINCLUDE WBPD FI.MVDB.WIDGET.TYPESş*şW$TITLE = "Widget code templates"şW$TYPE = "HTML"şW$WIDTH = 3şW$PRINTABLE = 1ş*şIF G$QUERYMODE THEN RETURNş*şIF WIDGET.USER.DATA(1) # "" THEN ;* Hidden modeş  W$LINK.LABEL<1,1> = "Show Widget"ş  W$LINK.LOCATION<1,1> = "C"ş  W$LINK.UD.POS<1,1> = 1ş  W$LINK.UD.VAL<1,1> = ""ş  W$LINK.ICON<1,1> = "application_view_detail.png"ş  W$LINK.ICON.TXT<1,1> = "Show Widget"ş  W$TITLE := ' (Hidden)'ş  W$PRINTABLE = 0ş  RETURNşENDşOPEN '','MVDB.SUB.TEMPLATES' TO F.MVDB.SUB.TEMPLATES ELSEş  W$HTML.DATA = '<h2>MVDB.SUB.TEMPLATES file cannot be opened.</h2>'ş  RETURNşENDşOPEN '','MVDB.WIDGET.TYPES' TO F.MVDB.WIDGET.TYPES ELSEş  W$HTML.DATA = '<h2>MVDB.WIDGET.TYPES file cannot be opened.</h2>'ş  RETURNşENDş*şEXECUTE 'SSELECT MVDB.WIDGET.TYPES BY GROUP BY HANDLER WITH INACTIVE # "1"' CAPTURING JUNKşW$HTML.DATA = '<table width="100%"><thead><tr><th>Widget Type/Template</th><th>Description</th><th>Lines</th><th>Use Template</th><th>Edit</th></tr><tbody>'şLOOPş  READNEXT ID ELSE EXITş  READ TREC FROM F.MVDB.SUB.TEMPLATES, ID ELSE TREC = ""ş  MATREAD WIDGET.TYPES FROM F.MVDB.WIDGET.TYPES, ID ELSE MAT WIDGET.TYPES = ""ş  CLASS.NAME = FIELD(WT$ICON,'.',1)ş  CONVERT "_" TO "-" IN CLASS.NAMEş  W$HTML.DATA := '<tr><td>':ID:'</td>'ş  W$HTML.DATA := '<td><img height="20" width="20" src="/db/icons/':WT$ICON:'" />':WT$DESC:'</td>'ş  LINES = DCOUNT(TREC,@AM)ş  IF LINES = 0 THEN LINES = '&nbsp;'ş  W$HTML.DATA := '<td align="right">':LINES:'</td>'ş  IF FIELD(TREC,' ',1) = "USE" THENş    USE.TEMPLATE = FIELD( TREC, ' ', 2 )ş    USE.TEMPLATE = '<a href="/dbc/MVDB.WEB.ED?ed_file=MVDB.SUB.TEMPLATES&ed_item=':USE.TEMPLATE:'" target="MVDB.SUB.TEMPLATES_':USE.TEMPLATE:'">':USE.TEMPLATE:'</a>'ş  END ELSE USE.TEMPLATE = '&nbsp;'ş  W$HTML.DATA := '<td>':USE.TEMPLATE:'</td>'ş  IF TREC = "" THEN ACTION = "Add" ELSE ACTION = "Edit"ş  W$HTML.DATA := '<td><a href="/dbc/MVDB.WEB.ED?ed_file=MVDB.SUB.TEMPLATES&ed_item=':ID:'" target="MVDB.SUB.TEMPLATES_':ID:'">':ACTION:'</a></td>'ş  W$HTML.DATA := '</tr>'şREPEATşW$HTML.DATA := '</tbody></table>'ş*şW$LINK.LABEL<1,1> = "Hide Widget"şW$LINK.LOCATION<1,1> = "C"şW$LINK.UD.POS<1,1> = 1şW$LINK.UD.VAL<1,1> = "1"şW$LINK.ICON<1,1> = "application.png"şW$LINK.ICON.TXT<1,1> = "Hide Widget"ş*şRETURN000D3BSUB.PORTAL.MARGINSş0c2SUBROUTINE SUB.PORTAL.MARGINSş*ş* DEFINE PARAMETERS FOR PORTAL SALES REPORTş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEşOPEN '','MVDB.SUBS' TO FI.MVDB.SUBS ELSE STOPşDIM SETUP.PARAMS(25)ş*şW$TITLE = "Portal Year to Year Margins"; CALL PORTAL.SHOW.LAST.UPDATED('SALES')şW$TYPE = "HTML"şW$WIDTH = 2şD3=1ş*şIF G$QUERYMODE THEN RETURNş*ş*şOPEN '','MVDB.CONTROL' TO FI.MVDB.CONTROL ELSE ş   ERROR.MSG='UNABLE TO OPEN MVDB.CONTROL'ş   GOTO DISPLAY.ERRORş ENDşOPEN '','DASHBOARD.CLOSING.STATS' TO FI.DASHBOARD.CLOSING.STATS ELSE ş   ERROR.MSG='UNABLE TO OPEN DASHBOARD.CLOSING.STATS'ş   GOTO DISPLAY.ERRORş ENDşOPEN 'DICT','DASHBOARD.CLOSING.STATS' TO FI.DICT.DASHBOARD.CLOSING.STATS ELSE ş   ERROR.MSG='UNABLE TO OPEN DICT DASHBOARD.CLOSING.STATS'ş   GOTO DISPLAY.ERRORş ENDş*şREAD PLATFORM FROM FI.MVDB.CONTROL, 'PLATFORM' ELSE PLATFORM='D3'şBEGIN CASEş   CASE PLATFORM = 'UD'ş      EXECUTE.STACKED.CMNDS='UD.EXECUTE.STACKED.CMNDS'ş   CASE PLATFORM = 'UV'ş      EXECUTE.STACKED.CMNDS='UV.EXECUTE.STACKED.CMNDS'ş   CASE PLATFORM = 'QM'ş      EXECUTE.STACKED.CMNDS='EXECUTE.STACKED.CMNDS'ş   CASE 1ş      * D3 AND JBASE ARE THE SAMEş      EXECUTE.STACKED.CMNDS='EXECUTE.STACKED.CMNDS'şEND CASEş*ş*şW$CHART.OPTIONS<-1>='decimals="2"'şW$CHART.OPTIONS<-1>='DecimalPrecision="2"'şW$CHART.OPTIONS<-1>='divLineDecimalPrecision="2"'şW$CHART.OPTIONS<-1>='limitsDecimalPrecision="2"'şW$CHART.OPTIONS<-1>='formatNumberScale="1"'ş*şOTODAY=OCONV(DATE(),'D4-')ş*şYEAR.TO.YEAR.MARGIN.PERCENTS:ş*şW$TYPE='FCCOLUMN3D'şTHIS.YEAR=OCONV(DATE(),'D4-')[7,4]şFIRST.YEAR=THIS.YEAR-4şSTACKED.1='SELECT DASHBOARD.CLOSING.STATS WITH YYYY GE "':FIRST.YEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY YYYY BREAK-ON YYYY PIPE TOTAL AMOUNT PIPE TOTAL GROSS.PROFIT ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)ş**WRITE DATE.SELECT.STRING ON FI.MVDB.SUBS, 'DATE.SELECT.STRING'şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE ':FIRST.YEARş   GOSUB DISPLAY.ERRORş   RETURNş ENDş**WRITE REPORT ON FI.MVDB.SUBS, 'YEAR.TO.YEAR.REPORT'şYEAR.TOTALS=''şYEAR.GROSS.PROFITS=''şYEARS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şYEAR.CNTR=0şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      YEAR=TRIM(FIELD(ROW,'|',1))ş      AMOUNT=TRIM(FIELD(ROW,'|',2))ş      GROSS.PROFIT=TRIM(FIELD(ROW,'|',3))ş      IF NUM(AMOUNT) AND NUM(GROSS.PROFIT) THENş         IF AMOUNT OR GROSS.PROFIT THENş            YEAR.CNTR+=1ş            YEARS<YEAR.CNTR>=YEARş            AMOUNT=ICONV(AMOUNT,'MD2')ş            GROSS.PROFIT=ICONV(GROSS.PROFIT,'MD2')ş            YEAR.TOTALS<YEAR.CNTR>=AMOUNTş            YEAR.GROSS.PROFITS<YEAR.CNTR>=GROSS.PROFITş          ENDş       ENDş    ENDşNEXT ROW.NOşYEAR.TOTALS<YEAR.CNTR+1>=SUM(YEAR.TOTALS)şYEAR.GROSS.PROFITS<YEAR.CNTR+1>=SUM(YEAR.GROSS.PROFITS)şYEARS<YEAR.CNTR+1>='Average'ş*şW$BAR.CAPTION = 'Year by Year Margin Percents'şW$BAR.XMEMO = "Year"şW$BAR.YMEMO = 'Margin Percents'ş*şMAX.YEARS=DCOUNT(YEARS,CHAR(254))şFOR YEAR.NO = 1 TO MAX.YEARSş   YEAR.TOTAL=YEAR.TOTALS<YEAR.NO>ş   YEAR.GROSS.PROFIT=YEAR.GROSS.PROFITS<YEAR.NO>ş   MARGIN=INT(YEAR.GROSS.PROFIT * 1000 / YEAR.TOTAL + .5)ş   W$BAR.VALUES<1,YEAR.NO>=OCONV(MARGIN+0,'MD1')ş   W$BAR.XLABELS<1,YEAR.NO>=YEARS<YEAR.NO>ş NEXT YEAR.NOşRETURNş*şDISPLAY.ERROR:ş*şW$HTML.DATA='<h3>':ERROR.MSG:'</h3>'şRETURNş*ş*şRETURNşEND0005ACREFRESH.PORTAL.DATESş0c2OPEN 'DICT','DASHBOARD.CLOSING.STATS' TO DICT.FI ELSE STOP 201,'DICT DASHBOARD.CLOSING.STATS'şREAD LAST.AR.DATE FROM DICT.FI, 'LAST.AR.REFRESH' ELSE STOP 201,'LAST.AR.REFRESH'şREAD LAST.AP.DATE FROM DICT.FI, 'LAST.AP.REFRESH' ELSE STOP 201,'LAST.AP.REFRESH'şREAD LAST.SALES.DATE FROM DICT.FI, 'LAST.SALES.REFRESH' ELSE STOP 201,'LAST.SALES.REFRESH'ş*şFI='PORTAL.AR'; LAST.DATE=LAST.AR.DATE<1>; ATTS=20:@AM:8; GOSUB UPDATE.DATESşWRITE DATE():@AM:OCONV(DATE(),'D2-') ON DICT.FI, 'LAST.AR.REFRESH'şFI='PORTAL.AP'; LAST.DATE=LAST.AP.DATE<1>; ATTS=20:@AM:8; GOSUB UPDATE.DATESşWRITE DATE():@AM:OCONV(DATE(),'D2-') ON DICT.FI, 'LAST.AP.REFRESH'şFI='PORTAL.SALES'; LAST.DATE=LAST.SALES.DATE<1>; ATTS=1; GOSUB UPDATE.DATESşWRITE DATE():@AM:OCONV(DATE(),'D2-') ON DICT.FI, 'LAST.SALES.REFRESH'şSTOPş*şUPDATE.DATES:ş*şMAX.ATTS=DCOUNT(ATTS,@AM)şDIFF.DAYS=DATE()-LAST.DATEşOPEN '',FI TO FI.FI ELSE STOP 201,FIşEXECUTE "SELECT ":FIşLOOPş   READNEXT ID ELSE ID = 'DONE'şUNTIL ID = 'DONE' DOş   READ REC FROM FI.FI, ID ELSE REC=''ş   FOR I = 1 TO MAX.ATTSş      ATT.NO=ATTS<I>ş      IF ATT.NO <> '' THENş         DATES=REC<ATT.NO>ş         MAX.DATES=DCOUNT(DATES,@VM)ş         FOR II = 1 TO MAX.DATESş            THIS.DATE=DATES<1,II>ş            IF THIS.DATE <> '' THENş               THIS.DATE+=DIFF.DAYSş               REC<ATT.NO,II>=THIS.DATEş             ENDş          NEXT IIş       ENDş    NEXT Iş   WRITE REC ON FI.FI, IDşREPEATşRETURN00013DSUB.LISTPEQSş0c2SUBROUTINE SUB.LISTPEQSş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş*şINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "HTML"şW$TITLE = "Print Queue"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şW$TEXT.DATA = '<iframe src="/dbc/SBBP.SB.LISTPEQS" width="100%" scrolling="auto" height="500"></iframe>'şRETURN000812SUB.DEMO.BULLETş0c2SUBROUTINE SUB.DEMO.BULLETş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Bullet widget demoş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Bullet Chart Demo - Sales Volume"şW$TYPE = "VBULLET"şW$WIDTH = 2ş*şIF G$QUERYMODE THEN RETURNş*şIF WIDGET.USER.DATA(1) # "" THENş  W$TYPE = WIDGET.USER.DATA(1)şEND ELSE WIDGET.USER.DATA(1) = "VBULLET"şIF WIDGET.USER.DATA(2) = "" THEN WIDGET.USER.DATA(2) = 1şPALETTE = WIDGET.USER.DATA(2)ş*şW$FW.LOWER.LIMIT = 0şW$FW.UPPER.LIMIT = 800000ş*şW$FW.COLOR.RANGE<1,1> = 0şW$FW.COLOR.RANGE<2,1> = 400000şW$FW.COLOR.RANGE<3,1> = COLOR$REDş*şW$FW.COLOR.RANGE<1,2> = 400000şW$FW.COLOR.RANGE<2,2> = 650000şW$FW.COLOR.RANGE<3,2> = "YELLOW"ş*şW$FW.COLOR.RANGE<1,3> = 650000şW$FW.COLOR.RANGE<2,3> = 800000şW$FW.COLOR.RANGE<3,3> = "GREEN"ş*şW$FW.METER.VALUE = 725000şW$FW.METER.TARGET = 775000ş*şW$FW.CAPTION = "July Sales"şW$FW.SUBCAPTION = "Billings"ş*W$FW.CHART.PALETTE = PALETTEş*şW$FW.NUMBER.PREFIX = "$"şW$FW.NUMBER.SUFFIX = ""ş*şW$FW.TICKMARKS<1> = 1 ;* Display tickmarksşW$FW.TICKMARKS<2> = 1 ;* Display values by tickmarksşW$FW.TICKMARKS<3> = "B" ;* Show tickmarks below the graphşW$FW.TICKMARKS<4> = "" ;* Let it calculate thisşW$FW.TICKMARKS<5> = 4 ;* 4 minor tickmarks between the major onesş*ş*W$CHART.OPTIONS = "paletteThemeColor='#a2287a'"ş*şW$FW.BC.PLOT.COLOR = COLOR$BLUEşW$FW.BC.TARGET.COLOR = COLOR$WHITEş*şW$FW.DD.WIDGET<1,1> = "Drilldown Demo"şW$FW.DD.UD.POS<1,1,1> = 1şW$FW.DD.UD.VAL<1,1,1> = W$FW.METER.VALUEşW$FW.DD.UD.POS<1,1,2> = 2şW$FW.DD.UD.VAL<1,1,2> = WIDGET.USER.DATA(1)ş*şW$INPUT.PROMPT = "Bullet Chart Style"şW$INPUT.TYPE = "SELECT"şW$INPUT.SELOPTS = "Horizontal":@VM:"Vertical"şW$INPUT.SELVALS = "HBULLET":@VM:"VBULLET"şW$INPUT.UDPOS = 1şW$INPUT.DEFAULT = WIDGET.USER.DATA(1)ş*şW$INPUT.PROMPT<2> = "Palette"şW$INPUT.TYPE<2> = "SELECT"şW$INPUT.SELOPTS<2> = "1":@VM:"2":@VM:"3":@VM:"4":@VM:"5"şW$INPUT.SELVALS<2> = "1":@VM:"2":@VM:"3":@VM:"4":@VM:"5"şW$INPUT.UDPOS<2> = 2şW$INPUT.DEFAULT<2> = WIDGET.USER.DATA(2)ş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN003487SUB.PORTAL.AP.REPORT.SETUPş0c2SUBROUTINE SUB.PORTAL.AP.REPORT.SETUPş*ş* DEFINE PARAMETERS FOR PORTAL AP REPORTş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEşOPEN '','MVDB.SUBS' TO FI.MVDB.SUBS ELSE STOPş*şW$TITLE = "Portal AP Report Setup"şW$TYPE = "HTML"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şEQUATE ACCOUNT TO WIDGET.USER.DATA(1)şEQUATE REPORT.FILE TO WIDGET.USER.DATA(2)şEQUATE DUE.DATE.DICT TO WIDGET.USER.DATA(3)şEQUATE DATE.PAID.DICT TO WIDGET.USER.DATA(4)şEQUATE INVOICE.AMT.DICT TO WIDGET.USER.DATA(5)şEQUATE BALANCE.DICT TO WIDGET.USER.DATA(6)şEQUATE DUE.DATE.AMC TO WIDGET.USER.DATA(8)şEQUATE DATE.PAID.AMC TO WIDGET.USER.DATA(9)şEQUATE INVOICE.AMT.AMC TO WIDGET.USER.DATA(10)şEQUATE INVOICE.AMT.CONV TO WIDGET.USER.DATA(11)şEQUATE INVOICE.AMT.COOR TO WIDGET.USER.DATA(12)şEQUATE BALANCE.AMC TO WIDGET.USER.DATA(13)şEQUATE BALANCE.CONV TO WIDGET.USER.DATA(14)şEQUATE BALANCE.COOR TO WIDGET.USER.DATA(15)şOPEN '','MVDB.CONTROL' TO FI.MVDB.CONTROL ELSE STOP 201,'MVDB.CONTROL'şREAD PLATFORM FROM FI.MVDB.CONTROL, 'PLATFORM' ELSEş   MESSAGE='No Platform Type Defined'ş   GOTO MESSAGE.DISPLAYş ENDşFIRST.TIME=0şIF G$SUBMITTED <> '1' THENş   MATREAD WIDGET.USER.DATA FROM FI.MVDB.CONTROL, 'PORTAL.AP.REPORT.SETUP' ELSEş      MAT WIDGET.USER.DATA = ''ş      FIRST.TIME=1ş    ENDş   IF NOT(FIRST.TIME) THENş      GOSUB VALIDATE.PREVIOUS.INPUTSş    ENDş END ELSEş   GOSUB VALIDATE.PREVIOUS.INPUTSş   MATWRITE WIDGET.USER.DATA ON FI.MVDB.CONTROL, 'PORTAL.AP.REPORT.SETUP'ş ENDşGOSUB SET.PROMPTSşRETURNş*şSET.PROMPTS:ş*şW$INPUT.PROMPT<1> = "AP File Account"şW$INPUT.TYPE<1> = "TEXT"şW$INPUT.UDPOS<1> = 1şW$INPUT.DEFAULT<1> = ACCOUNTş*şW$INPUT.PROMPT<2> = "Name Of AP File"şW$INPUT.TYPE<2> = "TEXT"şW$INPUT.UDPOS<2> = 2şW$INPUT.DEFAULT<2> = REPORT.FILEş*şW$INPUT.PROMPT<3> = "Due Date Dict Name"şW$INPUT.TYPE<3> = 'TEXT'şW$INPUT.UDPOS<3> = 3şW$INPUT.DEFAULT<3> = DUE.DATE.DICTş*şW$INPUT.PROMPT<4> = "Date Paid Dict Name"şW$INPUT.TYPE<4> = 'TEXT'şW$INPUT.UDPOS<4> = 4şW$INPUT.DEFAULT<4> = DATE.PAID.DICTş*şW$INPUT.PROMPT<5> = "Invoice Amount Dict Name"şW$INPUT.TYPE<5> = 'TEXT'şW$INPUT.UDPOS<5> = 5şW$INPUT.DEFAULT<5> = INVOICE.AMT.DICTş*şW$INPUT.PROMPT<6> = "Remaining Balance Dict Name"şW$INPUT.TYPE<6> = 'TEXT'şW$INPUT.UDPOS<6> = 6şW$INPUT.DEFAULT<6> = BALANCE.DICTş*şRETURNş*şVALIDATE.PREVIOUS.INPUTS:ş*şMESSAGE=''şBEGIN CASEş   CASE PLATFORM = 'D3'ş      MD.TYPE='MD'ş   CASE PLATFORM = 'JB'ş      MD.TYPE='MD'ş   CASE 1ş      MD.TYPE='VOC'şEND CASEşOPEN '',MD.TYPE TO FI.MD ELSEş   MESSAGE='Unable to open ':MD.TYPE:' for validation purposes'ş   GOTO MESSAGE.DISPLAYş ENDşVALID.ACCOUNT=1şIF ACCOUNT <> '' THENş**   EXECUTE "SET-FILE ":ACCOUNT:" ":MD.TYPE:' QFILE' CAPTURING DUMMYş   ERR.MSG=''ş   IF PLATFORM <> 'JB' THENş      QFILE.NAME='QFILE'ş      CALL CREATE.QPOINTER(PLATFORM,FI.MD,ACCOUNT,MD.TYPE,QFILE.NAME,FI.ACCOUNT.MD)ş      IF QFILE.NAME = '' THEN ERR.MSG=ACCOUNT:' is not a valid account'ş    END ELSEş      IF INDEX(ACCOUNT,'/',1) THEN PATH.DELIM='/' ELSE PATH.DELIM='\'ş      F.PTR='F':@AM:ACCOUNT:PATH.DELIM:'MD'ş      F.PTR<3>=F.PTR<2>:']D'ş      QFILE.NAME='QFILE'ş      WRITE F.PTR ON FI.MD, QFILE.NAMEş      OPEN '','QFILE' TO TEST.MD ELSE ERR.MSG=ACCOUNT:' is not a valid account path!'ş    ENDş    IF ERR.MSG <> '' THENş      MESSAGE<-1>=ERR.MSGş      VALID.ACCOUNT=0ş    ENDş**   IF PLATFORM = 'UD' THENş**      QFILE.NAME='QFILE'ş**      CALL CREATE.UD.QPOINTER(ACCOUNT,MD.TYPE,QFILE.NAME,FI.ACCOUNT.MD)ş**      IF QFILE.NAME = '' THENş**         MESSAGE<-1>=ACCOUNT:' is not a valid account!'ş**         VALID.ACCOUNT=0ş**       ENDş**    END ELSEş**      WRITE 'Q':@AM:ACCOUNT:@AM:MD.TYPE ON FI.MD, 'QFILE'ş**      VALID.ACCOUNT=1ş**      OPEN '','QFILE' TO FI.ACCOUNT.MD ELSEş**         MESSAGE<-1>=ACCOUNT:' is not a valid account!'ş**         VALID.ACCOUNT=0ş**       ENDş**    ENDş END ELSEş   VALID.ACCOUNT=0ş   MESSAGE<-1>='No Account defined!'ş ENDşIF REPORT.FILE <> '' THENş   IF NOT(VALID.ACCOUNT) THENş      IF PLATFORM = 'JB' THENş         MESSAGE<-1>='Unable to verify ':REPORT.FILE:' file because account path not properly defined!'ş      END ELSEş         MESSAGE<-1>='Unable to verify ':REPORT.FILE:' file because account not properly defined!'ş      ENDş      VALID.REPORT.FILE=0ş    END ELSEş      VALID.REPORT.FILE=1ş      QFILE.NAME='QFILE'ş      IF PLATFORM <> 'JB' THENş         CALL CREATE.QPOINTER(PLATFORM,FI.MD,ACCOUNT,REPORT.FILE,QFILE.NAME,FI.REPORT.FILE)ş         IF QFILE.NAME = '' THENş            MESSAGE<-1>=REPORT.FILE:' is not a valid file in the ':ACCOUNT:' account!'ş            VALID.REPORT.FILE=0ş          ENDş       END ELSEş         F.PTR='F':@AM:ACCOUNT:PATH.DELIM:REPORT.FILEş         F.PTR<3>=F.PTR<2>:']D'ş         QFILE.NAME='QFILE'ş         WRITE F.PTR ON FI.MD, QFILE.NAMEş         OPEN '','QFILE' TO TEST.MD ELSE ş            MESSAGE<-1>=REPORT.FILE:' is not a valid file in the ':ACCOUNT:' path!'ş            VALID.REPORT.FILE=0ş   ş       ENDş    END     ş**      EXECUTE "SET-FILE ":ACCOUNT:" ":REPORT.FILE:' QFILE' CAPTURING DUMMYş**       IF PLATFORM = 'UD' THENş**          QFILE.NAME='QFILE'ş**          CALL CREATE.UD.QPOINTER(ACCOUNT,REPORT.FILE,QFILE.NAME,FI.REPORT.FILE)ş**          IF QFILE.NAME = '' THENş**             MESSAGE<-1>=REPORT.FILE:' is not a valid file in the ':ACCOUNT:' account!'ş**             VALID.REPORT.FILE=0ş**           ENDş**        END ELSEş**         WRITE 'Q':@AM:ACCOUNT:@AM:REPORT.FILE ON FI.MD, 'QFILE'ş**         OPEN '','QFILE' TO FI.REPORT.FILE ELSEş**            MESSAGE<-1>=REPORT.FILE:' is not a valid file in the ':ACCOUNT:' account!'ş**            VALID.REPORT.FILE=0ş**          ENDş**       ENDş      IF VALID.REPORT.FILE THENş         HAVE.QFILE.REC=1ş         READ QFILE.REC FROM FI.MD, 'QFILE' ELSEş            HAVE.QFILE.REC=0ş            MESSAGE<-1>='Unable to create QFILE pointer to ':ACCOUNT:' ':REPORT.FILEş          ENDş         IF HAVE.QFILE.REC THENş            WRITE QFILE.REC ON FI.MD, 'DASHBOARD.AP.FILE'ş            OPEN 'DICT','DASHBOARD.AP.FILE' TO FI.DICT.REPORT.FILE ELSE ş               MESSAGE<-1>='Unable to open DICT ':REPORT.FILEş             ENDş          ENDş       ENDş    ENDş END ELSEş   MESSAGE<-1>='No AP Report file defined!'ş ENDşIF DUE.DATE.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Due Date Dictionary Defined!'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":DUE.DATE.DICT:' Because No AP File!'ş    END ELSEş      READ DUE.DATE.DICT.REC FROM FI.DICT.REPORT.FILE, DUE.DATE.DICT ELSEş         DUE.DATE.DICT.REC=''ş         MESSAGE<-1>=DUE.DATE.DICT:' Does Not Exist!'ş       ENDş      IF DUE.DATE.DICT.REC <> '' THENş         VALID.DATE.DICT=1ş         DICT.TYPE=DUE.DATE.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S' ş               IF DUE.DATE.DICT.REC<7>[1,1] <> 'D' AND DUE.DATE.DICT.REC<8>[1,1] <> 'D' THENş                  VALID.DATE.DICT=0ş                ENDş               DUE.DATE.AMC=DUE.DATE.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               IF DUE.DATE.DICT.REC<3>[1,1] <> 'D' THENş                  VALID.DATE.DICT=0ş                ENDş               DUE.DATE.AMC=DUE.DATE.DICT.REC<2>ş            CASE 1ş               VALID.DATE.DICT=0ş               DUE.DATE.AMC=DUE.DATE.DICT.REC<2>ş         END CASEş         IF NOT(VALID.DATE.DICT) THENş            MESSAGE<-1>='Dictionary Item ':DUE.DATE.DICT:' Does Not Appear To Be A Date!'ş          ENDş       ENDş    ENDş ENDşIF DATE.PAID.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Date Paid Dictionary Defined!'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":DATE.PAID.DICT:' Because No AP File!'ş    END ELSEş      READ DATE.PAID.DICT.REC FROM FI.DICT.REPORT.FILE, DATE.PAID.DICT ELSEş         DATE.PAID.DICT.REC=''ş         MESSAGE<-1>=DATE.PAID.DICT:' Does Not Exist!'ş       ENDş      IF DATE.PAID.DICT.REC <> '' THENş         VALID.DATE.DICT=1ş         DICT.TYPE=DATE.PAID.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S' ş               IF DATE.PAID.DICT.REC<7>[1,1] <> 'D' AND DATE.PAID.DICT.REC<8>[1,1] <> 'D' THENş                  VALID.DATE.DICT=0ş                ENDş               DATE.PAID.AMC=DATE.PAID.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               IF DATE.PAID.DICT.REC<3>[1,1] <> 'D' THENş                  VALID.DATE.DICT=0ş                ENDş               DATE.PAID.AMC=DATE.PAID.DICT.REC<2>ş            CASE 1ş               VALID.DATE.DICT=0ş               DATE.PAID.AMC=DATE.PAID.DICT.REC<2>ş         END CASEş         IF NOT(VALID.DATE.DICT) THENş            MESSAGE<-1>='Dictionary Item ':DATE.PAID.DICT:' Does Not Appear To Be A Date!'ş          ENDş       ENDş    ENDş ENDşIF INVOICE.AMT.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Invoice Amount Dictionary Defined!'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":INVOICE.AMT.DICT:' Because No AP File!'ş    END ELSEş      READ INVOICE.AMT.DICT.REC FROM FI.DICT.REPORT.FILE, INVOICE.AMT.DICT ELSEş         INVOICE.AMT.DICT.REC=''ş         MESSAGE<-1>=INVOICE.AMT.DICT:' Does Not Exist!'ş       ENDş      IF INVOICE.AMT.DICT.REC <> '' THENş         VALID.AMOUNT.DICT=1ş         DICT.TYPE=INVOICE.AMT.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S' ş               DICT.7.1.2=INVOICE.AMT.DICT.REC<7>[1,2]ş               DICT.8.1.2=INVOICE.AMT.DICT.REC<8>[1,2]ş               IF DICT.7.1.2 <> 'MD' AND DICT.7.1.2 <> 'MR' AND DICT.8.1.2 <> 'MD' AND DICT.8.1.2 <> 'MR' THENş                  VALID.AMOUNT.DICT=0ş                ENDş               INVOICE.AMT.AMC=INVOICE.AMT.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               DICT.3.1.2=INVOICE.AMT.DICT.REC<3>[1,2]ş               IF DICT.3.1.2 <> 'MR' AND DICT.3.1.2 <> 'MD' THENş                  VALID.AMOUNT.DICT=0ş                ENDş               INVOICE.AMT.AMC=INVOICE.AMT.DICT.REC<2>ş            CASE 1ş               VALID.AMOUNT.DICT=0ş               INVOICE.AMT.AMC=INVOICE.AMT.DICT.REC<2>ş         END CASEş         IF NOT(VALID.AMOUNT.DICT) THENş            MESSAGE<-1>='Dictionary Item ':INVOICE.AMT.DICT:' Does Not Appear To Be An Amount!'ş          ENDş       ENDş    ENDş ENDşIF BALANCE.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Balance Dictionary Defined!'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":BALANCE.DICT:' Because No AP File!'ş    END ELSEş      READ BALANCE.DICT.REC FROM FI.DICT.REPORT.FILE, BALANCE.DICT ELSEş         BALANCE.DICT.REC=''ş         MESSAGE<-1>=BALANCE.DICT:' Does Not Exist!'ş       ENDş      IF BALANCE.DICT.REC <> '' THENş         VALID.AMOUNT.DICT=1ş         DICT.TYPE=BALANCE.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S' ş               DICT.7.1.2=BALANCE.DICT.REC<7>[1,2]ş               DICT.8.1.2=BALANCE.DICT.REC<8>[1,2]ş               IF DICT.7.1.2 <> 'MD' AND DICT.7.1.2 <> 'MR' AND DICT.8.1.2 <> 'MD' AND DICT.8.1.2 <> 'MR' THENş                  VALID.AMOUNT.DICT=0ş                ENDş               BALANCE.AMC=BALANCE.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               DICT.3.1.2=BALANCE.DICT.REC<3>[1,2]ş               IF DICT.3.1.2 <> 'MR' AND DICT.3.1.2 <> 'MD' THENş                  VALID.AMOUNT.DICT=0ş                ENDş               BALANCE.AMC=BALANCE.DICT.REC<2>ş            CASE 1ş               VALID.AMOUNT.DICT=0ş               BALANCE.AMC=BALANCE.DICT.REC<2>ş         END CASEş         IF NOT(VALID.AMOUNT.DICT) THENş            MESSAGE<-1>='Dictionary Item ':BALANCE.DICT:' Does Not Appear To Be An Amount!'ş          ENDş       ENDş    ENDş ENDşCREATE.INDEXES=1şIF MESSAGE = '' THENş   MESSAGE='AP Report parameters properly defined!'ş END ELSEş   IF INDEX(MESSAGE,'!',1) THENş      MESSAGE=INSERT(MESSAGE,1,0,0,'!!! ERRORS !!!')ş      CREATE.INDEXES=0ş    ENDş ENDşIF CREATE.INDEXES THENş   * CREATE PIPE DICTIONARY ITEMş   IF PLATFORM = 'D3' OR PLATFORM = 'QM' OR PLATFORM = 'JB' THENş      PIPE='A'ş      PIPE<2>=0ş      PIPE<3>=' 'ş      PIPE<8>='F;C|'ş      PIPE<9>='L'ş      PIPE<10>=1ş    END ELSEş      PIPE='I'ş      PIPE<2>='"|"'ş      PIPE<4>='|'ş      PIPE<5>='1L'ş      PIPE<6>='S'ş    ENDş   WRITE PIPE ON FI.DICT.REPORT.FILE, 'PIPE'ş   *ş   ** INDEX LOGICş   *ş   BEGIN CASEş      CASE PLATFORM = 'D3'ş         INDEX.TEST='A':DUE.DATE.AMC:'(DY):':DUE.DATE.AMC:'(DM)'ş         READ FILE.DEF.REC FROM FI.DICT.REPORT.FILE, REPORT.FILE ELSE FILE.DEF.REC=''ş         IF FILE.DEF.REC <> '' AND NOT(INDEX(FILE.DEF.REC<8>,INDEX.TEST,1)) THENş            MESSAGE<-1>='Creating Indexes'ş            CMND1="CREATE-INDEX DASHBOARD.AP.FILE A":DUE.DATE.AMCş            EXECUTE CMND1 CAPTURING RESULT1ş            CMND2="CREATE-INDEX DASHBOARD.AP.FILE ":INDEX.TESTş            EXECUTE CMND2 CAPTURING RESULT2ş          ENDş      CASE 1ş         EXECUTE "CREATE-INDEX DASHBOARD.AP.FILE ":DUE.DATE.DICT CAPTURING RESULT1ş   END CASEş ENDşGOSUB MESSAGE.DISPLAYşRETURNş*şMESSAGE.DISPLAY:ş*şMAX.MSG=DCOUNT(MESSAGE,CHAR(254))şW$HTML.DATA='<h3>':MESSAGE<1>şIF MAX.MSG > 1 THENş   FOR MSG.NO = 2 TO MAX.MSGş      W$HTML.DATA:='<br>':MESSAGE<MSG.NO>ş    NEXT MSG.NOş ENDşW$HTML.DATA:='</h3>'şRETURNşEND0006AECREATE.QPOINTERş0c2SUBROUTINE CREATE.QPOINTER(PLATFORM,FI.MD,ACCOUNT,FILENAME,CALL.IT,FI.QPOINTER)ş**OPEN '',CALL.IT TO FI.QPOINTER THENş**   IF CALL.IT <> 'QFILE' THEN RETURNş** ENDşCALL.IT.PARAM=CALL.ITşCALL.IT=''şPATH=@PATHşBEGIN CASEş   CASE PLATFORM = 'UD'ş      OPEN '','UD.ACCOUNTS' TO FI.UD.ACCOUNTS ELSEş         UD.ACCOUNTS='F'ş         UD.ACCOUNTS<-1>='@UDTHOME/sys/UD.ACCOUNT'ş         UD.ACCOUNTS<-1>='@UDTHOME/sys/D_UD.ACCOUNT'ş         WRITE UD.ACCOUNTS ON FI.MD, 'UD.ACCOUNTS'ş         OPEN '','UD.ACCOUNTS' TO FI.UD.ACCOUNTS ELSE RETURNş       ENDş      READV PATH FROM FI.UD.ACCOUNTS, ACCOUNT, 1 ELSE RETURNş      F.POINTER='F'ş      F.POINTER<2>=PATH:'/':FILENAMEş      F.POINTER<3>=PATH:'/D_':FILENAMEş      WRITE F.POINTER ON FI.MD, CALL.IT.PARAMş   CASE PLATFORM = 'JB' AND ACCOUNT = 'MVDB'ş      IF INDEX(PATH,':\',1) THEN DELIM.TYPE='\' ELSE DELIM.TYPE='/'ş      F.POINTER='F'ş      F.POINTER<2>=PATH:DELIM.TYPE:FILENAMEş      F.POINTER<3>=PATH:DELIM.TYPE:FILENAME:']D'ş      WRITE F.POINTER ON FI.MD, CALL.IT.PARAMş   CASE 1ş      QFILE.REC='Q':@AM:ACCOUNT:@AM:FILENAMEş      WRITE QFILE.REC ON FI.MD, CALL.IT.PARAMşEND CASEş* CHANGE CALL.IT TO SUCCESSFUL NAMEş* OTHERWISE IT WILL RETURN WITH NULL SAYING FAILUREşCALL.IT=CALL.IT.PARAMşOPEN '',CALL.IT.PARAM TO FI.QPOINTER ELSEş   CALL.IT=''ş   IF PLATFORM = 'JB' AND FILENAME = 'MD' THENş      * OTHER ACCOUNT MAY NOT HAVE AN MD AND THE ONLY REASON TO SET Aş      * QPOINTER TO IT IS TO TEST VALIDITY OF THE ACCOUNT SO JUSTş      * CHECK FOR THE EXISTENCE OF A SYSTEM RECORDş      OPEN '','SYSTEM' TO FI.SYSTEM ELSE RETURNş      READ ACCOUNT.EXIST FROM FI.SYSTEM, ACCOUNT ELSE RETURNş      CALL.IT=CALL.IT.PARAMş    ENDş ENDşRETURNşEND000B60SUB.DEMO.SALES.CHARTş0c2SUBROUTINE SUB.DEMO.SALES.CHARTş*ş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "FCCOLUMN3D"şW$WIDTH = 2şW$PDFABLE = 1ş*şIF G$QUERYMODE THEN RETURNş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEşOPEN '','MVDB.CONTROL' TO FILE.CONTROL ELSE STOPşREAD REC FROM FILE.CONTROL, 'DEMO.FINANCIAL.PICTURE' ELSE REC=''şVAL.TYPE='$'şDRILLDOWN.WIDGET=''şDRILLDOWN.TYPE=''şBEGIN CASEş   CASE WIDGET.USER.DATA(1) = 'REVENUES'ş      W$TITLE='YTD Revenues'ş      W$BAR.YMEMO = "YTD Revenues"ş      SALES.AMTS=REC<68>ş   CASE WIDGET.USER.DATA(1) = 'GROSSPROFIT'ş      W$TITLE='YTD Gross Profit'ş      W$BAR.YMEMO = "YTD Gross Profit"ş      SALES.AMTS=REC<69>ş   CASE WIDGET.USER.DATA(1) = 'MARGIN'ş      VAL.TYPE='%'ş      W$TITLE='YTD Margin %'ş      W$BAR.YMEMO = "Margin %"ş      SALES.AMTS=REC<39>ş   CASE WIDGET.USER.DATA(1) = 'PARTS$'ş      W$TITLE='YTD Parts Revenue ($)'ş      W$BAR.YMEMO = "Parts Revenue ($)"ş      SALES.AMTS=REC<40>ş      DRILLDOWN.WIDGET='DEMO SALE TYPES PIE'ş      DRILLDOWN.TYPE='PARTS'ş   CASE WIDGET.USER.DATA(1) = 'SERVICES$'ş      W$TITLE='YTD Services Revenue ($)'ş      W$BAR.YMEMO = "Services Revenue ($)"ş      SALES.AMTS=REC<42>ş      DRILLDOWN.WIDGET='DEMO SALE TYPES PIE'ş      DRILLDOWN.TYPE='SERVICES'şEND CASEş*şYEARS=REC<38>şMAX.YEARS=DCOUNT(YEARS,CHAR(253))ş*ş*şMAX.SALES.AMT=0şN=0şFIRST.YEAR=''şFOR NN = 1 TO MAX.YEARSş   SALES.AMT=SUM(SALES.AMTS<1,NN>)ş   BEGIN CASEş      CASE VAL.TYPE = '$'ş         SALES.AMT=OCONV(SALES.AMT,'MD02')ş      CASE VAL.TYPE = '%'ş         SALES.AMT=OCONV(SALES.AMT,'MD01')ş      CASE 1ş         NULLş   END CASEş  IF SALES.AMT THENş     N+=1ş     IF SALES.AMT > MAX.SALES.AMT THEN MAX.SALES.AMT=SALES.AMTş     W$BAR.VALUES<1,N> = SALES.AMTş     YEAR=YEARS<1,NN>ş     IF DRILLDOWN.TYPE <> '' THENş        W$FW.DD.WIDGET<1,N>=DRILLDOWN.WIDGETş        W$FW.DD.UD.POS<1,N,1>=1ş        W$FW.DD.UD.VAL<1,N,1>=YEARş        W$FW.DD.UD.POS<1,N,2>=2ş        W$FW.DD.UD.VAL<1,N,2>=DRILLDOWN.TYPEş      ENDş     IF NOT(FIRST.YEAR) THEN FIRST.YEAR=YEARş     CURRENT.YEAR=YEARş     W$BAR.XLABELS<1,N> = YEARş   ENDşNEXT NNşW$BAR.XMEMO = "Year"şIF DRILLDOWN.TYPE <> '' THENş   W$BAR.XMEMO := " (drilldown for detail)"ş ENDşW$BAR.CAPTION=W$BAR.YMEMO:' From ':FIRST.YEAR:' to ':CURRENT.YEARşIF VAL.TYPE = '$' THENş   * ROUND MAX AMOUNT UP TO THE NEXT 250000ş   MAX.SALES.AMT+=250000ş   MAX.SALES.AMT=INT(MAX.SALES.AMT/250000) * 250000ş   W$CHART.OPTIONS<-1>='yAxisMaxValue="':MAX.SALES.AMT:'"'ş   W$CHART.OPTIONS<-1>='decimals="2"'ş   W$CHART.OPTIONS<-1>='DecimalPrecision="2"'ş   W$CHART.OPTIONS<-1>='divLineDecimalPrecision="2"'ş   W$CHART.OPTIONS<-1>='limitsDecimalPrecision="2"'ş   W$CHART.OPTIONS<-1>='formatNumberScale="1"'ş ENDşIF VAL.TYPE = '%' THENş   W$CHART.OPTIONS<-1>='decimals="1"'ş   W$CHART.OPTIONS<-1>='forceDecimals="1"'ş ENDşRETURN00B526SUB.PORTAL.SALES.REPORTSş0c2SUBROUTINE SUB.PORTAL.SALES.REPORTSş*ş* DEFINE PARAMETERS FOR PORTAL SALES REPORTş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEşOPEN '','MVDB.SUBS' TO FI.MVDB.SUBS ELSE STOPşDIM SETUP.PARAMS(25)ş*şW$TITLE = "Portal Sales Reports"; CALL PORTAL.SHOW.LAST.UPDATED('SALES')şW$TYPE = "HTML"şW$WIDTH = 3şD3=1ş*şIF G$QUERYMODE THEN RETURNş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEşW$BAR.COLORS<1,5>=COLOR$YELLOWşALF.MONTHS='Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec'şEQUATE REPORT.TYPE TO WIDGET.USER.DATA(1)ş*şIF REPORT.TYPE = '' THEN REPORT.TYPE='MTD Sales'ş*şOPEN '','MVDB.CONTROL' TO FI.MVDB.CONTROL ELSE ş   ERROR.MSG='UNABLE TO OPEN MVDB.CONTROL'ş   GOTO DISPLAY.ERRORş ENDşOPEN '','DASHBOARD.CLOSING.STATS' TO FI.DASHBOARD.CLOSING.STATS ELSE ş   ERROR.MSG='UNABLE TO OPEN DASHBOARD.CLOSING.STATS'ş   GOTO DISPLAY.ERRORş ENDşOPEN 'DICT','DASHBOARD.CLOSING.STATS' TO FI.DICT.DASHBOARD.CLOSING.STATS ELSE ş   ERROR.MSG='UNABLE TO OPEN DICT DASHBOARD.CLOSING.STATS'ş   GOTO DISPLAY.ERRORş ENDşMATREAD SETUP.PARAMS FROM FI.MVDB.CONTROL, 'PORTAL.SALES.REPORT.SETUP' ELSEş   MAT SETUP.PARAMS=''ş ENDşEQUATE ACCOUNT TO SETUP.PARAMS(1)şEQUATE REPORT.FILE TO SETUP.PARAMS(2)şEQUATE SALE.DATE.DICT TO SETUP.PARAMS(3)şEQUATE SALE.MONTH.DICT TO SETUP.PARAMS(4)şEQUATE SALE.YEAR.DICT TO SETUP.PARAMS(5)şEQUATE SALE.AMOUNT.DICT TO SETUP.PARAMS(6)şEQUATE COST.OF.SALE.AMOUNT.DICT TO SETUP.PARAMS(7)şEQUATE SALESMAN.DICT TO SETUP.PARAMS(8)şEQUATE BRANCH.DICT TO SETUP.PARAMS(9)şEQUATE REGION.DICT TO SETUP.PARAMS(10)şEQUATE SALE.DATE.AMC TO SETUP.PARAMS(11)şEQUATE SALE.AMOUNT.AMC TO SETUP.PARAMS(12)şEQUATE SALE.AMOUNT.CONV TO SETUP.PARAMS(13)şEQUATE SALE.AMOUNT.COOR TO SETUP.PARAMS(14)şEQUATE COST.OF.SALE.AMOUNT.AMC TO SETUP.PARAMS(15)şEQUATE COST.OF.SALE.AMOUNT.CONV TO SETUP.PARAMS(16)şEQUATE COST.OF.SALE.AMOUNT.COOR TO SETUP.PARAMS(17)şEQUATE SALESMAN.AMC TO SETUP.PARAMS(18)şEQUATE SALESMAN.TFILE TO SETUP.PARAMS(19)şEQUATE BRANCH.AMC TO SETUP.PARAMS(20)şEQUATE BRANCH.TFILE TO SETUP.PARAMS(21)şEQUATE REGION.AMC TO SETUP.PARAMS(22)şEQUATE REGION.TFILE TO SETUP.PARAMS(23)ş*şREAD PLATFORM FROM FI.MVDB.CONTROL, 'PLATFORM' ELSE PLATFORM='D3'şBEGIN CASEş   CASE PLATFORM = 'UD'ş      EXECUTE.STACKED.CMNDS='UD.EXECUTE.STACKED.CMNDS'ş      MD.FILE.NAME='VOC'ş   CASE PLATFORM = 'UV'ş      EXECUTE.STACKED.CMNDS='UV.EXECUTE.STACKED.CMNDS'ş      MD.FILE.NAME='VOC'ş   CASE PLATFORM = 'QM'ş      EXECUTE.STACKED.CMNDS='EXECUTE.STACKED.CMNDS'ş      MD.FILE.NAME='VOC'ş   CASE 1ş      * D3 AND JBASE ARE THE SAMEş      EXECUTE.STACKED.CMNDS='EXECUTE.STACKED.CMNDS'ş      MD.FILE.NAME='MD'şEND CASEşOPEN '',MD.FILE.NAME TO FI.MD ELSEş   ERROR.MSG='UNABLE TO OPEN ':MD.FILE.NAMEş   GOTO DISPLAY.ERRORş ENDş*şIF ACCOUNT = '' OR REPORT.FILE = '' OR SALE.DATE.DICT = '' OR SALE.AMOUNT.DICT = '' THENş   ERROR.MSG='SALES FILE ACCOUNT, SALES FILE NAME, DATE OF SALE, AND AMOUNT OF SALE MUST ALL BE DEFINED BEFORE REPORTS CAN BE ATTEMPTED'ş   GOTO DISPLAY.ERRORş ENDş*şSALES.FILE.PATH='SALES.FILE.PATH'şOPEN '',SALES.FILE.PATH TO FI.SALES.FILE.PATH ELSEş**   EXECUTE "SET-FILE ":ACCOUNT:" ":REPORT.FILE CAPTURING DUMMYş   QFILE.NAME=SALES.FILE.PATHş   CALL CREATE.QPOINTER(PLATFORM,FI.MD,ACCOUNT,REPORT.FILE,QFILE.NAME,FI.SALES.FILE.PATH)ş   IF QFILE.NAME = '' THENş      MESSAGE<-1>=REPORT.FILE:' is not a valid file in the ':ACCOUNT:' account!'ş      GOTO DISPLAY.ERRORş    ENDş**    IF PLATFORM = 'UD' THENş**       QFILE.NAME='SALES.FILE.PATH'ş**       CALL CREATE.UD.QPOINTER(ACCOUNT,REPORT.FILE,QFILE.NAME,FI.SALES.FILE.PATH)ş**       IF QFILE.NAME = '' THENş**          ERROR.MSG='UNABLE TO OPEN ':REPORT.FILE:' IN ':ACCOUNT:' ACCOUNT'ş**          GOTO DISPLAY.ERRORş**        ENDş**     END ELSEş**    **   READ MD.QFILE FROM FI.MD, 'QFILE' ELSEş**    **      ERROR.MSG='UNABLE TO CREATE QFILE TO SALES FILE'ş**    **      GOTO DISPLAY.ERRORş**    **    ENDş**       MD.QFILE='Q'ş**       MD.QFILE<2>=ACCOUNTş**       MD.QFILE<3>=REPORT.FILEş**       WRITE MD.QFILE ON FI.MD, 'SALES.FILE.PATH'ş**       OPEN '','SALES.FILE.PATH' TO FI.SALES.FILE.PATH ELSEş**          ERROR.MSG='UNABLE TO OPEN ':REPORT.FILE:' IN ':ACCOUNT:' ACCOUNT'ş**          GOTO DISPLAY.ERRORş**        ENDş**     ENDş   EXECUTE "CREATE-INDEX SALES.FILE.PATH ":SALE.DATE.DICT CAPTURING DUMMYş ENDş*şW$CHART.OPTIONS<-1>='decimals="2"'şW$CHART.OPTIONS<-1>='DecimalPrecision="2"'şW$CHART.OPTIONS<-1>='divLineDecimalPrecision="2"'şW$CHART.OPTIONS<-1>='limitsDecimalPrecision="2"'şW$CHART.OPTIONS<-1>='formatNumberScale="1"'ş*şOTODAY=OCONV(DATE(),'D4-')ş*şBEGIN CASEş   CASE REPORT.TYPE = 'MTD Sales'; GOSUB MTD.SALESş   CASE REPORT.TYPE = 'YTD Sales'; GOSUB YTD.SALESş   CASE REPORT.TYPE = 'Year to Year Sales and GP'; GOSUB YEAR.TO.YEAR.SALESş   CASE REPORT.TYPE = 'Year to Year Sales by Month'; GOSUB YEAR.TO.YEAR.SALES.BY.MONTHş   CASE REPORT.TYPE = 'Year to Year GP by Month'; GOSUB YEAR.TO.YEAR.GP.BY.MONTHş   CASE REPORT.TYPE = 'MTD Sales by Salesman'; GOSUB MTD.SALES.BY.SALESMANş   CASE REPORT.TYPE = 'YTD Sales by Salesman'; GOSUB YTD.SALES.BY.SALESMANş   CASE REPORT.TYPE = 'Year to Year Sales by Salesman'; GOSUB YEAR.TO.YEAR.BY.SALESMANş   CASE REPORT.TYPE = 'Year to Year GP by Salesman'; GOSUB YEAR.TO.YEAR.GP.BY.SALESMANş   CASE REPORT.TYPE = 'MTD Sales by Branch'; GOSUB MTD.SALES.BY.BRANCHş   CASE REPORT.TYPE = 'YTD Sales by Branch'; GOSUB YTD.SALES.BY.BRANCHş   CASE REPORT.TYPE = 'Year to Year Sales by Branch'; GOSUB YEAR.TO.YEAR.BY.BRANCHş   CASE REPORT.TYPE = 'Year to Year GP by Branch'; GOSUB YEAR.TO.YEAR.GP.BY.BRANCHş   CASE REPORT.TYPE = 'MTD Sales by Region'; GOSUB MTD.SALES.BY.REGIONş   CASE REPORT.TYPE = 'YTD Sales by Region'; GOSUB YTD.SALES.BY.REGIONş   CASE REPORT.TYPE = 'Year to Year Sales by Region'; GOSUB YEAR.TO.YEAR.BY.REGIONş   CASE REPORT.TYPE = 'Year to Year GP by Region'; GOSUB YEAR.TO.YEAR.GP.BY.REGIONşEND CASEş*şW$INPUT.PROMPT<1> = "Report Type"şW$INPUT.TYPE<1> = "SELECT"şW$INPUT.UDPOS<1> = 1şW$INPUT.DEFAULT<1> = REPORT.TYPEşSELOPTS='MTD Sales'şSELOPTS<1,-1>='YTD Sales'şSELOPTS<1,-1>='Year to Year Sales and GP'şSELOPTS<1,-1>='Year to Year Sales by Month'şSELOPTS<1,-1>='Year to Year GP by Month'şSELOPTS<1,-1>='MTD Sales by Salesman'şSELOPTS<1,-1>='YTD Sales by Salesman'şSELOPTS<1,-1>='Year to Year Sales by Salesman'şSELOPTS<1,-1>='Year to Year GP by Salesman'şIF BRANCH.DICT <> '' THENş   SELOPTS<1,-1>='MTD Sales by Branch'ş   SELOPTS<1,-1>='YTD Sales by Branch'ş   SELOPTS<1,-1>='Year to Year Sales by Branch'ş   SELOPTS<1,-1>='Year to Year GP by Branch'ş ENDşIF REGION.DICT <> '' THENş   SELOPTS<1,-1>='MTD Sales by Region'ş   SELOPTS<1,-1>='YTD Sales by Region'ş   SELOPTS<1,-1>='Year to Year Sales by Region'ş   SELOPTS<1,-1>='Year to Year GP by Region'ş ENDşW$INPUT.SELOPTS=SELOPTSşW$INPUT.SELVALS=SELOPTSşRETURNş*şDISPLAY.ERROR:ş*şW$HTML.DATA='<h3>':ERROR.MSG:'</h3>'şRETURNş*şMTD.SALES:ş*şGET.REPORT.TYPE='SALES'; GOSUB GET.CURRENT.REPORTşIF REPORT.STATS.REC[1,5] = 'ERROR' OR REPORT.STATS.REC<1> = '' THENş   ERROR.MSG='NO SALES CLOSED SINCE BEGINNING OF MONTH'ş   GOSUB DISPLAY.ERRORş   RETURNş ENDşW$BAR.XMEMO = "Date"şW$BAR.LABELS<1>='Total Sales'şW$BAR.LABELS<2>='Gross Profit'şDATES=REPORT.STATS.REC<1>şNUM.DATES=DCOUNT(DATES,CHAR(253))şAMOUNTS=REPORT.STATS.REC<2>şSUM.AMOUNTS=SUM(AMOUNTS)şCOST.OF.SALES=REPORT.STATS.REC<3>şSUM.COST.OF.SALES=SUM(COST.OF.SALES)şSUM.GROSS.PROFIT=SUM.AMOUNTS-SUM.COST.OF.SALESşW$BAR.YMEMO='Total Sales and Gross Profits'şW$BAR.CAPTION = "Total Month to Date Sales of ":OCONV(SUM.AMOUNTS,'MD2,$'):" and Gross Profit of ":OCONV(SUM.GROSS.PROFIT,'MD2,$'):" by Date"şIF NUM.DATES > 20 THENş   W$TYPE='FCMSBAR2D'ş   START.CNTR=NUM.DATESş   END.CNTR=1ş   STEP.CNTR=(-1)ş END ELSEş   W$TYPE='FCMSCOLUMN2D'ş   START.CNTR=1ş   END.CNTR=NUM.DATESş   STEP.CNTR=1ş ENDşVALUE.CNTR=0şFOR AMT.CNTR = START.CNTR TO END.CNTR STEP STEP.CNTRş   AMOUNT=AMOUNTS<1,AMT.CNTR>ş   IF AMOUNT THENş      COST.OF.SALE=COST.OF.SALES<1,AMT.CNTR>ş      GROSS.PROFIT=AMOUNT-COST.OF.SALEş      IF GROSS.PROFIT < 0 THEN GROSS.PROFIT=0ş      VALUE.CNTR+=1ş      ROW.DATE=ICONV(DATES<1,AMT.CNTR>,'D')ş      ROW.DATE=OCONV(ROW.DATE,'D0')ş      W$BAR.XLABELS<1,VALUE.CNTR>=ROW.DATEş      W$BAR.VALUES<1,VALUE.CNTR>=OCONV(AMOUNT,'MD2')ş      W$BAR.VALUES<2,VALUE.CNTR>=OCONV(GROSS.PROFIT,'MD2')ş    ENDş NEXT AMT.CNTRş**WRITE DATES:CHAR(254):AMOUNTS ON FI.MVDB.SUBS, 'MTD.SALES.TEST'şRETURNş*şYTD.SALES:ş*şGOSUB VERIFY.CURRENT.DATAş*OTODAY=OCONV(DATE(),'D4-')şYTD.MO=OTODAY[1,2]+0şOYEAR=OTODAY[7,4]şSTACKED.1= 'SELECT DASHBOARD.CLOSING.STATS WITH YYYY = "':OYEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY YYYYMM BREAK-ON YYYYMM PIPE DET-SUPP TOTAL AMOUNT PIPE TOTAL GROSS.PROFIT ID-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE BEGINNING OF YEAR'ş   GOSUB DISPLAY.ERRORş   RETURNş ENDşW$BAR.XMEMO = "Month"şW$BAR.LABELS<1>='Total Sales'şW$BAR.LABELS<2>='Gross Profit'şWRITE REPORT ON FI.MVDB.SUBS, 'REPORT.RETURNED'şMONTHS=''şMONTH.CNTR=0şLAST.MONTH=''şAMOUNTS=''şGROSS.PROFITS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      MONTH=TRIM(FIELD(ROW,'|',1))[5,2]+0ş      AMOUNT=ICONV(TRIM(FIELD(ROW,'|',2)),'MD2')ş      GROSS.PROFIT=ICONV(TRIM(FIELD(ROW,'|',3)),'MD2')ş      IF NUM(AMOUNT) AND NUM(GROSS.PROFIT) THENş         IF MONTH <> LAST.MONTH THENş            LAST.MONTH=MONTHş            MONTH.CNTR+=1ş            MONTHS<1,MONTH.CNTR>=MONTHş            AMOUNTS<1,MONTH.CNTR>=0ş            GROSS.PROFITS<1,MONTH.CNTR>=0ş          ENDş         AMOUNTS<1,MONTH.CNTR>+=AMOUNTş         GROSS.PROFITS<1,MONTH.CNTR>+=GROSS.PROFITş       ENDş    ENDş NEXT ROW.NOşW$BAR.YMEMO='Total Sales and Gross Profit'şW$BAR.CAPTION = "Total Year to Date Sales of ":OCONV(SUM(AMOUNTS),'MD2,$'):"  And Gross Profit of ":OCONV(SUM(GROSS.PROFITS),'MD2,$'):" By Month"şNUM.AMOUNTS=DCOUNT(AMOUNTS,CHAR(253))şW$TYPE='FCMSCOLUMN2D'şVALUE.CNTR=0şFOR AMT.CNTR = 1 TO YTD.MOş   AMOUNT=AMOUNTS<1,AMT.CNTR>ş   GROSS.PROFIT=GROSS.PROFITS<1,AMT.CNTR>ş   IF AMOUNT > 0 AND GROSS.PROFIT >= 0 THENş      VALUE.CNTR+=1ş      MONTH=FIELD(ALF.MONTHS,',',AMT.CNTR)ş      W$BAR.XLABELS<1,VALUE.CNTR>=MONTHş      W$BAR.VALUES<1,VALUE.CNTR>=OCONV(AMOUNT,'MD2')ş      W$BAR.VALUES<2,VALUE.CNTR>=OCONV(GROSS.PROFIT,'MD2')ş    ENDş NEXT AMT.CNTRşRETURNş*şYEAR.TO.YEAR.SALES:ş*şGOSUB VERIFY.CURRENT.DATAşW$TYPE='FCMSCOLUMN2D'şTHIS.YEAR=OCONV(DATE(),'D4-')[7,4]şFIRST.YEAR=THIS.YEAR-4şSTACKED.1='SELECT DASHBOARD.CLOSING.STATS WITH YYYY GE "':FIRST.YEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY YYYY BREAK-ON YYYY PIPE TOTAL AMOUNT PIPE TOTAL GROSS.PROFIT ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE ':FIRST.YEARş   GOSUB DISPLAY.ERRORş   RETURNş ENDş**WRITE REPORT ON FI.MVDB.SUBS, 'YEAR.TO.YEAR.REPORT'şYEAR.TOTALS=''şYEAR.GROSS.PROFITS=''şYEARS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şYEAR.CNTR=0şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      YEAR=TRIM(FIELD(ROW,'|',1))ş      AMOUNT=TRIM(FIELD(ROW,'|',2))ş      GROSS.PROFIT=TRIM(FIELD(ROW,'|',3))ş      IF NUM(AMOUNT) AND NUM(GROSS.PROFIT) THENş         IF AMOUNT OR GROSS.PROFIT THENş            YEAR.CNTR+=1ş            YEARS<YEAR.CNTR>=YEARş            AMOUNT=ICONV(AMOUNT,'MD2')ş            GROSS.PROFIT=ICONV(GROSS.PROFIT,'MD2')ş            YEAR.TOTALS<YEAR.CNTR>=AMOUNTş            YEAR.GROSS.PROFITS<YEAR.CNTR>=GROSS.PROFITş          ENDş       ENDş    ENDşNEXT ROW.NOş*şW$BAR.CAPTION = "Sales and Gross Profit by Year"şW$BAR.XMEMO = "Year"şW$BAR.LABELS<1>='Total Sales'şW$BAR.LABELS<2>='Gross Profit'şW$BAR.YMEMO = "Total Sales and Gross Profit"ş*şMAX.YEARS=DCOUNT(YEARS,CHAR(254))şFOR YEAR.NO = 1 TO MAX.YEARSş   YEAR.TOTAL=YEAR.TOTALS<YEAR.NO>ş   YEAR.GROSS.PROFIT=YEAR.GROSS.PROFITS<YEAR.NO>ş   W$BAR.VALUES<1,YEAR.NO>=OCONV(YEAR.TOTAL+0,'MD2')ş   W$BAR.VALUES<2,YEAR.NO>=OCONV(YEAR.GROSS.PROFIT+0,'MD2')ş   W$BAR.XLABELS<1,YEAR.NO>=YEARS<YEAR.NO>ş NEXT YEAR.NOşRETURNş*şYEAR.TO.YEAR.SALES.BY.MONTH:ş*şGOSUB VERIFY.CURRENT.DATAşW$TYPE='FCMSCOLUMN2D'şTHIS.YEAR=OCONV(DATE(),'D4-')[7,4]şFIRST.YEAR=THIS.YEAR-4şSTACKED.1='SELECT DASHBOARD.CLOSING.STATS WITH YYYY GE "':FIRST.YEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY YYYYMM BREAK-ON YYYYMM PIPE TOTAL AMOUNT ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE ':FIRST.YEARş   GOSUB DISPLAY.ERRORş   RETURNş ENDşYEAR.MO.TOTALS=''şYEAR.NO=1şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      YYYYMM=TRIM(FIELD(ROW,'|',1))ş      YEAR=YYYYMM[1,4]ş      MO.NO=YYYYMM[5,2]+0ş      AMOUNT=TRIM(FIELD(ROW,'|',2))ş      IF YEAR <> '' AND MO.NO AND NUM(AMOUNT) THENş         YEAR.NO=YEAR-FIRST.YEAR+1ş         IF AMOUNT THENş            AMOUNT=ICONV(AMOUNT,'MD2')ş            YEAR.MO.TOTALS<YEAR.NO,MO.NO>+=AMOUNTş          ENDş       ENDş    ENDş NEXT ROW.NOş*şFOR I = 0 TO 4ş   W$BAR.LABELS<I+1> = FIRST.YEAR+Iş   W$BAR.LABEL.OPTS<I+1> = "showValues='0'"ş NEXT Iş*şW$BAR.CAPTION = "Monthly Sales by Year"şW$BAR.XMEMO = "Month"şW$BAR.YMEMO = "Sales"ş*şFOR MO.NO = 1 TO 12ş   FOR YEAR.NO = 1 TO 5ş      W$BAR.VALUES<YEAR.NO,MO.NO>=OCONV(YEAR.MO.TOTALS<YEAR.NO,MO.NO>+0,'MD2')ş    NEXT YEAR.NOş   W$BAR.XLABELS<1,MO.NO>=FIELD(ALF.MONTHS,',',MO.NO)ş NEXT MO.NOşRETURNş*şYEAR.TO.YEAR.GP.BY.MONTH:ş*şGOSUB VERIFY.CURRENT.DATAşW$TYPE='FCMSCOLUMN2D'şTHIS.YEAR=OCONV(DATE(),'D4-')[7,4]şFIRST.YEAR=THIS.YEAR-4şSTACKED.1='SELECT DASHBOARD.CLOSING.STATS WITH YYYY GE "':FIRST.YEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY YYYYMM BREAK-ON YYYYMM PIPE TOTAL GROSS.PROFIT ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE ':FIRST.YEARş   GOSUB DISPLAY.ERRORş   RETURNş ENDşYEAR.MO.TOTALS=''şYEAR.NO=1şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      YYYYMM=TRIM(FIELD(ROW,'|',1))ş      YEAR=YYYYMM[1,4]ş      MO.NO=YYYYMM[5,2]+0ş      GROSS.PROFIT=TRIM(FIELD(ROW,'|',2))ş      IF YEAR <> '' AND MO.NO AND NUM(GROSS.PROFIT) THENş         YEAR.NO=YEAR-FIRST.YEAR+1ş         IF GROSS.PROFIT THENş            GROSS.PROFIT=ICONV(GROSS.PROFIT,'MD2')ş            YEAR.MO.TOTALS<YEAR.NO,MO.NO>+=GROSS.PROFITş          ENDş       ENDş    ENDş NEXT ROW.NOş*şFOR I = 0 TO 4ş   W$BAR.LABELS<I+1> = FIRST.YEAR+Iş   W$BAR.LABEL.OPTS<I+1> = "showValues='0'"ş NEXT Iş*şW$BAR.CAPTION = "Monthly Gross Profit by Year"şW$BAR.XMEMO = "Month"şW$BAR.YMEMO = "Gross Profit"ş*şFOR MO.NO = 1 TO 12ş   FOR YEAR.NO = 1 TO 5ş      W$BAR.VALUES<YEAR.NO,MO.NO>=OCONV(YEAR.MO.TOTALS<YEAR.NO,MO.NO>+0,'MD2')ş    NEXT YEAR.NOş   W$BAR.XLABELS<1,MO.NO>=FIELD(ALF.MONTHS,',',MO.NO)ş NEXT MO.NOşRETURNş*şMTD.SALES.BY.SALESMAN:ş*ş*OTODAY=OCONV(DATE(),'D4-')şOMO=OTODAY[1,2]şODAY=OTODAY[4,2]+0şOYEAR=OTODAY[7,4]şIF ODAY = 1 THENş   OMO=OMO-1ş   IF NOT(OMO) THENş      OMO=12ş      OYEAR=OYEAR-1ş    ENDş ENDşDATE.SELECT.STRING=''şISTART=ICONV(OMO:'-1-':OYEAR,'D')şIEND=DATE()şNUM.COLS=IEND-ISTART+1şFOR IDATE = ISTART TO IENDş   DATE.SELECT.STRING:=' "':OCONV(IDATE,'D2-'):'"'ş NEXT IDATEş**WRITE DATE.SELECT.STRING ON FI.MVDB.SUBS, 'DATE.SELECT.STRING'şSTACKED.1='SELECT ':SALES.FILE.PATH:' WITH ':SALE.DATE.DICT:' = ':DATE.SELECT.STRINGşSTACKED.2='SORT ':SALES.FILE.PATH:' BY ':SALESMAN.DICT:' BREAK-ON ':SALESMAN.DICT:' PIPE TOTAL ':SALE.AMOUNT.DICT:' PIPE TOTAL ':COST.OF.SALE.AMOUNT.DICT:' ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE BEGINNING OF MONTH'ş   GOSUB DISPLAY.ERRORş   RETURNş ENDşW$BAR.XMEMO = "Salesman"şSALESMEN=''şSALESMAN.CNTR=0şLAST.SALESMAN=''şAMOUNTS=''şGROSS.PROFITS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      SALESMAN=TRIM(FIELD(ROW,'|',1))ş      AMOUNT=ICONV(TRIM(FIELD(ROW,'|',2)),'MD2')ş      COST.OF.SALE=ICONV(TRIM(FIELD(ROW,'|',3)),'MD2')ş      IF NUM(AMOUNT) AND NUM(COST.OF.SALE) THENş         IF AMOUNT > 0 THENş            IF SALESMAN <> LAST.SALESMAN THENş               LAST.SALESMAN=SALESMANş               SALESMAN.CNTR+=1ş               SALESMEN<1,SALESMAN.CNTR>=SALESMANş               AMOUNTS<1,SALESMAN.CNTR>=0ş               GROSS.PROFITS<1,SALESMAN.CNTR>=0ş             ENDş            GROSS.PROFIT=AMOUNT-COST.OF.SALEş            AMOUNTS<1,SALESMAN.CNTR>+=AMOUNTş            GROSS.PROFITS<1,SALESMAN.CNTR>+=GROSS.PROFITş          ENDş       ENDş    ENDş NEXT ROW.NOşW$BAR.YMEMO='Total Sales'şW$BAR.CAPTION = "Total Month to Date Sales of ":OCONV(SUM(AMOUNTS),'MD2,$'):" and Gross Profits of ":OCONV(SUM(GROSS.PROFITS),'MD2,$'):" by Salesman"şNUM.AMOUNTS=DCOUNT(AMOUNTS,CHAR(253))şIF SALESMAN.CNTR > 10 THENş   W$TYPE='FCMSBAR2D'ş   W$CHART.HEIGHT = 200 + (25 * SALESMAN.CNTR)ş END ELSEş   W$TYPE='FCMSCOLUMN2D'ş ENDşW$BAR.LABELS<1>='Total Sales'şW$BAR.LABELS<2>='Gross Profit'şVALUE.CNTR=0şFOR AMT.CNTR = 1 TO NUM.AMOUNTSş   AMOUNT=AMOUNTS<1,AMT.CNTR>ş   IF AMOUNT > 0 THENş      GROSS.PROFIT=GROSS.PROFITS<1,AMT.CNTR>ş      VALUE.CNTR+=1ş      SALESMAN=SALESMEN<1,AMT.CNTR>ş      W$BAR.XLABELS<1,VALUE.CNTR>=SALESMANş      W$BAR.VALUES<1,VALUE.CNTR>=OCONV(AMOUNT,'MD2')ş      W$BAR.VALUES<2,VALUE.CNTR>=OCONV(GROSS.PROFIT,'MD2')ş    ENDş NEXT AMT.CNTRş**WRITE SALESMEN:CHAR(254):AMOUNTS ON FI.MVDB.SUBS, 'MTD.SALES.TEST'şRETURNş*şYTD.SALES.BY.SALESMAN:ş*şGOSUB VERIFY.CURRENT.DATAş*OTODAY=OCONV(DATE(),'D4-')şYTD.MO=OTODAY[1,2]+0şOYEAR=OTODAY[7,4]şSTACKED.1= 'SELECT DASHBOARD.CLOSING.STATS WITH YYYY = "':OYEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY SALESMAN BREAK-ON SALESMAN PIPE TOTAL AMOUNT PIPE TOTAL GROSS.PROFIT ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE BEGINNING OF YEAR'ş   GOSUB DISPLAY.ERRORş   RETURNş ENDşW$BAR.XMEMO = "Salesman"şW$BAR.LABELS<1>='Total Sales'şW$BAR.LABELS<2>='Gross Profit'ş**WRITE REPORT ON FI.MVDB.SUBS, 'REPORT.RETURNED'şSALESMEN=''şSALESMAN.CNTR=0şLAST.SALESMAN=''şAMOUNTS=''şGROSS.PROFITS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      SALESMAN=TRIM(FIELD(ROW,'|',1))ş      AMOUNT=TRIM(FIELD(ROW,'|',2))ş      GROSS.PROFIT=TRIM(FIELD(ROW,'|',3))ş      IF NUM(AMOUNT) AND NUM(GROSS.PROFIT) THENş         AMOUNT=ICONV(AMOUNT,'MD2')ş         IF AMOUNT > 0 THENş            GROSS.PROFIT=ICONV(GROSS.PROFIT,'MD2')ş            IF SALESMAN <> LAST.SALESMAN THENş               LAST.SALESMAN=SALESMANş               SALESMAN.CNTR+=1ş               SALESMEN<1,SALESMAN.CNTR>=SALESMANş               AMOUNTS<1,SALESMAN.CNTR>=0ş               GROSS.PROFITS<1,SALESMAN.CNTR>=0ş             ENDş            AMOUNTS<1,SALESMAN.CNTR>+=AMOUNTş            GROSS.PROFITS<1,SALESMAN.CNTR>+=GROSS.PROFITş          ENDş       ENDş    ENDş NEXT ROW.NOşW$BAR.YMEMO='Total Sales and Gross Profit'şW$BAR.CAPTION = "Total Year to Date Sales of ":OCONV(SUM(AMOUNTS),'MD2,$'):" and Gross Profit of ":OCONV(SUM(GROSS.PROFITS),'MD2,$'):" by Salesman"şIF SALESMAN.CNTR > 10 THENş   W$TYPE='FCMSBAR2D'ş   W$CHART.HEIGHT = 200 + (25 * SALESMAN.CNTR)ş END ELSEş   W$TYPE='FCMSCOLUMN2D'ş ENDşVALUE.CNTR=0şFOR AMT.CNTR = 1 TO SALESMAN.CNTRş   AMOUNT=AMOUNTS<1,AMT.CNTR>ş   GROSS.PROFIT=GROSS.PROFITS<1,AMT.CNTR>ş   IF AMOUNT THENş      VALUE.CNTR+=1ş      SALESMAN=SALESMEN<1,AMT.CNTR>ş      W$BAR.XLABELS<1,VALUE.CNTR>=SALESMANş      W$BAR.VALUES<1,VALUE.CNTR>=OCONV(AMOUNT,'MD2')ş      W$BAR.VALUES<2,VALUE.CNTR>=OCONV(GROSS.PROFIT,'MD2')ş    ENDş NEXT AMT.CNTRşRETURNş*şYEAR.TO.YEAR.BY.SALESMAN:ş*şGOSUB VERIFY.CURRENT.DATAşW$TYPE='FCMSBAR2D'şTHIS.YEAR=OCONV(DATE(),'D4-')[7,4]şFIRST.YEAR=THIS.YEAR-4şYEARS=''şFOR YEAR.NO = FIRST.YEAR TO THIS.YEARş   YEARS<-1>=YEAR.NOş NEXT YEAR.NOş*şSTACKED.1='SELECT DASHBOARD.CLOSING.STATS WITH YYYY GE "':FIRST.YEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY SALESMAN BY YYYY BREAK-ON SALESMAN PIPE BREAK-ON YYYY PIPE TOTAL AMOUNT ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE ':FIRST.YEARş   GOSUB DISPLAY.ERRORş   RETURNş ENDş**WRITE REPORT ON FI.MVDB.SUBS, 'REPORT.RETURNED'şYEAR.SALESMAN.TOTALS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şSALESMEN=''şSALESMEN.CNTR=0şYEAR.TOTALS=''şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   NUM.PIPES=COUNT(ROW,'|')ş   IF INDEX(ROW,'|',1) THENş      IF COUNT(ROW,'|') < 2 THEN YEAR='' ELSE YEAR=TRIM(FIELD(ROW,'|',2))ş      SALESMAN=TRIM(FIELD(ROW,'|',1))şIF YEAR = '' AND SALESMAN <> '' THEN; *      IF SALESMAN <> '' THENş         IF SUM(YEAR.TOTALS) THENş            LOCATE SALESMAN IN SALESMEN SETTING SALESMAN.POS ELSEş               SALESMEN.CNTR+=1ş               SALESMEN<SALESMEN.CNTR>=SALESMANş               SALESMAN.POS=SALESMEN.CNTRş             ENDş            YEAR.SALESMAN.TOTALS<SALESMAN.POS>=YEAR.TOTALSş          ENDş         YEAR.TOTALS=''ş       ENDş      IF YEAR <> '' THENş         LOCATE YEAR IN YEARS SETTING YEAR.POS ELSE YEAR.POS=0ş         IF YEAR.POS THENş            AMOUNT=TRIM(FIELD(ROW,'|',3))ş            IF NUM(AMOUNT) THENş               AMOUNT=ICONV(AMOUNT,'MD2')ş               YEAR.TOTALS<1,YEAR.POS>+=AMOUNTş             ENDş          ENDş       ENDş    ENDş NEXT ROW.NOş*şFOR I = 1 TO 5ş   W$BAR.LABELS<I> = YEARS<I>ş*   W$BAR.LABEL.OPTS<I> = "showValues='0'"ş NEXT Iş*şW$BAR.CAPTION = "Year to Year Sales by Salesman"şW$BAR.XMEMO = "Salesman"şW$BAR.YMEMO = "Sales"şW$CHART.HEIGHT = 200 + (70 * SALESMEN.CNTR)ş*şFOR SALESMAN.NO = 1 TO SALESMEN.CNTRş   FOR YEAR.NO = 1 TO 5ş      SALESMAN.YEAR.AMT=YEAR.SALESMAN.TOTALS<SALESMAN.NO,YEAR.NO>+0ş      IF SALESMAN.YEAR.AMT < 0 THEN SALESMAN.YEAR.AMT=0ş      W$BAR.VALUES<YEAR.NO,SALESMAN.NO>=OCONV(SALESMAN.YEAR.AMT,'MD2')ş    NEXT YEAR.NOş   W$BAR.XLABELS<1,SALESMAN.NO>=SALESMEN<SALESMAN.NO>ş NEXT SALESMAN.NOşRETURNş*şYEAR.TO.YEAR.GP.BY.SALESMAN:ş*şGOSUB VERIFY.CURRENT.DATAşW$TYPE='FCMSBAR2D'şTHIS.YEAR=OCONV(DATE(),'D4-')[7,4]şFIRST.YEAR=THIS.YEAR-4şYEARS=''şFOR YEAR.NO = FIRST.YEAR TO THIS.YEARş   YEARS<-1>=YEAR.NOş NEXT YEAR.NOş*şSTACKED.1='SELECT DASHBOARD.CLOSING.STATS WITH YYYY GE "':FIRST.YEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY SALESMAN BY YYYY BREAK-ON SALESMAN PIPE BREAK-ON YYYY PIPE TOTAL GROSS.PROFIT ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE ':FIRST.YEARş   GOSUB DISPLAY.ERRORş   RETURNş ENDşWRITE STACKED.1:@AM:STACKED.2 ON FI.MVDB.SUBS, 'YEAR.TO.YEAR.CMND'şWRITE REPORT ON FI.MVDB.SUBS, 'REPORT.RETURNED'şYEAR.SALESMAN.TOTALS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şSALESMEN=''şSALESMEN.CNTR=0şYEAR.TOTALS=''şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      IF COUNT(ROW,'|') < 2 THEN YEAR='' ELSE YEAR=TRIM(FIELD(ROW,'|',2))ş      SALESMAN=TRIM(FIELD(ROW,'|',1))şIF YEAR = '' AND SALESMAN <> '' THEN; *      IF SALESMAN <> '' THENş         IF SUM(YEAR.TOTALS) THENş            LOCATE SALESMAN IN SALESMEN SETTING SALESMAN.POS ELSEş               SALESMEN.CNTR+=1ş               SALESMEN<SALESMEN.CNTR>=SALESMANş               SALESMAN.POS=SALESMEN.CNTRş             ENDş            YEAR.SALESMAN.TOTALS<SALESMAN.POS>=YEAR.TOTALSş          ENDş         YEAR.TOTALS=''ş       ENDş      IF YEAR <> '' THENş         LOCATE YEAR IN YEARS SETTING YEAR.POS ELSE YEAR.POS=0ş         IF YEAR.POS THENş            GROSS.PROFIT=TRIM(FIELD(ROW,'|',3))ş            IF NUM(GROSS.PROFIT) THENş               GROSS.PROFIT=ICONV(GROSS.PROFIT,'MD2')ş               YEAR.TOTALS<1,YEAR.POS>+=GROSS.PROFITş             ENDş          ENDş       ENDş    ENDşWRITE SALESMEN ON FI.MVDB.SUBS, 'SALESMEN'şWRITE YEAR.SALESMAN.TOTALS ON FI.MVDB.SUBS, 'YEAR.SALESMAN.TOTALS'şWRITE YEAR.TOTALS ON FI.MVDB.SUBS, 'YEAR.TOTALS'ş NEXT ROW.NOş*şFOR I = 1 TO 5ş   W$BAR.LABELS<I> = YEARS<I>ş*   W$BAR.LABEL.OPTS<I> = "showValues='0'"ş NEXT Iş*şW$BAR.CAPTION = "Year to Year Gross Profit by Salesman"şW$BAR.XMEMO = "Salesman"şW$BAR.YMEMO = "Gross Profit"şW$CHART.HEIGHT = 200 + (70 * SALESMEN.CNTR)ş*şFOR SALESMAN.NO = 1 TO SALESMEN.CNTRş   FOR YEAR.NO = 1 TO 5ş      SALESMAN.YEAR.AMT=YEAR.SALESMAN.TOTALS<SALESMAN.NO,YEAR.NO>+0ş      IF SALESMAN.YEAR.AMT < 0 THEN SALESMAN.YEAR.AMT=0ş      W$BAR.VALUES<YEAR.NO,SALESMAN.NO>=OCONV(SALESMAN.YEAR.AMT,'MD2')ş    NEXT YEAR.NOş   W$BAR.XLABELS<1,SALESMAN.NO>=SALESMEN<SALESMAN.NO>ş NEXT SALESMAN.NOşRETURNş*ş*şMTD.SALES.BY.BRANCH:ş*ş*OTODAY=OCONV(DATE(),'D4-')şOMO=OTODAY[1,2]şODAY=OTODAY[4,2]+0şOYEAR=OTODAY[7,4]şIF ODAY = 1 THENş   OMO=OMO-1ş   IF NOT(OMO) THENş      OMO=12ş      OYEAR=OYEAR-1ş    ENDş ENDşDATE.SELECT.STRING=''şISTART=ICONV(OMO:'-1-':OYEAR,'D')şIEND=DATE()şNUM.COLS=IEND-ISTART+1şFOR IDATE = ISTART TO IENDş   DATE.SELECT.STRING:=' "':OCONV(IDATE,'D2-'):'"'ş NEXT IDATEş**WRITE DATE.SELECT.STRING ON FI.MVDB.SUBS, 'DATE.SELECT.STRING'şSTACKED.1='SELECT ':SALES.FILE.PATH:' WITH ':SALE.DATE.DICT:' = ':DATE.SELECT.STRINGşSTACKED.2='SORT ':SALES.FILE.PATH:' BY ':BRANCH.DICT:' BREAK-ON ':BRANCH.DICT:' PIPE TOTAL ':SALE.AMOUNT.DICT:' PIPE TOTAL ':COST.OF.SALE.AMOUNT.DICT:' ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE BEGINNING OF MONTH'ş   GOSUB DISPLAY.ERRORş   RETURNş ENDşW$BAR.XMEMO = "Branch"şBRANCHES=''şBRANCH.CNTR=0şLAST.BRANCH=''şAMOUNTS=''şGROSS.PROFITS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      BRANCH=TRIM(FIELD(ROW,'|',1))ş      AMOUNT=ICONV(TRIM(FIELD(ROW,'|',2)),'MD2')ş      COST.OF.SALE=ICONV(TRIM(FIELD(ROW,'|',3)),'MD2')ş      IF NUM(AMOUNT) AND NUM(COST.OF.SALE) THENş         IF AMOUNT > 0 THENş            IF BRANCH <> LAST.BRANCH THENş               LAST.BRANCH=BRANCHş               BRANCH.CNTR+=1ş               BRANCHES<1,BRANCH.CNTR>=BRANCHş               AMOUNTS<1,BRANCH.CNTR>=0ş               GROSS.PROFITS<1,BRANCH.CNTR>=0ş             ENDş            GROSS.PROFIT=AMOUNT-COST.OF.SALEş            AMOUNTS<1,BRANCH.CNTR>+=AMOUNTş            GROSS.PROFITS<1,BRANCH.CNTR>+=GROSS.PROFITş          ENDş       ENDş    ENDş NEXT ROW.NOşW$BAR.YMEMO='Total Sales and Gross Profit'şW$BAR.CAPTION = "Total Month to Date Sales of ":OCONV(SUM(AMOUNTS),'MD2,$'):" and Gross Profit of ":OCONV(SUM(GROSS.PROFITS),'MD2,$'):" by Branch"şNUM.AMOUNTS=DCOUNT(AMOUNTS,CHAR(253))şIF BRANCH.CNTR > 10 THENş   W$TYPE='FCMSBAR2D'ş   W$CHART.HEIGHT = 200 + (25 * BRANCH.CNTR)ş END ELSEş   W$TYPE='FCMSCOLUMN2D'ş ENDşW$BAR.LABELS<1>='Total Sales'şW$BAR.LABELS<2>='Gross Profit'şVALUE.CNTR=0şFOR AMT.CNTR = 1 TO NUM.AMOUNTSş   AMOUNT=AMOUNTS<1,AMT.CNTR>ş   IF AMOUNT > 0 THENş      GROSS.PROFIT=GROSS.PROFITS<1,AMT.CNTR>ş      VALUE.CNTR+=1ş      BRANCH=BRANCHES<1,AMT.CNTR>ş      W$BAR.XLABELS<1,VALUE.CNTR>=BRANCHş      W$BAR.VALUES<1,VALUE.CNTR>=OCONV(AMOUNT,'MD2')ş      W$BAR.VALUES<2,VALUE.CNTR>=OCONV(GROSS.PROFIT,'MD2')ş    ENDş NEXT AMT.CNTRş**WRITE BRANCHES:CHAR(254):AMOUNTS ON FI.MVDB.SUBS, 'MTD.SALES.TEST'şRETURNş*şYTD.SALES.BY.BRANCH:ş*şGOSUB VERIFY.CURRENT.DATAş*OTODAY=OCONV(DATE(),'D4-')şYTD.MO=OTODAY[1,2]+0şOYEAR=OTODAY[7,4]şSTACKED.1= 'SELECT DASHBOARD.CLOSING.STATS WITH YYYY = "':OYEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY BRANCH BREAK-ON BRANCH PIPE TOTAL AMOUNT PIPE TOTAL GROSS.PROFIT ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE BEGINNING OF YEAR'ş   GOSUB DISPLAY.ERRORş   RETURNş ENDşW$BAR.XMEMO = "Branch"şW$BAR.LABELS<1>='Total Sales'şW$BAR.LABELS<2>='Gross Profit'ş**WRITE REPORT ON FI.MVDB.SUBS, 'REPORT.RETURNED'şBRANCHES=''şBRANCH.CNTR=0şLAST.BRANCH=''şAMOUNTS=''şGROSS.PROFITS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      BRANCH=TRIM(FIELD(ROW,'|',1))ş      AMOUNT=TRIM(FIELD(ROW,'|',2))ş      GROSS.PROFIT=TRIM(FIELD(ROW,'|',3))ş      IF NUM(AMOUNT) AND NUM(GROSS.PROFIT) THENş         AMOUNT=ICONV(AMOUNT,'MD2')ş         IF AMOUNT > 0 THENş            GROSS.PROFIT=ICONV(GROSS.PROFIT,'MD2')ş            IF BRANCH <> LAST.BRANCH THENş               LAST.BRANCH=BRANCHş               BRANCH.CNTR+=1ş               BRANCHES<1,BRANCH.CNTR>=BRANCHş               AMOUNTS<1,BRANCH.CNTR>=0ş               GROSS.PROFITS<1,BRANCH.CNTR>=0ş             ENDş            AMOUNTS<1,BRANCH.CNTR>+=AMOUNTş            GROSS.PROFITS<1,BRANCH.CNTR>+=GROSS.PROFITş          ENDş       ENDş    ENDş NEXT ROW.NOşW$BAR.YMEMO='Total Sales and Gross Profit'şW$BAR.CAPTION = "Total Year to Date Sales of ":OCONV(SUM(AMOUNTS),'MD2,$'):" and Gross Profit of ":OCONV(SUM(GROSS.PROFITS),'MD2,$'):" by Branch"şIF BRANCH.CNTR > 10 THENş   W$TYPE='FCMSBAR2D'ş   W$CHART.HEIGHT = 200 + (25 * BRANCH.CNTR)ş END ELSEş   W$TYPE='FCMSCOLUMN2D'ş ENDşVALUE.CNTR=0şFOR AMT.CNTR = 1 TO BRANCH.CNTRş   AMOUNT=AMOUNTS<1,AMT.CNTR>ş   IF AMOUNT THENş      VALUE.CNTR+=1ş      BRANCH=BRANCHES<1,AMT.CNTR>ş      W$BAR.XLABELS<1,VALUE.CNTR>=BRANCHş      W$BAR.VALUES<1,VALUE.CNTR>=OCONV(AMOUNT,'MD2')ş      W$BAR.VALUES<2,VALUE.CNTR>=OCONV(GROSS.PROFITS<1,AMT.CNTR>,'MD2')ş    ENDş NEXT AMT.CNTRş**WRITE DATES:CHAR(254):AMOUNTS ON FI.MVDB.SUBS, 'YTD.SALES.TEST'şRETURNş*şYEAR.TO.YEAR.BY.BRANCH:ş*şGOSUB VERIFY.CURRENT.DATAşW$TYPE='FCMSBAR2D'şTHIS.YEAR=OCONV(DATE(),'D4-')[7,4]şFIRST.YEAR=THIS.YEAR-4şYEARS=''şFOR YEAR.NO = FIRST.YEAR TO THIS.YEARş   YEARS<-1>=YEAR.NOş NEXT YEAR.NOş*şSTACKED.1='SELECT DASHBOARD.CLOSING.STATS WITH YYYY GE "':FIRST.YEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY BRANCH BY YYYY BREAK-ON BRANCH PIPE BREAK-ON YYYY PIPE TOTAL AMOUNT PIPE TOTAL GROSS.PROFIT ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE ':FIRST.YEARş   GOSUB DISPLAY.ERRORş   RETURNş ENDş**WRITE REPORT ON FI.MVDB.SUBS, 'REPORT.RETURNED'şYEAR.BRANCH.TOTALS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şBRANCHES=''şBRANCHES.CNTR=0şYEAR.TOTALS=''şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      IF COUNT(ROW,'|') < 2 THEN YEAR='' ELSE YEAR=TRIM(FIELD(ROW,'|',2))ş      BRANCH=TRIM(FIELD(ROW,'|',1))şIF YEAR = '' AND BRANCH <> '' THEN; *      IF BRANCH <> '' THENş         IF SUM(YEAR.TOTALS) THENş            LOCATE BRANCH IN BRANCHES SETTING BRANCH.POS ELSEş               BRANCHES.CNTR+=1ş               BRANCHES<BRANCHES.CNTR>=BRANCHş               BRANCH.POS=BRANCHES.CNTRş             ENDş            YEAR.BRANCH.TOTALS<BRANCH.POS>=YEAR.TOTALSş          ENDş         YEAR.TOTALS=''ş       ENDş      IF YEAR <> '' THENş         LOCATE YEAR IN YEARS SETTING YEAR.POS ELSE YEAR.POS=0ş         IF YEAR.POS THENş            AMOUNT=TRIM(FIELD(ROW,'|',3))ş            GROSS.PROFIT=TRIM(FIELD(ROW,'|',4))ş            IF NUM(AMOUNT) AND NUM(GROSS.PROFIT) THENş               AMOUNT=ICONV(AMOUNT,'MD2')ş               GROSS.PROFIT=ICONV(GROSS.PROFIT,'MD2')ş               YEAR.TOTALS<1,YEAR.POS>+=AMOUNTş             ENDş          ENDş       ENDş    ENDş NEXT ROW.NOş*şFOR I = 1 TO 5ş   W$BAR.LABELS<I> = YEARS<I>ş*   W$BAR.LABEL.OPTS<I> = "showValues='0'"ş NEXT Iş*şW$BAR.CAPTION = "Year to Year Sales by Branch"şW$BAR.XMEMO = "Branch"şW$BAR.YMEMO = "Total Sales and Gross Profit"şW$CHART.HEIGHT = 200 + (50 * BRANCHES.CNTR)ş*şFOR BRANCH.NO = 1 TO BRANCHES.CNTRş   FOR YEAR.NO = 1 TO 5ş      BRANCH.YEAR.AMT=YEAR.BRANCH.TOTALS<BRANCH.NO,YEAR.NO>+0ş      IF BRANCH.YEAR.AMT < 0 THEN BRANCH.YEAR.AMT=0ş      W$BAR.VALUES<YEAR.NO,BRANCH.NO>=OCONV(BRANCH.YEAR.AMT,'MD2')ş    NEXT YEAR.NOş   W$BAR.XLABELS<1,BRANCH.NO>=BRANCHES<BRANCH.NO>ş NEXT BRANCH.NOşRETURNş*şYEAR.TO.YEAR.GP.BY.BRANCH:ş*şGOSUB VERIFY.CURRENT.DATAşW$TYPE='FCMSBAR2D'şTHIS.YEAR=OCONV(DATE(),'D4-')[7,4]şFIRST.YEAR=THIS.YEAR-4şYEARS=''şFOR YEAR.NO = FIRST.YEAR TO THIS.YEARş   YEARS<-1>=YEAR.NOş NEXT YEAR.NOş*şSTACKED.1='SELECT DASHBOARD.CLOSING.STATS WITH YYYY GE "':FIRST.YEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY BRANCH BY YYYY BREAK-ON BRANCH PIPE BREAK-ON YYYY PIPE TOTAL GROSS.PROFIT ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE ':FIRST.YEARş   GOSUB DISPLAY.ERRORş   RETURNş ENDşYEAR.BRANCH.TOTALS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şBRANCHES=''şBRANCHES.CNTR=0şYEAR.TOTALS=''şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      IF COUNT(ROW,'|') < 2 THEN YEAR='' ELSE YEAR=TRIM(FIELD(ROW,'|',2))ş      BRANCH=TRIM(FIELD(ROW,'|',1))şIF YEAR = '' AND BRANCH <> '' THEN; *      IF BRANCH <> '' THENş         IF SUM(YEAR.TOTALS) THENş            LOCATE BRANCH IN BRANCHES SETTING BRANCH.POS ELSEş               BRANCHES.CNTR+=1ş               BRANCHES<BRANCHES.CNTR>=BRANCHş               BRANCH.POS=BRANCHES.CNTRş             ENDş            YEAR.BRANCH.TOTALS<BRANCH.POS>=YEAR.TOTALSş          ENDş         YEAR.TOTALS=''ş       ENDş      IF YEAR <> '' THENş         LOCATE YEAR IN YEARS SETTING YEAR.POS ELSE YEAR.POS=0ş         IF YEAR.POS THENş            GROSS.PROFIT=TRIM(FIELD(ROW,'|',3))ş            IF NUM(GROSS.PROFIT) THENş               GROSS.PROFIT=ICONV(GROSS.PROFIT,'MD2')ş               YEAR.TOTALS<1,YEAR.POS>+=GROSS.PROFITş             ENDş          ENDş       ENDş    ENDş NEXT ROW.NOş*şFOR I = 1 TO 5ş   W$BAR.LABELS<I> = YEARS<I>ş*   W$BAR.LABEL.OPTS<I> = "showValues='0'"ş NEXT Iş*şW$BAR.CAPTION = "Year to Year Gross Profit by Branch"şW$BAR.XMEMO = "Branch"şW$BAR.YMEMO = "Gross Profit"şW$CHART.HEIGHT = 200 + (70 * BRANCHES.CNTR)ş*şFOR BRANCH.NO = 1 TO BRANCHES.CNTRş   FOR YEAR.NO = 1 TO 5ş      BRANCH.YEAR.AMT=YEAR.BRANCH.TOTALS<BRANCH.NO,YEAR.NO>+0ş      IF BRANCH.YEAR.AMT < 0 THEN BRANCH.YEAR.AMT=0ş      W$BAR.VALUES<YEAR.NO,BRANCH.NO>=OCONV(BRANCH.YEAR.AMT,'MD2')ş    NEXT YEAR.NOş   W$BAR.XLABELS<1,BRANCH.NO>=BRANCHES<BRANCH.NO>ş NEXT BRANCH.NOşRETURNş*şMTD.SALES.BY.REGION:ş*ş*OTODAY=OCONV(DATE(),'D4-')şOMO=OTODAY[1,2]şODAY=OTODAY[4,2]+0şOYEAR=OTODAY[7,4]şIF ODAY = 1 THENş   OMO=OMO-1ş   IF NOT(OMO) THENş      OMO=12ş      OYEAR=OYEAR-1ş    ENDş ENDşDATE.SELECT.STRING=''şISTART=ICONV(OMO:'-1-':OYEAR,'D')şIEND=DATE()şNUM.COLS=IEND-ISTART+1şFOR IDATE = ISTART TO IENDş   DATE.SELECT.STRING:=' "':OCONV(IDATE,'D2-'):'"'ş NEXT IDATEş**WRITE DATE.SELECT.STRING ON FI.MVDB.SUBS, 'DATE.SELECT.STRING'şSTACKED.1='SELECT ':SALES.FILE.PATH:' WITH ':SALE.DATE.DICT:' = ':DATE.SELECT.STRINGşSTACKED.2='SORT ':SALES.FILE.PATH:' BY ':REGION.DICT:' BREAK-ON ':REGION.DICT:' PIPE TOTAL ':SALE.AMOUNT.DICT:' PIPE TOTAL ':COST.OF.SALE.AMOUNT.DICT:' ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE BEGINNING OF MONTH'ş   GOSUB DISPLAY.ERRORş   RETURNş ENDşW$BAR.XMEMO = "REGION"şREGIONS=''şREGION.CNTR=0şLAST.REGION=''şAMOUNTS=''şGROSS.PROFITS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      REGION=TRIM(FIELD(ROW,'|',1))ş      AMOUNT=ICONV(TRIM(FIELD(ROW,'|',2)),'MD2')ş      COST.OF.SALE=ICONV(TRIM(FIELD(ROW,'|',3)),'MD2')ş      IF NUM(AMOUNT) AND NUM(COST.OF.SALE) THENş         IF AMOUNT > 0 THENş            IF REGION <> LAST.REGION THENş               LAST.REGION=REGIONş               REGION.CNTR+=1ş               REGIONS<1,REGION.CNTR>=REGIONş               AMOUNTS<1,REGION.CNTR>=0ş               GROSS.PROFITS<1,REGION.CNTR>=0ş             ENDş            GROSS.PROFIT=AMOUNT-COST.OF.SALEş            AMOUNTS<1,REGION.CNTR>+=AMOUNTş            GROSS.PROFITS<1,REGION.CNTR>+=GROSS.PROFITş          ENDş       ENDş    ENDş NEXT ROW.NOşW$BAR.YMEMO='Total Sales and Gross Profit'şW$BAR.CAPTION = "Total Month to Date Sales of ":OCONV(SUM(AMOUNTS),'MD2,$'):" and Gross Profit of ":OCONV(SUM(GROSS.PROFITS),'MD2,$'):" by Region"şNUM.AMOUNTS=DCOUNT(AMOUNTS,CHAR(253))şIF REGION.CNTR > 10 THENş   W$TYPE='FCMSBAR2D'ş   W$CHART.HEIGHT = 200 + (25 * REGION.CNTR)ş END ELSEş   W$TYPE='FCMSCOLUMN2D'ş ENDşW$BAR.LABELS<1>='Total Sales'şW$BAR.LABELS<2>='Gross Profit'şVALUE.CNTR=0şFOR AMT.CNTR = 1 TO NUM.AMOUNTSş   AMOUNT=AMOUNTS<1,AMT.CNTR>ş   IF AMOUNT > 0 THENş      GROSS.PROFIT=GROSS.PROFITS<1,AMT.CNTR>ş      VALUE.CNTR+=1ş      REGION=REGIONS<1,AMT.CNTR>ş      W$BAR.XLABELS<1,VALUE.CNTR>=REGIONş      W$BAR.VALUES<1,VALUE.CNTR>=OCONV(AMOUNT,'MD2')ş      W$BAR.VALUES<2,VALUE.CNTR>=OCONV(GROSS.PROFIT,'MD2')ş    ENDş NEXT AMT.CNTRş**WRITE REGIONS:CHAR(254):AMOUNTS ON FI.MVDB.SUBS, 'MTD.SALES.TEST'şRETURNş*şYTD.SALES.BY.REGION:ş*şGOSUB VERIFY.CURRENT.DATAş*OTODAY=OCONV(DATE(),'D4-')şYTD.MO=OTODAY[1,2]+0şOYEAR=OTODAY[7,4]şSTACKED.1= 'SELECT DASHBOARD.CLOSING.STATS WITH YYYY = "':OYEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY REGION BREAK-ON REGION PIPE TOTAL AMOUNT PIPE TOTAL GROSS.PROFIT ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE BEGINNING OF YEAR'ş   GOSUB DISPLAY.ERRORş   RETURNş ENDşW$BAR.XMEMO = "Region"şW$BAR.LABELS<1>='Total Sales'şW$BAR.LABELS<2>='Gross Profit'ş**WRITE REPORT ON FI.MVDB.SUBS, 'REPORT.RETURNED'şREGIONS=''şREGION.CNTR=0şLAST.REGION=''şAMOUNTS=''şGROSS.PROFITS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      REGION=TRIM(FIELD(ROW,'|',1))ş      AMOUNT=TRIM(FIELD(ROW,'|',2))ş      GROSS.PROFIT=TRIM(FIELD(ROW,'|',3))ş      IF NUM(AMOUNT) AND NUM(GROSS.PROFIT) THENş         AMOUNT=ICONV(AMOUNT,'MD2')ş         IF AMOUNT > 0 THENş            GROSS.PROFIT=ICONV(GROSS.PROFIT,'MD2')ş            IF REGION <> LAST.REGION THENş               LAST.REGION=REGIONş               REGION.CNTR+=1ş               REGIONS<1,REGION.CNTR>=REGIONş               AMOUNTS<1,REGION.CNTR>=0ş               GROSS.PROFITS<1,REGION.CNTR>=0ş             ENDş            AMOUNTS<1,REGION.CNTR>+=AMOUNTş            GROSS.PROFITS<1,REGION.CNTR>+=GROSS.PROFITş          ENDş       ENDş    ENDş NEXT ROW.NOşW$BAR.YMEMO='Total Sales and Gross Profit'şW$BAR.CAPTION = "Total Year to Date Sales of ":OCONV(SUM(AMOUNTS),'MD2,$'):" and Gross Profit of ":OCONV(SUM(GROSS.PROFITS),'MD2,$'):" by Region"şIF REGION.CNTR > 10 THENş   W$TYPE='FCMSBAR2D'ş   W$CHART.HEIGHT = 200 + (25 * REGION.CNTR)ş END ELSEş   W$TYPE='FCMSCOLUMN2D'ş ENDşVALUE.CNTR=0şFOR AMT.CNTR = 1 TO REGION.CNTRş   AMOUNT=AMOUNTS<1,AMT.CNTR>ş   IF AMOUNT THENş      VALUE.CNTR+=1ş      REGION=REGIONS<1,AMT.CNTR>ş      W$BAR.XLABELS<1,VALUE.CNTR>=REGIONş      W$BAR.VALUES<1,VALUE.CNTR>=OCONV(AMOUNT,'MD2')ş      W$BAR.VALUES<2,VALUE.CNTR>=OCONV(GROSS.PROFITS<1,AMT.CNTR>,'MD2')ş    ENDş NEXT AMT.CNTRş**WRITE DATES:CHAR(254):AMOUNTS ON FI.MVDB.SUBS, 'YTD.SALES.TEST'şRETURNş*ş*şYEAR.TO.YEAR.BY.REGION:ş*şGOSUB VERIFY.CURRENT.DATAşW$TYPE='FCMSBAR2D'şTHIS.YEAR=OCONV(DATE(),'D4-')[7,4]şFIRST.YEAR=THIS.YEAR-4şYEARS=''şFOR YEAR.NO = FIRST.YEAR TO THIS.YEARş   YEARS<-1>=YEAR.NOş NEXT YEAR.NOş*şSTACKED.1='SELECT DASHBOARD.CLOSING.STATS WITH YYYY GE "':FIRST.YEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY REGION BY YYYY BREAK-ON REGION PIPE BREAK-ON YYYY PIPE TOTAL AMOUNT PIPE TOTAL GROSS.PROFIT ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE ':FIRST.YEARş   GOSUB DISPLAY.ERRORş   RETURNş ENDşYEAR.REGION.TOTALS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şREGIONS=''şREGIONS.CNTR=0şYEAR.TOTALS=''şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      IF COUNT(ROW,'|') < 2 THEN YEAR='' ELSE YEAR=TRIM(FIELD(ROW,'|',2))ş      REGION=TRIM(FIELD(ROW,'|',1))şIF YEAR = '' AND REGION <> '' THEN; *      IF REGION <> '' THENş         IF SUM(YEAR.TOTALS) THENş            LOCATE REGION IN REGIONS SETTING REGION.POS ELSEş               REGIONS.CNTR+=1ş               REGIONS<REGIONS.CNTR>=REGIONş               REGION.POS=REGIONS.CNTRş             ENDş            YEAR.REGION.TOTALS<REGION.POS>=YEAR.TOTALSş          ENDş         YEAR.TOTALS=''ş       ENDş      IF YEAR <> '' THENş         LOCATE YEAR IN YEARS SETTING YEAR.POS ELSE YEAR.POS=0ş         IF YEAR.POS THENş            AMOUNT=TRIM(FIELD(ROW,'|',3))ş            IF NUM(AMOUNT) THENş               AMOUNT=ICONV(AMOUNT,'MD2')ş               YEAR.TOTALS<1,YEAR.POS>+=AMOUNTş             ENDş          ENDş       ENDş    ENDş NEXT ROW.NOş*şFOR I = 1 TO 5ş   W$BAR.LABELS<I> = YEARS<I>ş*   W$BAR.LABEL.OPTS<I> = "showValues='0'"ş NEXT Iş*şW$BAR.CAPTION = "Year to Year Sales by Region"şW$BAR.XMEMO = "Region"şW$BAR.YMEMO = "Sales"şW$CHART.HEIGHT = 200 + (50 * REGIONS.CNTR)ş*şFOR REGION.NO = 1 TO REGIONS.CNTRş   FOR YEAR.NO = 1 TO 5ş      REGION.YEAR.AMT=YEAR.REGION.TOTALS<REGION.NO,YEAR.NO>+0ş      IF REGION.YEAR.AMT < 0 THEN REGION.YEAR.AMT=0ş      W$BAR.VALUES<YEAR.NO,REGION.NO>=OCONV(REGION.YEAR.AMT,'MD2')ş    NEXT YEAR.NOş   W$BAR.XLABELS<1,REGION.NO>=REGIONS<REGION.NO>ş NEXT REGION.NOşRETURNş*şYEAR.TO.YEAR.GP.BY.REGION:ş*şGOSUB VERIFY.CURRENT.DATAşW$TYPE='FCMSBAR2D'şTHIS.YEAR=OCONV(DATE(),'D4-')[7,4]şFIRST.YEAR=THIS.YEAR-4şYEARS=''şFOR YEAR.NO = FIRST.YEAR TO THIS.YEARş   YEARS<-1>=YEAR.NOş NEXT YEAR.NOş*şSTACKED.1='SELECT DASHBOARD.CLOSING.STATS WITH YYYY GE "':FIRST.YEAR:'"'şSTACKED.2='SORT DASHBOARD.CLOSING.STATS BY REGION BY YYYY BREAK-ON REGION PIPE BREAK-ON YYYY PIPE TOTAL GROSS.PROFIT ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şIF NOT(SYSTEM.11) THENş   ERROR.MSG='NO SALES CLOSED SINCE ':FIRST.YEARş   GOSUB DISPLAY.ERRORş   RETURNş ENDş**WRITE REPORT ON FI.MVDB.SUBS, 'REPORT.RETURNED'şYEAR.REGION.TOTALS=''şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şREGIONS=''şREGIONS.CNTR=0şYEAR.TOTALS=''şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      IF COUNT(ROW,'|') < 2 THEN YEAR='' ELSE YEAR=TRIM(FIELD(ROW,'|',2))ş      REGION=TRIM(FIELD(ROW,'|',1))şIF YEAR = '' AND REGION <> '' THEN; *      IF REGION <> '' THENş         IF SUM(YEAR.TOTALS) THENş            LOCATE REGION IN REGIONS SETTING REGION.POS ELSEş               REGIONS.CNTR+=1ş               REGIONS<REGIONS.CNTR>=REGIONş               REGION.POS=REGIONS.CNTRş             ENDş            YEAR.REGION.TOTALS<REGION.POS>=YEAR.TOTALSş          ENDş         YEAR.TOTALS=''ş       ENDş      IF YEAR <> '' THENş         LOCATE YEAR IN YEARS SETTING YEAR.POS ELSE YEAR.POS=0ş         IF YEAR.POS THENş            GROSS.PROFIT=TRIM(FIELD(ROW,'|',3))ş            IF NUM(GROSS.PROFIT) THENş               GROSS.PROFIT=ICONV(GROSS.PROFIT,'MD2')ş               YEAR.TOTALS<1,YEAR.POS>+=GROSS.PROFITş             ENDş          ENDş       ENDş    ENDş NEXT ROW.NOş*şFOR I = 1 TO 5ş   W$BAR.LABELS<I> = YEARS<I>ş*   W$BAR.LABEL.OPTS<I> = "showValues='0'"ş NEXT Iş*şW$BAR.CAPTION = "Year to Year Gross Profit by Region"şW$BAR.XMEMO = "Region"şW$BAR.YMEMO = "Gross Profit"şW$CHART.HEIGHT = 200 + (70 * REGIONS.CNTR)ş*şFOR REGION.NO = 1 TO REGIONS.CNTRş   FOR YEAR.NO = 1 TO 5ş      REGION.YEAR.AMT=YEAR.REGION.TOTALS<REGION.NO,YEAR.NO>+0ş      IF REGION.YEAR.AMT < 0 THEN REGION.YEAR.AMT=0ş      W$BAR.VALUES<YEAR.NO,REGION.NO>=OCONV(REGION.YEAR.AMT,'MD2')ş    NEXT YEAR.NOş   W$BAR.XLABELS<1,REGION.NO>=REGIONS<REGION.NO>ş NEXT REGION.NOşRETURNş*şVERIFY.CURRENT.DATA:ş*şREAD LAST.UPDATE FROM FI.DICT.DASHBOARD.CLOSING.STATS, '*LAST.UPDATE' ELSE LAST.UPDATE=0şREAD LAST.UPDATED FROM FI.DICT.DASHBOARD.CLOSING.STATS, '*LAST.UPDATED' ELSE LAST.UPDATED=0şCUR.DATE=DATE(); CUR.TIME=TIME()şCUR.TIME=FIELD(CUR.TIME,'.',1)şLEN.CUR.TIME=LEN(CUR.TIME)şCUR.TIME=STR('0',5-LEN.CUR.TIME):CUR.TIMEşCUR.DATE.TIME=CUR.DATE:CUR.TIMEşDELTA.DATE.TIME=CUR.DATE.TIME-LAST.UPDATEDşIF DELTA.DATE.TIME > 900 THENş   * REFRESH EVERY 15 MINUTESş   LAST.UPDATED='UPDATING'ş   BEGIN CASEş      CASE PLATFORM = 'D3' OR PLATFORM = 'JB'ş         EXECUTE "Z REFRESH.DASHBOARD.CLOSING.STATS" CAPTURING DUMMYş      CASE 1ş         EXECUTE "PHANTOM REFRESH.DASHBOARD.CLOSING.STATS" CAPTURING DUMMYş   END CASEş ENDşIF NOT(NUM(LAST.UPDATE)) THENş   IF INDEX(LAST.UPDATE,'UPDATING',1) THENş      LAST.UPDATE='Figures are currently updating.'ş      LAST.UPDATE<-1>='Try again in a couple of minutes.'ş    ENDş   MAX.LINES=DCOUNT(LAST.UPDATE,CHAR(254))ş   ERROR.MSG=''ş   FOR I = 1 TO MAX.LINESş      THIS.MSG=LAST.UPDATE<I>ş      IF ERROR.MSG <> '' THEN ERROR.MSG:='<br>'ş      ERROR.MSG:=THIS.MSGş    NEXT Iş   RETURN TO DISPLAY.ERRORş ENDşRETURNş*şGET.CURRENT.REPORT:ş*şBEGIN CASEş   CASE GET.REPORT.TYPE = 'SALES'ş       FI.DICT=FI.DICT.DASHBOARD.CLOSING.STATSş       LAST.DATE.INDICATOR='*LAST.UPDATE.SALES'ş       REPORT.STATS.ID='*CURRENT.SALES.STATS'şEND CASEş*ş** IF MORE THAN 10 MINUTES SINCE LAST UPDATE THEN REFRESH DATAş*şRECALC.REQUESTED=0şDATA.CURRENT=0şLOOPş   READ LAST.UPDATE FROM FI.DICT, LAST.DATE.INDICATOR ELSE LAST.UPDATE=''ş   IF NUM(LAST.UPDATE) THENş      CUR.TIME=OCONV(TIME(),'MT')ş      CONVERT ':' TO '' IN CUR.TIMEş      CUR.DATE.TIME=DATE():CUR.TIMEş      LAST.UPDATE.DELTA=CUR.DATE.TIME - LAST.UPDATEş      IF LAST.UPDATE.DELTA < 10 THEN DATA.CURRENT=1ş    ENDşUNTIL DATA.CURRENT DOş   IF NUM(LAST.UPDATE) THENş      IF NOT(RECALC.REQUESTED) THENş         BEGIN CASEş            CASE PLATFORM = 'D3' OR PLATFORM = 'JB'ş               EXECUTE "Z REFRESH.DASHBOARD.MTD.STATS ":REPORT.TYPE CAPTURING DUMMYş            CASE 1ş               EXECUTE "PHANTOM REFRESH.DASHBOARD.MTD.STATS ":REPORT.TYPE CAPTURING DUMMYş         END CASEş         RECALC.REQUESTED=1ş       ENDş    ENDş   SLEEP 2şREPEATşREAD REPORT.STATS.REC FROM FI.DICT, REPORT.STATS.ID ELSE REPORT.STATS.REC=''şWRITE REPORT.STATS.REC ON FI.MVDB.SUBS, 'REPORT.STATS.REC'şRETURNşEND0051AFREFRESH.DASHBOARD.MTD.STATSş0c2*ş* PHANTOM PROGRAM TO CALCULATE MTD SALES, AR, AP, AND NET INCOME NUMBERSş*şOPEN.ERRORS=''şOPEN '','MVDB.CONTROL' TO FI.MVDB.CONTROL ELSE OPEN.ERRORS:=' MVDB.CONTROL'şREAD PLATFORM FROM FI.MVDB.CONTROL, 'PLATFORM' ELSE PLATFORM='D3'şDIM SETUP.PARAMS(25)şIF PLATFORM = 'D3' THEN CMND=SENTENCE() ELSE CMND=@SENTENCEşCMND=TRIM(CMND)şOPTION.PARAM=FIELD(CMND,' ',DCOUNT(CMND,' '))şIF OPTION.PARAM = 'SALES' OR OPTION.PARAM = 'ALL' THENş   OPEN 'DICT','DASHBOARD.CLOSING.STATS' TO FI.DICT.CLOSING.STATS ELSE OPEN.ERRORS:=' DICT DASHBOARD.CLOSING.STATS'ş ENDşIF OPTION.PARAM <> 'SALES' THENş   OPEN 'DICT','DASHBOARD.BALANCES' TO FI.DICT.BALANCES ELSE OPEN.ERRORS:=' DICT DASHBOARD.BALANCES'ş ENDşEXECUTE "TERM 132,20000"ş*şBEGIN CASEş   CASE PLATFORM = 'UD'ş      EXECUTE.STACKED.CMNDS='UD.EXECUTE.STACKED.CMNDS'ş      MD.FILE.NAME='VOC'ş   CASE PLATFORM = 'UV'ş      EXECUTE.STACKED.CMNDS='UV.EXECUTE.STACKED.CMNDS'ş      MD.FILE.NAME='VOC'ş   CASE PLATFORM = 'QM'ş      EXECUTE.STACKED.CMNDS='EXECUTE.STACKED.CMNDS'ş      MD.FILE.NAME='VOC'ş   CASE 1ş      * D3 AND JBASE ARE THE SAMEş      EXECUTE.STACKED.CMNDS='EXECUTE.STACKED.CMNDS'ş      MD.FILE.NAME='MD'şEND CASEşOPEN '',MD.FILE.NAME TO FI.MD ELSEş   OPEN.ERRORS:=' ':MD.FILE.NAMEş ENDşIF OPEN.ERRORS <> '' THEN STOPş*şDAYS.AGO.60=DATE()-60şDAYS.AGO.1000=DATE()-1000şALL.GOOD=1şBEGIN CASEş   CASE OPTION.PARAM = 'SALES'; GOSUB CALC.SALESş   CASE OPTION.PARAM = 'AR'; GOSUB CALC.ARş   CASE OPTION.PARAM = 'AP'; GOSUB CALC.APş   CASE OPTION.PARAM = 'NET.INCOME'; GOSUB CALC.NET.INCOMEş   CASE OPTION.PARAM = 'ALL'ş      GOSUB CALC.SALESş      GOSUB CALC.ARş      GOSUB CALC.APş      GOSUB CALC.NET.INCOMEş      IF ALL.GOOD THENş         DICT.FILE=FI.DICT.BALANCESş         TIME.STAMP.TYPE='ALL'ş         GOSUB UPDATE.TIME.STAMPş       ENDş   CASE 1; NULLşEND CASEşSTOPş*şCALC.SALES:ş*şDICT.FILE=FI.DICT.CLOSING.STATSşMATREAD SETUP.PARAMS FROM FI.MVDB.CONTROL, 'PORTAL.SALES.REPORT.SETUP' ELSEş   MAT SETUP.PARAMS=''ş ENDşEQUATE ACCOUNT TO SETUP.PARAMS(1)şEQUATE REPORT.FILE TO SETUP.PARAMS(2)şEQUATE SALE.DATE.DICT TO SETUP.PARAMS(3)şEQUATE SALE.MONTH.DICT TO SETUP.PARAMS(4)şEQUATE SALE.YEAR.DICT TO SETUP.PARAMS(5)şEQUATE SALE.AMOUNT.DICT TO SETUP.PARAMS(6)şEQUATE COST.OF.SALE.AMOUNT.DICT TO SETUP.PARAMS(7)şEQUATE SALESMAN.DICT TO SETUP.PARAMS(8)şEQUATE BRANCH.DICT TO SETUP.PARAMS(9)şEQUATE REGION.DICT TO SETUP.PARAMS(10)şEQUATE SALE.DATE.AMC TO SETUP.PARAMS(11)şEQUATE SALE.AMOUNT.AMC TO SETUP.PARAMS(12)şEQUATE SALE.AMOUNT.CONV TO SETUP.PARAMS(13)şEQUATE SALE.AMOUNT.COOR TO SETUP.PARAMS(14)şEQUATE COST.OF.SALE.AMOUNT.AMC TO SETUP.PARAMS(15)şEQUATE COST.OF.SALE.AMOUNT.CONV TO SETUP.PARAMS(16)şEQUATE COST.OF.SALE.AMOUNT.COOR TO SETUP.PARAMS(17)şEQUATE SALESMAN.AMC TO SETUP.PARAMS(18)şEQUATE SALESMAN.TFILE TO SETUP.PARAMS(19)şEQUATE BRANCH.AMC TO SETUP.PARAMS(20)şEQUATE BRANCH.TFILE TO SETUP.PARAMS(21)şEQUATE REGION.AMC TO SETUP.PARAMS(22)şEQUATE REGION.TFILE TO SETUP.PARAMS(23)şOTODAY=OCONV(DATE(),'D4-')şOMO=OTODAY[1,2]şODAY=OTODAY[4,2]+0şOYEAR=OTODAY[7,4]şIF ODAY = 1 THENş   OMO=OMO-1ş   IF NOT(OMO) THENş      OMO=12ş      OYEAR=OYEAR-1ş    ENDş ENDşDATE.SELECT.STRING=''şISTART=ICONV(OMO:'-1-':OYEAR,'D')şIEND=DATE()şNUM.COLS=IEND-ISTART+1şFOR IDATE = ISTART TO IENDş   DATE.SELECT.STRING:=' "':OCONV(IDATE,'D2-'):'"'ş NEXT IDATEş**WRITE DATE.SELECT.STRING ON FI.MVDB.SUBS, 'DATE.SELECT.STRING'şSALES.FILE.PATH='SALES.FILE.PATH'ş**IF PLATFORM = 'UD' THENş**   QFILE.NAME=SALES.FILE.PATHş**   CALL CREATE.UD.QPOINTER(ACCOUNT,REPORT.FILE,QFILE.NAME,FI.QFILE)ş** END ELSEş**   MD.QFILE='Q'ş**   MD.QFILE<2>=ACCOUNTş**   MD.QFILE<3>=REPORT.FILEş**   WRITE MD.QFILE ON FI.MD, 'SALES.FILE.PATH'ş** ENDşQFILE.NAME=SALES.FILE.PATHşCALL CREATE.QPOINTER(PLATFORM,FI.MD,ACCOUNT,REPORT.FILE,QFILE.NAME,FI.QFILE)şTIME.STAMP.TYPE='SALES'şSTACKED.1='SELECT ':SALES.FILE.PATH:' WITH ':SALE.DATE.DICT:' = ':DATE.SELECT.STRINGşSTACKED.2='SORT ':SALES.FILE.PATH:' BY ':SALE.DATE.DICT:' ':SALE.DATE.DICT:' PIPE ':SALE.AMOUNT.DICT:' PIPE ':COST.OF.SALE.AMOUNT.DICT:' ID-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şWRITE STACKED.2 ON FI.MVDB.CONTROL, 'SALES.REPORT.CMND'şWRITE REPORT ON FI.MVDB.CONTROL, 'SALES.REPORT.RESULT'şIF NOT(SYSTEM.11) THENş   WRITE 'ERROR: NO SALES CLOSED SINCE BEGINNING OF MONTH' ON FI.DICT.CLOSING.STATS, '*CURRENT.SALES.STATS'ş   GOSUB UPDATE.TIME.STAMPş   SALES.STATS=''ş**   RETURNş** ENDş END ELSEş   DATES=''ş   DATE.CNTR=0ş   LAST.DATE=''ş   AMOUNTS=''ş   COSTS=''ş   MAX.ROWS=DCOUNT(REPORT,CHAR(254))ş   FOR ROW.NO = 1 TO MAX.ROWSş      ROW=REPORT<ROW.NO>ş      IF INDEX(ROW,'|',1) THENş         ROW.DATE=TRIM(FIELD(ROW,'|',1))ş         AMOUNT=ICONV(TRIM(FIELD(ROW,'|',2)),'MD2')ş         COST=ICONV(TRIM(FIELD(ROW,'|',3)),'MD2')ş         IF NUM(AMOUNT) THENş            IF ROW.DATE <> LAST.DATE THENş               LAST.DATE=ROW.DATEş               DATE.CNTR+=1ş               DATES<1,DATE.CNTR>=ROW.DATEş               AMOUNTS<1,DATE.CNTR>=0ş               COSTS<1,DATE.CNTR>=0ş             ENDş            AMOUNTS<1,DATE.CNTR>+=AMOUNTş            COSTS<1,DATE.CNTR>+=COSTş          ENDş       ENDş    NEXT ROW.NOş   VALUE.CNTR=0ş   SALES.STATS=''ş   FOR AMT.CNTR = 1 TO DATE.CNTRş      COST=COSTS<1,AMT.CNTR>ş      AMOUNT=AMOUNTS<1,AMT.CNTR>ş      IF AMOUNT OR COST THENş         VALUE.CNTR+=1ş         ROW.DATE=ICONV(DATES<1,AMT.CNTR>,'D')ş         ROW.DATE=OCONV(ROW.DATE,'D0')ş         SALES.STATS<1,VALUE.CNTR>=ROW.DATEş         SALES.STATS<2,VALUE.CNTR>=AMOUNTş         SALES.STATS<3,VALUE.CNTR>=COSTş       ENDş    NEXT AMT.CNTRş ENDşWRITE SALES.STATS ON DICT.FILE, '*CURRENT.SALES.STATS'ş*şEXECUTE "REFRESH.DASHBOARD.CLOSING.STATS" CAPTURING DUMMYş*şGOSUB UPDATE.TIME.STAMPşRETURNş*şCALC.AR:ş*ş* PERIOD.AMOUNTS DATA LAYOUTş* 1 PERIOD 1 AMOUNTş* 2 PERIOS 2 AMOUNTş* 3 PERIOD 3 AMOUNTş* 4 PERIOD 4 AMOUNTş* 5ş* 6 YEAR ] YEAR ] YEARş* 7 PERIOD 1 NUMBER \ PERIOD 2 NUMBER \ PERIOD 3 NUMBER \ PERIOD 4 NUMBER ş* 8 PERIOD 1 AMOUNT \ PERIOD 2 AMOUNT \ PERIOD 3 AMOUNT \ PERIOD 4 AMOUNT ş* 9 PERIOD 1 TOTAL DAYS ? PERIOD 2 TOTAL DAYS ? ETCş* 10 YEAR 1 JAN # PAID\ FEB # PAID ... ] YEAR 2 JAN # PAID \ş* 11 YEAR 1 JAN # TOTAL DAYS \ FEB TOTAL DAYS ....ş* 12 CUSTOMER ] CUSTOMER ]ş* 13 CUSTOMER AMT DUE ] ] ]ş* 14 LARGEST DAYS DUE ] ] ]ş* 15 TOTAL DAYS LAST 1000 DAYS ] ] ]ş* 16 NUMBER OF ARS LAST 1000 DAYS ] ] ]ş* 17 TOTAL DAYS LAST 60 DAYS ] ] ]ş* 18 NUMBER OF ARS LAST 60 DAYS ] ] ]ş* 19 customers  ] ] ] for 50 highest amounts dueş* 20 amounts ] ] ] for 50 highest amounts dueş* 21 customers ] ] ] for 50 highest days dueş* 22 days due ] ] ] for 50 highest days dueş* 23 customer ] ] ] ] ] for 50 highest percent increaseş* 24 percentage increase from 1000 day average to 60 day average for highest 50ş*ş*şDICT.FILE=FI.DICT.BALANCESşMATREAD SETUP.PARAMS FROM FI.MVDB.CONTROL, 'PORTAL.AR.REPORT.SETUP' ELSEş   MAT SETUP.PARAMS=''ş ENDş*şEQUATE AR.ACCOUNT TO SETUP.PARAMS(1)şEQUATE AR.REPORT.FILE TO SETUP.PARAMS(2)şEQUATE AR.DUE.DATE.DICT TO SETUP.PARAMS(3)şEQUATE AR.DATE.PAID.DICT TO SETUP.PARAMS(4)şEQUATE AR.INVOICE.AMT.DICT TO SETUP.PARAMS(5)şEQUATE AR.BALANCE.DICT TO SETUP.PARAMS(6)şEQUATE AR.DUE.DATE.AMC TO SETUP.PARAMS(8)şEQUATE AR.DATE.PAID.AMC TO SETUP.PARAMS(9)şEQUATE AR.INVOICE.AMT.AMC TO SETUP.PARAMS(10)şEQUATE AR.INVOICE.AMT.CONV TO SETUP.PARAMS(11)şEQUATE AR.INVOICE.AMT.COOR TO SETUP.PARAMS(12)şEQUATE AR.BALANCE.AMC TO SETUP.PARAMS(13)şEQUATE AR.BALANCE.CONV TO SETUP.PARAMS(14)şEQUATE AR.BALANCE.COOR TO SETUP.PARAMS(15)şEQUATE AR.CUSTOMER.DICT TO SETUP.PARAMS(16)şEQUATE AR.CUSTOMER.AMC TO SETUP.PARAMS(17)şEQUATE AR.CUSTOMER.TFILE TO SETUP.PARAMS(18)ş*şAR.FILE.PATH='AR.FILE.PATH'şQFILE.NAME=AR.FILE.PATHş**OPEN '',AR.FILE.PATH TO FI.AR.FILE.PATH ELSEş**IF PLATFORM = 'UD' THENş**   QFILE.NAME=AR.FILE.PATHş**   CALL CREATE.UD.QPOINTER(ACCOUNT,REPORT.FILE,QFILE.NAME,FI.AR.FILE.PATH)ş**   IF QFILE.NAME = '' THENş**      WRITE 'ERROR: UNABLE TO OPEN ':REPORT.FILE:' IN ':ACCOUNT:' ACCOUNT' ON FI.DICT.BALANCES, '*CURRENT.AR.STATS'ş**      GOSUB UPDATE.TIME.STAMPş**      ALL.GOOD=0ş**      RETURNş**    ENDş** END ELSEş**   MD.QFILE='Q'ş**   MD.QFILE<2>=ACCOUNTş**   MD.QFILE<3>=REPORT.FILEş**   WRITE MD.QFILE ON FI.MD, 'AR.FILE.PATH'ş**   OPEN '','AR.FILE.PATH' TO FI.AR.FILE.PATH ELSEş**      WRITE 'ERROR: UNABLE TO OPEN ':REPORT.FILE:' IN ':ACCOUNT:' ACCOUNT' ON FI.DICT.BALANCES, '*CURRENT.AR.STATS'ş**      GOSUB UPDATE.TIME.STAMPş**      ALL.GOOD=0ş**      RETURNş**    ENDş** ENDşCALL CREATE.QPOINTER(PLATFORM,FI.MD,ACCOUNT,REPORT.FILE,QFILE.NAME,FI.REPORT.FILE)şIF QFILE.NAME = '' THENş   WRITE 'ERROR: UNABLE TO OPEN ':REPORT.FILE:' IN ':ACCOUNT:' ACCOUNT' ON FI.DICT.BALANCES, '*CURRENT.AR.STATS'ş   GOSUB UPDATE.TIME.STAMPş   ALL.GOOD=0ş   RETURNş ENDşEXECUTE "CREATE-INDEX AR.FILE.PATH ":AR.DUE.DATE.DICT CAPTURING DUMMYş** ENDş*ş**EXECUTE 'SELECT ':AR.FILE.PATH:' WITH ':AR.BALANCE.DICT:' > "0"' CAPTURING DUMMYş**IF NOT(SYSTEM(11)) THENş**   WRITE 'ERROR: NO OUTSTANDING RECEIVABLES' ON FI.DICT.BALANCES, '*CURRENT.AR.STATS'ş**   GOSUB UPDATE.TIME.STAMPş**   ALL.GOOD=0ş**   RETURNş** ENDş**CMND='SORT ':AR.FILE.PATH:' BY ':AR.DUE.DATE.DICT:' BREAK-ON ':AR.DUE.DATE.DICT:' PIPE TOTAL ':AR.BALANCE.DICT:' ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCMND='SORT ':AR.FILE.PATH:' WITH ':AR.INVOICE.AMT.DICT:' > "0" BY ':AR.DUE.DATE.DICTşCMND:=' PIPE ':AR.DUE.DATE.DICT:' PIPE ':AR.DATE.PAID.DICT:' PIPE ':AR.INVOICE.AMT.DICTşCMND:=' PIPE ':AR.BALANCE.DICT:' PIPE ':AR.CUSTOMER.DICT:' HDR-SUPP COL-HDR-SUPP NOPAGE'şWRITE CMND ON FI.MVDB.CONTROL, 'AR.REPORT.CMND'şEXECUTE CMND CAPTURING REPORTşCONVERT '$,' TO '' IN REPORTşWRITE REPORT ON FI.MVDB.CONTROL, 'AR.REPORT'ş* SETUP AGING PERIODS OF 0, 1-30, 31-60, 61-90, AND 90+şPERIODS=0:@AM:1:@AM:31:@AM:61:@AM:91şPERIOD.AMOUNTS=''şCUSTOMERS=''şNUM.CUSTS=0şCUST.AMT.DUES=''şCUST.MOST.DAYS.DUE=''şCUST.TOTAL.1000.DAYS=''şCUST.NUM.1000.DAYS=''şCUST.TOTAL.60.DAYS=''şCUST.NUM.60.DAYS=''şDATES=''şDATE.CNTR=0şLAST.DATE=''şAMOUNTS=''şROW.NO=0ş* BUILD LAST 5 YEARSşFIVE.YEARS=''şFIRST.YEAR=(OCONV(DATE(),'D4-')[7,4])-4şFOR YEAR.CNTR = 0 TO 4ş   FIVE.YEARS<1,-1>=FIRST.YEAR+YEAR.CNTRş NEXT YEAR.CNTRşPERIOD.AMOUNTS<6>=FIVE.YEARSşMAX.ROWS=DCOUNT(REPORT,@AM)şLOOPş   ROW.NO+=1ş   ROW=REPORT<ROW.NO>şUNTIL ROW.NO > MAX.ROWS DOş   IF INDEX(ROW,'|',1) THENş      ROW.DATE=TRIM(FIELD(ROW,'|',2))ş      DUE.DATE=ICONV(ROW.DATE,'D')ş      IF DUE.DATE = ROW.DATE OR NOT(NUM(DUE.DATE)) THEN DUE.DATE=''ş      IF DUE.DATE THENş         DUE.YEAR=OCONV(DUE.DATE,'D4-')[7,4]ş         LOCATE DUE.YEAR IN FIVE.YEARS<1> SETTING YEAR.POS ELSE YEAR.POS=0ş         PAID.DATE=TRIM(FIELD(ROW,'|',3))ş         NEXT.ROW.NO=ROW.NO+1ş         LOOPş            NEXT.ROW=TRIM(REPORT<NEXT.ROW.NO>)ş         UNTIL INDEX(NEXT.ROW,'|',1) OR NEXT.ROW = '' DOş            NEXT.PAID.DATE=NEXT.ROWş            IF NEXT.PAID.DATE <> '' THEN PAID.DATE=NEXT.PAID.DATEş            NEXT.ROW.NO+=1ş         REPEATş         ROW.NO=NEXT.ROW.NO-1ş         IF PAID.DATE <> '' THENş            PAID.DATE=ICONV(PAID.DATE,'D')ş            PAID.MO=OCONV(PAID.DATE,'D2-')[1,2]ş            PAID.MO+=0ş            PAID.YEAR=OCONV(PAID.DATE,'D4-')[7,4]ş            LOCATE PAID.YEAR IN FIVE.YEARS<1> SETTING PAID.YEAR.POS ELSE PAID.YEAR.POS=0ş            PAID.DAYS=PAID.DATE-DUE.DATEş          END ELSEş            PAID.MO=''ş            PAID.YEAR=''ş            PAID.DAYS=''ş            PAID.YEAR.POS=''ş          ENDş         INV.AMOUNT=ICONV(TRIM(FIELD(ROW,'|',4)),'MD2')ş         REM.BALANCE=ICONV(TRIM(FIELD(ROW,'|',5)),'MD2')ş         CUSTOMER=TRIM(FIELD(ROW,'|',6))ş         CUSTOMER.POS=0ş         IF NUM(INV.AMOUNT) AND NUM(REM.BALANCE) THENş            IF CUSTOMER <> '' THENş               IF REM.BALANCE OR PAID.DATE >= DAYS.AGO.1000 THENş                  LOCATE CUSTOMER IN CUSTOMERS<1> SETTING CUSTOMER.POS ELSEş                     NUM.CUSTS+=1ş                     CUSTOMER.POS=NUM.CUSTSş                     CUSTOMERS<1,CUSTOMER.POS>=CUSTOMERş                   ENDş                ENDş             ENDş            IF REM.BALANCE OR NOT(PAID.DATE) THENş               DAYS.DUE=DATE()-DUE.DATEş             END ELSEş               DAYS.DUE=PAID.DATE-DUE.DATEş             ENDş            IF DAYS.DUE < 0 THEN DAYS.DUE=0ş            LOCATE DAYS.DUE IN PERIODS BY "AR" SETTING PERIOD ELSE PERIOD=PERIOD-1ş            IF REM.BALANCE THENş               PERIOD.AMOUNTS<PERIOD>+=REM.BALANCEş               IF CUSTOMER.POS AND DAYS.DUE THENş                  CUST.AMT.DUES<1,CUSTOMER.POS>=CUST.AMT.DUES<1,CUSTOMER.POS>+REM.BALANCEş                  IF DAYS.DUE > CUST.MOST.DAYS.DUE<1,CUSTOMER.POS> THENş                     CUST.MOST.DAYS.DUE<1,CUSTOMER.POS>=DAYS.DUEş                   ENDş                ENDş             ENDş            IF DAYS.DUE AND CUSTOMER.POS THENş               IF PAID.DATE THENş                  PAID.OR.TODAY=PAID.DATEş                END ELSEş                  PAID.OR.TODAY=DATE()ş                ENDş               IF PAID.OR.TODAY >= DAYS.AGO.1000 THEN; * PAID IN LAST 1000 DAYSş                  CUST.TOTAL.1000.DAYS<1,CUSTOMER.POS>=CUST.TOTAL.1000.DAYS<1,CUSTOMER.POS>+DAYS.DUEş                  CUST.NUM.1000.DAYS<1,CUSTOMER.POS>=CUST.NUM.1000.DAYS<1,CUSTOMER.POS>+1ş                  IF PAID.OR.TODAY >= DAYS.AGO.60 THEN; * PAID IN LAST 60 DAYSş                     CUST.TOTAL.60.DAYS<1,CUSTOMER.POS>=CUST.TOTAL.60.DAYS<1,CUSTOMER.POS>+DAYS.DUEş                     CUST.NUM.60.DAYS<1,CUSTOMER.POS>=CUST.NUM.60.DAYS<1,CUSTOMER.POS>+1ş                   ENDş                ENDş             ENDş            IF PAID.YEAR.POS THENş               IF YEAR.POS AND PERIOD THENş                  PERIOD.AMOUNTS<7,YEAR.POS,PERIOD>=PERIOD.AMOUNTS<7,YEAR.POS,PERIOD>+1ş                  PERIOD.AMOUNTS<8,YEAR.POS,PERIOD>=PERIOD.AMOUNTS<8,YEAR.POS,PERIOD>+INV.AMOUNTş                  PERIOD.AMOUNTS<9,YEAR.POS>=PERIOD.AMOUNTS<9,YEAR.POS>+DAYS.DUEş                ENDş               PERIOD.AMOUNTS<10,PAID.YEAR.POS,PAID.MO>=PERIOD.AMOUNTS<10,PAID.YEAR.POS,PAID.MO>+1ş               PERIOD.AMOUNTS<11,PAID.YEAR.POS,PAID.MO>=PERIOD.AMOUNTS<11,PAID.YEAR.POS,PAID.MO>+PAID.DAYSş             ENDş          ENDş       ENDş    ENDşREPEATşPERIOD.AMOUNTS<12>=CUSTOMERSşPERIOD.AMOUNTS<13>=CUST.AMT.DUESşPERIOD.AMOUNTS<14>=CUST.MOST.DAYS.DUEşPERIOD.AMOUNTS<15>=CUST.TOTAL.1000.DAYSşPERIOD.AMOUNTS<16>=CUST.NUM.1000.DAYSşPERIOD.AMOUNTS<17>=CUST.TOTAL.60.DAYSşPERIOD.AMOUNTS<18>=CUST.NUM.60.DAYSş*ş** GET THE 50 HIGHEST AMOUNTS DUEş*şHIGHEST.AMTS=''şHIGHEST.AMTS.CUSTS=''şMAX.CUSTS=DCOUNT(CUSTOMERS,@VM)şFOR I = 1 TO MAX.CUSTSş   MAX.AMT=CUST.AMT.DUES<1,I>ş   IF MAX.AMT THENş      LOCATE MAX.AMT IN HIGHEST.AMTS<1> BY "DR" SETTING POS ELSE NULLş      IF POS <= 50 THENş         HIGHEST.AMTS=INSERT(HIGHEST.AMTS,1,POS,0,MAX.AMT)ş         HIGHEST.AMTS.CUSTS=INSERT(HIGHEST.AMTS.CUSTS,1,POS,0,CUSTOMERS<1,I>)ş       ENDş    ENDş NEXT IşPERIOD.AMOUNTS<19>=HIGHEST.AMTS.CUSTSşPERIOD.AMOUNTS<20>=HIGHEST.AMTSş*ş** GET THE 50 HIGHEST DUE DAYSş*şHIGHEST.DAYS=''şHIGHEST.DAYS.CUSTS=''şFOR I = 1 TO MAX.CUSTSş   CUST.DAYS.DUE=CUST.MOST.DAYS.DUE<1,I>ş   IF CUST.DAYS.DUE THENş      LOCATE CUST.DAYS.DUE IN HIGHEST.DAYS<1> BY "DR" SETTING POS ELSE NULLş      IF POS <= 50 THENş         HIGHEST.DAYS=INSERT(HIGHEST.DAYS,1,POS,0,CUST.DAYS.DUE)ş         HIGHEST.DAYS.CUSTS=INSERT(HIGHEST.DAYS.CUSTS,1,POS,0,CUSTOMERS<1,I>)ş       ENDş    ENDş NEXT IşPERIOD.AMOUNTS<21>=HIGHEST.DAYS.CUSTSşPERIOD.AMOUNTS<22>=HIGHEST.DAYSş*ş** GET THE 50 CUSTOMERS WITH HIGHEST PERCENTAGE INCREASESş*şHIGHEST.INCREASE.PCTS=''şHIGHEST.INCREASE.CUSTS=''şHIGHEST.INCREASE.60.DAYS=''şHIGHEST.INCREASE.1000.DAYS=''şFOR I = 1 TO MAX.CUSTSş   DAYS.1000=CUST.TOTAL.1000.DAYS<1,I>ş   NUM.1000=CUST.NUM.1000.DAYS<1,I>ş   DAYS.60=CUST.TOTAL.60.DAYS<1,I>ş   NUM.60=CUST.NUM.60.DAYS<1,I>ş   IF NUM.1000 THENş      AVG.1000=DAYS.1000 / NUM.1000ş    END ELSE AVG.1000=0ş   IF NUM.60 THENş      AVG.60=DAYS.60 / NUM.60ş    END ELSE AVG.60=0ş   AVG.INCREASE=AVG.60 - AVG.1000ş   IF AVG.INCREASE > 0 AND AVG.60 > 300 THEN;  * MUST BE DUE OVER 30 DAYSş      IF AVG.1000 THENş         PCT.INCREASE=INT(AVG.INCREASE * 1000 / AVG.1000 + .5)ş         PCT.INCREASE=OCONV(PCT.INCREASE,'MD1')ş       END ELSE PCT.INCREASE=0ş      LOCATE PCT.INCREASE IN HIGHEST.INCREASE.PCTS<1> BY "DR" SETTING POS ELSE NULLş      IF POS <= 50 THENş         HIGHEST.INCREASE.PCTS=INSERT(HIGHEST.INCREASE.PCTS,1,POS,0,PCT.INCREASE)ş         HIGHEST.INCREASE.CUSTS=INSERT(HIGHEST.INCREASE.CUSTS,1,POS,0,CUSTOMERS<1,I>)ş         HIGHEST.INCREASE.1000.DAYS=INSERT(HIGHEST.INCREASE.1000.DAYS,1,POS,0,OCONV(AVG.1000,'MD1'))ş         HIGHEST.INCREASE.60.DAYS=INSERT(HIGHEST.INCREASE.60.DAYS,1,POS,0,OCONV(AVG.60,'MD1'))ş       ENDş    ENDş NEXT IşPERIOD.AMOUNTS<23>=HIGHEST.INCREASE.CUSTSşPERIOD.AMOUNTS<24>=HIGHEST.INCREASE.PCTSşPERIOD.AMOUNTS<25>=HIGHEST.INCREASE.60.DAYSşPERIOD.AMOUNTS<26>=HIGHEST.INCREASE.1000.DAYSş*şTIME.STAMP.TYPE='AR'şDICT.FILE=FI.DICT.BALANCESşGOSUB UPDATE.TIME.STAMPşWRITE PERIOD.AMOUNTS ON DICT.FILE, '*CURRENT.AR.STATS'şRETURNş*şCALC.AP:ş*şDICT.FILE=FI.DICT.BALANCESşMATREAD SETUP.PARAMS FROM FI.MVDB.CONTROL, 'PORTAL.AP.REPORT.SETUP' ELSEş   MAT SETUP.PARAMS=''ş ENDş*şEQUATE AP.ACCOUNT TO SETUP.PARAMS(1)şEQUATE AP.REPORT.FILE TO SETUP.PARAMS(2)şEQUATE AP.DUE.DATE.DICT TO SETUP.PARAMS(3)şEQUATE AP.DATE.PAID.DICT TO SETUP.PARAMS(4)şEQUATE AP.INVOICE.AMT.DICT TO SETUP.PARAMS(5)şEQUATE AP.BALANCE.DICT TO SETUP.PARAMS(6)şEQUATE AP.DUE.DATE.AMC TO SETUP.PARAMS(8)şEQUATE AP.DATE.PAID.AMC TO SETUP.PARAMS(9)şEQUATE AP.INVOICE.AMT.AMC TO SETUP.PARAMS(10)şEQUATE AP.INVOICE.AMT.CONV TO SETUP.PARAMS(11)şEQUATE AP.INVOICE.AMT.COOR TO SETUP.PARAMS(12)şEQUATE AP.BALANCE.AMC TO SETUP.PARAMS(13)şEQUATE AP.BALANCE.CONV TO SETUP.PARAMS(14)şEQUATE AP.BALANCE.COOR TO SETUP.PARAMS(15)ş*şAP.FILE.PATH='AP.FILE.PATH'şQFILE.NAME=AP.FILE.PATHş**OPEN '',AP.FILE.PATH TO FI.AP.FILE.PATH ELSEş**IF PLATFORM = 'UD' THENş**   QFILE.NAME=AP.FILE.PATHş**   CALL CREATE.UD.QPOINTER(ACCOUNT,AP.REPORT.FILE,QFILE.NAME,FI.AP.FILE.PATH)ş**   IF QFILE.NAME = '' THENş**      WRITE 'ERROR: UNABLE TO OPEN ':REPORT.FILE:' IN ':ACCOUNT:' ACCOUNT' ON FI.DICT.BALANCES, '*CURRENT.AP.STATS'ş**      GOSUB UPDATE.TIME.STAMPş**      ALL.GOOD=0ş**      RETURNş**    ENDş** END ELSEş**   MD.QFILE='Q'ş**   MD.QFILE<2>=AP.ACCOUNTş**   MD.QFILE<3>=AP.REPORT.FILEş**   WRITE MD.QFILE ON FI.MD, 'AP.FILE.PATH'ş**   OPEN '','AP.FILE.PATH' TO FI.AP.FILE.PATH ELSEş**      WRITE 'ERROR: UNABLE TO OPEN ':REPORT.FILE:' IN ':ACCOUNT:' ACCOUNT' ON FI.DICT.BALANCES, '*CURRENT.AP.STATS'ş**      GOSUB UPDATE.TIME.STAMPş**      ALL.GOOD=0ş**      RETURNş**    ENDş** ENDşCALL CREATE.QPOINTER(PLATFORM,FI.MD,ACCOUNT,REPORT.FILE,QFILE.NAME,FI.REPORT.FILE)şIF QFILE.NAME = '' THENş   WRITE 'ERROR: UNABLE TO OPEN ':REPORT.FILE:' IN ':ACCOUNT:' ACCOUNT' ON FI.DICT.BALANCES, '*CURRENT.AP.STATS'ş   GOSUB UPDATE.TIME.STAMPş   ALL.GOOD=0ş   RETURNş ENDşEXECUTE "CREATE-INDEX AP.FILE.PATH ":AP.DUE.DATE.DICT CAPTURING DUMMYş** ENDş*şSTACKED.1='SELECT ':AP.FILE.PATH:' WITH ':AP.BALANCE.DICT:' > "0"'şSTACKED.2='SORT ':AP.FILE.PATH:' BY ':AP.DUE.DATE.DICT:' BREAK-ON ':AP.DUE.DATE.DICT:' PIPE TOTAL ':AP.BALANCE.DICT:' ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şWRITE STACKED.2 ON FI.MVDB.CONTROL, 'AP.CMND'şWRITE REPORT ON FI.MVDB.CONTROL, 'AP.REPORT'şIF NOT(SYSTEM.11) THENş   WRITE 'ERROR: NO OUTSTANDING PAYABLES' ON FI.DICT.BALANCES, '*CURRENT.AP.STATS'ş   GOSUB UPDATE.TIME.STAMPş**   ALL.GOOD=0ş**   RETURNş** ENDş   PERIOD.AMOUNTS=''ş END ELSEş   * SETUP AGING PERIODS OF 0, 1-30, 31-60, 61-90, AND 90+ş   PERIODS=0:@AM:1:@AM:31:@AM:61:@AM:91ş   PERIOD.AMOUNTS=''ş   DATES=''ş   DATE.CNTR=0ş   LAST.DATE=''ş   AMOUNTS=''ş   MAX.ROWS=DCOUNT(REPORT,CHAR(254))ş   FOR ROW.NO = 1 TO MAX.ROWSş      ROW=REPORT<ROW.NO>ş      IF INDEX(ROW,'|',1) THENş         ROW.DATE=TRIM(FIELD(ROW,'|',1))ş         DUE.DATE=ICONV(ROW.DATE,'D')ş         IF DUE.DATE = ROW.DATE OR NOT(NUM(DUE.DATE)) THEN DUE.DATE=''ş         IF DUE.DATE THENş            AMOUNT=ICONV(TRIM(FIELD(ROW,'|',2)),'MD2')ş            IF NUM(AMOUNT) THENş               DAYS.DUE=DATE()-DUE.DATEş               IF DAYS.DUE < 0 THEN DAYS.DUE=0ş               LOCATE DAYS.DUE IN PERIODS BY "AR" SETTING PERIOD ELSE PERIOD=PERIOD-1ş               PERIOD.AMOUNTS<PERIOD>+=AMOUNTş             ENDş          ENDş       ENDş    NEXT ROW.NOş ENDş*şTIME.STAMP.TYPE='AP'şDICT.FILE=FI.DICT.BALANCESşGOSUB UPDATE.TIME.STAMPşWRITE PERIOD.AMOUNTS ON DICT.FILE, '*CURRENT.AP.STATS'ş*şCALC.NET.INCOME:ş*şTIME.STAMP.TYPE='NET.INCOME'şDICT.FILE=FI.DICT.BALANCESşGOSUB UPDATE.TIME.STAMPşWRITE 999 ON DICT.FILE, '*CURRENT.NET.INCOME.STATS'şRETURNş*şUPDATE.TIME.STAMP:ş*şTIME.STAMP=TIME()şTIME.STAMP=STR('0',5-LEN(TIME.STAMP)):TIME.STAMPşWRITE DATE():TIME.STAMP ON DICT.FILE, '*LAST.UPDATE.':TIME.STAMP.TYPEşWRITE DATE():TIME.STAMP ON DICT.FILE, '*LAST.UPDATED.':TIME.STAMP.TYPEşRETURNşEND0007DFSUB.DEMO.SINGLE.MONTH.SALES.BY.REPş0c2SUBROUTINE SUB.DEMO.SINGLE.MONTH.SALES.BY.REPş*ş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "FCCOLUMN3D"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEşMONTHS='Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec'şCONVERT ',' TO CHAR(254) IN MONTHSşOPEN '','MVDB.CONTROL' TO FILE.CONTROL ELSE STOPşMATWRITE WIDGET.USER.DATA ON FILE.CONTROL, 'DEBUG'şREADV YEARS FROM FILE.CONTROL, 'DEMO.FINANCIAL.PICTURE', 67 ELSEş   YEARS='2013,2014,2015'ş   CONVERT ',' TO CHAR(253) IN YEARSş ENDşREVENUE.OR.GP=WIDGET.USER.DATA(1)şYEAR=WIDGET.USER.DATA(2)şMONTH=WIDGET.USER.DATA(3)şLOCATE MONTH IN MONTHS SETTING MONTH.SVM ELSE MONTH.SVM=1şYEAR.DETAIL.ID=''şBEGIN CASEş   CASE REVENUE.OR.GP = 'REVENUES'ş      W$TITLE=MONTH:' ':YEAR:' Sales By Sales Rep'ş      W$BAR.YMEMO = "Sales"ş      YEAR.DETAIL.ID='SALES.':YEARş      MAX.ROUNDER=150000ş   CASE REVENUE.OR.GP = 'GROSSPROFIT'ş      W$TITLE=MONTH:' ':YEAR:' Gross Profit By Sales Rep'ş      W$BAR.YMEMO = "Gross Profit"ş      YEAR.DETAIL.ID='GPS.':YEARş      MAX.ROUNDER=50000şEND CASEşREAD REC FROM FILE.CONTROL, YEAR.DETAIL.ID ELSE REC=''ş*şREPS=REC<1>ş*ş*şMAX.SALES.AMT=0şN=0şFIRST.YEAR=''şMAX.REPS=DCOUNT(REPS,CHAR(253))şFOR NN = 1 TO MAX.REPSş   REP=REPS<1,NN>ş   SALES.AMT=REC<2,NN,MONTH.SVM>ş   SALES.AMT=OCONV(SALES.AMT,'MD02')ş   IF SALES.AMT > MAX.SALES.AMT THEN MAX.SALES.AMT=SALES.AMTş   W$BAR.VALUES<1,NN> = SALES.AMTş   W$BAR.XLABELS<1,NN> = REPşNEXT NNşW$BAR.XMEMO = "Sales Rep"ş* ROUND MAX AMOUNT UP TO THE NEXT MAX.ROUNDERşMAX.SALES.AMT+=MAX.ROUNDERşMAX.SALES.AMT=INT(MAX.SALES.AMT/MAX.ROUNDER) * MAX.ROUNDERşW$CHART.OPTIONS<-1>='yAxisMaxValue="':MAX.SALES.AMT:'"'şW$CHART.OPTIONS<-1>='decimals="2"'şW$CHART.OPTIONS<-1>='DecimalPrecision="2"'şW$CHART.OPTIONS<-1>='divLineDecimalPrecision="2"'şW$CHART.OPTIONS<-1>='limitsDecimalPrecision="2"'şW$CHART.OPTIONS<-1>='formatNumberScale="1"'şRETURN0002FASUB.TEST.WIDGETş0c2SUBROUTINE SUB.TEST.WIDGETş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş*şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Neat Pie Chart"şW$TYPE = "FC2DPIE"şW$WIDTH = 1 ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*şW$PIE.CAPTION = "MV Dashboard Survey"ş*şW$PIE.LABELS<1,1> = "Love it"şW$PIE.LABELS<1,2> = "Like it"şW$PIE.LABELS<1,3> = "Very nice"şW$PIE.LABELS<1,4> = "Awesome!"ş*şW$PIE.VALUES<1,1> = "1560"şW$PIE.VALUES<1,2> = "400"şW$PIE.VALUES<1,3> = "1012"şW$PIE.VALUES<1,4> = "4065"ş*ş* For a 2D pie, a specific slice can be separated from the pieş* by setting this value:ş* W$PIE.VALUE.OPTS<1,3> = 'isSliced="1"'ş*ş* To show percentages instead of values, use this:şW$CHART.OPTIONS<-1> = "showPercentValues='1'"şRETURN003DCBSUB.PORTAL.DASHBOARDş0c2SUBROUTINE SUB.PORTAL.DASHBOARDş*ş* Dashboard Widgetş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEş*ş* Copyright (C) Zumasys, Incş*şWEB$TITLE='MVDashboard Portal Financial Picture'şWEB.FORM.NAME='PORTAL.DASHBOARD'şW$TYPE='HTML'şW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*şEQUATE AR.AMOUNTS TO GLOBAL.USER.DATA(1)şEQUATE AP.AMOUNTS TO GLOBAL.USER.DATA(2)şOPEN '','MVDB.CONTROL' TO FI.MVDB.CONTROL ELSE ş   ERROR.MSG<-1>='UNABLE TO OPEN MVDB.CONTROL'ş   GOTO DISPLAY.ERRORş ENDşREAD PLATFORM FROM FI.MVDB.CONTROL, 'PLATFORM' ELSE PLATFORM='D3'şBEGIN CASEş   CASE PLATFORM = 'UD'ş      EXECUTE.STACKED.CMNDS='UD.EXECUTE.STACKED.CMNDS'ş   CASE PLATFORM = 'UV'ş      EXECUTE.STACKED.CMNDS='UV.EXECUTE.STACKED.CMNDS'ş   CASE PLATFORM = 'QM'ş      EXECUTE.STACKED.CMNDS='EXECUTE.STACKED.CMNDS'ş   CASE 1ş      * D3 AND JBASE ARE THE SAMEş      EXECUTE.STACKED.CMNDS='EXECUTE.STACKED.CMNDS'şEND CASEşOPEN '','DASHBOARD.CLOSING.STATS' TO FI.DASHBOARD.CLOSING.STATS ELSE ş   ERROR.MSG<-1>='UNABLE TO OPEN DASHBOARD.CLOSING.STATS'ş   GOTO DISPLAY.ERRORş ENDşOPEN 'DICT','DASHBOARD.CLOSING.STATS' TO FI.DICT.CLOSING.STATS ELSE ş   ERROR.MSG<-1>='UNABLE TO OPEN DICT DASHBOARD.CLOSING.STATS'ş   GOTO DISPLAY.ERRORş ENDşOPEN '','DASHBOARD.BALANCES' TO FI.DASHBOARD.BALANCES ELSE ş   ERROR.MSG<-1>='UNABLE TO OPEN DASHBOARD.BALANCES'ş   GOTO DISPLAY.ERRORş ENDşREAD PLATFORM FROM FI.MVDB.CONTROL, 'PLATFORM' ELSE PLATFORM='D3'şERROR.MSG=''şDIM SALES.SETUP.PARAMS(20), AR.SETUP.PARAMS(20), AP.SETUP.PARAMS(20), NET.INCOME.SETUP.PARAMS(20)ş*şMATREAD SALES.SETUP.PARAMS FROM FI.MVDB.CONTROL, 'PORTAL.SALES.REPORT.SETUP' ELSEş   MAT SALES.SETUP.PARAMS=''ş ENDşEQUATE SALES.ACCOUNT TO SALES.SETUP.PARAMS(1)şEQUATE SALES.REPORT.FILE TO SALES.SETUP.PARAMS(2)şEQUATE SALES.DATE.DICT TO SALES.SETUP.PARAMS(3)şEQUATE SALES.AMOUNT.DICT TO SALES.SETUP.PARAMS(6)şEQUATE GP.DICT.NAME TO SALES.SETUP.PARAMS(7)ş*şIF SALES.ACCOUNT = '' OR SALES.REPORT.FILE = '' OR SALES.DATE.DICT = '' OR SALES.AMOUNT.DICT = '' THENş   ERROR.MSG<-1>='SALES FILE ACCOUNT, SALES FILE NAME, DATE OF SALE, AND AMOUNT OF SALE MUST ALL BE DEFINED BEFORE REPORTS CAN BE ATTEMPTED'ş ENDş*ş** BUILD SAMPLE DATA IF USING MVDB FOR SALES ACCOUNTş*şIF SALES.ACCOUNT = 'MVDB' THENş   EXECUTE "BUILD.SAMPLE.PORTAL.FILES" CAPTURING DUMMYş ENDş*ş*şOPEN 'DICT','DASHBOARD.BALANCES' TO FI.DICT.DASHBOARD.BALANCES ELSE ş   ERROR.MSG<-1>='UNABLE TO OPEN DICT DASHBOARD.BALANCES'ş   GOTO DISPLAY.ERRORş ENDşMATREAD AR.SETUP.PARAMS FROM FI.MVDB.CONTROL, 'PORTAL.AR.REPORT.SETUP' ELSEş   MAT AR.SETUP.PARAMS=''ş ENDş*şEQUATE AR.ACCOUNT TO AR.SETUP.PARAMS(1)şEQUATE AR.REPORT.FILE TO AR.SETUP.PARAMS(2)şEQUATE AR.DUE.DATE.DICT TO AR.SETUP.PARAMS(3)şEQUATE AR.BALANCE.DICT TO AR.SETUP.PARAMS(6)ş*ş*ş**IF AR.ACCOUNT = '' OR AR.REPORT.FILE = '' OR AR.DUE.DATE.DICT = '' OR AR.BALANCE.DICT = '' THENş**   ERROR.MSG<-1>='AR FILE ACCOUNT, AR FILE NAME, DUE DATE, AND BALANCE MUST ALL BE DEFINED BEFORE REPORTS CAN BE ATTEMPTED'ş***   GOTO DISPLAY.ERRORş** ENDş*şMATREAD AP.SETUP.PARAMS FROM FI.MVDB.CONTROL, 'PORTAL.AP.REPORT.SETUP' ELSEş   MAT AP.SETUP.PARAMS=''ş ENDş*şEQUATE AP.ACCOUNT TO AP.SETUP.PARAMS(1)şEQUATE AP.REPORT.FILE TO AP.SETUP.PARAMS(2)şEQUATE AP.DUE.DATE.DICT TO AP.SETUP.PARAMS(3)şEQUATE AP.BALANCE.DICT TO AP.SETUP.PARAMS(6)ş*ş*ş**IF AP.ACCOUNT = '' OR AP.REPORT.FILE = '' OR AP.DUE.DATE.DICT = '' OR AP.BALANCE.DICT = '' THENş**   ERROR.MSG<-1>='AP FILE ACCOUNT, AP FILE NAME, DUE DATE, AND BALANCE MUST ALL BE DEFINED BEFORE REPORTS CAN BE ATTEMPTED'ş***   GOTO DISPLAY.ERRORş** ENDş*ş**MATREAD NET.INCOME.SETUP.PARAMS FROM FI.MVDB.CONTROL, 'PORTAL.NET.INCOME.REPORT.SETUP' ELSEş**   MAT NET.INCOME.SETUP.PARAMS=''ş** ENDş*şEQUATE NET.INCOME.ACCOUNT TO NET.INCOME.SETUP.PARAMS(1)şEQUATE NET.INCOME.REPORT.FILE TO NET.INCOME.SETUP.PARAMS(2)şEQUATE NET.INCOME.DUE.DATE.DICT TO NET.INCOME.SETUP.PARAMS(3)şEQUATE NET.INCOME.BALANCE.DICT TO NET.INCOME.SETUP.PARAMS(6)ş*ş*ş**IF NET.INCOME.ACCOUNT = '' OR NET.INCOME.REPORT.FILE = '' OR NET.INCOME.DUE.DATE.DICT = '' OR NET.INCOME.BALANCE.DICT = '' THENş**   ERROR.MSG<-1>='NET INCOME FILE ACCOUNT, NET INCOME FILE NAME, DUE DATE, AND BALANCE MUST ALL BE DEFINED BEFORE REPORTS CAN BE ATTEMPTED'ş***   GOTO DISPLAY.ERRORş** ENDş*şIF ERROR.MSG <> '' THENş***   GOTO DISPLAY.ERRORş ENDş*ş* START ANY REQUIRED BACKGROUND CALCULATIONSş*şCUR.TIME=TIME()şCUR.TIME=FIELD(CUR.TIME,'.',1)şCUR.TIME=STR('0',5-LEN(CUR.TIME)):CUR.TIMEşCUR.DATE.TIME=DATE():CUR.TIMEş*ş** SALESş*şREADU SALES FROM FI.DICT.CLOSING.STATS, '*LAST.UPDATE.SALES' ELSE SALES=''şBEGIN CASEş   CASE SALES = 'UPDATING'; SALES.STATUS='UPDATING'ş   CASE NOT(NUM(SALES)); SALES.STATUS='NEED CALC'ş   CASE (CUR.DATE.TIME - SALES) < 900;   * LESS THAN 15 MINUTESş      SALES.STATUS='GOOD'ş      READ SALES.REC FROM FI.DICT.CLOSING.STATS, '*CURRENT.SALES.STATS' ELSEş         SALES.STATUS='NEED CALC'ş       ENDş   CASE 1; SALES.STATUS='NEED CALC'şEND CASEşIF SALES.STATUS <> 'NEED CALC' THENş   RELEASE FI.DICT.CLOSING.STATS, '*LAST.UPDATE.SALES'ş ENDş*ş** ARş*şREADU AR FROM FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.AR' ELSE AR=''şBEGIN CASEş   CASE AR = 'UPDATING'; AR.STATUS='UPDATING'ş   CASE NOT(NUM(AR)); AR.STATUS='NEED CALC'ş   CASE (CUR.DATE.TIME - AR) < 900;   * LESS THAN 15 MINUTESş      AR.STATUS='GOOD'ş      READ AR.REC FROM FI.DICT.DASHBOARD.BALANCES, '*CURRENT.AR.STATS' ELSEş         AR.STATUS='NEED CALC'ş       ENDş   CASE 1; AR.STATUS='NEED CALC'şEND CASEşIF AR.STATUS <> 'NEED CALC' THENş   RELEASE FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.AR'ş ENDş*ş** APş*şREADU AP FROM FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.AP' ELSE AP=''şBEGIN CASEş   CASE AP = 'UPDATING'; AP.STATUS='UPDATING'ş   CASE NOT(NUM(AP)); AP.STATUS='NEED CALC'ş   CASE (CUR.DATE.TIME - AP) < 900;   * LESS THAN 15 MINUTESş      AP.STATUS='GOOD'ş      READ AP.REC FROM FI.DICT.DASHBOARD.BALANCES, '*CURRENT.AP.STATS' ELSEş         AP.STATUS='NEED CALC'ş       ENDş   CASE 1; AP.STATUS='NEED CALC'şEND CASEşIF AP.STATUS <> 'NEED CALC' THENş   RELEASE FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.AP'ş ENDş***ş**** NET.INCOMEş***ş**READU NET.INCOME FROM FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.NET.INCOME' ELSE NET.INCOME=''ş**BEGIN CASEş**   CASE NET.INCOME = 'UPDATING'; NET.INCOME.STATUS='UPDATING'ş**   CASE NOT(NUM(NET.INCOME)); NET.INCOME.STATUS='NEED CALC'ş**   CASE (CUR.DATE.TIME - NET.INCOME) < 900;   * LESS THAN 15 MINUTESş**      NET.INCOME.STATUS='GOOD'ş**      READ NET.INCOME.REC FROM FI.DICT.DASHBOARD.BALANCES, '*CURRENT.NET.INCOME.STATS' ELSEş**         NET.INCOME.STATUS='NEED CALC'ş**       ENDş**   CASE 1; NET.INCOME.STATUS='NEED CALC'ş**END CASEş**IF NET.INCOME.STATUS <> 'NEED CALC' THENş**   RELEASE FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.NET.INCOME'ş** ENDş*şIF SALES.STATUS <> 'GOOD' OR AR.STATUS <> 'GOOD' OR AP.STATUS <> 'GOOD' THEN ; *OR NET.INCOME.STATUS <> 'GOOD' THENş   IF SALES.STATUS = 'NEED CALC' AND AR.STATUS = 'NEED CALC' AND AP.STATUS = 'NEED CALC' THEN; *AND NET.INCOME.STATUS = 'NEED CALC' THENş      TYPE.CALC='ALL'ş      GOSUB INITIATE.CALC.PHANTOMş      WRITE 'UPDATING' ON FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.ALL'ş      WRITE 'UPDATING' ON FI.DICT.CLOSING.STATS, '*LAST.UPDATE.SALES'ş      WRITE 'UPDATING' ON FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.AR'ş      WRITE 'UPDATING' ON FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.AP'ş**      WRITE 'UPDATING' ON FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.NET.INCOME'ş    END ELSEş      IF SALES.STATUS = 'NEED CALC' THENş         TYPE.CALC='SALES'ş         GOSUB INITIATE.CALC.PHANTOMş         WRITE 'UPDATING' ON FI.DICT.CLOSING.STATS, '*LAST.UPDATE.SALES'ş       ENDş      IF AR.STATUS = 'NEED CALC' THENş         TYPE.CALC='AR'ş         GOSUB INITIATE.CALC.PHANTOMş         WRITE 'UPDATING' ON FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.AR'ş       ENDş      IF AP.STATUS = 'NEED CALC' THENş         TYPE.CALC='AP'ş         GOSUB INITIATE.CALC.PHANTOMş         WRITE 'UPDATING' ON FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.AP'ş       ENDş**      IF NET.INCOME.STATUS = 'NEED CALC' THENş**         TYPE.CALC='NET.INCOME'ş**         GOSUB INITIATE.CALC.PHANTOMş**         WRITE 'UPDATING' ON FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.NET.INCOME'ş**       ENDş    ENDş   *ş   NOW.GOOD=1ş   *ş   ** GIVE IT 10 SECONDS TO COMPLETE ANY CALCS AND TRY AGAINş   *ş   SLEEP 10ş   *ş   IF SALES.STATUS <> 'GOOD' THENş      READ SALES.STATUS FROM FI.DICT.CLOSING.STATS, '*LAST.UPDATE.SALES' ELSE SALES.STATUS='UPDATING'ş      IF NUM(SALES.STATUS) THENş         READ SALES.REC FROM FI.DICT.CLOSING.STATS, '*CURRENT.SALES.STATS' ELSEş            SALES.STATUS='UPDATING'ş            NOW.GOOD=0ş          ENDş       END ELSEş         NOW.GOOD=0ş       ENDş    ENDş   *ş   IF AR.STATUS <> 'GOOD' THENş      READ AR.STATUS FROM FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.AR' ELSE AR.STATUS='UPDATING'ş      IF NUM(AR.STATUS) THENş         READ AR.REC FROM FI.DICT.DASHBOARD.BALANCES, '*CURRENT.AR.STATS' ELSEş            AR.STATUS='UPDATING'ş            NOW.GOOD=0ş          ENDş       END ELSEş         NOW.GOOD=0ş       ENDş    ENDş   *ş   IF AP.STATUS <> 'GOOD' THENş      READ AP.STATUS FROM FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.AP' ELSE AP.STATUS='UPDATING'ş      IF NUM(AP.STATUS) THENş         READ AP.REC FROM FI.DICT.DASHBOARD.BALANCES, '*CURRENT.AP.STATS' ELSEş            AP.STATUS='UPDATING'ş            NOW.GOOD=0ş          ENDş       END ELSEş         NOW.GOOD=0ş       ENDş    ENDş**   IF NET.INCOME.STATUS <> 'GOOD' THENş**      READ NET.INCOME.STATUS FROM FI.DICT.DASHBOARD.BALANCES, '*LAST.UPDATE.NET.INCOME' ELSE NET.INCOME.STATUS='UPDATING'ş**      IF NUM(NET.INCOME.STATUS) THENş**         READ NET.INCOME.REC FROM FI.DICT.DASHBOARD.BALANCES, '*CURRENT.NET.INCOME.STATS' ELSEş**            NET.INCOME.STATUS='UPDATING'ş**            NOW.GOOD=0ş**          ENDş**       END ELSEş**         NOW.GOOD=0ş**       ENDş**    ENDş   *ş   IF NOT(NOW.GOOD) THENş      *ş      ** USE PROMPTS AS A WAY OF SHOWING WHICH ARE CALCULATION.  NOTHING WILL BE DONE WITH THAT CONTENT OF THEş      ** PROMPT WHEN THE GO BUTTON IS CLICKED.ş      *ş      W$INPUT.PROMPT<1> = "MTD Sales Calcs"ş      W$INPUT.TYPE<1> = "TEXT"ş      W$INPUT.UDPOS<1> = 1ş      W$INPUT.DEFAULT<1> = SALES.STATUSş      *ş      IF AR.REPORT.FILE <> '' THENş         W$INPUT.PROMPT<2> = "AR Calcs"ş         W$INPUT.TYPE<2> = "TEXT"ş         W$INPUT.UDPOS<2> = 2ş         W$INPUT.DEFAULT<2> = AR.STATUSş         *ş         IF AP.REPORT.FILE <> '' THENş            W$INPUT.PROMPT<3> = "AP Calcs"ş            W$INPUT.TYPE<3> = 'TEXT'ş            W$INPUT.UDPOS<3> = 3ş            W$INPUT.DEFAULT<3> = AP.STATUSş          ENDş       ENDş      *ş**      W$INPUT.PROMPT<4> = "Net Income Calcs"ş**      W$INPUT.TYPE<4> = 'TEXT'ş**      W$INPUT.UDPOS<4> = 4ş**      W$INPUT.DEFAULT<4> = NET.INCOME.STATUSş      *ş      ERROR.MSG<-1>='Figures are currently updating.'ş      ERROR.MSG<-1>='Try again in a minute or two.'ş      GOTO DISPLAY.ERRORş   ENDş ENDş*şDASH.REC=''şMMM.YYYY=OCONV(DATE(),'D4')[4,8]şDASH.REC<1>=MMM.YYYYşYYYY=FIELD(MMM.YYYY,' ',2)şDASH.REC<2>=YYYYşDASH.REC<9>=DASH.REC<1>şDASH.REC<10>=YYYYşDASH.REC<15>=OCONV(DATE(),'D2-')şMTD.SALES=SUM(SALES.REC<2>); DASH.REC<3>=MTD.SALESşMTD.COST.OF.SALES=SUM(SALES.REC<3>)şGROSS.PROFIT=MTD.SALES-MTD.COST.OF.SALESşDASH.REC<5>=GROSS.PROFITşPERCENT=INT((GROSS.PROFIT*1000)/MTD.SALES + .5)şDASH.REC<7>=PERCENTş*ş** USE DASHBOARD.CLOSING.STATS TO GET YEAR TO DATE TOTALSş*şSTACKED.1=''şSTACKED.2='SORT DASHBOARD.CLOSING.STATS WITH YYYY = "':YYYY:'" BY YYYY BREAK-ON YYYY PIPE TOTAL AMOUNT PIPE TOTAL COST.OF.SALE ID-SUPP DET-SUPP HDR-SUPP COL-HDR-SUPP NOPAGE'şCALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)şMAX.ROWS=DCOUNT(REPORT,CHAR(254))şYTD.SALES=0şYTD.COST.OF.SALES=0şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=REPORT<ROW.NO>ş   IF INDEX(ROW,'|',1) THENş      TEST.YYYY=TRIM(FIELD(ROW,'|',1))ş      IF TEST.YYYY = YYYY THENş         YTD.SALES=TRIM(FIELD(ROW,'|',2))ş         YTD.SALES=ICONV(YTD.SALES,'MD2')ş         YTD.COST.OF.SALES=TRIM(FIELD(ROW,'|',3))ş         YTD.COST.OF.SALES=ICONV(YTD.COST.OF.SALES,'MD2')ş       ENDş    ENDş NEXT ROW.NOşDASH.REC<4>=YTD.SALESşGROSS.PROFIT=YTD.SALES-YTD.COST.OF.SALESşIF NOT(YTD.SALES) THENş   MARGIN=0ş END ELSEş   MARGIN=INT(GROSS.PROFIT*1000 / YTD.SALES + .5)ş ENDşDASH.REC<6>=GROSS.PROFITşDASH.REC<8>=MARGINş*şTEMP.AR.REC=AR.REC<1>:@AM:AR.REC<2>:@AM:AR.REC<3>:@AM:AR.REC<4>:@AM:AR.REC<5>şSUM.AR.BALANCES=SUM(TEMP.AR.REC)şDASH.REC<28>=SUM.AR.BALANCESşIF SUM.AR.BALANCES THENş   DAYS.CURRENT=AR.REC<1>; DASH.REC<30>=DAYS.CURRENT; DASH.REC<31>=INT(DAYS.CURRENT*1000/SUM.AR.BALANCES + .5)ş   DAYS.1.30=AR.REC<2>; DASH.REC<16>=DAYS.1.30; DASH.REC<17>=INT(DAYS.1.30*1000/SUM.AR.BALANCES + .5)ş   DAYS.31.60=AR.REC<3>; DASH.REC<19>=DAYS.31.60; DASH.REC<20>=INT(DAYS.31.60*1000/SUM.AR.BALANCES + .5)ş   DAYS.61.90=AR.REC<4>; DASH.REC<22>=DAYS.61.90; DASH.REC<23>=INT(DAYS.61.90*1000/SUM.AR.BALANCES + .5)ş   DAYS.91=AR.REC<5>; DASH.REC<25>=DAYS.91; DASH.REC<26>=INT(DAYS.91*1000/SUM.AR.BALANCES + .5)ş ENDşCONVERT CHAR(254) TO CHAR(253) IN TEMP.AR.RECşAR.AMOUNTS=TEMP.AR.RECş*şSUM.AP.BALANCES=SUM(AP.REC)şDASH.REC<29>=SUM.AP.BALANCESşDAYS.CURRENT=AP.REC<1>; DASH.REC<32>=DAYS.CURRENTşDAYS.1.30=AP.REC<2>; DASH.REC<18>=DAYS.1.30şDAYS.31.60=AP.REC<3>; DASH.REC<21>=DAYS.31.60şDAYS.61.90=AP.REC<4>; DASH.REC<24>=DAYS.61.90şDAYS.91=AP.REC<5>; DASH.REC<27>=DAYS.91şTEMP.AP.REC=AP.RECşCONVERT CHAR(254) TO CHAR(253) IN TEMP.AP.RECşAP.AMOUNTS=TEMP.AP.RECş*ş* DEFAULT CONVERSIONS TO $şCONVS=''şFOR I = 3 TO 32ş      CONVS<I>='$'ş NEXT Iş* CHANGE THOSE THAT AREN'TşCONVS<7>='%'; CONVS<8>='%'şCONVS<17>='%'; CONVS<20>='%'; CONVS<23>='%'; CONVS<26>='%'; CONVS<31>='%'şCONVS<1>=''; CONVS<2>=''şCONVS<9>=''; CONVS<10>=''şCONVS<13>=''; CONVS<14>=''; CONVS<15>=''ş*ş*şW$PRINTABLE=1şW$PDFABLE=1şOPEN '','WEB.FORMS' TO FILE.WEB.FORMS ELSE RETURNşBEGIN CASEş   CASE AR.REPORT.FILE <> '' AND AP.REPORT.FILE <> '' AND GP.DICT.NAME <> ''ş      WEB.FORM.NAME='PORTAL.DASHBOARD'ş   CASE GP.DICT.NAME <> '' AND AR.REPORT.FILE <> ''ş      WEB.FORM.NAME='PORTAL.DASHBOARD.SALES.GP.AR'ş   CASE GP.DICT.NAME <> ''ş      WEB.FORM.NAME='PORTAL.DASHBOARD.SALES.GP'ş   CASE AR.REPORT.FILE <> '' AND AP.REPORT.FILE <> ''ş      WEB.FORM.NAME='PORTAL.DASHBOARD.SALES.AR.AP'ş   CASE AR.REPORT.FILE <> ''ş      WEB.FORM.NAME='PORTAL.DASHBOARD.SALES.AR'ş   CASE 1ş      WEB.FORM.NAME='PORTAL.DASHBOARD.SALES'şEND CASEşREAD HTML FROM FILE.WEB.FORMS, WEB.FORM.NAME ELSE HTML=''ş*ş**USER.ID=G$USERIDş*şW$TITLE='  Portal Dashboard'; CALL PORTAL.SHOW.LAST.UPDATED('ALL')ş*ş*WRITE HTML ON FILE.WEB.FORMS, 'TEST.HTML'ş*ş** DYNAMIC VARIABLESş*şFOR I = 1 TO 32ş   INSERT.FIELD=DASH.REC<I>ş   IF INSERT.FIELD = '' THEN INSERT.FIELD=Iş   CONV=CONVS<I>ş   BEGIN CASEş      CASE CONV = ''; NULLş      CASE CONV = '$'; INSERT.FIELD=OCONV(INSERT.FIELD+0,'MD2,$')ş      CASE CONV = '%'; INSERT.FIELD=OCONV(INSERT.FIELD+0,'MD1'):'%'ş      CASE 1; INSERT.FIELD=OCONV(INSERT.FIELD,CONV)ş   END CASEş   IF INSERT.FIELD = '' THEN INSERT.FIELD='&nbsp;'ş   CALL SWAP(HTML,'~':I:'~',INSERT.FIELD)ş NEXT Iş   *şW$TEXT.DATA=HTMLşWRITE HTML ON FILE.WEB.FORMS, 'LAST.':WEB.FORM.NAMEşRETURNş*ş*şDISPLAY.ERROR:ş*şW$TYPE='HTML'şMAX.LINES=DCOUNT(ERROR.MSG,CHAR(254))şIF MAX.LINES > 1 THENş   TEMP.ERROR.MSG=ERROR.MSGş   ERROR.MSG=''ş   FOR ERROR.LINE = 1 TO MAX.LINESş      THIS.MSG=TEMP.ERROR.MSG<ERROR.LINE>ş      IF ERROR.MSG <> '' THEN ERROR.MSG:='<br>'ş      ERROR.MSG:=THIS.MSGş    NEXT ERROR.LINEş ENDşW$HTML.DATA='<h3>':ERROR.MSG:'</h3>'şRETURNş*şINITIATE.CALC.PHANTOM:ş*şBEGIN CASEş   CASE PLATFORM = 'D3' OR PLATFORM = 'JB'ş      EXECUTE "Z REFRESH.DASHBOARD.MTD.STATS ":TYPE.CALC CAPTURING DUMMYş   CASE 1ş      EXECUTE "PHANTOM REFRESH.DASHBOARD.MTD.STATS ":TYPE.CALC CAPTURING DUMMYşEND CASEşRETURN0011F2SUB.RUNTIME.ERRORSş0c2SUBROUTINE SUB.RUNTIME.ERRORSş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Report Runtime Errorsş*ş* UniVerse version (N/A)ş*şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "MVDB Runtime Errors"şW$TYPE = "HTML"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURN ;* Dont process, just provide title, type & widthş*şIF WIDGET.USER.DATA(2) # "" THENş  ACCTFILTER = WIDGET.USER.DATA(2)ş  W$TITLE = "Runtime Errors (User/Account filter = ":ACCTFILTER:")"şEND ELSEş  IF G$SUBMITTED THENş    ACCTFILTER = "ALL"ş  END ELSE ;* It's empty, but only becuase nobody has specified a valueş    ACCTFILTER = @WHOş  ENDş  WIDGET.USER.DATA(2) = ACCTFILTERşENDşIF WIDGET.USER.DATA(3) # "" THENş  PROGFILTER = WIDGET.USER.DATA(3)şEND ELSE PROGFILTER = ""şSTOP 201, 'RUNTIME-ERRORS'ş*XLINE = 'SSELECT DM,RUNTIME-ERRORS, BY-DSND DATE BY-DSND TIME'ş*IF ACCTFILTER # "ALL" THENş  *XLINE := ' WITH USERPIB = "[':ACCTFILTER:']"'ş  *WITH.USED = 1ş*END ELSE WITH.USED = 0ş*IF PROGFILTER # "ALL" AND PROGFILTER # "" THENş  *IF WITH.USED THEN XLINE := ' AND'ş  *XLINE := ' WITH PROGNAME = "':PROGFILTER:'"'ş*ENDş*EXECUTE XLINE CAPTURING JUNKş*IF WIDGET.USER.DATA(1) = 'CLEAR' THENş  *LOOPş    *READNEXT ID ELSE EXITş    *DELETE F.RUNTIME.ERRORS, IDş  *REPEATş  *WIDGET.USER.DATA(1) = ""ş*ENDş*IF SYSTEM(11) THENş  *IF SYSTEM(11) > 100 THEN MAX.DISPLAY = 100 ELSE MAX.DISPLAY = SYSTEM(11)ş  *W$HTML.DATA = '<h3>1 - ':MAX.DISPLAY:' of ':SYSTEM(11):'</h3>'ş  *W$HTML.DATA := '<table><tr>'ş  *W$HTML.DATA := '<th>Date / Time</th><th>User</th><th>Error</th>'ş  *W$HTML.DATA := '</tr>'ş*END ELSEş  *W$HTML.DATA = '<h3>No Errors</h3>'ş*ENDş*ERR.CNT = 0ş*LOOPş  *READNEXT ID ELSE EXITş  *READ RECORD FROM F.RUNTIME.ERRORS, ID ELSE CONTINUEş  *DATA RECORD<2,1>ş  *EXECUTE "PRINT-ERR DM,MESSAGES, ":RECORD<1>:" (S" CAPTURING ERRş  **ş  *CONVERT @AM TO " " IN ERRş  *ERR = OCONV(ERR,'MCP')ş  *ERR = TRIM(ERR)ş  *PROG = RECORD<4>ş  *DESC = PROG:" ":ERRş  *USERPIB = RECORD<3>ş  *STACK = ""ş  *FOR N = DCOUNT(RECORD<5>,@VM) TO 1 STEP -1ş    *STACK := RECORD<5,N>ş    *IF STACK # "" AND N # 1 THEN STACK := ' --> 'ş  *NEXT Nş  *IF RECORD<5> # '' THEN DESC := "Stack: ":STACKş  *MD = FIELD( RECORD<3>, ' ', 3 )ş  **ş  ** Try and find the source code to include in the feed.ş  **ş  *SREC = "" ; FNAME = ""ş  *OPEN MD:",MD," TO F.MD THENş    *FNAME = ""ş    *READ CREC FROM F.MD, RECORD<4> THENş      *IF CREC<1> = "VR" THEN ;* This is a catalog pointer, file name is in field 4ş        *FNAME = FIELD(CREC<4>,' ',1)ş      *END ELSE IF CREC<1> = "PQ" THENş        *IF FIELD(CREC<2>, ' ', 1 ) = "HRUN" THENş          *FNAME = FIELD( CREC<2>, ' ', 2 )ş        *ENDş      *ENDş    *ENDş    *IF FNAME # "" THENş      *OPEN MD:",":FNAME:"," TO SFILE THENş        *READ SREC FROM SFILE, RECORD<4> ELSE SREC = ""ş      *ENDş    *ENDş  *ENDş  *SOURCE.SNIP = ""ş  *IF SREC # "" THENş    *CALL SWAP(SREC,'&','&amp;')ş    *CALL SWAP(SREC,'<','&lt;')ş    *CALL SWAP(SREC,'>','&gt;')ş    *LINENO = RECORD<2,1>ş    *IF LINENO MATCHES "1N0N" THENş      *START.LINE = LINENO - 3ş      *IF START.LINE < 0 THEN START.LINE = 1ş    *END ELSE LINENO = 1 ; START.LINE = 1ş    *END.LINE = LINENO + 3ş    *SOURCE.SNIP = \<code style="font-size:12px" >\ş    *FOR LN = START.LINE TO END.LINEş      *LINE = LN "R#4":" ":SREC<LN>ş      *SOURCE.SNIP := LINE:'<br />'ş    *NEXT LNş    *SOURCE.SNIP := '</code>'ş    *EDIT.LINK = '<a href="/dbc/MVDB.WEB.ED?ed_acct=':MD:'&ed_file=':FNAME:'&ed_item=':PROG:'" target="':MD:'_':FNAME:'_':PROG:'">Edit Source</a>'ş    *SOURCE.SNIP := EDIT.LINKş  *END ELSEş    *SOURCE.SNIP = 'Unable to open source code for ':RECORD<4>:' in account ':MDş  *ENDş  *DATE = FIELD(ID,'*',1)ş  *TIME = FIELD(ID,'*',2)ş  **ş  *W$HTML.DATA<-1> = '<tr valign="top"><td>':OCONV(DATE,'D2/'):" ":OCONV(TIME,'MTS'):'</td>'ş  *W$HTML.DATA<-1> = '<td>':USERPIB:'</td>'ş  *W$HTML.DATA<-1> = '<td>':DESC:'</td>'ş  *W$HTML.DATA<-1> = '</tr>'ş  *W$HTML.DATA<-1> = '<tr valign="top"><td>&nbsp;</td><td colspan="2">':SOURCE.SNIP:'</td></tr>'ş  *ERR.CNT += 1ş*UNTIL ERR.CNT > 100 DO REPEATş*W$HTML.DATA<-1> = '</table>'ş**ş*W$LINK.LABEL<1> = "Clear Errors"ş*W$LINK.LOCATION<1> = '1'ş*W$LINK.UD.POS<1> = 1ş*W$LINK.UD.VAL<1> = 'CLEAR'ş**ş*W$LINK.LABEL<2> = "Print"ş*W$LINK.LOCATION<2> = "C"ş*W$LINK.ICON<2> = "print.png"ş*W$LINK.URL<2> = "javascript:printThis(this);"ş**ş*W$INPUT.PROMPT<1> = "User/Acct Filter"ş*W$INPUT.TYPE<1> = "TEXT"ş*W$INPUT.UDPOS<1> = 2ş*W$INPUT.DEFAULT<1> = WIDGET.USER.DATA(2)ş**ş*W$INPUT.PROMPT<2> = "Program Filter"ş*W$INPUT.TYPE<2> = "TEXT"ş*W$INPUT.UDPOS<2> = 3ş*W$INPUT.DEFAULT<2> = WIDGET.USER.DATA(3)ş*şRETURN0006B0SUB.SYS.ERRSş0c2SUBROUTINE SUB.SYS.ERRSş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Show system errorsş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "TABLE"şW$TITLE = "Recent System Errors"şW$WIDTH = 3ş*şIF G$QUERYMODE = "1" THEN RETURNş*şOPEN '','SYSTEM-ERRORS' TO F.SYSTEM.ERRORS ELSE RETURNş*şXLINE = 'SSELECT SYSTEM-ERRORS BY-DSND DATE BY-DSND TIME'şEXECUTE XLINE CAPTURING JUNKş*şW$TABLE.COL.LABELS = "Date":@VM:"Time":@VM:"Message":@VM:"Last TCL":@VM:"Pib / User":@VM:"Data"şW$TABLE.COL.JUST = "right":@VM:"right"ş*ş* User data 2 is the number of items to skip forward or backward. Calculateş* the offset by adding this number to the current offset position in field 1.ş* Then clear out the skip fowrad/backward value.ş*şWIDGET.USER.DATA(1) = WIDGET.USER.DATA(1) + WIDGET.USER.DATA(2)şWIDGET.USER.DATA(2) = 0şIF WIDGET.USER.DATA(1) < 0 THEN WIDGET.USER.DATA(1) = 0ş*şIF WIDGET.USER.DATA(1) > 0 THENş  W$TITLE := " (":WIDGET.USER.DATA(1)+1:" - ":WIDGET.USER.DATA(1)+11:")"şENDş*şOFFSET = WIDGET.USER.DATA(1)şFOR SKIPITEM = 1 TO OFFSETş  READNEXT THROWAWAY ELSE EXITşNEXT SKIPITEMşFOR X = 1 TO 10ş  READNEXT ID ELSE EXITş  READ EREC FROM F.SYSTEM.ERRORS, ID THENş    W$TABLE.DATA<X,1> = OCONV( FIELD( ID,'*',1),'D2/')ş    W$TABLE.DATA<X,2> = OCONV( FIELD( ID,'*',2),'MTS')ş    W$TABLE.DATA<X,3> = EREC<4,1>ş    W$TABLE.DATA<X,4> = EREC<22,DCOUNT(EREC<22>,@VM)>ş    W$TABLE.DATA<X,5> = EREC<12,1>ş    W$TABLE.DATA<X,6> = EREC<5,1>ş  ENDşNEXT Xş*şW$LINK.LABEL<1,1> = "Prev 10"şW$LINK.LABEL<1,2> = "Next 10"şW$LINK.LOCATION<1,1> = "23"şW$LINK.LOCATION<1,2> = "14"şW$LINK.UD.POS<1,1> = 2şW$LINK.UD.POS<1,2> = 2şW$LINK.UD.VAL<1,1> = "-10"şW$LINK.UD.VAL<1,2> = "10"ş*şRETURN00022DUD.EXECUTE.STACKED.CMNDSş0c2SUBROUTINE UD.EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,NUM.RETURNED,REPORT)ş*şREPORT=''şNUM.RETURNED=1şLIST_VAR = 1şIF STACKED.1 <> '' THENş   MDPERFORM STACKED.1 RTNLIST LIST_VAR RETURNING RETNO CAPTURING CAPTş   IF INDEX(RETNO,'No data',1) OR INDEX(CAPT,'No data',1) THENş      NUM.RETURNED=0ş      RETURNş    ENDş   MDPERFORM STACKED.2 PASSLIST LIST_VAR CAPTURING REPORTş END ELSEş   MDPERFORM STACKED.2 CAPTURING REPORTş ENDşIF INDEX(REPORT,'No records',1) THENş   NUM.RETURNED=0ş ENDşCONVERT '$,' TO '' IN REPORTşRETURNşEND002557BUILD.SAMPLE.PORTAL.FILESş0c2OPEN '','PORTAL.SALES' TO FI.SALES ELSE STOP 201,'PORTAL.SALES'şOPEN '','PORTAL.AR' TO FI.AR ELSE STOP 201,'PORTAL.AR'şOPEN '','PORTAL.AP' TO FI.AP ELSE STOP 201,'PORTAL.AP'şREAD SALES.1 FROM FI.SALES, 1 ELSE SALES.1=''şREAD AR.1 FROM FI.AR, 1 ELSE AR.1=''şREAD AP.1 FROM FI.AP, 1 ELSE AP.1=''şIF SALES.1 <> '' AND AR.1 <> '' AND AP.1 <> '' THEN STOPşOTODAY=OCONV(DATE(),'D4-')şOYYYY=OTODAY[7,4]şOMM=OTODAY[1,2]+0şREPS=''şREPS<-1>='GREG GRIFFIN'şREPS<-1>='KELLEY JOHNSON'şREPS<-1>='KEVIN PEPE'şREPS<-1>='KIM GONZALEZ'şREPS<-1>='MICHAEL HOUSE'şREPS<-1>='MICHELLE BLACK'şREPS<-1>='MITCH STREET'şREPS<-1>='NATALIE MCFARLAND'şREPS<-1>='PETE COX'şREPS<-1>='PHIL CRAMER'şREPS<-1>='ROBERT HUNT'şREPS<-1>='STEVE SMITH'şREPS<-1>='TAMMY HENDER'şREPS<-1>='TIFFANEY MILLER'şBRANCHES=''şBRANCHES<-1>='CHICAGO'şBRANCHES<-1>='DALLAS'şBRANCHES<-1>='DENVER'şBRANCHES<-1>='FLORIDA'şBRANCHES<-1>='NEW YORK'şBRANCHES<-1>='NORCAL'şBRANCHES<-1>='SOCAL'şBRANCHES<-1>='VEGAS'şREGIONS=''şREGIONS<-1>='CENTRAL'şREGIONS<-1>='EAST'şREGIONS<-1>='MOUNTAIN'şREGIONS<-1>='WEST'şEXECUTE "CLEAR-FILE DATA PORTAL.SALES" CAPTURING DUMMYşJAN12016=ICONV('1-1-16','D')şDATE.RANGE=DATE()-JAN12016şFOR I = 1 TO 10000ş   SALES.REC=''ş   CLOSE.DATE=JAN12016 + RND(DATE.RANGE) + 1ş   SALES.REC<1>=CLOSE.DATEş   RND.REP=RND(14)+1ş   IF RND.REP < 12 THENş      RND.PCT=((RND(10)+1)/10)ş      RND.REP=INT(RND.REP * RND.PCT + .5)ş      IF NOT(RND.REP) THEN RND.REP=1ş    ENDş   REP=REPS<RND.REP>ş   SALES.REC<5>=REPş   AMOUNT=RND(975000)+25000; * 250 TO 10000ş   SALES.REC<8>=AMOUNTş   COST.PCT=RND(40) + 50; * 50 TO 90 PERCENTş   COST.PCT=COST.PCT / 100ş   COST=INT(AMOUNT * COST.PCT + .5)ş   SALES.REC<9>=COSTş   RND.BRANCH=RND(8)+1ş   IF RND.BRANCH < 6 THENş      RND.PCT=((RND(10)+1)/10)ş      RND.BRANCH=INT(RND.BRANCH * RND.PCT + .5)ş      IF NOT(RND.BRANCH) THEN RND.BRANCH=1ş    ENDş   BRANCH=BRANCHES<RND.BRANCH>ş   SALES.REC<13>=BRANCHş   RND.REGION=RND(4)+1ş   IF RND.REGION < 4 THENş      RND.PCT=((RND(10)+1)/10)ş      RND.REGION=INT(RND.REGION * RND.PCT + .5)ş      IF NOT(RND.REGION) THEN RND.REGION=1ş    ENDş   REGION=REGIONS<RND.REGION>ş   SALES.REC<14>=REGIONş   WRITE SALES.REC ON FI.SALES, Iş NEXT IşCUSTS=''şCUSTS<-1>="ABC Computers"şCUSTS<-1>="ABC Electronics Corp"şCUSTS<-1>="Ajax Computer Electronics"şCUSTS<-1>="Alfreds Futterkiste"şCUSTS<-1>="Ana Trujillo Emparedados y helados"şCUSTS<-1>="Antonio Moreno Taqueria"şCUSTS<-1>="Around the Horn"şCUSTS<-1>="B'S Beverages"şCUSTS<-1>="Bakers Goods"şCUSTS<-1>="Berglunds snabbkop"şCUSTS<-1>="Best Computer Company"şCUSTS<-1>="Better Bytes"şCUSTS<-1>="Better Computing"şCUSTS<-1>="Better Connection"şCUSTS<-1>="Bills Shoes & Gopeds"şCUSTS<-1>="Bits and Bytes Inc"şCUSTS<-1>="Blauer See Delikatessen"şCUSTS<-1>="Blondel pere et fils"şCUSTS<-1>="Bobs Used Cycles"şCUSTS<-1>="Bon app"şCUSTS<-1>="Bottom-Dollar Markets"şCUSTS<-1>="Cactus Comidas para llevar"şCUSTS<-1>="Centro comercial Moctezuma"şCUSTS<-1>="Chop-suey Chinese"şCUSTS<-1>="Classic Computers"şCUSTS<-1>="Comp Data Inc."şCUSTS<-1>="Comp Products"şCUSTS<-1>="Computer Fancy"şCUSTS<-1>="Computer Portables Inc."şCUSTS<-1>="Computer Sitters"şCUSTS<-1>="Computer Tech"şCUSTS<-1>="Computer Tips"şCUSTS<-1>="Computer Town"şCUSTS<-1>="Computer Trainers"şCUSTS<-1>="Computer Warehouse"şCUSTS<-1>="Computers Etc."şCUSTS<-1>="Computers Galore"şCUSTS<-1>="Computers Inc.Systems"şCUSTS<-1>="Computers N More"şCUSTS<-1>="Computers R Us"şCUSTS<-1>="Consolidated Holdings"şCUSTS<-1>="Cyber Products"şCUSTS<-1>="Data Bits"şCUSTS<-1>="Data Comp"şCUSTS<-1>="Data Net"şCUSTS<-1>="Die Wandernde Kuh"şCUSTS<-1>="Disk Products"şCUSTS<-1>="Disks N More"şCUSTS<-1>="Drachenblut Delikatessen"şCUSTS<-1>="Du monde entier"şCUSTS<-1>="Eastern Connection"şCUSTS<-1>="Electronic Company"şCUSTS<-1>="Ernst Handel"şCUSTS<-1>="Familia Arquibaldo"şCUSTS<-1>="FISSA Fabrica Inter. Salchichas S.A."şCUSTS<-1>="Folies gourmandes"şCUSTS<-1>="For Computers Inc."şCUSTS<-1>="France restauration"şCUSTS<-1>="Franchi S.p.A."şCUSTS<-1>="Frankenversand"şCUSTS<-1>="Furia Bacalhau e Frutos do Mar"şCUSTS<-1>="Future Computers"şCUSTS<-1>="Future In Computing"şCUSTS<-1>="Galeria del gastronomo"şCUSTS<-1>="Godos Cocina Tipica"şCUSTS<-1>="Gourmet Lanchonetes"şCUSTS<-1>="Great Lakes Food Market"şCUSTS<-1>="GROSELLA-Restaurante"şCUSTS<-1>="Hanari Carnes"şCUSTS<-1>="HILARION-Abastos"şCUSTS<-1>="Hungry Coyote Import Store"şCUSTS<-1>="HUNGRY HOWIES PIZZA"şCUSTS<-1>="Hungry Owl All-Night Grocers"şCUSTS<-1>="Intercom Products"şCUSTS<-1>="Island Trading"şCUSTS<-1>="Joe'S Computers"şCUSTS<-1>="Koniglich Essen"şCUSTS<-1>="La corne d'abondance"şCUSTS<-1>="Lazy K Kountry Store"şCUSTS<-1>="Lehmanns Marktstand"şCUSTS<-1>="Let'S Stop N Shop"şCUSTS<-1>="LILA-Supermercado"şCUSTS<-1>="LINO-Delicateses"şCUSTS<-1>="Logical Computers"şCUSTS<-1>="Lonesome Pine Restaurant"şCUSTS<-1>="Longo Toyota"şCUSTS<-1>="Magazzini Alimentari Riuniti"şCUSTS<-1>="Memory Capturers"şCUSTS<-1>="Memory Plus Inc."şCUSTS<-1>="Modem Products"şCUSTS<-1>="Morgenstern Gesundkost"şCUSTS<-1>="Net Connect"şCUSTS<-1>="North/South"şCUSTS<-1>="Number One in Computing"şCUSTS<-1>="Oceano Atlantico Ltda."şCUSTS<-1>="Old World Delicatessen"şCUSTS<-1>="Ones & Zeros Inc."şCUSTS<-1>="Ottilies Kaseladen"şCUSTS<-1>="Paris specialites"şCUSTS<-1>="Pericles Comidas clasicas"şCUSTS<-1>="Piccolo und mehr"şCUSTS<-1>="Printer Products"şCUSTS<-1>="Que Delicia"şCUSTS<-1>="Queen Cozinha"şCUSTS<-1>="QUICK-Stop"şCUSTS<-1>="Rancho grande"şCUSTS<-1>="Rattlesnake Canyon Grocery"şCUSTS<-1>="Real Computers"şCUSTS<-1>="Reggiani Caseifici"şCUSTS<-1>="Ricardo Adocicados"şCUSTS<-1>="Richter Supermarkt"şCUSTS<-1>="Sante Gourmet"şCUSTS<-1>="Save-a-lot Markets"şCUSTS<-1>="Secure Computers"şCUSTS<-1>="Seven Seas Imports"şCUSTS<-1>="Software Inc"şCUSTS<-1>="Specialites du monde"şCUSTS<-1>="Split Rail Beer & Ale"şCUSTS<-1>="Supremes delices"şCUSTS<-1>="The Big Cheese"şCUSTS<-1>="The Cracker Box"şCUSTS<-1>="The Only Computers"şCUSTS<-1>="Tortuga Restaurante"şCUSTS<-1>="Tradicao Hipermercados"şCUSTS<-1>="Trail'S Head Gourmet Provisioners"şCUSTS<-1>="TRG"şCUSTS<-1>="USA Computers"şCUSTS<-1>="Victuailles en stock"şCUSTS<-1>="Vins et alcools Chevalier"şCUSTS<-1>="Wartian Herkku"şCUSTS<-1>="Wellington Importadora"şCUSTS<-1>="White Clover Markets"şCUSTS<-1>="White House"şCUSTS<-1>="Wilman Kala"şCUSTS<-1>="Wolski  Zajazd"şEXECUTE "CLEAR-FILE DATA PORTAL.AR" CAPTURING DUMMYşFOR I = 1 TO 5000ş   AR.REC=""ş   CUST=CUSTS<RND(135)+1>ş   AR.REC<1>=CUSTş   PCT=RND(100)+1ş   IF PCT > 4 THENş      * PAIDş      QTR=RND(18)+1; * BASED ON DATE BEFORE 7-1-20ş      BEGIN CASEş         CASE OYYYY > 2020; QTR+=2ş         CASE OMM >= 10; QTR+=2ş         CASE OMM >= 7;  QTR+=1ş      END CASEş      BEGIN CASEş         CASE QTR <= 4;   * 2016ş            BREAKS=71:@AM:87:@AM:93ş            BOY=ICONV("01-01-16","D")ş            QTR.IN.YEAR=QTRş         CASE QTR <= 8;   * 2017ş            BREAKS=73:@AM:89:@AM:94ş            BOY=ICONV("01-01-17","D")ş            QTR.IN.YEAR=QTR-4ş         CASE QTR <= 12;   * 2018ş            BREAKS=77:@AM:89:@AM:94ş            BOY=ICONV("01-01-18","D")ş            QTR.IN.YEAR=QTR-8ş         CASE QTR <= 16;   * 2019ş            BREAKS=77:@AM:90:@AM:94ş            BOY=ICONV("01-01-19","D")ş            QTR.IN.YEAR=QTR-12ş         CASE 1;          * 2020ş            BREAKS=71:@AM:87:@AM:93ş            BOY=ICONV("01-01-20","D")ş            QTR.IN.YEAR=QTR-16ş      END CASEş      BOQ=BOY + (QTR.IN.YEAR-1)*90ş      DATE.PAID=BOQ + RND(90) + 1ş      DAYS.IN.PERIOD=RND(30)+1ş      PCT=RND(100)ş      LOCATE PCT IN BREAKS BY "AR" SETTING CATEGORY ELSE NULLş      MOS.BEFORE=CATEGORY-1ş      DUE.DATE=DATE.PAID - (MOS.BEFORE*30) - DAYS.IN.PERIODş      AR.REC<20>=DUE.DATEş      AR.REC<8>=DATE.PAIDş      AR.REC<50>=0; * BALANCEş      AMOUNT=RND(975000)+25000; * 250 TO 10000ş      AR.REC<6>=AMOUNTş      WRITE AR.REC ON FI.AR, Iş    END ELSEş      BREAKS=60:@AM:81:@AM:91:@AM:96ş      PCT=RND(100)+1ş      LOCATE PCT IN BREAKS BY "AR" SETTING CATEGORY ELSE NULLş      DAY.IN.MONTH=RND(30)ş      BEGIN CASEş         CASE CATEGORY = 1ş            * NOT YET DUEş            DUE.DATE=DATE()+DAY.IN.MONTHş         CASE CATEGORY = 2ş            * 1-30ş            DUE.DATE=DATE()-DAY.IN.MONTHş         CASE CATEGORY = 3ş            * 31-60ş            DUE.DATE=DATE() - (30 + DAY.IN.MONTH)ş         CASE CATEGORY = 4ş            * 60-90ş            DUE.DATE=DATE() - (60 + DAY.IN.MONTH)ş         CASE 1ş            * 90+ş            DUE.DATE=DATE() - (90 + RND(120))ş      END CASEş      AR.REC<20>=DUE.DATEş      AR.REC<8>=''; * DATE PAIDş      AMOUNT=RND(975000)+25000; * 250 TO 10000ş      AR.REC<6>=AMOUNTş      AR.REC<50>=AMOUNT; * BALANCEş      WRITE AR.REC ON FI.AR, Iş    ENDş NEXT IşEXECUTE "CLEAR-FILE DATA PORTAL.AP" CAPTURING DUMMYşFOR I = 1 TO 100ş   AP.REC=""ş   BREAKS=56:@AM:90:@AM:95:@AM:97ş   PCT=RND(100)+1ş   LOCATE PCT IN BREAKS BY "AR" SETTING CATEGORY ELSE NULLş   DAY.IN.MONTH=RND(30)ş   BEGIN CASEş      CASE CATEGORY = 1ş         * NOT YET DUEş         DUE.DATE=DATE()+DAY.IN.MONTHş      CASE CATEGORY = 2ş         * 1-30ş         DUE.DATE=DATE()-DAY.IN.MONTHş      CASE CATEGORY = 3ş         * 31-60ş         DUE.DATE=DATE() - (30 + DAY.IN.MONTH)ş      CASE CATEGORY = 4ş         * 60-90ş         DUE.DATE=DATE() - (60 + DAY.IN.MONTH)ş      CASE 1ş         * 90+ş         DUE.DATE=DATE() - (90 + DAY.IN.MONTH)ş   END CASEş   AP.REC<20>=DUE.DATEş   AP.REC<8>=''; * DATE PAIDş   AMOUNT=RND(975000)+25000; * 250 TO 10000ş   AP.REC<6>=AMOUNTş   AP.REC<50>=AMOUNT; * BALANCEş   WRITE AP.REC ON FI.AP, Iş NEXT I000715SUB.DEMO.MAP.CANADAş0c2SUBROUTINE SUB.DEMO.MAP.CANADAş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: US Map demonstrationş* 6-1-15 ZUMASYS CONVERT MAP.DATA ID DELIMETER FROM * TO #ş*ş* Modified by Peter Schellenbach of Zumasys 06-08-15:ş*  Changed test of ENUM after EXECUTE to test SYSTEM(11) instead.ş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Demo - Canadian Provinces by Alphabet"şW$TYPE = "MAP:Canada"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şOPEN '','MVDB.MAP.DATA' TO F.MVDB.MAP.DATA ELSE STOP 201, 'MVDB.MAP.DATA'ş*şW$CHART.OPTIONS<-1> = 'animation="0"'şW$CHART.OPTIONS<-1> = 'showShadow="1"'ş* 10-17-16 deprecated * W$CHART.OPTIONS<-1> = 'showBevel="1"'şW$CHART.OPTIONS<-1> = 'legendShadow="1"'şW$CHART.OPTIONS<-1> = 'legendAllowDrag="1"'ş*ş*6-1-15*EXECUTE \SSELECT MVDB.MAP.DATA = "CANADA*]" BY A1\ RETURNING ENUM CAPTURING ETXTşEXECUTE \SSELECT MVDB.MAP.DATA = "CANADA#]" BY A1\ RETURNING ENUM CAPTURING ETXT; *6-1-15ş*PJS 06-08-15*IF ENUM[1,3]="404" THENşIF SYSTEM(11) THEN ; *PJS 06-08-15*ş LOOPş   READNEXT ID ELSE ID="\\EOF"ş UNTIL ID="\\EOF" DOş   READ I FROM F.MVDB.MAP.DATA,ID THENş*6-1-15*     W$MAP.IDS<1,-1> = FIELD(ID,'*',2)ş     W$MAP.IDS<1,-1> = FIELD(ID,'#',2); *6-1-15*ş     W$MAP.VALUES<1,-1> = (SEQ(I<1>[1,1]) - (SEQ('A')-1))ş     W$MAP.VALUE.TOOLTEXT<1,-1> := I<2>:' (':I<1>:')'ş   ENDş REPEATşENDş*şW$MAP.RANGE.NAME<1,1> = "Early in Alphabet"şW$MAP.RANGE.LOW<1,1> = "1"şW$MAP.RANGE.HIGH<1,1> = "10"şW$MAP.RANGE.COLOR<1,1> = "GREEN"şW$MAP.RANGE.NAME<1,2> = "Middle of Alphabet"şW$MAP.RANGE.LOW<1,2> = "10"şW$MAP.RANGE.HIGH<1,2> = "18"şW$MAP.RANGE.COLOR<1,2> = "YELLOW"şW$MAP.RANGE.NAME<1,3> = "Late in Alphabet"şW$MAP.RANGE.LOW<1,3> = "18"şW$MAP.RANGE.HIGH<1,3> = "27"şW$MAP.RANGE.COLOR<1,3> = "RED"ş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN00029ESUB.DEMO.DNUTş0c2SUBROUTINE SUB.DEMO.DNUTş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Doughnut Chart Demonstrationş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Demo - Defects by Reason"şW$TYPE = "FCDOUGHNUT2D"şW$WIDTH = 1ş*şIF G$QUERYMODE THEN RETURNş*şCATEG = ""şCATEG<1> = 20şCATEG<2> = 30şCATEG<3> = 20şCATEG<4> = 9ş*şCATEG.NAMES = ''şCATEG.NAMES<1> = "Choices"şCATEG.NAMES<2> = "Material"şCATEG.NAMES<3> = "Errors"şCATEG.NAMES<4> = "Shipping"ş*şFOR N = 1 TO DCOUNT(CATEG.NAMES,@AM)ş  W$PIE.LABELS<1,N> = CATEG.NAMES<N>ş  W$PIE.VALUES<1,N> = CATEG<N>şNEXT NşW$PIE.CAPTION = "Defects"ş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN001B05REFRESH.DASHBOARD.CLOSING.STATSş0c2EXECUTE "TERM 132" CAPTURING DUMMYşOPEN '','MVDB.SUBS' TO FI.MVDB.SUBS ELSE NULLşERRORS=''şOPEN '','DASHBOARD.CLOSING.STATS' TO FI.CLOSING.STATS ELSE ERRORS<-1>='UNABLE TO OPEN DASHBOARD.CLOSING.STATS'şHAVE.DICT.STATS=1şOPEN 'DICT','DASHBOARD.CLOSING.STATS' TO FI.DICT.CLOSING.STATS ELSE HAVE.DICT.STATS=0; ERRORS<-1>='UNABLE TO OPEN DICT DASHBOARD.CLOSING.STATS'şOPEN '','MVDB.CONTROL' TO FI.MVDB.CONTROL ELSE NULLşIF ERRORS <> '' THENş   WRITE ERRORS ON FI.MVDB.CONTROL, 'CLOSING.STATS.ERRORS'ş   IF HAVE.DICT.STATS THENş      WRITE 'CLOSING.STATS.ERRORS' ON FI.DICT.CLOSING.STATS, '*LAST.UPDATE'ş    ENDş   STOPş ENDşREAD PLATFORM FROM FI.MVDB.CONTROL, 'PLATFORM' ELSE PLATFORM='D3'şBEGIN CASEş   CASE PLATFORM = 'UD'ş      EXECUTE.STACKED.CMNDS='UD.EXECUTE.STACKED.CMNDS'ş   CASE PLATFORM = 'UV'ş      EXECUTE.STACKED.CMNDS='UV.EXECUTE.STACKED.CMNDS'ş   CASE PLATFORM = 'QM'ş      EXECUTE.STACKED.CMNDS='EXECUTE.STACKED.CMNDS'ş   CASE 1ş      * D3 AND JBASE ARE THE SAMEş      EXECUTE.STACKED.CMNDS='EXECUTE.STACKED.CMNDS'şEND CASEş*şDIM SETUP.PARAMS(30)şMATREAD SETUP.PARAMS FROM FI.MVDB.CONTROL, 'PORTAL.SALES.REPORT.SETUP' ELSEş   MAT SETUP.PARAMS=''ş ENDşEQUATE ACCOUNT TO SETUP.PARAMS(1)şEQUATE REPORT.FILE TO SETUP.PARAMS(2)şEQUATE SALE.DATE.DICT TO SETUP.PARAMS(3)şEQUATE SALE.MONTH.DICT TO SETUP.PARAMS(4)şEQUATE SALE.YEAR.DICT TO SETUP.PARAMS(5)şEQUATE SALE.AMOUNT.DICT TO SETUP.PARAMS(6)şEQUATE COST.OF.SALE.AMOUNT.DICT TO SETUP.PARAMS(7)şEQUATE SALESMAN.DICT TO SETUP.PARAMS(8)şEQUATE BRANCH.DICT TO SETUP.PARAMS(9)şEQUATE REGION.DICT TO SETUP.PARAMS(10)şEQUATE SALE.DATE.AMC TO SETUP.PARAMS(11)şEQUATE SALE.AMOUNT.AMC TO SETUP.PARAMS(12)şEQUATE SALE.AMOUNT.CONV TO SETUP.PARAMS(13)şEQUATE SALE.AMOUNT.COOR TO SETUP.PARAMS(14)şEQUATE COST.OF.SALE.AMOUNT.AMC TO SETUP.PARAMS(15)şEQUATE COST.OF.SALE.AMOUNT.CONV TO SETUP.PARAMS(16)şEQUATE COST.OF.SALE.AMOUNT.COOR TO SETUP.PARAMS(17)şEQUATE SALESMAN.AMC TO SETUP.PARAMS(18)şEQUATE SALESMAN.TFILE TO SETUP.PARAMS(19)şEQUATE BRANCH.AMC TO SETUP.PARAMS(20)şEQUATE BRANCH.TFILE TO SETUP.PARAMS(21)şEQUATE REGION.AMC TO SETUP.PARAMS(22)şEQUATE REGION.TFILE TO SETUP.PARAMS(23)ş*ş**FILE.PATH=ACCOUNT:',':REPORT.FILE:','şFILE.PATH='DASHBOARD.SALES.FILE'ş*şWRITE 'UPDATING' ON FI.DICT.CLOSING.STATS, '*LAST.UPDATE'şODATE=OCONV(DATE(),'D4-')şYYYY=ODATE[7,4]şFIRST.YYYY=YYYY-4şCMND='SELECT DASHBOARD.CLOSING.STATS WITH YYYY GE "':FIRST.YYYY:'"'şEXECUTE CMND CAPTURING DUMMYşSYSTEM.11=0şLOOPş   READNEXT DCS.ID ELSE DCS.ID='DONE'şUNTIL DCS.ID = 'DONE' DOş   SYSTEM.11=1ş   DELETE FI.CLOSING.STATS, DCS.IDşREPEATşIF SYSTEM.11 THENş   IF PLATFORM = 'D3' THENş      READV INDEX.DEFS FROM FI.DICT.CLOSING.STATS, 'DASHBOARD.CLOSING.STATS', 8 ELSE INDEX.DEFS=''ş      IF NOT(INDEX(INDEX.DEFS,'(G*1)',1)) THENş         EXECUTE "CREATE-INDEX DASHBOARD.CLOSING.STATS A0(G*1)" CAPTURING DUMMYş       ENDş      IF NOT(INDEX(INDEX.DEFS,'(G2*1)',1)) THENş         EXECUTE "CREATE-INDEX DASHBOARD.CLOSING.STATS A0(G2*1)" CAPTURING DUMMYş       ENDş      IF NOT(INDEX(INDEX.DEFS,'(G*2)',1)) THENş         EXECUTE "CREATE-INDEX DASHBOARD.CLOSING.STATS A0(G*2)" CAPTURING DUMMYş       ENDş      IF NOT(INDEX(INDEX.DEFS,'(G1*2)',1)) THENş         EXECUTE "CREATE-INDEX DASHBOARD.CLOSING.STATS A0(G1*2)" CAPTURING DUMMYş       ENDş      IF NOT(INDEX(INDEX.DEFS,'(G1*1)',1)) THENş         EXECUTE "CREATE-INDEX DASHBOARD.CLOSING.STATS A0(G1*1)" CAPTURING DUMMYş         EXECUTE "CREATE-INDEX DASHBOARD.CLOSING.STATS A0(G3*1)" CAPTURING DUMMYş         EXECUTE 'CREATE-INDEX DASHBOARD.CLOSING.STATS A0(G3*1):"*":0(G1*1)' CAPTURING DUMMYş       ENDş    END ELSEş      EXECUTE "CREATE-INDEX DASHBOARD.CLOSING.STATS SALESMAN" CAPTURING DUMMYş      EXECUTE "CREATE-INDEX DASHBOARD.CLOSING.STATS BRANCH" CAPTURING DUMMYş      EXECUTE "CREATE-INDEX DASHBOARD.CLOSING.STATS SALESMAN*YYYYMM" CAPTURING DUMMYş      EXECUTE "CREATE-INDEX DASHBOARD.CLOSING.STATS YYYYMM*BRANCH" CAPTURING DUMMYş      EXECUTE "CREATE-INDEX DASHBOARD.CLOSING.STATS YYYYMM" CAPTURING DUMMYş      EXECUTE "CREATE-INDEX DASHBOARD.CLOSING.STATS REGION" CAPTURING DUMMYş      EXECUTE "CREATE-INDEX DASHBOARD.CLOSING.STATS REGION*YYYYMM" CAPTURING DUMMYş    ENDş ENDş*şFOR YEAR = FIRST.YYYY TO YYYYş    WRITE 'UPDATING ':YEAR ON FI.DICT.CLOSING.STATS, '*LAST.UPDATE'ş   *ş  ** DO FOR EACH YEAR SEPARATELY TO LIMIT SIZE OF LIST RETURNINGş   *ş   STACKED.1='SELECT ':FILE.PATH:' WITH ':SALE.YEAR.DICT:' = "':YEAR:'"'ş**WRITE DUMMY ON FI.DICT.CLOSING.STATS, '*124.SELECT'ş   STACKED.2='SORT ':FILE.PATH:' WITH ':SALESMAN.DICT:' # "" BY ':SALE.MONTH.DICT:' BY ':SALESMAN.DICT:' ID-SUPP ':SALE.MONTH.DICT:' PIPE ':SALESMAN.DICT:' PIPE ':SALE.AMOUNT.DICT:' PIPE ':COST.OF.SALE.AMOUNT.DICTş   STACKED.2:=' PIPE ':BRANCH.DICT:' PIPE ':REGION.DICTş   STACKED.2:=' HDR-SUPP COL-HDR-SUPP NOPAGE'ş   CALL @EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,SYSTEM.11,REPORT)ş   IF SYSTEM.11 THENş      MAX.ROWS=DCOUNT(REPORT,CHAR(254))ş      STATS.IDS=''ş      STATS.AMTS=''ş      STATS.COS.AMTS=''ş      STATS.IDS.CNTR=0ş      FOR ROW.NO = 1 TO MAX.ROWSş         ROW=REPORT<ROW.NO>ş         IF INDEX(ROW,'|',1) THENş            MONTH=TRIM(FIELD(ROW,'|',1))+0ş            IF MONTH < 10 THENş               YYYYMM=YEAR:'0':MONTHş             END ELSE YYYYMM=YEAR:MONTHş            REP=TRIM(FIELD(ROW,'|',2))ş            AMOUNT=TRIM(FIELD(ROW,'|',3))ş            CONVERT '$,' TO '' IN AMOUNTş            AMOUNT=ICONV(AMOUNT,'MD2')ş            IF NOT(NUM(AMOUNT)) THEN AMOUNT=0ş            COST.OF.SALE.AMOUNT=TRIM(FIELD(ROW,'|',4))ş            CONVERT '$,' TO '' IN COST.OF.SALE.AMOUNTş            COST.OF.SALE.AMOUNT=ICONV(COST.OF.SALE.AMOUNT,'MD2')ş            IF NOT(NUM(COST.OF.SALE.AMOUNT)) THEN COST.OF.SALE.AMOUNT=0ş            IF AMOUNT OR COST.OF.SALE.AMOUNT THENş               BRANCH=TRIM(FIELD(ROW,'|',5))ş               REGION=TRIM(FIELD(ROW,'|',6))ş               STATS.ID=REP:'*':YYYYMM:'*':BRANCH:'*':REGIONş               LOCATE STATS.ID IN STATS.IDS SETTING STATS.PNTR ELSEş                  STATS.IDS.CNTR+=1ş                  STATS.PNTR=STATS.IDS.CNTRş                  STATS.IDS<STATS.PNTR>=STATS.IDş                ENDş               STATS.AMTS<STATS.PNTR>+=AMOUNTş               STATS.COS.AMTS<STATS.PNTR>+=COST.OF.SALE.AMOUNTş             ENDş          ENDş       NEXT ROW.NOş      MAX.STATS.IDS=DCOUNT(STATS.IDS,CHAR(254))ş      FOR ID.CNTR = 1 TO MAX.STATS.IDSş         AMOUNT=STATS.AMTS<ID.CNTR>ş         COST.OF.SALE.AMOUNT=STATS.COS.AMTS<ID.CNTR>ş         IF AMOUNT > 0 OR COST.OF.SALE.AMOUNT THENş            WRITE AMOUNT:CHAR(254):COST.OF.SALE.AMOUNT ON FI.CLOSING.STATS, STATS.IDS<ID.CNTR>ş          ENDş       NEXT ID.CNTRş    ENDş NEXT YEARşTIME.STAMP=TIME()şTIME.STAMP=FIELD(TIME.STAMP,'.',1)şTIME.STAMP=STR('0',5-LEN(TIME.STAMP)):TIME.STAMPşWRITE DATE():TIME.STAMP ON FI.DICT.CLOSING.STATS, '*LAST.UPDATE'şWRITE DATE():TIME.STAMP ON FI.DICT.CLOSING.STATS, '*LAST.UPDATED'şEND0002FASUB.PORTAL.REPORTS.DOCUMENTATIONş0c2SUBROUTINE SUB.PORTAL.REPORTS.DOCUMENTATIONş*ş* Dashboard Widgetş*şINCLUDE WBPD MVDB.INCLUDEş*ş* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "Portal Reports Documentation"şW$TYPE = "HTML"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*şOPEN '','WEB.FORMS' TO FI.WEB.FORMS ELSE RETURNşREAD WEB.FORM FROM FI.WEB.FORMS, 'PORTAL.REPORT.DOCUMENTATION' ELSE RETURNşW$HTML.DATA=WEB.FORMş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN000667SUB.FREEş0c2SUBROUTINE SUB.FREEş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Display disk usageş*şINCLUDE WBPD MVDB.INCLUDEş*şIF WIDGET.USER.DATA(1) = "TEXT" THENş  W$TYPE = "TEXT"ş  W$PRINTABLE = 1şEND ELSEş  W$TYPE = "FC3DPIE"şENDşW$TITLE = "D3 Free Space"şW$WIDTH = 2ş*şIF G$QUERYMODE THEN RETURNş*şIF WIDGET.USER.DATA(1) = "TEXT" THENş  W$TITLE := ' (Text Display)'ş  EXECUTE "FREE" CAPTURING OUTPUTş  W$TEXT.DATA = OUTPUTşEND ELSEş  W$TITLE := ' (Chart Display)'ş  EXECUTE "WHAT (LSW" CAPTURING WHATş  ATTR = DCOUNT(WHAT,@AM)ş  LOOP WHILE WHAT<ATTR> = "" DO ATTR -= 1 REPEATş  *ş  WHAT = TRIM(WHAT<ATTR>)ş  FRAMESIZE = FIELD(WHAT, ' ', 8)ş  MAXFID = FIELD( WHAT, ' ', 6 )ş  SYSBASE = FIELD( WHAT, ' ', 4 )ş  SYS.BYTE = SYSBASE * FRAMESIZEş  SYS.FRAME = SYS.BYTE/FRAMESIZEş  AVAIL.FRAME = FIELD( WHAT, ' ', 7 )ş  USED.FRAME = (MAXFID-SYSBASE)-AVAIL.FRAMEş  *ş  MAXBYTE = MAXFID * FRAMESIZEş  MAXMB = ICONV(MAXBYTE/1000000,"MD0")ş  SYS.MB = SYS.BYTE/1000000ş  USED.BYTE = USED.FRAME * FRAMESIZEş  USED.MB = USED.BYTE/1000000ş  AVAIL.BYTE = AVAIL.FRAME * FRAMESIZEş  AVAIL.MB = AVAIL.BYTE/1000000ş  *ş  W$PIE.LABELS<1,1> = "Used (":OCONV(SYS.MB+USED.MB,'MD0,'):")"ş  W$PIE.LABELS<1,2> = "Available (":OCONV(AVAIL.MB,'MD0,'):")"ş  *ş  W$PIE.VALUES<1,1> = SYS.MB+USED.MBş  W$PIE.VALUES<1,2> = AVAIL.MBş  *ş  W$PIE.CAPTION = "D3 Free Space"şENDş*ş* Set up linksş*şW$LINK.LABEL<1,1> = "Pie"şW$LINK.LABEL<1,2> = "Text"şW$LINK.LOCATION<1,1> = "2"şW$LINK.LOCATION<1,2> = "2"şW$LINK.UD.POS<1,1> = 1şW$LINK.UD.POS<1,2> = 1şW$LINK.UD.VAL<1,1> = "FC3DPIE"şW$LINK.UD.VAL<1,2> = "TEXT"ş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN	0002FESUB.PORTAL.RUN.DOCUMENTATIONş0c2SUBROUTINE SUB.PORTAL.RUN.DOCUMENTATIONş*ş* Dashboard Widgetş*şINCLUDE WBPD MVDB.INCLUDEş*ş* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "Running the Portal Dashboard Reports"şW$TYPE = "HTML"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*şOPEN '','WEB.FORMS' TO FI.WEB.FORMS ELSE RETURNşREAD WEB.FORM FROM FI.WEB.FORMS, 'PORTAL.REPORT.RUN.DOCUMENTATION' ELSE RETURNşW$HTML.DATA=WEB.FORMş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN000925SUB.DEMO.BULLETXXş0c2    SUBROUTINE SUB.DEMO.BULLETXXş* Changed by PORTBAS -> SUBROUTINE SUB.DEMO.BULLETş* @(#) SUB.DEMO.BULLETXX Ported to jBASE 17:55:31  08 JUL 2015ş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Bullet widget demoş*ş*#MAKE# RL $OPTIONS D3ş    INCLUDE WBPD MVDB.INCLUDEş*ş    W$TITLE = "Bullet Chart Demo - Sales Volume"ş    W$TYPE = "VBULLET"ş    W$WIDTH = 2ş*ş    IF G$QUERYMODE THEN RETURNş*ş    IF WIDGET.USER.DATA(1) # "" THENş        W$TYPE = WIDGET.USER.DATA(1)ş    END ELSE WIDGET.USER.DATA(1) = "VBULLET"ş    IF WIDGET.USER.DATA(2) = "" THEN WIDGET.USER.DATA(2) = 1ş    PALETTE = WIDGET.USER.DATA(2)ş*ş    W$FW.LOWER.LIMIT = 0ş    W$FW.UPPER.LIMIT = 800000ş*ş    W$FW.COLOR.RANGE<1,1> = 0ş    W$FW.COLOR.RANGE<2,1> = 400000ş    W$FW.COLOR.RANGE<3,1> = "RED"ş*ş    W$FW.COLOR.RANGE<1,2> = 400000ş    W$FW.COLOR.RANGE<2,2> = 650000ş    W$FW.COLOR.RANGE<3,2> = "YELLOW"ş*ş    W$FW.COLOR.RANGE<1,3> = 650000ş    W$FW.COLOR.RANGE<2,3> = 800000ş    W$FW.COLOR.RANGE<3,3> = "GREEN"ş*ş    W$FW.METER.VALUE = 725000ş    W$FW.METER.TARGET = 775000ş*ş    W$FW.CAPTION = "July Sales"ş    W$FW.SUBCAPTION = "Billings"ş    W$FW.CHART.PALETTE = PALETTEş*ş    W$FW.NUMBER.PREFIX = "$"ş    W$FW.NUMBER.SUFFIX = ""ş*ş    W$FW.TICKMARKS<1> = 1     ;* Display tickmarksş    W$FW.TICKMARKS<2> = 1     ;* Display values by tickmarksş    W$FW.TICKMARKS<3> = "B"   ;* Show tickmarks below the graphş    W$FW.TICKMARKS<4> = ""    ;* Let it calculate thisş    W$FW.TICKMARKS<5> = 4     ;* 4 minor tickmarks between the major onesş*ş*W$CHART.OPTIONS = "paletteThemeColor='#a2287a'"ş*ş    W$FW.DD.WIDGET<1,1> = "Drilldown Demo"ş    W$FW.DD.UD.POS<1,1,1> = 1ş    W$FW.DD.UD.VAL<1,1,1> = W$FW.METER.VALUEş    W$FW.DD.UD.POS<1,1,2> = 2ş    W$FW.DD.UD.VAL<1,1,2> = WIDGET.USER.DATA(1)ş*ş    W$INPUT.PROMPT = "Bullet Chart Style"ş    W$INPUT.TYPE = "SELECT"ş    W$INPUT.SELOPTS = "Horizontal":@VM:"Vertical"ş    W$INPUT.SELVALS = "HBULLET":@VM:"VBULLET"ş    W$INPUT.UDPOS = 1ş    W$INPUT.DEFAULT = WIDGET.USER.DATA(1)ş*ş    W$INPUT.PROMPT<2> = "Palette"ş    W$INPUT.TYPE<2> = "SELECT"ş    W$INPUT.SELOPTS<2> = "1":@VM:"2":@VM:"3":@VM:"4":@VM:"5"ş    W$INPUT.SELVALS<2> = "1":@VM:"2":@VM:"3":@VM:"4":@VM:"5"ş    W$INPUT.UDPOS<2> = 2ş    W$INPUT.DEFAULT<2> = WIDGET.USER.DATA(2)ş*ş    INCLUDE WBPD SOURCE.VIEW.ICONş*ş    RETURN000478SUB.DEMO.SS.LINEş0c2SUBROUTINE SUB.DEMO.SS.LINEş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Single Series Line Chart Demonstrationş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Demo - Monthly Sales Summary"şW$TYPE = "FCLINE"şW$WIDTH = 1ş*şIF G$QUERYMODE THEN RETURNş*şW$BAR.LABELS = "Sales (USD)"şW$BAR.CAPTION = "Monthly Sales (USD)"şW$BAR.XMEMO = "Month"şW$BAR.YMEMO = "Sales (USD)"ş*şSALES = ""şSALES<1> = "28452536"şSALES<2> = "31208425"şSALES<3> = "30245519"şSALES<4> = "40425111"şSALES<5> = "36515188"şSALES<6> = "39144100"şSALES<7> = "41655215"şSALES<8> = "36615152"şSALES<9> = "43944161"şSALES<10> = "42251594"şSALES<11> = "48833151"şSALES<12> = "50122415"ş*şFOR N = 1 TO 12ş  W$BAR.VALUES<1,N> = OCONV(SALES<N>,'MD02')ş*  W$BAR.XLABELS<1,N> = OCONV(ICONV(N:"/1",'D'),'DMA')[1,1]ş  W$BAR.XLABELS<1,N> = OCONV(N*30-15,'DMA')[1,3]şNEXT Nş*şW$BAR.TREND.BEG = OCONV(SALES<1>,'MD02')şW$BAR.TREND.END = OCONV(SALES<12>,'MD02')şW$BAR.TREND.OPTS = "thickness='2' displayValue='Trend'"şW$CHART.OPTIONS<-1> = "showValues='0'"şW$CHART.OPTIONS<-1> = "animation='1'"ş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN0020BFBUILD.DEMO.FINANCIAL.PICTUREş0c2SUBROUTINE BUILD.DEMO.FINANCIAL.PICTURE(YYYY,TODAY,LAST.EOM)şOPEN '','MVDB.CONTROL' TO FILE.CONTROL ELSE STOP 201,'MVDB.CONTROL'şREAD REC FROM FILE.CONTROL, 'DEMO.FINANCIAL.PICTURE' ELSE REC=''şREC<1>=YYYYşREC<2>=YYYY-1şREC<3>=YYYY-1şLAST.THREE=YYYY-2:CHAR(253):YYYY-1:CHAR(253):YYYYş*şOPEN '','MVDB.CONTROL' TO FILE.SALES ELSE STOP 201,'SALES'şREAD THIS.YEAR.SALES FROM FILE.SALES, 'MONTHLY.':YYYY ELSE THIS.YEAR.SALES=''şREAD LAST.YEAR.SALES FROM FILE.SALES, 'MONTHLY.':(YYYY-1) ELSE LAST.YEAR.SALES=''şREAD PREV.YEAR.SALES FROM FILE.SALES, 'MONTHLY.':(YYYY-2) ELSE PREV.YEAR.SALES=''şREAD PREV.YEAR.GPS FROM FILE.SALES, 'MONTHLY.GPS.':(YYYY-2) ELSE SALES.2.YEARS.AGO=''şREAD THIS.YEAR.GPS FROM FILE.SALES, 'MONTHLY.GPS.':YYYY ELSE THIS.YEAR.GPS=''şREAD LAST.YEAR.GPS FROM FILE.SALES, 'MONTHLY.GPS.':(YYYY-1) ELSE LAST.YEAR.GPS=''şREAD THIS.YEAR.PARTS FROM FILE.SALES, 'MONTHLY.PARTS.':YYYY ELSE THIS.YEAR.PARTS=''şREAD LAST.YEAR.PARTS FROM FILE.SALES, 'MONTHLY.PARTS.':(YYYY-1) ELSE LAST.YEAR.PARTS=''şREAD THIS.YEAR.SERVICES FROM FILE.SALES, 'MONTHLY.SERVICES.':YYYY ELSE THIS.YEAR.SERVICES=''şREAD LAST.YEAR.SERVICES FROM FILE.SALES, 'MONTHLY.SERVICES.':(YYYY-1) ELSE LAST.YEAR.SERVICES=''şFY.LAST=SUM(LAST.YEAR.SALES)şREC<7>=FY.LASTşFY.PARTS=SUM(LAST.YEAR.PARTS)şREC<18>=FY.PARTSşFY.SERVICES=SUM(LAST.YEAR.SERVICES)şREC<25>=FY.SERVICESşLAST.MONTH.NO=OCONV(LAST.EOM,'D2-')[1,2]+0şYTD.THIS=0şYTD.LAST=0şYTD.PREV=0şGPS.THIS=0şGPS.LAST=0şGPS.PREV=0şPARTS.THIS=0şPARTS.LAST=0şSERVICES.THIS=0şSERVICES.LAST=0şTHIS.YEAR.MONTHLY.SALES=''şTHIS.YEAR.MONTHLY.GPS=''şFOR MO.NO = 1 TO LAST.MONTH.NOş   YTD.THIS+=THIS.YEAR.SALES<MO.NO>ş   THIS.YEAR.MONTHLY.SALES<1,1,MO.NO>=THIS.YEAR.SALES<MO.NO>ş   YTD.LAST+=LAST.YEAR.SALES<MO.NO>ş   YTD.PREV+=PREV.YEAR.SALES<MO.NO>ş   GPS.THIS+=THIS.YEAR.GPS<MO.NO>ş   THIS.YEAR.MONTHLY.GPS<1,1,MO.NO>=THIS.YEAR.GPS<MO.NO>ş   GPS.LAST+=LAST.YEAR.GPS<MO.NO>ş   GPS.PREV+=PREV.YEAR.GPS<MO.NO>ş   PARTS.THIS+=THIS.YEAR.PARTS<MO.NO>ş   PARTS.LAST+=LAST.YEAR.PARTS<MO.NO>ş   SERVICES.THIS+=THIS.YEAR.SERVICES<MO.NO>ş   SERVICES.LAST+=LAST.YEAR.SERVICES<MO.NO>ş NEXT MO.NOşREC<67>=LAST.THREEşREC<68,3>=THIS.YEAR.MONTHLY.SALESşREC<69,3>=THIS.YEAR.MONTHLY.GPSşREC<36>=YTD.PREVşREC<37>=GPS.PREVşCONVERT CHAR(254) TO CHAR(252) IN PREV.YEAR.SALESşREC<68,1>=PREV.YEAR.SALESşCONVERT CHAR(254) TO CHAR(252) IN PREV.YEAR.GPSşREC<69,1>=PREV.YEAR.GPSşCONVERT CHAR(254) TO CHAR(252) IN LAST.YEAR.SALESşREC<68,2>=LAST.YEAR.SALESşCONVERT CHAR(254) TO CHAR(252) IN LAST.YEAR.GPSşREC<69,2>=LAST.YEAR.GPSşLAST.FY.GPS=SUM(LAST.YEAR.GPS)şREC<4>=YTD.THISşREC<5>=YTD.LASTşDELTA.SALES=YTD.THIS-YTD.LASTşDELTA.PCT=(DELTA.SALES*100)/YTD.LASTşREC<6>=DELTA.PCTşREC<8>=GPS.THISşREC<9>=GPS.LASTşDELTA.GPS=GPS.THIS-GPS.LASTşDELTA.PCT=(DELTA.GPS*100)/GPS.LASTşREC<10>=DELTA.PCTşREC<11>=LAST.FY.GPSşTHIS.GPS.PCT=INT(GPS.THIS * 1000 / YTD.THIS + .5)şREC<12>=THIS.GPS.PCTşLAST.GPS.PCT=INT(GPS.LAST * 1000 / YTD.LAST + .5)şPREV.GPS.PCT=INT(GPS.PREV * 1000 / YTD.PREV + .5)şREC<13>=LAST.GPS.PCTşFY.LAST.GPS.PCT=INT(LAST.FY.GPS * 1000 / FY.LAST + .5)şREC<14>=FY.LAST.GPS.PCTşREC<15>=PARTS.THISşREC<22>=SERVICES.THISşREC<16>=PARTS.LASTşREC<23>=SERVICES.LASTşDELTA.PARTS=PARTS.THIS-PARTS.LASTşDELTA.PARTS.PCT=(DELTA.PARTS*100)/PARTS.LASTşREC<17>=DELTA.PARTS.PCTşDELTA.SERVICES=SERVICES.THIS-SERVICES.LASTşDELTA.SERVICES.PCT=(DELTA.SERVICES*100)/SERVICES.LASTşREC<24>=DELTA.SERVICES.PCTşTHIS.PARTS.PCT=INT(PARTS.THIS * 1000 / YTD.THIS + .5)şREC<19>=THIS.PARTS.PCTşLAST.PARTS.PCT=INT(PARTS.LAST * 1000 / YTD.LAST + .5)şREC<20>=LAST.PARTS.PCTşFY.PARTS.PCT=INT(FY.PARTS * 1000 / FY.LAST + .5)şREC<21>=FY.PARTS.PCTşTHIS.SERVICES.PCT=INT(SERVICES.THIS * 1000 / YTD.THIS + .5)şREC<26>=THIS.SERVICES.PCTşLAST.SERVICES.PCT=INT(SERVICES.LAST * 1000 / YTD.LAST + .5)şREC<27>=LAST.SERVICES.PCTşFY.SERVICES.PCT=INT(FY.SERVICES * 1000 / FY.LAST + .5)şREC<28>=FY.SERVICES.PCTşREC<29>=YYYYşREC<30>=OCONV(LAST.EOM,'D2/')şREC<31>=YYYY-1şREC<32>=YYYY-2ş*ş** DETERMINE PCT OF PARTS FOR PREVIOUS YEAR BETWEEN 40.0% AND 60.0%ş*şDELTA=RND(200);  * -10.0 TO 10.0şPREV.PART.PCT=500+(DELTA-100)şPREV.PART.AMT=INT(YTD.PREV * PREV.PART.PCT/1000 + .5)şPREV.SERVICE.AMT=YTD.PREV-PREV.PART.AMTşPREV.SERVICE.PCT=1000-PREV.PART.PCTş*ş** MARGINS, PARTS, AND SERVICES FOR DRILLDOWNSş*şREC<38>=LAST.THREEşYEARS=LAST.THREEşMAX.YEARS=DCOUNT(YEARS,CHAR(253))şREC<39>=PREV.GPS.PCT:CHAR(253):LAST.GPS.PCT:CHAR(253):THIS.GPS.PCTşREC<40>=PREV.PART.AMT:CHAR(253):PARTS.LAST:CHAR(253):PARTS.THISşREC<41>=PREV.PART.PCT:CHAR(253):LAST.PARTS.PCT:CHAR(253):THIS.PARTS.PCTşREC<42>=PREV.SERVICE.AMT:CHAR(253):SERVICES.LAST:CHAR(253):SERVICES.THISşREC<43>=PREV.SERVICE.PCT:CHAR(253):LAST.SERVICES.PCT:CHAR(253):THIS.SERVICES.PCTş*ş** NET INCOME 10% OF SALESş*şREC<33>=INT(GPS.THIS * .1 + .5)şREC<34>=INT(LAST.FY.GPS * .1 + .5)şREC<35>=INT(SUM(PREV.YEAR.GPS) * .1 + .5)ş*ş** HARD CODE DAYS TO PAYş*şREC<44>=35şREC<45>=39şREC<46>=41şREC<54>=65:CHAR(253):20:CHAR(253):10:CHAR(253):5şREC<55>=63:CHAR(253):21:CHAR(253):10:CHAR(253):6şREC<56>=64:CHAR(253):19:CHAR(253):8:CHAR(253):9ş*ş** BUILD REP TOTALSş*şREPS='John,Katherine,Chris,Carrie,Sally,Jan,Bart,Linus,Max'şCONVERT ',' TO CHAR(253) IN REPSşMAX.REPS=DCOUNT(REPS,CHAR(253))şREC<47>=REPSşDEVIATION=35;  * 35% DEVIATIONşMOS.IN.YEAR=''şFOR YEAR.CNTR = 1 TO MAX.YEARSş   YEAR.AMTS=REC<68,YEAR.CNTR>ş   MOS.IN.YEAR<1,YEAR.CNTR>=DCOUNT(YEAR.AMTS,CHAR(252))ş   ANN.SALES.AMT=SUM(YEAR.AMTS)ş   ANN.GP.AMT=SUM(REC<69,YEAR.CNTR>)ş   GP.FACTOR=ANN.GP.AMT/ANN.SALES.AMTş   NUM.ITEMS=MAX.REPSş   TOT.SCAT.AMT=ANN.SALES.AMTş   GOSUB SCATTER.VALUESş   FOR REP.CNTR = 1 TO MAX.REPSş      REP.SALES.AMT=RETURN.AMOUNTS<1,1,REP.CNTR>ş      REC<48,REP.CNTR,YEAR.CNTR>=REP.SALES.AMTş      REP.GP.AMT=INT(REP.SALES.AMT * GP.FACTOR + .5)ş      REC<49,REP.CNTR,YEAR.CNTR>=REP.GP.AMTş    NEXT REP.CNTRş NEXT YEAR.CNTRş*ş** CREATE MONTHLIES FOR EACH REP AND SAVE IN SALES.YYYYş*şDEVIATION=20şFOR YEAR.CNTR = 1 TO MAX.YEARSş   YEAR=YEARS<1,YEAR.CNTR>ş   NUM.ITEMS=MOS.IN.YEAR<1,YEAR.CNTR>ş   SALES.REC=''ş   GPS.REC=''ş   FOR REP.CNTR = 1 TO MAX.REPSş      REP=REPS<1,REP.CNTR>ş      SALES.REC<1,REP.CNTR>=REPş      GPS.REC<1,REP.CNTR>=REPş      TOT.SCAT.AMT=REC<48,REP.CNTR,YEAR.CNTR>ş      GOSUB SCATTER.VALUESş      SALES.REC<2,REP.CNTR>=RETURN.AMOUNTSş      TOT.SCAT.AMT=REC<49,REP.CNTR,YEAR.CNTR>ş      GOSUB SCATTER.VALUESş      GPS.REC<2,REP.CNTR>=RETURN.AMOUNTSş    NEXT REP.CNTRş   WRITE SALES.REC ON FILE.CONTROL, 'SALES.':YEARş   WRITE GPS.REC ON FILE.CONTROL, 'GPS.':YEARş NEXT YEAR.CNTRş*ş** BUILD SERVICES AND PARTSş*şPARTS='Doohickey A,Doohickey B,Doohickey C,Doohickey D'şCONVERT ',' TO CHAR(253) IN PARTSşMAX.PARTS=DCOUNT(PARTS,CHAR(253))şREC<52>=PARTSşDEVIATION=35şFOR YEAR.CNTR = 1 TO MAX.YEARSş   ANN.PART.AMT=REC<40,YEAR.CNTR>ş   NUM.ITEMS=MAX.PARTSş   TOT.SCAT.AMT=ANN.PART.AMTş   GOSUB SCATTER.VALUESş   FOR PART.CNTR = 1 TO MAX.PARTSş      REC<53,PART.CNTR,YEAR.CNTR>=RETURN.AMOUNTS<1,1,PART.CNTR>ş    NEXT PART.CNTRş NEXT YEAR.CNTRş*şSERVICES='Diagnostics,Repair,Custom Machining,Preventative Maintenance'şCONVERT ',' TO CHAR(253) IN SERVICESşMAX.SERVICES=DCOUNT(SERVICES,CHAR(253))şREC<50>=SERVICESşDEVIATION=35şFOR YEAR.CNTR = 1 TO MAX.YEARSş   ANN.SERVICE.AMT=REC<42,YEAR.CNTR>ş   NUM.ITEMS=MAX.SERVICESş   TOT.SCAT.AMT=ANN.SERVICE.AMTş   GOSUB SCATTER.VALUESş**CRT 'YEAR.CNTR=':YEAR.CNTRş**CRT 'ANN.SERVICE.AMT=':ANN.SERVICE.AMTş**CRT 'RETURN.AMOUNTS=':RETURN.AMOUNTS:; DEBUGş   FOR SERVICE.CNTR = 1 TO MAX.SERVICESş      REC<51,SERVICE.CNTR,YEAR.CNTR>=RETURN.AMOUNTS<1,1,SERVICE.CNTR>ş    NEXT SERVICE.CNTRş NEXT YEAR.CNTRşWRITE REC ON FILE.CONTROL, 'DEMO.FINANCIAL.PICTURE'şRETURNş*şSCATTER.VALUES:ş*şRETURN.AMOUNTS=''şRUNNING.AMT=0şLINEAR.PCT=100/NUM.ITEMSşMAX.DEVIATION=INT((LINEAR.PCT * DEVIATION/100) * 200)şHALF.DEVIATION=INT(MAX.DEVIATION/2 + .5)şRUNNING.PCT=0şLESS.1=NUM.ITEMS-1şMID.WAY=INT(NUM.ITEMS/2 + .5)şFOR SCAT.CNTR = 1 TO LESS.1ş   RANDOM.SCAT=RND(MAX.DEVIATION)ş   PCT=LINEAR.PCT + ((HALF.DEVIATION-RANDOM.SCAT) / 100)ş   RUNNING.PCT+=PCTş   AMT=INT(TOT.SCAT.AMT * PCT/100 + .5)ş   RUNNING.AMT+=AMTş   IF MID.WAY THENş      IF RUNNING.AMT > (TOT.SCAT.AMT / 2 + .5) THENş         * RUNNING TOO HIGH SO REDUCTş         MAX.DEVIATION=INT((LINEAR.PCT * DEVIATION/100) * 125)ş         HALF.DEVIATION=INT(MAX.DEVIATION/2 + .5)ş       ENDş    ENDş   RETURN.AMOUNTS<1,1,-1>=AMTş NEXT SCAT.CNTRşRETURN.AMOUNTS<1,1,-1>=TOT.SCAT.AMT - RUNNING.AMTşRETURNşEND0001CDSUB.PORTAL.DOCUMENTATIONş0c2SUBROUTINE SUB.PORTAL.DOCUMENTATIONş*ş* Dashboard Widgetş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEş*ş* Copyright (C) Zumasys, Incş*şW$TITLE='Portal Documentation'şW$TYPE='HTML'şW$WIDTH = 1                    ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*şOPEN '','WEB.FORMS' TO FILE.WEB.FORMS ELSE RETURNşREAD WEB.FORM FROM FILE.WEB.FORMS, 'PORTAL.DOCUMENTATION' ELSE RETURNşW$HTML.DATA=WEB.FORMşRETURN00062BSUB.SYS.ERR.BARş0c2    SUBROUTINE SUB.SYS.ERR.BARş* Changed by PORTBAS -> SUBROUTINE SUB.SYS.ERRSş* @(#) SUB.SYS.ERR.BAR Ported to jBASE 17:55:32  08 JUL 2015ş*  The following variable names were convertedş*   DATEş* ş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Show system errorsş*ş    INCLUDE WBPD MVDB.INCLUDEş*ş    W$TYPE = "FCCOLUMN2D"ş    W$TITLE = "System Errors by Day For Each Day"ş    W$WIDTH = 3ş*ş    IF G$QUERYMODE = "1" THEN RETURNş*ş    OPEN '','SYSTEM-ERRORS' TO F.SYSTEM.ERRORS ELSE RETURNş*ş    BASE.DATE = DATE() - 29ş    XLINE = 'SSELECT SYSTEM-ERRORS BY-DSND DATE BY-DSND TIME WITH DATE GT "':OCONV(BASE.DATE,'D2/'):'"'ş    EXECUTE XLINE CAPTURING JUNKş*ş*ş    W$BAR.LABELS<1> = "Errors from ":OCONV(BASE.DATE,'D2/'):" Thru ":OCONV(DATE(),'D2/')ş    W$BAR.TYPE = "clustered"ş*ş    LOOPş        READNEXT ID ELSE EXITş        Date = FIELD(ID,'*',1)ş        IF Date < BASE.DATE THEN EXITş*ş        W$BAR.VALUES<1,(Date-BASE.DATE)+1> += 1ş    REPEATş*ş    FOR X = BASE.DATE TO DATE()ş        OFFSET = (BASE.DATE-X)+1ş        W$BAR.XLABELS<1,OFFSET> = OCONV(X,'DD')ş    NEXT Xş*ş    W$BAR.YMEMO = "Error Records"ş    W$BAR.XMEMO = "Day of Month"ş*ş    W$BAR.TREND.BEG<1> = "3"ş    W$BAR.TREND.END<1> = "13"ş    W$BAR.TREND.OPTS<1> = "thickness='4' color='ff0000' displayValue='Bad Trend'"ş    W$BAR.TREND.BEG<2> = "11"ş    W$BAR.TREND.END<2> = "8"ş    W$BAR.TREND.OPTS<2> = "thickness='10' color='00ff00' displayValue='Good Trend'"ş*ş    W$LINK.LABEL = "Detail"ş    W$LINK.LOCATION = "2"ş    W$LINK.DD.WIDGET = "System Errors"ş*ş    RETURN0002BASUB.SHOW.SESSIONş0c2SUBROUTINE SUB.SHOW.SESSIONş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Show session contentsş*şINCLUDE WBPD MVDB.INCLUDEşINCLUDE WBPD WWW.INCLUDEş*şW$TYPE = "TABLE"şW$TITLE = "Web Session Contents"şW$WIDTH = 3ş* şIF G$QUERYMODE THEN RETURNş*şREAD REC FROM F.WEB.SESSION, SESSION$ID ELSE REC = ""şW$TABLE.COL.LABELS<1,1> = "Variable"şW$TABLE.COL.LABELS<1,2> = "Value"şW$TABLE.DATA<1,1> = "Session ID"şW$TABLE.DATA<1,2> = SESSION$IDşFOR N = 1 TO DCOUNT(REC<1>, @VM)ş  W$TABLE.DATA<N+1,1> = REC<1,N>ş  VAL = REC<2,N>ş  CONVERT CHAR(2) TO "^" IN VALş  CONVERT CHAR(3) TO "]" IN VALş  CONVERT CHAR(4) TO "\" IN VALş  W$TABLE.DATA<N+1,2> = VALşNEXT Nş*şRETURN001133SUB.ADMIN.CONFIGş0c2SUBROUTINE SUB.ADMIN.CONFIGş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Administrative configuration widget.ş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Administrative Configuration Widget"şW$TYPE = "HTML" ;* or HTML, FCPIE, FCBAR, etc.şW$WIDTH = 2 ;* 1 = narrow, 2 = medium, 3 = full-widthş*şIF G$QUERYMODE THEN RETURN ;* Dont process, just provide title, type & widthş*şOPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSEş  W$TEXT.INFO = "Unable to open MVDB.CONTROL"ş  RETURNşENDşOPEN '','MVDB.THEMES' TO F.MVDB.THEMES ELSE ş  W$TEXT.INFO = "Unable to open MVDB.THEMES"ş  RETURNşENDşW$TEXT.INFO = "" ;* No widget content at this point.ş*şREAD SETTINGS.REC FROM F.MVDB.CONTROL, 'MVDB.SETTINGS' ELSE SETTINGS.REC = ""şIF G$SUBMITTED = 1 THENş  FOR N = 1 TO 15ş    SETTINGS.REC<N> = WIDGET.USER.DATA(N)ş  NEXT Nş  WRITE SETTINGS.REC ON F.MVDB.CONTROL, 'MVDB.SETTINGS'ş  W$HTML.DATA = "Settings saved."şENDşIF SETTINGS.REC<1> # "" THENş  W$HTML.DATA := '<br /><a href="/dbc/MVDB.WEB.ED?ed_file=MVDB.SUBS&ed_item=':SETTINGS.REC<1>:'" target="MVDB.SUBS_':SETTINGS.REC<1>:'">Edit Subroutine: ':SETTINGS.REC<1>:'</a>'şENDşIF SETTINGS.REC<5> = "" THEN SETTINGS.REC<5> = 24şIF SETTINGS.REC<3> = "" THEN SETTINGS.REC<3> = 20şIF SETTINGS.REC<4> = "" THENş  LOCATE "SERVER_PORT" IN CGI$VARS SETTING POS THENş    SETTINGS.REC<4> = CGI$VALS<POS>ş  ENDşENDşIF SETTINGS.REC<9> = '' THEN SETTINGS.REC<9> = 'UTF-8'ş*şW$INPUT.PROMPT<1> = "User Auth Sub"şW$INPUT.TYPE<1> = "TEXT"şW$INPUT.UDPOS<1> = 1şW$INPUT.DEFAULT<1> = SETTINGS.REC<1>şW$INPUT.PARAMS<1> = 'size="40"'ş*şW$INPUT.PROMPT<2> = "Password Req?"şW$INPUT.TYPE<2> = "SELECT"şW$INPUT.SELOPTS<2> = "Yes":@VM:"No"şW$INPUT.SELVALS<2> = "0":@VM:"1"şW$INPUT.UDPOS<2> = 2şW$INPUT.DEFAULT<2> = SETTINGS.REC<2>ş*şW$INPUT.PROMPT<3> = "Failure Tolerance Period"şW$INPUT.TYPE<3> = "TEXT"şW$INPUT.UDPOS<3> = 3şW$INPUT.DEFAULT<3> = SETTINGS.REC<3>şW$INPUT.PARAMS<3> = 'size="5"'ş*şW$INPUT.PROMPT<4> = "TCP Port"şW$INPUT.TYPE<4> = "TEXT"şW$INPUT.UDPOS<4> = 4şW$INPUT.DEFAULT<4> = SETTINGS.REC<4>şW$INPUT.PARAMS<4> = 'size="5"'ş*şW$INPUT.PROMPT<5> = "Session Timeout (hours)"şW$INPUT.TYPE<5> = "TEXT"şW$INPUT.UDPOS<5> = 5şW$INPUT.DEFAULT<5> = SETTINGS.REC<5>şW$INPUT.PARAMS<5> = 'size="5"'ş*şIF SETTINGS.REC<6> = '' THEN SETTINGS.REC<6> = 0şW$INPUT.PROMPT<6> = "GMT Offset"şW$INPUT.TYPE<6> = "SELECT"şGMT.VAL.LIST = ''; GMT.OPT.LIST = ''şFOR X = 12 TO 1 STEP -1ş  GMT.OPT.LIST<1,-1> = 'GMT -':Xş  GMT.VAL.LIST<1,-1> = X * (-1)şNEXT XşGMT.OPT.LIST<1,-1> = 'GMT'şGMT.VAL.LIST<1,-1> = 0şFOR X = 1 TO 12ş  GMT.OPT.LIST<1,-1> = 'GMT +':Xş  GMT.VAL.LIST<1,-1> = XşNEXT XşW$INPUT.SELOPTS<6> = GMT.OPT.LISTşW$INPUT.SELVALS<6> = GMT.VAL.LISTşW$INPUT.UDPOS<6> = 6şW$INPUT.DEFAULT<6> = SETTINGS.REC<6>ş*şW$INPUT.PROMPT<7> = "Alternate Logo Image"şW$INPUT.TYPE<7> = "TEXT"şW$INPUT.UDPOS<7> = 7şW$INPUT.DEFAULT<7> = SETTINGS.REC<7>ş*şEXECUTE 'SSELECT MVDB.THEMES' CAPTURING JUNKşTHEME.LIST = ''şLOOPş  READNEXT THEME.ID ELSE EXITş  READV CSS.NAME FROM F.MVDB.THEMES, THEME.ID, 1 ELSE CSS.NAME = ''ş  IF CSS.NAME # '' THENş    THEME.LIST<1,-1> = CSS.NAMEş    THEME.LIST<2,-1> = THEME.IDş  ENDşREPEATşW$INPUT.PROMPT<8> = "Dashboard Theme"şW$INPUT.TYPE<8> = "SELECT"şW$INPUT.SELOPTS<8> = 'Default Theme':@VM:THEME.LIST<2>şW$INPUT.SELVALS<8> = '':@VM:THEME.LIST<2>şW$INPUT.UDPOS<8> = 8şW$INPUT.DEFAULT<8> = SETTINGS.REC<8>ş*şW$INPUT.PROMPT<9> = 'Character Set'şW$INPUT.TYPE<9> = "TEXT"şW$INPUT.UDPOS<9> = 9şW$INPUT.DEFAULT<9> = SETTINGS.REC<9>ş*şW$INPUT.PROMPT<10> = "Auto-Trim Sessions"şW$INPUT.TYPE<10> = "SELECT"şW$INPUT.SELOPTS<10> = 'No':@VM:'Yes'şW$INPUT.SELVALS<10> = 'N':@VM:'Y'şW$INPUT.UDPOS<10> = 10şW$INPUT.DEFAULT<10> = SETTINGS.REC<10>ş*şW$INPUT.PROMPT<11> = "Auto-Refresh"şW$INPUT.TYPE<11> = "SELECT"şW$INPUT.SELOPTS<11> = 'No':@VM:'Yes'şW$INPUT.SELVALS<11> = 'N':@VM:'Y'şW$INPUT.UDPOS<11> = 11şW$INPUT.DEFAULT<11> = SETTINGS.REC<11>ş*ş*WEBSERVICE*şW$INPUT.PROMPT<12> = "Allow 'webservice' logins"şW$INPUT.TYPE<12> = "SELECT"şW$INPUT.SELOPTS<12> = 'No':@VM:'Yes'şW$INPUT.SELVALS<12> = 'N':@VM:'Y'şW$INPUT.UDPOS<12> = 12şW$INPUT.DEFAULT<12> = SETTINGS.REC<12>ş*ş*EMAILED REPORTS*şW$INPUT.PROMPT<13> = "Allow 'emailed' logins"şW$INPUT.TYPE<13> = "SELECT"şW$INPUT.SELOPTS<13> = 'No':@VM:'Yes'şW$INPUT.SELVALS<13> = 'N':@VM:'Y'şW$INPUT.UDPOS<13> = 13şW$INPUT.DEFAULT<13> = SETTINGS.REC<13>ş*şW$INPUT.BUTTON = "Save"ş*şRETURN003063SUB.PORTAL.AR.REPORTSş0c2SUBROUTINE SUB.PORTAL.AR.REPORTSş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE='Portal AR'; CALL PORTAL.SHOW.LAST.UPDATED('AR')şW$TYPE = "FC2DPIE"şW$WIDTH = 2ş*şIF G$QUERYMODE THEN RETURNş*şEQUATE REPORT.TYPE TO WIDGET.USER.DATA(1)şW$PDFABLE=1şOPEN 'DICT','DASHBOARD.BALANCES' TO FI.DICT.DASHBOARD.BALANCES ELSEş   W$TYPE='TEXT'ş   W$TEXT.DATA='UNABLE TO OPEN DICT DASHBOARD.BALANCES'ş   RETURNş ENDş*ş* LAYOUT OF THE *CURRENT.AR.STATS RECORDş*ş* PERIOD.AMOUNTS DATA LAYOUTş* 1 PERIOD 1 AMOUNTş* 2 PERIOS 2 AMOUNTş* 3 PERIOD 3 AMOUNTş* 4 PERIOD 4 AMOUNTş* 5ş* 6 YEAR ] YEAR ] YEARş* 7 PERIOD 1 NUMBER \ PERIOD 2 NUMBER \ PERIOD 3 NUMBER \ PERIOD 4 NUMBERş* 8 PERIOD 1 AMOUNT \ PERIOD 2 AMOUNT \ PERIOD 3 AMOUNT \ PERIOD 4 AMOUNTş* 9 YEAR 1 TOTAL DAYS ] YEAR TOTAL DAYS ] YEAR 3 TOTAL DAYS ] YEAR 4 TOTAL DAYSş* 10 YEAR 1 JAN # PAID\ FEB # PAID ... ] YEAR 2 JAN # PAID \ş* 11 YEAR 1 JAN # TOTAL DAYS \ FEB TOTAL DAYS ....ş*şDIM AR.AMOUNTS(30)şMATREAD AR.AMOUNTS FROM FI.DICT.DASHBOARD.BALANCES, '*CURRENT.AR.STATS' ELSE MAT AR.AMOUNTS=''şEQUATE YEARS TO AR.AMOUNTS(6)şNUM.YEARS=DCOUNT(YEARS,@VM)şEQUATE ANNUAL.NUMBERS TO AR.AMOUNTS(7)şEQUATE ANNUAL.AMOUNTS TO AR.AMOUNTS(8)şEQUATE ANNUAL.TOTAL.DAYS TO AR.AMOUNTS(9)şEQUATE MONTHLY.NUMBER.PAID TO AR.AMOUNTS(10)şEQUATE MONTHLY.TOTAL.DAYS TO AR.AMOUNTS(11)şEQUATE CUSTOMERS TO AR.AMOUNTS(12)şEQUATE CUST.AMT.DUES TO AR.AMOUNTS(13)şEQUATE CUST.MOST.DAYS.DUE TO AR.AMOUNTS(14)şEQUATE CUST.TOTAL.1000.DAYS TO AR.AMOUNTS(15)şEQUATE CUST.NUM.1000.DAYS TO AR.AMOUNTS(16)şEQUATE CUST.TOTAL.60.DAYS TO AR.AMOUNTS(17)şEQUATE CUST.NUM.60.DAYS TO AR.AMOUNTS(18)şEQUATE HIGHEST.AMTS.CUSTS TO AR.AMOUNTS(19)şEQUATE HIGHEST.AMTS TO AR.AMOUNTS(20)şEQUATE HIGHEST.DAYS.CUSTS TO AR.AMOUNTS(21)şEQUATE HIGHEST.DAYS TO AR.AMOUNTS(22)şEQUATE HIGHEST.INCREASE.CUSTS TO AR.AMOUNTS(23)şEQUATE HIGHEST.INCREASE.PCTS TO AR.AMOUNTS(24)şEQUATE HIGHEST.INCREASE.60.DAY.AVG TO AR.AMOUNTS(25)şEQUATE HIGHEST.INCREASE.1000.DAY.AVG TO AR.AMOUNTS(26)ş*şW$INPUT.PROMPT<1>='Type of Report 'şW$INPUT.TYPE<1>='SELECT'şW$INPUT.SELOPTS<1>='Current Receivables':@VM:'Average Days by Year':@VM:'Average Days Last 12 Months'ş*ş** Add Average Days by Month for past 3 years with activity in every monthş*şYEAR.POS=NUM.YEARSşYEARS.ALREADY=0şLOOPş   YEAR.POS=YEAR.POS-1ş   IF NOT(YEAR.POS) THENş      JAN.NUMBER=0ş    END ELSEş      JAN.NUMBER=MONTHLY.NUMBER.PAID<1,YEAR.POS,1>ş    ENDşUNTIL NOT(JAN.NUMBER) OR YEARS.ALREADY >= 3 DOş   YEAR=YEARS<1,YEAR.POS>ş   YEARS.ALREADY+=1ş   W$INPUT.SELOPTS<1,-1>='Average Days by Month ':YEARşREPEATş**W$INPUT.SELOPTS<1,-1>='Customers By Largest Receivables'ş**W$INPUT.SELOPTS<1,-1>='Customers By Most Aged Receivables'ş**W$INPUT.SELOPTS<1,-1>='Customers By Largest Aging Increases'şW$INPUT.SELOPTS<1,-1>='Customers Needing Aging Attention'şW$INPUT.SELVALS=W$INPUT.SELOPTSşIF REPORT.TYPE = '' THENş   REPORT.TYPE='Current Receivables'ş ENDşW$INPUT.UDPOS = 1şW$INPUT.DEFAULT<1>=REPORT.TYPEş*şBEGIN CASEş   CASE REPORT.TYPE = 'Current Receivables'ş      GOSUB DO.CURRENTş   CASE REPORT.TYPE = 'Average Days by Year'ş      GOSUB AVERAGE.DAYS.BY.YEARş   CASE REPORT.TYPE = 'Average Days Last 12 Months'ş      GOSUB AVERAGE.DAYS.LAST.12.MONTHSş   CASE REPORT.TYPE[1,21] = 'Average Days by Month'ş      AVERAGE.YEAR=FIELD(REPORT.TYPE,' ',5)ş      GOSUB AVERAGE.DAYS.BY.MONTH.PER.YEARş   CASE REPORT.TYPE = 'CUSTOMERS BY LARGEST RECEIVABLES'ş      GOSUB CUSTOMERS.BY.LARGEST.RECEIVABLESş   CASE REPORT.TYPE = 'CUSTOMERS BY MOST AGED RECEIVABLES'ş      GOSUB CUSTOMERS.BY.MOST.AGED.RECEIVABLESş   CASE REPORT.TYPE = 'CUSTOMERS BY LARGEST AGING INCREASES'ş      GOSUB CUSTOMERS.BY.LARGEST.AGING.INCREASESş   CASE REPORT.TYPE = 'Customers Needing Aging Attention'ş      GOSUB CUSTOMERS.BY.LARGEST.RECEIVABLESş   CASE 1ş      W$TYPE='TEXT'ş      W$TEXT.DATA='INVALID REPORT TYPE=':REPORT.TYPEşEND CASEşRETURNş*şDO.CURRENT:ş*şW$TITLE = "Current - AR Balances by Days Due"; CALL PORTAL.SHOW.LAST.UPDATED('AR')şAMTS=AR.AMOUNTS(1):@AM:AR.AMOUNTS(2):@AM:AR.AMOUNTS(3):@AM:AR.AMOUNTS(4):@AM:AR.AMOUNTS(5)şW$PIE.CAPTION='Total AR Balance of 'ş*şTOT.AMT=SUM(AMTS)şW$PIE.CAPTION:=OCONV(TOT.AMT,'MD02,$')ş*şCATEGORIES='Current'şCATEGORIES<2>='1 - 30 Days'şCATEGORIES<3>='31 - 60 Days'şCATEGORIES<4>='61 - 90 Days'şCATEGORIES<5>='Over 90 Days'ş*şCATEGORY.AMTS=AMTSş*ş*şW$CHART.OPTIONS<-1>='showValues="1"'şW$CHART.OPTIONS<-1>='showPercentageValues="0"'şW$CHART.OPTIONS<-1>='showPercentageInLabel="1"'şW$CHART.OPTIONS<-1>='formatNumber="1"'şW$CHART.OPTIONS<-1>='formatNumberScale="0"'şW$CHART.OPTIONS<-1>='decimalPrecision="0"'şW$CHART.OPTIONS<-1>='thousandSeparator=","'şW$CHART.OPTIONS<-1>='pieradius="150"'şFOR N = 1 TO 5ş  W$PIE.LABELS<1,N> = CATEGORIES<N>ş  W$PIE.VALUES<1,N> = INT(CATEGORY.AMTS<N>/100 + .5)şNEXT Nş*şRETURNş*şAVERAGE.DAYS.BY.YEAR:ş*şW$TITLE = "Average Days To Pay"; CALL PORTAL.SHOW.LAST.UPDATED('AR')şW$TYPE = "FCCOLUMN3D"ş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEşFIRST.YEAR=''; CURRENT.YEAR=''ş*şW$BAR.XMEMO = "Year (drill down for detail)"şW$BAR.YMEMO = "Average Days to Pay"ş*şYEAR.NO=0ş*şFOR NN = 1 TO NUM.YEARSş  ANNUAL.BY.TYPE.NUMBER=ANNUAL.NUMBERS<1,NN>ş  BY.TYPE.NUMBER=SUM(ANNUAL.BY.TYPE.NUMBER)ş  TOTAL.DAYS=ANNUAL.TOTAL.DAYS<1,NN>ş  IF BY.TYPE.NUMBER AND TOTAL.DAYS THENş     AVERAGE.DAYS=INT(TOTAL.DAYS * 10 / BY.TYPE.NUMBER + .5)ş     AVERAGE.DAYS=OCONV(AVERAGE.DAYS,'MD1')ş     YEAR.NO+=1ş     YEAR=YEARS<1,NN>ş     IF NOT(FIRST.YEAR) THEN FIRST.YEAR=YEARş     CURRENT.YEAR=YEARş     W$BAR.VALUES<1,YEAR.NO> = AVERAGE.DAYSş     W$BAR.XLABELS<1,YEAR.NO> = YEARş     W$FW.DD.WIDGET<1,YEAR.NO>='PORTAL DAYS TO PAY PIE'ş     W$FW.DD.UD.POS<1,YEAR.NO,1>=1ş     W$FW.DD.UD.VAL<1,YEAR.NO,1>=YEARş   ENDşNEXT NNş*şW$BAR.CAPTION = "Average Days to Pay From ":FIRST.YEAR:' to ':CURRENT.YEARşW$CHART.OPTIONS<-1>='showValues="1"'şW$CHART.OPTIONS<-1>='formatNumber="1"'şW$CHART.OPTIONS<-1>='formatNumberScale="0"'şW$CHART.OPTIONS<-1>='decimalPrecision="1"'şW$CHART.OPTIONS<-1>='thousandSeparator=","'şW$CHART.OPTIONS<-1>='pieradius="150"'ş*şRETURNş*şAVERAGE.DAYS.LAST.12.MONTHS:ş*şLAST.YEAR=YEARS<1,NUM.YEARS>ş**DEBUG=''şMOS.IN.LAST.YEAR=DCOUNT(MONTHLY.NUMBER.PAID<1,NUM.YEARS>,CHAR(252))ş**DEBUG<-1>=MOS.IN.LAST.YEARşMOS.IN.PREV.YEAR=12-MOS.IN.LAST.YEARş**DEBUG<-1>=MOS.IN.PREV.YEARşIF MOS.IN.PREV.YEAR = 12 THENş   LAST.YEAR=LAST.YEAR-1ş   THIS.MONTHLY.NUMBERS=MONTHLY.NUMBER.PAID<1,NUM.YEARS-1>ş   THIS.MONTHLY.TOTAL.DAYS=MONTHLY.TOTAL.DAYS<1,NUM.YEARS-1>ş   MONTHLY.LABELS='Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec'ş   CONVERT ',' TO CHAR(252) IN MONTHLY.LABELSş   START.MONTH="January ":LAST.YEARş   END.MONTH="December ":LAST.YEARş END ELSEş   FULL.MONTHS='January,February,March,April,May,June,July,August,September,October,November,December'ş   PREV.YEAR.MO.NO=12-MOS.IN.PREV.YEAR+1ş**DEBUG<-1>=PREV.YEAR.MO.NOş   START.MONTH=FIELD(FULL.MONTHS,',',PREV.YEAR.MO.NO):' ':(LAST.YEAR-1)ş   END.MONTH=FIELD(FULL.MONTHS,',',MOS.IN.LAST.YEAR):' ':LAST.YEARş   ABREV.MONTHS='Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec'ş   COMMA.POS=INDEX(ABREV.MONTHS,',',PREV.YEAR.MO.NO-1)ş   MONTHLY.LABELS=ABREV.MONTHS[COMMA.POS+1,9999]:',':(ABREV.MONTHS[1,COMMA.POS-1])ş   CONVERT ',' TO CHAR(252) IN MONTHLY.LABELSş   *ş   ** ISOLATE THE NUMBERS FOR THE PREVIOUS YEARş   *ş   THIS.MONTHLY.NUMBERS=MONTHLY.NUMBER.PAID<1,NUM.YEARS-1>ş   POS.BEFORE.FIRST=INDEX(THIS.MONTHLY.NUMBERS,CHAR(252),PREV.YEAR.MO.NO-1)ş   THIS.MONTHLY.NUMBERS=THIS.MONTHLY.NUMBERS[POS.BEFORE.FIRST+1,99999]ş   THIS.MONTHLY.NUMBERS:=CHAR(252):MONTHLY.NUMBER.PAID<1,NUM.YEARS>ş   THIS.MONTHLY.TOTAL.DAYS=MONTHLY.TOTAL.DAYS<1,NUM.YEARS-1>ş   POS.BEFORE.FIRST=INDEX(THIS.MONTHLY.TOTAL.DAYS,CHAR(252),PREV.YEAR.MO.NO-1)ş   THIS.MONTHLY.TOTAL.DAYS=THIS.MONTHLY.TOTAL.DAYS[POS.BEFORE.FIRST+1,99999]ş   THIS.MONTHLY.TOTAL.DAYS:=CHAR(252):MONTHLY.TOTAL.DAYS<1,NUM.YEARS>şENDşGOSUB AVERAGE.DAYS.BY.MONTHşRETURNş*şAVERAGE.DAYS.BY.MONTH.PER.YEAR:ş*şLOCATE AVERAGE.YEAR IN YEARS<1> SETTING YEAR.POS ELSE RETURNşTHIS.MONTHLY.NUMBERS=MONTHLY.NUMBER.PAID<1,YEAR.POS>şTHIS.MONTHLY.TOTAL.DAYS=MONTHLY.TOTAL.DAYS<1,YEAR.POS>şSTART.MONTH="January ":AVERAGE.YEARşEND.MONTH="December ":AVERAGE.YEARşMONTHLY.LABELS='Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec'şCONVERT ',' TO CHAR(252) IN MONTHLY.LABELSşGOSUB AVERAGE.DAYS.BY.MONTHşRETURNş*şAVERAGE.DAYS.BY.MONTH:ş*şW$TITLE = "Average Days To Pay"; CALL PORTAL.SHOW.LAST.UPDATED('AR')şW$TYPE = "FCCOLUMN3D"ş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEş*şW$BAR.XMEMO = "Month"şW$BAR.YMEMO = "Average Days to Pay"ş*şMONTH.NO=0ş*şFOR NN = 1 TO 12ş  MONTHLY.NUMBER=THIS.MONTHLY.NUMBERS<1,1,NN>ş  MONTHLY.DAYS=THIS.MONTHLY.TOTAL.DAYS<1,1,NN>ş  MONTHLY.LABEL=MONTHLY.LABELS<1,1,NN>ş  IF MONTHLY.NUMBER AND MONTHLY.DAYS THENş     AVERAGE.DAYS=INT(MONTHLY.DAYS * 10 / MONTHLY.NUMBER + .5)ş     AVERAGE.DAYS=OCONV(AVERAGE.DAYS,'MD1')ş   END ELSE AVERAGE.DAYS=0ş  W$BAR.VALUES<1,NN> = AVERAGE.DAYSş  W$BAR.XLABELS<1,NN> = MONTHLY.LABELşNEXT NNş*şW$BAR.CAPTION = "Average Days to Pay From ":START.MONTH:' to ':END.MONTHşW$CHART.OPTIONS<-1>='showValues="1"'şW$CHART.OPTIONS<-1>='formatNumber="1"'şW$CHART.OPTIONS<-1>='formatNumberScale="0"'şW$CHART.OPTIONS<-1>='decimalPrecision="1"'şRETURNş*şCUSTOMERS.BY.LARGEST.RECEIVABLES:ş*şW$TYPE='TABLE'şW$WIDTH = 3şMAX.HIGHEST.AMTS=DCOUNT(HIGHEST.AMTS.CUSTS,@VM)şIF MAX.HIGHEST.AMTS > 50 THEN MAX.HIGHEST.AMTS=50şW$TABLE.COL.LABELS<1,1> = "| --- Customers ---<br>| ":MAX.HIGHEST.AMTS:" With Most Amount Owed"şW$TABLE.COL.LABELS<1,2> = "Amount<br>Owed"şW$TABLE.COL.LABELS<1,3> = "Most Days|<br>&nbsp;&nbsp;&nbsp;&nbsp;Aged&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"şW$TABLE.COL.JUST<1,1> = "left"şW$TABLE.COL.JUST<1,2> = "center"şW$TABLE.COL.JUST<1,3> = "center"şIF MAX.HIGHEST.AMTS > 50 THEN MAX.HIGHEST.AMTS=50şW$TITLE = MAX.HIGHEST.AMTS:' Customers With Largest Receivables'; CALL PORTAL.SHOW.LAST.UPDATED('AR')şFOR I = 1 TO MAX.HIGHEST.AMTSş   CUSTOMER=HIGHEST.AMTS.CUSTS<1,I>ş   HIGHEST.AMT=HIGHEST.AMTS<1,I>ş   HIGHEST.AMT=OCONV(HIGHEST.AMT,'MD2,')ş   LOCATE CUSTOMER IN CUSTOMERS<1> SETTING CUST.POS ELSE CUST.POS=9999ş   CUST.HIGHEST.DAYS=CUST.MOST.DAYS.DUE<1,CUST.POS>ş   W$TABLE.DATA<I,1>=CUSTOMERş   W$TABLE.DATA<I,2>=HIGHEST.AMTş   W$TABLE.DATA<I,3>=CUST.HIGHEST.DAYSş NEXT Iş*RETURNş*şCUSTOMERS.BY.MOST.AGED.RECEIVABLES:ş*ş**W$TYPE='TABLE'ş**W$WIDTH = 2şMAX.HIGHEST.DAYS=DCOUNT(HIGHEST.DAYS.CUSTS,@VM)şIF MAX.HIGHEST.DAYS > 50 THEN MAX.HIGHEST.DAYS=50şW$TABLE.COL.LABELS<1,4> = "| --- Customers ---<br>| ":MAX.HIGHEST.DAYS:" With Most Days Aged"şW$TABLE.COL.LABELS<1,5> = "Most Days<br>Aged"şW$TABLE.COL.LABELS<1,6> = "&nbsp;Amount&nbsp;|<br>&nbsp;&nbsp;&nbsp;Owed&nbsp;&nbsp;&nbsp;|"şW$TABLE.COL.JUST<1,4> = "left"şW$TABLE.COL.JUST<1,5> = "center"şW$TABLE.COL.JUST<1,6> = "right"şW$TITLE = MAX.HIGHEST.DAYS:' Customers With Most Aged Receivables'; CALL PORTAL.SHOW.LAST.UPDATED('AR')şFOR I = 1 TO MAX.HIGHEST.DAYSş   CUSTOMER=HIGHEST.DAYS.CUSTS<1,I>ş   HIGHEST.DAY=HIGHEST.DAYS<1,I>ş   LOCATE CUSTOMER IN CUSTOMERS<1> SETTING CUST.POS ELSE CUST.POS=9999ş   AMT.DUE=CUST.AMT.DUES<1,CUST.POS>ş   W$TABLE.DATA<I,4>=CUSTOMERş   W$TABLE.DATA<I,5>=HIGHEST.DAYş   W$TABLE.DATA<I,6>=OCONV(AMT.DUE,'MD2,')ş NEXT Iş*RETURNş*şCUSTOMERS.BY.LARGEST.AGING.INCREASES:ş*ş*W$TYPE='TABLE'ş*W$WIDTH = 2şMAX.HIGHEST.INCREASE=DCOUNT(HIGHEST.INCREASE.CUSTS,@VM)şIF MAX.HIGHEST.INCREASE > 50 THEN MAX.HIGHEST.INCREASE=50şW$TABLE.COL.LABELS<1,7> = "| --- Customers ---<br>| ":MAX.HIGHEST.INCREASE:" With Significant Aging Increase"şW$TABLE.COL.LABELS<1,8> = "PCT<br>Increase"şW$TABLE.COL.LABELS<1,9> = "60<br>Day Avg"şW$TABLE.COL.LABELS<1,10> = "&nbsp;&nbsp;&nbsp;1000&nbsp;&nbsp;&nbsp;|<br>Day Avg|"şW$TABLE.COL.JUST<1,7> = "left"şW$TABLE.COL.JUST<1,8> = "center"şW$TABLE.COL.JUST<1,9> = "center"şW$TABLE.COL.JUST<1,10> = "center"şW$TITLE = MAX.HIGHEST.INCREASE:' Customers With Largest Aging Increase'; CALL PORTAL.SHOW.LAST.UPDATED('AR')şFOR I = 1 TO MAX.HIGHEST.INCREASEş   CUSTOMER=HIGHEST.INCREASE.CUSTS<1,I>ş   HIGHEST.INCREASE.PCT=HIGHEST.INCREASE.PCTS<1,I>ş   LOCATE CUSTOMER IN CUSTOMERS<1> SETTING CUST.POS ELSE CUST.POS=9999ş   W$TABLE.DATA<I,7>=CUSTOMERş   W$TABLE.DATA<I,8>=HIGHEST.INCREASE.PCTş   W$TABLE.DATA<I,9>=HIGHEST.INCREASE.60.DAY.AVG<1,I>ş   W$TABLE.DATA<I,10>=HIGHEST.INCREASE.1000.DAY.AVG<1,I>ş NEXT IşRETURN0014E0SUB.MOBILE.APPSş0c2    SUBROUTINE SUB.MOBILE.APPSş* @(#) SUB.MOBILE.APPS Ported to jBASE 17:55:32  08 JUL 2015ş*  The following variable names were convertedş*   STATUSş* ş*ş* Dashboard Widgetş*ş    INCLUDE WBPD MVDB.INCLUDEş*ş    W$TITLE = "Mobile Web App Registration"ş    W$TYPE = "TABLE"ş    W$WIDTH = 3     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*ş    IF G$QUERYMODE THEN RETURNş*ş* Set up column labelsş    W$TABLE.COL.LABELS<1,1> = "Subroutine Name"ş    W$TABLE.COL.LABELS<1,2> = "Application Name"ş    W$TABLE.COL.LABELS<1,3> = "Status"ş    W$TABLE.COL.LABELS<1,4> = "Action"ş*ş* Column justification = left, right, centerş    W$TABLE.COL.JUST<1,1> = "left"ş    W$TABLE.COL.JUST<1,2> = "left"ş    W$TABLE.COL.JUST<1,3> = "left"ş    W$TABLE.COL.JUST<1,4> = "left"ş*ş* Table Rowsş*ş    OPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSEş        W$TYPE = "TEXT"ş        W$TEXT.DATA = "Unable to open MVDB.CONTROL"ş        RETURNş    ENDş    READ MOBI.APPS FROM F.MVDB.CONTROL, "MOBI.APPS" ELSE MOBI.APPS = ""ş*ş    IF WIDGET.USER.DATA(1) # "" THENş        BEGIN CASEş        CASE G$SUBMITTEDş            SUBNAME = WIDGET.USER.DATA(1)ş            IF SUBNAME # "" THENş                LOCATE SUBNAME IN MOBI.APPS<1> BY "AL" SETTING POS THENş                    MOBI.APPS<2,POS> = WIDGET.USER.DATA(3)ş                    MOBI.APPS<3,POS> = WIDGET.USER.DATA(2)ş                END ELSEş                    MOBI.APPS = INSERT( MOBI.APPS, 1, POS, 0, SUBNAME )ş                    MOBI.APPS = INSERT( MOBI.APPS, 2, POS, 0, WIDGET.USER.DATA(3) )ş                    MOBI.APPS = INSERT( MOBI.APPS, 3, POS, 0, WIDGET.USER.DATA(2) )ş                ENDş            ENDş        CASE WIDGET.USER.DATA(2) = "delete"ş            MOBI.APPS = DELETE( MOBI.APPS, 1, WIDGET.USER.DATA(1), 0 )ş            MOBI.APPS = DELETE( MOBI.APPS, 2, WIDGET.USER.DATA(1), 0 )ş            MOBI.APPS = DELETE( MOBI.APPS, 3, WIDGET.USER.DATA(1), 0 )ş        CASE WIDGET.USER.DATA(2) = "play"ş            MOBI.APPS<2,WIDGET.USER.DATA(1)> = "A"ş        CASE WIDGET.USER.DATA(2) = "pause"ş            MOBI.APPS<2,WIDGET.USER.DATA(1)> = "I"ş        CASE WIDGET.USER.DATA(2) = "default"ş            LOCATE "D" IN MOBI.APPS<2> SETTING CURR.D THENş                MOBI.APPS<2,CURR.D> = "A"ş            ENDş            MOBI.APPS<2,WIDGET.USER.DATA(1)> = "D"ş        CASE 1ş        END CASEş        WRITE MOBI.APPS ON F.MVDB.CONTROL, 'MOBI.APPS'ş        WIDGET.USER.DATA(1) = ""ş        WIDGET.USER.DATA(2) = ""ş        WIDGET.USER.DATA(3) = ""ş    ENDş*ş    TOPROW = ""ş    FOR ROW = 1 TO DCOUNT(MOBI.APPS<1>, @VM )ş        SUB.NAME = MOBI.APPS<1,ROW>ş        ENC.SUB.NAME = SUB.NAMEş        CALL SUB.URL.ENCODE(ENC.SUB.NAME)ş        SUB.LINK = '<a href="/dbc/MVDB.WEB.ED?ed_file=MOBI.SUBS&ed_item=':ENC.SUB.NAME:'" target="MOBI.SUBS_':ENC.SUB.NAME:'">':SUB.NAME:'</a>'ş        W$TABLE.DATA<ROW,1> = SUB.LINKş        W$TABLE.DATA<ROW,2> = MOBI.APPS<3,ROW>ş        Status = MOBI.APPS<2,ROW>ş        BEGIN CASEş        CASE Status = "A"ş            Status = '<img src="/db/icons/bullet_green.png" />Active'ş        CASE Status = "I"ş            Status = '<img src="/db/icons/bullet_red.png" />Inactive'ş        CASE Status = "D"ş            Status = '<img src="/db/icons/bullet_green.png" /><b>Active/Default</b>'ş            Status := '&nbsp;<a href="/dbc/MVDB.MAIN?udview=':G$WIDGET.NAME:'&udpos1=1&udval1=':ROW:'&udpos2=2&udval2=play"><img src="/db/icons/control_stop.png" title="Un-set Default" /></a>'ş            TOPROW = ROWş        END CASEş        W$TABLE.DATA<ROW,3> = Statusş        ACTIONS = '<a href="/dbc/MVDB.MAIN?udview=':G$WIDGET.NAME:'&udpos1=1&udval1=':ROW:'&udpos2=2&udval2=delete" 'ş        ACTIONS := \onClick='confirm("Delete this entry?");'><img src="/db/icons/delete.png" title="Delete" /></a>\ş        ACTIONS := '&nbsp;'ş        IF MOBI.APPS<2,ROW> = "A" OR MOBI.APPS<2,ROW> = "D" THENş            ICON = "control_pause.png"ş            ACTION = "pause"ş            ALT = "Set as inactive"ş        END ELSEş            ICON = "control_play.png"ş            ACTION = "play"ş            ALT = "Set as active"ş        ENDş        ACTIONS := '<a href="/dbc/MVDB.MAIN?udview=':G$WIDGET.NAME:'&udpos1=1&udval1=':ROW:'&udpos2=2&udval2=':ACTION:'" ><img src="/db/icons/':ICON:'" title="':ALT:'" /></a>'ş        IF MOBI.APPS<2,ROW> # "D" THENş            ICON = "star.png"ş            ACTION = "default"ş            ALT = "Set as default"ş            ACTIONS := '&nbsp;<a href="/dbc/MVDB.MAIN?udview=':G$WIDGET.NAME:'&udpos1=1&udval1=':ROW:'&udpos2=2&udval2=':ACTION:'" ><img src="/db/icons/':ICON:'" title="':ALT:'" /></a>'ş        ENDş        W$TABLE.DATA<ROW,4> = ACTIONSş    NEXT ROWş*ş    IF TOPROW # "" THENş* Float this row to the top of the list (the default application)ş        ROW = W$TABLE.DATA<TOPROW>ş        W$TABLE.DATA = DELETE( W$TABLE.DATA, TOPROW, 0, 0 )ş        W$TABLE.DATA = INSERT( W$TABLE.DATA, 1, 0, 0, ROW )ş    ENDş*ş    W$INPUT.PROMPT<1> = "Add Subroutine"ş    W$INPUT.TYPE<1> = "TEXT"ş    W$INPUT.UDPOS<1> = 1ş*ş    W$INPUT.PROMPT<2> = "Description"ş    W$INPUT.TYPE<2> = "TEXT"ş    W$INPUT.UDPOS<2> = 2ş*ş    W$INPUT.PROMPT<3> = "Status"ş    W$INPUT.TYPE<3> = "SELECT"ş    W$INPUT.UDPOS<3> = 3ş    W$INPUT.DEFAULT<3> = "A"ş    W$INPUT.SELOPTS<3> = "Active":@VM:"Default":@VM:"Inactive"ş    W$INPUT.SELVALS<3> = "A":@VM:"D":@VM:"I"ş*ş    RETURN0003F5EXECUTE.STACKED.CMNDSş0c2SUBROUTINE EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,NUM.RETURNED,REPORT)ş*şREPORT=''şNUM.RETURNED=1şIF STACKED.1 <> '' THENş   EXECUTE STACKED.1 CAPTURING DUMMYş   NUM.RETURNED=SYSTEM(11)ş   IF NOT(NUM.RETURNED) THEN RETURNş ENDşBREAK.ON.POS2=INDEX(STACKED.2,'BREAK-ON ',2)şIF BREAK.ON.POS2 THENş   BREAK.ON.POS=INDEX(STACKED.2,'BREAK-ON ',1)ş   PLATFORM=OCONV('PLATFORM','TMVDB.CONTROL;X;1;1')ş   IF PLATFORM = '' THEN PLATFORM='D3'ş   IF PLATFORM = 'JB' THENş      STR1=STACKED.2[1,BREAK.ON.POS-1]ş      STR2=STACKED.2[BREAK.ON.POS,9999999]ş      PIPE.POS=INDEX(STR2,' PIPE ',1)ş      IF PIPE.POS THENş         BREAK.VAR=STR2[1,PIPE.POS-1]ş         BREAK.VAR=TRIM(BREAK.VAR)ş         BREAK.VAR=FIELD(BREAK.VAR,' ',2)ş         BREAK.VAR=' BREAK-ON ':BREAK.VAR:' "':"'V'|":'" 'ş         STR2=STR2[PIPE.POS,9999999]ş       END ELSEş         BREAK.VAR=''ş       ENDş      STACKED.2=STR1:BREAK.VAR:STR2ş    ENDş ENDşEXECUTE STACKED.2 CAPTURING REPORTşCONVERT '$,' TO '' IN REPORTşRETURNşEND0000D7TEST.TOMş0c2PROMPT ''şINPUT A,1şCRT AşINPUT A,0şCRT Aş****DATA "LIST SALES.FILE.PATH"ş****EXECUTE 'SELECT SALES.FILE.PATH WITH CLOSE.DATE = "5-1-20"'ş**IF 0 THEN XXX=@SENTENCE ELSE XXX=SENTENCE()ş**CRT XXXş**CRT XXX0003E3CREATE.UD.QPOINTERş0c2SUBROUTINE CREATE.UD.QPOINTER(ACCOUNT,FILENAME,CALL.IT,FI.QPOINTER)şOPEN '',CALL.IT TO FI.QPOINTER THENş   IF CALL.IT <> 'QFILE' THEN RETURNş ENDşCALL.IT.PARAM=CALL.ITşCALL.IT=''şOPEN '','VOC' TO FI.VOC ELSE RETURNşOPEN '','UD.ACCOUNTS' TO FI.UD.ACCOUNTS ELSEş   UD.ACCOUNTS='F'ş   UD.ACCOUNTS<-1>='@UDTHOME/sys/UD.ACCOUNT'ş   UD.ACCOUNTS<-1>='@UDTHOME/sys/D_UD.ACCOUNT'ş   WRITE UD.ACCOUNTS ON FI.VOC, 'UD.ACCOUNTS'ş   OPEN '','UD.ACCOUNTS' TO FI.UD.ACCOUNTS ELSE RETURNş ENDşREADV PATH FROM FI.UD.ACCOUNTS, ACCOUNT, 1 ELSE RETURNşF.POINTER='F'şF.POINTER<2>=PATH:'/':FILENAMEşF.POINTER<3>=PATH:'/D_':FILENAMEşWRITE F.POINTER ON FI.VOC, CALL.IT.PARAMşOPEN '',CALL.IT.PARAM TO FI.QPOINTER THENş   CALL.IT=CALL.IT.PARAMş   RETURNş ENDşF.POINTER<3>=PATH:'/D_VOC'şWRITE F.POINTER ON FI.VOC, CALL.IT.PARAMşOPEN '',CALL.IT.PARAM TO FI.QPOINTER THENş   * CHANGE CALL.IT TO SUCCESSFUL NAMEş   * OTHERWISE IT WILL RETURN WITH NULL SAYING FAILUREş   CALL.IT=CALL.IT.PARAMş ENDşRETURN00266FSUB.HERVEş0c2SUBROUTINE SUB.HERVEş*ş* Dashboard Widgetş*şINCLUDE WBPD MVDB.INCLUDEş*ş* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "Herve html to pdf test"     ;* Title for widget title barşW$TYPE = "HTML"               ;* Filled in by editorşW$WIDTH = 3                   ;* Full width (1=1/3, 2=2/3, 3=3/3)şW$PDFABLE = 1                 ;* Can be converted to PDFşW$PRINTABLE = 1               ;* Can be printedş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*şOPEN '','WEB.FORMS' TO FILE.WEB.FORMS ELSE NULLşREAD HTML FROM FILE.WEB.FORMS, 'VALENCOURS2368' ELSE HTML=''ş*ş*** Create a HTML stringş*ş*ş* In this example, we are including our own styles & scripts in <head>.ş* This causes MV Dashboard to display this content in an <iframe>.ş* Because this content does not render properly using the built-inş* DOCTYPE:ş*ş*   <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"ş*   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">ş*ş* we supply our own DOCTYPE to override the standard DOCTYPE.ş*şHTML = ''şHTML<-1> = \<!DOCTYPE HTML PUBLIC>\şHTML<-1> = \<html>\şHTML<-1> = \<head>\şHTML<-1> = \<title>Etat de la Valorisation des Encours</title>\şHTML<-1> = \<style type="text/css"> \şHTML<-1> = \body {background:#CCC; height:100%;}\şHTML<-1> = \h1 { color:#000000; font-weight:bold; font-size:40px; }\şHTML<-1> = \h2 { color:#000000; font-weight:bold; font-size:30px; }\şHTML<-1> = \h3 { color:#000000; font-size:20px; }\şHTML<-1> = \table { width: 97%; border: 1px solid #777; border-collapse:collapse; font-family:sans_serif, Verdana, Arial, Helvetica; }\şHTML<-1> = \thead { background-color:#fa3; }\şHTML<-1> = \tfoot { background-color:#fea; }\şHTML<-1> = \td { border-style:solid; border-width:1px; border-color:silver; font-size:10px; }\şHTML<-1> = \th { border-style:solid; border-width:1px; border-color:#6f5b85; font-size:11px; }\şHTML<-1> = \.titre { color:blue; font-weight:bold; font-size:40px; }\şHTML<-1> = \.stitre { color:BLACK; font-weight:bold; font-size:20px; }\şHTML<-1> = \.over { background-color: #ef2e25; color: white; }\şHTML<-1> = \.normal { background-color: white; }\şHTML<-1> = \.lig0 { background-color: #dcdcdc; } /* lignes paires */\şHTML<-1> = \.lig1 { background-color: #white; }  /* lignes impaires */\şHTML<-1> = \.alink { font-weight: bold; text-decoration: none; color: blue; }\şHTML<-1> = \#date { position: absolute; top: 10px; right: 15px; font-size: 14px; }\şHTML<-1> = \#titre { position: absolute;top: 30px; left: 300px; font-weight: bold; font-size: 30px; }\şHTML<-1> = \#stitre { position: absolute; top: 60px; left: 300px; font-weight: bold; font-size: 14px; }\şHTML<-1> = \#dateheure { position: absolute; top: 0px; width: 95%; text-align: right; font-size: 12px; }\şHTML<-1> = \#container { width: 100%; padding:15px;}\şHTML<-1> = \#banniere { margin:auto; background:url(logo.png) no-repeat; width:1000px; height:100px; padding-top:10px;position: relative;}\şHTML<-1> = \#content { width:1050px; background:#FFF; border-radius:15px; margin: auto; -moz-border-radius: 15px; display: block;}\şHTML<-1> = \.titre_tab { font-size:14px; font-weight:bold; text-align:left; padding-left:5px;}\şHTML<-1> = \.entete_tab_sem { background:#CCC;font-size:12px; font-weight:bold; text-align:center;}\şHTML<-1> = \.entete_tab_we { background:#fa3;font-size:12px; font-weight:bold; text-align:center;}\şHTML<-1> = \.cell_sem { text-align:center;background:#CFC;margin:0;padding:0;font-size:12px;}\şHTML<-1> = \.cell_we { background:#Fea};\şHTML<-1> = \</style>\şHTML<-1> = \<script>\şHTML<-1> = \  var affiche = "-";\şHTML<-1> = \function changetout(max) {\şHTML<-1> = \   var i    = 0;\şHTML<-1> = \   var val  = "";\şHTML<-1> = \   for (i=1; i <= max; i++) {\şHTML<-1> = \        if (affiche == "-") { val = "G" } else { val = "D" }\şHTML<-1> = \        val = val + i;\şHTML<-1> = \        change(val);\şHTML<-1> = \   }\şHTML<-1> = \   document.getElementById("idth1").innerText = affiche;\şHTML<-1> = \   if (affiche == "-") {\şHTML<-1> = \       affiche = "+"\şHTML<-1> = \   } else {\şHTML<-1> = \       affiche = "-"\şHTML<-1> = \   }\şHTML<-1> = \}\şHTML<-1> = \function change(lig) {\şHTML<-1> = \   car1 = lig.slice(0,1);\şHTML<-1> = \   car2 = lig.slice(1,lig.length);\şHTML<-1> = \   obj = document.getElementById(lig);\şHTML<-1> = \   val = obj.style.display;\şHTML<-1> = \   obj.style.display = "none";\şHTML<-1> = \   if (car1 == "G") {\şHTML<-1> = \      val = "D" + car2;\şHTML<-1> = \   } else {\şHTML<-1> = \      val = "G" + car2;\şHTML<-1> = \   }\şHTML<-1> = \   document.getElementById(val).style.display = "";\şHTML<-1> = \}\şHTML<-1> = \</script>\şHTML<-1> = \</head>\şHTML<-1> = \<body>\şHTML<-1> = \<div id="BANNIERE">\şHTML<-1> = \<div id="titre">Etat de la Valorisation des Encours<br/></div>\şHTML<-1> = \<div id="dateheure">le 14/12/2015 &agrave; 18:05:24</div></div>\şHTML<-1> = \<div id="container">\şHTML<-1> = \<table>\şHTML<-1> = \<thead>\şHTML<-1> = \<tr>\şHTML<-1> = \<th colspan="4">Composant</th>\şHTML<-1> = \<th colspan="2">OF</th>\şHTML<-1> = \<th colspan="2">OF Lanc&eacute;</th>\şHTML<-1> = \<th colspan="4">Pr&eacute;vu</th>\şHTML<-1> = \<th colspan="4">R&eacute;el</th>\şHTML<-1> = \</tr>\şHTML<-1> = \<tr>\şHTML<-1> = \<th>Type</th>\şHTML<-1> = \<th>ABC</th>\şHTML<-1> = \<th>Code</th>\şHTML<-1> = \<th>D&eacute;signation</th>\şHTML<-1> = \<th>No</th>\şHTML<-1> = \<th>Etat</th>\şHTML<-1> = \<th>No</th>\şHTML<-1> = \<th>Qt&eacute;</th>\şHTML<-1> = \<th>PU</th>\şHTML<-1> = \<th>Co&ucirc;t</th>\şHTML<-1> = \<th>Co&ucirc;t Prod</th>\şHTML<-1> = \<th>No<br/>OF</th>\şHTML<-1> = \<th>PU</th>\şHTML<-1> = \<th>Co&ucirc;t</th>\şHTML<-1> = \<th>Co&ucirc;t Prod</th>\şHTML<-1> = \<th>No<br/>OF</th>\şHTML<-1> = \</tr>\şHTML<-1> = \</thead><tbody>\şHTML<-1> = \<tr class="lig1"><td></td><td></td>\şHTML<-1> = \<td>T370366-0204-A0</td><td></td><td>3362</td><td>37</td><td>1</td><td>2</td><td align=right>76300</td><td align=right></td><td align=right></td><td align=right>0.00</td><td align=right></td><td align=right></td><td align=right></td><td align=right>0.00</td>\şHTML<-1> = \</tr>\şHTML<-1> = \<tr class="lig0"><td>MS</td><td></td>\şHTML<-1> = \<td>1041</td><td>Bouchon AMORIM</td><td>3362</td><td>37</td><td>1</td><td>2</td><td align=right>76300</td><td align=right></td><td align=right>0.00</td><td align=right></td><td align=right>76300</td><td align=right>0</td><td align=right>0.00</td><td align=right></td>\şHTML<-1> = \</tr>\şHTML<-1> = \<tr class="ligtot"><td colspan="8">Total MS</td><td></td><td></td><td align=right>0</td><td align=right>0</td><td></td><td></td><td align=right>0</td><td align=right>0</td>\şHTML<-1> = \<tr class="lig1"><td>N</td><td></td>\şHTML<-1> = \<td>0000750-R1052-0</td><td>Capsule R1052-0</td><td>3362</td><td>37</td><td>1</td><td>2</td><td align=right>76300</td><td align=right></td><td align=right>0.00</td><td align=right></td><td align=right>76300</td><td align=right>0</td><td align=right>0.00</td><td align=right></td>\şHTML<-1> = \</tr>\şHTML<-1> = \<tr class="lig0"><td>N</td><td></td>\şHTML<-1> = \<td>6X75CL.DBT.SS.CR</td><td>CARTON DE 6 BTL DE 0.75</td><td>3362</td><td>37</td><td>1</td><td>2</td><td align=right>12743</td><td align=right></td><td align=right>0.00</td><td align=right></td><td align=right>12743</td><td align=right>0</td><td align=right>0.00</td><td align=right></td>\şHTML<-1> = \</tr>\şHTML<-1> = \<tr class="lig1"><td>N</td><td></td>\şHTML<-1> = \<td>B01.001</td><td>Bouteille 0.75 all&eacute;g&eacute;e</td><td>3362</td><td>37</td><td>1</td><td>2</td><td align=right>76300</td><td align=right></td><td align=right>0.00</td><td align=right></td><td align=right>76300</td><td align=right>0</td><td align=right>0.00</td><td align=right></td>\şHTML<-1> = \</tr>\şHTML<-1> = \<tr class="lig0"><td>N</td><td></td>\şHTML<-1> = \<td>P2E.EURO</td><td>Palette EURO<br/>80x120<br/>24kg &agrave; vide</td><td>3362</td><td>37</td><td>1</td><td>2</td><td align=right>130</td><td align=right></td><td align=right>0.00</td><td align=right></td><td align=right>130</td><td align=right>0</td><td align=right>0.00</td><td align=right></td>\şHTML<-1> = \</tr>\şHTML<-1> = \<tr class="ligtot"><td colspan="8">Total N</td><td></td><td></td><td align=right>0</td><td align=right>0</td><td></td><td></td><td align=right>0</td><td align=right>0</td>\şHTML<-1> = \<tr class="lig1"><td>P</td><td>2013</td>\şHTML<-1> = \<td>U370018-0000B-1</td><td>PINOT GRIS<br/>QUALITE SYSTEM U<br/>MILLESIME 2013</td><td>3362</td><td>37</td><td>1</td><td>2</td><td align=right>573</td><td align=right></td><td align=right>0.00</td><td align=right></td><td align=right>574</td><td align=right>0</td><td align=right>0.00</td><td align=right></td>\şHTML<-1> = \</tr>\şHTML<-1> = \<tr class="ligtot"><td></td><td colspan="7">Total 2013</td><td></td><td></td><td align=right>0</td><td align=right>0</td><td></td><td></td><td align=right>0</td><td align=right>0</td>\şHTML<-1> = \</tr>\şHTML<-1> = \<tr class="ligtot"><td colspan="8">Total P</td><td></td><td></td><td align=right>0</td><td align=right>0</td><td></td><td></td><td align=right>0</td><td align=right>0</td>\şHTML<-1> = \</tr>\şHTML<-1> = \</tbody>\şHTML<-1> = \<tfoot><tr><td colspan="8">Total G&eacute;n&eacute;ral </td><td></td><td></td><td align=right>0</td><td align=right>0</td><td></td><td></td><td align=right>0</td><td align=right>0</td>\şHTML<-1> = \</tr><tr><td colspan="8"></td><td></td><td></td><td colspan="2" align=center>0</td><td></td><td></td><td colspan="2" align=center>0</td>\şHTML<-1> = \</tr>\şHTML<-1> = \</tfoot>\şHTML<-1> = \</table>\şHTML<-1> = \</div>\şHTML<-1> = \</body>\şHTML<-1> = \</html>\şşW$HTML.DATA = HTMLş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN000DFADEMO.FINANCIALS.DASHBOARDş0c2SUBROUTINE DEMO.FINANCIALS.DASHBOARDş*ş* Dashboard Widgetş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEş*ş* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şWEB$TITLE='Demo Company, Financial Picture'şWEB.FORM.NAME='DEMO.FINANCIALS.DASHBOARD'şW$TYPE='HTML'şW$TITLE='Demo Financial Company'şW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*şOPEN '','MVDB.CONTROL' TO FILE ELSE STOPşNOV15=ICONV('11-15-15','D')şTODAY=DATE()şIF TODAY > NOV15 THENş   TODAY=NOV15ş   TIME.DATE=OCONV(TIME(),'MTHS'):' ':OCONV(TODAY,'D4')ş END ELSEş   TIME.DATE=TIMEDATE()ş ENDşOTODAY=OCONV(TODAY,'D4-')şTODAY.MO=OTODAY[1,2]+0şTODAY.YYYY=OTODAY[7,4]şIF INDEX(TIME.DATE,'CALCULATIONS THROUGH',1) THENş   * LAST CALCULATION WAS FOR END OF LAST YEARş   DASHBOARD.YYYY=TODAY.YYYY-1ş END ELSE DASHBOARD.YYYY=TODAY.YYYYşIF LEN(WIDGET.USER.DATA(1)) = 4 THENş   WRITE WIDGET.USER.DATA(1) ON FILE, 'DASHBOARD.YYYY'ş END ELSEş   WIDGET.USER.DATA(1)=DASHBOARD.YYYYş ENDşCONVS=''şLAST.YYYY=TODAY.YYYY-1şLAST.EOM=ICONV(TODAY.MO:'-01-':TODAY.YYYY,'D')-1ş*ş** BUILD FRESH STATIC DATA IF A NEW RUN DATEş*şREAD LAST.BUILT FROM FILE, 'LAST.STATIC.BUILD' ELSE LAST.BUILT=''şIF LAST.BUILT <> DATE() THENş   CALL BUILD.DEMO.FINANCIAL.PICTURE(TODAY.YYYY,TODAY,LAST.EOM)ş   WRITE LAST.BUILT ON FILE, 'LAST.STATIC.BUILD'ş ENDşREAD REC FROM FILE, 'DEMO.FINANCIAL.PICTURE' ELSE REC=''ş*ş* DEFAULT CONVERSIONS TO $şFOR I = 4 TO 35ş   IF I < 29 OR I > 32 THENş      CONVS<I>='$'ş    ENDş NEXT Iş* CHANGE THOSE THAT AREN'TşCONVS<6>='%'; CONVS<10>='%'; CONVS<17>='%'; CONVS<24>='%'şCONVS<12>='%'; CONVS<13>='%'; CONVS<14>='%'şCONVS<19>='%'; CONVS<20>='%'; CONVS<21>='%'şCONVS<26>='%'; CONVS<27>='%'; CONVS<28>='%'ş*MATWRITE WIDGET.USER.DATA ON FILE, 'TEST.LINK'ş*şW$PRINTABLE=1şW$PDFABLE=1şOPEN '','WEB.FORMS' TO FILE.WEB.FORMS ELSE RETURNşREAD HTML FROM FILE.WEB.FORMS, WEB.FORM.NAME ELSE HTML=''ş*ş**USER.ID=G$USERIDş*şW$TITLE:='  Demo Financials  -- last updated --  ':TIME.DATEş*ş*WRITE HTML ON FILE.WEB.FORMS, 'TEST.HTML'ş*ş** DYNAMIC VARIABLESş*ş*INSERT.FIELD=DB.REC<4>;  * CUSTOMERş*IF INSERT.FIELD = '' THEN INSERT.FIELD='&nbsp;'ş*CALL SWAP(HTML,'~1~',INSERT.FIELD)şFOR I = 1 TO 46ş   INSERT.FIELD=REC<I>şIF INSERT.FIELD = '' THEN INSERT.FIELD=Iş   CONV=CONVS<I>ş   BEGIN CASEş      CASE CONV = ''; NULLş      CASE CONV = '$'; INSERT.FIELD=OCONV(INSERT.FIELD+0,'MD2,$')ş      CASE CONV = '%'; INSERT.FIELD=OCONV(INSERT.FIELD+0,'MD1'):'%'ş      CASE 1; INSERT.FIELD=OCONV(INSERT.FIELD,CONV)ş   END CASEş   IF INSERT.FIELD = '' THEN INSERT.FIELD='&nbsp;'ş   CALL SWAP(HTML,'~':I:'~',INSERT.FIELD)ş NEXT Iş   *şW$TEXT.DATA=HTMLşIF 0 THEN; *IF TODAY.MO = 1 THENş   W$INPUT.PROMPT<1>='As of Date'ş   W$INPUT.TYPE<1> = "SELECT"ş   W$INPUT.DEFAULT<1> = WIDGET.USER.DATA(1)ş   W$INPUT.UDPOS<1> = 1ş   W$INPUT.BUTTON<1> = "Apply"ş   W$INPUT.SELVALS<1>=TODAY.YYYY-1:CHAR(253):TODAY.YYYYş   W$INPUT.SELOPTS<1>='12-31-':TODAY.YYYY-1:CHAR(253):OCONV(DATE(),'D4-')ş   ITIME=ICONV(FIELD(TIME.DATE,' ',1),'MT')ş   NEXT.TIME=ITIME+1800;  * 30 MINUTESş   IF ABS(TIME()-NEXT.TIME) < 300 THEN;  * WITHIN 5 MINUTES TELL LONGERş      NEXT.TIME+=1800ş    ENDş   REFRESH.TIME=' - Wont refresh until app. ':OCONV(NEXT.TIME,'MTH')ş   IF DASHBOARD.YYYY = TODAY.YYYY THENş      * DECEMBER WILL REQUIRE A RECALCş      W$INPUT.SELOPTS<1,1>:=REFRESH.TIMEş    END ELSEş      * TODAY WILL REQUIRE A RECALCş      W$INPUT.SELOPTS<1,2>:=REFRESH.TIMEş    ENDş   *ş ENDşWRITE HTML ON FILE.WEB.FORMS, 'LAST.':WEB.FORM.NAMEşRETURNşEND000551SUB.SC.LIB.PIEş0c2SUBROUTINE SUB.SC.LIB.PIEş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Pie Demoş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şIF INDEX(G$WIDGET.NAME,'Progs',1) THENş  PIE.CNT = "PROG"ş  W$TITLE = "Source Code: Programs by Library"şEND ELSEş  PIE.CNT = "LINES"ş  W$TITLE = "Source Code: Lines by Library"şENDşW$TYPE = "FC3DPIE"şW$WIDTH = 1ş*şIF G$QUERYMODE THEN RETURNş*şDIM LIB.FILES(3), PROGS(3), LINES(3), LIBS(3)ş*şLIBS(1) = "MVDB.SUBS"şLIBS(2) = "RSS.BP"şLIBS(3) = "WBPD"ş*şMAT PROGS = 0; MAT LINES = 0ş*şTOT.LINES = 0 ; TOT.PROGS = 0şFOR N = 1 TO 3ş  OPEN LIBS(N) TO LIB.FILES(N) ELSE STOP 201, LIBS(N)ş  W$PIE.LABELS<1,N> = LIBS(N)ş  SELECT LIB.FILES(N)ş  LOOPş    READNEXT ID ELSE EXITş    PROGS(N) += 1ş    IF PIE.CNT # "PROG" THENş      READ REC FROM LIB.FILES(N), ID THENş        LINES(N) += DCOUNT(REC, @AM)ş      ENDş    ENDş  REPEATş  TOT.LINES += LINES(N)ş  TOT.PROGS += PROGS(N)ş  IF PIE.CNT = "PROG" THENş    W$PIE.VALUES<1,N> = PROGS(N)ş  END ELSEş    W$PIE.VALUES<1,N> = LINES(N)ş  END şNEXT Nş*şW$PIE.CAPTION = "By Program File"şIF PIE.CNT = "PROG" THENş  W$CHART.OPTIONS<-1> = "subCaption='":TOT.PROGS:" Total Programs'"ş  W$CHART.OPTIONS<-1> = "showValues='1'"şEND ELSEş  W$CHART.OPTIONS<-1> = "subCaption='":OCONV(TOT.LINES,'MD,'):" Total Lines'"şENDş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN000512SUB.DEMO.NET.INCOME.CHARTş0c2SUBROUTINE SUB.DEMO.NET.INCOME.CHARTş*ş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Net Income"şW$TYPE = "FCCOLUMN3D"şW$WIDTH = 2şW$PDFABLE = 1ş*şIF G$QUERYMODE THEN RETURNş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEşOPEN '','MVDB.CONTROL' TO FILE.CONTROL ELSE STOPşREAD REC FROM FILE.CONTROL, 'DEMO.FINANCIAL.PICTURE' ELSE REC=''şYEARS=REC<67>şNET.INCOMES=REC<75>şMAX.YEARS=DCOUNT(YEARS,CHAR(253))şFIRST.YEAR=YEARS<1,1>şCURRENT.YEAR=YEARS<1,MAX.YEARS>ş*şW$BAR.CAPTION = "Net Income From ":FIRST.YEAR:' to ':CURRENT.YEARşW$BAR.XMEMO = "Year"şW$BAR.YMEMO = "Net Income"ş*ş*şMAX.INCOME=0şFOR N = 1 TO MAX.YEARSş  NET.INCOME=OCONV(REC<36-N>,'MD02')ş  IF NET.INCOME > MAX.INCOME THEN MAX.INCOME=NET.INCOMEş  YEAR=YEARS<1,N>ş  W$BAR.VALUES<1,N> = NET.INCOMEş  W$BAR.XLABELS<1,N> = YEARşNEXT Nş* ROUND MAX INCOME UP TO THE NEXT 250000şMAX.INCOME+=250000şMAX.INCOME=INT(MAX.INCOME/250000) * 250000şW$CHART.OPTIONS<-1>='yAxisMaxValue="':MAX.INCOME:'"'şW$CHART.OPTIONS<-1>='decimals="2"'şW$CHART.OPTIONS<-1>='formatNumberScale="1"'şW$CHART.OPTIONS<-1>='forceDecimals="1"'şW$CHART.OPTIONS<-1>='divLineDecimalPrecision="2"'şW$CHART.OPTIONS<-1>='limitsDecimalPrecision="2"'ş*ş*şRETURN000068REBUILD.FILESş0c2FILE='SALES'; EVERY.NUM=6; GOSUB MOVE.ITşFILE='AR'; EVERY.NUM=3; GOSUB MOVE.ITşFILE='AP000277SUB.GRID.TESTş0c2SUBROUTINE SUB.GRID.TESTş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş*şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Untitled TABLE"şW$TYPE = "TABLE"şW$WIDTH = 3 ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş* Set up column labelsşW$TABLE.COL.LABELS<1,1> = "Column 1"şW$TABLE.COL.LABELS<1,2> = "Column 2"ş*ş* Column justification = left, right, centerşW$TABLE.COL.JUST<1,1> = "left"şW$TABLE.COL.JUST<1,2> = "right"ş*ş* Table RowsşFOR ROW = 1 TO 5ş  W$TABLE.DATA<ROW,1> = ROW:",1"ş  W$TABLE.DATA<ROW,2> = ROW:",2"şNEXT ROWş*ş* TotalsşW$TABLE.TOTALS<1,1> = "2"şW$TABLE.TOTALS<1,2> = "4"şRETURN000255SUB.DEMO.DRILLDOWNş0c2SUBROUTINE SUB.DEMO.DRILLDOWNş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Demo drill-down widgetş*şINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "TEXT"şW$TITLE = "Drilldown Widget"şW$WIDTH = 3şW$PRINTABLE = 1ş*şIF G$QUERYMODE = 1 THEN RETURNş*şW$TEXT.DATA = "Source Widget: ":G$DD.REFERRERşW$TEXT.DATA<-1> = " "şW$TEXT.DATA<-1> = "Contents of WIDGET.USER.DATA:"şW$TEXT.DATA<-1> = " "şFOR X = 1 TO 100ş  IF WIDGET.USER.DATA(X) # "" THENş    W$TEXT.DATA<-1> = "WIDGET.USER.DATA(":X:") = ":WIDGET.USER.DATA(X)ş  ENDşNEXT Xş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN0005AASUB.PORTAL.SETUP.DOCUMENTATIONş0c2SUBROUTINE SUB.PORTAL.SETUP.DOCUMENTATIONş*ş* Dashboard Widgetş*şINCLUDE WBPD MVDB.INCLUDEş*ş* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "Portal Setup Instructions"     ;* Title for widget title barşW$TYPE = "HTML"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*şOPEN '','MVDB.CONTROL' TO FI.MVDB.CONTROL ELSE ş   MESSAGE='MVDB.CONTROL'ş   GOTO MESSAGE.DISPLAYşENDşREAD PLATFORM FROM FI.MVDB.CONTROL, 'PLATFORM' ELSEş   MESSAGE='No Platform Type Defined'ş   GOTO MESSAGE.DISPLAYş ENDşOPEN '','WEB.FORMS' TO FI.WEB.FORMS ELSE ş   MESSAGE='CANT OPEN WEB.FORMS'ş   GOTO MESSAGE.DISPLAYşENDşIF PLATFORM = 'JB' THENş   DOCU.ID='JBASE.PORTAL.SETUP.DOCUMENTATION'şEND ELSEş   DOCU.ID='PORTAL.SETUP.DOCUMENTATION'şENDşREAD WEB.FORM FROM FI.WEB.FORMS, DOCU.ID ELSE ş   MESSAGE='UNABLE TO READ ':DOCU.IDş   GOTO MESSAGE.DISPLAYşENDşW$HTML.DATA=WEB.FORMş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURNş*şMESSAGE.DISPLAY:ş*şMAX.MSG=DCOUNT(MESSAGE,CHAR(254))şW$HTML.DATA='<h3>':MESSAGE<1>şIF MAX.MSG > 1 THENş   FOR MSG.NO = 2 TO MAX.MSGş      W$HTML.DATA:='<br>':MESSAGE<MSG.NO>ş    NEXT MSG.NOş ENDşW$HTML.DATA:='</h3>'şRETURN005950SUB.PORTAL.SALES.REPORT.SETUPş0c2SUBROUTINE SUB.PORTAL.SALES.REPORT.SETUPş*ş* DEFINE PARAMETERS FOR PORTAL SALES REPORTş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEşOPEN '','MVDB.SUBS' TO FI.MVDB.SUBS ELSE STOPş*şW$TITLE = "Portal Sales Report Setup"şW$TYPE = "HTML"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şEQUATE ACCOUNT TO WIDGET.USER.DATA(1)şEQUATE REPORT.FILE TO WIDGET.USER.DATA(2)şEQUATE SALE.DATE.DICT TO WIDGET.USER.DATA(3)şEQUATE SALE.MONTH.DICT TO WIDGET.USER.DATA(4)şEQUATE SALE.YEAR.DICT TO WIDGET.USER.DATA(5)şEQUATE SALE.AMOUNT.DICT TO WIDGET.USER.DATA(6)şEQUATE COST.OF.SALE.AMOUNT.DICT TO WIDGET.USER.DATA(7)şEQUATE SALESMAN.DICT TO WIDGET.USER.DATA(8)şEQUATE BRANCH.DICT TO WIDGET.USER.DATA(9)şEQUATE REGION.DICT TO WIDGET.USER.DATA(10)şEQUATE SALE.DATE.AMC TO WIDGET.USER.DATA(11)şEQUATE SALE.AMOUNT.AMC TO WIDGET.USER.DATA(12)şEQUATE SALE.AMOUNT.CONV TO WIDGET.USER.DATA(13)şEQUATE SALE.AMOUNT.COOR TO WIDGET.USER.DATA(14)şEQUATE COST.OF.SALE.AMOUNT.AMC TO WIDGET.USER.DATA(15)şEQUATE COST.OF.SALE.AMOUNT.CONV TO WIDGET.USER.DATA(16)şEQUATE COST.OF.SALE.AMOUNT.COOR TO WIDGET.USER.DATA(17)şEQUATE SALESMAN.AMC TO WIDGET.USER.DATA(18)şEQUATE SALESMAN.TFILE TO WIDGET.USER.DATA(19)şEQUATE BRANCH.AMC TO WIDGET.USER.DATA(20)şEQUATE BRANCH.TFILE TO WIDGET.USER.DATA(21)şEQUATE REGION.AMC TO WIDGET.USER.DATA(22)şEQUATE REGION.TFILE TO WIDGET.USER.DATA(23)şOPEN '','MVDB.CONTROL' TO FI.MVDB.CONTROL ELSE STOP 201,'MVDB.CONTROL'şREAD PLATFORM FROM FI.MVDB.CONTROL, 'PLATFORM' ELSEş   MESSAGE='No Platform Type Defined'ş   GOTO MESSAGE.DISPLAYş ENDşFIRST.TIME=0şIF G$SUBMITTED <> '1' THENş   IF PLATFORM = 'UV' OR PLATFORM = 'UD' THENş      OPEN '','UD.DICT.DASHBOARD.CLOSING.STATS' TO FI THENş         OPEN 'DICT','DASHBOARD.CLOSING.STATS' TO DFI THENş            SELECT FIş            LOOPş               READNEXT ID ELSE ID='DONE'ş            UNTIL ID = 'DONE' DOş               READ REC FROM FI, ID ELSE REC=''ş               IF REC <> '' THENş                  WRITE REC ON DFI, IDş                ENDş            REPEATş          ENDş       ENDş      OPEN '','UD.DICT.SALES' TO FI THENş         OPEN 'DICT','PORTAL.SALES' TO DFI THENş            SELECT FIş            LOOPş               READNEXT ID ELSE ID='DONE'ş            UNTIL ID = 'DONE' DOş               READ REC FROM FI, ID ELSE REC=''ş               IF REC <> '' THENş                  WRITE REC ON DFI, IDş                ENDş            REPEATş          ENDş       ENDş      OPEN '','UD.DICT.AR' TO FI THENş         OPEN 'DICT','PORTAL.AR' TO DFI THENş            SELECT FIş            LOOPş               READNEXT ID ELSE ID='DONE'ş            UNTIL ID = 'DONE' DOş               READ REC FROM FI, ID ELSE REC=''ş               IF REC <> '' THENş                  WRITE REC ON DFI, IDş                ENDş            REPEATş          ENDş       ENDş      OPEN '','UD.DICT.AP' TO FI THENş         OPEN 'DICT','PORTAL.AP' TO DFI THENş            SELECT FIş            LOOPş               READNEXT ID ELSE ID='DONE'ş            UNTIL ID = 'DONE' DOş               READ REC FROM FI, ID ELSE REC=''ş               IF REC <> '' THENş                  WRITE REC ON DFI, IDş                ENDş            REPEATş          ENDş       ENDş    ENDş   MATREAD WIDGET.USER.DATA FROM FI.MVDB.CONTROL, 'PORTAL.SALES.REPORT.SETUP' ELSEş      MAT WIDGET.USER.DATA = ''ş      FIRST.TIME=1ş    ENDş   IF NOT(FIRST.TIME) THENş      GOSUB VALIDATE.PREVIOUS.INPUTSş    ENDş END ELSEş   GOSUB VALIDATE.PREVIOUS.INPUTSş   MATWRITE WIDGET.USER.DATA ON FI.MVDB.CONTROL, 'PORTAL.SALES.REPORT.SETUP'ş ENDşGOSUB SET.PROMPTSşRETURNş*şSET.PROMPTS:ş*şIF PLATFORM = 'JB' THENş   W$INPUT.PROMPT<1> = "Sales File Account Path"şEND ELSEş   W$INPUT.PROMPT<1> = "Sales File Account"şENDşW$INPUT.TYPE<1> = "TEXT"şW$INPUT.UDPOS<1> = 1şW$INPUT.DEFAULT<1> = ACCOUNTş*şW$INPUT.PROMPT<2> = "Name Of Sales File"şW$INPUT.TYPE<2> = "TEXT"şW$INPUT.UDPOS<2> = 2şW$INPUT.DEFAULT<2> = REPORT.FILEş*şW$INPUT.PROMPT<3> = "Date Of Sale Dict Name"şW$INPUT.TYPE<3> = 'TEXT'şW$INPUT.UDPOS<3> = 3şW$INPUT.DEFAULT<3> = SALE.DATE.DICTş*şW$INPUT.PROMPT<4> = "Month Of Sale Dict Name"şW$INPUT.TYPE<4> = 'TEXT'şW$INPUT.UDPOS<4> = 4şW$INPUT.DEFAULT<4> = SALE.MONTH.DICTş*şW$INPUT.PROMPT<5> = "Year Of Sale Dict Name"şW$INPUT.TYPE<5> = 'TEXT'şW$INPUT.UDPOS<5> = 5şW$INPUT.DEFAULT<5> = SALE.YEAR.DICTş*şW$INPUT.PROMPT<6> = "Amount Of Sale Dict Name"şW$INPUT.TYPE<6> = 'TEXT'şW$INPUT.UDPOS<6> = 6şW$INPUT.DEFAULT<6> = SALE.AMOUNT.DICTş*şW$INPUT.PROMPT<7> = "Cost Of Sale Dict Name"şW$INPUT.TYPE<7> = 'TEXT'şW$INPUT.UDPOS<7> = 7şW$INPUT.DEFAULT<7> = COST.OF.SALE.AMOUNT.DICTş*şW$INPUT.PROMPT<8> = "Salesman Dict Name"şW$INPUT.TYPE<8> = 'TEXT'şW$INPUT.UDPOS<8> = 8şW$INPUT.DEFAULT<8> = SALESMAN.DICTş*şW$INPUT.PROMPT<9> = "Branch Dict Name"şW$INPUT.TYPE<9> = 'TEXT'şW$INPUT.UDPOS<9> = 9şW$INPUT.DEFAULT<9> = BRANCH.DICTş*şW$INPUT.PROMPT<10> = "Region Dict Name"şW$INPUT.TYPE<10> = 'TEXT'şW$INPUT.UDPOS<10> = 10şW$INPUT.DEFAULT<10> = REGION.DICTş*şRETURNş*şVALIDATE.PREVIOUS.INPUTS:ş*şMESSAGE=''şBEGIN CASEş   CASE PLATFORM = 'D3'ş      MD.TYPE='MD'ş   CASE PLATFORM = 'JB'ş      MD.TYPE='MD'ş   CASE 1ş      MD.TYPE='VOC'şEND CASEşOPEN '',MD.TYPE TO FI.MD ELSEş   MESSAGE='Unable to open ':MD.TYPE:' for validation purposes'ş   GOTO MESSAGE.DISPLAYş ENDşVALID.ACCOUNT=1şIF ACCOUNT <> '' THENş**   EXECUTE "SET-FILE ":ACCOUNT:" ":MD.TYPE:' QFILE' CAPTURING DUMMYş   ERR.MSG=''ş   IF PLATFORM <> 'JB' THENş      QFILE.NAME='QFILE'ş      CALL CREATE.QPOINTER(PLATFORM,FI.MD,ACCOUNT,MD.TYPE,QFILE.NAME,FI.ACCOUNT.MD)ş      IF QFILE.NAME = '' THEN ERR.MSG=ACCOUNT:' is not a valid account'ş    END ELSEş      IF INDEX(ACCOUNT,'/',1) THEN PATH.DELIM='/' ELSE PATH.DELIM='\'ş      F.PTR='F':@AM:ACCOUNT:PATH.DELIM:'MD'ş      F.PTR<3>=F.PTR<2>:']D'ş      QFILE.NAME='QFILE'ş      WRITE F.PTR ON FI.MD, QFILE.NAMEş      OPEN '','QFILE' TO TEST.MD ELSE ERR.MSG=ACCOUNT:' is not a valid account path!'ş    ENDş    IF ERR.MSG <> '' THENş      MESSAGE<-1>=ERR.MSGş      VALID.ACCOUNT=0ş    ENDş**   IF PLATFORM = 'UD' THENş**      QFILE.NAME='QFILE'ş**      CALL CREATE.UD.QPOINTER(ACCOUNT,MD.TYPE,QFILE.NAME,FI.ACCOUNT.MD)ş**      IF QFILE.NAME = '' THENş**         MESSAGE<-1>=ACCOUNT:' is not a valid account!'ş**         VALID.ACCOUNT=0ş**       ENDş**    END ELSEş**      WRITE 'Q':@AM:ACCOUNT:@AM:MD.TYPE ON FI.MD, 'QFILE'ş**      VALID.ACCOUNT=1ş**      OPEN '','QFILE' TO FI.ACCOUNT.MD ELSEş**         MESSAGE<-1>=ACCOUNT:' is not a valid account!'ş**         VALID.ACCOUNT=0ş**       ENDş**    ENDş END ELSEş   VALID.ACCOUNT=0ş   MESSAGE<-1>='No Account defined!'ş ENDşIF REPORT.FILE <> '' THENş   IF NOT(VALID.ACCOUNT) THENş      IF PLATFORM = 'JB' THENş         MESSAGE<-1>='Unable to verify ':REPORT.FILE:' file because account path not properly defined!'ş      END ELSEş         MESSAGE<-1>='Unable to verify ':REPORT.FILE:' file because account not properly defined!'ş      ENDş      VALID.REPORT.FILE=0ş    END ELSEş      VALID.REPORT.FILE=1ş      QFILE.NAME='QFILE'ş      IF PLATFORM <> 'JB' THENş         CALL CREATE.QPOINTER(PLATFORM,FI.MD,ACCOUNT,REPORT.FILE,QFILE.NAME,FI.REPORT.FILE)ş         IF QFILE.NAME = '' THENş            MESSAGE<-1>=REPORT.FILE:' is not a valid file in the ':ACCOUNT:' account!'ş            VALID.REPORT.FILE=0ş          ENDş       END ELSEş         F.PTR='F':@AM:ACCOUNT:PATH.DELIM:REPORT.FILEş         F.PTR<3>=F.PTR<2>:']D'ş         QFILE.NAME='QFILE'ş         WRITE F.PTR ON FI.MD, QFILE.NAMEş         OPEN '','QFILE' TO TEST.MD ELSE ş            MESSAGE<-1>=REPORT.FILE:' is not a valid file in the ':ACCOUNT:' path!'ş            VALID.REPORT.FILE=0ş   ş       ENDş    END     ş**      EXECUTE "SET-FILE ":ACCOUNT:" ":REPORT.FILE:' QFILE' CAPTURING DUMMYş**       IF PLATFORM = 'UD' THENş**          QFILE.NAME='QFILE'ş**          CALL CREATE.UD.QPOINTER(ACCOUNT,REPORT.FILE,QFILE.NAME,FI.REPORT.FILE)ş**          IF QFILE.NAME = '' THENş**             MESSAGE<-1>=REPORT.FILE:' is not a valid file in the ':ACCOUNT:' account!'ş**             VALID.REPORT.FILE=0ş**           ENDş**        END ELSEş**         WRITE 'Q':@AM:ACCOUNT:@AM:REPORT.FILE ON FI.MD, 'QFILE'ş**         OPEN '','QFILE' TO FI.REPORT.FILE ELSEş**            MESSAGE<-1>=REPORT.FILE:' is not a valid file in the ':ACCOUNT:' account!'ş**            VALID.REPORT.FILE=0ş**          ENDş**       ENDş      IF VALID.REPORT.FILE THENş         HAVE.QFILE.REC=1ş         READ QFILE.REC FROM FI.MD, 'QFILE' ELSEş            HAVE.QFILE.REC=0ş            MESSAGE<-1>='Unable to create QFILE pointer to ':ACCOUNT:' ':REPORT.FILEş          ENDş         IF HAVE.QFILE.REC THENş            WRITE QFILE.REC ON FI.MD, 'DASHBOARD.SALES.FILE'ş            OPEN 'DICT','DASHBOARD.SALES.FILE' TO FI.DICT.REPORT.FILE ELSE ş               MESSAGE<-1>='Unable to open DICT ':REPORT.FILEş             ENDş          ENDş       ENDş    ENDş END ELSEş   MESSAGE<-1>='No Sales Report file defined!'ş ENDşIF SALE.DATE.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Date Of Sale Dictionary Defined!'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":SALE.DATE.DICT:' Because No Sales File!'ş    END ELSEş      READ SALE.DATE.DICT.REC FROM FI.DICT.REPORT.FILE, SALE.DATE.DICT ELSEş         SALE.DATE.DICT.REC=''ş         MESSAGE<-1>=SALE.DATE.DICT:' Does Not Exist!'ş       ENDş      IF SALE.DATE.DICT.REC <> '' THENş         VALID.DATE.DICT=1ş         DICT.TYPE=SALE.DATE.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S' ş               IF SALE.DATE.DICT.REC<7>[1,1] <> 'D' AND SALE.DATE.DICT.REC<8>[1,1] <> 'D' THENş                  VALID.DATE.DICT=0ş                ENDş               SALE.DATE.AMC=SALE.DATE.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               IF SALE.DATE.DICT.REC<3>[1,1] <> 'D' THENş                  VALID.DATE.DICT=0ş                ENDş               SALE.DATE.AMC=SALE.DATE.DICT.REC<2>ş            CASE 1ş               VALID.DATE.DICT=0ş               SALE.DATE.AMC=SALE.DATE.DICT.REC<2>ş         END CASEş         IF NOT(VALID.DATE.DICT) THENş            MESSAGE<-1>='Dictionary Item ':SALE.DATE.DICT:' Does Not Appear To Be A Date!'ş          ENDş       ENDş    ENDş ENDşIF SALE.AMOUNT.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Sale Amount Dictionary Defined!'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":SALE.AMOUNT.DICT:' Because No Sales File!'ş    END ELSEş      READ SALE.AMOUNT.DICT.REC FROM FI.DICT.REPORT.FILE, SALE.AMOUNT.DICT ELSEş         SALE.AMOUNT.DICT.REC=''ş         MESSAGE<-1>=SALE.AMOUNT.DICT:' Does Not Exist!'ş       ENDş      IF SALE.AMOUNT.DICT.REC <> '' THENş         VALID.AMOUNT.DICT=1ş         DICT.TYPE=SALE.AMOUNT.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S' ş               DICT.7.1.2=SALE.AMOUNT.DICT.REC<7>[1,2]ş               DICT.8.1.2=SALE.AMOUNT.DICT.REC<8>[1,2]ş               IF DICT.7.1.2 <> 'MD' AND DICT.7.1.2 <> 'MR' AND DICT.8.1.2 <> 'MD' AND DICT.8.1.2 <> 'MR' THENş                  VALID.AMOUNT.DICT=0ş                ENDş               SALE.AMOUNT.AMC=SALE.AMOUNT.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               DICT.3.1.2=SALE.AMOUNT.DICT.REC<3>[1,2]ş               IF DICT.3.1.2 <> 'MR' AND DICT.3.1.2 <> 'MD' THENş                  VALID.AMOUNT.DICT=0ş                ENDş               SALE.AMOUNT.AMC=SALE.AMOUNT.DICT.REC<2>ş            CASE 1ş               VALID.AMOUNT.DICT=0ş               SALE.AMOUNT.AMC=SALE.AMOUNT.DICT.REC<2>ş         END CASEş         IF NOT(VALID.AMOUNT.DICT) THENş            MESSAGE<-1>='Dictionary Item ':SALE.AMOUNT.DICT:' Does Not Appear To Be An Amount!'ş          ENDş       ENDş    ENDşIF COST.OF.SALE.AMOUNT.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Cost of Sale Amount Dictionary Defined - Gross Profit and Margin reporting will not be possible'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":COST.OF.SALE.AMOUNT.DICT:' Because No Sales File!'ş    END ELSEş      READ COST.OF.SALE.AMOUNT.DICT.REC FROM FI.DICT.REPORT.FILE, COST.OF.SALE.AMOUNT.DICT ELSEş         COST.OF.SALE.AMOUNT.DICT.REC=''ş         MESSAGE<-1>=COST.OF.SALE.AMOUNT.DICT:' Does Not Exist!'ş       ENDş      IF COST.OF.SALE.AMOUNT.DICT.REC <> '' THENş         VALID.AMOUNT.DICT=1ş         DICT.TYPE=COST.OF.SALE.AMOUNT.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S' ş               DICT.7.1.2=COST.OF.SALE.AMOUNT.DICT.REC<7>[1,2]ş               DICT.8.1.2=COST.OF.SALE.AMOUNT.DICT.REC<8>[1,2]ş               IF DICT.7.1.2 <> 'MD' AND DICT.7.1.2 <> 'MR' AND DICT.8.1.2 <> 'MD' AND DICT.8.1.2 <> 'MR' THENş                  VALID.AMOUNT.DICT=0ş                ENDş               COST.OF.SALE.AMOUNT.AMC=COST.OF.SALE.AMOUNT.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               DICT.3.1.2=COST.OF.SALE.AMOUNT.DICT.REC<3>[1,2]ş               IF DICT.3.1.2 <> 'MR' AND DICT.3.1.2 <> 'MD' THENş                  VALID.AMOUNT.DICT=0ş                ENDş               COST.OF.SALE.AMOUNT.AMC=COST.OF.SALE.AMOUNT.DICT.REC<2>ş            CASE 1ş               VALID.AMOUNT.DICT=0ş               COST.OF.SALE.AMOUNT.AMC=COST.OF.SALE.AMOUNT.DICT.REC<2>ş         END CASEş         IF NOT(VALID.AMOUNT.DICT) THENş            MESSAGE<-1>='Dictionary Item ':COST.OF.SALE.AMOUNT.DICT:' Does Not Appear To Be An Amount!'ş          ENDş       ENDş    ENDş ENDşIF SALE.MONTH.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Month Of Sale Dictionary Defined!'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":SALE.MONTH.DICT:' Because No Sales File!'ş    END ELSEş      READ SALE.MONTH.DICT.REC FROM FI.DICT.REPORT.FILE, SALE.MONTH.DICT ELSEş         SALE.MONTH.DICT.REC=''ş         MESSAGE<-1>=SALE.MONTH.DICT:' Does Not Exist!'ş       ENDş      IF SALE.MONTH.DICT.REC <> '' THENş         VALID.MONTH.DICT=1ş         DICT.TYPE=SALE.MONTH.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S' ş               IF SALE.MONTH.DICT.REC<7>[1,1] <> 'D' AND SALE.MONTH.DICT.REC<8>[1,1] <> 'D' THENş                  VALID.MONTH.DICT=0ş                ENDş               SALE.MONTH.AMC=SALE.MONTH.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               IF SALE.MONTH.DICT.REC<3>[1,1] <> 'D' THENş                  VALID.MONTH.DICT=0ş                ENDş               SALE.MONTH.AMC=SALE.MONTH.DICT.REC<2>ş            CASE 1ş               VALID.MONTH.DICT=0ş               SALE.MONTH.AMC=SALE.MONTH.DICT.REC<2>ş         END CASEş         IF NOT(VALID.MONTH.DICT) THENş            MESSAGE<-1>='Dictionary Item ':SALE.MONTH.DICT:' Does Not Appear To Be A Date Month!'ş          ENDş       ENDş    ENDş ENDşIF SALE.YEAR.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Year Of Sale Dictionary Defined!'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":SALE.YEAR.DICT:' Because No Sales File!'ş    END ELSEş      READ SALE.YEAR.DICT.REC FROM FI.DICT.REPORT.FILE, SALE.YEAR.DICT ELSEş         SALE.YEAR.DICT.REC=''ş         MESSAGE<-1>=SALE.YEAR.DICT:' Does Not Exist!'ş       ENDş      IF SALE.YEAR.DICT.REC <> '' THENş         VALID.YEAR.DICT=1ş         DICT.TYPE=SALE.YEAR.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S' ş               IF SALE.YEAR.DICT.REC<7>[1,1] <> 'D' AND NOT(INDEX(SALE.YEAR.DICT.REC<8>,'D',1)) THENş                  VALID.YEAR.DICT=0ş                ENDş               SALE.YEAR.AMC=SALE.YEAR.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               ATT2=SALE.YEAR.DICT.REC<2>ş               IF INDEX(ATT2,"'D",1) OR INDEX(ATT2,'"D',1) OR ATT2[1,1] = 'D' THENş                  VALID.YEAR.DICT=1ş                END ELSEş                  VALID.YEAR.DICT=0ş                ENDş            CASE 1ş               VALID.YEAR.DICT=0ş               SALE.YEAR.AMC=SALE.YEAR.DICT.REC<2>ş         END CASEş         IF NOT(VALID.YEAR.DICT) THENş            MESSAGE<-1>='Dictionary Item ':SALE.YEAR.DICT:' Does Not Appear To Be A Date Year!'ş          ENDş       ENDş    ENDş ENDşIF SALESMAN.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Salesman Dictionary Defined!'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":SALESMAN.DICT:' Because No Sales File!'ş    END ELSEş      READ SALESMAN.DICT.REC FROM FI.DICT.REPORT.FILE, SALESMAN.DICT ELSEş         SALESMAN.DICT.REC=''ş         MESSAGE<-1>=SALESMAN.DICT:' Does Not Exist!'ş       ENDş      IF SALESMAN.DICT.REC <> '' THENş         VALID.SALESMAN.DICT=1ş         DICT.TYPE=SALESMAN.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S'ş               IF SALESMAN.DICT.REC<7>[1,1] <> 'T' AND SALESMAN.DICT.REC<8>[1,1] <> 'T' THENş                  VALID.SALESMAN.DICT=0ş                END ELSEş                  IF SALESMAN.DICT.REC<7>[1,1] = 'T' THENş                     SALESMAN.TFILE=SALESMAN.DICT.REC<7>ş                   END ELSEş                     SALESMAN.TFILE=SALESMAN.DICT.REC<8>ş                   ENDş                ENDş               SALESMAN.AMC=SALESMAN.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               IF INDEX(SALESMAN.DICT.REC<3>,'TRANS',1) THENş                  VALID.SALESMAN.DICT=0ş                END ELSEş                  SALESMAN.TFILE=SALESMAN.DICT.REC<3>ş                ENDş               SALE.SALESMAN.AMC=SALESMAN.DICT.REC<2>ş            CASE 1ş               VALID.SALESMAN.DICT=0ş               SALE.SALESMAN.AMC=SALESMAN.DICT.REC<2>ş         END CASEş         IF NOT(VALID.SALESMAN.DICT) THENş            MESSAGE<-1>='Dictionary Item ':SALESMAN.DICT:' May Not Be Correct'ş            MESSAGE:=" Because It Doesn't Translate To Another File For The Full Name"ş          ENDş       ENDş    ENDş ENDşIF BRANCH.DICT <> '' THENş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":BRANCH.DICT:' Because No Sales File!'ş    END ELSEş      READ BRANCH.DICT.REC FROM FI.DICT.REPORT.FILE, BRANCH.DICT ELSEş         BRANCH.DICT.REC=''ş         MESSAGE<-1>=BRANCH.DICT:' Does Not Exist!'ş       ENDş      IF BRANCH.DICT.REC <> '' THENş         VALID.BRANCH.DICT=1ş         DICT.TYPE=BRANCH.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S'ş               IF BRANCH.DICT.REC<7>[1,1] <> 'T' AND BRANCH.DICT.REC<8>[1,1] <> 'T' THENş                  VALID.BRANCH.DICT=0ş                END ELSEş                  IF BRANCH.DICT.REC<7>[1,1] = 'T' THENş                     BRANCH.TFILE=BRANCH.DICT.REC<7>ş                   END ELSEş                     BRANCH.TFILE=BRANCH.DICT.REC<8>ş                   ENDş                ENDş               BRANCH.AMC=BRANCH.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               IF INDEX(BRANCH.DICT.REC<3>,'TRANS',1) THENş                  VALID.BRANCH.DICT=0ş                END ELSEş                  BRANCH.TFILE=BRANCH.DICT.REC<3>ş                ENDş               SALE.BRANCH.AMC=BRANCH.DICT.REC<2>ş            CASE 1ş               VALID.BRANCH.DICT=0ş               SALE.BRANCH.AMC=BRANCH.DICT.REC<2>ş         END CASEş         IF NOT(VALID.BRANCH.DICT) THENş            MESSAGE<-1>='Dictionary Item ':BRANCH.DICT:' May Not Be Correct'ş            MESSAGE:=" Because It Doesn't Translate To Another File For The Full Name"ş          ENDş       ENDş    ENDş ENDşIF REGION.DICT <> '' THENş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":REGION.DICT:' Because No Sales File!'ş    END ELSEş      READ REGION.DICT.REC FROM FI.DICT.REPORT.FILE, REGION.DICT ELSEş         REGION.DICT.REC=''ş         MESSAGE<-1>=REGION.DICT:' Does Not Exist!'ş       ENDş      IF REGION.DICT.REC <> '' THENş         VALID.REGION.DICT=1ş         DICT.TYPE=REGION.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S'ş               IF REGION.DICT.REC<7>[1,1] <> 'T' AND REGION.DICT.REC<8>[1,1] <> 'T' THENş                  VALID.REGION.DICT=0ş                END ELSEş                  IF REGION.DICT.REC<7>[1,1] = 'T' THENş                     REGION.TFILE=REGION.DICT.REC<7>ş                   END ELSEş                     REGION.TFILE=REGION.DICT.REC<8>ş                   ENDş                ENDş               REGION.AMC=REGION.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               IF INDEX(REGION.DICT.REC<3>,'TRANS',1) THENş                  VALID.REGION.DICT=0ş                END ELSEş                  REGION.TFILE=REGION.DICT.REC<3>ş                ENDş               SALE.REGION.AMC=REGION.DICT.REC<2>ş            CASE 1ş               VALID.REGION.DICT=0ş               SALE.REGION.AMC=REGION.DICT.REC<2>ş         END CASEş         IF NOT(VALID.REGION.DICT) THENş            MESSAGE<-1>='Dictionary Item ':REGION.DICT:' May Not Be Correct'ş            MESSAGE:=" Because It Doesn't Translate To Another File For The Full Name"ş          ENDş       ENDş    ENDş ENDşCREATE.INDEXES=1şIF MESSAGE = '' THENş   MESSAGE='Sales Report parameters properly defined!'ş END ELSEş   IF INDEX(MESSAGE,'!',1) THENş      MESSAGE=INSERT(MESSAGE,1,0,0,'!!! ERRORS !!!')ş      CREATE.INDEXES=0ş    ENDş ENDşIF CREATE.INDEXES THENş   * CREATE PIPE DICTIONARY ITEMş   IF PLATFORM = 'D3' OR PLATFORM = 'QM' OR PLATFORM = 'JB' THENş      PIPE='A'ş      PIPE<2>=0ş      PIPE<3>=' 'ş      PIPE<8>='F;C|'ş      PIPE<9>='L'ş      PIPE<10>=1ş    END ELSEş      PIPE='I'ş      PIPE<2>='"|"'ş      PIPE<4>='|'ş      PIPE<5>='1L'ş      PIPE<6>='S'ş    ENDş   WRITE PIPE ON FI.DICT.REPORT.FILE, 'PIPE'ş   *ş   ** INDEX LOGICş   *ş   BEGIN CASEş      CASE PLATFORM = 'D3'ş         INDEX.TEST='A':SALE.DATE.AMC:'(DY):':SALE.DATE.AMC:'(DM)'ş         READ FILE.DEF.REC FROM FI.DICT.REPORT.FILE, REPORT.FILE ELSE FILE.DEF.REC=''ş         IF FILE.DEF.REC <> '' AND NOT(INDEX(FILE.DEF.REC<8>,INDEX.TEST,1)) THENş            MESSAGE<-1>='Creating Indexes'ş            CMND1="CREATE-INDEX DASHBOARD.SALES.FILE A":SALE.DATE.AMCş            EXECUTE CMND1 CAPTURING RESULT1ş            CMND2="CREATE-INDEX DASHBOARD.SALES.FILE ":INDEX.TESTş            EXECUTE CMND2 CAPTURING RESULT2ş          ENDş      CASE 1ş         EXECUTE "CREATE-INDEX DASHBOARD.SALES.FILE ":SALE.DATE.DICT CAPTURING RESULT1ş   END CASEş ENDşGOSUB MESSAGE.DISPLAYşRETURNş*şMESSAGE.DISPLAY:ş*şMAX.MSG=DCOUNT(MESSAGE,CHAR(254))şW$HTML.DATA='<h3>':MESSAGE<1>şIF MAX.MSG > 1 THENş   FOR MSG.NO = 2 TO MAX.MSGş      W$HTML.DATA:='<br>':MESSAGE<MSG.NO>ş    NEXT MSG.NOş ENDşW$HTML.DATA:='</h3>'şRETURNşEND00099ASUB.SC.LIB.COLş0c2    SUBROUTINE SUB.SC.LIB.COLş* Changed by PORTBAS -> SUBROUTINE SUB.SC.LIB.PIEş* @(#) SUB.SC.LIB.COL Ported to jBASE 17:55:32  08 JUL 2015ş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Pie Demoş*ş*#MAKE# RL $OPTIONS D3ş    INCLUDE WBPD MVDB.INCLUDEş*ş    W$TITLE = "Source Code: Lines by Program"ş    W$TYPE = "FCBAR2D"ş    W$WIDTH = 2ş*ş    IF G$QUERYMODE THEN RETURNş*ş    IF WIDGET.USER.DATA(1) = "" THEN WIDGET.USER.DATA(1) = "1"ş    IF WIDGET.USER.DATA(2) = "" THEN WIDGET.USER.DATA(2) = "1"ş    N = WIDGET.USER.DATA(1)ş*ş    IF WIDGET.USER.DATA(2) = "1" THENş        CNT.TYPE = "LINES"ş    END ELSEş        CNT.TYPE = "BYTES"ş    ENDş*ş    W$BAR.LABELS<1> = "Lines by Program"ş*ş    DIM LIB.FILES(3), LIBS(3)ş*ş    LIBS(1) = "RSS.BP"ş    LIBS(2) = "WBPD"ş    LIBS(3) = "MVDB.SUBS"ş*ş    W$TITLE := " (":LIBS(N):")"ş*ş    TOT.LINES = 0 ; TOT.PROGS = 0ş    OPEN LIBS(N) TO LIB.FILES(N) ELSE STOP 201, LIBS(N)ş    SELECT LIB.FILES(N)ş    LOOPş        READNEXT ID ELSE EXITş        READ REC FROM LIB.FILES(N), ID ELSE REC = ""ş        IF CNT.TYPE = "LINES" THENş            LINES = DCOUNT(REC, @AM)ş        END ELSEş            LINES = LEN(REC)ş        ENDş        W$BAR.XLABELS<1,-1> = IDş        W$BAR.VALUES<1,-1> = LINESş        TOT.PROGS += 1ş        TOT.LINES += LINESş    REPEATş*ş    IF TOT.PROGS > 0 THENş        AVG = INT( TOT.LINES / TOT.PROGS )ş    END ELSE AVG = 0ş*ş    W$BAR.XMEMO = "Programs"ş    IF CNT.TYPE = "LINES" THENş        W$BAR.YMEMO = "Lines of Code"ş    END ELSEş        W$BAR.YMEMO = "Bytes of Code"ş    ENDş    W$BAR.TREND.BEG = AVGş    W$BAR.TREND.OPTS = "color='20FF20' thickness='3' showOnTop='1'"ş*ş    W$CHART.HEIGHT = 200 + 8 * TOT.PROGSş    W$CHART.OPTIONS<-1> = 'numDivLines="3"'ş*ş    W$BAR.CAPTION = "In Program File ":LIBS(N)ş*ş    W$INPUT.PROMPT<1> = "Program File"ş    W$INPUT.TYPE<1> = "SELECT"ş    W$INPUT.SELOPTS<1> = "RSS Feeds (RSS.BP)":@VM:"Includes (WBPD)":@VM:"Widget Subs (MVDB.SUBS)"ş    W$INPUT.SELVALS<1> = "1":@VM:"2":@VM:"3"ş    W$INPUT.DEFAULT<1> = WIDGET.USER.DATA(1)ş    W$INPUT.UDPOS<1> = 1      ;* WIDGET.USER.DATA(1)ş*ş    W$INPUT.PROMPT<2> = "Count"ş    W$INPUT.TYPE<2> = "SELECT"ş    W$INPUT.SELOPTS<2> = "Lines of code":@VM:"Bytes of code"ş    W$INPUT.SELVALS<2> = "1":@VM:"2"ş    W$INPUT.DEFAULT<2> = WIDGET.USER.DATA(2)ş    W$INPUT.UDPOS<2> = 2      ;* WIDGET.USER.DATA(2)ş    W$INPUT.BUTTON = "Go"ş*ş    INCLUDE WBPD SOURCE.VIEW.ICONş*ş    RETURN000708SUB.DEMO.SS.COLş0c2SUBROUTINE SUB.DEMO.SS.COLş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Single Series Column Chart Demonstrationş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Demo - Monthly Unit Sales"şW$TYPE = "FCCOLUMN2D"şW$WIDTH = 2ş*şIF G$QUERYMODE THEN RETURNş*şIF WIDGET.USER.DATA(1) = "" THEN WIDGET.USER.DATA(1) = "2D"şBEGIN CASEş  CASE WIDGET.USER.DATA(1) = "2D"ş    W$TYPE = "FCCOLUMN2D"ş  CASE WIDGET.USER.DATA(1) = "3D"ş    W$TYPE = "FCCOLUMN3D"ş  CASE WIDGET.USER.DATA(1) = "BAR"ş    W$TYPE = "FCBAR2D"ş  CASE WIDGET.USER.DATA(1) = "AREA2D"ş    W$TYPE = "FCAREA2D"ş  CASE 1ş    W$TYPE = WIDGET.USER.DATA(1)şEND CASEş*şW$BAR.CAPTION = "Revenue by Branch for Period 2008-08"şW$BAR.XMEMO = "Branch"şW$BAR.YMEMO = "Sales Revenue"ş*şUNITS = ""şUNITS<1> = "15177"şUNITS<2> = "11700"şUNITS<3> = "12833"şUNITS<4> = "13529"şUNITS<5> = "21953"şUNITS<6> = "35792"şUNITS<7> = "35202"şUNITS<8> = "28206"şUNITS<9> = "23168"şUNITS<10> = "42657"şUNITS<11> = "35595"şUNITS<12> = "28328"şUNITS<13> = "297674"şUNITS<14> = "26111"şUNITS<15> = "243295"şUNITS<16> = "323846"şUNITS<17> = "42615"şUNITS<18> = "-29"şUNITS<19> = "38787"şUNITS<20> = "71023"şUNITS<21> = "130106"ş*şFOR N = 1 TO 12ş  W$BAR.VALUES<1,N> = UNITS<N>ş*  W$BAR.XLABELS<1,N> = OCONV(ICONV(N:"/1",'D'),'DMA')[1,3]ş  W$BAR.XLABELS<1,N> = Nş  W$FW.DD.WIDGET<1,N> = "Drilldown Demo"ş  W$FW.DD.UD.POS<1,N,1> = 1ş  W$FW.DD.UD.VAL<1,N,1> = UNITS<N>ş  W$FW.DD.UD.POS<1,N,2> = 2ş  W$FW.DD.UD.VAL<1,N,2> = NşNEXT Nş*şW$INPUT.PROMPT = "Chart Style"şW$INPUT.TYPE = "SELECT"şW$INPUT.SELOPTS = "2D Column":@VM:"3D Column":@VM:"Bar Chart":@VM:"2D Area Chart"şW$INPUT.SELVALS = "2D":@VM:"3D":@VM:"BAR":@VM:"AREA2D"şW$INPUT.UDPOS = 1şW$INPUT.DEFAULT = WIDGET.USER.DATA(1)ş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN000B92SUB.DEMO.MAP.USAş0c2SUBROUTINE SUB.DEMO.MAP.USAş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: US Map demonstrationş* 6-1-15 ZUMASYS CHANGE MAP ID DELIMITER FROM * TO #ş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Demo - States by Alphabet"şW$TYPE = "USAMAP"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şOPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSE STOP 201, 'MVDB.CONTROL'şREAD STATE.NAMES FROM F.MVDB.CONTROL, 'STATE.NAMES' ELSE STATE.NAMES = ''şCONVERT "," TO @VM IN STATE.NAMESş*şW$CHART.OPTIONS<-1> = 'animation="0"'şW$CHART.OPTIONS<-1> = 'showShadow="1"'ş* 10-17-16 deprecated * W$CHART.OPTIONS<-1> = 'showBevel="1"'şW$CHART.OPTIONS<-1> = 'legendShadow="1"'şW$CHART.OPTIONS<-1> = 'legendAllowDrag="1"'ş*şIF WIDGET.USER.DATA(1) # "" THENş  * This is a drill-down run on this widget - we are now to display info for a specific stateş  OPEN '','MVDB.MAP.DATA' TO F.MVDB.MAP.DATA ELSE STOP 201, 'MVDB.MAP.DATA'ş  EXECUTE 'SELECT MVDB.MAP.DATA WITH NAME = "':WIDGET.USER.DATA(2):'"' CAPTURING JUNKş  N = 0ş  LOOPş    READNEXT ID ELSE EXITş    READ REC FROM F.MVDB.MAP.DATA, ID THENş      N += 1ş      NAME = REC<2>ş*6-1-15*      W$MAP.IDS<1,N> = FIELD( ID, '*', 2 )ş      W$MAP.IDS<1,N> = FIELD( ID, '#', 2 ); *6-1-15ş      W$MAP.VALUES<1,N> = (SEQ(REC<2>[1,1]) - SEQ('A')) + 1ş      W$MAP.VALUE.TOOLTEXT<1,N> = NAMEş      W$FW.DD.WIDGET<1,N> = "Drilldown Demo"ş      W$FW.DD.UD.POS<1,N,1> = 1ş*6-1-15*      W$FW.DD.UD.VAL<1,N,1> = FIELD(ID,'*',1)ş      W$FW.DD.UD.VAL<1,N,1> = FIELD(ID,'#',1); *6-1-15*ş      W$FW.DD.UD.POS<1,N,2> = 2ş      W$FW.DD.UD.VAL<1,N,2> = IDş      W$FW.DD.UD.POS<1,N,3> = 3ş      W$FW.DD.UD.VAL<1,N,3> = WIDGET.USER.DATA(2)ş      W$FW.DD.UD.POS<1,N,4> = 4ş      W$FW.DD.UD.VAL<1,N,4> = REC<2>ş    ENDş  REPEATş  W$LINK.LABEL<1,1> = "Return to USA Map"ş  W$LINK.LOCATION<1,1> = "C"ş  W$LINK.UD.POS<1,1> = 1ş  W$LINK.UD.VAL<1,1> = ""ş  W$LINK.ICON<1,1> = "arrow_left.png"ş  W$LINK.ICON.TXT<1,1> = "Back to US Map"ş  *ş  W$LINK.LABEL<1,2> = "Return to USA Map"ş  W$LINK.LOCATION<1,2> = "1"ş  W$LINK.UD.POS<1,2> = 1ş  W$LINK.UD.VAL<1,2> = ""ş  *ş  W$TITLE = "Demo - ":WIDGET.USER.DATA(1):" Counties by Alphabet"şEND ELSE ;* National map displayş  STATE.CNT = DCOUNT( STATE.NAMES<1>, @VM )ş  FOR N = 1 TO STATE.CNTş    W$MAP.IDS<1,N> = STATE.NAMES<1,N>ş    W$MAP.VALUES<1,N> = (SEQ(STATE.NAMES<1,N>[1,1]) - SEQ('A')) + 1ş    W$MAP.VALUE.TOOLTEXT<1,N> := STATE.NAMES<2,N>:' (':STATE.NAMES<1,N>:')'ş    W$MAP.VALUE.DD<1,N> = 1 ;* Allow drill-downş  NEXT NşENDş*şW$MAP.RANGE.NAME<1,1> = "Early in Alphabet"şW$MAP.RANGE.LOW<1,1> = "1"şW$MAP.RANGE.HIGH<1,1> = "10"şW$MAP.RANGE.COLOR<1,1> = "GREEN"şW$MAP.RANGE.NAME<1,2> = "Middle of Alphabet"şW$MAP.RANGE.LOW<1,2> = "10"şW$MAP.RANGE.HIGH<1,2> = "18"şW$MAP.RANGE.COLOR<1,2> = "YELLOW"şW$MAP.RANGE.NAME<1,3> = "Late in Alphabet"şW$MAP.RANGE.LOW<1,3> = "18"şW$MAP.RANGE.HIGH<1,3> = "27"şW$MAP.RANGE.COLOR<1,3> = "RED"ş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN000355SUB.EMAILED.REPORTş0c2SUBROUTINE SUB.EMAILED.REPORTş*ş* Dashboard Widgetş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEşEQU REPORT.ID TO WIDGET.USER.DATA(1)şEMAILED.REPORT=''şIF REPORT.ID = '' THENş   EMAILED.REPORT='No report id found'ş END ELSEş   OPEN '','MVDB.EMAILED.HTML' TO F.MVDB.EMAILED.HTML ELSEş      EMAILED.REPORT='No MVDB.EMAILED.HTML file on system'ş    ENDş   IF EMAILED.REPORT = '' THENş      READ EMAILED.REPORT FROM F.MVDB.EMAILED.HTML, REPORT.ID ELSEş         EMAILED.REPORT='No report data found for ':REPORT.IDş       ENDş    ENDş ENDşW$TYPE='TEXT'şW$TITLE='View TEXT report'şIF INDEX(EMAILED.REPORT,'HTML',1) THENş   W$TYPE='HTML'ş   W$TITLE='View HTML report'ş ENDşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)şIF G$QUERYMODE THEN RETURNşW$PRINTABLE=1şW$PDFABLE=1şW$TEXT.DATA=EMAILED.REPORTşRETURNşEND000C87SUB.MAP.VARIABLEş0c2SUBROUTINE SUB.MAP.VARIABLEş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Variable Mapş* 6-1-15 ZUMASYS CHANGE MAP.DATA DELIMITER TO #ş*ş* Modified by Peter Schellenbach of Zumasys 06-08-15:ş*  Changed test of ENUM after EXECUTE to test SYSTEM(11) instead.ş*şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Variable Map"şW$TYPE = "MAP:World"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şIF WIDGET.USER.DATA(1) = "" THEN WIDGET.USER.DATA(1) = "World"ş*şOPEN '','MVDB.MAP.DATA' TO F.MVDB.MAP.DATA ELSE STOP 201, 'MVDB.MAP.DATA'ş*şW$CHART.OPTIONS<-1> = 'animation="0"'şW$CHART.OPTIONS<-1> = 'showShadow="1"'ş* 10-17-16 deprecated * W$CHART.OPTIONS<-1> = 'showBevel="1"'şW$CHART.OPTIONS<-1> = 'legendShadow="1"'şW$CHART.OPTIONS<-1> = 'legendAllowDrag="1"'ş*şLAST.WTYPE = ""şSELOPT.MAX = 0şSELOPTX = 1şEXECUTE \SSELECT MVDB.MAP.DATA BY NAME BY A1\ RETURNING ENUM CAPTURING ETXTş*PJS 06-08-15*IF ENUM[1,3]="404" THENşIF SYSTEM(11) THEN ; *PJS 06-08-15*ş LOOPş  READNEXT ID ELSE ID="\\EOF"ş UNTIL ID="\\EOF" DOş*6-1-15*  WTYPE = FIELD(ID,"*",1)ş  WTYPE = FIELD(ID,"#",1); *6-1-15ş  IF WTYPE # LAST.WTYPE THENş    SELOPT.MAX += 1ş    W$INPUT.SELOPTS<1,SELOPT.MAX> = WTYPEş    IF WTYPE = WIDGET.USER.DATA(1) THEN SELOPTX = SELOPT.MAXş    LAST.WTYPE = WTYPEş  ENDş REPEATşENDş*şIF WIDGET.USER.DATA(2) = "NEXT" AND SELOPTX < SELOPT.MAX THENş SELOPTX += 1ş WIDGET.USER.DATA(1) = W$INPUT.SELOPTS<1,SELOPTX>şENDşIF WIDGET.USER.DATA(2) = "PREV" AND SELOPTX > 1 THENş SELOPTX -= 1ş WIDGET.USER.DATA(1) = W$INPUT.SELOPTS<1,SELOPTX>şENDşWIDGET.USER.DATA(2) = ""ş*şEXECUTE \SSELECT MVDB.MAP.DATA BY NAME BY A1\ RETURNING ENUM CAPTURING ETXTşMAPX = 0ş*PJS 06-08-15*IF ENUM[1,3]="404" THENşIF SYSTEM(11) THEN ; *PJS 06-08-15*ş LOOPş  READNEXT ID ELSE ID="\\EOF"ş UNTIL ID="\\EOF" DOş*6-1-15*  WTYPE = FIELD(ID,"*",1)ş  WTYPE = FIELD(ID,"#",1); *6-1-15*ş  IF WTYPE # LAST.WTYPE THENş    W$INPUT.SELOPTS<1,-1> = WTYPEş    LAST.WTYPE = WTYPEş  ENDş  IF WTYPE = WIDGET.USER.DATA(1) THENş    READ I FROM F.MVDB.MAP.DATA,ID THENş      MAPX += 1ş*6-1-15*      W$MAP.IDS<1,MAPX> = FIELD(ID,'*',2)ş      W$MAP.IDS<1,MAPX> = FIELD(ID,'#',2); *6-1-15ş      W$MAP.VALUES<1,MAPX> = (SEQ(I<1>[1,1]) - (SEQ('A')-1))ş      W$MAP.VALUE.TOOLTEXT<1,MAPX> := I<2>:' (':I<1>:')'ş    ENDş  ENDş REPEATşENDş*şW$TYPE = "MAP:":WIDGET.USER.DATA(1)şW$MAP.RANGE.NAME<1,1> = "Early in Alphabet"şW$MAP.RANGE.LOW<1,1> = "1"şW$MAP.RANGE.HIGH<1,1> = "10"şW$MAP.RANGE.COLOR<1,1> = "GREEN"şW$MAP.RANGE.NAME<1,2> = "Middle of Alphabet"şW$MAP.RANGE.LOW<1,2> = "10"şW$MAP.RANGE.HIGH<1,2> = "18"şW$MAP.RANGE.COLOR<1,2> = "YELLOW"şW$MAP.RANGE.NAME<1,3> = "Late in Alphabet"şW$MAP.RANGE.LOW<1,3> = "18"şW$MAP.RANGE.HIGH<1,3> = "27"şW$MAP.RANGE.COLOR<1,3> = "RED"ş*şW$INPUT.PROMPT = "Map Of"şW$INPUT.TYPE = "SELECT"şW$INPUT.SELVALS = W$INPUT.SELOPTSşW$INPUT.UDPOS = 1şW$INPUT.DEFAULT = WIDGET.USER.DATA(1)ş*şIF SELOPTX > 1 THENş W$LINK.LABEL<1,-1> = "Prev Map"ş W$LINK.LOCATION<1,-1> = 23ş W$LINK.UD.POS<1,-1> = 2ş W$LINK.UD.VAL<1,-1> = "PREV"şENDş*şIF SELOPTX < SELOPT.MAX THENş W$LINK.LABEL<1,-1> = "Next Map"ş W$LINK.LOCATION<1,-1> = 14ş W$LINK.UD.POS<1,-1> = 2ş W$LINK.UD.VAL<1,-1> = "NEXT"şENDş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN000261UV.EXECUTE.STACKED.CMNDSş0c2SUBROUTINE UV.EXECUTE.STACKED.CMNDS(STACKED.1,STACKED.2,NUM.RETURNED,REPORT)ş*şREPORT=''şNUM.RETURNED=1şIF STACKED.1 <> '' THENş   EXECUTE STACKED.1 RTNLIST STACKED.LIST CAPTURING NUM.RETURNEDş   NUM.RETURNED=TRIM(NUM.RETURNED<2>)ş   NUM.RETURNED=FIELD(NUM.RETURNED,' ',1)ş   IF NOT(NUM.RETURNED) THEN RETURNş   EXECUTE STACKED.2 PASSLIST STACKED.LIST CAPTURING REPORTş END ELSEş   EXECUTE STACKED.2 CAPTURING REPORTş ENDşIF INDEX(REPORT,'0 records',1) THENş   IF DCOUNT(REPORT,@AM) < 5 THENş      NUM.RETURNED=0ş      REPORT=''ş    ENDş ENDşCONVERT '$,' TO '' IN REPORTşRETURNşEND000FCCSUB.DEMO.MS.COLş0c2SUBROUTINE SUB.DEMO.MS.COLş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş* Description: Multi Series Column Chart Demonstrationş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Demo - Monthly Unit Sales"şW$TYPE = "FCMSCOLUMN2D"şW$WIDTH = 2ş*şIF G$QUERYMODE THEN RETURNş*şIF WIDGET.USER.DATA(1) = "" THEN WIDGET.USER.DATA(1) = "2D"şBEGIN CASEş  CASE WIDGET.USER.DATA(1) = "2D"ş    W$TYPE = "FCMSCOLUMN2D"ş  CASE WIDGET.USER.DATA(1) = "3D"ş    W$TYPE = "FCMSCOLUMN3D"ş  CASE WIDGET.USER.DATA(1) = "BAR"ş    W$TYPE = "FCMSBAR2D"ş  CASE WIDGET.USER.DATA(1) = "AREA2D"ş    W$TYPE = "FCMSAREA2D"ş  CASE WIDGET.USER.DATA(1) = "LINE"ş    W$TYPE = "FCMSLINE"ş  CASE WIDGET.USER.DATA(1) = "STACKEDAREA"ş    W$TYPE = "FCSTACKEDAREA2D"ş  CASE WIDGET.USER.DATA(1) = "STACKEDCOLUMN2D"ş    W$TYPE = "FCSTACKEDCOLUMN2D"ş  CASE WIDGET.USER.DATA(1) = "STACKEDCOLUMN3D"ş    W$TYPE = "FCSTACKEDCOLUMN3D"ş  CASE WIDGET.USER.DATA(1) = "STACKEDBAR"ş    W$TYPE = "FCSTACKEDBAR2D"ş  CASE 1ş    W$TYPE = WIDGET.USER.DATA(1):"?"şEND CASEş*şW$BAR.LABELS<1> = "Regular"şW$BAR.LABELS<2> = "Mid-Grade"şW$BAR.LABELS<3> = "Premium"şW$BAR.LABELS<4> = "Ethanol"ş*şW$BAR.CAPTION = "Monthly Sales by Type"şW$BAR.XMEMO = "Month"şW$BAR.YMEMO = "Sales (USD)"ş*şSALES = ""şSALES<1> = "28452536"şSALES<2> = "31208425"şSALES<3> = "30245519"şSALES<4> = "40425111"şSALES<5> = "36515188"şSALES<6> = "39144100"şSALES<7> = "41655215"şSALES<8> = "36615152"şSALES<9> = "43944161"şSALES<10> = "42251594"şSALES<11> = "48833151"şSALES<12> = "50122415"ş*şTOT.SALES = SUM(SALES)ş*şLARGEST = 0şLARGEST.N = 0şFOR N = 1 TO 12ş  W$BAR.VALUES<1,N> = OCONV(SALES<N>*.4,'MD02')ş  W$BAR.VALUES<2,N> = OCONV(SALES<N>*.3,'MD02')ş  W$BAR.VALUES<3,N> = OCONV(SALES<N>*.1,'MD02')ş  W$BAR.VALUES<4,N> = OCONV(SALES<N>*.2,'MD02')ş  W$BAR.XLABELS<1,N> = OCONV(N*30-15,'DMA')[1,3]ş  IF SALES<N> > LARGEST THEN LARGEST = SALES<N> ; LARGEST.N = N şNEXT NşDD.SALES = OCONV(TOT.SALES*.4,'MD02')şDD.SALES<2> = OCONV(TOT.SALES*.3,'MD02') şDD.SALES<3> = OCONV(TOT.SALES*.1,'MD02') şDD.SALES<4> = OCONV(TOT.SALES*.2,'MD02') ş**FOR N = 1 TO 4ş**  W$FW.DD.WIDGET<1,N> = "Drilldown Demo"ş**  W$FW.DD.UD.POS<1,N,1> = 1ş**  W$FW.DD.UD.VAL<1,N,1> = DD.SALES<N>ş**  W$FW.DD.UD.POS<1,N,2> = 2ş**  W$FW.DD.UD.VAL<1,N,2> = W$BAR.LABELS<N> ş**NEXT N şVAL.CNTR = 0şFOR N = 1 TO 12ş**  W$FW.DD.WIDGET<1,N> = "Drilldown Demo"ş**  W$FW.DD.UD.POS<1,N,1> = 1ş**  W$FW.DD.UD.VAL<1,N,1>=W$BAR.XLABELS<1,N>ş  FOR NN = 1 TO 4ş     VAL.CNTR+=1ş     W$FW.DD.WIDGET<1,VAL.CNTR> = "Drilldown Demo"ş     W$FW.DD.UD.POS<1,VAL.CNTR,1>=1ş     W$FW.DD.UD.VAL<1,VAL.CNTR,1>=VAL.CNTRş     W$FW.DD.UD.POS<1,VAL.CNTR,2>=2ş**     W$FW.DD.UD.VAL<1,VAL.CNTR,2> = W$BAR.VALUES<NN,N>ş     W$FW.DD.UD.VAL<1,VAL.CNTR,2> = 'MS.VALUE'ş     W$FW.DD.UD.POS<1,VAL.CNTR,3> = 3ş**     W$FW.DD.UD.VAL<1,VAL.CNTR,3>=W$BAR.XLABELS<1,N>ş     W$FW.DD.UD.VAL<1,VAL.CNTR,3>='MS.LABEL'ş     W$FW.DD.UD.POS<1,VAL.CNTR,4> = 4ş     W$FW.DD.UD.VAL<1,VAL.CNTR,4>=W$BAR.LABELS<NN>ş   NEXT NNş**  W$FW.DD.UD.POS<1,N,2> = 2ş**  W$FW.DD.UD.VAL<1,N,2> = W$BAR.LABELS<N>şNEXT NşMAX.VALUE = OCONV((LARGEST * .4)*1.1,'MD02') şW$CHART.OPTIONS<-1> = "yAxisMaxValue='":MAX.VALUE:"'"ş*şW$BAR.LABEL.OPTS<1> = "showValues='0'"şW$BAR.LABEL.OPTS<2> = "showValues='0'"şW$BAR.LABEL.OPTS<3> = "showValues='0'"şW$BAR.LABEL.OPTS<4> = "showValues='0'"ş*şIF W$TYPE = "FCMSAREA2D" THENş  W$BAR.LABEL.OPTS<1> := " areaAlpha='50'"ş  W$BAR.LABEL.OPTS<2> := " areaAlpha='70'"ş  W$BAR.LABEL.OPTS<3> := " areaAlpha='90'"ş  W$BAR.LABEL.OPTS<4> := " areaAlpha='40'"şENDş*şW$INPUT.PROMPT = "Chart Style"şW$INPUT.TYPE = "SELECT"şW$INPUT.SELOPTS = "2D Column":@VM:"3D Column":@VM:"Bar Chart":@VM:"2D Area Chart":@VM:"Line Chart":@VM:"Stacked Area Chart":@VM:"2D Stacked Column Chart":@VM:"3D Stacked Column Chart":@VM:"Stacked Bar Chart"şW$INPUT.SELVALS = "2D":@VM:"3D":@VM:"BAR":@VM:"AREA2D":@VM:"LINE":@VM:"STACKEDAREA":@VM:"STACKEDCOLUMN2D":@VM:"STACKEDCOLUMN3D":@VM:"STACKEDBAR"şW$INPUT.UDPOS = 1şW$INPUT.DEFAULT = WIDGET.USER.DATA(1)ş*şINCLUDE WBPD SOURCE.VIEW.ICONş*şRETURN0011E2SUB.PDF.CONFIGş0c2SUBROUTINE SUB.PDF.CONFIGş*ş* Copyright (c) 2016 Zumasys, Inc. All rights reserved.ş* Description: PDF configuration widget.ş*şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "PDF Configuration"   ;* Title for widget title barşW$TYPE = "HTML"                 ;* Filled in by editorşW$WIDTH = 2                     ;* Full width (1=1/3, 2=2/3, 3=3/3)şW$PDFABLE = 1                   ;* Enable conversion to PDFş*şIF G$QUERYMODE THEN RETURNş*şOPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSEş  W$TEXT.INFO = "Unable to open MVDB.CONTROL"ş  RETURNşENDşW$TEXT.INFO = "" ;* No widget content at this point.ş*şIF SYSTEM(91) THEN isWindows = 1 ELSE isWindows = 0 ;*QM, UV, UDşIF isWindows THEN DIRSEP = '\' ELSE DIRSEP = '/'ş*şREAD SETTINGS.REC FROM F.MVDB.CONTROL, 'PDF.SETTINGS' ELSE SETTINGS.REC = ""şIF G$SUBMITTED = 1 THENş  * Save PDF settingsş  FOR N = 1 TO 4ş    SETTINGS.REC<N> = WIDGET.USER.DATA(N)ş  NEXT Nş  OK = 0ş  IF SETTINGS.REC<1> THENş    * Validate NATIVE.CONTENT fileş    OPEN 'NATIVE.CONTENT' TO F.NATIVE.CONTENT ELSEş      * Create a type19 file to store PDF files (type1 splits up long IDs)ş      * The CREATE-FILE syntax here is for a PICK type account!ş      EXECUTE 'CREATE-FILE NATIVE.CONTENT 1,1,3 1,1,19' CAPTURING OUTPUT ;*UV*ş    ENDş    OPEN 'NATIVE.CONTENT' TO F.NATIVE.CONTENT THENş      * Verify that directory returned by browser matches directory referenced by NATIVE.CONTENT fileş      NATIVE.DIR = FILEINFO(F.NATIVE.CONTENT,2)ş      IF isWindows THEN CONVERT '/' TO '\' IN NATIVE.DIR ;*UV may have wrong separator!ş      IF NATIVE.DIR[LEN(NATIVE.DIR),1] = DIRSEP THEN NATIVE.DIR = NATIVE.DIR[1,LEN(NATIVE.DIR)-1]ş      IF isWindows THENş        OK = (OCONV(NATIVE.DIR,'MCU') = OCONV(SETTINGS.REC<3>,'MCU'))ş      END ELSEş        OK = (NATIVE.DIR = SETTINGS.REC<3>)ş      ENDş      IF NOT(OK) THENş        W$HTML.DATA = "MV file 'NATIVE.CONTENT' does not refer to PDF directory ":SETTINGS.REC<3>:"!"ş      ENDş    ENDş  END ELSEş    OK = 1ş  ENDş  IF OK THENş    WRITE SETTINGS.REC ON F.MVDB.CONTROL, 'PDF.SETTINGS'ş    W$HTML.DATA = "Settings saved."ş  END ELSEş    IF W$HTML.DATA = "" THEN W$HTML.DATA = "Unable to open PDF directory!"ş  ENDşEND ELSEş  * Initialize default settingsş  IF SETTINGS.REC<1> = "" THENş    SETTINGS.REC<1> = 0 ;* PDF generation is disabledş  ENDş  IF SETTINGS.REC<2> = "" THENş    IF isWindows THENş      * Windowsş      EXEPATH = 'C:\Program Files (x86)\wkhtmltopdf\bin\wkhtmltopdf.exe'ş      SETTINGS.REC<2> = '"':EXEPATH:'" [INPUT_FILE] [OUTPUT_FILE]'ş    END ELSEş      * Linuxş      EXEPATH = '/usr/local/bin/wkhtmltopdf'ş      SETTINGS.REC<2> = EXEPATH:' [INPUT_FILE] [OUTPUT_FILE]'ş    ENDş  ENDş  IF SETTINGS.REC<3> = "" THENş    IF isWindows THENş      * Windowsş      NATIVE.DIR = @PATHş      CONVERT '/' TO '\' IN NATIVE.DIR ;* UV sometimes uses wrong separatorş      SETTINGS.REC<3> = NATIVE.DIR:'\NATIVE.CONTENT'ş    END ELSEş      * Linuxş      NATIVE.DIR = @PATHş      SETTINGS.REC<3> = NATIVE.DIR:'/NATIVE.CONTENT'ş    ENDş  ENDş  IF SETTINGS.REC<4> = "" THENş    SETTINGS.REC<4> = 0 ;* delete generated files immediatelyş  ENDşENDş*şW$INPUT.PROMPT<1> = "Enable PDF generation"şW$INPUT.TYPE<1> = "SELECT"şW$INPUT.SELOPTS<1> = "No":@VM:"Yes"şW$INPUT.SELVALS<1> = "0":@VM:"1"şW$INPUT.UDPOS<1> = 1şW$INPUT.DEFAULT<1> = SETTINGS.REC<1>ş*şW$INPUT.PROMPT<2> = "PDF converter command"şW$INPUT.TYPE<2> = "TEXT"şW$INPUT.UDPOS<2> = 2şTMP = SETTINGS.REC<2>şCALL SWAP(TMP, '"', '&quot;')şW$INPUT.DEFAULT<2> = TMPşW$INPUT.PARAMS<2> = 'size="100"'ş*ş*D3 requires directory to store PDF files; other platforms use DIR type fileşW$INPUT.PROMPT<3> = "Directory for PDF files"şW$INPUT.TYPE<3> = "TEXT"şW$INPUT.UDPOS<3> = 3şW$INPUT.DEFAULT<3> = SETTINGS.REC<3>şW$INPUT.PARAMS<3> = 'size="100"'ş*şW$INPUT.PROMPT<4> = "Delete PDF files after"şW$INPUT.TYPE<4> = "SELECT"şW$INPUT.UDPOS<4> = 4şW$INPUT.SELOPTS<4,1> = "immediately"; W$INPUT.SELVALS<4,1> = 0şW$INPUT.SELOPTS<4,2> = "1 day"; W$INPUT.SELVALS<4,2> = 1şW$INPUT.SELOPTS<4,3> = "2 days"; W$INPUT.SELVALS<4,3> = 2şW$INPUT.SELOPTS<4,4> = "3 days"; W$INPUT.SELVALS<4,4> = 3şW$INPUT.SELOPTS<4,5> = "4 days"; W$INPUT.SELVALS<4,5> = 4şW$INPUT.SELOPTS<4,6> = "5 days"; W$INPUT.SELVALS<4,6> = 5şW$INPUT.SELOPTS<4,7> = "6 days"; W$INPUT.SELVALS<4,7> = 6şW$INPUT.SELOPTS<4,8> = "7 days"; W$INPUT.SELVALS<4,8> = 7şW$INPUT.SELOPTS<4,9> = "14 days"; W$INPUT.SELVALS<4,9> = 14şW$INPUT.SELOPTS<4,10> = "30 days"; W$INPUT.SELVALS<4,10> = 30şW$INPUT.SELOPTS<4,11> = "never"; W$INPUT.SELVALS<4,11> = 999999şW$INPUT.DEFAULT<4> = SETTINGS.REC<4>ş*şW$INPUT.BUTTON = "Save"ş*şRETURN003B92SUB.PORTAL.AR.REPORT.SETUPş0c2SUBROUTINE SUB.PORTAL.AR.REPORT.SETUPş*ş* DEFINE PARAMETERS FOR PORTAL AR REPORTş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEşOPEN '','MVDB.SUBS' TO FI.MVDB.SUBS ELSE STOPş*şW$TITLE = "Portal AR Report Setup"şW$TYPE = "HTML"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şEQUATE ACCOUNT TO WIDGET.USER.DATA(1)şEQUATE REPORT.FILE TO WIDGET.USER.DATA(2)şEQUATE DUE.DATE.DICT TO WIDGET.USER.DATA(3)şEQUATE DATE.PAID.DICT TO WIDGET.USER.DATA(4)şEQUATE INVOICE.AMT.DICT TO WIDGET.USER.DATA(5)şEQUATE BALANCE.DICT TO WIDGET.USER.DATA(6)şEQUATE DUE.DATE.AMC TO WIDGET.USER.DATA(8)şEQUATE DATE.PAID.AMC TO WIDGET.USER.DATA(9)şEQUATE INVOICE.AMT.AMC TO WIDGET.USER.DATA(10)şEQUATE INVOICE.AMT.CONV TO WIDGET.USER.DATA(11)şEQUATE INVOICE.AMT.COOR TO WIDGET.USER.DATA(12)şEQUATE BALANCE.AMC TO WIDGET.USER.DATA(13)şEQUATE BALANCE.CONV TO WIDGET.USER.DATA(14)şEQUATE BALANCE.COOR TO WIDGET.USER.DATA(15)şEQUATE CUSTOMER.DICT TO WIDGET.USER.DATA(16)şEQUATE CUSTOMER.AMC TO WIDGET.USER.DATA(17)şEQUATE CUSTOMER.TFILE TO WIDGET.USER.DATA(18)ş*şOPEN '','MVDB.CONTROL' TO FI.MVDB.CONTROL ELSE STOP 201,'MVDB.CONTROL'şREAD PLATFORM FROM FI.MVDB.CONTROL, 'PLATFORM' ELSEş   MESSAGE='No Platform Type Defined'ş   GOTO MESSAGE.DISPLAYş ENDşFIRST.TIME=0şIF G$SUBMITTED <> '1' THENş   MATREAD WIDGET.USER.DATA FROM FI.MVDB.CONTROL, 'PORTAL.AR.REPORT.SETUP' ELSEş      MAT WIDGET.USER.DATA = ''ş      FIRST.TIME=1ş    ENDş   IF NOT(FIRST.TIME) THENş      GOSUB VALIDATE.PREVIOUS.INPUTSş    ENDş END ELSEş   GOSUB VALIDATE.PREVIOUS.INPUTSş   MATWRITE WIDGET.USER.DATA ON FI.MVDB.CONTROL, 'PORTAL.AR.REPORT.SETUP'ş ENDşGOSUB SET.PROMPTSşRETURNş*şSET.PROMPTS:ş*şW$INPUT.PROMPT<1> = "AR File Account"şW$INPUT.TYPE<1> = "TEXT"şW$INPUT.UDPOS<1> = 1şW$INPUT.DEFAULT<1> = ACCOUNTş*şW$INPUT.PROMPT<2> = "Name Of AR File"şW$INPUT.TYPE<2> = "TEXT"şW$INPUT.UDPOS<2> = 2şW$INPUT.DEFAULT<2> = REPORT.FILEş*şW$INPUT.PROMPT<3> = "Due Date Dict Name"şW$INPUT.TYPE<3> = 'TEXT'şW$INPUT.UDPOS<3> = 3şW$INPUT.DEFAULT<3> = DUE.DATE.DICTş*şW$INPUT.PROMPT<4> = "Date Paid Dict Name"şW$INPUT.TYPE<4> = 'TEXT'şW$INPUT.UDPOS<4> = 4şW$INPUT.DEFAULT<4> = DATE.PAID.DICTş*şW$INPUT.PROMPT<5> = "Invoice Amount Dict Name"şW$INPUT.TYPE<5> = 'TEXT'şW$INPUT.UDPOS<5> = 5şW$INPUT.DEFAULT<5> = INVOICE.AMT.DICTş*şW$INPUT.PROMPT<6> = "Remaining Balance Dict Name"şW$INPUT.TYPE<6> = 'TEXT'şW$INPUT.UDPOS<6> = 6şW$INPUT.DEFAULT<6> = BALANCE.DICTş*şW$INPUT.PROMPT<7> = "Customer Dict Name"şW$INPUT.TYPE<7> = 'TEXT'şW$INPUT.UDPOS<7> = 16şW$INPUT.DEFAULT<7> = CUSTOMER.DICTş*şRETURNş*şVALIDATE.PREVIOUS.INPUTS:ş*şMESSAGE=''şBEGIN CASEş   CASE PLATFORM = 'D3'ş      MD.TYPE='MD'ş   CASE PLATFORM = 'JB'ş      MD.TYPE='MD'ş   CASE 1ş      MD.TYPE='VOC'şEND CASEşOPEN '',MD.TYPE TO FI.MD ELSEş   MESSAGE='Unable to open ':MD.TYPE:' for validation purposes'ş   GOTO MESSAGE.DISPLAYş ENDşVALID.ACCOUNT=1şIF ACCOUNT <> '' THENş**   EXECUTE "SET-FILE ":ACCOUNT:" ":MD.TYPE:' QFILE' CAPTURING DUMMYş   ERR.MSG=''ş   IF PLATFORM <> 'JB' THENş      QFILE.NAME='QFILE'ş      CALL CREATE.QPOINTER(PLATFORM,FI.MD,ACCOUNT,MD.TYPE,QFILE.NAME,FI.ACCOUNT.MD)ş      IF QFILE.NAME = '' THEN ERR.MSG=ACCOUNT:' is not a valid account'ş    END ELSEş      IF INDEX(ACCOUNT,'/',1) THEN PATH.DELIM='/' ELSE PATH.DELIM='\'ş      F.PTR='F':@AM:ACCOUNT:PATH.DELIM:'MD'ş      F.PTR<3>=F.PTR<2>:']D'ş      QFILE.NAME='QFILE'ş      WRITE F.PTR ON FI.MD, QFILE.NAMEş      OPEN '','QFILE' TO TEST.MD ELSE ERR.MSG=ACCOUNT:' is not a valid account path!'ş    ENDş    IF ERR.MSG <> '' THENş      MESSAGE<-1>=ERR.MSGş      VALID.ACCOUNT=0ş    ENDş**   IF PLATFORM = 'UD' THENş**      QFILE.NAME='QFILE'ş**      CALL CREATE.UD.QPOINTER(ACCOUNT,MD.TYPE,QFILE.NAME,FI.ACCOUNT.MD)ş**      IF QFILE.NAME = '' THENş**         MESSAGE<-1>=ACCOUNT:' is not a valid account!'ş**         VALID.ACCOUNT=0ş**       ENDş**    END ELSEş**      WRITE 'Q':@AM:ACCOUNT:@AM:MD.TYPE ON FI.MD, 'QFILE'ş**      VALID.ACCOUNT=1ş**      OPEN '','QFILE' TO FI.ACCOUNT.MD ELSEş**         MESSAGE<-1>=ACCOUNT:' is not a valid account!'ş**         VALID.ACCOUNT=0ş**       ENDş**    ENDş END ELSEş   VALID.ACCOUNT=0ş   MESSAGE<-1>='No Account defined!'ş ENDşIF REPORT.FILE <> '' THENş   IF NOT(VALID.ACCOUNT) THENş      IF PLATFORM = 'JB' THENş         MESSAGE<-1>='Unable to verify ':REPORT.FILE:' file because account path not properly defined!'ş      END ELSEş         MESSAGE<-1>='Unable to verify ':REPORT.FILE:' file because account not properly defined!'ş      ENDş      VALID.REPORT.FILE=0ş    END ELSEş      VALID.REPORT.FILE=1ş      QFILE.NAME='QFILE'ş      IF PLATFORM <> 'JB' THENş         CALL CREATE.QPOINTER(PLATFORM,FI.MD,ACCOUNT,REPORT.FILE,QFILE.NAME,FI.REPORT.FILE)ş         IF QFILE.NAME = '' THENş            MESSAGE<-1>=REPORT.FILE:' is not a valid file in the ':ACCOUNT:' account!'ş            VALID.REPORT.FILE=0ş          ENDş       END ELSEş         F.PTR='F':@AM:ACCOUNT:PATH.DELIM:REPORT.FILEş         F.PTR<3>=F.PTR<2>:']D'ş         QFILE.NAME='QFILE'ş         WRITE F.PTR ON FI.MD, QFILE.NAMEş         OPEN '','QFILE' TO TEST.MD ELSE ş            MESSAGE<-1>=REPORT.FILE:' is not a valid file in the ':ACCOUNT:' path!'ş            VALID.REPORT.FILE=0ş   ş       ENDş    END     ş**      EXECUTE "SET-FILE ":ACCOUNT:" ":REPORT.FILE:' QFILE' CAPTURING DUMMYş**       IF PLATFORM = 'UD' THENş**          QFILE.NAME='QFILE'ş**          CALL CREATE.UD.QPOINTER(ACCOUNT,REPORT.FILE,QFILE.NAME,FI.REPORT.FILE)ş**          IF QFILE.NAME = '' THENş**             MESSAGE<-1>=REPORT.FILE:' is not a valid file in the ':ACCOUNT:' account!'ş**             VALID.REPORT.FILE=0ş**           ENDş**        END ELSEş**         WRITE 'Q':@AM:ACCOUNT:@AM:REPORT.FILE ON FI.MD, 'QFILE'ş**         OPEN '','QFILE' TO FI.REPORT.FILE ELSEş**            MESSAGE<-1>=REPORT.FILE:' is not a valid file in the ':ACCOUNT:' account!'ş**            VALID.REPORT.FILE=0ş**          ENDş**       ENDş      IF VALID.REPORT.FILE THENş         HAVE.QFILE.REC=1ş         READ QFILE.REC FROM FI.MD, 'QFILE' ELSEş            HAVE.QFILE.REC=0ş            MESSAGE<-1>='Unable to create QFILE pointer to ':ACCOUNT:' ':REPORT.FILEş          ENDş         IF HAVE.QFILE.REC THENş            WRITE QFILE.REC ON FI.MD, 'DASHBOARD.AR.FILE'ş            OPEN 'DICT','DASHBOARD.AR.FILE' TO FI.DICT.REPORT.FILE ELSE ş               MESSAGE<-1>='Unable to open DICT ':REPORT.FILEş             ENDş          ENDş       ENDş    ENDş END ELSEş   MESSAGE<-1>='No AR Report file defined!'ş ENDşIF DUE.DATE.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Due Date Dictionary Defined!'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":DUE.DATE.DICT:' Because No AR File!'ş    END ELSEş      READ DUE.DATE.DICT.REC FROM FI.DICT.REPORT.FILE, DUE.DATE.DICT ELSEş         DUE.DATE.DICT.REC=''ş         MESSAGE<-1>=DUE.DATE.DICT:' Does Not Exist!'ş       ENDş      IF DUE.DATE.DICT.REC <> '' THENş         VALID.DATE.DICT=1ş         DICT.TYPE=DUE.DATE.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S' ş               IF DUE.DATE.DICT.REC<7>[1,1] <> 'D' AND DUE.DATE.DICT.REC<8>[1,1] <> 'D' THENş                  VALID.DATE.DICT=0ş                ENDş               DUE.DATE.AMC=DUE.DATE.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               IF DUE.DATE.DICT.REC<3>[1,1] <> 'D' THENş                  VALID.DATE.DICT=0ş                ENDş               DUE.DATE.AMC=DUE.DATE.DICT.REC<2>ş            CASE 1ş               VALID.DATE.DICT=0ş               DUE.DATE.AMC=DUE.DATE.DICT.REC<2>ş         END CASEş         IF NOT(VALID.DATE.DICT) THENş            MESSAGE<-1>='Dictionary Item ':DUE.DATE.DICT:' Does Not Appear To Be A Date!'ş          ENDş       ENDş    ENDş ENDşIF DATE.PAID.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Date Paid Dictionary Defined!'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":DATE.PAID.DICT:' Because No AR File!'ş    END ELSEş      READ DATE.PAID.DICT.REC FROM FI.DICT.REPORT.FILE, DATE.PAID.DICT ELSEş         DATE.PAID.DICT.REC=''ş         MESSAGE<-1>=DATE.PAID.DICT:' Does Not Exist!'ş       ENDş      IF DATE.PAID.DICT.REC <> '' THENş         VALID.DATE.DICT=1ş         DICT.TYPE=DATE.PAID.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S' ş               IF DATE.PAID.DICT.REC<7>[1,1] <> 'D' AND DATE.PAID.DICT.REC<8>[1,1] <> 'D' THENş                  VALID.DATE.DICT=0ş                ENDş               DATE.PAID.AMC=DATE.PAID.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               IF DATE.PAID.DICT.REC<3>[1,1] <> 'D' THENş                  VALID.DATE.DICT=0ş                ENDş               DATE.PAID.AMC=DATE.PAID.DICT.REC<2>ş            CASE 1ş               VALID.DATE.DICT=0ş               DATE.PAID.AMC=DATE.PAID.DICT.REC<2>ş         END CASEş         IF NOT(VALID.DATE.DICT) THENş            MESSAGE<-1>='Dictionary Item ':DATE.PAID.DICT:' Does Not Appear To Be A Date!'ş          ENDş       ENDş    ENDş ENDşIF INVOICE.AMT.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Invoice Amount Dictionary Defined!'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":INVOICE.AMT.DICT:' Because No AR File!'ş    END ELSEş      READ INVOICE.AMT.DICT.REC FROM FI.DICT.REPORT.FILE, INVOICE.AMT.DICT ELSEş         INVOICE.AMT.DICT.REC=''ş         MESSAGE<-1>=INVOICE.AMT.DICT:' Does Not Exist!'ş       ENDş      IF INVOICE.AMT.DICT.REC <> '' THENş         VALID.AMOUNT.DICT=1ş         DICT.TYPE=INVOICE.AMT.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S' ş               DICT.7.1.2=INVOICE.AMT.DICT.REC<7>[1,2]ş               DICT.8.1.2=INVOICE.AMT.DICT.REC<8>[1,2]ş               IF DICT.7.1.2 <> 'MD' AND DICT.7.1.2 <> 'MR' AND DICT.8.1.2 <> 'MD' AND DICT.8.1.2 <> 'MR' THENş                  VALID.AMOUNT.DICT=0ş                ENDş               INVOICE.AMT.AMC=INVOICE.AMT.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               DICT.3.1.2=INVOICE.AMT.DICT.REC<3>[1,2]ş               IF DICT.3.1.2 <> 'MR' AND DICT.3.1.2 <> 'MD' THENş                  VALID.AMOUNT.DICT=0ş                ENDş               INVOICE.AMT.AMC=INVOICE.AMT.DICT.REC<2>ş            CASE 1ş               VALID.AMOUNT.DICT=0ş               INVOICE.AMT.AMC=INVOICE.AMT.DICT.REC<2>ş         END CASEş         IF NOT(VALID.AMOUNT.DICT) THENş            MESSAGE<-1>='Dictionary Item ':INVOICE.AMT.DICT:' Does Not Appear To Be An Amount!'ş          ENDş       ENDş    ENDş ENDşIF BALANCE.DICT = '' THENş   IF VALID.REPORT.FILE THENş      MESSAGE<-1>='No Balance Dictionary Defined!'ş    ENDş END ELSEş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":BALANCE.DICT:' Because No AR File!'ş    END ELSEş      READ BALANCE.DICT.REC FROM FI.DICT.REPORT.FILE, BALANCE.DICT ELSEş         BALANCE.DICT.REC=''ş         MESSAGE<-1>=BALANCE.DICT:' Does Not Exist!'ş       ENDş      IF BALANCE.DICT.REC <> '' THENş         VALID.AMOUNT.DICT=1ş         DICT.TYPE=BALANCE.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S' ş               DICT.7.1.2=BALANCE.DICT.REC<7>[1,2]ş               DICT.8.1.2=BALANCE.DICT.REC<8>[1,2]ş               IF DICT.7.1.2 <> 'MD' AND DICT.7.1.2 <> 'MR' AND DICT.8.1.2 <> 'MD' AND DICT.8.1.2 <> 'MR' THENş                  VALID.AMOUNT.DICT=0ş                ENDş               BALANCE.AMC=BALANCE.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               DICT.3.1.2=BALANCE.DICT.REC<3>[1,2]ş               IF DICT.3.1.2 <> 'MR' AND DICT.3.1.2 <> 'MD' THENş                  VALID.AMOUNT.DICT=0ş                ENDş               BALANCE.AMC=BALANCE.DICT.REC<2>ş            CASE 1ş               VALID.AMOUNT.DICT=0ş               BALANCE.AMC=BALANCE.DICT.REC<2>ş         END CASEş         IF NOT(VALID.AMOUNT.DICT) THENş            MESSAGE<-1>='Dictionary Item ':BALANCE.DICT:' Does Not Appear To Be An Amount!'ş          ENDş       ENDş    ENDş ENDşIF CUSTOMER.DICT <> '' THENş   IF NOT(VALID.REPORT.FILE) THENş      MESSAGE<-1>="Cant Verify Dict ":CUSTOMER.DICT:' Because No AR File!'ş    END ELSEş      READ CUSTOMER.DICT.REC FROM FI.DICT.REPORT.FILE, CUSTOMER.DICT ELSEş         CUSTOMER.DICT.REC=''ş         MESSAGE<-1>=CUSTOMER.DICT:' Does Not Exist!'ş       ENDş      IF CUSTOMER.DICT.REC <> '' THENş         VALID.CUSTOMER.DICT=1ş         DICT.TYPE=CUSTOMER.DICT.REC<1>ş         BEGIN CASEş            CASE DICT.TYPE = 'A' OR DICT.TYPE = 'S'ş               IF CUSTOMER.DICT.REC<7>[1,1] <> 'T' AND CUSTOMER.DICT.REC<8>[1,1] <> 'T' THENş                  VALID.CUSTOMER.DICT=0ş                END ELSEş                  IF CUSTOMER.DICT.REC<7>[1,1] = 'T' THENş                     CUSTOMER.TFILE=CUSTOMER.DICT.REC<7>ş                   END ELSEş                     CUSTOMER.TFILE=CUSTOMER.DICT.REC<8>ş                   ENDş                ENDş               CUSTOMER.AMC=CUSTOMER.DICT.REC<2>ş            CASE DICT.TYPE = 'D' OR DICT.TYPE = 'I' OR DICT.TYPE = 'C'ş               IF INDEX(CUSTOMER.DICT.REC<3>,'TRANS',1) THENş                  VALID.CUSTOMER.DICT=0ş                END ELSEş                  CUSTOMER.TFILE=CUSTOMER.DICT.REC<3>ş                ENDş            CASE 1ş               VALID.CUSTOMER.DICT=0ş         END CASEş         IF NOT(VALID.CUSTOMER.DICT) THENş            MESSAGE<-1>='Dictionary Item ':CUSTOMER.DICT:' May Not Be Correct'ş            MESSAGE:=" Because It Doesn't Translate To Another File For The Full Name"ş          ENDş       ENDş    ENDş ENDşCREATE.INDEXES=1şIF MESSAGE = '' THENş   MESSAGE='AR Report parameters properly defined!'ş END ELSEş   IF INDEX(MESSAGE,'!',1) THENş      MESSAGE=INSERT(MESSAGE,1,0,0,'!!! ERRORS !!!')ş      CREATE.INDEXES=0ş    ENDş ENDşIF CREATE.INDEXES THENş   * CREATE PIPE DICTIONARY ITEMş   IF PLATFORM = 'D3' OR PLATFORM = 'QM' OR PLATFORM = 'JB' THENş      PIPE='A'ş      PIPE<2>=0ş      PIPE<3>=' 'ş      PIPE<8>='F;C|'ş      PIPE<9>='L'ş      PIPE<10>=1ş    END ELSEş      PIPE='I'ş      PIPE<2>='"|"'ş      PIPE<4>='|'ş      PIPE<5>='1L'ş      PIPE<6>='S'ş    ENDş   WRITE PIPE ON FI.DICT.REPORT.FILE, 'PIPE'ş   *ş   ** INDEX LOGICş   *ş   BEGIN CASEş      CASE PLATFORM = 'D3'ş         INDEX.TEST='A':DUE.DATE.AMC:'(DY):':DUE.DATE.AMC:'(DM)'ş         READ FILE.DEF.REC FROM FI.DICT.REPORT.FILE, REPORT.FILE ELSE FILE.DEF.REC=''ş         IF FILE.DEF.REC <> '' AND NOT(INDEX(FILE.DEF.REC<8>,INDEX.TEST,1)) THENş            MESSAGE<-1>='Creating Indexes'ş            CMND1="CREATE-INDEX DASHBOARD.AR.FILE A":DUE.DATE.AMCş            EXECUTE CMND1 CAPTURING RESULT1ş            CMND2="CREATE-INDEX DASHBOARD.AR.FILE ":INDEX.TESTş            EXECUTE CMND2 CAPTURING RESULT2ş          ENDş      CASE 1ş         EXECUTE "CREATE-INDEX DASHBOARD.AR.FILE ":DUE.DATE.DICT CAPTURING RESULT1ş   END CASEş ENDşGOSUB MESSAGE.DISPLAYşRETURNş*şMESSAGE.DISPLAY:ş*şMAX.MSG=DCOUNT(MESSAGE,CHAR(254))şW$HTML.DATA='<h3>':MESSAGE<1>şIF MAX.MSG > 1 THENş   FOR MSG.NO = 2 TO MAX.MSGş      W$HTML.DATA:='<br>':MESSAGE<MSG.NO>ş    NEXT MSG.NOş ENDşW$HTML.DATA:='</h3>'şRETURNşEND0003F4SUB.DEMO.DAYS.TO.PAY.CHARTş0c2SUBROUTINE SUB.DEMO.DAYS.TO.PAY.CHARTş*ş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Average Days To Pay"şW$TYPE = "FCCOLUMN3D"şW$WIDTH = 2şW$PDFABLE = 1ş*şIF G$QUERYMODE THEN RETURNş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEşOPEN '','MVDB.CONTROL' TO FILE.CONTROL ELSE STOPşREAD REC FROM FILE.CONTROL, 'DEMO.FINANCIAL.PICTURE' ELSE REC=''şYEARS=REC<67>şMAX.YEARS=DCOUNT(YEARS,CHAR(253))şFIRST.YEAR=0ş*şW$BAR.XMEMO = "Year (drill down for detail)"şW$BAR.YMEMO = "Average Days to Pay"ş*şN=0ş*şFOR NN = 1 TO MAX.YEARSş  AVERAGE.DAYS=REC<47-NN>ş  YEAR=YEARS<1,NN>ş  IF NOT(FIRST.YEAR) THEN FIRST.YEAR=YEARş  CURRENT.YEAR=YEARş  W$BAR.VALUES<1,NN> = AVERAGE.DAYSş  W$BAR.XLABELS<1,NN> = YEARş  W$FW.DD.WIDGET<1,NN>='DEMO DAYS TO PAY PIE'ş  W$FW.DD.UD.POS<1,NN,1>=1ş  W$FW.DD.UD.VAL<1,NN,1>=YEARşNEXT NNş*şW$BAR.CAPTION = "Average Days to Pay From ":FIRST.YEAR:' to ':CURRENT.YEARş*şRETURN000341PORTAL.SHOW.LAST.UPDATEDş0c2SUBROUTINE PORTAL.SHOW.LAST.UPDATED(CALC.TYPE)şINCLUDE WBPD MVDB.INCLUDEşIF CALC.TYPE = 'SALES' THENş   OPEN 'DICT','DASHBOARD.CLOSING.STATS' TO DICT.FI ELSE RETURNş END ELSEş   OPEN 'DICT','DASHBOARD.BALANCES' TO DICT.FI ELSE RETURNş ENDşREAD LAST.UPDATED FROM DICT.FI, '*LAST.UPDATED.':CALC.TYPE ELSE RETURNşCUR.DATE=DATE()şCUR.TIME=TIME()şCUR.TIME=FIELD(CUR.TIME,'.',1)şCUR.TIME=STR('0',5-LEN(CUR.TIME)):CUR.TIMEşCUR.DATE.TIME=CUR.DATE:CUR.TIMEşDELTA.DATE.TIME=CUR.DATE.TIME-LAST.UPDATEDş*ş* IF LAST 5 MINUTES THEN NO MESSAGE NEEDEDş*şIF DELTA.DATE.TIME < 300 THENş   W$TITLE=W$TITLE:' - Updated in Last 5 Minutes'ş   RETURNş ENDş*şLAST.DATE=LAST.UPDATED[1,5]şLAST.TIME=LAST.UPDATED[6,9]şAPPEND.IT=' - Last Updated ':OCONV(LAST.DATE,'D4-'):' at ':OCONV(LAST.TIME,'MTH')şW$TITLE=W$TITLE:APPEND.ITşRETURN0007C4SUB.DEMO.ANNUAL.SALES.BY.REPş0c2SUBROUTINE SUB.DEMO.ANNUAL.SALES.BY.REPş*ş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "FCCOLUMN3D"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEşOPEN '','MVDB.CONTROL' TO FILE.CONTROL ELSE STOPşREAD REC FROM FILE.CONTROL, 'DEMO.FINANCIAL.PICTURE' ELSE REC=''şREVENUE.OR.GP=WIDGET.USER.DATA(1)şYEAR=WIDGET.USER.DATA(2)şMONTH=WIDGET.USER.DATA(3)şVAL.TYPE='$'şDRILLDOWN.WIDGET=''şDRILLDOWN.TYPE=''şBEGIN CASEş   CASE REVENUE.OR.GP = 'REVENUES'ş      W$TITLE=YEAR:' Sales By Sales Rep'ş      W$BAR.YMEMO = "Sales"ş      SALES.AMTS=REC<48>ş   CASE REVENUE.OR.GP = 'GROSSPROFIT'ş      W$TITLE=YEAR:' Gross Profit By Sales Rep'ş      W$BAR.YMEMO = "Gross Profit"ş      SALES.AMTS=REC<49>şEND CASEş*şREPS=REC<47>şLOCATE YEAR IN REC<67> SETTING YEAR.SVM ELSE YEAR.SVM=1ş*ş*şMAX.SALES.AMT=0şN=0şFIRST.YEAR=''şMAX.REPS=DCOUNT(REPS,CHAR(253))şFOR NN = 1 TO MAX.REPSş   REP=REPS<1,NN>ş   SALES.AMT=SUM(SALES.AMTS<1,NN,YEAR.SVM>)ş   SALES.AMT=OCONV(SALES.AMT,'MD02')ş   IF SALES.AMT > MAX.SALES.AMT THEN MAX.SALES.AMT=SALES.AMTş   W$BAR.VALUES<1,NN> = SALES.AMTş   W$BAR.XLABELS<1,NN> = REPş   W$FW.DD.WIDGET<1,NN> = "DEMO MONTHLY SALES BY REP"ş   W$FW.DD.UD.POS<1,NN,1> = 1ş   W$FW.DD.UD.VAL<1,NN,1> = WIDGET.USER.DATA(1); * REVENUE OR GPş   W$FW.DD.UD.POS<1,NN,2> = 2ş   W$FW.DD.UD.VAL<1,NN,2> = YEARş   W$FW.DD.UD.POS<1,NN,3> = 3ş   W$FW.DD.UD.VAL<1,NN,3> = REPşNEXT NNşW$BAR.XMEMO = "Sales Rep (drilldown for ":W$BAR.YMEMO:" by month)"ş* ROUND MAX AMOUNT UP TO THE NEXT 250000şMAX.SALES.AMT+=250000şMAX.SALES.AMT=INT(MAX.SALES.AMT/250000) * 250000şW$CHART.OPTIONS<-1>='yAxisMaxValue="':MAX.SALES.AMT:'"'şW$CHART.OPTIONS<-1>='decimals="2"'şW$CHART.OPTIONS<-1>='DecimalPrecision="2"'şW$CHART.OPTIONS<-1>='divLineDecimalPrecision="2"'şW$CHART.OPTIONS<-1>='limitsDecimalPrecision="2"'şW$CHART.OPTIONS<-1>='formatNumberScale="1"'şRETURN0004C7SUB.PORTAL.DAYS.TO.PAY.PIEş0c2SUBROUTINE SUB.PORTAL.DAYS.TO.PAY.PIEş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "FC2DPIE"şW$WIDTH = 3şW$TITLE = 'Chart - Days To Pay 'ş*şIF G$QUERYMODE THEN RETURNş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEşYEAR=WIDGET.USER.DATA(1)şOPEN 'DICT','DASHBOARD.BALANCES' TO FI.DICT ELSE RETURNşREAD STATS.REC FROM FI.DICT, '*CURRENT.AR.STATS' ELSE RETURNşWRITE 'READ' ON FI.DICT, 'DEBUG'şLOCATE YEAR IN STATS.REC<6> SETTING YEAR.POS ELSE RETURNşWRITEV YEAR.POS ON FI.DICT, 'DEBUG', 2şNUMBERS=STATS.REC<7,YEAR.POS>şWRITEV NUMBERS ON FI.DICT, 'DEBUG', 3şTOT.NUMBERS=SUM(NUMBERS)şTOT.NUMBERS=TOT.NUMBERS-NUMBERS<1,1,1>şWRITEV TOT.NUMBERS ON FI.DICT, 'DEBUG', 4şW$TITLE:=YEARşDAYS.TYPES='0 - 30 Days,31 - 60 Days,61 - 90 Days,Over 90 Days'şCONVERT ',' TO CHAR(253) IN DAYS.TYPESşMAX.DAYS.TYPES=DCOUNT(DAYS.TYPES,CHAR(253))şFOR DAYS.CNTR = 1 TO MAX.DAYS.TYPESş   NUMBER=NUMBERS<1,1,DAYS.CNTR+1>ş   PCT=INT(NUMBER * 1000/TOT.NUMBERS + .5)ş   W$PIE.LABELS<1,DAYS.CNTR>=DAYS.TYPES<1,DAYS.CNTR>ş   W$PIE.VALUES<1,DAYS.CNTR>=(PCT/10)ş NEXT DAYS.CNTRşW$PIE.CAPTION='Days To Pay By Period For ':YEARş*ş*ş*şRETURN00060ASUB.USER.AUTHş0c2SUBROUTINE SUB.USER.AUTH(USERID,PASSWORD,MODE,VALID,MESSAGE,MAT USER.ITEM)ş*ş* Custom user authentication subroutine. Authenticate user from the USERS file.ş*ş* Input Values:ş*  USERID - User ID entered by the user on the login formş*  PASSWORD - Password entered by the user on the login formş*  MODE - "AUTH" - User is logging in, authorize.ş*       - "READ" - User is already authorized, just provide the USER.ITEMş*                  Ignore PASSWORD.ş*                  VALID and MESSAGE will be ignored by caller.ş* ş* Output valuesş*  VALID - 1=User authenticated, 0=User NOT authenticatedş*  MESSAGE - Alternative Message to display when user is NOT authenticated.ş*  MAT USER.ITEM - Dashboard user informationş*şINCLUDE WBPD FI.MVDB.USERSş*ş* USER.ITEM values that may be populated by this program:ş*ş* EQU USER.DEFAULT.DB   TO USER.ITEM(2)ş* EQU USER.NAME         TO USER.ITEM(3)ş* EQU USER.ROLE         TO USER.ITEM(6)ş*şMAT USER.ITEM = ""ş*şOPEN '','DM,USERS,' TO F.USERS ELSEş  MESSAGE = "Unable to open DM,USERS, file."ş  VALID = 0ş  RETURNşENDşREAD UREC FROM F.USERS, USERID ELSEş  VALID = 0ş  RETURNşENDşIF MODE = "AUTH" THENş  IF PASSWORD # "" THEN EPWD = ICONV( PASSWORD, 'UC' ) ELSE EPWD = ""şEND ELSEş  EPWD = "" ; UREC<7> = "" ;* Make them match since we're not really authenticatingşENDşIF EPWD = UREC<7> THENş  VALID = 1ş  USER.DEFAULT.DB = "Chart Demo"ş  USER.NAME = UREC<1>ş  IF UREC<2> = "DBADMIN" THENş    USER.ROLE = "Administrator"ş  END ELSE USER.ROLE = "User"ş  RETURNşEND ELSEş  VALID = 0şENDşRETURN000403SUB.DEMO.SALES.PERCENTSş0c2SUBROUTINE SUB.DEMO.SALES.PERCENTSş*ş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "FCMSCOLUMN3D"şW$WIDTH = 3şW$PDFABLE = 1ş*şIF G$QUERYMODE THEN RETURNş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEşOPEN '','MVDB.CONTROL' TO FILE.CONTROL ELSE STOPşREAD REC FROM FILE.CONTROL, 'DEMO.FINANCIAL.PICTURE' ELSE REC=''şW$BAR.LABELS<1>='Parts'şW$BAR.LABELS<2>='Services'şW$BAR.CAPTION='YTD Percentage of Sales by Type'şW$BAR.XMEMO='Year'şW$BAR.YMEMO='Percent of Sales'ş*şYEARS=REC<38>şPART.AMTS=REC<40>şPART.PCTS=REC<41>şSERVICE.AMTS=REC<42>şSERVICE.PCTS=REC<43>şMAX.YEARS=DCOUNT(YEARS,CHAR(253))ş*ş*şFOR YEAR.CNTR = 1 TO MAX.YEARSş   W$BAR.XLABELS<1,YEAR.CNTR>=YEARS<1,YEAR.CNTR>ş   W$BAR.VALUES<1,YEAR.CNTR>=OCONV(PART.PCTS<1,YEAR.CNTR>,'MD1')ş   W$BAR.VALUES<2,YEAR.CNTR>=OCONV(SERVICE.PCTS<1,YEAR.CNTR>,'MD1')ş NEXT YEAR.CNTRşW$CHART.OPTIONS<-1>='decimals="1"'şW$CHART.OPTIONS<-1>='forceDecimals="1"'şRETURNşEND00078BSUB.DEMO.MONTHLY.SALES.BY.REPş0c2SUBROUTINE SUB.DEMO.MONTHLY.SALES.BY.REPş*ş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "FCCOLUMN2D"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEşMONTHS='Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec'şOPEN '','MVDB.CONTROL' TO FILE.CONTROL ELSE STOPşREVENUE.OR.GP=WIDGET.USER.DATA(1)şYEAR=WIDGET.USER.DATA(2)şREP=WIDGET.USER.DATA(3)şBEGIN CASEş   CASE REVENUE.OR.GP = 'REVENUES'ş      W$TITLE=YEAR:' Monthly Sales For Rep: ':REPş      W$BAR.YMEMO = "Sales"ş      READ ANNUAL.REC FROM FILE.CONTROL, 'SALES.':YEAR ELSE ANNUAL.REC=''ş      LOCATE REP IN ANNUAL.REC<1> SETTING REP.POS ELSE REP.POS=1ş      SALES.AMTS=ANNUAL.REC<2,REP.POS>ş      MAX.ROUNDER=250000ş   CASE REVENUE.OR.GP = 'GROSSPROFIT'ş      W$TITLE=YEAR:' Monthly Gross Profits For Rep: ':REPş      W$BAR.YMEMO = "Gross Profits"ş      READ ANNUAL.REC FROM FILE.CONTROL, 'GPS.':YEAR ELSE ANNUAL.REC=''ş      LOCATE REP IN ANNUAL.REC<1> SETTING REP.POS ELSE REP.POS=1ş      SALES.AMTS=ANNUAL.REC<2,REP.POS>ş      MAX.ROUNDER=50000şEND CASEş*şMAX.MOS=DCOUNT(SALES.AMTS,CHAR(252))şMAX.SALES.AMT=0şFIRST.MOS=''şFOR NN = 1 TO MAX.MOSş   MONTH=FIELD(MONTHS,',',NN)ş   SALES.AMT=SALES.AMTS<1,1,NN>ş   SALES.AMT=OCONV(SALES.AMT,'MD02')ş   IF SALES.AMT > MAX.SALES.AMT THEN MAX.SALES.AMT=SALES.AMTş   W$BAR.VALUES<1,NN> = SALES.AMTş   W$BAR.XLABELS<1,NN> = MONTHşNEXT NNşW$BAR.XMEMO = "Month"ş* ROUND MAX AMOUNT UP TO THE NEXT MAX.ROUNDERşMAX.SALES.AMT+=MAX.ROUNDERşMAX.SALES.AMT=INT(MAX.SALES.AMT/MAX.ROUNDER) * MAX.ROUNDERşW$CHART.OPTIONS<-1>='yAxisMaxValue="':MAX.SALES.AMT:'"'şW$CHART.OPTIONS<-1>='decimals="2"'şW$CHART.OPTIONS<-1>='DecimalPrecision="2"'şW$CHART.OPTIONS<-1>='divLineDecimalPrecision="2"'şW$CHART.OPTIONS<-1>='limitsDecimalPrecision="2"'şW$CHART.OPTIONS<-1>='formatNumberScale="1"'şRETURN001DF6SUB.MW.CODE.FACTORYş0c2SUBROUTINE SUB.MW.CODE.FACTORYş*ş* Copyright (c) 2010 SB, Inc. All rights reserved.ş*ş* Dashboard Widgetş*şINCLUDE WBPD MVDB.INCLUDEş*şW$TITLE = "Mobile Web Code Factory"şW$TYPE = "HTML"şW$WIDTH = 3 ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*şW$HTML.DATA = '<form action="/dbc/MVDB.MAIN" method="GET">'şW$HTML.DATA<-1> = '<input type="hidden" name="udview" value="':G$WIDGET.NAME:'" />'ş*şNSELECTED = "" ; TSELECTED = "" ; FSELECTED = ""şCODE.TEXT = ""şIF WIDGET.USER.DATA(1) # WIDGET.USER.DATA(100) THENş  TMP1 = WIDGET.USER.DATA(1)ş  TMP100 = WIDGET.USER.DATA(100)ş  MAT WIDGET.USER.DATA = ""ş  WIDGET.USER.DATA(1) = TMP1ş  WIDGET.USER.DATA(100) = TMP100şENDşW$HTML.DATA<-1> = '<table width="100%">'şBEGIN CASEş  CASE WIDGET.USER.DATA(1) = "N"ş    NSELECTED = "selected"ş    GOSUB TYPE.SELECTORş    W$HTML.DATA<-1> = '<tr><td><input type="hidden" name="udpos2" value="2" />'ş    W$HTML.DATA<-1> = 'Nav Labels (comma-separated):</td><td><input type="text" name="udval2" value="':WIDGET.USER.DATA(2):'" /></td></tr>'ş    W$HTML.DATA<-1> = '<tr><td><input type="hidden" name="udpos3" value="3" />'ş    W$HTML.DATA<-1> = 'Nav Links (comma-separated):</td><td><input type="text" name="udval3" value="':WIDGET.USER.DATA(3):'" /></td></tr>'ş    W$HTML.DATA<-1> = '</table>'ş    *ş    IF WIDGET.USER.DATA(2) # "" THENş      CODE.TEXT = 'P$NAV.OPTS = ""'ş      VARNAME = "P$NAV.LABEL" ; LIST = WIDGET.USER.DATA(2)ş      GOSUB MAKE.CODEş      VARNAME = "P$NAV.LINK" ; LIST = WIDGET.USER.DATA(3)ş      GOSUB MAKE.CODEş    ENDş    W$HTML.DATA<-1> = '<br /><input type="submit" value="Make Code" />'ş  CASE WIDGET.USER.DATA(1) = "T"ş    TSELECTED = "selected"ş    GOSUB TYPE.SELECTORş    *ş    W$HTML.DATA<-1> = '<tr><td><input type="hidden" name="udpos2" value="2" />'ş    W$HTML.DATA<-1> = 'Column Headings (comma-separated):</td><td><input type="text" name="udval2" value="':WIDGET.USER.DATA(2):'" /></td></tr>'ş    W$HTML.DATA<-1> = '<tr><td><input type="hidden" name="udpos3" value="3" />'ş    W$HTML.DATA<-1> = 'Column Just (L/R) (comma-separated):</td><td><input type="text" name="udval3" value="':WIDGET.USER.DATA(3):'" /></td></tr>'ş    W$HTML.DATA<-1> = '</table>'ş    IF WIDGET.USER.DATA(2) # "" THENş      CODE.TEXT<-1> = 'MAT TABLE.DEFS = ""'ş      VARNAME = "TABLE$LABELS" ; LIST = WIDGET.USER.DATA(2)ş      GOSUB MAKE.CODEş      VARNAME = "TABLE$ALIGN" ; LIST = WIDGET.USER.DATA(3)ş      GOSUB MAKE.CODEş      *ş      CODE.TEXT<-1> = 'TABLE$DATA = "" ;* Fill in your data here'ş      CODE.TEXT<-1> = 'CALL SUB.MOBI.TABLE(MAT TABLE.DEFS)'ş    ENDş    W$HTML.DATA<-1> = '<br /><input type="submit" value="Make Code" />'ş  CASE WIDGET.USER.DATA(1) = "F"ş    FSELECTED = "selected"ş    GOSUB TYPE.SELECTORş    *ş    W$HTML.DATA<-1> = '<tr><td><input type="hidden" name="udpos2" value="2" />'ş    W$HTML.DATA<-1> = 'Field Labels (comma-separated):</td><td><input type="text" name="udval2" value="':WIDGET.USER.DATA(2):'" /></td></tr>'ş    W$HTML.DATA<-1> = '<tr><td><input type="hidden" name="udpos3" value="3" />'ş    W$HTML.DATA<-1> = 'Field Types (comma-separated):</td><td><input type="text" name="udval3" value="':WIDGET.USER.DATA(3):'" /></td></tr>'ş    W$HTML.DATA<-1> = '<tr><td><input type="hidden" name="udpos4" value="4" />'ş    W$HTML.DATA<-1> = 'Values (comma-separated):</td><td><input type="text" name="udval4" value="':WIDGET.USER.DATA(4):'" /></td></tr>'ş    *ş    IF WIDGET.USER.DATA(2) # "" THENş      *ş      DIM SEL.REF(20)ş      DIM SEL.LISTS(20)ş      DIM SEL.VALS(20)ş      TMP.TYPES = WIDGET.USER.DATA(3)ş      CALL SWAP(TMP.TYPES,'\,',CHAR(9))ş      CONVERT "," TO @AM IN TMP.TYPESş      CONVERT " " TO "" IN TMP.TYPESş      CONVERT CHAR(9) TO "," IN TMP.TYPESş      TMP.NAMES = WIDGET.USER.DATA(2)ş      CALL SWAP(TMP.NAMES,'\,',CHAR(9))ş      CONVERT "," TO @AM IN TMP.NAMESş      CONVERT CHAR(9) TO "," IN TMP.NAMESş      SEL.POS = 0ş      POS.LIST = ""ş      UDPOS = 6 ;* Next user data position (hold 5 open)ş      LOOPş        LOCATE "SELECT" IN TMP.TYPES SETTING POS THENş          TMP.TYPES<POS> = "XXX"ş          SEL.POS += 1ş          POS.LIST<-1> = POSş          W$HTML.DATA<-1> = '<tr><td><input type="hidden" name="udpos':UDPOS:'" value="':UDPOS:'" />'ş          W$HTML.DATA<-1> = 'Options for "':TMP.NAMES<POS>:'":</td><td><input type="text" name="udval':UDPOS:'" value="':WIDGET.USER.DATA(UDPOS):'" /></td></tr>'ş          UDPOS += 1ş          W$HTML.DATA<-1> = '<tr><td><input type="hidden" name="udpos':UDPOS:'" value="':UDPOS:'" />'ş          W$HTML.DATA<-1> = 'Values for "':TMP.NAMES<POS>:'":</td><td><input type="text" name="udval':UDPOS:'" value="':WIDGET.USER.DATA(UDPOS):'" /></td></tr>'ş          UDPOS += 1ş        END ELSE EXITş      REPEATş      W$HTML.DATA<-1> = '</table>'ş      UDPOS = 5ş      CONVERT @AM TO "," IN POS.LISTş      W$HTML.DATA<-1> = '<input type="hidden" name="udpos':UDPOS:'" value="5" />'ş      W$HTML.DATA<-1> = '<input type="hidden" name="udval':UDPOS:'" value="':POS.LIST:'" />'ş    END ELSEş      W$HTML.DATA<-1> = '</table>'ş    ENDş    W$HTML.DATA<-1> = '<input type="submit" value="Make Code" />'ş    *ş    IF WIDGET.USER.DATA(2) # "" THENş      CODE.TEXT<-1> = "FORM.ID = 1"ş      CODE.TEXT<-1> = 'INPUT.OPTS = "" ; SEL.LISTS = "" ; SEL.VALS = ""'ş      CODE.TEXT<-1> = 'FIELDSET.LABEL = "Fieldset Label"'ş      VARNAME = "LABELS" ; LIST = WIDGET.USER.DATA(2)ş      GOSUB MAKE.CODEş      VARNAME = "INPUT.TYPES" ; LIST = WIDGET.USER.DATA(3)ş      GOSUB MAKE.CODEş      VARNAME = "VALUES" ; LIST = WIDGET.USER.DATA(4)ş      GOSUB MAKE.CODEş      *ş      POS.LIST = WIDGET.USER.DATA(5)ş      CONVERT "," TO @AM IN POS.LISTş      POS.CNT = DCOUNT( POS.LIST, @AM )ş      SXPOS = 6ş      FOR SX = 1 TO POS.CNTş        LIST = WIDGET.USER.DATA(SXPOS)ş        SXPOS += 1ş        VALS = WIDGET.USER.DATA(SXPOS)ş        SXPOS += 1ş        CONVERT "," TO @AM IN LISTş        CONVERT "," TO @AM IN VALSş        FOR SVX = 1 TO DCOUNT( LIST, @AM )ş          CODE.TEXT<-1> = "SEL.LISTS<":POS.LIST<SX>:",":SVX:"> = \":TRIM(LIST<SVX>):"\"ş          CODE.TEXT<-1> = "SEL.VALS<":POS.LIST<SX>:",":SVX:"> = \":TRIM(VALS<SVX>):"\"ş        NEXT SVXş      NEXT SXş      CODE.TEXT<-1> = 'FIELDSET.OPTIONS = ""'ş      CODE.TEXT<-1> = "CALL SUB.MOBI.FIELDSET(LABELS,VALUES,INPUT.TYPES,INPUT.OPTS,SEL.LISTS,SEL.VALS,FIELDSET.LABEL,FORM.ID,FIELDSET.OPTIONS)"ş    ENDş  CASE 1ş    GOSUB TYPE.SELECTORş    MAT WIDGET.USER.DATA = ""ş    W$HTML.DATA<-1> = '</table>'şEND CASEş*şWIDGET.USER.DATA(100) = WIDGET.USER.DATA(1) ;* Current typeşW$HTML.DATA<-1> = '</form>'şIF CODE.TEXT # "" THENş  CALL SWAP(CODE.TEXT,'&','&amp;')ş  CALL SWAP(CODE.TEXT,'<','&lt;')ş  CALL SWAP(CODE.TEXT,'>','&gt;')ş  CALL SWAP(CODE.TEXT,@AM,'<br />')ş  W$HTML.DATA<-1> = '<hr />'ş  W$HTML.DATA<-1> = '<pre>'ş  W$HTML.DATA<-1> = CODE.TEXTş  W$HTML.DATA<-1> = '</pre>'şENDşRETURNş*şMAKE.CODE: *ş*şCALL SWAP(LIST,'\,',CHAR(9))şCONVERT "," TO @AM IN LISTşCONVERT CHAR(9) TO ',' IN LISTşCNT = DCOUNT( LIST, @AM )şCODE.TEXT<-1> = VARNAME:' = ""'şFOR N = 1 TO CNTş  WORD = TRIM(LIST<N>)ş  IF WORD # "" THENş    CODE.TEXT<-1> = VARNAME:'<':N:'> = \':WORD:'\'ş  ENDşNEXT NşRETURNş*şTYPE.SELECTOR: *ş*şW$HTML.DATA<-1> = '<tr><td><input type="hidden" name="udpos1" value="1" />'şW$HTML.DATA<-1> = 'Create code for:</td><td><select name="udval1" onChange="this.form.submit();">'şW$HTML.DATA<-1> = '<option value="">Select Code Type</option>'şW$HTML.DATA<-1> = '<option value="N" ':NSELECTED:'>P$NAV Navigation</option>'şW$HTML.DATA<-1> = '<option value="T" ':TSELECTED:'>Table</option>'şW$HTML.DATA<-1> = '<option value="F" ':FSELECTED:'>Fieldset / Form</option>'şW$HTML.DATA<-1> = '</select></td></tr>'şRETURN0004B6SUB.DEMO.SALE.TYPES.PIEş0c2SUBROUTINE SUB.DEMO.SALE.TYPES.PIEş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEş*şW$TYPE = "FC2DPIE"şW$WIDTH = 3ş*şIF G$QUERYMODE THEN RETURNş*şW$BAR.COLORS<1,1>=COLOR$MAROONşW$BAR.COLORS<1,2>=COLOR$TEALşW$BAR.COLORS<1,3>=COLOR$SILVERşW$BAR.COLORS<1,4>=COLOR$BLUEşYEAR=WIDGET.USER.DATA(1)şBEGIN CASEş   CASE WIDGET.USER.DATA(2) = 'PARTS'ş      W$TITLE = 'Chart - ':YEAR:' Parts Revenue by Type'ş      TYPE.ATT=52ş      AMTS.ATT=53ş      W$PIE.CAPTION='Total Parts Revenue of 'ş   CASE WIDGET.USER.DATA(2) = 'SERVICES'ş      W$TITLE = 'Chart - ':YEAR:' Services Revenue by Type'ş      TYPE.ATT=50ş      AMTS.ATT=51ş      W$PIE.CAPTION='Total Services Revenue of 'şEND CASEş*şOPEN '','MVDB.CONTROL' TO FILE.CONTROL ELSE STOPşREAD REC FROM FILE.CONTROL, 'DEMO.FINANCIAL.PICTURE' ELSE REC=''şLOCATE YEAR IN REC<67> SETTING YEAR.POS ELSE YEAR.POS=1ş**W$PIE.VALUE.OPTS<1,3>='isSliced="1"'ş*şTYPES=REC<TYPE.ATT>şAMOUNTS=REC<AMTS.ATT>şMAX.TYPES=DCOUNT(TYPES,CHAR(253))şFOR TYPE.CNTR = 1 TO MAX.TYPESş   W$PIE.LABELS<1,TYPE.CNTR>=TYPES<1,TYPE.CNTR>ş   W$PIE.VALUES<1,TYPE.CNTR>=AMOUNTS<1,TYPE.CNTR,YEAR.POS>ş NEXT TYPE.CNTRşW$PIE.CAPTION:=OCONV(SUM(W$PIE.VALUES),'MD2,$')ş*ş*şRETURN000221SUB.LISTUş0c2SUBROUTINE SUB.LISTU ş* ş* Copyright (c) 2010 SB, Inc. All rights reserved. ş* Description: List Users ş* ş*#MAKE# RL $OPTIONS D3 şINCLUDE WBPD MVDB.INCLUDE ş* şW$TYPE = "HTML" şW$TITLE = "List Users" şW$WIDTH = 1 şW$PRINTABLE = 1 ş* şIF G$QUERYMODE THEN RETURN ş* şEXECUTE "LISTU" CAPTURING JUNK şW$HTML.DATA = '<div  align="left">' şW$HTML.DATA<-1> = '<pre>' şFOR X = 1 TO DCOUNT( JUNK, @AM ) ş W$HTML.DATA<-1> = JUNK<X> şNEXT X şW$HTML.DATA<-1> = '</pre>' şW$HTML.DATA<-1> = '</div>' ş* şINCLUDE WBPD SOURCE.VIEW.ICON ş* şRETURN 00006CVOCş0c000003AMVAPPS.INSTALLERş0c2PQşHRUN WDB.BP APP.INSTALLERşSTONşA2şP00001FLOGINş0c2PAşPTERM CASE NOINVERT0000F9MVDB.USERSş0c0000027guestş0c2guestşChartsşGuest UserşşşUser00003Fadminş0c2adminşAdministratorşAdmin Userşşno emailşAdministrator000037emailedş0c2788CF490şAdministratorşemailed reportşşşUser000036webserviceş0c2788CF490şAdministratorşwebserviceşşşUser000281DICT_DASHBOARD.CLOSING.STATSş0c000001BAMOUNTş0c1Aş1şşşşşMD2şşRş1200001CBRANCHş0c1Aş0şşşşşşG2*1şLş10000021COST.OF.SALEş0c1Aş2şşşşşMD2şşRş12000028GROSS.PROFITş0c1Aş0şşşşşMD2şF;1;2;-şRş12000014IDş0c1Aş0şşşşşşşLş10000021LAST.AP.REFRESHş0c119109ş04-25-20000021LAST.AR.REFRESHş0c119109ş04-25-20000024LAST.SALES.REFRESHş0c119109ş04-25-2000001APIPEş0c1Aş0ş şşşşşF;C|şLş100001CREGIONş0c1Aş0şşşşşşG3*1şLş10000034REGION*YYYYMMş0c1Aş0şşşşşşA;0(G3*1):"*":0(G1*1)şLş1000001DSALESMANş0c1Aş0şşşşşşG*1şLş20000024SALESMAN*YYYYMMş0c1Aş0şşşşşşG*2şLş2000001EYYYYş0c1Aş0şşşşşşG1*1ıT1,4şLş400001BYYYYMMş0c1Aş0şşşşşşG1*1şLş6000023YYYYMM*BRANCHş0c1Aş0şşşşşşG1*2şLş1000818EMVDB.SUB.TEMPLATESş0c0000017FCBAR2Dş0c2USE FCAREA2D0009C3FCMSAREA2Dş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Create three arrays here. Two of them are single-dimention attributeş*   or value separated lists, one that stores descriptions of eachş*   point along the X axis (major), another that stores descriptionsş*   of the components that make up each point along the X axis (minor).ş*   Example: Monthly sales by territory where each month is a pointş*   (major) and each territory is a component of that point (minor).ş*   The third array is a full dynamic array where each attribute is aş*   territory (minor) and each value is a month (major).ş*   Array Examples:ş    TERRS="" ;* Each attribute is a short description of the territoryş    MNTHS="" ;* Each value is a short description of the month (Mon/YY)ş    SALES="" ;* Each attribute contains values (one per month) of theş             ;* sales within a territory. SALES<3,2> corresponds toş             ;* TERRS<1,3> and MNTHS<1,3>ş*   then you can load the widget's values and labels like:ş*     W$BAR.VALUES  = SALESş*     W$BAR.XLABELS = MNTHSş*     W$BAR.LABELS  = TERRSş*   rather than loading them a value at a time as shownş*   in the "FOR N = 1 TO 12" loop below.ş*şW$BAR.CAPTION = "YOUR CHART CAPTION HERE"şW$BAR.XMEMO = "X-Axis Text" ;* Text that appears below the X-Axis labelsş                            ;* Ex: Territory Sales by MonthşW$BAR.YMEMO = "Y-Axis Text" ;* Text that appears beside the Y-Axis labelsş                            ;* Ex: Sales (USD)ş*şFOR N = 1 TO 12ş  W$BAR.VALUES<1,N> = N ;* Valueş  W$BAR.XLABELS<1,N> = "Label ":N ;* X-Axis labelşNEXT NşW$BAR.LABELS<1>="Label 1"şW$BAR.LABELS<2>="Label 2"şW$BAR.LABELS<3>="Label 3"ş*ş* To suppress the actual values for any of the series:şW$BAR.LABEL.OPTS<1> = "showValues='0'"şW$BAR.LABEL.OPTS<2> = "showValues='0'"şW$BAR.LABEL.OPTS<3> = "showValues='0'"ş*ş* Specify the alpha (transparency level) for each of the seriesşW$BAR.LABEL.OPTS<1> := " areaAlpha='50'"şW$BAR.LABEL.OPTS<2> := " areaAlpha='70'"şW$BAR.LABEL.OPTS<3> := " areaAlpha='90'"ş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN000561SPARKWINLOSSş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Create two one-attribute, value-separated arrays here.ş*   One contains the actual data, the other contains benchmark dataş*   to which the actual data are compared.ş*   Example:ş      SALES: Each value is a single sales total for the monthş      GOALS: Each value is a single goal for the corresponding monthş*     you build the chart values by comparing each value within theş*     two lists, setting each chart value to "W" (win), "L" (lose)ş*     or "D" (draw) based on the comparisonş*şW$FW.CAPTION = "YOUR CHART CAPTION HERE"şW$FW.SUBCAPTION = "YOUR CHART SUBCAPTION HERE"ş*şMAX = DCOUNT(SALES,@VM)şFOR N = 1 TO MAXş  BEGIN CASEş    CASE SALES<1,N> > GOALS<1,N>; W$FW.VALUES<1,N> = "W" ;* Winş    CASE SALES<1,N> < GOALS<1,N>; W$FW.VALUES<1,N> = "L" ;* Lossş    CASE 1                                               ;* Drawş  END CASEşNEXT Nş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN00001BFCDOUGHNUT2Dş0c2USE FC2DPIE00057BFC2DPIEş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Create two one-attribute, value-separated arrays here.ş*   One contains the data, the other contains a short descriptionş*   of that data.ş*   Example:ş*     TERRSALES: Each value is a single territory's sales for the monthş*     TERRNAMES: Each value is a short name for the territoryş*     then you can load the widget's values like:ş*       W$PIE.LABELS = TERRNAMESş*       W$PIE.VALUES = TERRSALESş*     rather than loading them a value at a time as shownş*     in the "FOR N = 1 TO 7" loop below.ş*şFOR N = 1 TO 7ş  W$PIE.LABELS<1,N> = "Slice ":Nş  W$PIE.VALUES<1,N> = NşNEXT Nş*ş* For a 2D pie, a specific slice can be separated from the pieş* by setting this value:ş* W$PIE.VALUE.OPTS<1,X> = 'isSliced="1"'ş*   where "X" is the number of the value you want separatedş*ş* To show values instead of percentages, use this:ş* W$CHART.OPTIONS<-1> = "showPercentageValues='0'"ş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN00001BCYLINDERş0c2USE THERMOMETER000303TEXTş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Create dynamic array, on text line per attributeş*   Examples:ş*     READ TXTITM FROM FILE,ID ELSE TXTITM = "TXTITM NOT FOUND"ş*   or:ş*     EXECUTE "YOUR SORT STATEMENT" CAPTURING TXTITEMş*şW$TEXT.DATA = "YOUR DYNAMIC ARRAY HERE";* example: TXTITMş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN000016FCLINEş0c2USE FCAREA2D000022FCSTACKEDCOLUMN3Dş0c2USE FCMSBAR2D000A7CHLEDş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Read your data, summarize it into one number, like total salesş*   for the period. While you're at it, determine a contant toş*   which that number can be compared, like sales at the same pointş*   last year, or a sales goal for the period, whatever.ş*   Example:ş*     SALES: Total sales for a period within the current yearş*     GOAL:  Sales goal for said current year periodş*   Once you have your goal (or other benchmark), use it to calculateş*   your color range values. Also, you must determine the upper rangeş*   of your gauge. Make it slightly higher than the higher of yourş*   calculations (ie. if your sales exceed your goal, use the sales; ifş*   your goal exceeds your sales, use the goal).ş*   Example: Given GOAL & SALES, calculate the ranges:ş             GOAL      = 100000ş             SALES     = 110000ş             RANGE.BAD = INT(GOAL*.7)ş             RANGE.OK  = INT(GOAL*.9)ş             RANGE.GOOD= INT(SALES*1.1)ş*şW$FW.LOWER.LIMIT = 0şW$FW.UPPER.LIMIT = RANGE.GOOD ;* Upper limit of the gaugeşW$FW.LOWER.LIMIT.LABEL = "Poor"şW$FW.UPPER.LIMIT.LABEL = "Great"ş*şW$FW.NUMBER.PREFIX = "$"şW$FW.NUMBER.SUFFIX = ""ş*ş* First Color Range (Normally Green)şW$FW.COLOR.RANGE<1,1> = 0           ;* FromşW$FW.COLOR.RANGE<2,1> = RANGE.BAD   ;* ToşW$FW.COLOR.RANGE<3,1> = COLOR$RED   ;* Override colorş* Second Color Range (Normally Yellow)şW$FW.COLOR.RANGE<1,2> = RANGE.BAD   ;* FromşW$FW.COLOR.RANGE<2,2> = RANGE.OK    ;* Toş* Third Color Range (Normally Red)şW$FW.COLOR.RANGE<1,3> = RANGE.OK    ;* FromşW$FW.COLOR.RANGE<2,3> = RANGE.GOOD  ;* ToşW$FW.COLOR.RANGE<3,3> = COLOR$GREEN ;* Override colorş*ş* Value & TargetşW$FW.METER.VALUE  = SALES      ;* Your actual valueş*ş* Configure tickmarks (optional)ş* Below are default values. Leaving this code out would make no differenceş* but this is here in case you want to modify the defaultsş*şW$FW.TICKMARKS<1> = 1 ;* Display tickmarksşW$FW.TICKMARKS<2> = 1 ;* Display values by tickmarksşW$FW.TICKMARKS<3> = "B" ;* Show tickmarks below the graphşW$FW.TICKMARKS<4> = "" ;* # of Major Tickmarks (blank = Let it calculate this)şW$FW.TICKMARKS<5> = "" ;* # of Minor Tickmarks between Majors (none)ş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN00001DFCMSCOLUMN3Dş0c2USE FCMSBAR2D00026AHTMLş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Create a HTML string from data previously readş*şW$HTML.DATA = "<h2>YOUR HTML STRING HERE</h2>"ş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN00001AFCCOLUMN2Dş0c2USE FCAREA2D00001CSPARKLINEş0c2USE SPARKCOLUMN000ADBHBULLETş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Read your data, summarize it into one number, like total salesş*   for the period. While you're at it, determine a contant toş*   which that number can be compared, like sales at the same pointş*   last year, or a sales goal for the period, whatever.ş*   Example:ş*     SALES: Total sales for a period within the current yearş*     GOAL:  Sales goal for said current year periodş*   Once you have your goal (or other benchmark), use it to calculateş*   your color range values. Also, you must determine the upper rangeş*   of your gauge. Make it slightly higher than the higher of yourş*   calculations (ie. if your sales exceed your goal, use the sales; ifş*   your goal exceeds your sales, use the goal).ş*   Example: Given GOAL & SALES, calculate the ranges:ş             GOAL      = 100000ş             SALES     = 110000ş             RANGE.BAD = INT(GOAL*.7)ş             RANGE.OK  = INT(GOAL*.9)ş             RANGE.GOOD= INT(SALES*1.1)ş*şW$FW.LOWER.LIMIT = 0şW$FW.UPPER.LIMIT = RANGE.GOOD ;* Upper limit of the gaugeşW$FW.CAPTION     = "YOUR MAIN CAPTION HERE"şW$FW.SUBCAPTION  = "YOUR SUB-CAPTION HERE"  ;* Optionalş*şW$FW.NUMBER.PREFIX = "$"şW$FW.NUMBER.SUFFIX = ""ş*ş* First Color Range (Normally Green)şW$FW.COLOR.RANGE<1,1> = 0           ;* FromşW$FW.COLOR.RANGE<2,1> = RANGE.BAD   ;* ToşW$FW.COLOR.RANGE<3,1> = COLOR$RED   ;* Override colorş* Second Color Range (Normally Yellow)şW$FW.COLOR.RANGE<1,2> = RANGE.BAD   ;* FromşW$FW.COLOR.RANGE<2,2> = RANGE.OK    ;* Toş* Third Color Range (Normally Red)şW$FW.COLOR.RANGE<1,3> = RANGE.OK    ;* FromşW$FW.COLOR.RANGE<2,3> = RANGE.GOOD  ;* ToşW$FW.COLOR.RANGE<3,3> = COLOR$GREEN ;* Override colorş*ş* Value & TargetşW$FW.METER.VALUE  = SALES      ;* Your actual valueşW$FW.METER.TARGET = GOAL       ;* Your calculated targetş*ş* Configure tickmarks (optional)ş* Below are default values. Leaving this code out would make no differenceş* but this is here in case you want to modify the defaultsş*şW$FW.TICKMARKS<1> = 1 ;* Display tickmarksşW$FW.TICKMARKS<2> = 1 ;* Display values by tickmarksşW$FW.TICKMARKS<3> = "B" ;* Show tickmarks below the graphşW$FW.TICKMARKS<4> = "" ;* # of Major Tickmarks (blank = Let it calculate this)şW$FW.TICKMARKS<5> = "" ;* # of Minor Tickmarks between Majors (none)ş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN000010VLEDş0c2USE HLED000016FC3DPIEş0c2USE FC2DPIE000905FCMSBAR2Dş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Create three arrays here. Two of them are single-dimention attributeş*   or value separated lists, one that stores descriptions of eachş*   point along the X axis (major), another that stores descriptionsş*   of the components that make up each point along the X axis (minor).ş*   Example: Monthly sales by territory where each month is a pointş*   (major) and each territory is a component of that point (minor).ş*   The third array is a full dynamic array where each attribute is aş*   territory (minor) and each value is a month (major).ş*   Array Examples:ş    TERRS="" ;* Each attribute is a short description of the territoryş    MNTHS="" ;* Each value is a short description of the month (Mon/YY)ş    SALES="" ;* Each attribute contains values (one per month) of theş             ;* sales within a territory. SALES<3,2> corresponds toş             ;* TERRS<1,3> and MNTHS<1,3>ş*   then you can load the widget's values and labels like:ş*     W$BAR.VALUES  = SALESş*     W$BAR.XLABELS = MNTHSş*     W$BAR.LABELS  = TERRSş*   rather than loading them a value at a time as shownş*   in the "FOR N = 1 TO 12" loop below.ş*şW$BAR.CAPTION = "YOUR CHART CAPTION HERE"şW$BAR.XMEMO = "X-Axis Text" ;* Text that appears below the X-Axis labelsş                            ;* Ex: Territory Sales by MonthşW$BAR.YMEMO = "Y-Axis Text" ;* Text that appears beside the Y-Axis labelsş                            ;* Ex: Sales (USD)ş*şFOR N = 1 TO 12ş  W$BAR.VALUES<1,N> = N ;* Valueş  W$BAR.XLABELS<1,N> = "Label ":N ;* X-Axis labelşNEXT NşW$BAR.LABELS<1>="Label 1"şW$BAR.LABELS<2>="Label 2"şW$BAR.LABELS<3>="Label 3"ş*ş* To suppress the actual values for any of the series:şW$BAR.LABEL.OPTS<1> = "showValues='0'"şW$BAR.LABEL.OPTS<2> = "showValues='0'"şW$BAR.LABEL.OPTS<3> = "showValues='0'"ş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN00022EMAPş0c2W$TITLE = "Untitled Map"ş*ş* The W$TYPE variable needs to represent a valid map nameş*şW$TYPE = "MAP:Canada"şW$WIDTH = 3 ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*şW$MAP.IDS<1,1> = "01"şW$MAP.VALUES<1,1> = 5şW$MAP.VALUE.OPTS<1,1> = 'toolText="This is Alberta!"'ş*şW$MAP.RANGE.NAME<1,1> = "Not On The Map"şW$MAP.RANGE.LOW<1,1> = "0"şW$MAP.RANGE.HIGH<1,1> = "5"şW$MAP.RANGE.COLOR<1,1> = "WHITE"şW$MAP.RANGE.NAME<1,2> = "On The Map"şW$MAP.RANGE.LOW<1,2> = "5"şW$MAP.RANGE.HIGH<1,2> = "10"şW$MAP.RANGE.COLOR<1,2> = "GREEN"ş*şRETURN0004FFTABLEş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Create a work table from your data that you'll use to populate theş*   widget's table data array where attributes represent rows andş*   values represent columns. NOTE: If you are using the widget'sş*   Total row, you have to calculate the totals yourself and stickş*   them in the appropriate W$TABLE.TOTALS value.ş*ş* Set up column labelsşW$TABLE.COL.LABELS<1,1> = "Column Heading 1"şW$TABLE.COL.LABELS<1,2> = "Column Heading 2"şW$TABLE.COL.LABELS<1,3> = "Column Heading 3"ş*ş* Column justification = left, right, centerşW$TABLE.COL.JUST<1,1> = "left"şW$TABLE.COL.JUST<1,2> = "right"ş*ş* Table RowsşFOR ROW = 1 TO 5ş  W$TABLE.DATA<ROW,1> = ROW:",1"ş  W$TABLE.DATA<ROW,2> = ROW:",2"şNEXT ROWş*ş* TotalsşW$TABLE.TOTALS<1,1> = "2"şW$TABLE.TOTALS<1,2> = "4"ş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN000DE2ANGULARGAUGEş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Read your data, summarize it into one number, like total salesş*   for the period. While you're at it, determine some contants toş*   which that number can be compared, like sales at the same pointş*   last year, or a sales goal for the period, whatever. Also, gatherş*   information that will allow you to create ranges against which toş*   compare the number and those constants, if any.ş*   Example:ş*     SALES.CY: Total sales for a period within the current yearş*     SALES.LY: Total sales within that same period last yearş*     SLS.GOAL: Sales goal for said current year periodş*   Once you have your goal (or other benchmark), use it to calculateş*   your color range values. Also, you must determine the upper rangeş*   of your gauge. Make it slightly higher than the highest of yourş*   calculations (ie. if your sales exceed your goal, use the sales; ifş*   your goal exceeds your sales, use the goal).ş*   Example: Given SLS.GOAL & SALES.CY, calculate the ranges:ş             SLS.GOAL  = 100000ş             SALES.CY  = 110000ş             SALES.LY  = 95000ş             RANGE.BAD = INT(SLS.GOAL*.7)ş             RANGE.OK  = INT(SLS.GOAL*.9)ş             RANGE.GOOD= INT(SALES.CY*1.1)ş*şW$FW.LOWER.LIMIT = 0şW$FW.UPPER.LIMIT = RANGE.GOOD ;* Upper limit of the gaugeşW$FW.LOWER.LIMIT.LABEL = "Poor"şW$FW.UPPER.LIMIT.LABEL = "Great"ş*şW$FW.NUMBER.PREFIX = "$"şW$FW.NUMBER.SUFFIX = ""ş*ş* First Color Range (Normally Green)şW$FW.COLOR.RANGE<1,1> = 0           ;* FromşW$FW.COLOR.RANGE<2,1> = RANGE.BAD   ;* ToşW$FW.COLOR.RANGE<3,1> = COLOR$RED   ;* Override colorş* Second Color Range (Normally Yellow)şW$FW.COLOR.RANGE<1,2> = RANGE.BAD   ;* FromşW$FW.COLOR.RANGE<2,2> = RANGE.OK    ;* ToşW$FW.COLOR.RANGE<3,2> = COLOR$YELLOW;* Override colorş* Third Color Range (Normally Red)şW$FW.COLOR.RANGE<1,3> = RANGE.OK    ;* FromşW$FW.COLOR.RANGE<2,3> = RANGE.GOOD  ;* ToşW$FW.COLOR.RANGE<3,3> = COLOR$GREEN ;* Override colorş*ş* Main Dial ValueşW$FW.DIAL.VALUES<1> = SALES.CY      ;* Your actual valueş*ş* Trendpoints (optional)ş* By default, there are no trendpoints on the gauge.ş*ş* First TrendpointşW$FW.TRENDPOINT.VALUES<1,1> = SALES.LYşW$FW.TRENDPOINT.LABELS<1,1> = "Last Year"şW$FW.TRENDPOINT.OPTS<1,1> = 'color="':COLOR$BLACK:'" useMarker="1"'ş* Second TrendpointşW$FW.TRENDPOINT.VALUES<1,2> = SLS.GOALşW$FW.TRENDPOINT.LABELS<1,2> = "Goal"şW$FW.TRENDPOINT.OPTS<1,2> = 'color="':COLOR$SILVER:'" useMarker="1"'ş*ş* Plot an arc (optional) şW$FW.TRENDPOINT.VALUES<2,1> = SALES.LY ;* Arc beginşW$FW.TRENDPOINT.VALUES<2,2> = SALES.CY ;* Arc endş*ş* Configure tickmarks (optional)ş* Below are default values. Leaving this code out would make no differenceş* but this is here in case you want to modify the defaultsş*şW$FW.TICKMARKS<1> = 1 ;* Display tickmarksşW$FW.TICKMARKS<2> = 1 ;* Display values by tickmarksşW$FW.TICKMARKS<3> = "B" ;* Show tickmarks below the graphşW$FW.TICKMARKS<4> = "" ;* # of Major Tickmarks (blank = Let it calculate this)şW$FW.TICKMARKS<5> = "" ;* # of Minor Tickmarks between Majors (none)ş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN00001AFCCOLUMN3Dş0c2USE FCAREA2D000020FCSTACKEDAREA2Dş0c2USE FCMSBAR2D0005C4FCAREA2Dş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Create two one-attribute, value-separated arrays here.ş*   One contains the data, the other contains a short descriptionş*   of that data, like the month and year.ş*   Example:ş*     TERRSALES: Each value is a single territory's sales for the monthş*     TERRPERDS: Each value is a short description of the period (MM/YY)ş*     then you can load the widget's values like:ş*       W$BAR.XLABELS = TERRPERDSş*       W$BAR.VALUES = TERRSALESş*     rather than loading them a value at a time as shownş*     in the "FOR N = 1 TO 12" loop below.ş*şW$BAR.CAPTION = "YOUR CHART CAPTION HERE"şW$BAR.XMEMO = "X-Axis Text" ;* Text that appears below the X-Axis labelsş                            ;* Ex: Territory ABC Sales by MonthşW$BAR.YMEMO = "Y-Axis Text" ;* Text that appears beside the Y-Axis labelsş                            ;* Ex: Sales (USD)ş*şFOR N = 1 TO 12ş  W$BAR.VALUES<1,N> = N ;* Valueş  W$BAR.XLABELS<1,N> = "Label ":N ;* X-Axis labelşNEXT Nş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN0006F3FUNNELş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Create two one-attribute, value-separated arrays here.ş*   One contains the data, the other contains a short descriptionş*   of that data. NOTE: The values should be ordered from largest toş*   smallest (value<1,1> should be larger than value<1,2> and so on)ş*   or the funnel will look weird. For a pyramid, that order shouldş*   be reversed (value<1,1> should be smaller than value<1,2>, etc).ş*   Example:ş*     KILLSTATS: Each value is a single territory's sales for the monthş*     STATDESCS: Each value is a short name for the territoryş*     then you can load the widget's values like:ş*       W$FC.LABELS = STATDESCSş*       W$FC.VALUES = KILLSTATSş*     rather than loading them a value at a time as shownş*     in the "FOR N = 1 TO 5" loop below.ş*   For a funnel chart, the last value in the list must represent theş*   total of all the other values. This is not true for a pyramid chart.ş*şFOR N = 1 TO 5ş  W$FW.LABELS<1,N> = "Section ":Nş  W$FW.VALUES<1,N> = NşNEXT Nş*şW$FW.CAPTION = "YOUR CAPTION HERE"şW$FW.SUBCAPTION = "YOUR SUB-CAPTION HERE"ş*ş* To show percentages instead of values, use this:ş* W$CHART.OPTIONS<-1> = "showPercentValues='1'"ş* To separate the sections from one another, use this:ş* W$CHART.OPTIONS<-1> = "isSliced='1'"ş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN0006FCTHERMOMETERş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Read your data, summarize it into one number, like total salesş*   for the period. While you're at it, determine a contant toş*   which that number can be compared, like sales at the same pointş*   last year, or a sales goal for the period, whatever.ş*   Example:ş*     SALES: Total sales for a period within the current yearş*     GOAL:  Sales goal for said current year periodş*   Example: Given GOAL & SALES, calculate the ranges:ş             GOAL      = 100000ş             SALES     = 110000ş*şW$FW.LOWER.LIMIT = 0şW$FW.UPPER.LIMIT = GOAL ;* Upper limit of the gaugeşW$FW.LOWER.LIMIT.LABEL = "Poor"şW$FW.UPPER.LIMIT.LABEL = "Great"şW$FW.THERMOMETER.COLOR = COLOR$REDş*şW$FW.NUMBER.PREFIX = "$"şW$FW.NUMBER.SUFFIX = ""ş*ş* ValueşW$FW.METER.VALUE  = SALES      ;* Your actual valueş*ş* Configure tickmarks (optional)ş* Below are default values. Leaving this code out would make no differenceş* but this is here in case you want to modify the defaultsş*şW$FW.TICKMARKS<1> = 1 ;* Display tickmarksşW$FW.TICKMARKS<2> = 1 ;* Display values by tickmarksşW$FW.TICKMARKS<3> = "B" ;* Show tickmarks below the graphşW$FW.TICKMARKS<4> = "" ;* # of Major Tickmarks (blank = Let it calculate this)şW$FW.TICKMARKS<5> = "" ;* # of Minor Tickmarks between Majors (none)ş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN000019FCMSLINEş0c2USE FCMSBAR2D000BB5USAMAPş0c2W$TITLE = "Untitled Map"şW$TYPE = "%TYPE%"şW$WIDTH = 3 ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş* The IDs of each section of a USA map are the state abbreviations, including DCş* A list of the state names can be obtained as follows:şOPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSEş  W$TYPE = "TEXT"ş  W$TEXT.DATA = "Unable to open MVDB.CONTROL"ş  RETURNşENDşREAD STATE.NAMES FROM F.MVDB.CONTROL, 'STATE.NAMES' ELSE STATE.NAMES = ''şCONVERT "," TO @VM IN STATE.NAMESş*şIF WIDGET.USER.DATA(1) # "" THENş  * User has clicked on a specific state. That state map will be displayed.ş  * This entire section of code can be removed if you dont want to allowş  * drill-down to a state map.ş  *ş  * The map "name" for the sepcifc state is stored in WIDGET.USER.DATA(2).ş  * The IDs for the state map are the FIPS county codes.ş  * A list of county codes can be gathered for a specific state as follows:ş  OPEN '','MVDB.MAP.DATA' TO F.MVDB.MAP.DATA ELSEş    W$TYPE = "TEXT"ş    W$TEXT.DATA = "Unable to open MVDB.MAP.DATA"ş    RETURNş  ENDş  EXECUTE 'SELECT MVDB.MAP.DATA WITH NAME = "':WIDGET.USER.DATA(2):'"' CAPTURING JUNKş  N = 0ş  LOOPş    READNEXT ID ELSE EXITş    READ REC FROM F.MVDB.MAP.DATA, ID THENş      N += 1ş      * The ID of the map data file is STATE * FIPS_Codeş      * Extract the FIPS code from the ID and use it as the ID for thisş      * value.ş      W$MAP.IDS<1,N> = FIELD( ID, '*', 2 )ş      W$MAP.VALUES<1,N> = Nş      * The county name can be found in REC<2>ş      W$MAP.VALUE.OPTS<1,N> = 'toolText="':REC<2>:'"'ş    ENDş  REPEATş  * Since we are in drill-down mode, we need to give the user a way to get backş  * to the national map. To get out of drill-down mode, WIDGET.USER.DATA(1) needsş  * to be cleared. Using a link is an easy way to do that.ş  W$LINK.LABEL<1,2> = "Return to USA Map"ş  W$LINK.LOCATION<1,2> = "1"ş  W$LINK.UD.POS<1,2> = 1ş  W$LINK.UD.VAL<1,2> = ""ş  * Override the title to show the state name.ş  W$TITLE = "Demo - ":WIDGET.USER.DATA(1):" Counties by Alphabet"şEND ELSE ;* No state specified, full US Mapş  * Assign a value to each desired map segments (States) as followsş  W$MAP.IDS<1,-1> = "TX"ş  W$MAP.VALUES<1,-1> = 100ş  W$MAP.VALUE.OPTS<1,-1> = 'toolText="Texas" ' ;* Multiple option settings are space-delimitedş  *ş  * With drill-down enabled, the widget will automatically be re-executed with the state ID in WIDGET.USER.DATA(1)ş  * Allow drill-down to the state level by setting this value:ş  W$MAP.VALUE.DD<1,-1> = 1şENDş*ş* Set up ranges of values. Note that the low range is inclusive, high range is exclusive.şW$MAP.RANGE.NAME<1,1> = "Range 1-99"şW$MAP.RANGE.LOW<1,1> = "1"şW$MAP.RANGE.HIGH<1,1> = "100"şW$MAP.RANGE.COLOR<1,1> = "GREEN"şW$MAP.RANGE.NAME<1,2> = "Range 100-199"şW$MAP.RANGE.LOW<1,2> = "100"şW$MAP.RANGE.HIGH<1,2> = "200"şW$MAP.RANGE.COLOR<1,2> = "YELLOW"şW$MAP.RANGE.NAME<1,3> = "Range 200-300"şW$MAP.RANGE.LOW<1,3> = "200"şW$MAP.RANGE.HIGH<1,3> = "301"şW$MAP.RANGE.COLOR<1,3> = "RED"ş*şRETURN000DE2HLINEARGAUGEş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Read your data, summarize it into one number, like total salesş*   for the period. While you're at it, determine some contants toş*   which that number can be compared, like sales at the same pointş*   last year, or a sales goal for the period, whatever. Also, gatherş*   information that will allow you to create ranges against which toş*   compare the number and those constants, if any.ş*   Example:ş*     SALES.CY: Total sales for a period within the current yearş*     SALES.LY: Total sales within that same period last yearş*     SLS.GOAL: Sales goal for said current year periodş*   Once you have your goal (or other benchmark), use it to calculateş*   your color range values. Also, you must determine the upper rangeş*   of your gauge. Make it slightly higher than the highest of yourş*   calculations (ie. if your sales exceed your goal, use the sales; ifş*   your goal exceeds your sales, use the goal).ş*   Example: Given SLS.GOAL & SALES.CY, calculate the ranges:ş             SLS.GOAL  = 100000ş             SALES.CY  = 110000ş             SALES.LY  = 95000ş             RANGE.BAD = INT(SLS.GOAL*.7)ş             RANGE.OK  = INT(SLS.GOAL*.9)ş             RANGE.GOOD= INT(SALES.CY*1.1)ş*şW$FW.LOWER.LIMIT = 0şW$FW.UPPER.LIMIT = RANGE.GOOD ;* Upper limit of the gaugeşW$FW.LOWER.LIMIT.LABEL = "Poor"şW$FW.UPPER.LIMIT.LABEL = "Great"ş*şW$FW.NUMBER.PREFIX = "$"şW$FW.NUMBER.SUFFIX = ""ş*ş* First Color Range (Normally Green)şW$FW.COLOR.RANGE<1,1> = 0           ;* FromşW$FW.COLOR.RANGE<2,1> = RANGE.BAD   ;* ToşW$FW.COLOR.RANGE<3,1> = COLOR$RED   ;* Override colorş* Second Color Range (Normally Yellow)şW$FW.COLOR.RANGE<1,2> = RANGE.BAD   ;* FromşW$FW.COLOR.RANGE<2,2> = RANGE.OK    ;* ToşW$FW.COLOR.RANGE<3,1> = COLOR$YELLOW;* Override colorş* Third Color Range (Normally Red)şW$FW.COLOR.RANGE<1,3> = RANGE.OK    ;* FromşW$FW.COLOR.RANGE<2,3> = RANGE.GOOD  ;* ToşW$FW.COLOR.RANGE<3,3> = COLOR$GREEN ;* Override colorş*ş* Main Dial ValueşW$FW.DIAL.VALUES<1> = SALES.CY      ;* Your actual valueş*ş* Trendpoints (optional)ş* By default, there are no trendpoints on the gauge.ş*ş* First TrendpointşW$FW.TRENDPOINT.VALUES<1,1> = SALES.LYşW$FW.TRENDPOINT.LABELS<1,1> = "Last Year"şW$FW.TRENDPOINT.OPTS<1,1> = 'color="':COLOR$BLACK:'" useMarker="1"'ş* Second TrendpointşW$FW.TRENDPOINT.VALUES<1,2> = SLS.GOALşW$FW.TRENDPOINT.LABELS<1,2> = "Goal"şW$FW.TRENDPOINT.OPTS<1,2> = 'color="':COLOR$SILVER:'" useMarker="1"'ş*ş* Plot an arc (optional) şW$FW.TRENDPOINT.VALUES<2,1> = SALES.LY ;* Arc beginşW$FW.TRENDPOINT.VALUES<2,2> = SALES.CY ;* Arc endş*ş* Configure tickmarks (optional)ş* Below are default values. Leaving this code out would make no differenceş* but this is here in case you want to modify the defaultsş*şW$FW.TICKMARKS<1> = 1 ;* Display tickmarksşW$FW.TICKMARKS<2> = 1 ;* Display values by tickmarksşW$FW.TICKMARKS<3> = "B" ;* Show tickmarks below the graphşW$FW.TICKMARKS<4> = "" ;* # of Major Tickmarks (blank = Let it calculate this)şW$FW.TICKMARKS<5> = "" ;* # of Minor Tickmarks between Majors (none)ş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN00001DFCMSCOLUMN2Dş0c2USE FCMSBAR2D000016VBULLETş0c2USE HBULLET000022FCSTACKEDCOLUMN2Dş0c2USE FCMSBAR2D000009GANTTş0c20003E6SPARKCOLUMNş0c2* Copyright (C) information here if relevantş* Any other descriptive comments hereş* and hereş*şW$TITLE = "YOUR TITLE HERE"     ;* Title for widget title barşW$TYPE = "%TYPE%"               ;* Filled in by editorşW$WIDTH = 3                     ;* Full width (1=1/3, 2=2/3, 3=3/3)ş*şIF G$QUERYMODE THEN RETURNş*ş*** Extract data from GLOBAL, WIDGET variables hereş*ş*** Open files hereş*ş*** Create one one-attribute, value-separated array here.ş*   Example:ş*     TERRSALES: Each value is a single territory's sales for the monthş*     then you can load the widget's values like:ş*       W$FW.VALUES = TERRSALESş*     rather than loading them a value at a time as shownş*     in the "FOR N = 1 TO 12" loop below.ş*şW$FW.CAPTION = "YOUR CHART CAPTION HERE"şW$FW.SUBCAPTION = "YOUR CHART SUBCAPTION HERE"ş*şFOR N = 1 TO 12ş  W$FW.VALUES<1,N> = N ;* ValueşNEXT Nş*ş*** Load any relevant data into GLOBAL, WIDGET variables hereş*   as needed for subsequent use by other widgetsş*şRETURN000015PYRAMIDş0c2USE FUNNEL000010BULBş0c2USE HLED00001FFCSTACKEDBAR2Dş0c2USE FCMSBAR2D00005CDICT_MVDB.WIDGETSş0c000001FSUBş0c1Aş1şSUBROUTINEşşşşşşLş2500001CUSERSş0c1Aş2şUSERSşşşşşşLş2000F39EWREST.BPş0c000023CWSWAPş0c2SUBROUTINE WSWAP(string,SUB1,SUB2)ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2016ş* Description  : This subroutine swaps one string for anotherş*              ş**********************************************************************şIDX.POS = 1şLOOPş  POS = INDEX(string, SUB1, IDX.POS)şWHILE POS DOş  string = string[1,POS-1]:SUB2:string[POS+LEN(SUB1),LEN(string)]ş  IDX.POS = IDX.POS + COUNT(SUB2,SUB1)şREPEATşRETURNşEND00020DWGETINFOş0c2SUBROUTINE WGETINFO(InfoVal, InfoItem)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Peter Schellenbach, Zumasysş* Date: March 2017ş* Description: return an element from WWW.INFOş*ş**********************************************************************şINCLUDE WWW.INCLUDEşIF NUM(InfoItem) AND InfoItem > 0 AND InfoItem <= 50 THENş IF INT(InfoItem) = InfoItem THENş  InfoVal = WWW.INFO(InfoItem)ş ENDşENDşRETURNşEND0005BFWENCODEJSONş0c2SUBROUTINE WENCODEJSON(ORIG.OPTION,IN.STR,OUT.STR)ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: 8/13/2016ş* Description: this program will convert all bad characters to an escaped characterş*ş**********************************************************************ş*OPEN 'RESULT.FILE' TO RFILE ELSE STOPş* WE NEED TO ENCODEş* " = \"   (34)ş* \ = \\    (92)ş* / = \/ş* CHAR(7) = \bş* CHAR(13) = \rş* char(10) = \nş* char(12) = \fş* char(9)  = \tş*WRITE IN.STR ON RFILE, 'IN.STR'şOPTION=ORIG.OPTIONşOUT.STR=''şL=LEN(IN.STR)şCONVERT @AM TO CHAR(10) IN IN.STR; * LETS SWITCH 254 TO CR BE DEFAULTşFOR X=1 TO Lş  C=IN.STR[X,1]ş  SEQ.C=SEQ(C)ş  ENCODE=0ş  IF SEQ.C < 32 THEN ENCODE=1; * BELOW SPACEş*IF SEQ.C > 32 AND SEQ.C < 48 THEN ENCODE=1; * LETS ENCODE ALL OF THIS !@$%^&*()ş  IF SEQ.C=34 THEN ENCODE=1ş  IF SEQ.C=92 THEN ENCODE=1ş  IF SEQ.C=47 THEN ENCODE=1ş  IF SEQ.C > 122 THEN ENCODE = 1; * LETS ENCODE ALL THE HIGH ENTRIESş*IF SEQ.C >= 91 AND SEQ.C <= 96 THEN ENCODE=1ş  IF ENCODE THENş    BEGIN CASEş      CASE SEQ.C=7; OUT.STR='\b'ş      CASE C='\'; OUT.STR:='\\'ş      CASE C='/'; OUT.STR:='\/'ş      CASE SEQ.C=10; OUT.STR:='\n'ş      CASE SEQ.C=13; OUT.STR:='\r'ş      CASE SEQ.C=12; OUT.STR:='\f'ş      CASE 1;  OUT.STR:='\u00':OCONV(C,'MX0C');*UV*ş    END CASEş  END ELSEş    OUT.STR=OUT.STR:Cş  ENDşNEXT XşRETURNşEND000230WGETCOOKIEş0c2SUBROUTINE WGETCOOKIE(VarValue, VarName)ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2016ş* Description  : This subroutine gets the value of a cookie.ş*              ş**********************************************************************şINCLUDE WWW.INCLUDEşVarValue = ''şTEMPVARS = OCONV(CGI$CVARS,'MCU')şLOCATE OCONV(VarName,'MCU') IN TEMPVARS SETTING POS THENş  VarValue = CGI$CVALS<POS>şENDşRETURNşEND0058A2WDEBUGş0c2* WDEBUGş*ş* Debug REST Servicesş* Copyright (c) 2017 Zumasys Inc.ş* Rewritten by Peter Schellenbach, 10/18/2017ş*ş* Based on original version:ş*  Copyright (C) 2007 Sierra Bravo Corporation, All Rights Reservedş*  Written by: Luke Bucklin, Sierra Bravoş*  Date: Sometime, 2006-ishş*ş$OPTIONS TIME.MILLISECOND ;*UV*ş*şINCLUDE WWW.INCLUDEşINCLUDE FI.WDB.DEBUGş*şCLR.SCR = @(-1)şCLR.EOS = @(-3)şMAX.LINES = SYSTEM(3) - 4şMAX.COLS = SYSTEM(2) - 1şIF MAX.LINES <= 0 OR CLR.SCR = '' OR CLR.EOS = '' THENş  MAX.LINES = 20ş  CLR.SCR = ''ş  CLR.EOS = ''ş  PRMPT.LINE = CHAR(13):CHAR(10)şEND ELSEş  PRMPT.LINE = @(0, MAX.LINES + 2):CLR.EOSşENDşPROMPT ''ş*şPRINT CLR.SCR:şPRINTşPRINT 'WDEBUG Web Request Degug Tool'şPRINTşPRINT 'The WDEBUG tool allows you to inspect, modify and re-run web requests.'şPRINT 'Whenever a request for a debuggable resource is processed by WDB.INIT,'şPRINT 'a debug record for the request is added to the WDB.DEBUG file. WDEBUG'şPRINT 'allows you to select a debug record, view the request details, edit the'şPRINT 'request variables, re-run the request and view the response.'şPRINTşPRINT 'To debug web requests for a resource, set attribute 7 of the WDB.RESOURCE'şPRINT 'record for the resource to 1, then issue the web request from the client'şPRINT 'browser or other agent. WDEBUG will show a list of recent web requests to'şPRINT 'select from.'şPRINTşPRINT 'Start WDEBUG with an active select list if you need to use special criteria'şPRINT 'to select the record(s) you need to debug.'şPRINTşPRINT 'Press <enter> to continue':şINPUT ANSş*şOPEN 'WDB.DEBUG' TO F.WDB.DEBUG ELSEş  PRINT 'The WDB.DEBUG data file is required to use WDEBUG. Default installations'ş  PRINT 'only create the dictionary for this file. Please create the data section'ş  PRINT 'to use WDEBUG: CREATE-FILE DATA WDB.DEBUG 101.'ş  STOPşENDş*şSESSION.FLAG = 0şOPEN 'WEB.SESSION' TO F.WEB.SESSION THEN SESSION.FLAG = 1 ;* can restore session when running debug reqestş*şEDITOR = ''şIDS = ''şNUM.IDS = 0şIF SYSTEM(11) THENş  LOOPş    READNEXT ID ELSE EXITş    READV X FROM F.WDB.DEBUG, ID, 1 THENş      IDS<-1> = IDş      NUM.IDS += 1ş    END ELSEş      PRINT ID:' not found in WDB.DEBUG!'ş    ENDş  REPEATşENDşUSE.SUPPLIED.LIST = (NUM.IDS > 0)ş*şLOOPş  IF NOT(USE.SUPPLIED.LIST) THENş* Select available WDB.DEBUG itemsş    CMND = 'SSELECT WDB.DEBUG WITH TYPE = "C" "R" BY-DSND DATE BY-DSND TIME'ş    EXECUTE CMND CAPTURING RESULTş    IF SYSTEM(11) = 0 THENş      PRINT "No items found."ş      STOPş    ENDş    IDS = ''ş    NUM.IDS = 0ş    LOOPş      READNEXT ID ELSE EXITş      IDS<-1> = IDş      NUM.IDS += 1ş    REPEATş  ENDş*ş  TOP = 0ş  LOOPş* Display page of itemsş    PRINT CLR.SCR:ş    PRINT "Ln Date. Time.... Path................ Remote Address...... Request ID........."ş    FOR CNTR = 1 TO MAX.LINES UNTIL CNTR + TOP > NUM.IDSş      DBG.ID = IDS<CNTR>ş      READ DBGREC FROM F.WDB.DEBUG, DBG.ID ELSE CONTINUEş      PATH.INFO = DBGREC<WDBG_PATH>ş      IF PATH.INFO = '' THEN PATH.INFO = DBGREC<WDBG_HANDLER>:'/':DBGREC<WDBG_RESOURCE>ş      PRINT CNTR "R#2 ":ş      PRINT OCONV(DBGREC<WDBG_DATE>, 'D0-') "L#5 ":ş      PRINT OCONV(DBGREC<WDBG_TIME>, 'MTS') "L#8 ":ş      PRINT PATH.INFO "L#20 ":ş      PRINT DBGREC<WDBG_REMOTE_ADDR> "L#20 ":ş      PRINT DBGREC<WDBG_REQUEST_ID>[1,20]ş    NEXT CNTRş    IF TOP + MAX.LINES > NUM.IDS THEN BOT = NUM.IDS ELSE BOT = TOP + MAX.LINESş    PRINT "Showing items ":(TOP + 1):"-":BOT:" of ":NUM.IDSş*ş    LOOPş      PRINT PRMPT.LINE:"Command: (Q)uit (R)efresh (C)lear (N)ext (P)rev (##) Line to debug: ":ş      INPUT COMMANDş      IF COMMAND MATCHES '1N0N' THENş        IF COMMAND >= 1 AND COMMAND <= MAX.LINES AND COMMAND + TOP <= NUM.IDS THENş          DBG.ID = IDS<COMMAND + TOP>ş          GOSUB debug.requestş        ENDş        COMMAND = ''ş      END ELSEş        COMMAND = OCONV(COMMAND[1,1], 'MCU')ş        IF COMMAND = '' THEN COMMAND = 'N'ş        IF INDEX('ERCNPQ', COMMAND, 1) = 0 THEN COMMAND = ''ş      ENDş    WHILE COMMAND = '' DO REPEATş*ş    BEGIN CASEş      CASE COMMAND = 'N'ş        IF TOP + MAX.LINES < NUM.IDS THEN TOP += MAX.LINESş      CASE COMMAND = 'P'ş        IF TOP - MAX.LINES >= 0 THEN TOP -= MAX.LINESş    END CASEş  WHILE COMMAND = 'N' OR COMMAND = 'P' DO REPEATş*şUNTIL COMMAND = 'Q' DOş  BEGIN CASEş    CASE COMMAND = 'R' ; NULLş    CASE COMMAND = 'C'ş      EXECUTE 'SELECT WDB.DEBUG WITH TYPE = "C" "R"'ş      PRINT 'Are you sure you want to clear these items from the WDB.DEBUG file? ':ş      INPUT ANSş      ANS = OCONV(ANS[1,1],'MCU')ş      IF ANS = 'Y' THENş        IF SYSTEM(11) THENş          LOOPş            READNEXT ID ELSE EXITş            DELETE F.WDB.DEBUG, IDş          REPEATş        ENDş      END ELSEş        CLEARSELECTş      ENDş  END CASEşREPEATşSTOPş*ş*----------şdebug.request:ş*----------ş*şREAD DBGREC FROM F.WDB.DEBUG, DBG.ID ELSEş  PRINT "The selected item '":DBG.ID:"' is not available!"ş  PRINTş  PRINT 'Press <enter> to continue':ş  INPUT ANSş  RETURNşENDşEDIT.ID = 'D':DBG.ID[2, LEN(DBG.ID)]şLOOPş  PRINT PRMPT.LINE:"Debugging ":DBG.ID[1,28]:" - command: (Q)uit (V)iew (E)dit (R)un: ":ş  INPUT COMMANDş  COMMAND = OCONV(COMMAND[1,1], 'MCU')şUNTIL COMMAND = 'Q' DOş  BEGIN CASEş    CASE COMMAND = 'V'ş      GOSUB view.requestş    CASE COMMAND = 'E'ş      GOSUB edit.requestş    CASE COMMAND = 'R'ş      GOSUB run.requestş  END CASEşREPEATşRETURNş*ş*----------şview.request:ş*----------ş*şIF DBGREC = '' THENş  PRINT 'No debug info is available for this request!'ş  PRINTş  PRINT 'Press <enter> to continue':ş  INPUT ANSş  RETURNşENDşGOSUB to.editşNUM.LNS = DCOUNT(EDIT.REC, @AM)şI = 1şLOOP WHILE I <= NUM.LNS DOş  X = EDIT.REC<I>ş  IF LEN(X) > MAX.COLS THENş    X = FOLD(X, MAX.COLS)ş    EDIT.REC<I> = Xş    N = COUNT(X, @AM)ş    NUM.LNS += Nş    I += Nş  ENDş  I += 1şREPEATşIF NUM.LNS = 0 THEN NUM.LNS = 1şNUM.PGS = INT((NUM.LNS - 1) / MAX.LINES) + 1şCUR.PG = 1şLOOPş  PG.TOP = (CUR.PG - 1) * MAX.LINESş  IF PG.TOP + MAX.LINES > NUM.LNS THEN LPP = NUM.LNS - PG.TOP ELSE LPP = MAX.LINESş  PRINT CLR.SCR:ş  PRINT 'Page ':CUR.PG:' of ':NUM.PGS:SPACE(10):DBG.IDş  PRINTş  FOR I = 1 TO LPPş    PRINT EDIT.REC<I + PG.TOP>ş  NEXT Iş  PRINT PRMPT.LINE:'Command: (Q)uit (N)ext (P)rev (##) Goto page ':ş  INPUT COMMANDş  IF COMMAND MATCHES '1N0N' THENş    IF COMMAND >= 1 AND COMMAND <= NUM.PGS THEN CUR.PG = COMMANDş  END ELSEş    COMMAND = OCONV(COMMAND[1,1], 'MCU')ş  ENDşUNTIL COMMAND = 'Q' DOş  BEGIN CASEş    CASE COMMAND = 'N' OR COMMAND = ''ş      IF CUR.PG < NUM.PGS THEN CUR.PG = CUR.PG + 1ş    CASE COMMAND = 'P'ş      IF CUR.PG > 1 THEN CUR.PG = CUR.PG - 1ş  END CASEşREPEATşRETURNş*ş*----------şedit.request:ş*----------ş*şIF EDITOR = '' THEN GOSUB choose.editorşIF EDITOR <> '' THENş  EDIT.ID = 'D':DBG.IDş  GOSUB to.editş  WRITE EDIT.REC ON F.WDB.DEBUG, EDIT.IDş  CMND = EDITOR:' WDB.DEBUG ':EDIT.IDş  EXECUTE CMNDş  READ EDIT.REC FROM F.WDB.DEBUG, EDIT.ID ELSE NULLş  DELETE F.WDB.DEBUG, EDIT.IDş  GOSUB from.editşENDşRETURNş*ş*----------şrun.request:ş*----------ş*şIF DBGREC = '' THENş  PRINT 'No debug info is available for this request!'ş  PRINTş  PRINT 'Press <enter> to continue':ş  INPUT ANSş  RETURNşENDş*şHANDLER.NAME = DBGREC<WDBG_HANDLER>şRESOURCE.NAME = DBGREC<WDBG_RESOURCE>ş* Reconstruct query stringşQSTR = ''şQSEP = ''ş* headers and server variablesşN = DCOUNT(DBGREC<WDBG_HEADER_VARS>, @VM)şFOR I = 1 TO Nş  HDR.VAR = DBGREC<WDBG_HEADER_VARS, I>ş  URLENCODE.STRING = DBGREC<WDBG_HEADER_VALS, I>ş  GOSUB url.encodeş  QSTR := QSEP:HDR.VAR:'=':NEW.STRINGş  QSEP = '&'şNEXT Iş* form variablesşN = DCOUNT(DBGREC<WDBG_CGI_VARS>, @VM)şFOR I = 1 TO Nş  HDR.VAR = DBGREC<WDBG_CGI_VARS, I>ş  URLENCODE.STRING = DBGREC<WDBG_CGI_VALS, I>ş  GOSUB url.encodeş  QSTR := QSEP:HDR.VAR:'=':NEW.STRINGş  QSEP = '&'şNEXT Iş* bodyşTHE.BODY = DBGREC<WDBG_BODY>şIF THE.BODY <> '' THENş  URLENCODE.STRING = CHANGE(THE.BODY, @VM, CHAR(10))ş  GOSUB url.encodeş  QSTR := QSEP:'__body__=':NEW.STRINGşENDş* restore session stateşIF SESSION.FLAG THENş  SESSION.ID = DBGREC<WDBG_SESSION_ID>ş  IF SESSION.ID <> '' THENş    SESSION.REC = ''ş    SESSION.REC<1> = DBGREC<WDBG_SESSION_VARS>ş    SESSION.REC<2> = DBGREC<WDBG_SESSION_VALS>ş    SESSION.REC<3> = DBGREC<WDBG_SESSION_DATE>ş    SESSION.REC<4> = DBGREC<WDBG_SESSION_TIME>ş    WRITE SESSION.REC ON F.WEB.SESSION, SESSION.IDş  ENDşENDş* break the query string into 1000 byte chunksşN = INT((LEN(QSTR) - 1) / 1000) + 1ş* build the command lineşRUN.ID = DBGREC<WDBG_REQUEST_ID>şCMND = 'WDB.INIT ':HANDLER.NAME:'/':RESOURCE.NAME:' ':RUN.ID:'-1-':N:' %% _WDEBUG_MODE_'ş*ş* run the commandşPRINTşPRINT 'Executing the request: ':CMNDşPRINTşMAT WWW.INFO = ""şEXECSTART = SYSTEM(12)ş* send query string as stacked inputşFOR I = 1 TO Nş  DATA QSTR[((I - 1) * 1000) + 1, 1000]şNEXT IşEXECUTE CMND CAPTURING RESPONSEşEXECDUR = SYSTEM(12) - EXECSTARTşPRINT 'Request complete. Press <enter> to parse results':şINPUT ANSş*ş* update the request runtimeşDBGREC<WDBG_DATE> = DATE()şDBGREC<WDBG_TIME> = TIME()şDBGREC<WDBG_DURATION> = EXECDURş* process the responseşLINT.BEFORE = ''şLINT.AFTER = ''şWARN = ''şERR = ''ş* Gather lint from before the start tag and after the complete tagşDBGREC<WDBG_WARNING> = '' ;* WarningsşDBGREC<WDBG_ERROR> = '' ;* ErrorsşDBGREC<WDBG_LINT> = '' ;* LintşIF RESPONSE<1> = "700 WDB-START" THENş  RESPONSE = DELETE(RESPONSE, 1)şEND ELSEş  TAG = @AM:"700 WDB-START":@AMş  TAG.POS = INDEX(RESPONSE, TAG, 1)ş  IF TAG.POS = 0 THENş    WARN = '700 WDB-START tag is missing from response'ş    LINT.BEFORE = RESPONSEş    RESPONSE = ''ş  END ELSEş    IF TAG.POS >= 1 THENş      LINT.BEFORE = RESPONSE[1, TAG.POS - 1]ş      RESPONSE = RESPONSE[TAG.POS + LEN(TAG), LEN(RESPONSE)]ş    ENDş  ENDşENDşN = DCOUNT(RESPONSE, @AM)şIF RESPONSE<N> = "800 WDB-COMPLETE" THENş  RESPONSE = DELETE(RESPONSE, N)şEND ELSEş  TAG = @AM:"800 WDB-COMPLETE":@AMş  TAG.POS = INDEX(RESPONSE, TAG, 1)ş  IF TAG.POS = 0 THENş    WARN = '800 WDB-COMPLETE tag missing from response!'ş  END ELSEş    LINT.AFTER = RESPONSE[TAG.POS + LEN(TAG), LEN(RESPONSE)]ş    RESPONSE = RESPONSE[1, TAG.POS - 1]ş  ENDşENDş* Clean up lintşIF TRIM(CHANGE(LINT.BEFORE, @AM, '')) = '' THEN LINT.BEFORE = ''şIF TRIM(CHANGE(LINT.AFTER, @AM, '')) = '' THEN LINT.AFTER = ''şIF LINT.BEFORE <> '' OR LINT.AFTER <> '' THENş  LINT = LINT.BEFOREş  IF LINT.BEFORE <> '' AND LINT.AFTER <> '' THEN LINT := @AM:'...':@AMş  LINT := LINT.AFTERş  DBGREC<WDBG_LINT> = LOWER(LINT)şENDş* Parse the response headersşDBGREC<WDBG_RESPONSE_VARS> = ''şDBGREC<WDBG_RESPONSE_VALS> = ''şDBGREC<WDBG_RESPONSE_CONTENT> = ''şNUM.VARS = 0şSTATUS.CODE = ''şEOH = INDEX(RESPONSE, @AM:@AM, 1) ;* headers end at first blank line in responseşIF EOH = 0 THEN EOH = LEN(RESPONSE) + 1şN = DCOUNT(RESPONSE[1, EOH - 1], @AM)şFOR I = 1 TO Nş  HDR.LINE = RESPONSE<I>ş  IF HDR.LINE[1,10] = '500 ERROR ' THENş    ERR = HDR.LINE[11, LEN(HDR.LINE)]ş    IF STATUS.CODE = '' THEN STATUS.CODE = 500ş  END ELSEş    HDR.VAR = FIELD(HDR.LINE, ':', 1)ş    HDR.VAL = TRIMF(HDR.LINE[COL2() + 1, LEN(HDR.LINE)])ş    M = LEN(HDR.VAR)ş    FOR J = 1 TO Mş      IF NOT(HDR.VAR[J,1] MATCHES '1A') AND HDR.VAR[J,1] <> '-' THENş        HDR.VAR = ''ş        EXITş      ENDş    NEXT Jş    IF HDR.LINE[LEN(HDR.VAR) + 1, 1] <> ':' THEN HDR.VAR = ''ş    IF HDR.VAR = '' THENş      NUM.VARS += 1ş      DBGREC<WDBG_RESPONSE_VARS, NUM.VARS> = '_BAD_'ş      DBGREC<WDBG_RESPONSE_VALS, NUM.VARS> = HDR.LINE ;* invalid header line!ş    END ELSEş      IF HDR.VAR = 'X-MVDB-STATUS' THENş        STATUS.CODE = HDR.VALş      END ELSEş        NUM.VARS += 1ş        DBGREC<WDBG_RESPONSE_VARS, NUM.VARS> = HDR.VARş        DBGREC<WDBG_RESPONSE_VALS, NUM.VARS> = HDR.VALş      ENDş    ENDş  ENDşNEXT IşIF STATUS.CODE = '' THEN STATUS.CODE = 200şDBGREC<WDBG_STATUS> = STATUS.CODEş* save response contentşIF EOH + 2 <= LEN(RESPONSE) THENş  DBGREC<WDBG_RESPONSE_CONTENT> = LOWER(RESPONSE[EOH + 2, LEN(RESPONSE)])şENDşDBGREC<WDBG_WARNING> = WARNşDBGREC<WDBG_ERROR> = ERRşRETURNş*ş*----------şto.edit:ş*----------ş*şEDIT.REC = ''şEDIT.REC<-1> = '[INFO] (do not edit this section)'şEDIT.REC<-1> = 'Date            = ':OCONV(DBGREC<WDBG_DATE>,'D4')şEDIT.REC<-1> = 'Time            = ':OCONV(DBGREC<WDBG_TIME>,'MTS')şEDIT.REC<-1> = 'Duration        = ':DBGREC<WDBG_DURATION>şEDIT.REC<-1> = 'Port            = ':DBGREC<WDBG_PORT>şEDIT.REC<-1> = 'Handler         = ':DBGREC<WDBG_HANDLER>şEDIT.REC<-1> = 'Resource        = ':DBGREC<WDBG_RESOURCE>şEDIT.REC<-1> = 'Controller      = ':DBGREC<WDBG_CONTROLLER>şEDIT.REC<-1> = 'Program         = ':DBGREC<WDBG_PROGRAM>şEDIT.REC<-1> = 'RequestID       = ':DBGREC<WDBG_REQUEST_ID>şEDIT.REC<-1> = 'Method          = ':DBGREC<WDBG_METHOD>şEDIT.REC<-1> = 'Path            = ':DBGREC<WDBG_PATH>şEDIT.REC<-1> = 'RemoteAddr      = ':DBGREC<WDBG_REMOTE_ADDR>şEDIT.REC<-1> = 'Status          = ':DBGREC<WDBG_STATUS>şIF DBGREC<WDBG_WARNING> <> '' THENş  EDIT.REC<-1> = 'WARNING: ':DBGREC<WDBG_WARNING>şENDşIF DBGREC<WDBG_ERROR> <> '' THENş  EDIT.REC<-1> = 'ERROR: ':DBGREC<WDBG_ERROR>şENDşIF DBGREC<WDBG_LINT> <> '' THENş  EDIT.REC<-1> = 'LINT:':@AM:RAISE(DBGREC<WDBG_LINT>)şENDş* Request headers and server variablesşEDIT.REC<-1> = @AM:'[HEADERS]'şN = DCOUNT(DBGREC<WDBG_HEADER_VARS>, @VM)şFOR I = 1 TO Nş  HDR.VAR = DBGREC<WDBG_HEADER_VARS, I>ş  HDR.VAL = DBGREC<WDBG_HEADER_VALS, I>ş  EDIT.REC<-1> = HDR.VAR:SPACE(16-LEN(HDR.VAR)):'= ':HDR.VALşNEXT Iş* Query string variablesşN = DCOUNT(DBGREC<WDBG_CGI_VARS>, @VM)şIF N > 0 THENş  EDIT.REC<-1> = @AM:'[VARS]'ş  FOR I = 1 TO Nş    CGI.VAR = DBGREC<WDBG_CGI_VARS, I>ş    CGI.VAL = DBGREC<WDBG_CGI_VALS, I>ş    EDIT.REC<-1> = CGI.VAR:SPACE(16-LEN(CGI.VAR)):'= ':CGI.VALş  NEXT IşENDş* CookiesşLOCATE 'HTTP_COOKIE' IN DBGREC<WDBG_HEADER_VARS> SETTING POS THENş  CSTRING = DBGREC<WDBG_HEADER_VALS, POS>şEND ELSE CSTRING = ''şCONVERT ';' TO @AM IN CSTRINGşN = DCOUNT(CSTRING, @AM)şIF N > 0 THENş  EDIT.REC<-1> = @AM:'[COOKIES]'ş  FOR I = 1 TO Nş    COOKIE.VAR = TRIM(FIELD(CSTRING<I>, '=', 1))ş    COOKIE.VAL = CSTRING<I>[COL2() + 1, 99999]ş    EDIT.REC<-1> = COOKIE.VAR:SPACE(16-LEN(COOKIE.VAR)):'= ':COOKIE.VALş  NEXT IşENDş* REST parametersşLOCATE 'PATH_INFO' IN DBGREC<WDBG_HEADER_VARS> SETTING POS THENş  PATH = DBGREC<WDBG_HEADER_VALS, POS>şEND ELSE PATH = ''şIF PATH[1,1] = '/' THEN PATH = PATH[2,9999]şN = DCOUNT(PATH, '/')şIF N > 0 THENş  EDIT.REC<-1> = @AM:'[PARAMS]'ş  FOR I = 3 TO Nş    PARAM.VAR = 'Param[':(I-2):']'ş    EDIT.REC<-1> = PARAM.VAR:SPACE(16-LEN(PARAM.VAR)):'= ':FIELD(PATH, '/', I)ş  NEXT IşENDş* Session variablesşIF SESSION.FLAG THENş  SESSION.ID = DBGREC<WDBG_SESSION_ID>ş  IF SESSION.ID <> '' THENş    N = DCOUNT(DBGREC<WDBG_SESSION_VARS>, @VM)ş    IF N > 0 THENş      EDIT.REC<-1> = @AM:'[SESSION]'ş      EDIT.REC<-1> = '_SessionID      = ':SESSION.IDş      IF DBGREC<WDBG_SESSION_DATE> <> '' THEN EDIT.REC<-1> = '_Date           = ':OCONV(DBGREC<20>, 'D4')ş      IF DBGREC<WDBG_SESSION_TIME> <> '' THEN EDIT.REC<-1> = '_Time           = ':OCONV(DBGREC<21>, 'MTS')ş      FOR I = 1 TO Nş        SESSION.VAR = DBGREC<WDBG_SESSION_VARS, I>ş        EDIT.REC<-1> = SESSION.VAR:SPACE(16-LEN(SESSION.VAR)):'= ':DBGREC<WDBG_SESSION_VALS, I>ş      NEXT Iş    ENDş  ENDşENDş* Request bodyşTHE.BODY = DBGREC<WDBG_BODY>şIF THE.BODY <> '' THENş  EDIT.REC<-1> = @AM:'[BODY]':@AM:RAISE(THE.BODY)şENDş* Response headersşN = DCOUNT(DBGREC<WDBG_RESPONSE_VARS>, @VM)şIF N > 0 THENş  EDIT.REC<-1> = @AM:'[RESPONSE_HEADERS]'ş  FOR I = 1 TO Nş    HDR.VAR = DBGREC<WDBG_RESPONSE_VARS, I>ş    HDR.VAL = DBGREC<WDBG_RESPONSE_VALS, I>ş    EDIT.REC<-1> = HDR.VAR:SPACE(16-LEN(HDR.VAR)):'= ':HDR.VALş  NEXT IşENDş* Response contentşTHE.CONTENT = DBGREC<WDBG_RESPONSE_CONTENT>şIF THE.CONTENT <> '' THENş  EDIT.REC<-1> = @AM:'[RESPONSE_CONTENT]':@AM:RAISE(THE.CONTENT)şENDş*şRETURNş*ş*----------şfrom.edit:ş*----------ş*şSESSION.ID = ''şHANDLER.NAME = DBGREC<WDBG_HANDLER>şRESOURCE.NAME = DBGREC<WDBG_RESOURCE>ş* If COOKIES section exists, rebuild HTTP_COOKIE headerşCOOKIES = ''şSECT = 'COOKIES'şGOSUB find.sectionşIF SECT.START > 0 THENş  FOR I = SECT.START + 1 TO SECT.ENDş    COOKIE = EDIT.REC<I>ş    IF COOKIE <> '' THENş      COOKIE.NAME = TRIM(FIELD(COOKIE, '=', 1))ş      COOKIE.VAL = TRIMF(COOKIE[COL2() + 1, LEN(COOKIE)])ş      COOKIES := COOKIE.NAME:'=':COOKIE.VAL:';'ş      IF OCONV(COOKIE.NAME, 'MCU') = 'SESSIONID' THEN SESSION.ID = COOKIE.VALş    ENDş  NEXT Iş  IF COOKIES[LEN(COOKIES), 1] = ';' THEN COOKIES = COOKIES[1, LEN(COOKIES) - 1]şENDş* If PARAMS section exists, rebuild PATH_INFO headerşPARAMS = ''şSECT = 'PARAMS'şGOSUB find.sectionşIF SECT.START > 0 THENş  PNUM = 1ş  FOR I = SECT.START + 1 TO SECT.ENDş    PARAM = EDIT.REC<I>ş    IF PARAM <> '' THENş      PARAM.NAME = TRIM(OCONV(FIELD(PARAM, '=', 1), 'MCU'))ş      PARAM.VAL = TRIMF(PARAM[COL2() + 1, LEN(PARAM)])ş      IF PARAM.NAME <> 'PARAM[':PNUM:']' THEN EXITş      PARAMS := '/':PARAM.VALş      PNUM += 1ş    ENDş  NEXT Iş  IF PARAMS <> '' THEN PARAMS = '/':HANDLER.NAME:'/':RESOURCE.NAME:PARAMS ;* handler & resource come before paramsşENDş* Get headers and server variablesşDBGREC<WDBG_HEADER_VARS> = ''şDBGREC<WDBG_HEADER_VALS> = ''şNUM.VARS = 0şSECT = 'HEADERS'şGOSUB find.sectionşIF SECT.START > 0 THENş  FOR I = SECT.START + 1 TO SECT.ENDş    VAR.LINE = EDIT.REC<I>ş    IF VAR.LINE <> '' THENş      VAR.NAME = TRIM(FIELD(VAR.LINE, '=', 1))ş      VAR.VAL = TRIMF(VAR.LINE[COL2() + 1, LEN(VAR.LINE)])ş* check for special headersş      BEGIN CASEş        CASE OCONV(VAR.NAME, 'MCU') = 'HTTP_COOKIE'ş          IF COOKIES <> '' THENş            VAR.VAL = COOKIESş          ENDş        CASE OCONV(VAR.NAME, 'MCU') = 'PATH_INFO'ş          IF PARAMS <> '' THENş            VAR.VAL = PARAMSş          ENDş          IF VAR.VAL[1,1] <> '/' THEN VAR.VAL = '/' : VAR.VALş          IF COUNT(VAR.VAL, '/') >= 2 THENş            HANDLER.NAME = FIELD(VAR.VAL, '/', 2)ş            RESOURCE.NAME = FIELD(VAR.VAL, '/', 3)ş          ENDş          DBGREC<WDBG_PATH> = VAR.VALş        CASE OCONV(VAR.NAME, 'MCU') = 'REQUEST_METHOD'ş          DBGREC<WDBG_METHOD> = VAR.VAL      ş        CASE OCONV(VAR.NAME, 'MCU') = 'REMOTE_ADDR'ş          DBGREC<WDBG_REMOTE_ADDR> = VAR.VALş      END CASEş      NUM.VARS += 1ş      DBGREC<WDBG_HEADER_VARS, NUM.VARS> = VAR.NAMEş      DBGREC<WDBG_HEADER_VALS, NUM.VARS> = VAR.VALş    ENDş  NEXT Iş  DBGREC<WDBG_HANDLER> = HANDLER.NAMEş  DBGREC<WDBG_RESOURCE> = RESOURCE.NAMEşENDş* Get form variablesşDBGREC<WDBG_CGI_VARS> = ''şDBGREC<WDBG_CGI_VALS> = ''şNUM.VARS = 0şSECT = 'VARS'şGOSUB find.sectionşIF SECT.START > 0 THENş  FOR I = SECT.START + 1 TO SECT.ENDş    VAR.LINE = EDIT.REC<I>ş    IF VAR.LINE <> '' THENş      VAR.NAME = TRIM(FIELD(VAR.LINE, '=', 1))ş      VAR.VAL = TRIMF(VAR.LINE[COL2() + 1, LEN(VAR.LINE)])ş      NUM.VARS += 1ş      DBGREC<WDBG_CGI_VARS, NUM.VARS> = VAR.NAMEş      DBGREC<WDBG_CGI_VALS, NUM.VARS> = VAR.VALş    ENDş  NEXT IşENDş* Get bodyşDBGREC<WDBG_BODY> = ''şSECT = 'BODY'şGOSUB find.sectionşIF SECT.START > 0 THENş  I = INDEX(EDIT.REC, @AM, SECT.START)ş  IF I > 0 THENş    I += 1ş    J = INDEX(EDIT.REC, @AM, SECT.END)ş    IF J = 0 THEN J = LEN(EDIT.REC) + 1 ELSE J -= 1ş    IF EDIT.REC[J - 1, 1] = @AM AND J > 1 THEN J -= 1ş    THE.BODY = EDIT.REC[I, J - I + 1]ş    DBGREC<WDBG_BODY> = LOWER(THE.BODY)ş  ENDşENDş* Get session stateşIF SESSION.FLAG AND SESSION.ID <> '' THENş  DBGREC<WDBG_SESSION_ID> = ''ş  DBGREC<WDBG_SESSION_VARS> = ''ş  DBGREC<WDBG_SESSION_VALS> = ''ş  DBGREC<WDBG_SESSION_DATE> = ''ş  DBGREC<WDBG_SESSION_TIME> = ''ş  NUM.VARS = 0ş  SECT = 'SESSION'ş  GOSUB find.sectionş  IF SECT.START > 0 THENş    FOR I = SECT.START + 1 TO SECT.ENDş      SESSION.LINE = EDIT.REC<I>ş      SESSION.VAR = TRIM(FIELD(SESSION.LINE, '=', 1))ş      SESSION.VAL = TRIMF(SESSION.LINE[COL2() + 1, LEN(SESSION.LINE)])ş      BEGIN CASEş        CASE SESSION.VAR = '_SessionID'ş          DBGREC<WDBG_SESSION_ID> = SESSION.VALş        CASE SESSION.VAR = '_Date'ş          DBGREC<WDBG_SESSION_DATE> = ICONV(SESSION.VAL, 'D')ş        CASE SESSION.VAR = '_Time'ş          DBGREC<WDBG_SESSION_TIME> = ICONV(SESSION.VAL, 'MTS')ş        CASE 1ş          NUM.VARS += 1ş          DBGREC<WDBG_SESSION_VARS, NUM.VARS> = SESSION.VARş          DBGREC<WDBG_SESSION_VALS, NUM.VARS> = SESSION.VALş      END CASEş    NEXT Iş  ENDşENDş* Get response headersşDBGREC<WDBG_RESPONSE_VARS> = ''şDBGREC<WDBG_RESPONSE_VALS> = ''şNUM.VARS = 0şSECT = 'RESPONSE_HEADERS'şGOSUB find.sectionşIF SECT.START > 0 THENş  FOR I = SECT.START + 1 TO SECT.ENDş    VAR.LINE = EDIT.REC<I>ş    IF VAR.LINE <> '' THENş      VAR.NAME = TRIM(FIELD(VAR.LINE, '=', 1))ş      VAR.VAL = TRIMF(VAR.LINE[COL2() + 1, LEN(VAR.LINE)])ş      NUM.VARS += 1ş      DBGREC<WDBG_RESPONSE_VARS, NUM.VARS> = VAR.NAMEş      DBGREC<WDBG_RESPONSE_VALS, NUM.VARS> = VAR.VALş    ENDş  NEXT IşENDş* Get response contentşDBGREC<WDBG_RESPONSE_CONTENT> = ''şSECT = 'RESPONSE_CONTENT'şGOSUB find.sectionşIF SECT.START > 0 THENş  I = INDEX(EDIT.REC, @AM, SECT.START)ş  IF I > 0 THENş    I += 1ş    J = INDEX(EDIT.REC, @AM, SECT.END)ş    IF J = 0 THEN J = LEN(EDIT.REC) + 1 ELSE J -= 1ş    IF EDIT.REC[J - 1, 1] = @AM AND J > 1 THEN J -= 1ş    THE.CONTENT = EDIT.REC[I, J - I + 1]ş    DBGREC<WDBG_RESPONSE_CONTENT> = LOWER(THE.CONTENT)ş  ENDşENDşRETURNş*ş*----------şchoose.editor:ş*----------ş*şPRINTşLOOPş  PRINT 'Select the editor you want to use: 1 = ED, 2 = other: ':ş  INPUT ANSşUNTIL ANS EQ '' DOş  BEGIN CASEş    CASE ANS = 1ş      EDITOR = 'ED'ş      EXITş    CASE ANS = 2ş      PRINT 'Enter the verb to invoke your editor: ':ş      INPUT TMPş      PRINT TMP:' OK?':ş      INPUT ANSş      ANS = OCONV(ANS[1,1], 'MCU')ş      IF ANS = 'Y' THENş        EDITOR = TMPş        EXITş      ENDş  END CASEşREPEATşRETURNş*ş*----------şfind.section:ş*----------ş*şSECT.START = -1şSECT.END = -1şTAG = @AM:'[':SECT:']':@AMşTAG.POS = INDEX(EDIT.REC, TAG, 1)şIF TAG.POS = 0 THEN RETURN ;* Section not foundşSECT.START = DCOUNT(EDIT.REC[1, TAG.POS], @AM)şSECT.END = DCOUNT(EDIT.REC, @AM)şFOR I = SECT.START + 1 TO SECT.ENDş  SECT.LN = EDIT.REC<I>ş  IF SECT.LN MATCHES '"["1A0A"]"' OR SECT.LN MATCHES '"["1A0A"_"1A0A"]"' THENş* beginning of next section is end of current sectionş    SECT.END = I - 1ş    EXITş  ENDşNEXT IşRETURNş*ş*----------şurl.encode:ş*----------ş*şNEW.STRING = ""şUE.LEN = LEN(URLENCODE.STRING)şFOR UEX = 1 TO UE.LENş  UE.CHR = URLENCODE.STRING[UEX,1]ş  UE.CVAL = SEQ(UE.CHR)ş  BEGIN CASEş    CASE UE.CVAL < 32; ENC.FLAG = 1   ;* control characterş    CASE UE.CVAL = 37 OR UE.CVAL = 38 OR UE.CVAL = 43 OR UE.CVAL = 61; ENC.FLAG = 1 ;* % & + =ş    CASE UE.CVAL = 127; ENC.FLAG = 1  ;* DEL control characterş    CASE UE.CVAL >= 252; ENC.FLAG = 1 ;* delimiter characterş    CASE 1 ; ENC.FLAG = 0ş  END CASEş  IF ENC.FLAG THENş    UE.CHR = "%":(OCONV(UE.CVAL,'MCDX') 'R%2')ş  ENDş  NEW.STRING := UE.CHRşNEXT UEXşRETURNş*şEND000484FI.WDB.DEBUGş0c2*ş* WDB.DEBUG record layoutş*şEQU WDBG_DATE                TO 1şEQU WDBG_TIME                TO 2şEQU WDBG_DURATION            TO 3şEQU WDBG_PORT                TO 4şEQU WDBG_HANDLER             TO 5şEQU WDBG_RESOURCE            TO 6şEQU WDBG_CONTROLLER          TO 7şEQU WDBG_PROGRAM             TO 8şEQU WDBG_REQUEST_ID          TO 9şEQU WDBG_REQUEST             TO 10şEQU WDBG_METHOD              TO 11şEQU WDBG_PATH                TO 12şEQU WDBG_REMOTE_ADDR         TO 13şEQU WDBG_STATUS              TO 14şEQU WDBG_HEADER_VARS         TO 15şEQU WDBG_HEADER_VALS         TO 16şEQU WDBG_CGI_VARS            TO 17şEQU WDBG_CGI_VALS            TO 18şEQU WDBG_BODY                TO 19şEQU WDBG_RESPONSE_VARS       TO 20şEQU WDBG_RESPONSE_VALS       TO 21şEQU WDBG_RESPONSE_CONTENT    TO 22şEQU WDBG_RESERVED1           TO 23şEQU WDBG_RESERVED2           TO 24şEQU WDBG_SESSION_ID          TO 25şEQU WDBG_SESSION_VARS        TO 26şEQU WDBG_SESSION_VALS        TO 27şEQU WDBG_SESSION_DATE        TO 28şEQU WDBG_SESSION_TIME        TO 29şEQU WDBG_WARNING             TO 30şEQU WDBG_ERROR               TO 31şEQU WDBG_LINT                TO 320005EBWWW.INCLUDEş0c2*ş* Standard web includeş*şşCOMMON /WWW/ WWW.INFO(50), F.WEB.SESSIONşşEQU SESSION$ID               TO WWW.INFO(1)şEQU SESSION$CONTENT.TYPE     TO WWW.INFO(2)şEQU SESSION$CONTENT.SENT     TO WWW.INFO(3)şEQU SESSION$OUTBUF           TO WWW.INFO(4)şEQU SESSION$HEADERS          TO WWW.INFO(5)şEQU SESSION$COOKIES          TO WWW.INFO(6)şEQU SESSION$OUTBUF.SIZE      TO WWW.INFO(7)şEQU SESSION$OUTBUF.FLAG      TO WWW.INFO(8)şEQU SESSION$TIME.OUT         TO WWW.INFO(9)şEQU SESSION$GLOBAL.DEBUG     TO WWW.INFO(10)şEQU SESSION$STATUS.CODE      TO WWW.INFO(11)şEQU SESSION$WDEBUG.MODE      TO WWW.INFO(12)şEQU CONFIG$WDB.RESOURCE      TO WWW.INFO(15)şEQU CGI$VARS                 TO WWW.INFO(25)şEQU CGI$VALS                 TO WWW.INFO(26)şEQU CGI$CVARS                TO WWW.INFO(27)şEQU CGI$CVALS                TO WWW.INFO(28)şEQU CGI$SERVER.NAME          TO WWW.INFO(29)şEQU CGI$PATH                 TO WWW.INFO(30)şEQU CGI$SERVER.PORT          TO WWW.INFO(31)şEQU CGI$BODY                 TO WWW.INFO(32)şEQU CGI$HEADERVALS           TO WWW.INFO(33)şEQU CGI$HEADERVARS           TO WWW.INFO(34)şEQU CGI$RESTPARAMS           TO WWW.INFO(35)şEQU CGI$CONFIG               TO WWW.INFO(36)şEQU F.WEB.FORMS              TO WWW.INFO(40)şEQU CGI$APPSVR.ID            TO WWW.INFO(45)şEQU CGI$RESERVED1            TO WWW.INFO(46)şEQU CGI$RESERVED2            TO WWW.INFO(47)şEQU CGI$RESERVED3            TO WWW.INFO(48)şEQU CGI$UNIQUE.ID            TO WWW.INFO(49)şEQU CGI$RESOURCE.NAME        TO WWW.INFO(50)00020BWSETINFOş0c2SUBROUTINE WSETINFO(InfoVal, InfoItem)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Peter Schellenbach, Zumasysş* Date: November 2017ş* Description: set an element in WWW.INFOş*ş**********************************************************************şINCLUDE WWW.INCLUDEşIF NUM(InfoItem) AND InfoItem > 0 AND InfoItem <= 50 THENş IF INT(InfoItem) = InfoItem THENş  WWW.INFO(InfoItem) = InfoValş ENDşENDşRETURNşEND000418WSETCOOKIEş0c2SUBROUTINE WSETCOOKIE(COOKIENAME,COOKIEVAR,D,T,PATH,DOMAIN,SECURE)ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2016ş* Description  : This subroutine sets the value of a cookie.ş*              ş**********************************************************************şINCLUDE WWW.INCLUDEşCOOKIE = COOKIENAME:'=':COOKIEVARş* FIGURE OUT EXPIRATIONşIF D # '' THENş  EXPIRES='expires='ş  DAY=OCONV(D,'DWA')[1,3]ş  DAY=OCONV(DAY,'MCT')ş  EXPIRES:=DAYş  EXPIRES:=', 'ş  EXPIRES:=OCONV(D,'DD')ş  EXPIRES:=' 'ş  MONTH=OCONV(D,'DMA')[1,3]ş  MONTH=OCONV(MONTH,'MCT')ş  EXPIRES:=MONTHş  EXPIRES:=' 'ş  EXPIRES:=OCONV(D,'DY')ş  EXPIRES:=' 'ş  EXPIRES:=OCONV(T,'MTS')ş  COOKIE:=';':EXPIRESşENDşIF PATH # '' THENş  COOKIE:=';path="':PATH:'"'şENDşIF DOMAIN # '' THENş  COOKIE:=';domain=':DOMAINşENDşIF SECURE # '' THENş  COOKIE:=';secure'şENDşIF TRIM(COOKIE) # '' THENş  SESSION$COOKIES<-1>=COOKIEşENDşRETURNşEND000228WGETHEADERş0c2SUBROUTINE WGETHEADER(VarValue, VarName)ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2016ş* Description: extract value of an HTTP request headerş*ş**********************************************************************şINCLUDE WWW.INCLUDEşVarValue = ''şTEMPVARS = OCONV(CGI$HEADERVARS, 'MCU')şLOCATE OCONV(VarName, 'MCU') IN TEMPVARS SETTING POS THENş  VarValue = CGI$HEADERVALS<POS>şENDşRETURNşEND000199WGETBODYş0c2SUBROUTINE WGETBODY(RequestBody)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Peter Schellenbach, Zumasysş* Date: March 2017ş* Description: return the BODY of the requestş*ş**********************************************************************şINCLUDE WWW.INCLUDEşRequestBody = CGI$BODYşRETURNşEND0001EEWFLUSHş0c2SUBROUTINE WFLUSHş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2016ş* Description  : This program calls WSETBUFFER(FALSE) then ş*                calls WSEND("")ş*              ş**********************************************************************şINCLUDE WWW.INCLUDEşEQU FALSE TO 0, TRUE TO 1ş*şCALL WSETBUFFER(FALSE)şCALL WSEND("")şRETURNşEND00295FWRESTTESTş0c2      PROGRAM WRESTTESTş      **********************************************************************ş      *ş      * Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş      *ş      * Written by: Patrick Payne, Zumasysş      * Date: 01/31/2017ş      * Description: this is a simple REST testş      *ş      **********************************************************************ş      INCLUDE WWW.INFOş      RESTVERSION = "2.0"ş      JSTATUS = 'ok'ş      JSTATUSMSG = ''şş      CALL MVDBTOOLKIT.WPLATFORM(PLATFORM.OBJ)ş      CALL WOBJ(PLATFORM.OBJ,"GET","mvtype",MVTYPE,"",RERR)ş      CALL WOBJ(PLATFORM.OBJ,"GET","platform",PLATFORM,"",RERR)şş      *ş      * Supplied function for setting content type.ş      *ş      CALL WSETCONTENTTYPE("application/json")ş      *ş      *ş      * Set a custom header with supplied function.ş      *ş      CALL WSETHEADER("restversion",RESTVERSION)ş      *ş      * Start building our json object, ugly way until objects.ş      *ş      CALL WOBJ(ROBJ,"FROMJSON","","{}","",RERR)şş      *ş      * Need to know all the variablesş      *ş      CALL WGETINFO(VARS,CGI_VARS)ş      CALL WGETINFO(VALS,CGI_VALS)ş      *ş      * Need to know all the headersş      *ş      CALL WGETINFO(HEADERVARS,CGI_HEADERVARS)ş      CALL WGETINFO(HEADERVALS,CGI_HEADERVALS)ş      *ş      * Set our rest version, this will be replaced in the future with objectsş      *ş      CALL WOBJ(ROBJ,"SET","RestVersion",RESTVERSION,"",RERR)şş      CALL WGETPARAM(REQKEY,1)şş      IF REQKEY # "" THENş         * Function to get our options already broken out.ş         *ş         CALL WGETCONFIG(APIKEY,'APIKEY')şş         IF OCONV(APIKEY,'MX') = OCONV(REQKEY,'MX') THENş            GOSUB processrestş         ENDş      ENDş      *ş      *ş      * WHOş      *ş      EXECUTE 'WHO' CAPTURING WRESULTş      CONVERT @AM TO '' IN WRESULTş      CONVERT @VM TO ' ' IN WRESULTş      CONVERT @SVM TO ' ' IN WRESULTş      CALL WOBJ(ROBJ,"SET","Who",WRESULT,"",RERR)ş      *ş      * HOSTNAMEş      *ş      *EXECUTE 'hostname' CAPTURING HOSTNAMEş      *CALL WBUILDJSON(JSON,'hostname',HOSTNAME<1,1,1>,RERR)ş      *ş      CALL WOBJ(EOBJ,"FROMJSON","","{}","",RERR)ş      CALL WOBJ(EOBJ,"SET","command","hostname","",RERR)ş      CALL MVDBTOOLKIT.WEXECUTE(EOBJ)ş      CALL WOBJ(EOBJ,"GET","result.result",HOSTNAME,"",RERR)şş      CALL WOBJ(ROBJ,"SET","hostname",HOSTNAME,"",RERR)şş      * IFCONFIGş      CALL WOBJ(ROBJ,"SET","mvtype",MVTYPE,"",RERR)ş      CALL WOBJ(ROBJ,"SET","platform",PLATFORM,"",RERR)şş      *ş      *EXECUTE 'ifconfig' CAPTURING RESULTş      *GOSUB exportresultş      *JSON:=', "ifconfig": ':Rş      *ş      * PWDş      *ş      CALL WOBJ(EOBJ,"FROMJSON","","{}","",RERR)ş      CALL WOBJ(EOBJ,"SET","command","pwd","",RERR)ş      CALL MVDBTOOLKIT.WEXECUTE(EOBJ)ş      CALL WOBJ(EOBJ,"GET","result.result",PWD,"",RERR)şş      CALL WOBJ(ROBJ,"SET","pwd",PWD,"",RERR)ş      *ş      * PSş      *ş      *ş      * JSHOWş      *şş      *EXECUTE 'jshow -v WRESTTEST' CAPTURING RESULTş      *GOSUB exportresultş      *JSON := ', "wresttest": ':Rş      *ş      * Build out varsş      *ş      CALL WOBJ(ROBJ,"SET.OBJECT","vars","{}","",RERR)şş      FOR X = 1 TO DCOUNT(VARS, @AM)ş         * Lets test our WGETVAR routineş         VARNAME = VARS<X>ş         *ş         * WGETVAR is our customer supplied function to get variablesş         * usually sent by browser as form variables, either in the bodyş         * or in the URL query string.ş         *ş         CALL WGETVAR(THISVAR,VARNAME)ş         CALL WOBJ(ROBJ,"SET","vars.":VARNAME,THISVAR,"",RERR)ş      NEXT Xş      *ş      * Here is our messy add, todo is to adjust WBUILDJSON to be ableş      * to do this.ş      *ş      *ş      * Get all our cookiesş      *ş      CALL WGETINFO(CVARS,CGI_CVARS)ş      CALL WGETINFO(CVALS,CGI_CVALS)şş      CALL WOBJ(ROBJ,"SET.OBJECT","cookies","{}","",RERR)şş      NUM_COOKIES = DCOUNT(CVARS,@AM)ş      FOR A = 1 TO NUM_COOKIESş         COOKIENAME = CVARS<A>ş         *ş         * This is our customer supplied function to get cookies.ş         *ş         CALL WGETCOOKIE(COOKIEVALUE,COOKIENAME)ş         CALL WOBJ(ROBJ,"SET","cookies.":COOKIENAME,COOKIEVALUE,"",RERR)ş      NEXT Aşş      *ş      * Build out headersş      *şş      CALL WOBJ(ROBJ,"SET.OBJECT","headers","{}","",RERR)ş      numheaders = DCOUNT(HEADERVARS, @AM)ş      FOR X = 1 TO numheadersş         HEADERNAME = HEADERVARS<X>ş         *ş         * This is our customer supplied function to get headers.ş         *ş         CALL WGETHEADER(THISVAR,HEADERNAME)ş         CALL WOBJ(ROBJ,"SET","headers.":HEADERNAME,THISVAR,"",RERR)ş      NEXT Xşş      *ş      * This is where the raw body is put, this is used primarily forş      * AJAX functions where the body should be a json string.ş      *ş      CALL WGETBODY(BODY)ş      CALL WOBJ(ROBJ,"SET","body",BODY,"",RERR)ş      *ş      * Set our test cookieş      *ş      COOKIE.NAME = 'wresttestcookie'ş      COOKIE.VALUE = TIMEDATE()ş      CONVERT ' :' TO '' IN COOKIE.VALUEş      *ş      * Our function for setting a cookie.  Hides all the formatting requirementsş      * and correctly sets expiration date/time using PICK dates and times.ş      *ş      * CALL WSETCOOKIE(NAME,VALUE,EXPDATE,EXPTIME,DOMAIN,PATH,SECURE)ş      *ş      CALL WSETCOOKIE(COOKIE.NAME,COOKIE.VALUE,DATE()+1,TIME()+300,'','','')şş      IF MVTYPE = "D3" THENş         EXECUTE "RUN DM,BP, MAXUSERS" CAPTURING ARRAY.VALUEş         ARRAY.NAME="maxusers"ş         GOSUB process.arrayş         EXECUTE "FREE" CAPTURING ARRAY.VALUEş         ARRAY.NAME="free"ş         GOSUB process.arrayş         ISFLASH=SYSTEM(36)ş         CALL WOBJ(ROBJ,"SET","d3flash",ISFLASH,"",RERR)ş      ENDşş şend.of.program: *ş      *ş      * Build our default status/resultş      *ş      CALL WOBJ(ROBJ,"SET","status",JSTATUS,"",RERR)ş      CALL WOBJ(ROBJ,"SET","statusmsg",JSTATUSMSG,"",RERR)şş      *ş      * Close out our objectş      *ş      CALL WOBJ(ROBJ,"TOJSON","",JSON,"PRETTIFY",RERR)ş      *ş      * Send string json to the client. This can be done anytime and multiple times.ş      *ş      CALL WSEND(JSON)ş      *ş      STOPş      *ş      şprocessrest: *ş      *ş      * Build new object to store rest responsesş      *ş      CALL WOBJ(POBJ,"FROMJSON","","{}","",RERR)ş      *ş      * Get our commandş      *ş      CALL WGETPARAM(COMMAND,2)ş      COMMAND = OCONV(COMMAND,'MCU')ş      *ş      * Respond in REST response our requested command, nice for debuggingş      *ş      CALL WOBJ(POBJ,"SET","requestedcommand",COMMAND,"",RERR)ş      *ş      * Now process our commandsş      *ş      BEGIN CASEş         CASE COMMAND = 'DEBUGON'ş            CALL WGETPARAM(DEBUGLINE,3)ş            IF DEBUGLINE = '' OR NOT(NUM(DEBUGLINE)) THENş               JSTATUS = 'error'ş               JSTATUSMSG = 'You must put in a debug option as next paramater'ş            END ELSEş               JSTATUSMSG = 'Setting debug to on for ':DEBUGLINEş               CALL WSETCOOKIE('wrestapidebug',DEBUGLINE,DATE()+1,TIME()+300,'','',' ')ş            ENDş         CASE COMMAND = 'DEBUGOFF'ş            CALL WSETCOOKIE('wrestapidebug','',DATE()-1,TIME(),'','','')ş         CASE COMMAND = 'ENV'ş            * Get environment variablesş            CALL WOBJ(EOBJ,"FROMJSON","","{}","",RERR)ş            IF PLATFORM="WINDOWS" THENş               CALL WOBJ(EOBJ,"SET","command","SET","",RERR)ş            END ELSEş               CALL WOBJ(EOBJ,"SET","command","env","",RERR)ş            ENDş            CALL MVDBTOOLKIT.WEXECUTE(EOBJ)ş            CALL WOBJ(EOBJ,"GET","result.result",ENVIRONMENT,"",RERR)ş            *ş            * New object to store responseş            *ş            CALL WOBJ(POBJ,"SET.OBJECT","environment","{}","",RERR)şş            NUMENV = DCOUNT(ENVIRONMENT,@AM)ş            FOR A = 1 TO NUMENVş               ENV = ENVIRONMENT<A>ş               ENV.NAME = FIELD(ENV,'=',1)ş               ENV.VALUE = FIELD(ENV,'=',2,9999)ş               IF TRIM(ENV.NAME) # '' THENş                  CALL WOBJ(POBJ,"SET","environment.":ENV.NAME,ENV.VALUE,"",RERR)ş               ENDş            NEXT Aş         CASE COMMAND = 'USERS'ş            IF MVTYPE="D3" OR MVTYPE="D3" THENş               EXECUTE 'LISTU' CAPTURING ARRAY.VALUEş               ARRAY.NAME="users"ş               GOSUB process.pobj.arrayş            ENDş         CASE COMMAND='JSHOW'ş             CALL WGETPARAM(JSHOWITEM,3)ş             EXECUTE 'jshow -v ':JSHOWITEM CAPTURING ARRAY.VALUEş             ARRAY.NAME='jshow'ş             GOSUB process.pobj.arrayş         CASE 1; * DO HELPş            CALL WOBJ(POBJ,"SET.OBJECT",'commands','{}','',RERR)ş            CALL WOBJ(POBJ,'SET','commands.help','List all commands','',RERR)ş            CALL WOBJ(POBJ,'SET','commands.debugon','Turn debug on, next param is line no','',RERR)ş            CALL WOBJ(POBJ,'SET','commands.debugoff','Turn off debugging','',RERR)ş            CALL WOBJ(POBJ,'SET','commands.env','List Environment Variables','',RERR)ş            CALL WOBJ(POBJ,'SET','commands.users','List users','',RERR)ş            IF OCONV(MVTYPE,"MCU") = "JBASE" THENş               CALL WOBJ(POBJ,"SET","commands.jshow","Do a jshow.  Next param is program/file","",RERR)ş               CALL WOBJ(POBJ,"SET","commands.jlicensinginfo","Licensing info","",RERR)ş            ENDş      END CASEş      CALL WOBJ(POBJ,"TOJSON","",RJSON,"",RERR)ş      CALL WOBJ(ROBJ,"SET.OBJECT","rest",RJSON,"",RERR)ş      RETURNş      *şexportresult: *ş      NUM.LINES = DCOUNT(RESULT,@AM)ş      R= '[ 'ş      FOR XX = 1 TO NUM.LINESş         LINE = RESULT<XX>ş         CALL WSWAP(LINE,CHAR(9),'     ')ş         CALL WENCODEJSON('',LINE,OUTLINE)ş         IF XX > 1 THEN R := ','ş         R := '"':OUTLINE:'"'ş      NEXT XXş      R := ']'ş      RETURNş      *şşşprocess.array: *şş      CALL WOBJ(ROBJ,"SET.ARRAY",ARRAY.NAME,"[]","",RERR)ş      CALL MVDBTOOLKIT.SWAP(ARRAY.VALUE,@(-1),"")ş      CALL MVDBTOOLKIT.SWAP(ARRAY.VALUE,CHAR(27):'[7m',"")ş      CALL MVDBTOOLKIT.SWAP(ARRAY.VALUE,CHAR(27):'[0m',"")ş      NUM.LINES=DCOUNT(ARRAY.VALUE,@AM)şş      FOR X=1 TO NUM.LINESş         LINE=ARRAY.VALUE<X>ş         CALL WOBJ(ROBJ,"SET",ARRAY.NAME:"[-1]",LINE,"",RERR)ş      NEXT Xşş      RETURNşşprocess.pobj.array: *şş      CALL WOBJ(POBJ,"SET.ARRAY",ARRAY.NAME,"[]","",RERR)ş      CALL MVDBTOOLKIT.SWAP(ARRAY.VALUE,@(-1),"")ş      CALL MVDBTOOLKIT.SWAP(ARRAY.VALUE,CHAR(27):'[7m',"")ş      CALL MVDBTOOLKIT.SWAP(ARRAY.VALUE,CHAR(27):'[0m',"")ş      NUM.LINES=DCOUNT(ARRAY.VALUE,@AM)şş      FOR X=1 TO NUM.LINESş         LINE=ARRAY.VALUE<X>ş         CALL WOBJ(POBJ,"SET",ARRAY.NAME:"[-1]",LINE,"",RERR)ş      NEXT XşşRETURNşş      END0002E8WBUILDJSONş0c2SUBROUTINE WBUILDJSON(JSONSTRING,NAME,VALUE,RETURNERROR)ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: 8/13/2016ş* Description: build json stringş*ş**********************************************************************şRETURNERROR=''ş*CALL FIX.ESCAPE.DATA.JSON('\',NAME,OUT_NAME)ş*CALL FIX.ESCAPE.DATA.JSON('\',VALUE,OUT_VALUE)şCALL WENCODEJSON('',NAME,OUT_NAME)şCALL WENCODEJSON('',VALUE,OUT_VALUE)şTEMP_STRING='"':OUT_NAME:'":"':OUT_VALUE:'"'şL=LEN(JSONSTRING)şLAST_C=JSONSTRING[L,1]şIF LAST_C = "}" OR LAST_C='"' OR LAST_C = "]" THEN TEMP_STRING=', ':TEMP_STRINGşJSONSTRING:=TEMP_STRINGşRETURNşEND00198AWSENDş0c2SUBROUTINE WSEND(FORM)ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Original Author: Luke J. Bucklin, Sierra Bravoş* Date: 2/29/00ş* Modified By  : Mike Schmidt, Sierra Bravoş* Modified By  : Peter Schellenbach & Patrick Payne, Zumasysş* Purpose: Send the web page.ş* Forked off new version as WSEND for REST services based on original WEB.SENDş*ş* Modified by Peter Schellenbach 09-21-2017ş*  Removed extra @AM appended to the content to prevent extra CR from being sent in responseş*ş* Modified by Peter Schellenbach 10-18-2017ş*  Removed duplicate debug info being sent in html or xml output. Removed loggingş*  code as this is handled by WDB.INIT / JAGENTWDBINIT when saving debug info.ş*ş* Modified by Patrick Payne 04-29-2020ş*  Issue #5.  HTTP wants new lines to be CHAR(13):CHAR(10).  We cannot depend onş*  pick PRINT statements to output the new line since one linux it will only doş*  char(10).  All output statements are updated toş*  PRINT <DATA>:NEW.LINE:    where new.line=CHAR(13):CHAR(1)ş*ş**********************************************************************ş*ş*                1) Header Management: This program will check to seeş*                   if the content type has been written to the browserş*                   before ever printing anything to standard out.  Ifş*                   the headers have not been sent, the program will printş*                   the headers using the SESSION$CONTENT.TYPE,ş*                   SESSION$HEADERS, and SESSION$COOKIES session variables.ş*                   The program will then set the SESSION$CONTENT.SENTş*                   variable.ş*                   WARNING: This program assumes that the global SESSIONş*                   variables were setup prior to using this subroutine.ş*                   WARNING: The SESSION$OUTBUF.SIZE should not be reliedş*                   upon to prevent the buffer from exceeding the set limit.ş*                   This program simply flushes the buffer if it exceedsş*                   the set size limit.ş*ş*                2) Buffer Management: Instead of always printing everyş*                   thing to standard out, by default the program willş*                   write everything passed into into the SESSION$OUTBUFş*                   variable.  This program will then flush the bufferş*                   under certain situations.  The first is if the bufferş*                   size reaches the limit set in SESSION$OUTBUF.SIZE. Ifş*                   this happens the prgram will flush the buffer thenş*                   reinitialize it.  The second is if the SESSION$OUTBUF.FLAGş*                   is set to FALSE, then this program will always flushş*                   the buffer.ş*ş*                3) The program will display debug information if the globalş*                   variable SESSION$GLOBAL.DEBUG flag is >= 3.ş*ş**********************************************************************ş*ş* Add the incoming string to the buffer.şINCLUDE WWW.INCLUDEş*şNEW.LINE = CHAR(13):CHAR(10); * We need to force this as a new lineşşSHOW.SESSION.VARS = 0şIF SESSION$GLOBAL.DEBUG >= 3 THENş  OPEN 'WEB.SESSION' TO F.WEB.SESSION THEN SHOW.SESSION.VARS = 1şENDş*şIF FORM <> '' THENş  CALL WSWAP(FORM,'<!-- CGI$PATH -->',CGI$PATH)ş*PJS 09-21-2017*SESSION$OUTBUF := FORM:@AMş  SESSION$OUTBUF := FORM ; *PJS 09-21-2017*şENDş*ş* If the buffer is greater then the max size or the buffer flag is false then flush.şIF LEN(SESSION$OUTBUF) >= SESSION$OUTBUF.SIZE OR NOT(SESSION$OUTBUF.FLAG) THENş* Before flushing, check to see if the headers have been send.ş  IF NOT(SESSION$CONTENT.SENT) THENş    IF SESSION$STATUS.CODE > 0 THENş* 04-21-17 send the status code before headersş      PRINT "X-MVDB-STATUS: ":SESSION$STATUS.CODE:NEW.LINE:ş    ENDş* The headers have not been sent so send them now.ş    IF SESSION$CONTENT.TYPE = "" THENş      CALL WSETCONTENTTYPE("application/json")ş    ENDş* If there are any cookies that need to be set, do it now.ş    PRINT "Content-type: ":SESSION$CONTENT.TYPE:NEW.LINE:ş* If there are any cookies that need to be set, do it now.ş    FOR I = 1 TO DCOUNT(SESSION$COOKIES, @AM)ş      COOKIE = SESSION$COOKIES<I>ş      IF INDEX(COOKIE, "; path=", 1) + INDEX(COOKIE, ";path=", 1) = 0 THEN COOKIE := "; path=/"ş      PRINT "Set-Cookie: ":COOKIE:NEW.LINE:ş    NEXT Iş* If there are any additional headers that need to be set, do it now.ş    PRINT 'Cache-Control: no-cache'ş    FOR I = 1 TO DCOUNT(SESSION$HEADERS, @AM)ş      PRINT SESSION$HEADERS<I>:NEW.LINE:ş    NEXT Iş* Now print the blank line that ends the headers.ş    PRINTş    IF INDEX(SESSION$CONTENT.TYPE,'html',1) THENş      IF INDEX(SESSION$OUTBUF<1>,'<!DOCTYPE',1) = 0 THENş        PRINT '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"':NEW.LINE:ş        PRINT '"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">':NEW.LINE:ş      ENDş    ENDş* Set the SESSION$CONTENT.SENT variable so next time we know not to send the headers.ş    SESSION$CONTENT.SENT = 1ş* From this point on, do not buffer.ş    IF SESSION$OUTBUF.FLAG THENş      CALL WSETBUFFER(0)ş    ENDş  ENDş  LINE.CNT = DCOUNT(SESSION$OUTBUF, @AM)ş  FOR LINE.J = 1 TO LINE.CNTş    PRINT SESSION$OUTBUF<LINE.J>:NEW.LINE:ş  NEXT LINE.Jş  IF SESSION$GLOBAL.DEBUG >= 3 THENş    IF INDEX(SESSION$CONTENT.TYPE,'xml',1) OR INDEX(SESSION$CONTENT.TYPE,'html',1) THENş* If the debug flag is set then dump all the session information to the browser.ş      PRINT '<!-- Debug Information generated by WEB.SEND.  This feature can be turned off by':NEW.LINE:ş      PRINT '     setting the SESSION$GLOBAL.DEBUG = "1" in the initalization program     -->':NEW.LINE:ş      PRINT '<!-- START DEBUG OUPUT ':NEW.LINE:ş      PRINT '     GET AND POST VARS:':NEW.LINE:ş      FOR I = 1 TO DCOUNT(CGI$VARS, @AM)ş        PRINT '     ':CGI$VARS<I>:' = ':CGI$VALS<I>:NEW.LINE:ş      NEXT Iş      PRINTş      IF SHOW.SESSION.VARS THENş        PRINT '    SESSION VARIABLES:':NEW.LINE:ş        PRINT '    SESSION$ID = ':SESSION$ID:NEW.LINE:ş        READ REC FROM F.WEB.SESSION, SESSION$ID THENş          PRINT '    SESSION DATE = ':OCONV(REC<3>,'D4/'):NEW.LINE:ş          PRINT '    SESSION TIME = ':OCONV(REC<4>,'MTS,'):NEW.LINE:ş          FOR I = 1 TO DCOUNT(REC<1>, @VM)ş            PRINT '    ':REC<1,I>:' = ':REC<2,I>:NEW.LINE:ş          NEXT Iş        ENDş      ENDş      PRINT '    END DEBUG OUTPUT -->':NEW.LINE:ş      PRINT NEW.LINE:ş    ENDş  ENDş  SESSION$OUTBUF = ''şENDşRETURNşEND0014E9WPARSEJSONş0c2SUBROUTINE WPARSEJSON(JSON_STRING,JSON_REQUEST,JSON_RESULT,JSON_ERRORS)ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: 8/13/2016ş* Description: this is to be a simple json parser, it will not be high performance!!ş*ş**********************************************************************ş*ş* COMMAND WILL BE QM STYLEş*ş* object or #/object or #/object or #ş*ş* lets do this VERY ugly, we know what we are looking for should be in the formatş* "key":  or "key" :ş*şJSON_ERRORS=''şJSON_RESULT=''şMAX_LENGTH=LEN(JSON_STRING)şFIRST_KEY=FIELD(JSON_REQUEST,'/',1); * WE CAN ONLY DO SINGLE DEPTH ON THIS VERSIONşIF FIRST_KEY[1,1]='[' THENş  GOSUB getobjectş  RETURNşENDşSEARCH_STRING1='"':FIRST_KEY:'":'şSEARCH_STRING2='"':FIRST_KEY:'" :'şPOS=INDEX(JSON_STRING,SEARCH_STRING1,1)şIF NOT(POS) THENş  POS=INDEX(JSON_STRING,SEARCH_STRING2,1)şENDşIF NOT(POS) THENş  JSON_ERRORS=-1ş  JSON_ERRORS<2>='COULD NOT FIND KEY ':FIRST_KEYş  PRINT 'ERROR'ş  RETURNşENDşTEMP_DATA=JSON_STRING[POS,MAX_LENGTH]ş*PRINT 'TEMP_DATA=':TEMP_DATAş* NOW LETS CHOP TO OUR FIRST :şPOS2=INDEX(TEMP_DATA,':',1)şTEMP_DATA=TEMP_DATA[POS2+1,MAX_LENGTH]ş* NOT SURE IF WE HAVE TO DEAL WITH DATA BEING NOT IN QUOTES, TO MAKE SURE WE ARE GOING TO INSPECT THE NEXT TWO POSITIONSş* AND MAKE SUREş*PRINT 'TEMP_DATA=':TEMP_DATAşTEMP_DATA=TRIM(TEMP_DATA,' ','L')şBEGIN CASEş  CASE TEMP_DATA[1,1] = '"' OR TEMP_DATA[2,1] = '"'ş* QUOTESş    TEMP_DATA=FIELD(TEMP_DATA,'"',2,9999)ş*PRINT 'TEMP_DATA=':TEMP_DATAş* WE CANNOT RELY ON IT JUST BEING THE NEXT QUOTE DUE TO ESCAPING !!@#$#$ş    LEN_STRING=LEN(TEMP_DATA)ş    FOUND_QUOTE=0ş    LAST_C=''ş    FOR X=1 TO LEN_STRING UNTIL FOUND_QUOTEş      C=TEMP_DATA[X,1]ş      NEXTC=TEMP_DATA[X+1,1]ş*PRINT 'C=':C:' NEXT_C=':NEXT_Cş      IF C='\' AND NEXTC='"' THENş        JSON_RESULT:='"'ş        X+=1ş        CONTINUEş      ENDş      IF C='"' THENş        FOUND_QUOTE=1ş        EXITş      END ELSEş        JSON_RESULT:=Cş*PRINT 'JSON_RESULT=':JSON_RESULTş      ENDş      IF X > LEN_STRING THEN FOUND_QUOTE=1ş    NEXT Xş  CASE TEMP_DATA[1,1]='[' OR TEMP_DATA[2,1]='['; * WE ARE PULLING AN ARRAY.  THIS IS VERY MESSY.  IT CAN ONLY HANDLE A SINGLE ARRAY. ANY MORE NESTING AND WE ARE BROKEş* WE NEED TO LOOP UNTIL WE SEE THE NEXT ] THAT IS NOT IS A INSIDE QUOTESş    LEN$STRING=LEN(TEMP_DATA)ş    FOUND$BRACKET=0ş    LAST$C=''ş    INSIDE$QUOTES=0ş    FOR X=1 TO LEN$STRING UNTIL FOUND$BRACKETş      C=TEMP_DATA[X,1]ş      BEGIN CASEş        CASE C=']' AND NOT(INSIDE$QUOTES); FOUND$BRACKET=1ş        CASE C='"' AND INSIDE$QUOTES; INSIDE$QUOTES=0ş        CASE C="'" AND INSIDE$QUOTES; INSIDE$QUOTES=0ş        CASE C='"'; INSIDE$QUOTES=1ş        CASE C="'"; INSIDE$QUOTES=1ş      END CASEş      JSON_RESULT:=Cş    NEXT Xş  CASE TEMP_DATA[1,1]='{' OR TEMP_DATA[2,1]='['; * WE ARE PULLING AN ARRAY.  THIS IS VERY MESSY.  IT CAN ONLY HANDLE A SINGLE ARRAY. ANY MORE NESTING AND WE ARE BROKEş* WE NEED TO LOOP UNTIL WE SEE THE NEXT ] THAT IS NOT IS A INSIDE QUOTESş    LEN$STRING=LEN(TEMP_DATA)ş    FOUND$BRACKET=0ş    LAST$C=''ş    INSIDE$QUOTES=0ş    FOR X=1 TO LEN$STRING UNTIL FOUND$BRACKETş      C=TEMP_DATA[X,1]ş      BEGIN CASEş        CASE C='}' AND NOT(INSIDE$QUOTES); FOUND$BRACKET=1ş        CASE C='"' AND INSIDE$QUOTES; INSIDE$QUOTES=0ş        CASE C="'" AND INSIDE$QUOTES; INSIDE$QUOTES=0ş        CASE C='"'; INSIDE$QUOTES=1ş        CASE C="'"; INSIDE$QUOTES=1ş      END CASEş      JSON_RESULT:=Cş    NEXT Xş  CASE 1ş* IT SHOULD BE A NUMBER ONLYş    IF TEMP_DATA[1,1]=' ' THEN TEMP_DATA=TEMP_DATA[2,MAX_LENGTH]ş* NEXT CHARACTER WILL EITHER BE A },OR SPACXEş    NEXT1=INDEX(TEMP_DATA,' ',1)ş    NEXT2=INDEX(TEMP_DATA,'}',1)ş    NEXT3=INDEX(TEMP_DATA,',',1)ş    N=NEXT1ş    IF NEXT2 < N THEN N=NEXT2ş    IF NEXT3 < N THEN N=NEXT3ş    JSON_RESULT=TEMP_DATA[1,N-1]şEND CASEşRETURNş*şgetobject: *şOBJECTNUMBER=FIELD(FIRST_KEY,']',1)şOBJECTNUMBER=FIELD(OBJECTNUMBER,'[',2)şINSIDE$QUOTES=0şOBJECTCOUNT=0şCHARCNTR=0şNESTCOUNT=0şJSON_RESULT=''şDOINGCOUNT=0şLEN_JSON_STRING=LEN(JSON_STRING)şIF OBJECTNUMBER='#' THENş  OBJECTNUMBER=99999999ş  DOINGCOUNT=1şENDşLOOPş  CHARCNTR+=1ş  IF CHARCNTR > LEN_JSON_STRING THEN EXITş  C=JSON_STRING[CHARCNTR,1]ş  BEGIN CASEş    CASE NOT(INSIDE$QUOTES) AND C='"'ş      JSON_RESULT:=Cş      INSIDE$QUOTES=1ş    CASE INSIDE$QUOTES AND C='"'ş      JSON_RESULT:=Cş      INSIDE$QUOTES=0ş    CASE INSIDE$QUOTESş      JSON_RESULT:=Cş    CASE C='{' AND NOT(NESTCOUNT)ş* WE HAVE THE START OF OUR OBJECTş      JSON_RESULT=Cş      NESTCOUNT=1ş      OBJECTCOUNT+=1ş    CASE C='{' AND NOT(INSIDE$QUOTES)ş* GOING A NEXT DEEPERş      JSON_RESULT:=Cş      NESTCOUNT+=1ş    CASE C='}'ş      JSON_RESULT:=Cş      NESTCOUNT=NESTCOUNT-1ş      IF NESTCOUNT = 0 THENş        IF OBJECTNUMBER=OBJECTCOUNT-1 THENş          EXIT; * WE HAVE OUR OBJECTş        END ELSEş          NESTCOUNT=0ş          JSON_RESULT=''; * RESET OUR OBJECTş        ENDş      ENDş    CASE NESTCOUNT=0; * DO NOTHINGş    CASE 1ş      JSON_RESULT:=Cş  END CASEş  IF 0 THENş    PRINT C,'NESTCOUNT=':NESTCOUNT:' OBJECTCOUNT=':OBJECTCOUNT:' INQUOTE=':INSIDE$QUOTES:' CHARCNTR=':CHARCNTRş  ENDş  IF DOINGCOUNT THEN JSON_RESULT=OBJECTCOUNTşREPEATşIF 0 THENş  PRINT JSON_RESULTş  PRINTş  PRINT JSON_STRING[1,CHARCNTR+50]ş  INPUT WAITşENDşRETURNşEND0002B9WGETPARAMş0c2SUBROUTINE WGETPARAM(ParamVal, ParamNum)ş**********************************************************************ş*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Peter Schellenbach, Zumasysş* Date: March 2017ş* Description: return a parameter from the URL. Assume theş* URL is in the format:ş*ş*   http://api.hostname.com/api/resource/key/command/opt1/opt2/opt3ş*ş* ParamNum = 1 ParamVal = keyş*            2            commandş*            3            opt1ş*            4            opt2ş*            5            opt3ş*ş**********************************************************************şINCLUDE WWW.INCLUDEşParamVal = CGI$RESTPARAMS<ParamNum>şRETURNşEND00069BWSETBUFFERş0c2SUBROUTINE WSETBUFFER(B.VAL)ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2016ş* Updated by: Peter Schellenbach, Zumasysş* Date: November 2017ş* Description  : This program sets the SESSION$OUTBUF.FLAG and optionallyş*                SESSION$OUTBUF.SIZE variables to enable or disableş*                buffering of output generated by WSEND. If bufferingş*                is enabled, be sure to call WFLUSH to flush the finalş*                buffer content.ş*ş*                B.VAL = 0 : disable bufferingş*                B.VAL = 1 : enable buffering using current buffer sizeş*                B.VAL > 1 : enable buffering and set buffer size toş*                            this value.ş*ş*                By default buffering is disabled. If buffering will beş*                used, call WSETBUFFER before the first call to WSEND.ş*                If the size of buffer content ever exceeds the bufferş*                size, the buffer is flushed to the client along withş*                any headers, and buffering is disabled.ş*              ş**********************************************************************şINCLUDE WWW.INCLUDEşEQU FALSE TO 0, TRUE TO 1ş*şIF NUM(B.VAL) AND B.VAL > 0 AND B.VAL <= 1000000 THENş  * Set buffer size and enable bufferingş  SESSION$OUTBUF.SIZE = B.VALş  SESSION$OUTBUF.FLAG = TRUEşEND ELSEş  * Enable or disable bufferingş  IF B.VAL # TRUE AND B.VAL # FALSE THENş    IF B.VAL = "" THENş      B.VAL = FALSEş    END ELSEş      B.VAL = TRUEş    ENDş  ENDş  SESSION$OUTBUF.FLAG = B.VALşENDşRETURNşEND0002A0WSETHEADERş0c2SUBROUTINE WSETHEADER(VarName, VarValue)ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2016ş* Description: set a value of HTTP response headerş*ş* Updated by Peter Schellenbach, 09-21-2017 to call WSETCONTENTTYPE when setting the Content-Type headerş*ş**********************************************************************şINCLUDE WWW.INCLUDEşIF OCONV(VarName,'MCU') = 'CONTENT-TYPE' THENş  CALL WSETCONTENTTYPE(VarValue)şEND ELSEş  HEADER_LINE = VarName:': ':VarValueş  SESSION$HEADERS<-1> = HEADER_LINEşENDşRETURNşEND0001F0WGETCONFIGş0c2SUBROUTINE WGETCONFIG(VarValue, VarName) ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2016ş* Description: extract a configuration valueş*ş**********************************************************************şINCLUDE WWW.INCLUDEşVarValue = ''şLOCATE VarName IN CGI$CONFIG<1,1> SETTING POS THENş  VarValue = CGI$CONFIG<1,2,POS>şENDşRETURNşEND00023FWSETVARş0c2SUBROUTINE WSETVAR(VarValue, VarName)ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2016ş* Description: update value of a request variableş*ş**********************************************************************şINCLUDE WWW.INCLUDEşTEMPVARS = OCONV(CGI$VARS, 'MCU')şLOCATE OCONV(VarName, 'MCU') IN TEMPVARS SETTING POS THENş  CGI$VALS<POS> = VarValueşEND ELSEş  CGI$VARS<-1> = VarNameş  CGI$VALS<-1> = VarValueşENDşRETURNşEND00028CWSETSTATUSş0c2SUBROUTINE WSETSTATUS( STATUS.CODE )ş**********************************************************************ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written By   : Peter Schellenbachş* Date Written : 04/21/2017ş* Description  : This program sets the response status code sentş*                back to client. Successful requests should returnş*                status code 200 (this is the default). Status codeş*                500 indicates a generic server failure.ş*              ş**********************************************************************şINCLUDE WWW.INCLUDEşSESSION$STATUS.CODE = STATUS.CODEşRETURNşEND000481WWW.INFOş0c2*ş* Element index for standard web common /WWW/ WWW.INFO arrayş*şEQU SESSION_ID               TO 1şEQU SESSION_CONTENT.TYPE     TO 2şEQU SESSION_CONTENT.SENT     TO 3şEQU SESSION_OUTBUF           TO 4şEQU SESSION_HEADERS          TO 5şEQU SESSION_COOKIES          TO 6şEQU SESSION_OUTBUF.SIZE      TO 7şEQU SESSION_OUTBUF.FLAG      TO 8şEQU SESSION_TIME.OUT         TO 9şEQU SESSION_GLOBAL.DEBUG     TO 10şEQU SESSION_STATUS.CODE      TO 11şEQU SESSION_WDEBUG_MODE      TO 12şEQU CONFIG_WDB.RESOURCE      TO 15şEQU CGI_VARS                 TO 25şEQU CGI_VALS                 TO 26şEQU CGI_CVARS                TO 27şEQU CGI_CVALS                TO 28 şEQU CGI_SERVER.NAME          TO 29şEQU CGI_PATH                 TO 30şEQU CGI_SERVER.PORT          TO 31şEQU CGI_BODY                 TO 32şEQU CGI_HEADERVALS           TO 33şEQU CGI_HEADERVARS           TO 34şEQU CGI_RESTPARAMS           TO 35şEQU CGI_CONFIG               TO 36şEQU CGI_APPSVR.ID            TO 45şEQU CGI_RESERVED1            TO 46şEQU CGI_RESERVED2            TO 47şEQU CGI_RESERVED3            TO 48şEQU CGI_UNIQUE.ID            TO 49şEQU CGI_RESOURCE.NAME        TO 50000212WGETVARş0c2SUBROUTINE WGETVAR(VarValue, VarName)ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2016ş* Description: extract value of a request variableş*ş**********************************************************************şINCLUDE WWW.INCLUDEşVarValue = ''şTEMPVARS = OCONV(CGI$VARS, 'MCU')şLOCATE OCONV(VarName, 'MCU') IN TEMPVARS SETTING POS THENş  VarValue = CGI$VALS<POS>şENDşRETURNşEND00018EFI.WDB.RESOURCEş0c2DIM RSRC.ITEM(20)ş*şEQU RSRC.TYPE           TO RSRC.ITEM(1)şEQU RSRC.DESCRIPTION    TO RSRC.ITEM(2)şEQU RSRC.CONTROLLER     TO RSRC.ITEM(3)şEQU RSRC.PROGRAM        TO RSRC.ITEM(4)şEQU RSRC.PARSE.CGI      TO RSRC.ITEM(5)şEQU RSRC.ENABLED        TO RSRC.ITEM(6)şEQU RSRC.DEBUG.MODE     TO RSRC.ITEM(7)şEQU RSRC.ACCOUNT        TO RSRC.ITEM(8)şEQU RSRC.NL             TO RSRC.ITEM(9)000251WSETCONTENTTYPEş0c2SUBROUTINE WSETCONTENTTYPE(CONTENTTYPE)ş**********************************************************************ş*ş* Copyright (C) 2016 Zumasys, Inc., All Rights Reservedş*ş* Written by: Patrick Payne, Zumasysş* Date: December 2016ş* Description  : This subroutine sets the SESSION$CONTENT.TYPE variable.ş*                This value is used in the Content-Type HTTP headerş*                in the response sent to the client.ş*              ş**********************************************************************şINCLUDE WWW.INCLUDEşSESSION$CONTENT.TYPE=CONTENTTYPEşRETURNşEND0000EERSS.FEEDSş0c000005DFEEDSş0c2Available RSS FeedsşşRSS Feeds available on this serverşSUB.FEEDS.SELşSUB.FEEDS.ITEM000078RUNTIME-ERRORSş0c2Basic Runtime ErrorsşşData basic runtime errors.şSUB.RE.SELşSUB.RE.ITEMşDashboard Accountşaccount=TLDB006E09MVDB.CONTROLş0c000024ECOMPILE.SETUPş0c2BASIC %FILENAME% %ITEMNAME%ş* To configure the compile command when using the web editorş* edit line # 1 of this record to contain the appropriate syntax.ş*ş* Example # 1 - Standard compile using BASICş* 001 BASIC %FILENAME% %ITEMNAME%ş*ş* Example # 2 - FLASH compile using BASICş* 001 BASIC %FILENAME% %ITEMNAME% (Oş*ş* Example # 3 - Standard compile using COMPILEş* 001 COMPILE %FILENAME% %ITEMNAME%ş*ş* Only line # 1 of this record is used, all other lines of this record are ignored.ş* If this record is deleted, the default behavior is:ş* COMPILE %FILENAME% %ITEMNAME%0000A1FC2DPIE.SETTINGSş0c2<graph caption='[CHART.TITLE]' decimalPrecision='0' showNames='1' showValues='0'ş pieRadius='[RADIUS]' animation='0' >ş [CHART.DATA]ş</graph>0000DEFC3DPIE.SETTINGSş0c2<graph caption='[CHART.TITLE]' decimalPrecision='0' showNames='1' showValues='0'ş showPercentageInLabel='0' pieYScale='45' pieRadius='[RADIUS]' animation='0'ş pieFillAlpha='100' >ş [CHART.DATA]ş</graph>0000A9FCAREA2D.SETTINGSş0c2<graph bgcolor='ffffff' caption='[CHART.TITLE]' animation='0' decimalPrecision='0' ş yaxisname='[YMEMO]' xaxisname='[XMEMO]'>ş [CHART.DATA]ş</graph>0000A9FCBAR2D.SETTINGSş0c2<graph bgcolor='ffffff' caption='[CHART.TITLE]' animation='0' decimalPrecision='0' ş yaxisname='[YMEMO]' xaxisname='[XMEMO]' >ş [CHART.DATA]ş</graph>00009BFCCOLUMN2D.SETTINGSş0c2<graph caption='[CHART.TITLE]' animation='0' decimalPrecision='0' ş yaxisname='[YMEMO]' xaxisname='[XMEMO]' >ş [CHART.DATA]ş</graph>0000ADFCCOLUMN3D.SETTINGSş0c2<graph bgcolor='ffffff' caption='[CHART.TITLE]' ş decimalPrecision='0' animation='0'ş yaxisname='[YMEMO]' xaxisname='[XMEMO]' >ş [CHART.DATA]ş</graph>0000A6FCDOUGHNUT2D.SETTINGSş0c2<graph caption='[CHART.TITLE]' decimalPrecision='0' showNames='1' showValues='0'ş pieRadius='[RADIUS]' animation='0' >ş [CHART.DATA]ş</graph>0000A7FCLINE.SETTINGSş0c2<graph bgcolor='ffffff' caption='[CHART.TITLE]' animation='0' decimalPrecision='0' ş yaxisname='[YMEMO]' xaxisname='[XMEMO]'>ş [CHART.DATA]ş</graph>000C53FCMAP.NAMESş0c2AfghanistanşAfricaşAlabamaşAlaskaşAlbaniaşAlbertaşAlgeriaşAndorraşAngolaşAntiguaşArgentinaşArizonaşArkansasşArmeniaşAsia3şAsiaGeorgiaşAsiaşAustralia2şAustraliaşAustriaşAzerbaijanşBahamasşBahrainşBangladeshşBarbadosşBelarusşBelgiumşBelizeşBeninşBhutanşBoliviaşBosniaHerzegovinaşBotswanaşBrazilRegionşBrazilşBritishColumbiaşBruneişBulgariaşBurkinaFasoşBurmaşBurundişCaliforniaşCambodiaşCameroonşCanadaşCapeVerdeşCaymanIslandsşCentralAfricanRepublicşCentralAmerica2şCentralAmericaşCentralAmericawithCaribbeanşCentralEuropeanRegionşChadşChileşChina2şChinaşColombiaşColoradoşComorosşCongoşConnecticutşCostaRicaşCoteDivoireşCroatiaşCubaşCyprus2şCyprusşCzechRepublicşDelawareşDemocraticRepublicofCongoşDenmarkRegionşDenmarkşDistrictofColumbiaşDjiboutişDominicanRepublicşDominicaşEastEuropeanRegionşEastTimorşEcuadorşEgyptşElSalvadorşEnglandRegionşEnglandşEquatorialGuineaşEritreaşEstoniaşEthiopiaşEurope2şEuropeRegionşEuropeşEuropewithcountriesşFalklandIslandşFijişFinlandşFloridaşFranceDepartmentşFranceşFrenchGuianaşGabonşGambiaşGeorgiaşGermanyşGhanaşGreeceşGreenlandşGrenadaşGuatemalaşGuineaBissauşGuineaşGuyanaşHaitişHawaiişHondurasşHongKongşHungaryRegionsşHungaryşIcelandşIdahoşIllinoisşIndianaşIndiaşIndonesiaşIowaşIranşIraqşIrelandşIsraelşItalyşJamaicaşJapanşJordanşKansasşKazakhstanşKentuckyşKenyaşKiribatişKuwaitşKyrgyzstanşLaosşLatviaşLebanonşLesothoşLiberiaşLibyaşLiechtensteinşLithuaniaşLouisianaşLuxembourgşMacauşMacedoniaşMadagascarRegionsşMadagascarşMaineşMalawişMalaysiaşMalişMaltaşManitobaşMarshallIslandşMarylandşMassachusettsşMauritaniaşMauritiusşMexicoşMichiganşMicronesiaşMiddleEastşMinnesotaşMississippişMissourişMoldovaşMonacoşMongoliaşMontanaşMontenegroşMoroccoşMozambiqueşNamibiaşNauruşNebraskaşNepalşNetherlandşNevadaşNewBrunswickşNewCaledoniaşNewfoundlandandLabradorşNewHampshireşNewJerseyşNewMexicoşNewWorldşNewYorkşNewZealandşNicaraguaşNigeriaşNigerşNorthAmericaşNorthAmerica_WOCentralşNorthCarolinaşNorthDakotaşNorthEuropeanRegionşNorthIrelandşNorthKoreaşNorthWestTerritoriesşNorwayRegionşNorwayşNovaScotiaşNunavutşOceaniaşOhioşOklahomaşOmanşOntarioşOregonşPakistanşPalauşPanamaşPapuaNewGuineaşParaguayşPennsylvaniaşPeruşPhilippinesşPolandCountiesşPolandşPortugalşPrinceEdwardIslandşPuertoRicoşQatarşQuebecşRhodeIslandşRomaniaşRussiaşRwandaşSaintKittsandNevisşSaintLuciaşSaintVincentandtheGrenadinesşSamoaşSanMarinoşSaoTomeandPrincipeşSaskatchewanşSaudiArabiaşScotlandRegionşScotlandşSenegalşSerbiaşSeychellesşSierraLeoneşSingaporeşSlovakiaşSloveniaşSolomonIslandşSomaliaşSouthAfricaşSouthAmericaşSouthCarolinaşSouthDakotaşSouthEuropeanRegionşSouthKoreaşSpainProvincesşSpainşSriLankaşSudanşSurinameşSwazilandşSwedenşSwitzerlandşSyriaşTaiwanşTajikistanşTanzaniaşTennesseeşTexasşThailandşTibetşTogoşTongaşTrinidadandTobagoşTunisiaşTurkeyşTurkmenistanşTuvaluşUAEşUgandaşUK7şUkraineşUKşUruguayşUSACentralRegionşUSANorthEastRegionşUSANorthWestRegionşUSARegionşUSASouthEastRegionşUSASouthWestRegionşUSAşUtahşUzbekistanşVanuatuşVaticanCityşVenezuelaşVermontşVietnamşVirginiaşWalesşWashingtonşWesternSaharaşWestEuropeanRegionşWestVirginiaşWisconsinşWorld8şWorldşWorldwithCountriesşWyomingşYemenşYukonTerritoryşZambiaşZimbabwe0000B1FCMAP.SETTINGSş0c2<map showCanvasBorder='1' canvasBorderColor='F1F1F1' canvasBorderThickness='2' borderColor='FFFFFF' connectorColor='000000' fillAlpha='70'>ş[CHART.DATA]ş</map>00009AFCMSAREA2D.SETTINGSş0c2<graph xaxisname='[XMEMO]' yaxisname='[YMEMO]' decimalPrecision='0'ş animation='0' caption='[CHART.TITLE]' >ş [CHART.DATA]ş</graph>000099FCMSBAR2D.SETTINGSş0c2<graph xaxisname='[XMEMO]' yaxisname='[YMEMO]' decimalPrecision='0'ş animation='0' caption='[CHART.TITLE]' >ş [CHART.DATA]ş</graph>00009CFCMSCOLUMN2D.SETTINGSş0c2<graph xaxisname='[XMEMO]' yaxisname='[YMEMO]' decimalPrecision='0'ş animation='0' caption='[CHART.TITLE]' >ş [CHART.DATA]ş</graph>00009CFCMSCOLUMN3D.SETTINGSş0c2<graph xaxisname='[XMEMO]' yaxisname='[YMEMO]' decimalPrecision='0'ş animation='0' caption='[CHART.TITLE]' >ş [CHART.DATA]ş</graph>000098FCMSLINE.SETTINGSş0c2<graph xaxisname='[XMEMO]' yaxisname='[YMEMO]' decimalPrecision='0'ş animation='0' caption='[CHART.TITLE]' >ş [CHART.DATA]ş</graph>00009FFCSTACKEDAREA2D.SETTINGSş0c2<graph xaxisname='[XMEMO]' yaxisname='[YMEMO]' decimalPrecision='0'ş animation='0' caption='[CHART.TITLE]' >ş [CHART.DATA]ş</graph>00009EFCSTACKEDBAR2D.SETTINGSş0c2<graph xaxisname='[XMEMO]' yaxisname='[YMEMO]' decimalPrecision='0'ş animation='0' caption='[CHART.TITLE]' >ş [CHART.DATA]ş</graph>0000A1FCSTACKEDCOLUMN2D.SETTINGSş0c2<graph xaxisname='[XMEMO]' yaxisname='[YMEMO]' decimalPrecision='0'ş animation='0' caption='[CHART.TITLE]' >ş [CHART.DATA]ş</graph>0000A1FCSTACKEDCOLUMN3D.SETTINGSş0c2<graph xaxisname='[XMEMO]' yaxisname='[YMEMO]' decimalPrecision='0'ş animation='0' caption='[CHART.TITLE]' >ş [CHART.DATA]ş</graph>0000FDFWBULLET.SETTINGSş0c2<chart palette='[CHART.PALETTE]' lowerLimit='[LOWER.LIMIT]' upperLimit='[UPPER.LIMIT]' caption='[CAPTION]' subcaption='[SUBCAPTION]' numberPrefix='[NUMBER.PREFIX]' numberSuffix='[NUMBER.SUFFIX]' showValue='1' >ş[CHART.DATA]ş</chart>0000BAFWFP.SETTINGSş0c2<chart numberPrefix='[NUMBER.PREFIX]' numberSuffix='[NUMBER.SUFFIX]' caption='[CAPTION]' subcaption='[SUBCAPTION]' decimals='1' baseFontSize='11' >ş[CHART.DATA]ş</chart>000122FWGAUGE.SETTINGSş0c2<chart palette='[CHART.PALETTE]' lowerLimitDisplay='[LOWER.LIMIT.DISPLAY]' upperLimitDisplay='[UPPER.LIMIT.DISPLAY]' lowerLimit='[LOWER.LIMIT]' upperLimit='[UPPER.LIMIT]' numberPrefix='[NUMBER.PREFIX]' numberSuffix='[NUMBER.SUFFIX]' showValue='1' >ş[CHART.DATA]ş</chart>0000CAFWSPARK.SETTINGSş0c2<chart yAxisMinValue='[LOWER.LIMIT]' yAxisMaxValue='[UPPER.LIMIT]' palette='[CHART.PALETTE]' caption='[CAPTION]' subcaption='[SUBCAPTION]' setAdaptiveYMin='1' >ş[CHART.DATA]ş</chart>004113ICON.LISTş0c2accept.pngşadd.pngşanchor.pngşapplication_add.pngşapplication_cascade.pngşapplication_delete.pngşapplication_double.pngşapplication_edit.pngşapplication_error.pngşapplication_form_add.pngşapplication_form_delete.pngşapplication_form_edit.pngşapplication_form_magnify.pngşapplication_form.pngşapplication_get.pngşapplication_go.pngşapplication_home.pngşapplication_key.pngşapplication_lightning.pngşapplication_link.pngşapplication_osx.pngşapplication_osx_terminal.pngşapplication.pngşapplication_put.pngşapplication_side_boxes.pngşapplication_side_contract.pngşapplication_side_expand.pngşapplication_side_list.pngşapplication_side_tree.pngşapplication_split.pngşapplication_tile_horizontal.pngşapplication_tile_vertical.pngşapplication_view_columns.pngşapplication_view_detail.pngşapplication_view_gallery.pngşapplication_view_icons.pngşapplication_view_list.pngşapplication_view_tile.pngşapplication_xp.pngşapplication_xp_terminal.pngşarrow_branch.pngşarrow_divide.pngşarrow_down.pngşarrow_inout.pngşarrow_in.pngşarrow_join.pngşarrow_left.pngşarrow_merge.pngşarrow_out.pngşarrow_redo.pngşarrow_refresh.pngşarrow_refresh_small.pngşarrow_right.pngşarrow_rotate_anticlockwise.pngşarrow_rotate_clockwise.pngşarrow_switch.pngşarrow_turn_left.pngşarrow_turn_right.pngşarrow_undo.pngşarrow_up.pngşasterisk_orange.pngşasterisk_yellow.pngşattach.pngşaward_star_add.pngşaward_star_bronze_1.pngşaward_star_bronze_2.pngşaward_star_bronze_3.pngşaward_star_delete.pngşaward_star_gold_1.pngşaward_star_gold_2.pngşaward_star_gold_3.pngşaward_star_silver_1.pngşaward_star_silver_2.pngşaward_star_silver_3.pngşbasket_add.pngşbasket_delete.pngşbasket_edit.pngşbasket_error.pngşbasket_go.pngşbasket.pngşbasket_put.pngşbasket_remove.pngşbell_add.pngşbell_delete.pngşbell_error.pngşbell_go.pngşbell_link.pngşbell.pngşbin_closed.pngşbin_empty.pngşbin.pngşbomb.pngşbook_add.pngşbook_addresses.pngşbook_delete.pngşbook_edit.pngşbook_error.pngşbook_go.pngşbook_key.pngşbook_link.pngşbook_next.pngşbook_open.pngşbook.pngşbook_previous.pngşbox.pngşbrick_add.pngşbrick_delete.pngşbrick_edit.pngşbrick_error.pngşbrick_go.pngşbrick_link.pngşbrick.pngşbricks.pngşbriefcase.pngşbug_add.pngşbug_delete.pngşbug_edit.pngşbug_error.pngşbug_go.pngşbug_link.pngşbug.pngşbuilding_add.pngşbuilding_delete.pngşbuilding_edit.pngşbuilding_error.pngşbuilding_go.pngşbuilding_key.pngşbuilding_link.pngşbuilding.pngşbullet_add.pngşbullet_arrow_bottom.pngşbullet_arrow_down.pngşbullet_arrow_top.pngşbullet_arrow_up.pngşbullet_black.pngşbullet_blue.pngşbullet_delete.pngşbullet_disk.pngşbullet_error.pngşbullet_feed.pngşbullet_go.pngşbullet_green.pngşbullet_key.pngşbullet_orange.pngşbullet_picture.pngşbullet_pink.pngşbullet_purple.pngşbullet_red.pngşbullet_star.pngşbullet_toggle_minus.pngşbullet_toggle_plus.pngşbullet_white.pngşbullet_wrench.pngşbullet_yellow.pngşcake.pngşcalculator_add.pngşcalculator_delete.pngşcalculator_edit.pngşcalculator_error.pngşcalculator_link.pngşcalculator.pngşcalendar_add.pngşcalendar_delete.pngşcalendar_edit.pngşcalendar_link.pngşcalendar.pngşcalendar_view_day.pngşcalendar_view_month.pngşcalendar_view_week.pngşcamera_add.pngşcamera_delete.pngşcamera_edit.pngşcamera_error.pngşcamera_go.pngşcamera_link.pngşcamera.pngşcamera_small.pngşcancel.pngşcar_add.pngşcar_delete.pngşcar.pngşcart_add.pngşcart_delete.pngşcart_edit.pngşcart_error.pngşcart_go.pngşcart.pngşcart_put.pngşcart_remove.pngşcd_add.pngşcd_burn.pngşcd_delete.pngşcd_edit.pngşcd_eject.pngşcd_go.pngşcd.pngşchart_bar_add.pngşchart_bar_delete.pngşchart_bar_edit.pngşchart_bar_error.pngşchart_bar_link.pngşchart_bar.pngşchart_curve_add.pngşchart_curve_delete.pngşchart_curve_edit.pngşchart_curve_error.pngşchart_curve_go.pngşchart_curve_link.pngşchart_curve.pngşchart_line_add.pngşchart_line_delete.pngşchart_line_edit.pngşchart_line_error.pngşchart_line_link.pngşchart_line.pngşchart_organisation_add.pngşchart_organisation_delete.pngşchart_organisation.pngşchart_pie_add.pngşchart_pie_delete.pngşchart_pie_edit.pngşchart_pie_error.pngşchart_pie_link.pngşchart_pie.pngşclock_add.pngşclock_delete.pngşclock_edit.pngşclock_error.pngşclock_go.pngşclock_link.pngşclock_pause.pngşclock_play.pngşclock.pngşclock_red.pngşclock_stop.pngşcog_add.pngşcog_delete.pngşcog_edit.pngşcog_error.pngşcog_go.pngşcog.pngşcoins_add.pngşcoins_delete.pngşcoins.pngşcolor_swatch.pngşcolor_wheel.pngşcomment_add.pngşcomment_delete.pngşcomment_edit.pngşcomment.pngşcomments_add.pngşcomments_delete.pngşcomments.pngşcompress.pngşcomputer_add.pngşcomputer_delete.pngşcomputer_edit.pngşcomputer_error.pngşcomputer_go.pngşcomputer_key.pngşcomputer_link.pngşcomputer.pngşconnect.pngşcontrast_decrease.pngşcontrast_high.pngşcontrast_increase.pngşcontrast_low.pngşcontrast.pngşcontrol_eject_blue.pngşcontrol_eject.pngşcontrol_end_blue.pngşcontrol_end.pngşcontrol_equalizer_blue.pngşcontrol_equalizer.pngşcontrol_fastforward_blue.pngşcontrol_fastforward.pngşcontroller_add.pngşcontroller_delete.pngşcontroller_error.pngşcontroller.pngşcontrol_pause_blue.pngşcontrol_pause.pngşcontrol_play_blue.pngşcontrol_play.pngşcontrol_repeat_blue.pngşcontrol_repeat.pngşcontrol_rewind_blue.pngşcontrol_rewind.pngşcontrol_start_blue.pngşcontrol_start.pngşcontrol_stop_blue.pngşcontrol_stop.pngşcreditcards.pngşcross.pngşcss_add.pngşcss_delete.pngşcss_go.pngşcss.pngşcss_valid.pngşcup_add.pngşcup_delete.pngşcup_edit.pngşcup_error.pngşcup_go.pngşcup_key.pngşcup_link.pngşcup.pngşcursor.pngşcut.pngşcut_red.pngşdatabase_add.pngşdatabase_connect.pngşdatabase_delete.pngşdatabase_edit.pngşdatabase_error.pngşdatabase_gear.pngşdatabase_go.pngşdatabase_key.pngşdatabase_lightning.pngşdatabase_link.pngşdatabase.pngşdatabase_refresh.pngşdatabase_save.pngşdatabase_table.pngşdate_add.pngşdate_delete.pngşdate_edit.pngşdate_error.pngşdate_go.pngşdate_link.pngşdate_magnify.pngşdate_next.pngşdate.pngşdate_previous.pngşdelete.pngşdisconnect.pngşdisk_multiple.pngşdisk.pngşdoor_in.pngşdoor_open.pngşdoor_out.pngşdoor.pngşdrink_empty.pngşdrink.pngşdrive_add.pngşdrive_burn.pngşdrive_cd_empty.pngşdrive_cd.pngşdrive_delete.pngşdrive_disk.pngşdrive_edit.pngşdrive_error.pngşdrive_go.pngşdrive_key.pngşdrive_link.pngşdrive_magnify.pngşdrive_network.pngşdrive.pngşdrive_rename.pngşdrive_user.pngşdrive_web.pngşdvd_add.pngşdvd_delete.pngşdvd_edit.pngşdvd_error.pngşdvd_go.pngşdvd_key.pngşdvd_link.pngşdvd.pngşemail_add.pngşemail_attach.pngşemail_delete.pngşemail_edit.pngşemail_error.pngşemail_go.pngşemail_link.pngşemail_open_image.pngşemail_open.pngşemail.pngşemoticon_evilgrin.pngşemoticon_grin.pngşemoticon_happy.pngşemoticon_smile.pngşemoticon_surprised.pngşemoticon_tongue.pngşemoticon_unhappy.pngşemoticon_waii.pngşemoticon_wink.pngşerror_add.pngşerror_delete.pngşerror_go.pngşerror.pngşexclamation.pngşeye.pngşfeed_add.pngşfeed_delete.pngşfeed_disk.pngşfeed_edit.pngşfeed_error.pngşfeed_go.pngşfeed_key.pngşfeed_link.pngşfeed_magnify.pngşfeed.pngşfemale.pngşfilm_add.pngşfilm_delete.pngşfilm_edit.pngşfilm_error.pngşfilm_go.pngşfilm_key.pngşfilm_link.pngşfilm.pngşfilm_save.pngşfind.pngşflag_blue.pngşflag_green.pngşflag_orange.pngşflag_pink.pngşflag_purple.pngşflag_red.pngşflag_yellow.pngşfolder_add.pngşfolder_bell.pngşfolder_brick.pngşfolder_bug.pngşfolder_camera.pngşfolder_database.pngşfolder_delete.pngşfolder_edit.pngşfolder_error.pngşfolder_explore.pngşfolder_feed.pngşfolder_find.pngşfolder_go.pngşfolder_heart.pngşfolder_image.pngşfolder_key.pngşfolder_lightbulb.pngşfolder_link.pngşfolder_magnify.pngşfolder_page.pngşfolder_page_white.pngşfolder_palette.pngşfolder_picture.pngşfolder.pngşfolder_star.pngşfolder_table.pngşfolder_user.pngşfolder_wrench.pngşfont_add.pngşfont_delete.pngşfont_go.pngşfont.pngşgroup_add.pngşgroup_delete.pngşgroup_edit.pngşgroup_error.pngşgroup_gear.pngşgroup_go.pngşgroup_key.pngşgroup_link.pngşgroup.pngşheart_add.pngşheart_delete.pngşheart.pngşhelp.pngşhourglass_add.pngşhourglass_delete.pngşhourglass_go.pngşhourglass_link.pngşhourglass.pngşhouse_go.pngşhouse_link.pngşhouse.pngşhtml_add.pngşhtml_delete.pngşhtml_go.pngşhtml.pngşhtml_valid.pngşimage_add.pngşimage_delete.pngşimage_edit.pngşimage_link.pngşimage.pngşimages.pngşinformation.pngşipod_cast_add.pngşipod_cast_delete.pngşipod_cast.pngşipod.pngşipod_sound.pngşjoystick_add.pngşjoystick_delete.pngşjoystick_error.pngşjoystick.pngşkey_add.pngşkeyboard_add.pngşkeyboard_delete.pngşkeyboard_magnify.pngşkeyboard.pngşkey_delete.pngşkey_go.pngşkey.pngşlayers.pngşlayout_add.pngşlayout_content.pngşlayout_delete.pngşlayout_edit.pngşlayout_error.pngşlayout_header.pngşlayout_link.pngşlayout.pngşlayout_sidebar.pngşlightbulb_add.pngşlightbulb_delete.pngşlightbulb_off.pngşlightbulb.pngşlightning_add.pngşlightning_delete.pngşlightning_go.pngşlightning.pngşlink_add.pngşlink_break.pngşlink_delete.pngşlink_edit.pngşlink_error.pngşlink_go.pngşlink.pngşlock_add.pngşlock_break.pngşlock_delete.pngşlock_edit.pngşlock_go.pngşlock_open.pngşlock.pngşlorry_add.pngşlorry_delete.pngşlorry_error.pngşlorry_flatbed.pngşlorry_go.pngşlorry_link.pngşlorry.pngşmagifier_zoom_out.pngşmagnifier.pngşmagnifier_zoom_in.pngşmale.pngşmap_add.pngşmap_delete.pngşmap_edit.pngşmap_go.pngşmap_magnify.pngşmap.pngşmedal_bronze_1.pngşmedal_bronze_2.pngşmedal_bronze_3.pngşmedal_bronze_add.pngşmedal_bronze_delete.pngşmedal_gold_1.pngşmedal_gold_2.pngşmedal_gold_3.pngşmedal_gold_add.pngşmedal_gold_delete.pngşmedal_silver_1.pngşmedal_silver_2.pngşmedal_silver_3.pngşmedal_silver_add.pngşmedal_silver_delete.pngşmoney_add.pngşmoney_delete.pngşmoney_dollar.pngşmoney_euro.pngşmoney.pngşmoney_pound.pngşmoney_yen.pngşmonitor_add.pngşmonitor_delete.pngşmonitor_edit.pngşmonitor_error.pngşmonitor_go.pngşmonitor_lightning.pngşmonitor_link.pngşmonitor.pngşmouse_add.pngşmouse_delete.pngşmouse_error.pngşmouse.pngşmusic.pngşnew.pngşnewspaper_add.pngşnewspaper_delete.pngşnewspaper_go.pngşnewspaper_link.pngşnewspaper.pngşnote_add.pngşnote_delete.pngşnote_edit.pngşnote_error.pngşnote_go.pngşnote.pngşoverlays.pngşpackage_add.pngşpackage_delete.pngşpackage_go.pngşpackage_green.pngşpackage_link.pngşpackage.pngşpage_add.pngşpage_attach.pngşpage_code.pngşpage_copy.pngşpage_delete.pngşpage_edit.pngşpage_error.pngşpage_excel.pngşpage_find.pngşpage_gear.pngşpage_go.pngşpage_green.pngşpage_key.pngşpage_lightning.pngşpage_link.pngşpage_paintbrush.pngşpage_paste.pngşpage.pngşpage_red.pngşpage_refresh.pngşpage_save.pngşpage_white_acrobat.pngşpage_white_actionscript.pngşpage_white_add.pngşpage_white_camera.pngşpage_white_cd.pngşpage_white_code.pngşpage_white_code_red.pngşpage_white_coldfusion.pngşpage_white_compressed.pngşpage_white_copy.pngşpage_white_cplusplus.pngşpage_white_c.pngşpage_white_csharp.pngşpage_white_cup.pngşpage_white_database.pngşpage_white_delete.pngşpage_white_dvd.pngşpage_white_edit.pngşpage_white_error.pngşpage_white_excel.pngşpage_white_find.pngşpage_white_flash.pngşpage_white_freehand.pngşpage_white_gear.pngşpage_white_get.pngşpage_white_go.pngşpage_white_horizontal.pngşpage_white_h.pngşpage_white_key.pngşpage_white_lightning.pngşpage_white_link.pngşpage_white_magnify.pngşpage_white_medal.pngşpage_white_office.pngşpage_white_paintbrush.pngşpage_white_paint.pngşpage_white_paste.pngşpage_white_php.pngşpage_white_picture.pngşpage_white.pngşpage_white_powerpoint.pngşpage_white_put.pngşpage_white_ruby.pngşpage_white_stack.pngşpage_white_star.pngşpage_white_swoosh.pngşpage_white_text.pngşpage_white_text_width.pngşpage_white_tux.pngşpage_white_vector.pngşpage_white_visualstudio.pngşpage_white_width.pngşpage_white_word.pngşpage_white_world.pngşpage_white_wrench.pngşpage_white_zip.pngşpage_word.pngşpage_world.pngşpaintbrush.pngşpaintcan.pngşpalette.pngşpaste_plain.pngşpaste_word.pngşpencil_add.pngşpencil_delete.pngşpencil_go.pngşpencil.pngşphone_add.pngşphone_delete.pngşphone.pngşphone_sound.pngşphoto_add.pngşphoto_delete.pngşphoto_link.pngşphoto.pngşphotos.pngşpicture_add.pngşpicture_delete.pngşpicture_edit.pngşpicture_empty.pngşpicture_error.pngşpicture_go.pngşpicture_key.pngşpicture_link.pngşpicture.pngşpicture_save.pngşpictures.pngşpilcrow.pngşpill_add.pngşpill_delete.pngşpill_go.pngşpill.pngşplugin_add.pngşplugin_delete.pngşplugin_disabled.pngşplugin_edit.pngşplugin_error.pngşplugin_go.pngşplugin_link.pngşplugin.pngşprinter_add.pngşprinter_delete.pngşprinter_empty.pngşprinter_error.pngşprinter.pngşrainbow.pngşreport_add.pngşreport_delete.pngşreport_disk.pngşreport_edit.pngşreport_go.pngşreport_key.pngşreport_link.pngşreport_magnify.pngşreport_picture.pngşreport.pngşreport_user.pngşreport_word.pngşresultset_first.pngşresultset_last.pngşresultset_next.pngşresultset_previous.pngşrosette.pngşrss_add.pngşrss_delete.pngşrss_go.pngşrss.pngşrss_valid.pngşruby_add.pngşruby_delete.pngşruby_gear.pngşruby_get.pngşruby_go.pngşruby_key.pngşruby_link.pngşruby.pngşruby_put.pngşscript_add.pngşscript_code.pngşscript_code_red.pngşscript_delete.pngşscript_edit.pngşscript_error.pngşscript_gear.pngşscript_go.pngşscript_key.pngşscript_lightning.pngşscript_link.pngşscript_palette.pngşscript.pngşscript_save.pngşserver_add.pngşserver_chart.pngşserver_compressed.pngşserver_connect.pngşserver_database.pngşserver_delete.pngşserver_edit.pngşserver_error.pngşserver_go.pngşserver_key.pngşserver_lightning.pngşserver_link.pngşserver.pngşserver_uncompressed.pngşshading.pngşshape_align_bottom.pngşshape_align_center.pngşshape_align_left.pngşshape_align_middle.pngşshape_align_right.pngşshape_align_top.pngşshape_flip_horizontal.pngşshape_flip_vertical.pngşshape_group.pngşshape_handles.pngşshape_move_back.pngşshape_move_backwards.pngşshape_move_forwards.pngşshape_move_front.pngşshape_rotate_anticlockwise.pngşshape_rotate_clockwise.pngşshape_square_add.pngşshape_square_delete.pngşshape_square_edit.pngşshape_square_error.pngşshape_square_go.pngşshape_square_key.pngşshape_square_link.pngşshape_square.pngşshape_ungroup.pngşshield_add.pngşshield_delete.pngşshield_go.pngşshield.pngşsitemap_color.pngşsitemap.pngşsound_add.pngşsound_delete.pngşsound_low.pngşsound_mute.pngşsound_none.pngşsound.pngşspellcheck.pngşsport_8ball.pngşsport_basketball.pngşsport_football.pngşsport_golf.pngşsport_raquet.pngşsport_shuttlecock.pngşsport_soccer.pngşsport_tennis.pngşstar.pngşstatus_away.pngşstatus_busy.pngşstatus_offline.pngşstatus_online.pngşstop.pngşstyle_add.pngşstyle_delete.pngşstyle_edit.pngşstyle_go.pngşstyle.pngşsum.pngştab_add.pngştab_delete.pngştab_edit.pngştab_go.pngştable_add.pngştable_delete.pngştable_edit.pngştable_error.pngştable_gear.pngştable_go.pngştable_key.pngştable_lightning.pngştable_link.pngştable_multiple.pngştable.pngştable_refresh.pngştable_relationship.pngştable_row_delete.pngştable_row_insert.pngştable_save.pngştable_sort.pngştab.pngştag_blue_add.pngştag_blue_delete.pngştag_blue_edit.pngştag_blue.pngştag_green.pngştag_orange.pngştag_pink.pngştag.pngştag_purple.pngştag_red.pngştag_yellow.pngştelephone_add.pngştelephone_delete.pngştelephone_edit.pngştelephone_error.pngştelephone_go.pngştelephone_key.pngştelephone_link.pngştelephone.pngştelevision_add.pngştelevision_delete.pngştelevision.pngştext_align_center.pngştext_align_justify.pngştext_align_left.pngştext_align_right.pngştext_allcaps.pngştext_bold.pngştext_columns.pngştext_dropcaps.pngştextfield_add.pngştextfield_delete.pngştextfield_key.pngştextfield.pngştextfield_rename.pngştext_heading_1.pngştext_heading_2.pngştext_heading_3.pngştext_heading_4.pngştext_heading_5.pngştext_heading_6.pngştext_horizontalrule.pngştext_indent.pngştext_indent_remove.pngştext_italic.pngştext_kerning.pngştext_letter_omega.pngştext_letterspacing.pngştext_linespacing.pngştext_list_bullets.pngştext_list_numbers.pngştext_lowercase.pngştext_padding_bottom.pngştext_padding_left.pngştext_padding_right.pngştext_padding_top.pngştext_replace.pngştext_signature.pngştext_smallcaps.pngştext_strikethrough.pngştext_subscript.pngştext_superscript.pngştext_underline.pngştext_uppercase.pngşthumb_down.pngşthumb_up.pngştick.pngştime_add.pngştime_delete.pngştime_go.pngştimeline_marker.pngştime.pngştransmit_add.pngştransmit_blue.pngştransmit_delete.pngştransmit_edit.pngştransmit_error.pngştransmit_go.pngştransmit.pngştux.pngşuser_add.pngşuser_comment.pngşuser_delete.pngşuser_edit.pngşuser_female.pngşuser_go.pngşuser_gray.pngşuser_green.pngşuser_orange.pngşuser.pngşuser_red.pngşuser_suit.pngşvcard_add.pngşvcard_delete.pngşvcard_edit.pngşvcard.pngşvector_add.pngşvector_delete.pngşvector.pngşwand.pngşweather_clouds.pngşweather_cloudy.pngşweather_lightning.pngşweather_rain.pngşweather_snow.pngşweather_sun.pngşwebcam_add.pngşwebcam_delete.pngşwebcam_error.pngşwebcam.pngşworld_add.pngşworld_delete.pngşworld_edit.pngşworld_go.pngşworld_link.pngşworld.pngşwrench_orange.pngşwrench.pngşxhtml_add.pngşxhtml_delete.pngşxhtml_go.pngşxhtml.pngşxhtml_valid.pngşzoom_in.pngşzoom_out.pngşzoom.png000092MOBI.APPSş0c2SUB.D3ADMINıSUB.MOBI.APP.MENUıSUB.MOBI.WOıSUB.TESTşAıIıAıAşD3 AdministrationıApplication ChooserıDemo WO ApplicationıDemo Application00007BMONTHLY.2013ş0c277869980ş89686980ş89000910ş77900940ş58970340ş67198860ş71869680ş80687070ş74287080ş58871070ş68257080ş8878968000007BMONTHLY.2014ş0c286522200ş99652200ş98889900ş86556600ş65522600ş74665400ş79855200ş89652300ş82541200ş65412300ş75841200ş98655200000073MONTHLY.2015ş0c296543200ş80145600ş88854000ş96501100ş95012300ş96512100ş84563200ş105236800ş98521000ş64414400ş5888660000007FMONTHLY.GPS.2013ş0c226517550ş28806410ş31786017ş29914744ş20915414ş22019619ş23275705ş28006808ş27998227ş22781623ş24704258ş3250054900007FMONTHLY.GPS.2014ş0c229463944ş32007122ş35317797ş33238604ş23239349ş24466243ş25861894ş31118676ş31109141ş25312914ş27449175ş36111721000076MONTHLY.GPS.2015ş0c236796778ş32936845ş33965425ş37984720ş34865781ş36545082ş31976227ş41016726ş35949343ş23315342ş21977139000073MONTHLY.NET.2014ş0c22946394ş3200712ş3531779ş3323860ş2323934ş2446624ş2586189ş3111867ş3110914ş2531291ş2744917ş361117200006CMONTHLY.NET.2015ş0c29654320ş8014560ş8885400ş9650110ş9501230ş9651210ş8456320ş10523680ş9852100ş6441440ş5888660000081MONTHLY.PARTS.2014ş0c241437844ş52242841ş47585401ş43842542ş36090673ş36395560ş41646485ş58547188ş41895322ş32831266ş40749858ş47292673000078MONTHLY.PARTS.2015ş0c249608696ş51350055ş53344946ş45243183ş62544291ş44956837ş42935385ş57601358ş54084263ş31465039ş29950454000084MONTHLY.SERVICES.2014ş0c245084356ş47409359ş51304499ş42714058ş29431927ş38269840ş38208715ş31105112ş40645878ş32581034ş35091342ş5136252700007BMONTHLY.SERVICES.2015ş0c246934504ş28795545ş35509054ş51257917ş32468009ş51555263ş41627815ş47635442ş44436737ş32949361ş2893614600000EPLATFORMş0c2UV000288STATE.NAMESş0c2AL,AK,AZ,AR,CA,CO,CT,DE,FL,GA,HI,ID,IL,IN,IA,KS,KY,LA,ME,MD,MA,MI,MN,MS,MO,MT,NE,NV,NH,NJ,NM,NY,NC,ND,OH,OK,OR,PA,RI,SC,SD,TN,TX,UT,VT,VA,WA,WV,WI,WY,DCşAlabama,Alaska,Arizona,Arkansas,California,Colorado,Connecticut,Delaware,Florida,Georgia,Hawaii,Idaho,Illinois,Indiana,Iowa,Kansas,Kentucky,Louisiana,Maine,Maryland,Massachusetts,Michigan,Minnesota,Mississippi,Missouri,Montana,Nebraska,Nevada,NewHampshire,NewJersey,NewMexico,NewYork,NorthCarolina,NorthDakota,Ohio,Oklahoma,Oregon,Pennsylvania,RhodeIsland,SouthCarolina,SouthDakota,Tennessee,Texas,Utah,Vermont,Virginia,Washington,WestVirginia,Wisconsin,Wyoming,DistrictofColumbia000040TLDB.SETTINGSş0c2SUB.USER.AUTHş1ş10ş83ş1ş-5şşşiso-8859-1şNşNşşşş00005FTLDB.THEMESş0c2cream_gray.css,ice.css,patriotic.css,tuscani.cssşTheme 1,Theme 2,Theme 3,Theme 400024ECOMPILE.SETUPş0c2BASIC %FILENAME% %ITEMNAME%ş* To configure the compile command when using the web editorş* edit line # 1 of this record to contain the appropriate syntax.ş*ş* Example # 1 - Standard compile using BASICş* 001 BASIC %FILENAME% %ITEMNAME%ş*ş* Example # 2 - FLASH compile using BASICş* 001 BASIC %FILENAME% %ITEMNAME% (Oş*ş* Example # 3 - Standard compile using COMPILEş* 001 COMPILE %FILENAME% %ITEMNAME%ş*ş* Only line # 1 of this record is used, all other lines of this record are ignored.ş* If this record is deleted, the default behavior is:ş* COMPILE %FILENAME% %ITEMNAME%0000A1FC2DPIE.SETTINGSş0c2<graph caption='[CHART.TITLE]' decimalPrecision='0' showNames='1' showValues='0'ş pieRadius='[RADIUS]' animation='0' >ş [CHART.DATA]ş</graph>0000B3PORTAL.SALES.REPORT.SETUPş0c2MVDBşPORTAL.SALESşCLOSE.DATEşCLOSE.DATE.MMşCLOSE.DATE.YYYYşEXT.AMTşEXT.COSTşREP.NAMEşBRANCHşREGIONş1ş99şMD24şF8;9;10;-;(MR2);*ş0şşş5şTREP;X;1;1ş13şş14000070PORTAL.AR.REPORT.SETUPş0c2MVDBşPORTAL.ARşDUE.DATEşDATES.PAIDşINVOICE.AMTşBALANCEşCUSTş20ş8ş6şMD2şş50şMD2şşCUSTş1000062PORTAL.AP.REPORT.SETUPş0c2MVDBşPORTAL.APşDUE.DATEşDATE.PAIDşINV.AMOUNTşBALANCEşş20ş8ş6şMD2şş50şMD2055506WDB.BPş0c000021DSET.COOKIEş0c2SUBROUTINE SET.COOKIE( C.VAL )ş**********************************************************************ş* Copyright (C) 2003 Sierra Bravo Corporation, All Rights Reservedş*ş* Written By   : Michael Schmidt, Sierra Bravo Corporationş* Date Written : 10/25/03ş* Description  : This program sets the SESSION$COOKIES variable.ş*              ş**********************************************************************ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD WWW.INCLUDEş*şIF TRIM(C.VAL) # "" THENş  SESSION$COOKIES<-1> = C.VALşENDş*şRETURNş*000872CREATE.SESSIONş0c2SUBROUTINE CREATE.SESSION( SESSION.ID )ş*ş* Copyright (C) 2003 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Michael Derheim, Sierra Bravoş* Date: 10/25/03ş* Description: This program creates a unique session record andş*              returns the session id to the calling program.ş*ş*          WARNING: This program relys on MvInternet to generateş*                       its unique ID.  If you are testing your programş*                       from TCL, this will FAIL and you will not getş*                       any session ID returned.ş*ş* Modified by  : Mike Schmidt, Sierra Bravo Corporationş* Date Revised : 11/6/2003ş* Modification : Modified to add the date and time to attributes 3 and 4.ş*ş* Modified By: Peter Schellenbach, Zumasysş* Date: 06/12/2015ş* Description: Changed PROCREAD to use SENTENCE() in the ELSE clauseş*ş* Modified By: Peter Schellenbach, Zumasysş* Date: 10/25/2016ş* Description: Added INCLUDE WWW.INCLUDE so we have access to F.WEB.SESSIONş*              in /WWW/ COMMON, instead of opening file here. Use F.WEB.SESSIONş*              instead of WEB.SESSION for file variable. Removed PROCREAD /ş*              SENTENCE since CGI$UNIQUE.ID is also in /WWW/ COMMON.ş*ş* Initş*#MAKE# RL $OPTIONS D3şEQU FALSE TO 0, TRUE TO 1şEQU AM TO CHAR(254), VM TO CHAR(253), SVM TO CHAR(252)ş*şINCLUDE WBPD WWW.INCLUDE ; *PJS 10-25-16*ş*şSESSION.ID = ''ş*ş*PJS 10-25-16*OPEN '','WEB.SESSION' TO WEB.SESSION ELSE SESSION.ID = 'ERROR'ş*PJS 06-12-15*PROCREAD TCL.LINE ELSE TCL.LINE = ""; SESSION.ID = 'ERROR'ş*PJS 10-25-16*PROCREAD TCL.LINE ELSE TCL.LINE = SENTENCE(); *PJS 06-12-15*ş*PJS 10-25-16*SESSION.ID = FIELD( TCL.LINE, ' ', 2 )ş*şSESSION.ID = CGI$UNIQUE.ID ;* PJS 10-25-16*şIF SESSION.ID = "" THEN SESSION.ID = "ERROR" ; *PJS 06-12-15*şCONVERT '{' TO '' IN SESSION.IDşCONVERT '}' TO '' IN SESSION.IDş*şIF (SESSION.ID # 'ERROR') THENş  SESSION.ID = SESSION.ID:'-':DATE():'-':TIME()ş  SESSION.REC = ""ş  SESSION.REC<3> = DATE()ş  SESSION.REC<4> = TIME()ş  WRITE SESSION.REC ON F.WEB.SESSION, SESSION.IDşENDşSESSION$ID = SESSION.IDşCALL PUT.SESSION.VAR('LastSessionAccess', DATE():'*':TIME())ş*şRETURNş*şEND0173DEMVDB.MAINş0c2*ş* Copyright (C) 2007 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Luke Bucklin, Sierra Bravoş* Date: November, 2007ş* Description: Dashboard Display Programş*ş* 1-5-15 TOM PARKER OF ZUMASYS - CHANGES TO SUPPORT MULTI-SERIES DRILLDOWNSş* 1-26-15 TOM PARKER OF ZUMASYS - ALLOW PRINTABLE ON ALL CHART TYPE SINCEş*         NEW FUSION CHARTS SUPPORT THEMş* 3-4-15 TOM PARKER OF ZUMASYS - DONT STRIP OUT DECIMALS IN W$BAR.VALUESş* 3-15-15 TOM PARKER OF ZUMASYS - ADDITIONAL CHANGE TO SUPPORT MULTI-SERIESş* 6-4-15 PETER SCHELLENBACH OF ZUMASYS - MODIFIED FOR QMş*          CHANGE OCONV(X,'U3060') TO MD5(X)ş*ş* Modified by Peter Schellenbach of Zumasys 07-17-15 for UV compatiblity:ş*   Added $OPTIONS TIME.MILLISECONDS to so that SYSTEM(12) returns milliseconds, not seconds.ş*   When testing for cataloged program, check if line 1 is 'V', not 'VR'.ş*   Change U3060 user exist to use DIGEST('MD5',...) instead.ş*ş* 11-30-15 TOM PARKER - PROVIDE WEBSERVICE ACCESS WITH EMBEDDED USER AND PASSWORDş*ş* 12-15-15 & 01-14-16 Tom Parker & Peter Schellenbach (*PDF*)ş*  Added support for PDF generation of any widget.ş*  Widget subroutine must set W$PDFABLE to 1 to enable PDF generation.ş*  PDF generation must be enabled in the PDF Configuration widget, onş*  the Administrator dashboard.ş* 01-25-16 Tom Parker - Do not allow Go Back if doing webserviceş* 04-25-16 Tom Parker - Make Go Back button fully functional for backingş*                       up from drilldownsş* 6-1-16 TOM PARKER - FIX ISSUES WITH BACKING UP FROM DRILLDOWNş* 06-27-16 Tom Parker & Peter Schellenback (*EXCEL*)ş*  Added support for EXCEL spreadsheet generation of many widgets.ş*  Widget type must be EXCEL'able to set W$EXCELABLE to 1 to generate iconş*ş* 09-23-16 Tom Parker - Eliminate GO_BACK button support and replace withş*          logic to handle standard browser back buttonş*  ş* 09-23-16 Peter Schellenbachş*  Add support for alternate logo defined for each user (MVDB.USERS attr 7).ş*  Enable 'datepicker' style input fields.ş*  Fix single user login problem.ş*  ş* 10-07-16 Peter Schellenbachş*  If form contains many widget input controls, use POST instead of GETş*  for form submission to avoid URL length limitations.ş*ş*  Because POST method for login and widget inputs causes browser to promptş*  for resubmit when using back or refresh button, the POST-REDIRECT-GETş*  pattern is now used. When responding to POST, we return small javascriptş*  which REDIRECTS by setting window.location. This causes a GET from browser.ş*ş* 10-25-16 Peter Schellenbachş*  Refactored INIT.WWW so all dashboard specific initialization is now inş*  MVDB.INIT which is called from here. Only use POST-REDIRECT-GET patternş*  for login page. Use POST without P-R-G for forms with more than 20 inputsş*  so that we don't end up with a bogus URL in the browser location (theş*  URL used for redirect is bogus, and cannot be used to create emailed orş*  webservice URLs).ş*ş*  Removed the saving of GLOBAL.USER.DATA and WIDGET.USER.DATA from thisş*  program and move it to MVDB.INIT, saving before letting MVDB.MAIN handleş*  the request.ş*ş* 11-02-16 Peter Schellenbachş*  Fine-tuned widget sizes now that we have switched to application_larger.cssş*  instead of application_normal.css to maximuze the are used by the charts.ş*  Calculate the 1/3 widget size differently for the 2-column layout, whichş*  is 45 pixels wider than the same widget in 3-column layout. Old size valuesş*  are commented out for reference (in case we need to support normal size again.)ş*ş$OPTIONS TIME.MILLISECOND *PJS 07-17-15 UV*ş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEşINCLUDE WBPD FI.MVDB.USERSşINCLUDE WBPD FI.MVDB.DEFSşINCLUDE WBPD FI.MVDB.WIDGETSşINCLUDE WBPD FI.MVDB.WIDGET.TYPESş*şEQU TRUE TO 1, FALSE TO 0, AM TO CHAR(254), VM TO CHAR(253), SVM TO CHAR(252)ş*şOPEN '','MVDB.WIDGETS' TO F.MVDB.WIDGETS ELSE STOP 201, 'MVDB.WIDGETS'şOPEN '','MVDB.SUBS' TO F.MVDB.SUBS ELSE STOP 201, 'MVDB.SUBS'şOPEN '','MVDB.USERS' TO F.MVDB.USERS ELSE STOP 201, 'MVDB.USERS'şOPEN '','MVDB.DEFS' TO F.MVDB.DEFS ELSE STOP 201, 'MVDB.DEFS'şOPEN '','MVDB.UDATA' TO F.MVDB.UDATA ELSE STOP 201, 'MVDB.UDATA'şOPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSE STOP 201, 'MVDB.CONTROL'ş*ş** 11-30-15 NEED AN INSTALL DATE TO CONTROL SINGLE USER WEBSERVICE ACCESSş*şREAD INSTALL.DATE FROM F.MVDB.CONTROL, 'INSTALL.DATE' ELSEş   INSTALL.DATE=DATE()ş   WRITE INSTALL.DATE ON F.MVDB.CONTROL, 'INSTALL.DATE'ş ENDş*şOPEN '','MVDB.MAP.DATA' TO F.MVDB.MAP.DATA ELSE STOP 201, 'MVDB.MAP.DATA'şOPEN '','MVDB.WIDGET.TYPES' TO F.MVDB.WIDGET.TYPES ELSE STOP 201, 'MVDB.WIDGET.TYPES'şOPEN '','MVDB.THEMES' TO F.MVDB.THEMES ELSE STOP 201, 'MVDB.THEMES'şOPEN '','MD' TO F.MD ELSEş  OPEN '','VOC' TO F.MD ELSE STOP 201, 'MD/VOC'şENDş*şREAD WIDGET.DIV FROM F.WEB.FORMS, "WIDGET.DIV" ELSE WIDGET.DIV = "Missing WIDGET.DIV"ş*şDIM SITE$SETTINGS(100)şEQU SITE$AUTH.SUB     TO SITE$SETTINGS(1)şEQU SITE$NULL.PW.OK   TO SITE$SETTINGS(2)şEQU SITE$W.MAX.DUR    TO SITE$SETTINGS(3)şEQU SITE$TCP.PORT     TO SITE$SETTINGS(4)şEQU SITE$ALT.LOGO     TO SITE$SETTINGS(7)şEQU SITE$THEME        TO SITE$SETTINGS(8)şEQU SITE$CHARSET      TO SITE$SETTINGS(9)şEQU SITE$AUTO.TRIM    TO SITE$SETTINGS(10)şEQU SITE$REFRESH TO SITE$SETTINGS(11)şEQU SITE$ALLOW.WEBSVC TO SITE$SETTINGS(12)şEQU SITE$ALLOW.EMAILD TO SITE$SETTINGS(13)ş*şMATREAD SITE$SETTINGS FROM F.MVDB.CONTROL, "MVDB.SETTINGS" ELSE MAT SITE$SETTINGS = ""şREAD THEME.LIST FROM F.MVDB.CONTROL, "MVDB.THEMES" ELSEş THEME.LIST = "cream_gray.css,ice.css,patriotic.css,tuscani.css"ş THEME.LIST<2> = "Theme 1,Theme 2,Theme 3,Theme 4"ş WRITE THEME.LIST ON F.MVDB.CONTROL, "MVDB.THEMES"şENDşIF SITE$CHARSET = '' THEN SITE$CHARSET = 'UTF-8'ş*MATREAD SITE$SETTINGS FROM F.MVDB.CONTROL, "MVDB.SETTINGS" ELSE MAT SITE$SETTINGS = ""şREADV THEME.CSS FROM F.MVDB.THEMES, SITE$THEME, 1 ELSE THEME.CSS = ''şIF SITE$ALT.LOGO = '' THENş  SITE.LOGO = '/db/images/mv-logo.png'şEND ELSEş  SITE.LOGO = SITE$ALT.LOGOş  IF NOT(INDEX(SITE.LOGO,'/',1)) THENş    SITE.LOGO = '/db/images/':SITE.LOGOş  ENDşENDş*şMAT GLOBAL.INFO = ''şG$QUERYMODE = FALSE ;* Not query modeş*ş*PDF*ş* Read PDF configuration settingsşDIM PDF$SETTINGS(10)şEQU PDF$ENABLED   TO PDF$SETTINGS(1)şEQU PDF$COMMAND   TO PDF$SETTINGS(2)şEQU PDF$DIRECTORY TO PDF$SETTINGS(3)şEQU PDF$LIFETIME  TO PDF$SETTINGS(4)şMATREAD PDF$SETTINGS FROM F.MVDB.CONTROL,'PDF.SETTINGS' ELSE MAT PDF$SETTINGS=''şIF PDF$ENABLED THEN CALL SUB.PDF.FUNC('cleanup','')ş*ş* GET LICENSE INFORMATIONş*şCALL SUB.MVDB.FEATURES(USER.LIMIT,MAPS.ENABLED,FUSION.WIDGETS.ENABLED,WATERMARK)ş*şNAME.COLOR = "AQUA":VM:"BLACK":VM:"BLUE":VM:"FUCHSIA":VM:"GRAY":VM:"GREEN":VM:"LIME":VM:"MAROON":VM:"NAVY"şNAME.COLOR = NAME.COLOR:VM:"OLIVE":VM:"PURPLE":VM:"RED":VM:"SILVER":VM:"TEAL":VM:"WHITE":VM:"YELLOW":VM:"GREY"şNAME.COLOR<2> = "#00FFFF":VM:"#000000":VM:"#0000FF":VM:"#FF00FF":VM:"#808080":VM:"#008000":VM:"#00FF00":VM:"#800000":VM:"#000080"şNAME.COLOR<2> = NAME.COLOR<2>:VM:"#808000":VM:"#800080":VM:"#FF0000":VM:"#C0C0C0":VM:"#008080":VM:"#FFFFFF":VM:"#FFFF00":VM:"#808080"ş*şLOCATE "logout" IN CGI$VARS SETTING POS THENş  CALL DESTROY.SESSIONşENDşCALL GET.SESSION.VAR("userid",userid)şCALL GET.SESSION.VAR("adminauth",adminauth)şLOCATE "psid" IN CGI$VARS SETTING POS THENş  PURGE.SESSIONID = CGI$VALS<POS>ş  EXECUTE "MVDB.PURGE.SESSIONS ":PURGE.SESSIONID CAPTURING JUNKşENDşMAT USER.ITEM = "" ;* PJS 09-23-16: make sure this gets initialized, in case of webservice or emailed reportsş* 11-30-15 ESTABLISH WEBSERVICE VARIABLESşDIM W$WEBSERVICE.DATA(5)şMATREAD W$WEBSERVICE.DATA FROM F.MVDB.UDATA,SESSION$ID:"$WEBSERVICE" ELSE MAT W$WEBSERVICE.DATA=''şEQU W$WEBSERVICE TO W$WEBSERVICE.DATA(1)şEQU W$EMAILED.REPORT TO W$WEBSERVICE.DATA(2)şHTML.ID=''şIF userid = "" THENş  LOGIN.OK = FALSEş  LOGIN.MSG = ""  ş  loginid = "" ; password = ""ş  LOCATE "loginid" IN CGI$VARS SETTING POS THENş    loginid = CGI$VALS<POS>ş    LOCATE "password" IN CGI$VARS SETTING POS THENş      password = CGI$VALS<POS>ş    ENDş  ENDş*WEBSERVICE*  IF loginid # "" AND (password # "" OR SITE$NULL.PW.OK=1) THENş*WEBSERVICE*    IF SITE$AUTH.SUB # "" THENş*WEBSERVICE*      READ CATPTR FROM F.MD, SITE$AUTH.SUB ELSE CATPTR = ""      ş*WEBSERVICE*      *PJS 07-17-15 UV* IF CATPTR<1> = "VR" THENş*WEBSERVICE*      IF CATPTR<1> = "V" THEN ; *PJS 07-17-15 UV*ş*WEBSERVICE*        CALL @SITE$AUTH.SUB(loginid,password,"AUTH",LOGIN.OK,LOGIN.MSG,MAT USER.ITEM)ş*WEBSERVICE*        IF LOGIN.OK = "Y" THEN LOGIN.OK = TRUEş*WEBSERVICE*        IF NOT(LOGIN.OK MATCHES "1N0N") THEN LOGIN.OK = FALSEş*WEBSERVICE*      END ELSEş*WEBSERVICE*        LOGIN.OK = FALSEş*WEBSERVICE*        LOGIN.MSG = SITE$AUTH.SUB:" authentication subroutine not cataloged."ş*WEBSERVICE*      ENDş*WEBSERVICE*    END ELSEş*WEBSERVICE*      MATREAD USER.ITEM FROM F.MVDB.USERS, loginid THENş*WEBSERVICE*      *PJS 07-17-15 UV* IF OCONV(password,"U3060") = USER.PASSWORD THENş*WEBSERVICE*        IF DIGEST('MD5',password,1,ENCR.PASSWORD) = 0 THENş*WEBSERVICE*          ENCR.PASSWORD = OCONV(ENCR.PASSWORD,'MX0C') ; *PJS 07-17-15 UV*ş*WEBSERVICE*          IF ENCR.PASSWORD = USER.PASSWORD THEN ; *PJS 07-17-15 UV*ş*WEBSERVICE*            LOGIN.OK = TRUEş*WEBSERVICE*          ENDş*WEBSERVICE*        ENDş*WEBSERVICE*      ENDş*WEBSERVICE*    ENDş  *ş  ** 11-30-15 WEBSERVICE AND EMAILED REPORT CAPABILITY LOGICş  *ş  IF loginid = 'emailed' THEN W$EMAILED.REPORT=1ş  IF loginid = 'webservice' THEN W$WEBSERVICE=1ş  LOCATE "htmlid" IN CGI$VARS SETTING POS THENş    HTML.ID = CGI$VALS<POS>ş  END ELSEş    HTML.ID='null'ş  ENDş  IF loginid # "" AND (W$EMAILED.REPORT OR password # "" OR SITE$NULL.PW.OK=1) THENş     LOCATE 'passtime' IN CGI$VARS SETTING PASSTIME.POS ELSE PASSTIME.POS=0ş     IF PASSTIME.POS THENş        PASSTIME=CGI$VALS<PASSTIME.POS>ş        CONVERT ':' TO '' IN PASSTIMEş      END ELSE PASSTIME=''ş     BEGIN CASEş        CASE PASSTIME AND loginid = 'webservice'ş           EXECUTE "MVDB.PURGE.SESSIONS webservice" CAPTURING JUNK; * PURGE ANY OLD webservicesş           IF PASSTIME MATCHES '6N' THENş              IPASSTIME = ICONV(PASSTIME[1,2]:':':PASSTIME[3,2]:':':PASSTIME[5,2],'MT')ş           END ELSEş              IPASSTIME = -601 ;* Ensure the time is expired if not 6 digits!ş           ENDş           BEGIN CASEş              CASE SITE$ALLOW.WEBSVC # 'Y'ş                 * webservice login is not enabledş                 LOGIN.OK = FALSEş                 LOGIN.MSG = 'Webservice login is not enabled'ş              CASE USER.LIMIT < 2 AND DATE() > (INSTALL.DATE+30)ş                 * MUST HAVE A MULTI USER LICENSE TO USE WEBSERVICE AFTERş                 * 30 DAY TRIAL PERIODş                 LOGIN.OK = FALSEş                 LOGIN.MSG = 'Must have a multi-user license to use webservices'ş              CASE ABS(TIME()-IPASSTIME) > 600ş                 * TIME MUST BE WITHIN 10 MINUTES OF MACHINE TIMEş                 LOGIN.OK = FALSEş                 *LOGIN.MSG = 'Request not synced with system time.'ş                 LOGIN.MSG = 'The request URL has expired. This may be due to differences in the system 'ş                 LOGIN.MSG := 'clock on the MV Dashboard server and the clock used to generate the URL.'ş              CASE 1ş                 * VALID PASSWORD IS THE SUM OF MMDDYY + SSMMHH (FROM PASSTIME)ş                 * INVERT THE TIME TO SSMMHHş                 EMITSSAP=''ş                 FOR TIME.I = 6 TO 1 STEP -1ş                    EMITSSAP:=PASSTIME[TIME.I,1]ş                  NEXT TIME.Iş                 *OTODAY=OCONV(DATE(),'D2-')ş                 *CONVERT '-' TO '' IN OTODAYş                 TODAY.MM=OCONV(DATE(),'DM')'R%%'ş                 TODAY.DD=OCONV(DATE(),'DD')'R%%'ş                 TODAY.YY=OCONV(DATE(),'DY')'R%%'ş                 OTODAY = TODAY.MM:TODAY.DD:TODAY.YY ;* handle non-USA date formats properlyş                 CALCED.PASSWORD=OTODAY+EMITSSAPş                 IF password MATCHES '6N' THEN CHECKED.PASSWORD = password + 0 ELSE CHECKED.PASSWORD = -1ş                 IF CALCED.PASSWORD = CHECKED.PASSWORD THENş                    LOGIN.OK = TRUEş                    USER.ROLE=''ş*                    CALL PUT.SESSION.VAR("userid",loginid)ş                 END ELSEş                    LOGIN.OK = FALSEş                    LOGIN.MSG = 'Invalid password'ş                 ENDş           END CASEş        CASE loginid = 'emailed'ş           EXECUTE "MVDB.PURGE.SESSIONS emailed" CAPTURING JUNK; * PURGE ANY OLD emailedş           OPEN '','MVDB.EMAILED.HTML' TO F.EMAILED.HTML ELSE STOP 201, 'MVDB.EMAILED.HTML'ş           *ş           ** PURGED ANY EMAIL REPORTS OVER 10 DAYS OLDş           *ş           EXECUTE 'SELECT MVDB.EMAILED.HTML' CAPTURING JUNKş           LOOPş              READNEXT EMAILED.ID ELSE EMAILED.ID='DONE'ş           UNTIL EMAILED.ID='DONE' DOş              IF (EMAILED.ID[1,5]+10) < DATE() THENş                 DELETE F.EMAILED.HTML, EMAILED.IDş              ENDş           REPEATş           IF SITE$ALLOW.EMAILD # 'Y' THENş              * emaild login is not enabledş              LOGIN.OK = FALSEş              LOGIN.MSG = 'Emailed login is not enabled'ş           END ELSEş              READV TEST.HTML.REPORT FROM F.EMAILED.HTML, HTML.ID, 1 ELSE TEST.HTML.REPORT='NOTFOUND'ş              IF TEST.HTML.REPORT = 'NOTFOUND' THENş                 LOGIN.OK = FALSEş                 LOGIN.MSG = 'Emailed report not found with ID of ':HTML.IDş              END ELSEş                 USER.ROLE=''ş                 LOGIN.OK = TRUEş                 INSERT.VARS='dbname':AM:'udview':AM:'udpos1':AM:'udval1'ş                 INSERT.VALS='Emailed Report':AM:'Emailed Report':AM:1:AM:HTML.IDş                 CGI$VARS=INSERT(CGI$VARS,1,0,0,INSERT.VARS)ş                 CGI$VALS=INSERT(CGI$VALS,1,0,0,INSERT.VALS)ş              ENDş           ENDş        CASE SITE$AUTH.SUB # ""ş           READ CATPTR FROM F.MD, SITE$AUTH.SUB ELSE CATPTR = ""ş           *PJS 07-17-15 UV* IF CATPTR<1> = "VR" THENş           IF CATPTR<1> = "V" THEN ; *PJS 07-17-15 UV*ş             CALL @SITE$AUTH.SUB(loginid,password,"AUTH",LOGIN.OK,LOGIN.MSG,MAT USER.ITEM)ş             IF LOGIN.OK = "Y" THEN LOGIN.OK = TRUEş             IF NOT(LOGIN.OK MATCHES "1N0N") THEN LOGIN.OK = FALSEş           END ELSEş             LOGIN.OK = FALSEş             LOGIN.MSG = SITE$AUTH.SUB:" authentication subroutine not cataloged."ş           ENDş        CASE 1ş           MATREAD USER.ITEM FROM F.MVDB.USERS, loginid THENş             *PJS 07-17-15 UV* IF OCONV(password,"U3060") = USER.PASSWORD THENş             IF DIGEST('MD5',password,1,ENCR.PASSWORD) = 0 THENş               ENCR.PASSWORD = OCONV(ENCR.PASSWORD,'MX0C') ; *PJS 07-17-15 UV*ş               IF ENCR.PASSWORD = USER.PASSWORD THEN ; *PJS 07-17-15 UV*ş                 LOGIN.OK = TRUEş*                 CALL PUT.SESSION.VAR("userid",loginid)ş               ENDş             ENDş           ENDş     END CASEş  ENDş  IF LOGIN.OK THENş    EXECUTE "MVDB.PURGE.SESSIONS" CAPTURING JUNK ;* Purge out old session dataş    *ş    SELECT F.WEB.SESSIONş    ACTIVE.SESSIONS = ""ş    USER.ACTIVE.SESSIONS = ""ş    LOOPş      READNEXT WSID ELSE EXITş      READ SREC FROM F.WEB.SESSION, WSID ELSE CONTINUEş      LOCATE "userid" IN SREC<1> SETTING UPOS THENş        ASUSER = SREC<2,UPOS>ş        LOCATE "LastSessionAccess" IN SREC<1> SETTING UPOS THENş          ASDATE = FIELD(SREC<2,UPOS>,'*',1) ;* dateş          ASTIME = FIELD(SREC<2,UPOS>,'*',2) ;* timeş          ASAGE = (DATE()-ASDATE) * 86400ş          ASAGE += (TIME()-ASTIME)ş        END ELSE ASAGE = 0ş        IF OCONV(ASUSER,'MCU') = OCONV(loginid,'MCU') THENş          LOCATE ASAGE IN USER.ACTIVE.SESSIONS<3> BY "DR" SETTING ASPOS ELSE NULLş          USER.ACTIVE.SESSIONS = INSERT( USER.ACTIVE.SESSIONS, 1, ASPOS, 0, WSID )ş          USER.ACTIVE.SESSIONS = INSERT( USER.ACTIVE.SESSIONS, 2, ASPOS, 0, ASUSER ) ;* User IDş          USER.ACTIVE.SESSIONS = INSERT( USER.ACTIVE.SESSIONS, 3, ASPOS, 0, ASAGE )ş        END ELSEş          LOCATE ASAGE IN ACTIVE.SESSIONS<3> BY "DR" SETTING ASPOS ELSE NULLş          ACTIVE.SESSIONS = INSERT( ACTIVE.SESSIONS, 1, ASPOS, 0, WSID )ş          ACTIVE.SESSIONS = INSERT( ACTIVE.SESSIONS, 2, ASPOS, 0, ASUSER ) ;* User IDş          ACTIVE.SESSIONS = INSERT( ACTIVE.SESSIONS, 3, ASPOS, 0, ASAGE )ş        ENDş      ENDş    REPEATş    *Merge active sessions for this user in front of ş    *the other sessions to prefer those sessions for cleanup.ş    IF USER.ACTIVE.SESSIONS # '' THENş      ACTIVE.SESSIONS = INSERT( ACTIVE.SESSIONS, 1, 1, 0, USER.ACTIVE.SESSIONS<1> )ş      ACTIVE.SESSIONS = INSERT( ACTIVE.SESSIONS, 2, 1, 0, USER.ACTIVE.SESSIONS<2> )ş      ACTIVE.SESSIONS = INSERT( ACTIVE.SESSIONS, 3, 1, 0, USER.ACTIVE.SESSIONS<3> )ş    ENDş    ASCNT = DCOUNT( ACTIVE.SESSIONS<1>, @VM )ş    IF ASCNT > USER.LIMIT THENş      PURGE.LIST = ""ş      LOOP WHILE ASCNT > USER.LIMIT DOş        PURGE.LIST := ACTIVE.SESSIONS<1,1>:" "ş        ACTIVE.SESSIONS = DELETE( ACTIVE.SESSIONS, 1, 1, 0 )ş        ACTIVE.SESSIONS = DELETE( ACTIVE.SESSIONS, 2, 1, 0 )ş        ACTIVE.SESSIONS = DELETE( ACTIVE.SESSIONS, 3, 1, 0 )ş        ASCNT -= 1ş      REPEATş      EXECUTE "MVDB.PURGE.SESSIONS ":PURGE.LIST CAPTURING JUNKş    ENDş    IF ASCNT = USER.LIMIT THENş      * Logging in will force a user to log offş      IF SITE$AUTO.TRIM = 'Y' THENş        EXECUTE "MVDB.PURGE.SESSIONS ":ACTIVE.SESSIONS<1,1> CAPTURING JUNKş      END ELSEş        READ MSG.TEMPLATE FROM F.WEB.FORMS, "message.html" ELSE MSG.TEMPLATE = "message.html not found."ş        CALL SWAP(MSG.TEMPLATE,'<!-- MSG_TITLE -->',"User limit exceeded.")ş        CALL SWAP(MSG.TEMPLATE,'<!-- SITE_LOGO -->',SITE.LOGO)ş        CALL SWAP(MSG.TEMPLATE,'<!-- SITE_THEME -->',THEME.CSS)ş        MSG.CONTENT = \<p>Your maximum user limit has been reached. If you choose to log in, user "\:ACTIVE.SESSIONS<2,1>ş        MSG.CONTENT := \" will be logged out and the user's session data will be lost.</p>\ş        MSG.CONTENT := '<a href="/dbc/MVDB.MAIN?psid=':ACTIVE.SESSIONS<1,1>:'">Click here</a> to log ':ACTIVE.SESSIONS<2,1>:' out and try again.</a>'ş        CALL SWAP(MSG.TEMPLATE,'<!-- MSG_CONTENT -->',MSG.CONTENT)ş        CALL WEB.SEND(MSG.TEMPLATE)ş        GLOBAL.INFO(100) = 1ş        STOPş      ENDş    ENDş    CALL PUT.SESSION.VAR("userid",loginid)ş    userid = loginidş    CALL PUT.SESSION.VAR("login_date",DATE())ş    CALL PUT.SESSION.VAR("login_time",TIME())ş  END ELSEş    READ LOGIN.PAGE FROM F.WEB.FORMS, "login.html" ELSE LOGIN.PAGE = "login.html not found."ş    IF loginid # "" THENş      IF LOGIN.MSG = "" THEN LOGIN.MSG = "Invalid user ID or Password"ş      CALL SWAP(LOGIN.PAGE,'<!-- ERROR -->',LOGIN.MSG)ş    ENDş    CALL SWAP(LOGIN.PAGE,'<!-- SITE_LOGO -->',SITE.LOGO)ş    CALL SWAP(LOGIN.PAGE,'<!--CHARACTER_SET-->',SITE$CHARSET)    ş    CALL SWAP(LOGIN.PAGE,'<!-- SITE_THEME -->',THEME.CSS)ş    CALL WEB.SEND(LOGIN.PAGE)ş    GLOBAL.INFO(100) = 1 ;* Intentional Stopş    STOPş  ENDşEND ELSEş  * Get the user item.ş  * If a custom authentication subroutine is in use, we have to call thatş  * subroutine again in order to get the user record populatedş  IF SITE$AUTH.SUB # "" THENş    READ CATPTR FROM F.MD, SITE$AUTH.SUB ELSE CATPTR = ""ş    *PJS 07-17-15 UV* IF CATPTR<1> = "VR" THENş    IF CATPTR<1> = "V" THEN ; *PJS 07-17-15 UV*ş      CALL @SITE$AUTH.SUB(userid,"","READ",LOGIN.OK,LOGIN.MSG,MAT USER.ITEM)ş    END ELSE MAT USER.ITEM = ""ş  END ELSEş    MATREAD USER.ITEM FROM F.MVDB.USERS, userid ELSE MAT USER.ITEM = ''ş  ENDşENDşIF USER.ROLE = "Administrator" AND NOT(adminauth) THENş  * The user is an admin based on the USER.ROLE setting in their user recordş  adminauth = 1ş  CALL PUT.SESSION.VAR("adminauth",adminauth)şENDşG$ADMIN.USER = adminauthş*şG$USERID = useridş* 10-07-16 Implement the POST-REDIRECT-GET pattern to prevent the browserş* from prompting before resubmit when using back or refresh buttons afterş* a POST (used for login form only at this time).şLOCATE "REQUEST_METHOD" IN CGI$VARS SETTING POS THENş  IF CGI$VALS<POS> = "POST" THENş    LOCATE "dblogin" IN CGI$VARS SETTING POS THENş      IF CGI$VALS<POS> THENş        * Redirect to MVDB.MAIN default dashboard after valid loginş        HTML = ''ş        HTML<-1> = '<html>'ş        HTML<-1> = '<body>'ş        HTML<-1> = '<script type="text/javascript">'ş        HTML<-1> = 'window.location="':CGI$PATH:'/MVDB.MAIN?dbname=";' ;* start with default dashboard after loginş        HTML<-1> = '</script>'ş        HTML<-1> = '</body>'ş        HTML<-1> = '</html>'ş        CALL WEB.SEND(HTML)ş        GLOBAL.INFO(100) = 1 ;* Intentional Stopş        STOPş      ENDş    ENDş    * handle P-R-G for widget input form submitş*    WRITE CGI$VARS ON F.MVDB.UDATA,SESSION$ID:'$POSTVARS'ş*    WRITE CGI$VALS ON F.MVDB.UDATA,SESSION$ID:'$POSTVALS'ş*    HTML = ''ş*    HTML<-1> = '<html>'ş*    HTML<-1> = '<body>'ş*    HTML<-1> = '<script type="text/javascript">'ş*    HTML<-1> = 'window.location="':CGI$PATH:'/MVDB.MAIN?dbprg=1";'ş*    HTML<-1> = '</script>'ş*    HTML<-1> = '</body>'ş*    HTML<-1> = '</html>'ş*    CALL WEB.SEND(HTML)ş*    GLOBAL.INFO(100) = 1 ;* Intentional Stopş*    STOPş*  ENDşENDş*LOCATE "dbprg" IN CGI$VARS SETTING POS THENş*  IF CGI$VALS<POS> THENş*    READ CGI$VARS FROM F.MVDB.UDATA,SESSION$ID:'$POSTVARS' THENş*      READ CGI$VALS FROM F.MVDB.UDATA,SESSION$ID:'$POSTVALS' ELSE CGI$VALS = ''ş*    ENDş*    DELETE F.MVDB.UDATA,SESSION$ID:'$POSTVARS'ş*    DELETE F.MVDB.UDATA,SESSION$ID:'$POSTVALS'ş*  ENDş*ENDş* END OF 10-07-16ş*şLOCATE 'generatepdf' IN CGI$VARS SETTING GENERATE.PDF ELSE GENERATE.PDF=0; * 4-25-16şLOCATE 'generateexcel' IN CGI$VARS SETTING GENERATE.EXCEL ELSE GENERATE.EXCEL=0; *EXCEL* 6-27-16şW$EXCELABLE=0;   *EXCEL* 6-27-16şGO.BACK=0;   * 4-25-16ş*şGOBACK.REENTRY:; * 4-25-16ş*ş* udview, if present, is the view name to which  the associatedş* udpos and udval parameters apply.şLOCATE "udview" IN CGI$VARS SETTING POS THENş  udview = CGI$VALS<POS>şEND ELSE udview = ""ş*şLOCATE "dbname" IN CGI$VARS SETTING POS THENş  CALL PUT.SESSION.VAR("current_db",CGI$VALS<POS>)şENDş*şLOCATE 'refresh' IN CGI$VARS SETTING POS THENş  *really, this should be stored in the user record per db keyş  IF CGI$VALS<POS> = '0' THEN CGI$VALS<POS> = ''ş  CALL GET.SESSION.VAR("current_db",r.current.db)ş  IF r.current.db = '' THEN r.current.db = USER.DEFAULT.DBş  CALL PUT.SESSION.VAR(r.current.db:"!refresh",CGI$VALS<POS>)şENDş*9-23-16**ş*9-23-16*** 4-25-16 SUPPORT AUTOMATIC BACKOUT FROM A DRILLDOWNş*9-23-16**ş*9-23-16**EXCEL*IF NOT(GO.BACK) AND NOT(GENERATE.PDF) THENş*9-23-16*IF NOT(GO.BACK) AND NOT(GENERATE.PDF) AND NOT(GENERATE.EXCEL) THEN; *EXCEL* 6-27-16ş*9-23-16*   CALL DRILLDOWN.STACK.RTNE(F.MVDB.UDATA,DRILLDOWN.STACK,GO.BACK)ş*9-23-16*   IF GO.BACK THEN GOTO GOBACK.REENTRYş*9-23-16*END ELSEş*9-23-16*   DRILLDOWN.STACK = ""ş*9-23-16*ENDşDRILLDOWN.STACK=''; *9-23-16şG$DRILLDOWN.MODE = FALSEşLOCATE "dd" IN CGI$VARS SETTING POS THENş   IF CGI$VALS<POS> <> '' THENş      G$DRILLDOWN.MODE = TRUEş   ENDşENDş*9-23-16** END OF 4-25-16ş*şLOCATE "sw" IN CGI$VARS SETTING POS THENş  FORM.SUBMIT.WIDGET = CGI$VALS<POS>şEND ELSE FORM.SUBMIT.WIDGET = ""ş*şIF G$DRILLDOWN.MODE THENş  * This is a drill-down call. Load up the "drilldown" dashboardş  * and populate it only with this single widget.ş  LOCATE "dd_from" IN CGI$VARS SETTING POS THENş    G$DD.REFERRER = CGI$VALS<POS>ş  ENDş  LOCATE "dd_from_db" IN CGI$VARS SETTING POS THENş    G$DD.FROM.DB = CGI$VALS<POS>ş  ENDş  G$CURRENT.DB = "drilldown"ş  MAT DB.ITEM = ''ş  READV DD.FROM.DB.THEME FROM F.MVDB.DEFS, G$DD.FROM.DB, 7 ELSE DD.FROM.DB.THEME = ''ş  DB.THEME = DD.FROM.DB.THEMEş  DB.WIDGETS = udviewşEND ELSEş  CALL GET.SESSION.VAR("current_db",current.db)ş  IF current.db # "" THENş    G$CURRENT.DB = current.dbş  END ELSEş    * No current dashboard is available in the session.ş    * Must be the first time through. Go get the default.ş    G$CURRENT.DB = USER.DEFAULT.DBş    IF G$CURRENT.DB = '' THEN G$CURRENT.DB = "EMPTY" ;* Empty dashboardş  ENDş  *ş  MATREAD DB.ITEM FROM F.MVDB.DEFS, G$CURRENT.DB ELSE MAT DB.ITEM = ''şENDşIF DB.THEME # '' THENş  READV THEME.CSS FROM F.MVDB.THEMES, DB.THEME, 1 ELSE THEME.CSS = ''şEND ELSEş  READV THEME.CSS FROM F.MVDB.THEMES, SITE$THEME, 1 ELSE THEME.CSS = ''şENDş*ş* PJS 09-23-16: user altertnate logo overrides site logoşIF USER.ALT.LOGO <> '' THENş  SITE.LOGO = USER.ALT.LOGOşEND ELSEşIF SITE$ALT.LOGO = '' THENş  SITE.LOGO = '/db/images/mv-logo.png'şEND ELSEş  SITE.LOGO = SITE$ALT.LOGOş  ENDşENDşIF NOT(INDEX(SITE.LOGO,'/',1)) THENş  SITE.LOGO = '/db/images/':SITE.LOGOşENDş*şCALL GET.SESSION.VAR("login_date",login.date)şCALL GET.SESSION.VAR("login_time",login.time)şG$LOGIN.DATE = login.dateşG$LOGIN.TIME = login.timeş*ş*PDF*ş* When generating a PDF, get name of widget to render into PDF.ş* When generating iframe content, get the HTML widget name toş* show in the iframe.şWIDGET.OWN.STYLE = FALSEşSINGLE.WIDGET = ""şPDF.WIDGET.NAME = ""ş* 4-25-16 *IF PDF$ENABLED THENş* 4-25-16 *  LOCATE 'generatepdf' IN CGI$VARS SETTING POS ELSE POS=0ş* 4-25-16 *  IF POS THENş* 4-25-16 *    PDF.WIDGET.NAME = CGI$VALS<POS>ş* 4-25-16 *    SINGLE.WIDGET = PDF.WIDGET.NAMEş* 4-25-16 *  ENDş* 4-25-16 *ENDş*ş** 4-25-16 CHANGED LOGICş*şIF PDF$ENABLED AND GENERATE.PDF THENş  PDF.WIDGET.NAME = CGI$VALS<GENERATE.PDF>ş  SINGLE.WIDGET = PDF.WIDGET.NAMEş  W$PDFABLE=1ş  DB.WIDGETS=PDF.WIDGET.NAMEşENDş* END OF 4-25-16ş*ş**EXCEL* 6-27-16 ADDED LOGICş*şIF GENERATE.EXCEL THENş  EXCEL.WIDGET.NAME = CGI$VALS<GENERATE.EXCEL>ş  SINGLE.WIDGET = EXCEL.WIDGET.NAMEş  W$EXCELABLE=1ş  DB.WIDGETS=EXCEL.WIDGET.NAMEşEND ELSE EXCEL.WIDGET.NAME=''ş* END OF 6-27-16şIFRAME.WIDGET.NAME = ""şLOCATE 'iframewidget' IN CGI$VARS SETTING POS ELSE POS=0şIF POS THENş  IFRAME.WIDGET.NAME = CGI$VALS<POS>ş  SINGLE.WIDGET = IFRAME.WIDGET.NAMEşENDş*ş* Build a list of subroutines to call to create this dashboardş*şDISP.CNT = DCOUNT( DB.WIDGETS, VM )şWIDGET.NAME.POS = FALSEşFOR DX = 1 TO DISP.CNTş  MATREAD WIDGET.ITEM FROM F.MVDB.WIDGETS, DB.WIDGETS<1,DX> THENş    ADD.OK = TRUEş    IF WIDGET.USERS = "ADMIN" THENş      IF NOT(adminauth) THEN ADD.OK = FALSE ;* Only usable by authenticated adminsş    END ELSE IF WIDGET.USERS # "" THEN ;* Some user restrictions have been assignedş      LOCATE userid IN WIDGET.USERS<1> SETTING POS ELSE ADD.OK = FALSEş    ENDş    IF ADD.OK THENş      *PDF* if generating PDF or iframe content, exclude other widgetsş      *EXCEL* also applies to generating EXCELş      IF SINGLE.WIDGET = "" OR SINGLE.WIDGET = DB.WIDGETS<1,DX> THENş        WIDGET.NAME.POS += 1ş        G$WIDGET.NAME.LIST<1,WIDGET.NAME.POS> = DB.WIDGETS<1,DX>ş        G$WIDGET.SUB.LIST<1,WIDGET.NAME.POS> = WIDGET.SUBş      ENDş    ENDş  ENDşNEXT DXş*şDIM TEMPLATE.AREA(5)şMAT TEMPLATE.AREA = ''ş*şMAT GLOBAL.TEMP.DATA = '' ;* InitializeşMATREAD GLOBAL.USER.DATA FROM F.MVDB.UDATA, SESSION$ID:"$UG" ELSE MAT GLOBAL.USER.DATA = ''ş*şCALL GET.SESSION.VAR("debug_widgets",DEBUG.WIDGETS) ;* Retrieve a list of widgets user is debuggingşIF adminauth THEN ;* Only administrators can put widgets into debug mdoe.ş  LOCATE "debug_widget" IN CGI$VARS SETTING POS THENş    DEBUG.WIDGET = CGI$VALS<POS>ş    LOCATE DEBUG.WIDGET IN DEBUG.WIDGETS SETTING POS ELSEş      DEBUG.WIDGETS<-1> = DEBUG.WIDGETş      CALL PUT.SESSION.VAR("debug_widgets",DEBUG.WIDGETS)ş    ENDş  ENDş  LOCATE "undebug_widget" IN CGI$VARS SETTING POS THENş    UNDEBUG.WIDGET = CGI$VALS<POS>ş    LOCATE UNDEBUG.WIDGET IN DEBUG.WIDGETS SETTING DPOS THENş      DEBUG.WIDGETS = DELETE( DEBUG.WIDGETS, DPOS, 0, 0 )ş      CALL PUT.SESSION.VAR("debug_widgets",DEBUG.WIDGETS)ş    ENDş  ENDşENDş*şCALL GET.SESSION.VAR("failed_widgets",FAILED.WIDGETS) ;* Retrieve a list of failed widgets this sessionşLOCATE "unfail_widget" IN CGI$VARS SETTING POS THENş  * The user has asked to take this widget out of failed mode and try running the widget again.ş  UNFAIL.WIDGET = CGI$VALS<POS>ş  LOCATE UNFAIL.WIDGET IN FAILED.WIDGETS SETTING DPOS THENş    FAILED.WIDGETS = DELETE( FAILED.WIDGETS, DPOS, 0, 0 )ş    CALL PUT.SESSION.VAR("failed_widgets",FAILED.WIDGETS)ş  ENDşENDş*ş* Was there a running widget that didn't complete? If so, it's a failed widget that didn't returnş* control to MVDB.MAIN. Let's add it to the list of failed widgets this session so we can avoidş* producing blank pages for the user.ş*şCALL GET.SESSION.VAR("running_widget",FAILED.WIDGET)şCALL GET.SESSION.VAR("running_widget_dt",FAILED.WIDGET.DT)şIF FAILED.WIDGET # "" THENş  FW.DATE = FIELD( FAILED.WIDGET.DT, '*', 1 )ş  FW.TIME = FIELD( FAILED.WIDGET.DT, '*', 2 )ş  FW.LAPSE = TIME() - FW.TIMEş  FW.LAPSE += ((DATE() - FW.DATE) * 86400)ş  IF SITE$W.MAX.DUR = "" THEN SITE$W.MAX.DUR = 10 ;* Defaultş  IF FW.LAPSE < SITE$W.MAX.DUR THEN FAILED.WIDGET = ""şENDşIF FAILED.WIDGET # "" THENş  CALL PUT.SESSION.VAR("running_widget","")ş  CALL PUT.SESSION.VAR("running_widget_dt","")ş  LOCATE FAILED.WIDGET IN FAILED.WIDGETS SETTING FWPOS ELSEş    FAILED.WIDGETS<-1> = FAILED.WIDGETş    CALL PUT.SESSION.VAR("failed_widgets",FAILED.WIDGETS)ş  ENDşENDş*ş* Widgets appearing in FAILED.WIDGETS and DEBUG.WIDGETS are both hijacked at runtime, and ourş* SUB.DEBUG.WIDGET subroutine is executed in place of the subroutine in the widget definition.ş* The difference is that FAILED.WIDGETS are widgets that this program has determined to haveş* failed. DEBUG.WIDGETS are functional widgets that the user has put into debug mode.ş* In both cases, the widget remains in this list until the user removes it using controls ş* within the SUB.DEBUG.WIDGET widget.ş*şWIDGET.CNT = DCOUNT( G$WIDGET.NAME.LIST, VM )şFOR VX = 1 TO WIDGET.CNTş  WIDGET.NAME = G$WIDGET.NAME.LIST<1,VX>ş  MATREAD WIDGET.ITEM FROM F.MVDB.WIDGETS, WIDGET.NAME ELSE MAT WIDGET.ITEM = ''ş*9-23-16** FIX 6-1-16 *  MATREAD WIDGET.USER.DATA FROM F.MVDB.UDATA, SESSION$ID:"$":WIDGET.NAME ELSE MAT WIDGET.USER.DATA = ''ş*9-23-16** FIX 6-1-16 *ş*9-23-16*  IF GO.BACK THEN ş*9-23-16*     MAT WIDGET.USER.DATA=''ş*9-23-16*   END ELSEş*9-23-16*     MATREAD WIDGET.USER.DATA FROM F.MVDB.UDATA, SESSION$ID:"$":WIDGET.NAME ELSE MAT WIDGET.USER.DATA = ''ş*9-23-16*   ENDş*9-23-16** END OF 6-1-16ş  MATREAD WIDGET.USER.DATA FROM F.MVDB.UDATA, SESSION$ID:"$":WIDGET.NAME ELSE MAT WIDGET.USER.DATA = ''; *9-23-16*ş  *ş  MAP.TYPE.SUFFIX = ""ş  IF WIDGET.NAME = udview THENş    * We need to set values in WIDGET.USER.DATA before calling this routineş    * Process links.ş    UDN = 1ş    SEARCH.DONE = FALSEş    LOOPş      SEARCH.NAME = "udpos":UDNş      LOCATE SEARCH.NAME IN CGI$VARS SETTING POS THENş        udpos = CGI$VALS<POS>ş        IF udpos MATCHES "1N0N" THENş          IF udpos < 1 OR udpos > 100 THEN UDN +=1 ; CONTINUEş        END ELSE UDN += 1 ; CONTINUEş        SEARCH.NAME = "udval":UDNş        LOCATE SEARCH.NAME IN CGI$VARS SETTING POS THENş          WIDGET.USER.DATA(udpos) = CGI$VALS<POS>ş        ENDş      END ELSE SEARCH.DONE = TRUEş    UNTIL SEARCH.DONE DOş      UDN += 1ş    REPEATş    * Process Inputs.ş    VARCNT = DCOUNT( CGI$VARS, AM )ş    FOR CGIVX = 1 TO VARCNTş      IF CGI$VARS<CGIVX>[1,4] = "inp_" THENş        udpos = FIELD(CGI$VARS<CGIVX>,'_',2)ş        IF udpos MATCHES "1N0N" THENş          IF udpos >= 1 AND udpos <= 100 THENş            WIDGET.USER.DATA(udpos) = CGI$VALS<CGIVX>ş          ENDş        ENDş      ENDş      *Look for checkboxes that didn't come backş      *and stuff a zero in there.ş      IF CGI$VARS<CGIVX>[1,9] = 'mvdbcxbx_' THENş        udpos = FIELD(CGI$VARS<CGIVX>,'_',2)ş        LOCATE 'inp_':udpos IN CGI$VARS SETTING CXBX.POS ELSEş          IF udpos >= 1 AND udpos <= 100 THENş            WIDGET.USER.DATA(udpos) = 0ş          ENDş        ENDş      ENDş    NEXT CGIVXş    *ş    LOCATE 'mapdd' IN CGI$VARS SETTING POS THENş      * This is a map drilldown. Get the map name from the state codeş      STATE.CODE = WIDGET.USER.DATA(1)ş      READ STATE.NAMES FROM F.MVDB.CONTROL, 'STATE.NAMES' ELSE STATE.NAMES = ""ş      CONVERT "," TO @VM IN STATE.NAMESş      LOCATE STATE.CODE IN STATE.NAMES<1> SETTING STATE.POS THENş        WIDGET.USER.DATA(2) = STATE.NAMES<2,STATE.POS>ş        MAP.TYPE.SUFFIX = STATE.CODE ;* Add this to the widget typeş      ENDş    ENDş  ENDş  *ş  * If this is a USA map widget set in drill-down mode for a specific stateş  * that state name will be in WIDGET.USER.DATA(1). This code below is necessaryş  * to ensure that the widget stays in the state map mode until the userş  * changes it.ş  *ş  IF MAP.TYPE.SUFFIX = "" THEN MAP.TYPE.SUFFIX = WIDGET.USER.DATA(1)<1>ş  *ş  IF FORM.SUBMIT.WIDGET = WIDGET.NAME THENş    * The user clicked the "go" button on the form section of this widget.ş    G$SUBMITTED = 1ş  END ELSEş    G$SUBMITTED = 0ş  ENDş  *ş  * The widget debugger uses GLOBAL.INFO(90) to determine if the widget is in debugş  * mode due to user request, or if it is being forced into debug mode by MVDB.MAINş  *ş  GLOBAL.INFO(90) = ""ş  GLOBAL.INFO(91) = G$WIDGET.SUB.LIST<1,VX> ;* Original subroutine nameş  WDEBUG.MODE = 0 ; WFAIL.MODE = 0ş  *ş  LOCATE WIDGET.NAME IN FAILED.WIDGETS SETTING DUM THENş    * This widget failed last time we tried to run it. Let's run the "Failed Widget" subroutine instead.ş    * This subroutine will have access to all of the information that would have been passed to theş    * failed widget, so diagnostic information can be presented through this widget.ş    GLOBAL.INFO(90) = "FAIL"ş    SUBNAME = "SUB.DEBUG.WIDGET"ş    WFAIL.MODE = 1ş  END ELSEş    LOCATE WIDGET.NAME IN DEBUG.WIDGETS SETTING DUM THENş      GLOBAL.INFO(90) = "DEBUG"ş      SUBNAME = "SUB.DEBUG.WIDGET"ş      WDEBUG.MODE = 1ş    END ELSEş      SUBNAME = G$WIDGET.SUB.LIST<1,VX>ş    ENDş  ENDş  MAT WIDGET.INFO = "" ;* clear this one out for the new callş  G$WIDGET.NAME = WIDGET.NAMEş  G$WIDGET.SUB = SUBNAMEş  G$WIDGET.CALL.TIME<1,VX> = DATE():"*":TIME()ş*#MAKE# RL IF 0 THENş  START.TIMER = SYSTEM(12)ş*#MAKE# RL ENDş  READ TST FROM F.MD, SUBNAME THENş    CALL PUT.SESSION.VAR("running_widget",WIDGET.NAME)ş    DT.STAMP = DATE():"*":TIME()ş    CALL PUT.SESSION.VAR("running_widget_dt",DT.STAMP)ş    CALL @SUBNAMEş    CALL PUT.SESSION.VAR("running_widget","")ş    CALL PUT.SESSION.VAR("running_widget_dt","")ş  END ELSEş    W$TITLE = WIDGET.NAME:" (ERROR)"ş    W$TYPE = "TEXT"ş    W$TEXT.DATA = SUBNAME:" not cataloged."ş  ENDş  * Special handling for drill-down to a state level on a USA Mapş  IF W$TYPE = "USAMAP" AND MAP.TYPE.SUFFIX # "" THENş    W$TYPE := ":":MAP.TYPE.SUFFIXş  ENDş*#MAKE# RL IF 0 THENş  G$WIDGET.CALL.DUR<1,VX> = SYSTEM(12) - START.TIMERş*#MAKE# RL ENDş  MATWRITE WIDGET.USER.DATA ON F.MVDB.UDATA, SESSION$ID:"$":WIDGET.NAMEş  *ş  IF NOT(W$HIDDEN) THENş    *EXCEL* 6-27-16 DETERMINE IF W$TYPE CAN GENERATE EXCELş    BEGIN CASEş       CASE W$EXCELABLE; NULLş       CASE W$TYPE = 'TABLE'; W$EXCELABLE=1ş       CASE INDEX(W$TYPE,'COLUMN',1); W$EXCELABLE=1ş       CASE INDEX(W$TYPE,'LINE',1); W$EXCELABLE=1ş       CASE INDEX(W$TYPE,'BAR',1); W$EXCELABLE=1ş       CASE INDEX(W$TYPE,'AREA',1); W$EXCELABLE=1ş       CASE INDEX(W$TYPE,'PIE',1); W$EXCELABLE=1ş       CASE INDEX(W$TYPE,'DOUGHNUT',1); W$EXCELABLE=1ş       CASE 1; W$EXCELABLE=0ş    END CASEş    *EXCEL* END OF 6-27-16ş    GOSUB MAKE.HTMLş    LOCATE WIDGET.NAME IN DB.WIDGETS<1> SETTING DB.DEFS.POS THENş      AREA = DB.WIDGET.AREA<1,DB.DEFS.POS>ş      IF NOT(AREA MATCHES "1N0N") THEN AREA = 1ş      IF AREA < 1 OR AREA > 5 THEN AREA = 1ş    END ELSE AREA = 1        ş    TEMPLATE.AREA(AREA)<-1> = HTML.DIVş  ENDşNEXT VXş*şMATWRITE GLOBAL.USER.DATA ON F.MVDB.UDATA,SESSION$ID:"$UG"şMATWRITE W$WEBSERVICE.DATA ON F.MVDB.UDATA,SESSION$ID:"$WEBSERVICE"; *11-30-15ş*ş* Send templateş*ş*PDF* Use special inner template for PDF & iframesşIF IFRAME.WIDGET.NAME # "" THENş  * iframe content just contains widget-generated HTML, no extra styles, script, etc.ş  TEMPLATE = "<!-- AREA1 --><!-- AREA2 --><!-- AREA3 --><!-- AREA4 --><!-- AREA5 -->"şEND ELSEş  IF PDF.WIDGET.NAME # "" THENş    IF WIDGET.OWN.STYLE THENş      * Widget HTML has <head> tag - supplies its own stylesş      TEMPLATE = "<!-- AREA1 --><!-- AREA2 --><!-- AREA3 --><!-- AREA4 --><!-- AREA5 -->"ş    END ELSEş      * PDF template has single <div> for all "areas"ş      READ TEMPLATE FROM F.WEB.FORMS, "pdf_inner_template" ELSE TEMPLATE = "pdf_inner_template not found."ş    ENDş  END ELSEş    * normal widget template with area for header, 3 columns & footerş    READ TEMPLATE FROM F.WEB.FORMS, "db_inner_template" ELSE TEMPLATE = "db_inner_template not found."ş  ENDşENDşCALL SWAP(TEMPLATE,'<!-- column_style -->',"layout":DB.TEMPLATE)ş*şFOR AX = 1 TO 5ş  CALL SWAP(TEMPLATE,"<!-- AREA":AX:" -->",TEMPLATE.AREA(AX))şNEXT AXş*ş*PDF* Use special PDF html template for PDF outputşIF IFRAME.WIDGET.NAME # "" THENş  * iframe content just contains widget-generated HTML, no extra styles, script, etc.ş  MAIN.TEMPLATE = "<!-- DASHBOARD -->"şEND ELSEş  IF PDF.WIDGET.NAME # "" THENş    IF WIDGET.OWN.STYLE THENş      * Widget HTML has <head> tag - supplies its own stylesş      MAIN.TEMPLATE = "<!-- DASHBOARD -->"ş    END ELSEş      * PDF template does not include print, refresh, header or footerş      READ MAIN.TEMPLATE FROM F.WEB.FORMS, "pdftemplate" ELSE MAIN.TEMPLATE = "pdftemplate missing."ş    ENDş  END ELSEş    * normal dashboard templateş    READ MAIN.TEMPLATE FROM F.WEB.FORMS, "dbtemplate" ELSE MAIN.TEMPLATE = "dbtemplate missing."ş  ENDşENDş*ş* Insert header stuffşADMIN.HEADER = ""şIF adminauth = 1 THENş  ADMIN.HEADER := '<li class="admin_tab"><a href="':CGI$PATH:'/MVDB.ADMIN">Admin Area</a></li>'şENDşADMIN.HEADER := '<li class="admin_tab"><a href="':CGI$PATH:'/MVDB.MAIN?logout">Log Out</a></li>'şHEADER = '<div id="dashboard_nav"><ol class="dashboard_list">'şCALL SWAP(MAIN.TEMPLATE,'<!--CHARACTER_SET-->',SITE$CHARSET)ş*11-30-15*EXECUTE "SSELECT MVDB.DEFS BY DB.SORT" CAPTURING JUNKşIF NOT(W$EMAILED.REPORT) AND NOT(W$WEBSERVICE) THEN EXECUTE "SSELECT MVDB.DEFS BY DB.SORT" CAPTURING JUNK; *11-30-15şDB.LIST = ''şLOOPş  READNEXT ID ELSE EXITş  DB.LIST<-1> = IDşREPEATşDB.CNT = DCOUNT( DB.LIST, AM )şFOR DBX = 1 TO DB.CNTş  ID = DB.LIST<DBX>ş  MATREAD DB.ITEM FROM F.MVDB.DEFS, ID ELSE MAT DB.ITEM = ""ş  ADD.OK = TRUEş  IF DB.USERS.ALLOWED = "ADMIN" THENş    IF NOT(adminauth) THEN ADD.OK = FALSE ;* This is only for authenticated adminsş  END ELSE IF DB.USERS.ALLOWED # "" THEN ;* Some user restrictions have been assigned ş    LOCATE userid IN DB.USERS.ALLOWED<1> SETTING POS ELSE ADD.OK = FALSE ş  END ş  IF ADD.OK = TRUE THENş    IF ID = G$CURRENT.DB THENş      HEADER := '<li class="db_active"><a href="':CGI$PATH:'/MVDB.MAIN?dbname=':ID:'">':ID:'</a></li>'ş    END ELSEş      HEADER := '<li><a href="':CGI$PATH:'/MVDB.MAIN?dbname=':ID:'">':ID:'</a></li>'ş    ENDş    HEADER := CHAR(10)ş  ENDşNEXT DBXşHEADER := ADMIN.HEADERşHEADER := '</ol></div>'şIF THEME.CSS # '' THEN THEME.CSS = '<link rel="Stylesheet" href="/db/themes/':THEME.CSS:'" media="screen" type="text/css" />'şCALL SWAP(MAIN.TEMPLATE,'<!-- HEADER -->',HEADER)şCALL SWAP(MAIN.TEMPLATE,'<!-- SITE_LOGO -->',SITE.LOGO)şCALL SWAP(MAIN.TEMPLATE,'<!-- SITE_THEME -->',THEME.CSS)ş* Insert footer stuffşFOOTER = ''ş*01-25-16*IF G$DRILLDOWN.MODE THENş*4-25-16*IF G$DRILLDOWN.MODE AND NOT(W$WEBSERVICE) THEN; *01-25-16ş*4-25-16*  IF G$DD.FROM.DB # "" THENş*4-25-16*    URLENCODE.STRING = G$DD.FROM.DBş*4-25-16*    GOSUB URL.ENCODEş*4-25-16*    DB.URL = NEW.STRINGş*4-25-16*    FOOTER = '<a href="/dbc/MVDB.MAIN?dbname=':DB.URL:'">Go Back</a><br />'ş*4-25-16*  ENDş*4-25-16*ENDş*9-23-16**ş*9-23-16*** 4-25-16 NEW SUPPORT FOR ALLOWING BACKUPş*9-23-16**ş*9-23-16*IF DRILLDOWN.STACK<2> <> '' THENş*9-23-16*   FOOTER='<a href="/dbc/MVDB.MAIN?dbname=go_back">Go Back</a><br />'ş*9-23-16* ENDş*9-23-16** END OF 4-25-16şIF WATERMARK # '' THENş  FOOTER := WATERMARK:'<br/>'şENDşCALL SWAP(MAIN.TEMPLATE,'<!-- FOOTER -->',FOOTER)ş*şCALL GET.SESSION.VAR(G$CURRENT.DB:"!refresh",REFRESH.RATE)şREFRESH = ""şIF REFRESH.RATE # '' THENş  RATES = "1":VM:"2":VM:"3":VM:"4":VM:"5":VM:"6":VM:"7":VM:"8":VM:"9"ş  RATES<2> = "15":VM:"30":VM:"60":VM:"120":VM:"300":VM:"600":VM:"900":VM:"1800":VM:"3600"ş  LOCATE REFRESH.RATE IN RATES<1> SETTING RPOS THENş    REFRESH = "<meta http-equiv='refresh' content='":RATES<2,RPOS>:"'>"ş  ENDşENDş*şIF SITE$REFRESH = 'Y' THENş  READ REFRESH.SLIDER FROM F.WEB.FORMS, 'RefreshSlider' ELSE REFRESH.SLIDER=''ş  CALL SWAP(MAIN.TEMPLATE,'<!-- RefreshSlider -->',REFRESH.SLIDER)ş  CALL SWAP(MAIN.TEMPLATE,'<!-- REFRESH_RATE -->',REFRESH.RATE)ş  CALL SWAP(MAIN.TEMPLATE,'<!-- REFRESH -->',REFRESH)ş  READ TRACK FROM F.WEB.FORMS, 'outerTrackWrapper' ELSE TRACK = ''ş  CALL SWAP(MAIN.TEMPLATE,'<!-- outerTrackWrapper -->',TRACK)  şENDşCALL SWAP(MAIN.TEMPLATE,'<!-- DASHBOARD -->',TEMPLATE)ş*ş*PDF* Generate the PDF from HTML in MAIN.TEMPLATEşIF PDF$ENABLED AND W$PDFABLE AND PDF.WIDGET.NAME # "" THENş  CALL SUB.PDF.FUNC('generate', MAIN.TEMPLATE)ş  MAIN.TEMPLATE = ''şENDş*EXCEL* Generate the EXCEL from HTML in MAIN.TEMPLATEş* 6-27-16  *EXCEL*şIF W$EXCELABLE AND EXCEL.WIDGET.NAME # "" THENş  CALL SUB.EXCEL.FUNC('generate', MAIN.TEMPLATE,EXCEL.WIDGET.NAME)şENDş* END OF 6-27-16 *EXCEL*ş*ş*ş** 9-23-16 NEW DRILLDOWN AND BACKUP LOGIC REQUIRES SAVING GLOBAL.USER.DATAş**         AT COMPLETION OF PROCESSş*ş*READ DD.STACK FROM F.MVDB.UDATA, SESSION$ID:'$DD.STACK' ELSE DD.STACK=''ş*DD.LEVEL=DCOUNT(DD.STACK,AM)ş*IF NOT(DD.LEVEL) THEN DD.LEVEL=1ş*MATWRITE GLOBAL.USER.DATA ON F.MVDB.UDATA, SESSION$ID:'$DD.':DD.LEVEL:'.GUD'ş*MATWRITE WIDGET.USER.DATA ON F.MVDB.UDATA, SESSION$ID:'$':WIDGET.NAME:'$DD.':DD.LEVEL:'.WUD'; * 9-23-16ş*şCALL WEB.SEND(MAIN.TEMPLATE)şGLOBAL.INFO(100) = 1 ;* Process completed successfullyşSTOPş*şMAKE.HTML: *ş*şHTML = ''şMATREAD WIDGET.TYPES FROM F.MVDB.WIDGET.TYPES, W$TYPE ELSE MAT WIDGET.TYPES = ""şWIDGET.OWN.STYLE = FALSE ;*PDF* set to TRUE if widget-generated HTML includes <head> tagş*şBEGIN CASEş  CASE WT$GROUP = "LC" OR WT$GROUP = "BAR"ş    IF WT$GROUP = "BAR" THEN CHART.TYPE = "BAR" ELSEş      CHART.TYPE = "FCLINECOL"ş      MULTI.SERIES = (WT$HANDLER = "M")ş    ENDş    CALL XML.ENCODE(W$BAR.VALUES,"")ş    CALL XML.ENCODE(W$BAR.LABELS,"")ş    CALL XML.ENCODE(W$BAR.XLABELS,"")ş    CALL XML.ENCODE(W$BAR.XMEMO,"")ş    CALL XML.ENCODE(W$BAR.YMEMO,"")ş    CALL XML.ENCODE(W$BAR.CAPTION,"")ş    *1-26-15* W$PRINTABLE = 0ş  CASE WT$GROUP = "PIE"ş    CHART.TYPE = WT$HANDLERş    CALL XML.ENCODE(W$PIE.LABELS,"")ş    CALL XML.ENCODE(W$PIE.VALUES,"")ş    CALL XML.ENCODE(W$PIE.CAPTION,"")ş    *1-26-15* W$PRINTABLE = 0ş  CASE WT$GROUP = "FW"ş    CHART.TYPE = WT$HANDLERş    FW.NAME = WT$SWFş    CALL XML.ENCODE(W$FW.LOWER.LIMIT.LABEL,"")ş    CALL XML.ENCODE(W$FW.UPPER.LIMIT.LABEL,"")ş    CALL XML.ENCODE(W$FW.CAPTION,"")ş    CALL XML.ENCODE(W$FW.SUBCAPTION,"")ş    CALL XML.ENCODE(W$FW.TRENDPOINT.LABELS,"")ş    *1-26-15* W$PRINTABLE = 0ş  CASE FIELD(W$TYPE,':',1) = "MAP"ş    CHART.TYPE = "MAP"ş    CHART.TYPE<2> = FIELD( W$TYPE,':',2)ş    *1-26-15* W$PRINTABLE = 0ş  CASE W$TYPE = "USAMAP"ş    CHART.TYPE = "MAP"ş    CHART.TYPE<2> = "USA"ş    *1-26-15* W$PRINTABLE = 0ş  CASE 1ş    CHART.TYPE = W$TYPEşEND CASEş*şCHK.VAL = OCONV("123456","MD2$,")şCURRENCY = CHK.VAL[1,1]şTHOUSAND = CHK.VAL[3,1]şDECIMAL = CHK.VAL[7,1]ş*ş*Make sure values are in the correct format for fusion chartsş*All the positions in WIDGET.INFO we're going to modifyşCONV.POS.LIST = 41:AM:44:AM:45:AM:63:AM:73:AM:75:AM:61:AM:62:AMşCONV.POS.LIST := 64:AM:54:AM:58:AM:59:AM:11:AM:17:AM:18:AM:66şCONV.POS.LIST.LEN = DCOUNT(CONV.POS.LIST,AM)şFOR CONV.POS = 1 TO CONV.POS.LIST.LENş  THIS.VAL = WIDGET.INFO(CONV.POS.LIST<CONV.POS>)ş  IF THIS.VAL # '' THENş    AM.CNT = DCOUNT(THIS.VAL,AM)ş    FOR ON.AM = 1 TO AM.CNTş      VM.CNT = DCOUNT(THIS.VAL<ON.AM>,VM)ş      FOR ON.VM = 1 TO VM.CNTş        SVM.CNT = DCOUNT(THIS.VAL<ON.AM,ON.VM>,SVM)ş        FOR ON.SVM = 1 TO SVM.CNTş          CONV.VAL = THIS.VAL<ON.AM,ON.VM,ON.SVM>ş          IF OCONV(CONV.VAL,"MCN") # CONV.VAL THEN ;*output formattedş            *Convert decimal to . and strip thousand separatorş            CONVERT DECIMAL:THOUSAND TO '.' IN CONV.VALş            THIS.VAL<ON.AM,ON.VM,ON.SVM> = CONV.VALş          ENDş        NEXT ON.SVMş      NEXT ON.VMş    NEXT ON.AMş    WIDGET.INFO(CONV.POS.LIST<CONV.POS>) = THIS.VALş  ENDşNEXT CONV.POSş*şUPDATE.OPTS = W$CHART.OPTIONSşOPTS.DELIM = AMşGOSUB OPTS.UPDATEşW$CHART.OPTIONS = UPDATE.OPTSş*şCONVERT '"' TO "'" IN W$FW.METER.VALUE.OPTSşCONVERT '"' TO "'" IN W$FW.METER.TARGET.OPTSşCONVERT '"' TO "'" IN W$FW.VALUE.OPTSşCONVERT '"' TO "'" IN W$PIE.VALUE.OPTSşCONVERT '"' TO "'" IN W$BAR.VALUE.OPTSşCONVERT '"' TO "'" IN W$BAR.LABEL.OPTSşCONVERT '"' TO "'" IN W$BAR.TREND.OPTSşCONVERT '"' TO "'" IN W$BAR.XLABEL.OPTSşCONVERT '"' TO "'" IN W$MAP.VALUE.OPTSşCONVERT '"' TO "'" IN W$MAP.RANGE.OPTSşCONVERT '"' TO "'" IN W$FW.SPARK.TREND.OPTSşCONVERT '"' TO "'" IN W$FW.DIAL.OPTSşCONVERT '"' TO "'" IN W$FW.TRENDPOINT.OPTSş*şCONVERT @VM TO " " IN W$FW.METER.TARGET.OPTSşCONVERT @VM TO " " IN W$BAR.LABEL.OPTSş*şCONVERT @AM TO " " IN W$FW.METER.TARGET.OPTSş*ş* Set up default widget dimensionsş*ş  BEGIN CASEş    CASE W$WIDTH = 1 AND DB.TEMPLATE = 3ş      *CHART.WIDTH = 220ş      *CHART.HEIGHT = 180ş      CHART.WIDTH = 260ş      CHART.HEIGHT = 240ş    CASE W$WIDTH = 1ş      *CHART.WIDTH = 220ş      *CHART.HEIGHT = 180ş      CHART.WIDTH = 300ş      CHART.HEIGHT = 270ş    CASE W$WIDTH = 2ş      *CHART.WIDTH = 400ş      *CHART.HEIGHT = 280ş      CHART.WIDTH = 520ş      CHART.HEIGHT = 350ş    CASE W$WIDTH = 3 OR 1ş      *CHART.WIDTH = 600ş      *CHART.HEIGHT = 400ş      CHART.WIDTH = 800ş      CHART.HEIGHT = 530ş  END CASEş*ş*DEBUG='CHART.TYPE=':CHART.TYPEş*DEBUG<-1>='FUSION.WIDGETS.ENABLED=':FUSION.WIDGETS.ENABLEDş*TEMP.VARS=CGI$VARS; CONVERT CHAR(254) TO CHAR(253) IN TEMP.VARSş*DEBUG<-1>='VARS=':TEMP.VARSş*TEMP.VALS=CGI$VALS; CONVERT CHAR(254) TO CHAR(253) IN TEMP.VALSş*DEBUG<-1>='VALS=':TEMP.VALSş*WRITE DEBUG ON F.WEB.SESSION, 'DEBUG.TEST'ş*ş  BEGIN CASEş    CASE CHART.TYPE[1,2] = "FW" AND FUSION.WIDGETS.ENABLED = 0 OR (CHART.TYPE<1> = "MAP" OR FIELD(W$TYPE,':',1) = "USAMAP" AND MAPS.ENABLED = 0)ş      W$TEXT.DATA = "Widget type ":W$TYPE<1>:" is not enabled."ş      W$TYPE = "TEXT"ş      W$INPUT.PROMPT = ""ş      W$LINK.LABEL = ""ş      W$LINK.ICON = ""ş      W$LINK.ICON.TXT = ""ş      W$LINK.LOCATION = ""ş      W$LINK.URL = ""ş      W$LINK.UD.POS = ""ş      W$LINK.UD.VAL = ""ş      W$LINK.DD.WIDGET = ""ş      W$LINK.URL.OPTS = ""ş      W$PRINTABLE = 0ş      W$HIDDEN = 0ş      HTML = '<pre>'ş      HTML<-1> = W$TEXT.DATAş      HTML<-1> = '</pre>'ş    CASE CHART.TYPE = "FWGAUGE"ş      BEGIN CASEş        CASE W$WIDTH = 1 AND DB.TEMPLATE = 3ş          *CHART.WIDTH = 260ş          *CHART.HEIGHT = 130ş          CHART.WIDTH = 260ş          CHART.HEIGHT = 240ş        CASE W$WIDTH = 1ş          *CHART.WIDTH = 260ş          *CHART.HEIGHT = 130ş          CHART.WIDTH = 300ş          CHART.HEIGHT = 270ş        CASE W$WIDTH = 2ş          *CHART.WIDTH = 400ş          *CHART.HEIGHT = 200ş          CHART.WIDTH = 520ş          CHART.HEIGHT = 270ş        CASE W$WIDTH = 3 OR 1ş          *CHART.WIDTH = 750ş          *CHART.HEIGHT = 280ş          CHART.WIDTH = 1015ş          CHART.HEIGHT = 410ş      END CASEş      *IF W$TYPE = "HLINEARGAUGE" OR W$TYPE = "HLED" THEN CHART.HEIGHT = 80ş      *IF W$TYPE = "VLED" OR W$TYPE = "THERMOMETER" THEN CHART.WIDTH = 110 ; CHART.HEIGHT = 280ş      *IF W$TYPE = "CYLINDER" THEN CHART.WIDTH = 140ş      *IF W$TYPE = "BULB" THEN CHART.WIDTH = 110 ; CHART.HEIGHT = 130ş      IF W$TYPE = "HLINEARGAUGE" OR W$TYPE = "HLED" THEN CHART.HEIGHT = 80ş      IF W$TYPE = "VLED" OR W$TYPE = "THERMOMETER" THEN CHART.WIDTH = 110ş      IF W$TYPE = "CYLINDER" THEN CHART.WIDTH = 140ş      IF W$TYPE = "BULB" THEN CHART.WIDTH = 110 ; CHART.HEIGHT = 130ş      IF W$TYPE = "ANGULARGAUGE" THENş        BEGIN CASEş          CASE W$WIDTH = 1ş            CHART.HEIGHT = 130ş          CASE W$WIDTH = 2ş            CHART.HEIGHT = 200ş        END CASEş      ENDş      MOVIE.HEIGHT = INT(CHART.HEIGHT *1.3)ş      MOVIE.WIDTH = CHART.WIDTH + 75ş*ş      READ FW.TEMPLATE FROM F.WEB.FORMS, "FW_template.html" ELSE FW.TEMPLATE = "FW_template.html not found"ş      CALL SWAP(FW.TEMPLATE,'[FW_MODULE]',FW.NAME)ş*ş      READ SXML FROM F.MVDB.CONTROL, CHART.TYPE:".SETTINGS" ELSE SXML = ''ş      CONVERT AM TO "" IN SXMLş*ş      GOSUB TICKMARK.OPTIONS ;* Add chart options to support tickmarksş*ş      IF W$TYPE = "THERMOMETER" AND W$FW.THERMOMETER.COLOR # "" THENş        LOCATE W$FW.THERMOMETER.COLOR IN NAME.COLOR<1> SETTING CPOS THENş          W$FW.THERMOMETER.COLOR = NAME.COLOR<2,CPOS>ş        ENDş        W$CHART.OPTIONS<-1> = "gaugeFillColor='":W$FW.THERMOMETER.COLOR:"'"ş      ENDş* LJB 7-10-10 Removed DD restriction for angular and linear gauge charts. Not sure why itş* was here in the first placeş*    IF W$TYPE = "HLED" OR W$TYPE = "VLED" OR W$TYPE = "THERMOMETER" OR W$TYPE = "CYLINDER" OR W$TYPE = "BULB" THENş      IF W$FW.DD.WIDGET # "" THENş        FW.WIDGET.POS = 1ş        GOSUB MAKE.FW.DD.URLş        IF URL # "" THENş          URLENCODE.STRING = URLş          GOSUB URL.ENCODE ;* Encode the entire URLş          W$CHART.OPTIONS<-1> = " clickURL='":NEW.STRING:"'"ş        ENDş      ENDş*    ENDş      IF W$CHART.OPTIONS # "" THENş        XML.OPTS = W$CHART.OPTIONSş        NODE.NAME = 'chart'ş        GOSUB APPLY.XML.OPTSş      ENDş*ş      PDATA = '<colorRange>'ş      COLOR.RANGE.OPTS = W$FW.COLOR.RANGE<4>ş      CONVERT '"' TO "'" IN COLOR.RANGE.OPTSş      FOR PX = 1 TO DCOUNT( W$FW.COLOR.RANGE<1>, VM )ş        USE.COLOR = W$FW.COLOR.RANGE<3,PX>ş        LOCATE USE.COLOR IN NAME.COLOR<1> SETTING CPOS THENş          USE.COLOR = NAME.COLOR<2,CPOS>ş        END ELSEş          IF USE.COLOR[1,1] # "#" THEN USE.COLOR = "#FFFFFF" ;* Whiteş        ENDş        CONVERT "#" TO "" IN USE.COLORş        UPDATE.OPTS = COLOR.RANGE.OPTS<1,PX>ş        OPTS.DELIM = ' 'ş        GOSUB OPTS.UPDATEş        COLOR.RANGE.OPTS<1,PX> = UPDATE.OPTSş        PDATA := "<color minValue='":W$FW.COLOR.RANGE<1,PX>:"' maxValue='":W$FW.COLOR.RANGE<2,PX>:"' code='":USE.COLOR:"' ":COLOR.RANGE.OPTS<1,PX>:" />"ş      NEXT PXş      PDATA := '</colorRange>'ş      METER.STYLE = 0ş      IF W$TYPE = "HLED" OR W$TYPE = "VLED" OR W$TYPE = "THERMOMETER" OR W$TYPE = "CYLINDER" OR W$TYPE = "BULB" THENş        PDATA := '[METER_VALUE]'ş        METER.STYLE = 1ş      END ELSEş        IF W$TYPE = "ANGULARGAUGE" THENş          PDATA := '<dials>'ş          DNODE = "dial"ş        END ELSEş          PDATA := '<pointers>'ş          DNODE = 'pointer'ş        ENDş        FOR PX = 1 TO DCOUNT( W$FW.DIAL.VALUES<1>, VM )ş          UPDATE.OPTS = W$FW.DIAL.OPTS<1,PX>ş          OPTS.DELIM = ' 'ş          GOSUB OPTS.UPDATEş          W$FW.DIAL.OPTS<1,PX> = UPDATE.OPTSş          PDATA := "<":DNODE:" value='":W$FW.DIAL.VALUES<1,PX>:"' ":W$FW.DIAL.OPTS<1,PX>ş          FW.WIDGET.POS = PXş          GOSUB MAKE.FW.DD.URLş          IF URL # "" THENş            URLENCODE.STRING = URLş            GOSUB URL.ENCODE ;* Encode the entire URLş            PDATA := " link='":NEW.STRING:"'"ş          ENDş          PDATA := " />"ş        NEXT PXş        PDATA := '</':DNODE:'s>'ş        PDATA := '<trendpoints>'ş        FOR PX = 1 TO DCOUNT( W$FW.TRENDPOINT.VALUES<1>, VM )ş          UPDATE.OPTS = W$FW.TRENDPOINT.OPTS<1,PX>ş          OPTS.DELIM = ' 'ş          GOSUB OPTS.UPDATEş          W$FW.TRENDPOINT.OPTS<1,PX> = UPDATE.OPTSş          PDATA := "<point startValue='":W$FW.TRENDPOINT.VALUES<1,PX>:"' "ş          IF W$FW.TRENDPOINT.VALUES<2,PX> # "" THEN PDATA := "endValue='":W$FW.TRENDPOINT.VALUES<2,PX>:"' "ş          PDATA := "displayValue='":W$FW.TRENDPOINT.LABELS<1,PX>:"' ":W$FW.TRENDPOINT.OPTS<1,PX>:" />"ş        NEXT PXş        PDATA := '</trendpoints>'ş      ENDş      CALL SWAP(SXML,'[CHART.PALETTE]',W$FW.CHART.PALETTE)ş      CALL SWAP(SXML,'[UPPER.LIMIT]',W$FW.UPPER.LIMIT)ş      CALL SWAP(SXML,'[LOWER.LIMIT]',W$FW.LOWER.LIMIT)ş      CALL SWAP(SXML,'[UPPER.LIMIT.DISPLAY]',W$FW.UPPER.LIMIT.LABEL)ş      CALL SWAP(SXML,'[LOWER.LIMIT.DISPLAY]',W$FW.LOWER.LIMIT.LABEL)ş      CALL SWAP(SXML,'[NUMBER.PREFIX]',W$FW.NUMBER.PREFIX)ş      CALL SWAP(SXML,'[NUMBER.SUFFIX]',W$FW.NUMBER.SUFFIX)ş      CALL SWAP(FW.TEMPLATE,'<!-- chart_width -->',MOVIE.WIDTH)ş      CALL SWAP(FW.TEMPLATE,'<!-- chart_height -->',MOVIE.HEIGHT)ş*ş      IF METER.STYLE THENş        HTML = ''ş        MASTER.SXML = SXMLş        MASTER.PDATA = PDATAş        MASTER.FW.TEMPLATE = FW.TEMPLATEş        VAL.CNT = DCOUNT( W$FW.METER.VALUE<1>, @VM )ş        FOR MVX = 1 TO VAL.CNTş          UPDATE.OPTS = W$FW.METER.VALUE.OPTS<1,MVX>ş          OPTS.DELIM = ' 'ş          GOSUB OPTS.UPDATEş          W$FW.METER.VALUE.OPTS<1,MVX> = UPDATE.OPTSş          VALDATA = '<value ':W$FW.METER.VALUE.OPTS<1,MVX>' >':W$FW.METER.VALUE<1,MVX>:'</value>'ş          CALL SWAP(PDATA,'[METER_VALUE]',VALDATA)ş          CALL SWAP(SXML,'[CHART.DATA]',PDATA)ş          CALL SWAP(FW.TEMPLATE,'<!-- chart_div_id -->','flashcontent_':VX:'_':MVX)ş          CALL SWAP(FW.TEMPLATE,'<!-- CHARTXML -->',SXML)ş          HTML := FW.TEMPLATEş          SXML = MASTER.SXMLş          PDATA = MASTER.PDATAş          FW.TEMPLATE = MASTER.FW.TEMPLATEş        NEXT MVXş*ş        IF VAL.CNT > 1 THENş          IF W$TYPE = "FWBULB" THENş            SHRINK.MLT = 1ş            FOR NN = 2 TO VAL.CNTş              SHRINK.MLT -= .2ş            NEXT NNş            IF SHRINK.MLT < .25 THEN SHRINK.MLT = .25ş            CHART.WIDTH = INT( CHART.WIDTH * SHRINK.MLT )ş            CHART.HEIGHT = INT( CHART.WIDTH * SHRINK.MLT )ş          ENDş        ENDş      END ELSEş        CALL SWAP(SXML,'[CHART.DATA]',PDATA)ş        CALL SWAP(FW.TEMPLATE,'<!-- chart_div_id -->','flashcontent_':VX)ş        CALL SWAP(FW.TEMPLATE,'<!-- CHARTXML -->',SXML)ş        HTML = FW.TEMPLATEş      ENDş    CASE CHART.TYPE = "FWBULLET"ş      IF W$TYPE = "HBULLET" THENş        BEGIN CASEş          CASE W$WIDTH = 1 AND DB.TEMPLATE = 3ş            *HART.WIDTH = 220ş            *HART.HEIGHT = 60ş            CHART.WIDTH = 260ş            CHART.HEIGHT = 60ş          CASE W$WIDTH = 1ş            *CHART.WIDTH = 220ş            *CHART.HEIGHT = 60ş            CHART.WIDTH = 300ş            CHART.HEIGHT = 60ş          CASE W$WIDTH = 2ş            *CHART.WIDTH = 400ş            *CHART.HEIGHT = 60ş            CHART.WIDTH = 520ş            CHART.HEIGHT = 60ş          CASE W$WIDTH = 3 OR 1ş            *CHART.WIDTH = 750ş            *CHART.HEIGHT = 60ş            CHART.WIDTH = 1015ş            CHART.HEIGHT = 60ş        END CASEş      END ELSEş        BEGIN CASEş          CASE W$WIDTH = 1 AND DB.TEMPLATE = 3ş            *CHART.WIDTH = 110ş            *CHART.HEIGHT = 180ş            CHART.WIDTH = 110ş            CHART.HEIGHT = 240ş          CASE W$WIDTH = 1ş            *CHART.WIDTH = 110ş            *CHART.HEIGHT = 180ş            CHART.WIDTH = 110ş            CHART.HEIGHT = 270ş          CASE W$WIDTH = 2ş            *CHART.WIDTH = 110ş            *CHART.HEIGHT = 280ş            CHART.WIDTH = 110ş            CHART.HEIGHT = 300ş          CASE W$WIDTH = 3 OR 1ş            *CHART.WIDTH = 110ş            *CHART.HEIGHT = 400ş            CHART.WIDTH = 110ş            CHART.HEIGHT = 410ş        END CASEş      ENDş      MOVIE.HEIGHT = INT(CHART.HEIGHT *1.3)ş      MOVIE.WIDTH = CHART.WIDTH + 75ş*ş      READ FW.TEMPLATE FROM F.WEB.FORMS, "FW_template.html" ELSE FW.TEMPLATE = "FW_template.html not found"ş      CALL SWAP(FW.TEMPLATE,'[FW_MODULE]',FW.NAME)ş*ş      READ SXML FROM F.MVDB.CONTROL, CHART.TYPE:".SETTINGS" ELSE SXML = ''ş      CONVERT AM TO "" IN SXMLş*ş      GOSUB TICKMARK.OPTIONS ;* Add chart options to support tickmarksş*ş      IF W$FW.BC.PLOT.COLOR # "" THENş        USE.COLOR = W$FW.BC.PLOT.COLORş        LOCATE USE.COLOR IN NAME.COLOR<1> SETTING CPOS THENş          USE.COLOR = NAME.COLOR<2,CPOS>ş        END ELSEş          IF USE.COLOR[1,1] # "#" THEN USE.COLOR = ""ş        ENDş        IF USE.COLOR # "" THEN W$CHART.OPTIONS<-1> = "plotFillColor='":USE.COLOR:'"'ş      ENDş      IF W$FW.BC.TARGET.COLOR # "" THENş        USE.COLOR = W$FW.BC.TARGET.COLORş        LOCATE USE.COLOR IN NAME.COLOR<1> SETTING CPOS THENş          USE.COLOR = NAME.COLOR<2,CPOS>ş        END ELSEş          IF USE.COLOR[1,1] # "#" THEN USE.COLOR = ""ş        ENDş        IF USE.COLOR # "" THEN W$CHART.OPTIONS<-1> = "targetColor='":USE.COLOR:'"'ş      ENDş*ş      IF W$FW.DD.WIDGET # "" THENş        FW.WIDGET.POS = 1ş        GOSUB MAKE.FW.DD.URLş        IF URL # "" THENş          URLENCODE.STRING = URLş          GOSUB URL.ENCODE ;* Encode the entire URLş          W$CHART.OPTIONS<-1> = " clickURL='":NEW.STRING:"'"ş        ENDş      ENDş*ş      IF W$CHART.OPTIONS # "" THENş        XML.OPTS = W$CHART.OPTIONSş        NODE.NAME = 'chart'ş        GOSUB APPLY.XML.OPTSş      ENDş*ş      PDATA = '<colorRange>'ş      COLOR.RANGE.OPTS = W$FW.COLOR.RANGE<4>ş      UPDATE.OPTS = COLOR.RANGE.OPTSş      OPTS.DELIM = ' 'ş      GOSUB OPTS.UPDATEş      COLOR.RANGE.OPTS = UPDATE.OPTSş      FOR PX = 1 TO DCOUNT( W$FW.COLOR.RANGE<1>, VM )ş        USE.COLOR = W$FW.COLOR.RANGE<3,PX>ş        LOCATE USE.COLOR IN NAME.COLOR<1> SETTING CPOS THENş          USE.COLOR = NAME.COLOR<2,CPOS>ş        END ELSEş          IF USE.COLOR[1,1] # "#" THEN USE.COLOR = "#FFFFFF" ;* Whiteş        ENDş        PDATA := "<color minValue='":W$FW.COLOR.RANGE<1,PX>:"' maxValue='":W$FW.COLOR.RANGE<2,PX>:"' code='":USE.COLOR:"' ":COLOR.RANGE.OPTS<1,PX>:" />"ş      NEXT PXş      PDATA := '</colorRange>'ş      PDATA := '<value ':W$FW.METER.VALUE.OPTS:' >':W$FW.METER.VALUE:'</value>'ş      PDATA := '<target ':W$FW.METER.TARGET.OPTS:' >':W$FW.METER.TARGET:'</target>'ş      CALL SWAP(SXML,'[CHART.DATA]',PDATA)ş      CALL SWAP(SXML,'[CAPTION]',W$FW.CAPTION)ş      CALL SWAP(SXML,'[SUBCAPTION]',W$FW.SUBCAPTION)ş      CALL SWAP(SXML,'[CHART.PALETTE]',W$FW.CHART.PALETTE)ş      CALL SWAP(SXML,'[UPPER.LIMIT]',W$FW.UPPER.LIMIT)ş      CALL SWAP(SXML,'[LOWER.LIMIT]',W$FW.LOWER.LIMIT)ş      CALL SWAP(SXML,'[NUMBER.PREFIX]',W$FW.NUMBER.PREFIX)ş      CALL SWAP(SXML,'[NUMBER.SUFFIX]',W$FW.NUMBER.SUFFIX)ş      CALL SWAP(FW.TEMPLATE,'<!-- chart_width -->',MOVIE.WIDTH)ş      CALL SWAP(FW.TEMPLATE,'<!-- chart_height -->',MOVIE.HEIGHT)ş      CALL SWAP(FW.TEMPLATE,'<!-- chart_div_id -->','flashcontent_':VX)ş      CALL SWAP(FW.TEMPLATE,'<!-- CHARTXML -->',SXML)ş      HTML = FW.TEMPLATEş    CASE CHART.TYPE = "FWSPARK"ş      BEGIN CASEş        CASE W$WIDTH = 1 AND DB.TEMPLATE = 3ş          *CHART.WIDTH = 220ş          *CHART.HEIGHT = 40ş          CHART.WIDTH = 260ş          CHART.HEIGHT = 40ş        CASE W$WIDTH = 1ş          *CHART.WIDTH = 220ş          *CHART.HEIGHT = 40ş          CHART.WIDTH = 300ş          CHART.HEIGHT = 40ş        CASE W$WIDTH = 2ş          *CHART.WIDTH = 400ş          *CHART.HEIGHT = 40ş          CHART.WIDTH = 520ş          CHART.HEIGHT = 40ş        CASE W$WIDTH = 3 OR 1ş          *CHART.WIDTH = 750ş          *CHART.HEIGHT = 40ş          CHART.WIDTH = 1015ş          CHART.HEIGHT = 40ş      END CASEş      MOVIE.HEIGHT = INT(CHART.HEIGHT *1.3)ş      MOVIE.WIDTH = CHART.WIDTH + 75ş*ş      READ FW.TEMPLATE FROM F.WEB.FORMS, "FW_template.html" ELSE FW.TEMPLATE = "FW_template.html not found"ş      CALL SWAP(FW.TEMPLATE,'[FW_MODULE]',FW.NAME)ş*ş      READ SXML FROM F.MVDB.CONTROL, CHART.TYPE:".SETTINGS" ELSE SXML = ''ş      CONVERT AM TO "" IN SXMLş*ş      IF W$FW.DD.WIDGET # "" THENş        FW.WIDGET.POS = 1ş        GOSUB MAKE.FW.DD.URLş        IF URL # "" THENş          URLENCODE.STRING = URLş          GOSUB URL.ENCODE ;* Encode the entire URLş          W$CHART.OPTIONS<-1> = " clickURL='":NEW.STRING:"'"ş        ENDş      ENDş      IF W$CHART.OPTIONS # "" THENş        XML.OPTS = W$CHART.OPTIONSş        NODE.NAME = 'chart'ş        GOSUB APPLY.XML.OPTSş      ENDş*ş      PDATA = '<dataset>'ş      FOR PX = 1 TO DCOUNT( W$FW.VALUES<1>, VM )ş        UPDATE.OPTS = W$FW.VALUE.OPTS<1,PX>ş        OPTS.DELIM = ' 'ş        GOSUB OPTS.UPDATEş        W$FW.VALUE.OPTS<1,PX> = UPDATE.OPTSş        PDATA := "<set value='":W$FW.VALUES<1,PX>:"' ":W$FW.VALUE.OPTS<1,PX>:" />"ş      NEXT PXş      PDATA := '</dataset>'ş      IF W$FW.SPARK.TREND.BEG # "" THENş        PDATA := '<trendlines>'ş        FOR TLX = 1 TO DCOUNT( W$FW.SPARK.TREND.BEG, VM )ş          UPDATE.OPTS = W$FW.SPARK.TREND.OPTS<1,TLX>ş          OPTS.DELIM = ' 'ş          GOSUB OPTS.UPDATEş          W$FW.SPARK.TREND.OPTS<1,TLX> = UPDATE.OPTSş          PDATA := "<line startValue='":W$FW.SPARK.TREND.BEG<1,TLX>:"' endValue='":W$FW.SPARK.TREND.END<1,TLX>:"' ":W$FW.SPARK.TREND.OPTS<1,TLX>:" />"ş        NEXT TLXş        PDATA := '</trendlines>'ş      ENDş      CALL SWAP(SXML,'[CHART.DATA]',PDATA)ş      CALL SWAP(SXML,'[CAPTION]',W$FW.CAPTION)ş      CALL SWAP(SXML,'[SUBCAPTION]',W$FW.SUBCAPTION)ş      CALL SWAP(SXML,'[CHART.PALETTE]',W$FW.CHART.PALETTE)ş      CALL SWAP(SXML,'[UPPER.LIMIT]',W$FW.UPPER.LIMIT)ş      CALL SWAP(SXML,'[LOWER.LIMIT]',W$FW.LOWER.LIMIT)ş      CALL SWAP(FW.TEMPLATE,'<!-- chart_width -->',MOVIE.WIDTH)ş      CALL SWAP(FW.TEMPLATE,'<!-- chart_height -->',MOVIE.HEIGHT)ş      CALL SWAP(FW.TEMPLATE,'<!-- chart_div_id -->','flashcontent_':VX)ş      CALL SWAP(FW.TEMPLATE,'<!-- CHARTXML -->',SXML)ş      HTML = FW.TEMPLATEş    CASE CHART.TYPE = "FWFP"ş      MOVIE.HEIGHT = INT(CHART.HEIGHT *1.3)ş      MOVIE.WIDTH = CHART.WIDTH + 75ş*ş      READ FW.TEMPLATE FROM F.WEB.FORMS, "FW_template.html" ELSE FW.TEMPLATE = "FW_template.html not found"ş      CALL SWAP(FW.TEMPLATE,'[FW_MODULE]',FW.NAME)ş*ş      READ SXML FROM F.MVDB.CONTROL, CHART.TYPE:".SETTINGS" ELSE SXML = ''ş      CONVERT AM TO "" IN SXMLş      IF W$CHART.OPTIONS # "" THENş        XML.OPTS = W$CHART.OPTIONSş        NODE.NAME = 'chart'ş        GOSUB APPLY.XML.OPTSş      ENDş      COLOR.LIST = W$FW.COLORSş      GOSUB APPLY.COLOR.OPTSş*ş      PDATA = ''ş      FOR PX = 1 TO DCOUNT( W$FW.LABELS<1>, VM )ş        UPDATE.OPTS = W$FW.VALUE.OPTS<1,PX>ş        OPTS.DELIM = ' 'ş        GOSUB OPTS.UPDATEş        W$FW.VALUE.OPTS<1,PX> = UPDATE.OPTSş        PDATA := "<set label='":W$FW.LABELS<1,PX>:"' value='":W$FW.VALUES<1,PX>:"' color='":COLOR.ARRAY<1,PX>:"' ":W$FW.VALUE.OPTS<1,PX>ş        FW.WIDGET.POS = PXş        GOSUB MAKE.FW.DD.URLş        IF URL # "" THENş          URLENCODE.STRING = URLş          GOSUB URL.ENCODE ;* Encode the entire URLş          PDATA := " link='":NEW.STRING:"'"ş        ENDş        PDATA := " />"ş      NEXT PXş      CALL SWAP(SXML,'[CHART.DATA]',PDATA)ş      CALL SWAP(SXML,'[CAPTION]',W$FW.CAPTION)ş      CALL SWAP(SXML,'[SUBCAPTION]',W$FW.SUBCAPTION)ş      CALL SWAP(SXML,'[NUMBER.PREFIX]',W$FW.NUMBER.PREFIX)ş      CALL SWAP(SXML,'[NUMBER.SUFFIX]',W$FW.NUMBER.SUFFIX)ş      CALL SWAP(FW.TEMPLATE,'<!-- chart_width -->',MOVIE.WIDTH)ş      CALL SWAP(FW.TEMPLATE,'<!-- chart_height -->',MOVIE.HEIGHT)ş      CALL SWAP(FW.TEMPLATE,'<!-- chart_div_id -->','flashcontent_':VX)ş      CALL SWAP(FW.TEMPLATE,'<!-- CHARTXML -->',SXML)ş      HTML = FW.TEMPLATEş    CASE CHART.TYPE = "FCPIE"ş      BEGIN CASEş        CASE W$WIDTH = 1 AND DB.TEMPLATE = 3ş          *CHART.WIDTH = 220ş          *CHART.HEIGHT = 180ş          CHART.WIDTH = 260ş          CHART.HEIGHT = 240ş        CASE W$WIDTH = 1ş          *CHART.WIDTH = 220ş          *CHART.HEIGHT = 180ş          CHART.WIDTH = 300ş          CHART.HEIGHT = 270ş        CASE W$WIDTH = 2ş          *CHART.WIDTH = 420ş          *CHART.HEIGHT = 240ş          CHART.WIDTH = 520ş          CHART.HEIGHT = 365ş        CASE W$WIDTH = 3 OR 1ş          *CHART.WIDTH = 730ş          *CHART.HEIGHT = 320ş          CHART.WIDTH = 800ş          CHART.HEIGHT = 550ş      END CASEş      PT.NAME = WT$SWFş      PS.NAME = W$TYPE:".SETTINGS"ş      IF W$CHART.HEIGHT # "" THEN CHART.HEIGHT = W$CHART.HEIGHTş      IF W$TYPE = "FC3DPIE" THENş        CHART.HEIGHT = INT(CHART.HEIGHT*.75)ş      ENDş      MOVIE.HEIGHT = INT(CHART.HEIGHT *1.3)ş      MOVIE.WIDTH = CHART.WIDTH + 75ş*ş      READ PIE.TEMPLATE FROM F.WEB.FORMS, "FCF_template.html" ELSE PIE.TEMPLATE = "FCF_template.html not found"ş      PT.NAME = OCONV(PT.NAME,'MCL')ş      CALL SWAP(PIE.TEMPLATE,'[FCF_MODULE]',PT.NAME)ş*ş      READ SXML FROM F.MVDB.CONTROL, PS.NAME ELSE SXML = ''ş      CONVERT AM TO "" IN SXMLş      IF W$CHART.OPTIONS # "" THENş        XML.OPTS = W$CHART.OPTIONSş        NODE.NAME = 'graph'ş        GOSUB APPLY.XML.OPTSş      ENDş      COLOR.LIST = W$PIE.COLORSş      GOSUB APPLY.COLOR.OPTSş      PDATA = ''ş      FOR PX = 1 TO DCOUNT( W$PIE.LABELS<1>, VM )ş        UPDATE.OPTS = W$PIE.VALUE.OPTS<1,PX>ş        OPTS.DELIM = ' 'ş        GOSUB OPTS.UPDATEş        W$PIE.VALUE.OPTS<1,PX> = UPDATE.OPTSş        PDATA := "<set label='":W$PIE.LABELS<1,PX>:"' color='":COLOR.ARRAY<1,PX>:"' ":W$PIE.VALUE.OPTS<1,PX>:" value='":W$PIE.VALUES<1,PX>:"'"ş        FW.WIDGET.POS = PXş        GOSUB MAKE.FW.DD.URLş        IF URL # "" THENş          URLENCODE.STRING = URLş          GOSUB URL.ENCODE ;* Encode the entire URLş          PDATA := " link='":NEW.STRING:"'"ş        ENDş        PDATA := ' />'ş      NEXT PXş      CALL SWAP(SXML,'[CHART.DATA]',PDATA)ş      CALL SWAP(SXML,'[CHART.TITLE]',W$PIE.CAPTION)ş      RADIUS = INT(CHART.WIDTH/2)-INT(CHART.WIDTH*.15)ş      CALL SWAP(SXML,'[RADIUS]',RADIUS)ş      CALL SWAP(PIE.TEMPLATE,'<!-- chart_width -->',MOVIE.WIDTH)ş      CALL SWAP(PIE.TEMPLATE,'<!-- chart_height -->',MOVIE.HEIGHT)ş      CALL SWAP(PIE.TEMPLATE,'<!-- chart_div_id -->','flashcontent_':VX)ş      CALL SWAP(PIE.TEMPLATE,'<!-- CHARTXML -->',SXML)ş      HTML = PIE.TEMPLATEş    CASE CHART.TYPE = "FCLINECOL"ş      BEGIN CASEş        CASE W$WIDTH = 1 AND DB.TEMPLATE = 3ş          *CHART.WIDTH = 220ş          *CHART.HEIGHT = 180ş          CHART.WIDTH = 260ş          CHART.HEIGHT = 240ş        CASE W$WIDTH = 1ş          *CHART.WIDTH = 220ş          *CHART.HEIGHT = 180ş          CHART.WIDTH = 300ş          CHART.HEIGHT = 270ş        CASE W$WIDTH = 2ş          *CHART.WIDTH = 420ş          *CHART.HEIGHT = 240ş          CHART.WIDTH = 520ş          CHART.HEIGHT = 300ş        CASE W$WIDTH = 3 OR 1ş          *CHART.WIDTH = 730ş          *CHART.HEIGHT = 320ş          CHART.WIDTH = 1015ş          CHART.HEIGHT = 425ş      END CASEş      IF W$CHART.HEIGHT # "" THEN CHART.HEIGHT = W$CHART.HEIGHTş      BT.NAME = WT$SWFş      BS.NAME = W$TYPE:".SETTINGS"ş      MOVIE.HEIGHT = INT(CHART.HEIGHT *1.3)ş      MOVIE.WIDTH = CHART.WIDTH + 75ş*ş      COLOR.LIST = W$BAR.COLORSş      GOSUB APPLY.COLOR.OPTSş*ş      READ BAR.TEMPLATE FROM F.WEB.FORMS, "FCF_template.html" ELSE BAR.TEMPLATE = "FCF_template.html not found"ş      BT.NAME = OCONV(BT.NAME,'MCL')ş      CALL SWAP(BAR.TEMPLATE,'[FCF_MODULE]',BT.NAME)ş*ş      READ SXML FROM F.MVDB.CONTROL, BS.NAME ELSE SXML = ''ş      CONVERT AM TO "" IN SXMLş      IF W$CHART.OPTIONS # "" THENş        XML.OPTS = W$CHART.OPTIONSş        NODE.NAME = 'graph'ş        GOSUB APPLY.XML.OPTSş      ENDş      PDATA = ''ş      IF MULTI.SERIES THENş        PDATA := '<categories>'ş        FOR PX = 1 TO DCOUNT( W$BAR.XLABELS<1>, VM )ş          PDATA := "<category label='":W$BAR.XLABELS<1,PX>:"' ":W$BAR.XLABEL.OPTS<1,PX>:" />"ş        NEXT PXş        PDATA := '</categories>'ş        FOR PX = 1 TO DCOUNT( W$BAR.LABELS,AM)ş          PDATA := "<dataset seriesname='":W$BAR.LABELS<PX>:"' color='":COLOR.ARRAY<1,PX>:"' ":W$BAR.LABEL.OPTS<PX>:" >"ş          FOR PXV = 1 TO DCOUNT( W$BAR.VALUES<PX>,VM)ş            UPDATE.OPTS = W$BAR.VALUE.OPTS<PX,PXV>ş            OPTS.DELIM = ' 'ş            GOSUB OPTS.UPDATEş            W$BAR.VALUE.OPTS<PX,PXV> = UPDATE.OPTSş            MS.VALUE=W$BAR.VALUES<PX,PXV>;  *ZUMASYS 1-5-15ş            MS.LABEL=W$BAR.XLABELS<1,PXV>; *ZUMASYS 1-5-15ş* 7-29-15 CHANGE ANY &lt;br&gt;'s to spacesş            LOOPş              BR.POS=INDEX(MS.LABEL,'&lt;br&gt;',1)ş            UNTIL NOT(BR.POS) DOş              MS.LABEL=MS.LABEL[1,BR.POS-1]:' ':(MS.LABEL[BR.POS+10,9999])ş            REPEATş* END OF 7-29-15ş            MS.SERIES=W$BAR.LABELS<PX>;    *ZUMASYS 3-15-15ş*ZUMASYS 1-5-15*          PDATA := "<set value='":W$BAR.VALUES<PX,PXV>:"' ":W$BAR.VALUE.OPTS<PX,PXV>ş            PDATA := "<set value='":MS.VALUE:"' ":W$BAR.VALUE.OPTS<PX,PXV>; *ZUMASYS 1-5-15ş            FW.WIDGET.POS = PXş            GOSUB MAKE.FW.DD.URLş            IF URL # "" THENş              URLENCODE.STRING = URLş              GOSUB URL.ENCODE ;* Encode the entire URLş              PDATA := " link='":NEW.STRING:"'"ş            ENDş            PDATA := ' />'ş          NEXT PXVş          PDATA := '</dataset>'ş        NEXT PXş      END ELSEş        FOR PX = 1 TO DCOUNT( W$BAR.XLABELS<1>, VM )ş          IF INDEX(W$BAR.VALUES<1,PX>,'-',1) THENş            SIGN.MINUS = 1ş          END ELSE SIGN.MINUS = 0ş* 3-4-15 ZUMASYS - SUPPORT DECIMALS IN BAR.VALUESş          THIS.BAR.VALUES=W$BAR.VALUES<1,PX>ş          IF INDEX(THIS.BAR.VALUES,'.',1) THENş            THIS.BAR.VALUES.1=OCONV(FIELD(THIS.BAR.VALUES,'.',1),'MCN')ş            THIS.BAR.VALUES.2=OCONV(FIELD(THIS.BAR.VALUES,'.',2),'MCN')ş            W$BAR.VALUES<1,PX>=THIS.BAR.VALUES.1:'.':THIS.BAR.VALUES.2ş          END ELSEş            W$BAR.VALUES<1,PX> = OCONV(THIS.BAR.VALUES, 'MCN' )ş          ENDş* END OF 3-4-15 ZUMASYSş          IF SIGN.MINUS THEN W$BAR.VALUES<1,PX> = '-':W$BAR.VALUES<1,PX>ş          PDATA := "<set label='":W$BAR.XLABELS<1,PX>:"' value='":W$BAR.VALUES<1,PX>+0:"' "ş          IF NOT(INDEX(W$BAR.VALUE.OPTS<1,PX>,'color=',1)) THENş* Color setting is not being overridden by the W$BAR.VALUE.OPTS infoş            PDATA := "color='":COLOR.ARRAY<1,1>:"' "ş          ENDş          UPDATE.OPTS = W$BAR.VALUE.OPTS<1,PX>ş          OPTS.DELIM = ' 'ş          GOSUB OPTS.UPDATEş          W$BAR.VALUE.OPTS<1,PX> = UPDATE.OPTSş          PDATA := ' ':W$BAR.VALUE.OPTS<1,PX>ş          FW.WIDGET.POS = PXş          GOSUB MAKE.FW.DD.URLş          IF URL # "" THENş            URLENCODE.STRING = URLş            GOSUB URL.ENCODE ;* Encode the entire URLş            PDATA := " link='":NEW.STRING:"'"ş          ENDş          PDATA := ' />'ş        NEXT PXş      ENDş      IF W$BAR.TREND.BEG # "" THENş        PDATA := '<trendLines>'ş        FOR TLX = 1 TO DCOUNT( W$BAR.TREND.BEG<1>, VM )ş          PDATA := "<line startValue='":W$BAR.TREND.BEG<1,TLX>:"' "ş          IF W$BAR.TREND.END<1,TLX> # "" THEN PDATA := "endValue='":W$BAR.TREND.END<1,TLX>:"' "ş          UPDATE.OPTS = W$BAR.TREND.OPTS<1,TLX>ş          OPTS.DELIM = ' 'ş          GOSUB OPTS.UPDATEş          W$BAR.TREND.OPTS<1,TLX> = UPDATE.OPTSş          PDATA := W$BAR.TREND.OPTS<1,TLX>ş          PDATA := " />"ş        NEXT TLXş        PDATA := '</trendLines>'ş      ENDş      CONVERT '"' TO "'" IN PDATAş      CALL SWAP(SXML,'[CHART.DATA]',PDATA)ş      CALL SWAP(SXML,'[CHART.TITLE]',W$BAR.CAPTION)ş      CALL SWAP(SXML,'[YMEMO]',W$BAR.YMEMO<1>)ş      CALL SWAP(SXML,'[XMEMO]',W$BAR.XMEMO<1>)ş      CALL SWAP(BAR.TEMPLATE,'<!-- chart_width -->',MOVIE.WIDTH)ş      CALL SWAP(BAR.TEMPLATE,'<!-- chart_height -->',MOVIE.HEIGHT)ş      CALL SWAP(BAR.TEMPLATE,'<!-- chart_div_id -->','flashcontent_':VX)ş      CALL SWAP(BAR.TEMPLATE,'<!-- CHARTXML -->',SXML)ş      HTML = BAR.TEMPLATEş    CASE CHART.TYPE<1> = "MAP" OR FIELD(W$TYPE,':',1) = "USAMAP"ş      BEGIN CASEş        CASE W$WIDTH = 1 AND DB.TEMPLATE = 3ş          NULLş        CASE W$WIDTH = 1ş          NULLş        CASE W$WIDTH = 2ş          *CHART.WIDTH = 420ş          *CHART.HEIGHT = 240ş          CHART.WIDTH = 520ş          CHART.HEIGHT = 300ş        CASE W$WIDTH = 3 OR 1ş          *CHART.WIDTH = 730ş          *CHART.HEIGHT = 320ş          CHART.WIDTH = 1015ş          CHART.HEIGHT = 425ş      END CASEş      IF W$CHART.HEIGHT # "" THEN CHART.HEIGHT = W$CHART.HEIGHTş      CALL XML.ENCODE(W$MAP.RANGE.NAME,"")ş      IF FIELD(W$TYPE,':',1) = "USAMAP" THENş        STATE.MAP = FIELD( W$TYPE,':',2)ş        IF STATE.MAP # "" THENş* This is a drill-down to a specific state detail. We need to match theş* map name with the selected state.ş* selected state.ş          READ STATE.NAMES FROM F.MVDB.CONTROL, 'STATE.NAMES' ELSE STATE.NAMES = ""ş          CONVERT "," TO @VM IN STATE.NAMESş          LOCATE STATE.MAP IN STATE.NAMES<1> SETTING STATE.POS THENş            MAP.NAME = STATE.NAMES<2,STATE.POS>ş          END ELSEş            MAP.NAME = "USA"ş            W$TITLE := " - Error: Invalid State: ":STATE.MAPş          ENDş        END ELSEş          MAP.NAME = "USA"ş        ENDş      END ELSEş        MAP.NAME = CHART.TYPE<2>ş      ENDş      READ MAP.LIST FROM F.MVDB.CONTROL, 'FCMAP.NAMES' ELSE MAP.LIST = ""ş      LOCATE MAP.NAME IN MAP.LIST SETTING DUM THENş* This is a valid map nameş        MS.NAME = MAP.NAME:".SETTINGS"ş        READ SXML FROM F.MVDB.CONTROL, MS.NAME ELSE SXML = ''ş        IF SXML = "" THENş          MS.NAME = "FCMAP.SETTINGS"ş          READ SXML FROM F.MVDB.CONTROL, MS.NAME ELSE SXML = ''ş        ENDş        MOVIE.HEIGHT = INT(CHART.HEIGHT *1.3)ş        MOVIE.WIDTH = CHART.WIDTH + 75ş*ş        READ MAP.TEMPLATE FROM F.WEB.FORMS, "FCMAP_template.html" ELSE MAP.TEMPLATE = "FMAP_template.html not found"ş        CALL SWAP(MAP.TEMPLATE,'[FCMAP_MODULE]',MAP.NAME)ş*ş        CONVERT AM TO "" IN SXMLş        IF W$CHART.OPTIONS # "" THENş          XML.OPTS = W$CHART.OPTIONSş          NODE.NAME = 'map'ş          GOSUB APPLY.XML.OPTSş        ENDş*ş        MAPDATA = '<colorRange>'ş        FOR CX = 1 TO DCOUNT( W$MAP.RANGE.NAME<1>, @VM )ş          THIS.COLOR = W$MAP.RANGE.COLOR<1,CX>ş          LOCATE THIS.COLOR IN NAME.COLOR<1> SETTING CPOS THENş            USE.COLOR = NAME.COLOR<2,CPOS>ş          END ELSE USE.COLOR = THIS.COLORş          UPDATE.OPTS = W$MAP.RANGE.OPTS<1,CX>ş          OPTS.DELIM = ' 'ş          GOSUB OPTS.UPDATEş          W$MAP.RANGE.OPTS<1,CX> = UPDATE.OPTSş          MAPDATA := "<color minValue='":W$MAP.RANGE.LOW<1,CX>:"' maxValue='":W$MAP.RANGE.HIGH<1,CX>:"' displayValue='":W$MAP.RANGE.NAME<1,CX>:"' color='":USE.COLORş          MAPDATA := "' ":W$MAP.RANGE.OPTS<1,CX>:" />"ş        NEXT CXş        MAPDATA := '</colorRange>'ş        MAPDATA := '<data>'ş        FOR MX = 1 TO DCOUNT( W$MAP.IDS<1>, @VM )ş          IF W$MAP.VALUE.DD<1,MX> = 1 THENş            MAP.LINK = CGI$PATH:"/MVDB.MAIN?udview=":WIDGET.NAME:"&udpos1=1&udval1=":W$MAP.IDS<1,MX>:"&mapdd"ş          END ELSE IF W$MAP.VALUE.LINK<1,MX> # "" THENş            MAP.LINK = W$MAP.VALUE.LINK<1,MX>ş            IF W$MAP.LINK.MODE<1,MX> = "N" THEN MAP.LINK = "n-":MAP.LINKş          END ELSEş            IF W$FW.DD.WIDGET<1,MX> # "" THENş              FW.WIDGET.POS = MXş              GOSUB MAKE.FW.DD.URLş              MAP.LINK = URLş            END ELSEş              MAP.LINK = ""ş            ENDş          ENDş          IF MAP.LINK # "" THENş            URLENCODE.STRING = MAP.LINKş            GOSUB URL.ENCODEş            MAP.LINK = NEW.STRINGş            MAP.LINK = "link='":MAP.LINK:"' "ş          ENDş          TOOLTEXT = W$MAP.VALUE.TOOLTEXT<1,MX>ş          CALL XML.ENCODE(TOOLTEXT,'')ş          UPDATE.OPTS = W$MAP.VALUE.OPTS<1,MX>ş          OPTS.DELIM = ' 'ş          GOSUB OPTS.UPDATEş          W$MAP.VALUE.OPTS<1,MX> = UPDATE.OPTSş          MAPDATA := "<entity id='":W$MAP.IDS<1,MX>:"' value='":W$MAP.VALUES<1,MX>:"' ":W$MAP.VALUE.OPTS<1,MX>:" toolText='":TOOLTEXT:"' ":MAP.LINK:"/>"ş        NEXT MXş        MAPDATA := '</data>'ş        CONVERT '"' TO "'" IN MAPDATAş        CALL SWAP(SXML,'[CHART.DATA]',MAPDATA)ş        CALL SWAP(MAP.TEMPLATE,'<!-- chart_width -->',MOVIE.WIDTH)ş        CALL SWAP(MAP.TEMPLATE,'<!-- chart_height -->',MOVIE.HEIGHT)ş        CALL SWAP(MAP.TEMPLATE,'<!-- chart_div_id -->','flashcontent_':VX)ş        CALL SWAP(MAP.TEMPLATE,'<!-- CHARTXML -->',SXML)ş        HTML = MAP.TEMPLATEş      END ELSEş        HTML = "Map name '":MAP.NAME:"' not found in MVDB.CONTROL, FCMAP.NAMES"ş      ENDş    CASE W$TYPE = "TABLE"ş      HTML<-1> = '<table class="gridWidget" width="100%" >'ş      HTML<-1> = '<thead>'ş      HTML<-1> = '<tr>'ş      TABLE.COLS = DCOUNT( W$TABLE.COL.LABELS<1>, VM )ş      FOR CHX = 1 TO TABLE.COLSş        IF W$TABLE.COL.JUST<1,CHX> # "" THENş          ALIGN = ' align="':W$TABLE.COL.JUST<1,CHX>:'"'ş        END ELSE ALIGN = ""ş        LABEL = W$TABLE.COL.LABELS<1,CHX>ş        IF LABEL = '' THEN LABEL = '&nbsp;'ş        HTML<-1> = '<th':ALIGN:' >':LABEL:'</th>'ş      NEXT CHXş      HTML<-1> = '</tr>'ş      HTML<-1> = '</thead>'ş      HTML<-1> = '<tbody>'ş      TABLE.ROWS = DCOUNT( W$TABLE.DATA, AM )ş      FOR TRX = 1 TO TABLE.ROWSş        HTML<-1> = '<tr>'ş        THIS.ROW = W$TABLE.DATA<TRX>ş        FOR TRC = 1 TO TABLE.COLSş          IF W$TABLE.COL.JUST<1,TRC> # "" THENş            ALIGN = ' align="':W$TABLE.COL.JUST<1,TRC>:'"'ş          END ELSE ALIGN = ""ş          VALUE = THIS.ROW<1,TRC>ş          IF VALUE = '' THEN VALUE = '&nbsp;'ş          THIS.COL = '<td':ALIGN:'>':VALUE:'</td>'ş          HTML<-1> = THIS.COLş        NEXT TRCş        HTML<-1> = '</tr>'ş      NEXT TRXş      HTML<-1> = '</tbody>'ş      HTML<-1> = '<tfoot>'ş      HTML<-1> = '<tr>'ş      FOR CHX = 1 TO TABLE.COLSş        IF W$TABLE.COL.JUST<1,CHX> # "" THENş          ALIGN = ' align="':W$TABLE.COL.JUST<1,CHX>:'"'ş        END ELSE ALIGN = ""ş        VALUE = W$TABLE.TOTALS<1,CHX>ş        IF VALUE = '' THEN VALUE = '&nbsp;'ş        HTML<-1> = '<td':ALIGN:'>':VALUE:'</td>'ş      NEXT CHXş      HTML<-1> = '</tr>'ş      HTML<-1> = '</tfoot>'ş      HTML<-1> = '</table>'ş    CASE W$TYPE = "TEXT"ş      HTML = '<pre>'ş      HTML<-1> = W$TEXT.DATAş      HTML<-1> = '</pre>'ş    CASE W$TYPE = "HTML"ş      HTML = W$HTML.DATAş*PDF* Check if widget-generated HTML includes a <head> tag, which we interpret as having its own stylingş      IF INDEX(HTML,'<head>',1)+INDEX(HTML,'<HEAD>',1) THEN WIDGET.OWN.STYLE = TRUEş      IF WIDGET.OWN.STYLE AND IFRAME.WIDGET.NAME = "" AND PDF.WIDGET.NAME = "" THENş* Not rendering PDF or returning iframe content - changeş* widget content to iframe so styles render properly.ş        CALL REBUILD.URL.STRING(IFRAME.URL.STRING)ş        URLENCODE.STRING = WIDGET.NAMEş        GOSUB URL.ENCODEş        IFRAME.URL.STRING = '/dbc/MVDB.MAIN?iframewidget=':NEW.STRING:'&':IFRAME.URL.STRING ;* stash widget name in URL string so we know which widget to use for iframe contentş        HTML = '<iframe src="':IFRAME.URL.STRING:'" width="100%" style="height: 100vh;">':WIDGET.NAME:'</iframe>'ş      ENDş    CASE 1ş      HTML = "INVALID TYPE ":W$TYPEş  END CASEş*ş  IF IFRAME.WIDGET.NAME # "" THENş* Returning iframe content - no widget styling neededş    HTML.DIV = '<!-- WIDGETDATA -->'ş  END ELSEş    IF WIDGET.OWN.STYLE AND PDF.WIDGET.NAME # "" THENş* Render PDF from widget HTML that has a <head> tag - no widget styling neededş      HTML.DIV = '<!-- WIDGETDATA -->'ş    END ELSEş* normal widget stylesş      HTML.DIV = WIDGET.DIVş    ENDş  ENDş*ş  Q1.LINKS = ''ş  Q2.LINKS = ''ş  Q3.LINKS = ''ş  Q4.LINKS = ''ş  Q5.LINKS = ''ş*ş* Add source code edit link for administrative userş*ş*ş* FIX 6-1-16 ADD A GO BACK IN ICON LISTş*ş  NEXT.LINK.POS = DCOUNT(W$LINK.LABEL<1>,@VM)ş  NEXT.LINK.POS2 = DCOUNT(W$LINK.ICON<1>,@VM)ş  IF NEXT.LINK.POS2 > NEXT.LINK.POS THEN NEXT.LINK.POS=NEXT.LINK.POS2ş  READ DD.STACK FROM F.MVDB.UDATA, SESSION$ID:'$DD.STACK' ELSE DD.STACK=''ş  MAX.DD.STACK=DCOUNT(DD.STACK,AM)ş  IF MAX.DD.STACK > 2 THENş    NEXT.LINK.POS += 1ş    W$LINK.ICON<1,NEXT.LINK.POS> = 'arrow_left.png'ş    W$LINK.ICON.TXT<1,NEXT.LINK.POS> = "Go Back"ş    W$LINK.URL<1,NEXT.LINK.POS> = "javascript:history.back()"; * 9-23-16 *ş    W$LINK.LOCATION<1,NEXT.LINK.POS> = "C"ş  ENDş* END FIX 6-1-16ş  IF adminauth = 1 THENş* 6-1-16 *  NEXT.LINK.POS = DCOUNT( W$LINK.LABEL<1>, @VM )ş* 6-1-16 *  NEXT.LINK.POS2 = DCOUNT( W$LINK.ICON<1>, @VM )ş* 6-1-16 *  IF NEXT.LINK.POS2 > NEXT.LINK.POS THEN NEXT.LINK.POS = NEXT.LINK.POS2ş    NEXT.LINK.POS += 1ş    W$LINK.ICON<1,NEXT.LINK.POS> = "script_edit.png"ş    W$LINK.ICON.TXT<1,NEXT.LINK.POS> = "Edit BASIC Source"ş    IF WDEBUG.MODE OR WFAIL.MODE THENş      USE.SUBNAME = GLOBAL.INFO(91) ;* Original subroutine nameş    END ELSE USE.SUBNAME = SUBNAMEş    URLENCODE.STRING = USE.SUBNAMEş    GOSUB URL.ENCODEş    URL.SUBNAME = NEW.STRINGş    W$LINK.URL<1,NEXT.LINK.POS> = "/dbc/MVDB.WEB.ED?ed_file=MVDB.SUBS&ed_item=":URL.SUBNAMEş    W$LINK.URL.OPTS<1,NEXT.LINK.POS> = 'target="ED_MVDB.SUBS_':URL.SUBNAME:'"'ş    W$LINK.LOCATION<1,NEXT.LINK.POS> = "C"ş*ş* Add debug widget link for administrative userş*ş    IF NOT(WFAIL.MODE) THENş      NEXT.LINK.POS += 1ş      W$LINK.ICON<1,NEXT.LINK.POS> = "information.png" ;* Change this to a real debug iconş      IF WDEBUG.MODE THENş        W$LINK.ICON.TXT<1,NEXT.LINK.POS> = "Normal Mode"ş      END ELSEş        W$LINK.ICON.TXT<1,NEXT.LINK.POS> = "Debug Mode"ş      ENDş      URLENCODE.STRING = WIDGET.NAMEş      GOSUB URL.ENCODEş      IF WDEBUG.MODE THENş        W$LINK.URL<1,NEXT.LINK.POS> = "/dbc/MVDB.MAIN?undebug_widget=":NEW.STRINGş      END ELSEş        W$LINK.URL<1,NEXT.LINK.POS> = "/dbc/MVDB.MAIN?debug_widget=":NEW.STRINGş      ENDş      W$LINK.LOCATION<1,NEXT.LINK.POS> = "C"ş    ENDş  ENDş  IF W$PRINTABLE = 1 THENş    NEXT.LINK.POS = DCOUNT( W$LINK.LABEL<1>, @VM )ş    NEXT.LINK.POS2 = DCOUNT( W$LINK.ICON<1>, @VM )ş    IF NEXT.LINK.POS2 > NEXT.LINK.POS THEN NEXT.LINK.POS = NEXT.LINK.POS2ş    NEXT.LINK.POS += 1ş    W$LINK.ICON<1,NEXT.LINK.POS> = "printer.png"ş    W$LINK.ICON.TXT<1,NEXT.LINK.POS> = "Print"ş    W$LINK.LABEL<1,NEXT.LINK.POS> = "Print"ş    W$LINK.URL<1,NEXT.LINK.POS> = "#"ş*W$LINK.URL.OPTS<1,NEXT.LINK.POS> = 'onClick="printThis(this);"'ş    W$LINK.URL.OPTS<1,NEXT.LINK.POS> = 'class="DansClass"'ş    W$LINK.LOCATION<1,NEXT.LINK.POS> = 'C'ş  ENDş*ş*PDF* If PDF generation is enabled, and supported for this widget, add a PDF icon to the control menuş  IF PDF$ENABLED AND W$PDFABLE AND PDF.WIDGET.NAME = "" THENş    NEXT.LINK.POS = DCOUNT( W$LINK.LABEL<1>, @VM )ş    NEXT.LINK.POS2 = DCOUNT( W$LINK.ICON<1>, @VM )ş    IF NEXT.LINK.POS2 > NEXT.LINK.POS THEN NEXT.LINK.POS = NEXT.LINK.POS2ş    NEXT.LINK.POS += 1ş    W$LINK.ICON<1,NEXT.LINK.POS> = "page_white_acrobat.png"ş    W$LINK.ICON.TXT<1,NEXT.LINK.POS> = "Generate PDF"ş    W$LINK.LABEL<1,NEXT.LINK.POS> = "Generate PDF"ş    CALL REBUILD.URL.STRING(CURRENT.URL.STRING)ş    PDF.URL.STRING=CURRENT.URL.STRINGş    URLENCODE.STRING = WIDGET.NAMEş    GOSUB URL.ENCODEş    PDF.URL.STRING := '&generatepdf=':NEW.STRING ;* stash widget name in URL string so we know which widget to render as PDFş    W$LINK.URL<1,NEXT.LINK.POS> = "/dbc/MVDB.MAIN?":PDF.URL.STRINGş    W$LINK.LOCATION<1,NEXT.LINK.POS> = 'C'ş  ENDş*ş* 6-27-16 *EXCEL* If EXCEL generation is supported for this widget, add a EXCEL icon to the control menuş  IF W$EXCELABLE AND EXCEL.WIDGET.NAME = '' THENş    NEXT.LINK.POS = DCOUNT( W$LINK.LABEL<1>, @VM )ş    NEXT.LINK.POS2 = DCOUNT( W$LINK.ICON<1>, @VM )ş    IF NEXT.LINK.POS2 > NEXT.LINK.POS THEN NEXT.LINK.POS = NEXT.LINK.POS2ş    NEXT.LINK.POS += 1ş    W$LINK.ICON<1,NEXT.LINK.POS> = "page_white_excel.png"ş    W$LINK.ICON.TXT<1,NEXT.LINK.POS> = "Generate Spreadsheet"ş    W$LINK.LABEL<1,NEXT.LINK.POS> = "Generate Spreadsheet"ş    CALL REBUILD.URL.STRING(CURRENT.URL.STRING)ş    URLENCODE.STRING=CURRENT.URL.STRINGş    GOSUB URL.ENCODEş    EXCEL.URL.STRING=NEW.STRINGş    URLENCODE.STRING = WIDGET.NAMEş    GOSUB URL.ENCODEş    EXCEL.URL.STRING := '&generateexcel=':NEW.STRING ;* stash widget name in URL string so we know which widget to render as Excel spreadsheetş    W$LINK.URL<1,NEXT.LINK.POS> = "/dbc/MVDB.MAIN?":EXCEL.URL.STRINGş    W$LINK.LOCATION<1,NEXT.LINK.POS> = 'C'ş  ENDş* END OF 6-27-16 *EXCEL*ş*ş  LINK.CNT = DCOUNT( W$LINK.LABEL<1>, VM )ş  LINK.CNT2 = DCOUNT( W$LINK.ICON<1>, VM )ş  IF LINK.CNT2 > LINK.CNT THEN LINK.CNT = LINK.CNT2ş  FOR LX = 1 TO LINK.CNTş    THIS.LABEL = W$LINK.LABEL<1,LX>ş    THIS.LOC = W$LINK.LOCATION<1,LX>ş    THIS.UD.POS = W$LINK.UD.POS<1,LX>ş    THIS.UD.VAL = W$LINK.UD.VAL<1,LX>ş    THIS.DD.WIDGET = W$LINK.DD.WIDGET<1,LX>ş    THIS.URL = W$LINK.URL<1,LX>ş    THIS.URL.OPTS = W$LINK.URL.OPTS<1,LX>ş*ş    IF THIS.LOC = '' THEN THIS.LOC = '1' ;* Set to quadrant 1 if not specifiedş*ş    IF THIS.URL # "" THENş* Specific URL = ignore UD information and Drill down (DD) info.ş      URL = THIS.URLş    END ELSEş      IF THIS.DD.WIDGET # "" THEN TARGET.WIDGET = THIS.DD.WIDGET ELSE TARGET.WIDGET = WIDGET.NAMEş      URLENCODE.STRING = TARGET.WIDGETş      GOSUB URL.ENCODEş      TARGET.WIDGET = NEW.STRINGş      URL = CGI$PATH:"/MVDB.MAIN?udview=":TARGET.WIDGETş      FOR UDX = 1 TO DCOUNT( THIS.UD.POS<1,1>,SVM )ş        URLENCODE.STRING = THIS.UD.VAL<1,1,UDX>ş        GOSUB URL.ENCODEş        URL := "&udpos":UDX:"=":THIS.UD.POS<1,1,UDX>:"&udval":UDX:"=":NEW.STRINGş      NEXT UDXş      IF THIS.DD.WIDGET # "" THENş        URL := "&dd"ş* Include the name of this widget in the drilldown link so the target widget knows the referrerş        URLENCODE.STRING = WIDGET.NAMEş        GOSUB URL.ENCODEş        URL := '&dd_from=':NEW.STRINGş      ENDş    ENDş    IF W$LINK.ICON<1,LX> # "" THENş      IMG.REF = '<img title="':W$LINK.ICON.TXT<1,LX>:'" class="icon" src="/db/icons/':W$LINK.ICON<1,LX>:'" />'ş    END ELSE IMG.REF = ''ş    IF INDEX(THIS.LOC,'C',1) AND IMG.REF # '' THEN ;* This is a Control Iconş      LINK.DATA = '<a href="':URL:'" ':THIS.URL.OPTS:'>':IMG.REF:'</a>'ş    END ELSEş      LINK.DATA = '<a href="':URL:'" ':THIS.URL.OPTS:'>':IMG.REF:THIS.LABEL:'</a>'ş    ENDş*ş    IF INDEX(THIS.LOC,'1',1) THENş      Q1.LINKS := LINK.DATA:'&nbsp;'ş    ENDş    IF INDEX(THIS.LOC,'2',1) THENş      Q2.LINKS := LINK.DATA:'&nbsp;'ş    ENDş    IF INDEX(THIS.LOC,'3',1) THENş      Q3.LINKS := LINK.DATA:'&nbsp;'ş    ENDş    IF INDEX(THIS.LOC,'4',1) THENş      Q4.LINKS := LINK.DATA:'&nbsp;'ş    ENDş    IF INDEX(THIS.LOC,'C',1) THENş      Q5.LINKS := LINK.DATA:'&nbsp;'ş    ENDş  NEXT LXş  IF Q1.LINKS # "" THENş    Q1.LINKS = '<div class="widget_trcorner widget_corner">':Q1.LINKS:'</div>'ş  ENDş  IF Q2.LINKS # "" THENş    Q2.LINKS = '<div class="widget_tlcorner widget_corner">':Q2.LINKS:'</div>'ş  ENDş  IF Q3.LINKS # "" THENş    Q3.LINKS = '<div class="widget_blcorner widget_corner">':Q3.LINKS:'</div>'ş  ENDş  IF Q4.LINKS # "" THENş    Q4.LINKS = '<div class="widget_brcorner widget_corner">':Q4.LINKS:'</div>'ş  ENDş*ş* Create the input sectionş*ş  INP.CNT = DCOUNT( W$INPUT.PROMPT, AM )ş  INP.HTML = ''ş  IF INP.CNT THENş* PJS 10-07-16: Change method from GET to POST to eliminate URL length limitationş* when form contains many input controls.ş    IF INP.CNT > 20 THENş      INP.HTML = '<form method="POST" class="widget_form" action="':CGI$PATH:'/MVDB.MAIN">'ş    END ELSEş      INP.HTML = '<form method="GET" class="widget_form">'ş    ENDş    FOR IX = 1 TO INP.CNTş      INP.HTML<-1> = '<div class="widget_control">'ş      INP.HTML<-1> = '<label ':W$INPUT.PROMPT.PARAMS<IX>:'>':W$INPUT.PROMPT<IX>:':</label>'ş      BEGIN CASEş        CASE W$INPUT.TYPE<IX> = "TEXT"ş          INP.HTML<-1> = '<input type="text" name="inp_':W$INPUT.UDPOS<IX>:'" value="':W$INPUT.DEFAULT<IX>:'" ':W$INPUT.PARAMS<IX>:'>'ş        CASE W$INPUT.TYPE<IX> = "PASSWORD"ş          INP.HTML<-1> = '<input type="password" name="inp_':W$INPUT.UDPOS<IX>:'" value="':W$INPUT.DEFAULT<IX>:'" ':W$INPUT.PARAMS<IX>:'>'ş        CASE W$INPUT.TYPE<IX> = "DATE"ş          INP.HTML<-1> = '<input class="datepicker" type="text" name="inp_':W$INPUT.UDPOS<IX>:'" value="':W$INPUT.DEFAULT<IX>:'" ':W$INPUT.PARAMS<IX>:'>'ş        CASE W$INPUT.TYPE<IX> = "SELECT"ş          INP.HTML<-1> = '<select name="inp_':W$INPUT.UDPOS<IX>:'" ':W$INPUT.PARAMS<IX>:'>'ş          SCNT = DCOUNT( W$INPUT.SELOPTS<IX>, VM )ş          IF W$INPUT.SELVALS<IX> = "" THEN W$INPUT.SELVALS<IX> = W$INPUT.SELOPTS<IX>ş          FOR SELX = 1 TO SCNTş            IF W$INPUT.SELVALS<IX,SELX> = W$INPUT.DEFAULT<IX> THEN DFLT = "selected" ELSE DFLT = ""ş            INP.HTML<-1> = '<option value="':W$INPUT.SELVALS<IX,SELX>:'" ':DFLT:'>':W$INPUT.SELOPTS<IX,SELX>:'</option>'ş          NEXT SELXş          INP.HTML<-1> = '</select>'ş        CASE W$INPUT.TYPE<IX> = "CHECKBOX"ş          INP.HTML<-1> = '<input type="checkbox" name="inp_':W$INPUT.UDPOS<IX>:'" value="1" ':W$INPUT.PARAMS<IX>ş          IF W$INPUT.DEFAULT<IX> = 1 THENş            INP.HTML := ' checked'ş          ENDş          INP.HTML := '>'ş*add a hidden field to let up know that there was a checkbox on the form.ş*unchecked checkboxes don't get submitted with the rest of the form data.ş          INP.HTML<-1> = '<input type="hidden" name="mvdbcxbx_':W$INPUT.UDPOS<IX>:'" value="1">'ş        CASE 1 ; NULLş      END CASEş      INP.HTML<-1> = '</div>'ş    NEXT IXş    IF W$INPUT.BUTTON = "" THEN W$INPUT.BUTTON = "Go"ş    INP.HTML<-1> = '<div class="widget_control"><input type="submit" value="':W$INPUT.BUTTON:'" ></div>'ş    INP.HTML<-1> = '<input type="hidden" name="udview" value="':WIDGET.NAME:'">'ş    INP.HTML<-1> = '<input type="hidden" name="sw" value="':WIDGET.NAME:'">'ş    IF G$DRILLDOWN.MODE THENş      INP.HTML<-1> = '<input type="hidden" name="dd" value="">'ş      INP.HTML<-1> = '<input type="hidden" name="dd_from" value="':G$DD.REFERRER:'">'ş      INP.HTML<-1> = '<input type="hidden" name="dd_from_db" value="':G$DD.FROM.DB:'">'ş    ENDş    INP.HTML<-1> = '</form>'ş    INP.HTML = '<div class="widget_input">':INP.HTML:'</div>'ş  ENDş*ş*PDF* Omit the control icons in the PDF documentş  IF PDF.WIDGET.NAME # "" THENş    Q5.LINKS = ""ş  ENDş*ş  ENC.TITLE = W$TITLEş  CALL XML.ENCODE(ENC.TITLE,"")ş  CALL SWAP(HTML.DIV,'<!-- TITLE -->',ENC.TITLE)ş  CALL SWAP(HTML.DIV,'<!-- QUAD1 -->',Q1.LINKS)ş  CALL SWAP(HTML.DIV,'<!-- QUAD2 -->',Q2.LINKS)ş  CALL SWAP(HTML.DIV,'<!-- QUAD3 -->',Q3.LINKS)ş  CALL SWAP(HTML.DIV,'<!-- QUAD4 -->',Q4.LINKS)ş  CALL SWAP(HTML.DIV,'<!-- CONTROLS -->',Q5.LINKS)ş  CALL SWAP(HTML.DIV,'<!-- INPUT -->',INP.HTML)ş  CALL SWAP(HTML.DIV,'<!-- WIDGETDATA -->',HTML)ş  RETURNş*şAPPLY.XML.OPTS: * Apply XML option overridesş*ş  SXML.ATTRS = ""ş  ATTR.VAR.LIST = ''ş* Parse the attrbiutes from the XML tag.ş  CPOS = 3 + LEN(NODE.NAME) ;* Start after "<graph " or "<map " depending on the node name.ş  SXML.ATTR.POS = 0ş  SXML.LEN = LEN(SXML)ş  THIS.ATTR = ''ş  SXML.SUFFIX = '>[CHART.DATA]</':NODE.NAME:'>'ş  LOOP UNTIL CPOS > SXML.LEN DOş    THIS.CH = SXML[CPOS,1]ş    BEGIN CASEş      CASE THIS.CH = '<' ;* Nothing to do - beginningş        THIS.ATTR = ''ş      CASE THIS.CH = ' 'ş        GOSUB ADD.SXML.ATTRş      CASE THIS.CH = '>' ;* Ending tagş        GOSUB ADD.SXML.ATTRş        SXML.SUFFIX = SXML[CPOS,999]ş        EXITş      CASE 1ş        THIS.ATTR := THIS.CHş    END CASEş    CPOS += 1ş  REPEATş  GOSUB ADD.SXML.ATTRş*ş  CONVERT '"' TO "'" IN XML.OPTSş  CONVERT @VM TO @AM IN XML.OPTSş  XML.OPT.CNT = DCOUNT( XML.OPTS, AM )ş  FOR XOX = 1 TO XML.OPT.CNTş    THIS.OPT = XML.OPTS<XOX>ş    OPT.VAR = FIELD( THIS.OPT, '=', 1 )ş    LOCATE OPT.VAR IN ATTR.VAR.LIST SETTING XOPOS THENş      SXML.ATTRS<XOPOS> = THIS.OPTş    END ELSEş      THIS.ATTR = THIS.OPTş      GOSUB ADD.SXML.ATTRş    ENDş  NEXT XOXş*ş* Rebuild SXMLş*ş  SXML = '<':NODE.NAME:' 'ş  FOR XOX = 1 TO SXML.ATTR.POSş    SXML := SXML.ATTRS<XOX>:' 'ş  NEXT XOXş  SXML := SXML.SUFFIXş  RETURNş*şADD.SXML.ATTR: * Add an attrbiute to the listş*ş  IF THIS.ATTR # '' THENş    SXML.ATTR.POS += 1ş    SXML.ATTRS<SXML.ATTR.POS> = THIS.ATTRş    ATTR.VAR.LIST<SXML.ATTR.POS> = FIELD(THIS.ATTR,'=',1)ş    THIS.ATTR = ''ş  ENDş  RETURNş*şAPPLY.COLOR.OPTS: * Build COLOR.ARRAY from defaults and user settingsş*ş  COLOR.ARRAY = ''ş  DFLT.COLOR.ARRAY = ''ş  IF DB.THEME # '' THENş    READ THEME.REC FROM F.MVDB.THEMES, DB.THEME ELSE THEME.REC = ''ş    DFLT.COLOR.ARRAY = DELETE(THEME.REC,1,0,0)ş    CONVERT AM TO VM IN DFLT.COLOR.ARRAYş  END ELSE IF SITE$THEME # '' THENş    READ THEME.REC FROM F.MVDB.THEMES, SITE$THEME ELSE THEME.REC = ''ş    DFLT.COLOR.ARRAY = DELETE(THEME.REC,1,0,0)ş    CONVERT AM TO VM IN DFLT.COLOR.ARRAYş  ENDş  IF DFLT.COLOR.ARRAY = '' THENş    DFLT.COLOR.ARRAY<1,-1> = '#ff8125'ş    DFLT.COLOR.ARRAY<1,-1> = '#584d43'ş    DFLT.COLOR.ARRAY<1,-1> = '#2e2a27'ş    DFLT.COLOR.ARRAY<1,-1> = '#7b746d'ş    DFLT.COLOR.ARRAY<1,-1> = '#e78859'ş    DFLT.COLOR.ARRAY<1,-1> = '#f04408'ş    DFLT.COLOR.ARRAY<1,-1> = '#bd5204'ş    DFLT.COLOR.ARRAY<1,-1> = '#733e30'ş  ENDş  DFLT.MAX = DCOUNT( DFLT.COLOR.ARRAY<1>, VM )ş*ş  MAX.COLOR.AM = DCOUNT( COLOR.LIST, AM )ş  IF MAX.COLOR.AM = 0 THEN MAX.COLOR.AM = 1ş  FOR CLX = 1 TO MAX.COLOR.AMş    MAX.COLOR.VAL = DCOUNT( COLOR.LIST<CLX>, VM )ş    IF MAX.COLOR.VAL < DFLT.MAX THEN MAX.COLOR.VAL = DFLT.MAXş    FOR CLXV = 1 TO MAX.COLOR.VALş      IF COLOR.LIST<CLX,CLXV> # "" THENş        LOCATE OCONV(COLOR.LIST<CLX,CLXV>,"MCU") IN NAME.COLOR<1> SETTING COLOR.POS THENş          COLOR.LIST<CLX,CLXV> = NAME.COLOR<2,COLOR.POS>ş        ENDş        COLOR.ARRAY<CLX,CLXV> = COLOR.LIST<CLX,CLXV>ş      END ELSEş        COLOR.ARRAY<CLX,CLXV> = DFLT.COLOR.ARRAY<1,CLXV>ş      ENDş    NEXT CLXVş  NEXT CLXş  RETURNş*şURL.ENCODE: *ş*ş  NEW.STRING = ""ş  UE.LEN = LEN(URLENCODE.STRING)ş  FOR UEX = 1 TO UE.LENş    UE.CHR = URLENCODE.STRING[UEX,1]ş    UE.CVAL = SEQ(UE.CHR)ş    BEGIN CASEş      CASE UE.CVAL <= 47 ; ENC.FLAG = 1ş      CASE UE.CVAL >= 58 AND UE.CVAL <= 64 ; ENC.FLAG = 1ş      CASE UE.CVAL >= 91 AND UE.CVAL <= 96 ; ENC.FLAG = 1ş      CASE UE.CVAL > 122 ; ENC.FLAG = 1ş      CASE 1 ; ENC.FLAG = 0ş    END CASEş    IF ENC.FLAG THENş      UE.CHR = "%":(OCONV(UE.CVAL,'MCDX') 'R%2')ş    ENDş    NEW.STRING := UE.CHRş  NEXT UEXş  RETURNş*şTICKMARK.OPTIONS: * For charts that support tickmark optionsş*ş* Convert the settings in W$FW.TICKMARKS into the appropriate XML attributes to beş* added to the <chart> tag via W$CHART.OPTIONSş*ş  IF W$FW.TICKMARKS<1> = "0" THENş    W$CHART.OPTIONS<-1> = "showTickMarks='0'"ş    W$CHART.OPTIONS<-1> = "showTickValues='0'"ş  END ELSEş    IF W$FW.TICKMARKS<2> = 0 THENş      W$CHART.OPTIONS<-1> = "showTickValues='0'"ş    ENDş    IF W$FW.TICKMARKS<3> = "A" THENş      W$CHART.OPTIONS<-1> = "ticksBelowGraph='0'"ş    ENDş    IF W$FW.TICKMARKS<4> # "" THENş      W$CHART.OPTIONS<-1> = "majorTMNumber='":W$FW.TICKMARKS<4>:"'"ş    ENDş    IF W$FW.TICKMARKS<5> # "" THENş      W$CHART.OPTIONS<-1> = "minorTMNumber='":W$FW.TICKMARKS<5>:"'"ş    ENDş  ENDş  RETURNş*şMAKE.FW.DD.URL: *ş*ş  TARGET.WIDGET = W$FW.DD.WIDGET<1,FW.WIDGET.POS>ş  IF TARGET.WIDGET = "" THENş    URL = ""ş    RETURNş  ENDş  URLENCODE.STRING = TARGET.WIDGETş  GOSUB URL.ENCODEş  TARGET.WIDGET = NEW.STRINGş  URL = CGI$PATH:"/MVDB.MAIN?udview=":TARGET.WIDGETş  FOR UDX = 1 TO DCOUNT( W$FW.DD.UD.POS<1,FW.WIDGET.POS>,SVM )ş    URLENCODE.STRING = W$FW.DD.UD.VAL<1,FW.WIDGET.POS,UDX>ş* BEGIN ZUMASYS 1-5-15ş    BEGIN CASEş      CASE URLENCODE.STRING = 'MS.LABEL'ş        URLENCODE.STRING=MS.LABELş      CASE URLENCODE.STRING = 'MS.VALUE'ş        URLENCODE.STRING=MS.VALUEş      CASE URLENCODE.STRING = 'MS.SERIES'; *3-15-15ş        URLENCODE.STRING=MS.SERIES; *3-15-15ş      CASE 1; NULLş    END CASEş* END ZUMASYS 1-5-15ş    GOSUB URL.ENCODEş    URL := "&udpos":UDX:"=":W$FW.DD.UD.POS<1,FW.WIDGET.POS,UDX>:"&udval":UDX:"=":NEW.STRINGş  NEXT UDXş  URL := "&dd"ş* Include the name of this widget in the drilldown link so the target widget knows the referrerş  URLENCODE.STRING = WIDGET.NAMEş  GOSUB URL.ENCODEş  URL := '&dd_from=':NEW.STRINGş* Specify the dashboard to return to from this drilldown view.ş  IF G$DRILLDOWN.MODE THENş    SOURCE.DB = G$DD.FROM.DBş  END ELSE SOURCE.DB = G$CURRENT.DBş  URLENCODE.STRING = SOURCE.DBş  GOSUB URL.ENCODEş  URL := '&dd_from_db=':NEW.STRINGş  RETURNş*şOPTS.UPDATE:ş  IF NOT(INDEX(UPDATE.OPTS,'decimalSeparator',1)) THENş    UPDATE.OPTS := OPTS.DELIM:"decimalSeparator='":DECIMAL:"'"ş  ENDş  IF NOT(INDEX(UPDATE.OPTS,'thousandSeparator',1)) THENş    UPDATE.OPTS := OPTS.DELIM:"thousandSeparator='":THOUSAND:"'"ş  ENDş  RETURNşEND0002F4SUB.URL.ENCODEş0c2SUBROUTINE SUB.URL.ENCODE(URLENCODE.STRING)ş*ş* (C) Copyright 2009, Sierra Bravo Corporation, All Rights Reservedş* ş* Author: Luke Bucklin, Sierra Bravo Corporationş* Date: August 7, 2009ş* Purpose: URL encode a text stringş*şNEW.STRING = ""şUE.LEN = LEN(URLENCODE.STRING)şFOR UEX = 1 TO UE.LENş  UE.CHR = URLENCODE.STRING[UEX,1]ş  UE.CVAL = SEQ(UE.CHR)ş  BEGIN CASEş    CASE UE.CVAL <= 47 ; ENC.FLAG = 1ş    CASE UE.CVAL >= 58 AND UE.CVAL <= 64 ; ENC.FLAG = 1ş    CASE UE.CVAL >= 91 AND UE.CVAL <= 96 ; ENC.FLAG = 1ş    CASE UE.CVAL > 122 ; ENC.FLAG = 1ş    CASE 1 ; ENC.FLAG = 0ş  END CASEş  IF ENC.FLAG THENş    UE.CHR = "%":(OCONV(UE.CVAL,'MCDX') 'R%2')ş  ENDş  NEW.STRING := UE.CHRşNEXT UEXşURLENCODE.STRING = NEW.STRINGşRETURNşEND 0024B2MV.COMPILEş0c2* MV.COMPILE - Sierra Bravo Precompilerş*ş* Copyright (C) 2006 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Luke Bucklinş* Date: 12/26/2006ş* Description: Precompilerş*ş* Modified By: Peter Schellenbach, Zumasysş* Date: 06/12/2015ş* Description: Changed PROCREAD to use SENTENCE() in the ELSE clauseş*ş*PJS 06-12-15*PROCREAD TCL.LINE ELSE TCL.LINE = ''şPROCREAD TCL.LINE ELSE TCL.LINE = SENTENCE() ; *PJS 06-12-15*şTCL.LINE = TRIM( TCL.LINE )şVERB = FIELD(TCL.LINE,' ', 1)şFILE = FIELD( TCL.LINE, ' ', 2 )şITEM.LIST = ''şIF SYSTEM(11) THENş  LOOPş    READNEXT ITEM ELSE EXITş    ITEM.LIST<-1> = ITEMş  REPEATşEND ELSEş  POS = 3ş  LOOPş    ITEM = FIELD( TCL.LINE, ' ', POS )ş  UNTIL ITEM = '' OR ITEM[1,1] = '(' DOş    ITEM.LIST<-1> = ITEMş    POS += 1ş  REPEATşENDşOPTS.POS = INDEX( TCL.LINE, '(', 1 )şIF OPTS.POS THENş  OPTS = TCL.LINE[OPTS.POS,999]şEND ELSE OPTS = ''ş*şOPEN FILE TO FILEVAR ELSE STOP 201, FILEş*şINC.FILE = FILE:".INC"şOPEN INC.FILE TO INC.FILEVAR ELSEş  EXECUTE "CREATE-FILE ":INC.FILE:" 1 51"ş  OPEN INC.FILE TO INC.FILEVAR ELSE STOP 201, INC.FILEşENDşOPEN '','MVPC.CONTROL' TO F.MVPC.CONTROL ELSEş  EXECUTE "CREATE-FILE MVPC.CONTROL 3 11" CAPTURING JUNKş  OPEN '','MVPC.CONTROL' TO F.MVPC.CONTROL ELSE STOP 201, 'MVPC.CONTROL'şENDş*şDELIMS = \"'\şONE.WORD.TOKENS = ""şONE.WORD.TOKENS<-1> = "notrim"şONE.WORD.TOKENS<-1> = "exists"ş*şITEM.CNT = DCOUNT( ITEM.LIST, @AM )şFOR ITEM.X = 1 TO ITEM.CNTş  PRINT "MV Precompiler Version 1.0 ":ş  INC.SOURCE = '** Auto-generated source code. Do not modify this file.'ş  INC.SOURCE<-1> = "VAR$ERR = ''"ş  INC.SOURCE<-1> = "CALL WDB.VARS(VARS,VALS)"ş  INC.SOURCE<-1> = "*"ş  INC.SOURCE<-1> = 'LOCATE "xmlQuery" IN VARS SETTING POS THEN'ş  INC.SOURCE<-1> = '  XML$QUERY = 1'ş  INC.SOURCE<-1> = 'END ELSE XML$QUERY = 0'ş  XML.INFO = '<vars>'ş  VAR.INFO = ''ş  VAR.INFO.POS = 1ş  ITEM = ITEM.LIST<ITEM.X>ş  READ SOURCE FROM FILEVAR, ITEM ELSEş    PRINT "Item '":ITEM:"' not on file."ş    CONTINUEş  ENDş  DELETE INC.FILEVAR, ITEMş  SOURCE.LINES = DCOUNT( SOURCE, @AM )ş  SLINE = 1ş  END.OF.PC = 0ş  PARSED.ANY = 0ş  PC.ERRORS = 0ş  LOOPş    LINE = SOURCE<SLINE>ş    IF TRIM(LINE)[1,1] = "!" THENş      GOSUB PARSE.LINEş      IF SYNTAX.ERROR # "" THENş        PRINTş        PRINT "Syntax Error: ":SYNTAX.ERRORş        PRINT SLINE:": ":LINEş        PARSED = 0ş        PC.ERRORS += 1ş      ENDş      IF PARSED THENş        PRINT ".":ş        PARSED.ANY = 1ş        THIS.INC = ""ş        IF REQUIRE.ERROR = "" THENş          REQUIRE.ERROR = FROMVAR:' required.'ş        ENDş        IF ITERATIVE THENş          FROMVAR = FROMVAR[1,LEN(FROMVAR)-2]ş          VARNAME = VARNAME[1,LEN(VARNAME)-2]ş          THIS.INC<-1> = "VAR$CNT = DCOUNT( VARS, @AM )"ş          THIS.INC<-1> = "VAR$STRLEN = ":LEN(FROMVAR)ş          THIS.INC<-1> = VARNAME:" = ''"ş          IF VARTYPE = "date" THENş            THIS.INC<-1> = VARNAME:".I = ''"ş          ENDş          THIS.INC<-1> = "FOR VAR$X = 1 TO VAR$CNT"ş          THIS.INC<-1> = \  IF VARS<VAR$X> MATCHES "'\:FROMVAR:\'1N0N" THEN\ş          THIS.INC<-1> = '    VAR$NUM = VARS<VAR$X>[VAR$STRLEN+1,99]'ş          THIS.INC<-1> = '    ':VARNAME:'<VAR$NUM> = VALS<VAR$X>'ş          IF VARTYPE = "date" THENş            THIS.INC<-1> = '    ':VARNAME:'.I<VAR$NUM> = ICONV(':VARNAME:'<VAR$NUM>,"D")'ş            THIS.INC<-1> = '    ':VARNAME:'<VAR$NUM> = OCONV(':VARNAME:'.I<VAR$NUM>,"D4/")'ş          ENDş          THIS.INC<-1> = '  END'ş          THIS.INC<-1> = 'NEXT VAR$X' ş        END ELSEş          THIS.INC<-1> = 'LOCATE "':FROMVAR:'" IN VARS SETTING POS THEN'ş          THIS.INC<-1> = '  ':VARNAME:' = VALS<POS>'ş          THIS.INC<-1> = '  ':VARNAME:'.EXISTS = 1'ş          IF VARTYPE = "date" THENş            THIS.INC<-1> = '  ':VARNAME:'.I = ICONV(':VARNAME:',"D")'ş            THIS.INC<-1> = '  ':VARNAME:' = OCONV(':VARNAME:'.I,"D4/")'ş          ENDş          IF DEFAULT # "" THENş            THIS.INC<-1> = '  IF ':VARNAME:' = "" THEN ':VARNAME:' = "':DEFAULT:'"'ş          ENDş          THIS.INC<-1> = 'END ELSE'ş          THIS.INC<-1> = '  ':VARNAME:'.EXISTS = 0'ş          IF VARTYPE = "date" THENş            THIS.INC<-1> = '  ':VARNAME:'.I = ""'ş          ENDş          IF METHOD = "REQUIRE" AND EXISTS THENş            * Existence of variable is requiredş            THIS.INC<-1> = '  ':VARNAME:' = ""'ş            THIS.INC<-1> = '  VAR$ERR<-1> = "':REQUIRE.ERROR:'"'ş          END ELSEş            THIS.INC<-1> = '  ':VARNAME:' = "':DEFAULT:'"'ş          ENDş          THIS.INC<-1> = 'END'ş          IF METHOD = "REQUIRE" AND NOT(EXISTS) THENş            THIS.INC<-1> = 'IF ':VARNAME:' = "" THEN'ş            THIS.INC<-1> = '  VAR$ERR<-1> = "':REQUIRE.ERROR:'"'ş            THIS.INC<-1> = 'END'ş          ENDş          IF TRIM.VAL THENş            THIS.INC<-1> = VARNAME:" = TRIM(":VARNAME:")"ş          ENDş        ENDş        *ş        IF METHOD = "REQUIRE" THEN REQUIRED = 1 ELSE REQUIRED = 0ş        *ş        VAR.INFO<1,VAR.INFO.POS> = FROMVARş        VAR.INFO<2,VAR.INFO.POS> = REQUIREDş        VAR.INFO<3,VAR.INFO.POS> = VARTYPEş        VAR.INFO<4,VAR.INFO.POS> = ITERATIVEş        VAR.INFO<5,VAR.INFO.POS> = DEFAULTş        VAR.INFO<6,VAR.INFO.POS> = COMMENTş        VAR.INFO<7,VAR.INFO.POS> = EXISTSş        VAR.INFO.POS += 1ş        *ş        XML.INFO<-1> = '<var name="':FROMVAR:'" required="':REQUIRED:'" type="':VARTYPE:'" iterative="':ITERATIVE:'">'ş        CALL XML.ENCODE(DEFAULT,'')ş        CALL XML.ENCODE(COMMENT,'')ş        XML.INFO<-1> = ' <default>':DEFAULT:'</default>'ş        XML.INFO<-1> = ' <comment>':COMMENT:'</comment>'ş        XML.INFO<-1> = '</var>'ş        *ş        INC.SOURCE<-1> = THIS.INCş      ENDş    END ELSEş      LINE = TRIM(LINE)ş      IF LINE = "INCLUDE ":FILE:".INC ":ITEM THEN END.OF.PC = 1ş    ENDş  UNTIL SLINE > SOURCE.LINES OR END.OF.PC DO SLINE += 1 REPEATş  PRINTş  IF PARSED.ANY THENş    XML.INFO<-1> = '</vars>'ş    INC.SOURCE<-1> = "* XML Info"ş    INC.SOURCE<-1> = \XML$INFO = '<?xml version="1.0" ?>'\ş    XICNT = DCOUNT( XML.INFO, @AM )ş    FOR XML.X = 1 TO XICNTş      INC.SOURCE<-1> = 'XML$INFO<-1> = \':XML.INFO<XML.X>:'\'ş    NEXT XML.Xş    INC.SOURCE<-1> = 'IF XML$QUERY THEN'ş    INC.SOURCE<-1> = '  CALL XML.SEND(XML$INFO)'ş    INC.SOURCE<-1> = '  STOP'ş    INC.SOURCE<-1> = 'END'ş    WRITE INC.SOURCE ON INC.FILEVAR, ITEMş    WRITE VAR.INFO ON INC.FILEVAR, "$":ITEMş    *ş    READU FILE.LIST FROM F.MVPC.CONTROL, 'LIBRARIES' ELSE FILE.LIST = ''ş    LOCATE FILE IN FILE.LIST BY 'AL' SETTING POS THENş      RELEASE F.MVPC.CONTROL, 'LIBRARIES'ş    END ELSEş      FILE.LIST = INSERT( FILE.LIST, 1, POS, 0, FILE )ş      WRITE FILE.LIST ON F.MVPC.CONTROL, 'LIBRARIES'ş    ENDş  ENDş  IF PC.ERRORS THENş    PRINT "Compile aborted"ş  END ELSEş    XLINE = "D3.":VERB:" ":FILE:" ":ITEM:" ":OPTSş    PRINT "D3 Compile: ":XLINEş    EXECUTE XLINEş  ENDşNEXT ITEM.XşSTOPş*şPARSE.LINE: * Parse a line into tokensş*şSYNTAX.ERROR = ""şLINE = TRIM(LINE)şLINE = LINE[2,9999] ;* Remove "!"ş*şLINELEN = LEN(LINE)şTOKEN.LIST = '' ; TOKEN.POS = 1şTOKEN = ""şVALUE = ""şGETMODE = "TOKEN" ;* Start looking for tokensşDELIM = ""şIN.DELIM.STRING = 0şPARSED = 0şFOR LX = 1 TO LINELENş  CH = LINE[LX,1]ş  IF GETMODE = "TOKEN" THENş    BEGIN CASEş      CASE CH MATCHES "1A" OR CH MATCHES "1N"ş        TOKEN := CHş      CASE CH = " "ş        * End of word - Token completeş        IF TOKEN # "" THENş          TOKEN.LIST<1,TOKEN.POS> = TOKENş          LOCATE TOKEN IN ONE.WORD.TOKENS SETTING POS ELSEş            GETMODE = "VALUE"ş            VALUE.POS = TOKEN.POSş            IN.DELIM.STRING = 0ş          ENDş          TOKEN.POS += 1ş          TOKEN = ""ş        ENDş    END CASEş  END ELSE IF GETMODE = "VALUE" THENş    BEGIN CASEş      CASE IN.DELIM.STRING AND CH = DELIMş        TOKEN.LIST<2,VALUE.POS> = VALUEş        VALUE = ""ş        DELIM = ""ş        GETMODE = "TOKEN"ş      CASE NOT(IN.DELIM.STRING) AND INDEX(DELIMS,CH,1) ;* This is a delimiterş        IN.DELIM.STRING = 1ş        DELIM = CHş      CASE CH = " " AND NOT(IN.DELIM.STRING)ş        TOKEN.LIST<2,VALUE.POS> = VALUEş        VALUE = ""ş        GETMODE = "TOKEN"ş      CASE 1ş        VALUE := CHş    END CASEş  ENDşNEXT LXşIF TOKEN # "" THENş  TOKEN.LIST<1,-1> = TOKENşEND ELSE IF VALUE # "" THENş  TOKEN.LIST<2,VALUE.POS> = VALUEşENDş*şVARNAME = ""şFROMVAR = ""şCOMMENT = ""şDEFAULT = ""şVARTYPE = "string"şTRIM.VAL = 1şEXISTS = 0şREQUIRE.ERROR = ""ş*şFOR TX = 1 TO DCOUNT( TOKEN.LIST<1>, @VM )ş  TOKEN = TOKEN.LIST<1,TX>ş  VALUE = TOKEN.LIST<2,TX>ş  BEGIN CASEş    CASE TOKEN = "get" OR TOKEN = "require"ş      METHOD = TOKENş      VARNAME = VALUEş      PARSED = 1ş    CASE TOKEN = "from"ş      FROMVAR = VALUEş    CASE TOKEN = "type"ş      VARTYPE = OCONV(VALUE,'MCL')ş    CASE TOKEN = "default"ş      DEFAULT = VALUEş    CASE TOKEN = "comment"ş      COMMENT = VALUEş    CASE TOKEN = "notrim"ş      TRIM.VAL = 0ş    CASE TOKEN = "exists"ş      EXISTS = 1ş    CASE TOKEN = "error"ş      REQUIRE.ERROR = VALUEş    CASE 1ş      SYNTAX.ERROR = "Invalid Token: '":TOKEN:'"'ş  END CASEşNEXT TXş*şIF NOT(PARSED) THEN RETURNş*şIF VARNAME = "" THENş  SYNTAX.ERROR = "No variable specified"ş  RETURNşENDş*şIF FROMVAR = "" THEN FROMVAR = VARNAMEş*şITERATIVE = 0şIF VARNAME[LEN(VARNAME)-1,2] = "[]" THENş  IF FROMVAR[LEN(FROMVAR)-1,2] = "[]" THENş    ITERATIVE = 1ş  END ELSEş    SYNTAX.ERROR = "Iterative array mismatch: ":VARNAME:", ":FROMVARş  ENDşENDş*şRETURN000A64MV.PACKAGE.INSTALLER.DEFAULTSş0c2      * Install packagesşş      * first, get a list of packagesşş      CALL WOBJ(COBJ,"FROMJSON","","{}","",RERR)şş      CALL MVDBTOOLKIT.WPLATFORM(PLATFORM.OBJ)şş      CALL WOBJ(PLATFORM.OBJ,"GET","packagesurl",PACKAGES.URL,"",RERR)şş      IF PACKAGES.URL = "" THENş         PACKAGES.URL="https://raw.githubusercontent.com/zumasys/MVConnect/master/packages.json"ş      ENDşş      CALL WOBJ(PLATFORM.OBJ,"GET","mvtype",MVTYPE,"",RERR)ş      ş      MVTYPE=OCONV(MVTYPE,"MCU")ş      ş      BEGIN CASEş         CASE MVTYPE="D3"; MVTYPE2="d3"ş         CASE MVTYPE="JBASE"; MVTYPE2="jbase"ş         CASE MVTYPE="QM"; MVTYPE2="qm"ş         CASE MVTYPE="UNIVERSE"; MVTYPE2="uv"ş         CASE MVTYPE="UNIDATA"; MVTYPE2="ud"ş         CASE 1ş             PRINT "Platform ":MVTYPE:" not supported"ş             STOPş      END CASEş      ş      CALL WOBJ(PLATFORM.OBJ,"GET","tmpdir",TMP.DIR,"",RERR)ş      ş      CALL WOBJ(PLATFORM.OBJ,"GET","filedelim",FILEDELIM,"",RERR)ş      ş      PRINT "Packages url: ":PACKAGES.URLşş      CALL WOBJ(COBJ,"SET","url",PACKAGES.URL,"",RERR)ş      CALL WOBJ(COBJ,"SET","method","GET","",RERR)şş      CRT "Getting package list...":şş      CALL MVDBTOOLKIT.WCALL(COBJ)şş      *CALL MVDBTOOLKIT.WCALL.DEBUG(COBJ)şşş      CALL WOBJ(COBJ,"GET","response.status",RESPONSE.STATUS,"",RERR)şş      CALL WOBJ(COBJ,"GET","response.statusmsg",RESPONSE.STATUS.MSG,"",RERR)ş      CALL WOBJ(COBJ,"GET","response.data",RESPONSE.DATA,"",RERR)şş      PRINT RESPONSE.STATUS:' ':RESPONSE.STATUS.MSGşş      CALL WOBJ(POBJ,"FROMJSON","",RESPONSE.DATA,"",RERR)şş      IF RERR>0 THENş         PRINT RERR<1>:" Error: ":RERR<2>ş         STOPş      ENDşş      CALL WOBJ(POBJ,"LENGTH","packages",NUMBER.PACKAGES,"",RERR)şş      PRINT "Number packages: ":NUMBER.PACKAGESşştop.of.packages: *şş      PACKAGES=""ş      ş      FOR P=1 TO NUMBER.PACKAGESşş         CALL WOBJ(POBJ,"GET","packages[":P-1:"].name",PACKAGE.NAME,"",RERR)ş         CALL WOBJ(POBJ,"GET","packages[":P-1:"].version",PACKAGE.VERSION,"",RERR)ş         CALL WOBJ(POBJ,"GET","packages[":P-1:"].default",PACKAGE.DEFAULT,"",RERR)şş         PRINT P"MR(#4)":ş         PRINT " ":ş         PRINT PACKAGE.NAME:ş         PACKAGES<P>=PACKAGE.NAMEş         ş         PRINT " ":ş         PRINT PACKAGE.VERSION:ş         PRINT " ":ş         PRINT PACKAGE.DEFAULTş         ş         IF OCONV(PACKAGE.DEFAULT,"MCU")="YES" THENş              GOSUB process.packageş         ENDş         ş      NEXT PşşSTOPşşprocess.package: *şş      COBJ=""ş      CALL WOBJ(COBJ,"FROMSTRING","","{}","",RERR)ş      ş      CALL MVDB.PACKAGE.INSTALLER.SUB(PACKAGE.NAME,RESULT)ş      ş      şRETURNşşş0062C4MVDB.WEB.EDş0c2*ş* Copyright (C) 2009 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Luke Bucklin, Sierra Bravoş* Date: August 6, 2009ş* Description: Web Editor for Bravo Dashboardş*ş* 3-9-15 TFP CHANGE FILENAME TO FILENAME.VAR TO PREVENT CONFLICT WITH filenameş*ş* Modified by Peter Schellenbach of Zumasys 07-17-15 for UV compatiblity:ş*   Change U50BB to @WHOş*   Change MDS to UV.ACCOUNTş*   Change LOGTO syntax for QMş*   Parse file path in catalog pointer to find subroutine source fileş*ş* Modified by Peter Schellenbach of Zumasys 11-02-16ş*  Added GLOBAL.INFO(100) = 1 before each of the STOP statements (except STOP due to errors)ş*  to indicate successful execution of this routine. Otherwise the controller programş*  (MVDB.INIT) thinks an error has occurred and appends some debug info to the HTML output.ş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEşINCLUDE WBPD FI.MVDB.WIDGET.TYPESş*ş**OPEN '','WEB.FORMS' TO F.WEB.FORMS ELSE STOP 201, 'WEB.FORMS' ;* this is in /WWW/ COMMON and is opened by MVDB.INITşOPEN '','MV.WEB.ED.ARCHIVE' TO F.ED.ARCHIVE THENş  ARCHIVE = 1şEND ELSE ARCHIVE = 0şOPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSE STOP 201, 'MVDB.CONTROL'şREAD ACCTS FROM F.MVDB.CONTROL, "ED.ACCOUNTS" ELSE ACCTS = ""ş*şDIM SITE$SETTINGS(100)şEQU SITE$AUTH.SUB     TO SITE$SETTINGS(1)şEQU SITE$NULL.PW.OK   TO SITE$SETTINGS(2)şEQU SITE$W.MAX.DUR    TO SITE$SETTINGS(3)şEQU SITE$TCP.PORT     TO SITE$SETTINGS(4)şEQU SITE$ALT.LOGO     TO SITE$SETTINGS(7)şEQU SITE$CHARSET      TO SITE$SETTINGS(9)ş*şMATREAD SITE$SETTINGS FROM F.MVDB.CONTROL, "MVDB.SETTINGS" ELSE MAT SITE$SETTINGS = ""şIF SITE$ALT.LOGO = '' THENş  SITE.LOGO = '/db/images/mv-logo.png'şEND ELSEş  SITE.LOGO = SITE$ALT.LOGOş  IF NOT(INDEX(SITE.LOGO,'/',1)) THENş    SITE.LOGO = '/db/images/':SITE.LOGOş  ENDşENDşIF SITE$CHARSET = '' THEN SITE$CHARSET = 'UTF-8'ş*şCALL GET.SESSION.VAR("adminauth",adminauth)şIF adminauth # 1 THENş  FORM = '<html><head><meta http-equiv="Refresh" content="0; url=/dbc/MVDB.MAIN" />'ş  FORM := '</head><body><p>Administrative priviledges are required. 'ş  FORM:= 'Please <a href="/dbc/MVDB.MAIN">log in</a>.</p></body></html>'ş  CALL WEB.SEND(FORM)ş  GLOBAL.INFO(100) = 1 ;* Intentional stopş  STOPş*  READ LOGIN.PAGE FROM F.WEB.FORMS, "admin_login.html" ELSE LOGIN.PAGE = "admin_login.html not found."ş*  CALL SWAP(LOGIN.PAGE,'<!-- SITE_LOGO -->',SITE.LOGO)  ş*  GLOBAL.INFO(100) = 1 ;* Intentional stopş*  CALL WEB.SEND(LOGIN.PAGE)ş*  STOPşENDş*şEDIT.SCRIPTS = "NEW_PROGRAM_DIALOG = 0;":CHAR(10) ;* This will get overwritten later, if appropriateşESC.APOS = "\'"şHMESSAGE = ""şFMESSAGE = ""şrecord = ""şLOCATE "ed_file" IN CGI$VARS SETTING POS THENş  filename = CGI$VALS<POS>şEND ELSEş  filename = ""ş  HMESSAGE<-1> = "No filename specified."şENDşLOCATE "ed_item" IN CGI$VARS SETTING POS THENş  item = CGI$VALS<POS>şEND ELSEş  item = ""ş  HMESSAGE<-1> = "No item name specified."şENDşLOCATE "ed_acct" IN CGI$VARS SETTING POS THENş  acct = CGI$VALS<POS>şEND ELSE acct = ""ş*şLOCATE "action" IN CGI$VARS SETTING POS THENş  action = CGI$VALS<POS>şEND ELSE action = "open"şIF action = "code_template" THENş  LOCATE "template" IN CGI$VARS SETTING POS THENş    template = CGI$VALS<POS>ş  END ELSE template = ""ş  OPEN '','MVDB.SUB.TEMPLATES' TO F.MVDB.SUB.TEMPLATES THENş    orig.template = templateş    LOOPş      READ TEMPLATE.TEXT FROM F.MVDB.SUB.TEMPLATES, template ELSE TEMPLATE.TEXT = ""ş      IF TEMPLATE.TEXT = "" THEN TEMPLATE.TEXT = "No template for ":templateş    WHILE FIELD( TEMPLATE.TEXT, ' ', 1 ) = "USE" DOş      template = FIELD( TEMPLATE.TEXT, ' ', 2 )ş    REPEATş    CALL SWAP(TEMPLATE.TEXT,'W$TYPE = "%TYPE%"','W$TYPE = "':orig.template:'"')ş  END ELSEş    TEMPLATE.TEXT = "Unable to open MVDB.SUB.TEMPLATES"ş  ENDş  SESSION$CONTENT.SENT = 1ş  CRT "Content-Type: text/html"ş  CRTş  CALL WEB.SEND(TEMPLATE.TEXT)ş  GLOBAL.INFO(100) = 1 ;* Intentional stopş  STOPşENDşLOCATE "record" IN CGI$VARS SETTING POS THENş  record = CGI$VALS<POS>ş  CONVERT CHAR(10) TO @AM IN recordş  CONVERT CHAR(13) TO "" IN recordşENDşIF action = "compile" OR action = "save" THENş  READ HTML FROM F.WEB.FORMS, "ed_output.html" ELSE HTML = "Unable to read ed_output.html"ş  QUIET.MODE = 1şEND ELSEş  READ HTML FROM F.WEB.FORMS, "ed_template.html" ELSE HTML = "Unable to read ed_template.html"ş  QUIET.MODE = 0şENDşCALL SWAP(HTML,'<!--CHARACTER_SET-->',SITE$CHARSET)şLOCATE "height" IN CGI$VARS SETTING POS THENş  height = CGI$VALS<POS>ş  CALL PUT.SESSION.VAR("ed_height",height)şEND ELSEş  CALL GET.SESSION.VAR("ed_height",height)şENDşOUT.OF.ACCOUNT = 0şmyacct = @WHO ; * OCONV( 'a', 'U50BB') *PJS 07-17-15*şIF acct = myacct THEN acct = ""şIF acct # "" AND HMESSAGE = "" THENş  password = ""ş  OPEN '','UV.ACCOUNT' TO F.ACCOUNTS THENş    READ APTR FROM F.ACCOUNTS, acct ELSE APTR = ""ş    IF APTR<1> <> "" THENş*      IF APTR<7> # "" THEN ;* This account has a passwordş*        LOCATE acct IN ACCTS<1> SETTING APOS THENş*          password = ACCTS<2,APOS>ş*        END ELSEş*          HMESSAGE<-1> = "Account ":acct:" requies a password. Not found in MVDB.CONTROL, ED.ACCOUNTS"ş*        ENDş*      ENDş    END ELSEş      HMESSAGE<-1> = "Account ":acct:" is not valid."ş    ENDş  END ELSEş    HMESSAGE<-1> = "Unable to open UV.ACCOUNT file."ş  ENDş  IF HMESSAGE = "" THENş*    DATA passwordş    EXECUTE "LOGTO ":acct CAPTURING LOGTO.OUT ;* Switch over to specified accountş    IF LOGTO.OUT = "" THENş      OUT.OF.ACCOUNT = 1ş    END ELSEş      HMESSAGE<-1> = "Error: ":LOGTO.OUTş    ENDş  ENDşENDşIF HMESSAGE # "" THENş  IF filename = "" AND item = "" THENş    HMESSAGE = ""ş    CALL SWAP(HTML,'<!-- SYNTAX -->',"")ş    CALL SWAP(HTML,'<!-- WINDOW_HEIGHT -->',"")ş    CALL SWAP(HTML,'<!-- FILE -->',"")ş    CALL SWAP(HTML,'<!-- ITEM -->',"")ş    CALL SWAP(HTML,'<!-- BODY -->',"")ş    CALL SWAP(HTML,'<!-- LAST_COMPILE -->',"")ş    CALL SWAP(HTML,'<!-- COMPILE_OUTPUT -->',"")ş    CALL SWAP(HTML,'<!-- COMPILE_ERRLINE -->',"")ş    CALL SWAP(HTML,'<!-- ED_CONTENT -->',"''")ş    CALL SWAP(HTML,'<!-- EA_CALLS_CONTENT -->',"")ş    CALL SWAP(HTML,'<!-- EA_INCLUDES_CONTENT -->',"")ş    CALL SWAP(HTML,'<!-- EA_FILES_CONTENT -->',"")ş    CALL SWAP(HTML,'<!-- EA_ARCHIVE_CONTENT -->',"")ş    CALL SWAP(HTML,'<!-- NUM_OF_CALLS -->',0)ş    CALL SWAP(HTML,'<!-- NUM_OF_INCLUDES -->',0)ş    CALL SWAP(HTML,'<!-- NUM_OF_FILES -->',0)ş    CALL SWAP(HTML,'<!-- NUM_OF_ARCHIVES -->',0)ş    CALL SWAP(HTML,'<!-- ED_SCRIPTS -->',"")ş    CALL SWAP(HTML,'<!-- ED_INIT_SCRIPT -->',"openEditDialog();")ş    CALL WEB.SEND(HTML)ş  END ELSEş    GOSUB ADD.MESSAGEş    CALL WEB.SEND(HTML)ş  ENDş  GLOBAL.INFO(100) = 1 ;* Intentional stopş  STOPşENDş* This will be the master dictionary in the appropriate account.şOPEN '','MD' TO F.MD ELSEş  OPEN '','VOC' TO F.MD ELSE STOP 201, 'MD OR VOC'şENDşBASIC.SUB = 0şOPEN filename TO F.FILE THENş  IF record # "" AND action # "open" THENş    ELINE = DCOUNT( record, @AM )ş    LOOP WHILE ELINE > 1 AND record<ELINE> = "" DOş      record = DELETE( record, ELINE, 0, 0 )ş      ELINE -= 1ş    REPEATş    IF ARCHIVE AND filename # "MV.WEB.ED.ARCHIVE" THENş      READ oldrec FROM F.FILE, item THENş        IF oldrec # record THENş          NOW = TIME()ş          TD.STAMP = NOW:"*":DATE()ş          NOW2 = NOW "R%2"ş          NOW2 = MOD(NOW2,16) ;* Get it down to a hex digitş          IF acct = "" THEN USE.ACCT = myacct ELSE USE.ACCT = acctş          ARCHIVE.ID = USE.ACCT:"*":filename:"*":item:"*":OCONV(NOW2,'MCDX')ş          oldrec = INSERT( oldrec, 1, 0, 0, TD.STAMP )ş          WRITE oldrec ON F.ED.ARCHIVE, ARCHIVE.IDş        ENDş      ENDş    ENDş    WRITE record ON F.FILE, itemş    IF record[1,3] = "SUB" THEN BASIC.SUB = 1ş    IF QUIET.MODE THENş      record = ""ş    END ELSEş      HMESSAGE<-1> = item:" saved, ":LEN(record):" bytes."ş    ENDş  END ELSEş    READ record FROM F.FILE, item THENş      HMESSAGE<-1> = item:" opened, ":LEN(record):" bytes."ş    END ELSEş      record = ""ş      HMESSAGE<-1> = "New Item: ":itemş    ENDş    IF record = "" THENş      NEW.ITEM.FLAG = 1ş      BEGIN CASEş        CASE filename = "RSS.BP"ş          record = 'SUBROUTINE ':itemş          record<-1> = '*'ş          record<-1> = '* RSS Feed'ş          record<-1> = '*'ş          record<-1> = 'INCLUDE RSS.BP RSS.DATA.INC'ş          record<-1> = '*'ş          IF INDEX(item,'.SEL',1) THENş            record<-1> = '* EXECUTE SELECT - Create active select list'ş            record<-1> = 'RETURN'ş          END ELSE IF INDEX(item,'.ITEM',1) THENş            record<-1> = 'RSS$TITLE = "" ;* Title text'ş            record<-1> = 'RSS$LINK = "" ;* Link to URL for full-view (if applicable)'ş            record<-1> = 'RSS$AUTHOR = "" ;* Author'ş            record<-1> = 'RSS$DATE = "" ;* Date of feed item (internal)'ş            record<-1> = 'RSS$TIME = "" ;* Time of feed item (internal)'ş            record<-1> = 'RSS$DESCRIPTION = "" ;* Feed description text (HTML)'ş            record<-1> = '*'ş            record<-1> = '* Programming to fill in the above values goes here.'ş            record<-1> = '*'ş            record<-1> = 'RETURN'ş          ENDş        CASE filename = 'MVDB.SUBS'ş          EDIT.SCRIPTS = "NEW_PROGRAM_DIALOG = 1;":CHAR(10)ş          EDIT.SCRIPTS := 'widgetTypes = new Array();':CHAR(10)ş          OPEN '','MVDB.WIDGET.TYPES' TO F.MVDB.WIDGET.TYPES THENş            EXECUTE 'SSELECT MVDB.WIDGET.TYPES BY GROUP BY HANDLER WITH INACTIVE # "1"' CAPTURING JUNKş            LOOPş              READNEXT TYPE.ID ELSE EXITş              MATREAD WIDGET.TYPES FROM F.MVDB.WIDGET.TYPES, TYPE.ID THENş                CALL SWAP(WT$DESC,'"','\"')ş                CLASS.NAME = FIELD(WT$ICON,'.',1)ş                CONVERT "_" TO "-" IN CLASS.NAMEş                EDIT.SCRIPTS := 'widgetTypes["':TYPE.ID:'"] = new Array("':WT$DESC:'","':CLASS.NAME:'");':CHAR(10)ş              ENDş            REPEATş          ENDş          record = 'SUBROUTINE ':itemş          record<-1> = '*'ş          record<-1> = '* Dashboard Widget'ş          record<-1> = '*'ş          record<-1> = 'INCLUDE WBPD MVDB.INCLUDE'ş          record<-1> = '*'ş        CASE 1 ; NULLş      END CASEş    ENDş  ENDşEND ELSEş  HMESSAGE<-1> = "Unable to open file '":filename:"'"ş  GOSUB ADD.MESSAGEş  CALL WEB.SEND(HTML)ş  GLOBAL.INFO(100) = 1 ;* Intentional stopş  STOPşENDş*şOUTPUT = "" ;* Compiler outputşCOMP.ERRLINE = ""şBEGIN CASEş  CASE HMESSAGE # "" ; NULLş  CASE action = "compile"ş    READV BASIC.TEMPLATE FROM F.MVDB.CONTROL, "COMPILE.SETUP", 1 ELSE BASIC.TEMPLATE = ""ş    IF BASIC.TEMPLATE # "" THENş      CMD = BASIC.TEMPLATEş      CALL SWAP(CMD,"%FILENAME%",filename)ş      CALL SWAP(CMD,"%ITEMNAME%",item)ş    END ELSEş      CMD = "BASIC ":filename:" ":itemş    ENDş    EXECUTE CMD CAPTURING CMPOUTPUTş    OUTPUT<-1> = CMDş    OUTPUT<-1> = CMPOUTPUTş    * If the compile failed, find the first error line #ş    CO = 1ş    LOOP UNTIL CO > DCOUNT( CMPOUTPUT, @AM ) DOş      LN = FIELD(TRIM(CMPOUTPUT<CO>),' ',1)ş      IF LN MATCHES "4N" THENş        COMP.ERRLINE = (LN+0)ş        EXITş      END ELSE CO += 1ş    REPEATş    IF BASIC.SUB = 1 THENş      CMD = "CATALOG ":filename:" ":itemş      EXECUTE CMD CAPTURING CATOUTPUTş      OUTPUT<-1> = CMDş      OUTPUT<-1> = CATOUTPUTş    ENDş  CASE action = "save"ş  CASE 1ş    NULLşEND CASEş*şSUBLIST = ''şINCLIST = ''şFILELIST = ''şIF record # "" THENş  GOSUB BUILD.SUBLISTş  GOSUB BUILD.INCLISTş  GOSUB BUILD.FILELISTşENDşIF filename = "WEB.FORMS" THEN SYNTAX = "html" ELSE SYNTAX = "basic"ş*ş* Last compile date/time?ş*şCSTRING = ""şIF SYNTAX = "basic" THENş  EXECUTE "SELECT DICT ":filename:" '":item:"' C/DATE C/TIME" CAPTURING JUNKş  READNEXT CDATE ELSE CDATE = ""ş  READNEXT CTIME ELSE CTIME = ""ş  CLEARSELECTş  IF CDATE MATCHES "1N0N" AND CTIME MATCHES "1N0N" THENş    CDATE = OCONV(CDATE, 'D2/')ş    CTIME = OCONV(CTIME, 'MTS')ş    CSTRING = "Last compiled on ":CDATE:" at ":CTIME:'<br />'ş  ENDşENDşIF OUT.OF.ACCOUNT THENş  LOCATE myacct IN ACCTS<1> SETTING APOS THENş    password = ACCTS<2,APOS>ş  END ELSE password = ""ş*  DATA passwordş  EXECUTE "LOGTO ":myacct CAPTURING LOGTO.OUTş  IF LOGTO.OUT # "" THENş    * Fatal error - cannot get back to our account. Send crapy CGI error.ş    PRINT "Content-type: text/html"ş    PRINTş    PRINT "<html><body>Error returning to ":myacct:", ":LOGTO.OUTş    PRINT "Check MVDB.CONTROL, ED.ACCOUNTS settings.</body></html>"ş    GLOBAL.INFO(100) = 1 ;* Intentional stopş    STOPş  ENDş  * Re-open the master dictionary in the local account.ş  OPEN '','MD' TO F.MD ELSEş    OPEN '','VOC' TO F.MD ELSE STOP 201, 'MD OR VOC'ş  ENDşENDşIF OUTPUT # "" THENş  CALL SWAP(OUTPUT,'&','&amp;')ş  CALL SWAP(OUTPUT,'<','&lt;')ş  CALL SWAP(OUTPUT,'>','&gt;')şENDşGOSUB ADD.MESSAGEşIF record # "" THENş  CALL SWAP(record,'&','&amp;')ş  CALL SWAP(record,'<','&lt;')ş  CALL SWAP(record,'>','&gt;')şENDşIF action = "compile" THENş  CALL SWAP(OUTPUT,@AM,"<br>")şENDşIF QUIET.MODE THENş  FORM = ""şEND ELSEş  FORM = '<form id="ed_form" method="post" action="':CGI$PATH:'/MVDB.WEB.ED" >'ş  FORM<-1> = '<textarea id="file_1" style="height: 100%; width: 100%;" name="record">'ş  FORM<-1> = recordş  FORM<-1> = '</textarea>'ş  IF acct = "" THEN USE.ACCT = myacct ELSE USE.ACCT = acctş  FORM<-1> = '<input type="hidden" name="ed_acct" value = "':USE.ACCT:'" />'ş  FORM<-1> = '<input type="hidden" name="ed_file" value="':filename:'" />'ş  FORM<-1> = '<input type="hidden" name="ed_item" value="':item:'" />'ş  FORM<-1> = '<input type="hidden" name="action" value="" />'ş  FORM<-1> = '</form>'şENDşCALL SWAP(HTML,'<!-- SYNTAX -->',SYNTAX)şCALL SWAP(HTML,'<!-- WINDOW_HEIGHT -->',height)şCALL SWAP(HTML,'<!-- FILE -->',filename)şCALL SWAP(HTML,'<!-- ITEM -->',item)şCALL SWAP(HTML,'<!-- BODY -->',FORM)şCALL SWAP(HTML,'<!-- LAST_COMPILE -->',CSTRING)şCALL SWAP(HTML,'<!-- COMPILE_OUTPUT -->',OUTPUT)şCALL SWAP(HTML,'<!-- COMPILE_ERRLINE -->',COMP.ERRLINE)şCALL SWAP(HTML,'<!-- ED_CONTENT -->',record)ş*şSUB.CNT = DCOUNT( SUBLIST<1>, @VM )şINC.CNT = DCOUNT( INCLIST<1>, @VM )şFILE.CNT = DCOUNT( FILELIST<1>, @VM )şIF SUB.CNT > INC.CNT THEN MAX.CNT = SUB.CNT ELSE MAX.CNT = INC.CNTşIF FILE.CNT > MAX.CNT THEN MAX.CNT = FILE.CNTş*şIF acct # "" THENş  URL.ACCT = acctş  CALL SUB.URL.ENCODE(URL.ACCT)ş  ACCT.LINK = "ed_acct=":URL.ACCT:"&"şEND ELSE ACCT.LINK = ""ş*şIF SUB.CNT THENş  EA.CALLS ='<table width="100%"><tbody><tr><th>File</th><th>Program</th><th>Line(s)</th></tr>'şEND ELSE EA.CALLS = ""şIF INC.CNT THENş  EA.INCS ='<table width="100%"><tbody><tr><th>File</th><th>Program</th><th>Line(s)</th></tr>'şEND ELSE EA.INCS = ""şIF FILE.CNT THENş  EA.FILES = '<table width="100%"><tbody><tr><th>File</th><th>Operation</th><th>Line(s)</th></tr>'şEND ELSE EA.FILES = ""şFOR LX = 1 TO MAX.CNTş  IF LX <= SUB.CNT THENş    URL.SUBFILE = SUBLIST<1,LX>ş    CALL SUB.URL.ENCODE(URL.SUBFILE)ş    URL.SUBITEM = SUBLIST<2,LX>ş    CALL SUB.URL.ENCODE(URL.SUBITEM)ş    PROGFNAME = SUBLIST<1,LX>ş    PROGNAME = SUBLIST<2,LX>ş    CALL SWAP(PROGNAME,"'","\'")ş    CALL SWAP(PROGFNAME,"'","\'")ş    IF SUBLIST<2,LX>[1,1] = "@" THEN ;* This is a CALL @ function, so no link to open the subroutineş      EA.CALLS := '<tr><td>':PROGFNAME:'</td><td>':PROGNAME:'</a></td>'ş    END ELSEş      EA.CALLS := '<tr><td>':PROGFNAME:'</td><td><a target="':URL.SUBFILE:'_':URL.SUBITEM:'" href="/dbc/MVDB.WEB.ED?':ACCT.LINK:'ed_file=':URL.SUBFILE:'&ed_item=':URL.SUBITEM:'">':PROGNAME:'</a></td>'ş    ENDş    EA.CALLS := '</td><td>'ş    CL.CNT = DCOUNT( SUBLIST<4,LX>, @SVM )ş    FOR LXL = 1 TO CL.CNTş      EA.CALLS := '<a href="#" onclick="javascript:editArea.go_to_line(':ESC.APOS:SUBLIST<4,LX,LXL>:ESC.APOS:'); return false;">':SUBLIST<4,LX,LXL>:'</a>'ş      IF LXL < CL.CNT THEN EA.CALLS := ", "ş    NEXT LXLş  ENDş  IF LX <= INC.CNT THENş    URL.INCFILE = INCLIST<1,LX>ş    CALL SUB.URL.ENCODE(URL.INCFILE)ş    URL.INCITEM = INCLIST<2,LX>ş    CALL SUB.URL.ENCODE(URL.INCITEM)ş    INCFNAME = INCLIST<1,LX>ş    INCNAME = INCLIST<2,LX>ş    CALL SWAP(INCNAME,"'","\'")ş    CALL SWAP(INCFNAME,"'","\'")ş    EA.INCS := '<tr><td>':INCFNAME:'</td><td><a target="':URL.INCFILE:'_':URL.INCITEM:'" href="/dbc/MVDB.WEB.ED?':ACCT.LINK:'ed_file=':URL.INCFILE:'&ed_item=':URL.INCITEM:'">':INCNAME:'</a>'ş    EA.INCS := '</td><td>'ş    IN.CNT = DCOUNT( INCLIST<4,LX>, @SVM )ş    FOR LXL = 1 TO IN.CNTş      EA.INCS := '<a href="#" onclick="javascript:editArea.go_to_line(':ESC.APOS:INCLIST<4,LX,LXL>:ESC.APOS:'); return false;">':INCLIST<4,LX,LXL>:'</a> 'ş      IF LXL < IN.CNT THEN EA.INCS := ", "ş    NEXT LXLş  ENDş  IF LX <= FILE.CNT THENş    FOR FOPX = 1 TO DCOUNT( FILELIST<3,LX>, @SVM )ş      IF FOPX = 1 THEN SHOW.FILENAME = FILELIST<1,LX> ELSE SHOW.FILENAME = '&nbsp;'ş      EA.FILES := '<tr><td>':SHOW.FILENAME:'</td><td>':FILELIST<3,LX,FOPX>ş      EA.FILES := '</td><td>'ş      IN.CNT = DCOUNT( FILELIST<5,LX,FOPX>, "," )ş      FOR LXL = 1 TO IN.CNTş        LNO = FIELD( FILELIST<5,LX,FOPX>,',',LXL)ş        EA.FILES := '<a href="#" onclick="javascript:editArea.go_to_line(':ESC.APOS:LNO:ESC.APOS:'); return false;">':LNO:'</a>'ş        IF LXL < IN.CNT THEN EA.FILES := ", "ş      NEXT LXLş      EA.FILES := '</td></tr>'ş    NEXT FOPXş  ENDşNEXT LXşIF SUB.CNT THENş  EA.CALLS := '</td></tr></tbody></table>'şENDşIF INC.CNT THENş  EA.INCS := '</td></tr></tbody></table>'şENDşIF FILE.CNT THENş  EA.FILES := '</tbody></table>'şENDş*şARC.LIST = ""şARC.CNT = 0şIF ARCHIVE THENş  * Archiving is enabled. Find a list of archived copies of this fileş  IF acct = "" THEN USE.ACCT = myacct ELSE USE.ACCT = acctş  CMD = 'SSELECT MV.WEB.ED.ARCHIVE WITH ACCT = "':USE.ACCT:'" AND WITH FILE.NAME = "':filename:'" AND WITH ITEM = "':item:'" BY-DSND DATE BY-DSND TIME'ş  EXECUTE CMD CAPTURING JUNKş  IF SYSTEM(11) THENş    ARC.LIST = '<table width="100%"><tbody><tr><th>Date</th><th>Time</th><th>Open</th></tr>'ş    ARC.CNT = SYSTEM(11)ş    LOOPş      READNEXT AID ELSE EXITş      READV DT.STAMP FROM F.ED.ARCHIVE, AID, 1 ELSE DT.STAMP = ""ş      ARC.LIST := '<tr><td>':OCONV(FIELD(DT.STAMP,'*',2),'D2/'):'</td><td>':OCONV(FIELD(DT.STAMP,'*',1),'MTS'):'</td><td>'ş      URL.AID = AIDş      CALL SUB.URL.ENCODE(URL.AID)ş      ARC.LIST := '<a href="/dbc/MVDB.WEB.ED?ed_acct=MVDB&ed_file=MV.WEB.ED.ARCHIVE&ed_item=':URL.AID:'" target="MVDB_MV.WEB.ED.ARCHIVE_':URL.AID:'">Open</a>'ş      ARC.LIST := '</td></tr>'ş    REPEATş    ARC.LIST := '</tbody></table>'ş  ENDşENDş*şCALL SWAP(HTML,'<!-- EA_CALLS_CONTENT -->',EA.CALLS)şCALL SWAP(HTML,'<!-- EA_INCLUDES_CONTENT -->',EA.INCS)şCALL SWAP(HTML,'<!-- EA_FILES_CONTENT -->',EA.FILES)şCALL SWAP(HTML,'<!-- EA_ARCHIVE_CONTENT -->',ARC.LIST)şCALL SWAP(HTML,'<!-- NUM_OF_CALLS -->',SUB.CNT)şCALL SWAP(HTML,'<!-- NUM_OF_INCLUDES -->',INC.CNT)şCALL SWAP(HTML,'<!-- NUM_OF_FILES -->',FILE.CNT)şCALL SWAP(HTML,'<!-- NUM_OF_ARCHIVES -->',ARC.CNT)şCALL SWAP(HTML,'<!-- ED_SCRIPTS -->',EDIT.SCRIPTS)şCALL WEB.SEND(HTML)şGLOBAL.INFO(100) = 1 ;* Intentional stopşSTOPş*şADD.MESSAGE: *ş*şCALL SWAP(HTML,'<!-- HEADER -->',HMESSAGE)şCALL SWAP(HTML,'<!-- FOOTER -->',FMESSAGE)şRETURNş*şBUILD.SUBLIST: * Build a list of subroutines called by this programş*şIDX.POS = 1şLPOS = 1şLOOPş  POS = INDEX( record, "CALL ", IDX.POS )şWHILE POS DOş  LINE.NUM = DCOUNT(record[1,POS+1],@AM)ş  LINE = TRIM(record<LINE.NUM>)ş  IF LINE[1,1] # "*" AND LINE[1,1] # "!" THENş    CALL.POS = INDEX( LINE, 'CALL ', 1 )ş    QCPOS = CALL.POSş    GOSUB QUOTE.CHECK ;* Make sure the "CALL " is not in a quoteş    SKIP.LINE = 0ş    IF IN.QUOTE THEN SKIP.LINE = 1 ELSEş      MID.CMNT.POS = INDEX(LINE,';*',1)ş      IF MID.CMNT.POS AND MID.CMNT.POS < CALL.POS THENş        * Is the mid-line comment within a quote?ş        QCPOS = MID.CMNT.POSş        GOSUB QUOTE.CHECKş        IF NOT(IN.QUOTE) THEN SKIP.LINE = 1ş      ENDş    ENDş    IF SKIP.LINE THEN ;* This is happening inside a literal string, ignore it.ş      IDX.POS += 1ş      CONTINUEş    ENDş    TEMP.STR = LINE[1,CALL.POS]ş    SUBNAME = LINE[CALL.POS+5,999]ş    IF INDEX( SUBNAME,'(',1) THENş      SUBNAME = FIELD( SUBNAME, '(', 1 )ş    END ELSE SUBNAME = FIELD(SUBNAME,' ',1)ş    SUBNAME = TRIM(SUBNAME)ş    *ş    READ CATPTR FROM F.MD, SUBNAME ELSE CATPTR = ""ş    IF CATPTR # "" THENş      *PJS 07-17-15 BEGIN UV*ş      *SUBFILE = FIELD( CATPTR<4>, ' ', 1 )ş      SUBFILE=filenameş      IF SYSTEM(91) THEN DS = '\' ELSE DS = '/'ş      NDS = DCOUNT(CATPTR<2>, DS)ş      IF NDS >= 2 THENş        SUBPATH = FIELD(CATPTR<2>,DS,NDS-1)ş        IF SUBPATH[LEN(SUBPATH)-1,2]='.O' THEN SUBFILE=SUBPATH[1,LEN(SUBPATH)-2]ş      ENDş      *PJS 07-17-15 END UV*ş    END ELSE SUBFILE = filename    ş    UKEY = SUBFILE:"*":SUBNAMEş    LOCATE UKEY IN SUBLIST<3> SETTING FOUND.POS THENş      SUBLIST<4,FOUND.POS,-1> = LINE.NUMş    END ELSEş      SUBLIST<1,LPOS> = SUBFILEş      SUBLIST<2,LPOS> = SUBNAMEş      SUBLIST<3,LPOS> = UKEYş      SUBLIST<4,LPOS> = LINE.NUMş      LPOS += 1ş    ENDş  ENDş  IDX.POS += 1şREPEATşRETURNş*şBUILD.INCLIST: * Build a list of include items used by this programş*şIDX.POS = 1şLPOS = 1şLOOPş  POS = INDEX( record, "INCLUDE ", IDX.POS )şWHILE POS DOş  LINE.NUM = DCOUNT(record[1,POS+1],@AM)ş  LINE = TRIM(record<LINE.NUM>)ş  SEMI.POS = INDEX( LINE, ';', 1 )ş  IF SEMI.POS THEN LINE = LINE[1,SEMI.POS-1]ş  IF TRIM(LINE[1,8]) = "INCLUDE" THENş    INC.POS = INDEX( LINE, 'INCLUDE ', 1 )ş    QCPOS = INC.POSş    GOSUB QUOTE.CHECKş    IF IN.QUOTE THEN ;* This is happening inside a literal string, ignore it.ş      IDX.POS += 1ş      CONTINUEş    ENDş    INCPARAM = LINE[INC.POS+8,999]ş    INCFILE = FIELD( INCPARAM, ' ', 1 )ş    INCITEM = FIELD( INCPARAM, ' ', 2 )ş    IF INCITEM = '' THENş      INCITEM = INCFILEş      INCFILE = filenameş    ENDş    UKEY = INCFILE:"*":INCITEMş    LOCATE UKEY IN INCLIST<3> SETTING FOUND.POS THENş      INCLIST<4,FOUND.POS,-1> = LINE.NUMş    END ELSEş      INCLIST<1,LPOS> = INCFILEş      INCLIST<2,LPOS> = INCITEMş      INCLIST<3,LPOS> = UKEYş      INCLIST<4,LPOS> = LINE.NUMş      LPOS += 1ş    ENDş  ENDş  IDX.POS += 1şREPEATşRETURNş*şBUILD.FILELIST: * Build a list of files used by this programş*şIDX.POS = 1şLPOS = 1şLOOPş  POS = INDEX( record, "OPEN ",IDX.POS )şWHILE POS DOş  LINE.NUM = DCOUNT(record[1,POS+1],@AM)ş  LINE = TRIM(record<LINE.NUM>)ş  IF LINE[1,1] # "*" AND LINE[1,1] # "!" THENş    OPOS = INDEX( LINE, 'OPEN ', 1 )ş    QCPOS = OPOSş    GOSUB QUOTE.CHECK ;* Make sure this doesn't appear inside a literal stringş    IF IN.QUOTE THENş      IDX.POS += 1ş      CONTINUEş    ENDş    CONVERT "'" TO '"' IN LINE ;* Standaraize the quote characterş    CONVERT "\" TO '"' IN LINEş    * An open statement may look like this: OPEN "","FILENAME"  - Get rid of the "", if it existsş    DPOS = INDEX( LINE, '"",', 1 )ş    IF DPOS THENş      LINE = LINE[1,DPOS-1]:LINE[DPOS+3,999]ş    ENDş    OPARAM = LINE[OPOS+5,999]ş    TPOS = INDEX( OPARAM, ' TO ', 1 )ş    IF NOT(TPOS) THENş      IDX.POS += 1ş      CONTINUE ;* Must not be an open statement.ş    ENDş    FILEVAR = OPARAM[TPOS+4,999]ş    FILEVAR = FIELD( TRIM( FILEVAR ), ' ', 1 )ş    OPARAM = OPARAM[1,TPOS]ş*3-9-15*    FILENAME = TRIM(OPARAM)ş*3-9-15*    IF FILENAME[1,1] = '"' THEN FILENAME = FIELD(FILENAME,'"',2)ş*3-9-15*    UKEY = FILENAME:"*":FILEVARş    FILENAME.VAR = TRIM(OPARAM); *3-9-15*ş    IF FILENAME.VAR[1,1] = '"' THEN FILENAME.VAR = FIELD(FILENAME.VAR,'"',2); *3-9-15*ş    UKEY = FILENAME.VAR:"*":FILEVAR; *3-9-15*ş    LOCATE UKEY IN FILELIST<4> SETTING FOUND.POS THENş      FILELIST<5,FOUND.POS,-1> = LINE.NUMş    END ELSEş*3-9-15*      FILELIST<1,LPOS> = FILENAMEş      FILELIST<1,LPOS> = FILENAME.VAR; *3-9-15*ş      FILELIST<2,LPOS> = FILEVARş      FILELIST<3,LPOS,1> = "Open"ş      FILELIST<4,LPOS> = UKEYş      FILELIST<5,LPOS,1> = LINE.NUMş      F.R.IDX = 1; F.R.LINES = ""ş      LOOPş        F.R.POS = INDEX( record, "FROM ":FILEVAR, F.R.IDX )ş      WHILE F.R.POS DOş        F.R.IDX += 1ş        IF F.R.LINES # "" THEN F.R.LINES := ","ş        F.R.LINES := DCOUNT(record[1,F.R.POS+1],@AM)ş      REPEATş      IF F.R.IDX > 1 THENş        * Read operationş        FILELIST<3,LPOS,-1> = "Read"ş        FILELIST<5,LPOS,-1> = F.R.LINESş      ENDş      *ş      F.W.IDX = 1 ; F.W.LINES = ""ş      LOOPş        F.W.POS =  INDEX( record, "ON ":FILEVAR, F.W.IDX )ş      WHILE F.W.POS DOş        F.W.IDX += 1ş        IF F.W.LINES # "" THEN F.W.LINES := ","ş        F.W.LINES := DCOUNT(record[1,F.W.POS+1],@AM)ş      REPEATş      IF F.W.IDX > 1 THENş        * Write operationş        FILELIST<3,LPOS,-1> = "Write"ş        FILELIST<5,LPOS,-1> = F.W.LINESş      ENDş      *ş      F.D.IDX = 1 ; F.D.LINES = ""ş      LOOPş        F.D.POS =  INDEX( record, "DELETE ":FILEVAR, F.D.IDX )ş      WHILE F.D.POS DOş        F.D.IDX += 1ş        IF F.D.LINES # "" THEN F.D.LINES := ","ş        F.D.LINES := DCOUNT(record[1,F.D.POS+1],@AM)ş      REPEATş      IF F.D.IDX > 1 THENş        * Delete operationş        FILELIST<3,LPOS,-1> = "Delete"ş        FILELIST<5,LPOS,-1> = F.D.LINESş      ENDş      LPOS += 1ş    ENDş  ENDş  IDX.POS += 1şREPEATşRETURNş*şQUOTE.CHECK: * Is the data in LINE at QCPOS inside quotes?ş*şCURR.Q = ""şFOR SEEK.POS = 1 TO QCPOSş  QCH = LINE[SEEK.POS,1]ş  BEGIN CASEş    CASE CURR.Q # ""ş      IF QCH = CURR.Q THENş        CURR.Q = ""ş      ENDş    CASE QCH = "'" ; CURR.Q = QCHş    CASE QCH = '"' ; CURR.Q = QCHş    CASE QCH = '\' ; CURR.Q = QCHş  END CASEşNEXT SEEK.POSşIF CURR.Q # "" THEN IN.QUOTE = 1 ELSE IN.QUOTE = 0şRETURN00650CMVDB.ADMINş0c2* Copyright (C) 2007 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Luke Bucklin, Sierra Bravoş* Date: November, 2007ş* Description: Administration area of Bravo Dashboardş*ş* 07-17-15 PETER SCHELLENBACH OF ZUMASYS - MODIFIED FOR UVş*          CHANGE OCONV(X,'U3060') TO DIGEST('MD5'...)ş*ş* 09-23-16 Peter Schellenbachş*  Add support for alternate logo defined for each user (MVDB.USERS attr 7).ş*  Requires corresponding changes in WEB.FORMS admin_template.html andş*  javascripts initAdminTemplate.js to edit the alternate logo field.ş*ş* 06-19-17 Peter Schellenbachş*  Fix bug where encrypted passwords were being stored in MVDB.USERS withoutş*  converting to hex (MVDB.MAIN compares hex-converted encrypted password).ş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEşINCLUDE WBPD FI.MVDB.USERSşINCLUDE WBPD FI.MVDB.WIDGETSşINCLUDE WBPD FI.MVDB.DEFSşINCLUDE WBPD FI.MVDB.WIDGET.TYPESş*şDIM DB.AREAS(5)ş*şOPEN '','MVDB.WIDGETS' TO F.MVDB.WIDGETS ELSE STOP 201, 'MVDB.WIDGETS'şOPEN '','MVDB.SUBS' TO F.MVDB.SUBS ELSE STOP 201, 'MVDB.SUBS'şOPEN '','MVDB.USERS' TO F.MVDB.USERS ELSE STOP 201, 'MVDB.USERS'şOPEN '','MVDB.DEFS' TO F.MVDB.DEFS ELSE STOP 201, 'MVDB.DEFS'şOPEN '','MVDB.WIDGET.TYPES' TO F.MVDB.WIDGET.TYPES ELSE STOP 201, 'MVDB.WIDGET.TYPES'şOPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSE STOP 201, 'MVDB.CONTROL'şOPEN '','MVDB.THEMES' TO F.MVDB.THEMES ELSE STOP 201, 'MVDB.THEMES'ş*şDIM SITE$SETTINGS(100)şEQU SITE$AUTH.SUB     TO SITE$SETTINGS(1)şEQU SITE$NULL.PW.OK   TO SITE$SETTINGS(2)şEQU SITE$W.MAX.DUR    TO SITE$SETTINGS(3)şEQU SITE$TCP.PORT     TO SITE$SETTINGS(4)şEQU SITE$ALT.LOGO     TO SITE$SETTINGS(7)şEQU SITE$THEME        TO SITE$SETTINGS(8)şEQU SITE$CHARSET      TO SITE$SETTINGS(9)ş*şMATREAD SITE$SETTINGS FROM F.MVDB.CONTROL, "MVDB.SETTINGS" ELSE MAT SITE$SETTINGS = ""şREADV THEME.CSS FROM F.MVDB.THEMES, SITE$THEME, 1 ELSE THEME.CSS = ''şIF SITE$ALT.LOGO = '' THENş  SITE.LOGO = '/db/images/mv-logo.png'şEND ELSEş  SITE.LOGO = SITE$ALT.LOGOş  IF NOT(INDEX(SITE.LOGO,'/',1)) THENş    SITE.LOGO = '/db/images/':SITE.LOGOş  ENDşENDşIF THEME.CSS # '' THEN THEME.CSS = '<link rel="Stylesheet" href="/db/themes/':THEME.CSS:'" media="screen" type="text/css" />'şIF SITE$CHARSET = '' THEN SITE$CHARSET = 'UTF-8'ş*ş*SESSION$GLOBAL.DEBUG = 1ş*şGLOBAL.INFO(100) = 0şCALL GET.SESSION.VAR("adminauth",adminauth)şCALL PUT.SESSION.VAR("dd_mode",0)şadminpass = ""şIF adminauth # 1 THENş  FORM = '<html><head><meta http-equiv="Refresh" content="0; url=/dbc/MVDB.MAIN" />'ş  FORM := '</head><body><p>Administrative priviledges are required. 'ş  FORM:= 'Please <a href="/dbc/MVDB.MAIN">log in</a>.</p></body></html>'ş  CALL WEB.SEND(FORM)ş  GLOBAL.INFO(100) = 1 ;* Intentional stopş  STOPşENDş*şLOCATE "action" IN CGI$VARS SETTING POS THENş  action = CGI$VALS<POS>şEND ELSE action = ""şLOCATE "filter" IN CGI$VARS SETTING POS THENş  filter = CGI$VALS<POS>şEND ELSEş  CALL GET.SESSION.VAR("widget_filter",filter)şENDşLOCATE "clearfilter" IN CGI$VARS SETTING POS THENş  filter = ""şENDşCALL PUT.SESSION.VAR("widget_filter",filter)ş*şLOCATE "unfail_widget" IN CGI$VARS SETTING POS THENş  UNFAIL.WIDGET = CGI$VALS<POS>ş  CALL GET.SESSION.VAR("failed_widgets",FAILED.WIDGETS)ş  LOCATE UNFAIL.WIDGET IN FAILED.WIDGETS SETTING DPOS THENş    FAILED.WIDGETS = DELETE( FAILED.WIDGETS, DPOS, 0, 0 )ş    CALL PUT.SESSION.VAR("failed_widgets",FAILED.WIDGETS)ş  ENDş  action = "widgets"şENDş*şACTIVE.MENU = ''şHTML = ''şSCRIPTS = ""şBEGIN CASEş  CASE action = "users" OR action = ""ş    GOSUB LOAD.USERSş  CASE action = "widgets"ş    GOSUB LOAD.WIDGETSş  CASE action = "save_widget"ş    LOCATE "save_widget" IN CGI$VARS SETTING POS THENş      LOCATE "save_widgetid" IN CGI$VARS SETTING POS THENş        save.widgetid = CGI$VALS<POS>ş        LOCATE "newwidget" IN CGI$VARS SETTING POS THENş          newwidget = (CGI$VALS<POS> = 1)ş        END ELSE newwidget = ""ş        IF newwidget = 1 THENş          LOCATE "new_widgetid" IN CGI$VARS SETTING POS THENş            save.widgetid = CGI$VALS<POS>ş          ENDş        END ELSE newwidget = 0ş        IF newwidget THENş          MATREAD WIDGET.ITEM FROM F.MVDB.WIDGETS, save.widgetid THENş            SQN = 1ş            LOOPş              new.saveid = save.widgetid:"-":SQNş              MATREAD WIDGET.ITEM FROM F.MVDB.WIDGETS, new.saveid THENş                SQN += 1ş              END ELSEş                save.widgetid = new.saveidş                EXITş              ENDş            REPEATş          ENDş        ENDş        IF save.widgetid # "" THENş          MATREAD WIDGET.ITEM FROM F.MVDB.WIDGETS, save.widgetid ELSE MAT WIDGET.ITEM = ''ş          LOCATE "widget_sub" IN CGI$VARS SETTING POS THENş            WIDGET.SUB = CGI$VALS<POS>ş          ENDş          LOCATE "widget_users" IN CGI$VARS SETTING POS THENş            USER.LIST = CGI$VALS<POS>ş            CONVERT "," TO @VM IN USER.LISTş            WIDGET.USERS = USER.LISTş          END ELSE WIDGET.USERS = ""ş          LOCATE "new_widget_name" IN CGI$VARS SETTING POS THENş            NEW.NAME = CGI$VALS<POS>ş            IF NEW.NAME = save.widgetid THEN NEW.NAME = ""ş          END ELSE NEW.NAME = ""ş          IF NEW.NAME # "" THENş            * A rename of the widget has occurred.ş            MATWRITE WIDGET.ITEM ON F.MVDB.WIDGETS, NEW.NAMEş            DELETE F.MVDB.WIDGETS, save.widgetidş            * Rename instances of this widget name within dashboard definitionsş            SELECT F.MVDB.DEFSş            LOOPş              READNEXT DBID ELSE EXITş              MATREADU DB.ITEM FROM F.MVDB.DEFS, DBID ELSE CONTINUEş              LOOPş                LOCATE save.widgetid IN DB.WIDGETS<1> SETTING RPOS THENş                  FOUND = 1ş                  DB.WIDGETS<1,RPOS> = NEW.NAMEş                END ELSE FOUND = 0ş              WHILE FOUND DO REPEATş              MATWRITE DB.ITEM ON F.MVDB.DEFS, DBIDş            REPEATş          END ELSEş            MATWRITE WIDGET.ITEM ON F.MVDB.WIDGETS, save.widgetidş          ENDş        ENDş      ENDş    END ELSEş      LOCATE "delete_widget" IN CGI$VARS SETTING POS THENş        LOCATE "save_widgetid" IN CGI$VARS SETTING POS THENş          save.widgetid = CGI$VALS<POS>ş          DELETE F.MVDB.WIDGETS, save.widgetidş        ENDş      ENDş    ENDş    GOSUB LOAD.WIDGETSş  CASE action = "dashboards"ş    GOSUB LOAD.DASHBOARDSş  CASE action = "editdb" OR action = "adddb"ş    ACTIVE.MENU = "DASHBOARDS"ş    READ INNER.TEMPLATE FROM F.WEB.FORMS, "admin_dashboards.html" ELSE INNER.TEMPLATE = "admin_dashboards.html not found"ş    DASHBOARD.LIST = ''ş    EXECUTE 'SSELECT MVDB.DEFS' CAPTURING JUNKş    LOOPş      READNEXT ID ELSE EXITş      DASHBOARD.LIST<-1> = IDş    REPEATş    CALL SWAP(DASHBOARD.LIST, CHAR(254), '","')ş    DASHBOARD.LIST = '"':DASHBOARD.LIST:'"'ş    CALL SWAP(INNER.TEMPLATE,'<!-- list_of_dashboard_ids -->',DASHBOARD.LIST)ş    *ş    IF action = "adddb" THENş      edit.id = "new_db"ş      EDIT.PROMPT = '<input id="edit_dbid" type="text" value="Untitled Dashboard" name="edit_dbid"/>'ş      CALL SWAP(INNER.TEMPLATE,'<!-- save_dbid -->',edit.id)ş      CALL SWAP(INNER.TEMPLATE,'<!-- edit_dbid -->',EDIT.PROMPT)ş      MAT DB.ITEM = ''ş    END ELSEş      LOCATE "edit_dbid" IN CGI$VARS SETTING POS THENş        edit.id = CGI$VALS<POS>ş      END ELSE edit.id = ""ş      *ş      MATREAD DB.ITEM FROM F.MVDB.DEFS, edit.id ELSE MAT DB.ITEM = ''ş      *ş      EDIT.PROMPT = '<input id="db_id" type="text" value="':edit.id:'" name="db_new_id" size="63" />' ş      CALL SWAP(INNER.TEMPLATE,'<!-- save_dbid -->',edit.id)ş      CALL SWAP(INNER.TEMPLATE,'<!-- edit_dbid -->',EDIT.PROMPT)ş    ENDş    CALL MVDB.SUB.WIDGET.LIST(WIDGET.LIST)ş    *ş    SCRIPT1 = 'var widgetList = new Array("");':CHAR(10)ş    CALL SWAP(INNER.TEMPLATE,'<!-- db_desc -->',DB.DESC)ş    CALL SWAP(INNER.TEMPLATE,'<!-- db_sort -->',DB.SORT)ş    *ş    *DB.THEME db_theme select listş    *ş    theme.select = '<select name="db_theme">'ş    theme.select := CHAR(10):'<option value="">Default Theme</option>'ş    EXECUTE 'SSELECT MVDB.THEMES' CAPTURING JUNKş    THEME.LIST = ''ş    LOOPş      READNEXT THEME.ID ELSE EXITş      READV CSS.NAME FROM F.MVDB.THEMES, THEME.ID, 1 ELSE CSS.NAME = ''ş      IF CSS.NAME # '' THENş        SELECTED = ''ş        IF THEME.ID = DB.THEME THEN SELECTED = ' selected'ş        theme.select := CHAR(10):'<option value="':THEME.ID:'"':SELECTED:'>':THEME.ID:'</option>'ş      ENDş    REPEATş    theme.select := CHAR(10):'</select>':CHAR(10)ş    CALL SWAP(INNER.TEMPLATE,'<!-- db_theme -->',theme.select)    ş    CALL SWAP(INNER.TEMPLATE,'<!-- db_sort -->',DB.SORT)ş    *ş    SHOW.USERS = DB.USERS.ALLOWEDş    CONVERT @VM TO "," IN SHOW.USERSş    CALL SWAP(INNER.TEMPLATE,'<!-- db_users -->',SHOW.USERS)ş    *ş    ACTIVE1 = "" ; ACTIVE2 = "" ; ACTIVE3 = ""ş    IF DB.TEMPLATE = "" THEN DB.TEMPLATE = 1ş    SCRIPT1 := 'var defaultLayout=':DB.TEMPLATE:';':CHAR(10)ş    BEGIN CASEş      CASE DB.TEMPLATE = 3 ; ACTIVE3 = 'class="active"'ş      CASE DB.TEMPLATE = 2 ; ACTIVE2 = 'class="active"'ş      CASE DB.TEMPLATE = 1 OR 1 ; ACTIVE1 = 'class="active"'ş    END CASEş    LAYOUT.OPTS  = '<li ':ACTIVE1:'><label>1 column</label><img alt="1" src="/db/images/1-column-layout.png" /></li>'ş    LAYOUT.OPTS := '<li ':ACTIVE2:'><label>2 column</label><img alt="2" src="/db/images/2-column-layout.png" /></li>'ş    LAYOUT.OPTS := '<li ':ACTIVE3:'><label>3 column</label><img alt="3" src="/db/images/3-column-layout.png" /></li>'ş    *ş    CALL SWAP(INNER.TEMPLATE,'<!-- db_layout_opts -->',LAYOUT.OPTS)ş    *ş    * Create a list of widgets by areaş    *ş    MAT DB.AREAS = ""ş    FOR X = 1 TO DCOUNT( DB.WIDGETS, @VM )ş      WID = DB.WIDGETS<1,X>ş      CALL SWAP(WID,'"','\"')ş      LOCATE WID IN WIDGET.LIST<1> SETTING WPOS THENş        WWIDTH = WIDGET.LIST<6,WPOS>ş        WTYPE = WIDGET.LIST<4,WPOS>ş        FAIL.TEXT = WIDGET.LIST<8,WPOS>ş      END ELSEş        WTYPE = "UNKNOWN"ş        WWIDTH = 1ş        FAIL.TEXT = ""ş      ENDş      THIS.AREA = DB.WIDGET.AREA<1,X>ş      IF NOT(THIS.AREA MATCHES "1N") THEN THIS.AREA = 1ş      IF THIS.AREA < 1 OR THIS.AREA > 5 THEN THIS.AREA = 1ş      MATREAD WIDGET.TYPES FROM F.MVDB.WIDGET.TYPES, WTYPE THENş        CLASS.NAME = FIELD(WT$ICON,'.',1)ş        CONVERT "_" TO "-" IN CLASS.NAMEş        WIDTH.CLASS = ""ş        BEGIN CASEş          CASE WWIDTH = 1 ; WIDTH.CLASS = 'widget-small'ş          CASE WWIDTH = 2 ; WIDTH.CLASS = 'widget-medium'ş          CASE WWIDTH = 3 OR 1; WIDTH.CLASS = 'widget-large'ş        END CASEş        SHOW.WID = WIDş        IF FAIL.TEXT # "" THEN SHOW.WID := " (":FAIL.TEXT:")"ş        DB.AREAS(THIS.AREA) := '<div name="':WID:'" class="':CLASS.NAME:'"><span type="':WTYPE:'" class="':WIDTH.CLASS:'" >':SHOW.WID:'</span></div>'ş      ENDş    NEXT Xş    FOR X = 1 TO 5ş      CALL SWAP(INNER.TEMPLATE,'<!-- AREA_':X:'_WIDGETS -->',DB.AREAS(X))ş    NEXT Xş    *ş    * Build widget option listş    *ş    WOPTS = ''ş    ALL.WIDGET.CNT = DCOUNT( WIDGET.LIST<1>, @VM )ş    FOR X = 1 TO ALL.WIDGET.CNTş      USE.DESC = WIDGET.LIST<2,X>ş      WID = WIDGET.LIST<1,X>ş      WDESC = WIDGET.LIST<2,X>ş      WTYPE = WIDGET.LIST<4,X>ş      WWIDTH = WIDGET.LIST<6,X>ş      FAIL.TEXT = WIDGET.LIST<8,X>ş      CALL SWAP(WDESC,'"','\"')ş      CALL SWAP(WID,'"','\"')ş      MATREAD WIDGET.TYPES FROM F.MVDB.WIDGET.TYPES, WTYPE THENş        CLASS.NAME = FIELD(WT$ICON,'.',1)ş        CONVERT "_" TO "-" IN CLASS.NAMEş        WIDTH.CLASS = ""ş        BEGIN CASEş          CASE WWIDTH = 1 ; WIDTH.CLASS = 'widget-small'ş          CASE WWIDTH = 2 ; WIDTH.CLASS = 'widget-medium'ş          CASE WWIDTH = 3 OR 1; WIDTH.CLASS = 'widget-large'ş        END CASEş        SHOW.WID = WIDş        IF FAIL.TEXT # "" THEN SHOW.WID := " (":FAIL.TEXT:")"ş        WOPTS := '<div class="':CLASS.NAME:'"><span name="':WID:'" class="widget-id ':WIDTH.CLASS:'" type="':WTYPE:'">':SHOW.WID:'</span></div>':CHAR(10)ş      ENDş      SCRIPT1 := \widgetList["\:WID:\"] = new Array("\:WDESC:\","\:WTYPE:\","\:WIDGET.LIST<6,X>:\");\ş    NEXT Xş    *ş    GOSUB MAKE.DB.SCRIPTş    SCRIPTS<-1> = SCRIPT1ş    *ş    CALL SWAP(INNER.TEMPLATE,'<!-- widget_list -->',WOPTS)ş    HTML = INNER.TEMPLATEş  CASE action = "save_db"ş    LOCATE "save_db" IN CGI$VARS SETTING POS THENş      SAVE.OK = 1ş      rename.id = ""ş      LOCATE "save_dbid" IN CGI$VARS SETTING POS THENş        save.id = CGI$VALS<POS>ş        IF save.id = "new_db" THENş          LOCATE "edit_dbid" IN CGI$VARS SETTING POS THENş            save.id = CGI$VALS<POS>ş          END ELSE save.id = ""ş          IF save.id = "" THEN SAVE.OK = 0 ELSEş            MATREAD DB.ITEM FROM F.MVDB.DEFS, save.id THEN SAVE.OK = 0ş          ENDş        END ELSEş          LOCATE "db_new_id" IN CGI$VARS SETTING POS THENş            rename.id = CGI$VALS<POS>ş          ENDş        ENDş        CONVERT '"\' TO '' IN rename.idş        CONVERT '"\' TO '' IN save.idş        IF SAVE.OK THENş          MATREAD DB.ITEM FROM F.MVDB.DEFS, save.id ELSE MAT DB.ITEM = ''ş          LOCATE "db_desc" IN CGI$VARS SETTING POS THENş            DB.DESC = CGI$VALS<POS>ş          ENDş          LOCATE "db_theme" IN CGI$VARS SETTING POS THENş            DB.THEME = CGI$VALS<POS>ş          ENDş          LOCATE "db_sort" IN CGI$VARS SETTING POS THENş            DB.SORT = CGI$VALS<POS>ş          ENDş          LOCATE "db_layout" IN CGI$VARS SETTING POS THENş            DB.TEMPLATE = CGI$VALS<POS>ş          ENDş          LOCATE "db_users" IN CGI$VARS SETTING POS THENş            DB.USERS.ALLOWED = CGI$VALS<POS>ş          ENDş          CONVERT "," TO @VM IN DB.USERS.ALLOWEDş          *ş          LOCATE "widgets" IN CGI$VARS SETTING POS THENş            WIDGET.LIST = CGI$VALS<POS>ş          END ELSE WIDGET.LIST = ""ş          CONVERT CHAR(13) TO @AM IN WIDGET.LISTş          CONVERT CHAR(10) TO "" IN WIDGET.LISTş          WCNT = DCOUNT( WIDGET.LIST, @AM )ş          DB.WIDGETS = ''ş          DB.WIDGET.AREA = ''ş          DB.WIDGET.ORDER = ''ş          FOR WX = 1 TO WCNTş            THIS.W = WIDGET.LIST<WX>ş            DB.WIDGET.AREA<1,WX> = FIELD( THIS.W, ',', 1 )ş            DB.WIDGET.ORDER<1,WX> = FIELD( THIS.W,',', 2 )ş            DB.WIDGETS<1,WX> = OCONV(THIS.W,'G2,99' )ş          NEXT WXş          IF rename.id # "" AND rename.id # save.id THENş            DELETE F.MVDB.DEFS, save.idş            MATWRITE DB.ITEM ON F.MVDB.DEFS, rename.idş          END ELSEş            MATWRITE DB.ITEM ON F.MVDB.DEFS, save.idş          ENDş        ENDş      ENDş    END ELSEş      LOCATE "delete_db" IN CGI$VARS SETTING POS THENş        LOCATE "save_dbid" IN CGI$VARS SETTING POS THENş          del.id = CGI$VALS<POS>ş          DELETE F.MVDB.DEFS, del.idş        ENDş      ENDş    ENDş    GOSUB LOAD.DASHBOARDSş  CASE action = "save_user"ş    LOCATE "save_userid" IN CGI$VARS SETTING POS THENş      save.userid = CGI$VALS<POS>ş      LOCATE "delete_user" IN CGI$VARS SETTING POS THENş        DELETE F.MVDB.USERS, save.useridş      END ELSEş        LOCATE "newuser" IN CGI$VARS SETTING POS THENş          newuser = 1ş          LOCATE "new_userid" IN CGI$VARS SETTING POS THENş            save.userid = CGI$VALS<POS>ş          ENDş        END ELSE newuser = 0ş        SAVE.OK = 1ş        IF newuser THENş          MATREAD USER.ITEM FROM F.MVDB.USERS, save.userid THENş            SAVE.OK = 0ş          ENDş        ENDş        IF SAVE.OK AND save.userid # "" THENş          MATREAD USER.ITEM FROM F.MVDB.USERS, save.userid ELSE MAT USER.ITEM = ''ş          LOCATE "username" IN CGI$VARS SETTING POS THENş            USER.NAME = CGI$VALS<POS>ş          ENDş          LOCATE "default_dashboard" IN CGI$VARS SETTING POS THENş            USER.DEFAULT.DB = CGI$VALS<POS>ş          ENDş          LOCATE "user_password" IN CGI$VARS SETTING POS THENş            IF CGI$VALS<POS> # "" THENş*07-17-15 UV*             USER.PASSWORD = OCONV(CGI$VALS<POS>,"U3060")ş              IF DIGEST('MD5', CGI$VALS<POS>, 1, USER.PASSWORD) <> 0 THEN ; *07-17-15 UV*ş                SAVE.OK = 0 ; *07-17-15 UV*ş              END ELSEş                USER.PASSWORD = OCONV(USER.PASSWORD, 'MX0C') ; *06-19-17 UV*                ş              ENDş            ENDş          ENDş          LOCATE "user_role" IN CGI$VARS SETTING POS THENş            USER.ROLE = CGI$VALS<POS>ş          ENDş          IF USER.ROLE = "" THEN USER.ROLE = "User"ş          * PJS 09-23-16 save optional user logoş          LOCATE "opt_logo_path" IN CGI$VARS SETTING POS THENş            USER.ALT.LOGO = CGI$VALS<POS>ş          END ELSEş            USER.ALT.LOGO = ""ş          ENDş          IF SAVE.OK THEN ; *07-17-15 UV* if DIGEST() function failed, don't save user (no password!)ş            MATWRITE USER.ITEM ON F.MVDB.USERS, save.useridş          ENDş        ENDş      ENDş    ENDş    GOSUB LOAD.USERSş  CASE 1ş    READ HTML FROM F.WEB.FORMS, "admin_menu.html" ELSE ADMIN.MENU = "admin_menu.html not found."şEND CASEşREAD ADMIN.TEMPLATE FROM F.WEB.FORMS, "admin_template.html" ELSE ADMIN.TEMPLATE = "admin_template.html not found."şCALL SWAP(ADMIN.TEMPLATE,'<!--CHARACTER_SET-->',SITE$CHARSET)şHEADER = '<div id="dashboard_nav">'şHEADER := '<ol class="dashboard_list">'şIF ACTIVE.MENU = "USERS" THEN ACTIVE = 'class="db_active"' ELSE ACTIVE = ""şHEADER := '<li ':ACTIVE:'><a href="':CGI$PATH:'/MVDB.ADMIN?action=users">Users</a></li>'şIF ACTIVE.MENU = "WIDGETS" THEN ACTIVE = 'class="db_active"' ELSE ACTIVE = ""şHEADER := '<li ':ACTIVE:'><a href="':CGI$PATH:'/MVDB.ADMIN?action=widgets">Widgets</a></li>'şIF ACTIVE.MENU = "DASHBOARDS" THEN ACTIVE = 'class="db_active"' ELSE ACTIVE = ""şHEADER := '<li ':ACTIVE:'><a href="':CGI$PATH:'/MVDB.ADMIN?action=dashboards">Dashboards</a></li>'şOPEN 'RSS.BP' TO F.RSS.BP THENş  HEADER := '<li><a href="':CGI$PATH:'/RSS.MAINT">RSS Feed Maintenance</a></li>'şENDşOPEN 'MVPKG.DATA' TO F.MVPKG.DATA THENş  HEADER := '<li><a href="':CGI$PATH:'/MVPKG.MAIN">Package Manager</a></li>'şENDşHEADER := '<li><a href="':CGI$PATH:'/MVDB.MAIN">Return to Dashboard</a></li>'şHEADER := '</ol>'şHEADER := '</div>'şCALL SWAP(ADMIN.TEMPLATE,'<!-- HEADER -->',HEADER)şFOOTER = ''şCALL SWAP(ADMIN.TEMPLATE,'<!-- FOOTER -->',FOOTER)ş*şCALL SWAP(ADMIN.TEMPLATE,'<!-- ADMIN_MAIN -->',HTML)şCALL SWAP(ADMIN.TEMPLATE,'<!-- ADMIN_SCRIPTS -->',SCRIPTS)şCALL SWAP(ADMIN.TEMPLATE,'<!-- SITE_LOGO -->',SITE.LOGO)şCALL SWAP(ADMIN.TEMPLATE,'<!-- SITE_THEME -->',THEME.CSS)şCALL WEB.SEND(ADMIN.TEMPLATE)şGLOBAL.INFO(100) = 1 ;* Process completed successfullyşSTOPş*şLOAD.USERS: *ş*ş    ACTIVE.MENU = "USERS"ş    EXECUTE 'SSELECT MVDB.USERS' CAPTURING JUNKş    HTML = '<table width="100%">'ş    HTML<-1> = '<tr><td colspan="5"><a href="':CGI$PATH:'/MVDB.ADMIN?action=adduser" class="add-user">Add User</a></td></tr>'ş    HTML<-1> = '<tr><th>User ID</th>'ş    HTML<-1> = '<th>Name</th>' ş    HTML<-1> = '<th>Default Dashboard</th>'ş    HTML<-1> = '<th>Role</th>'ş    HTML<-1> = '<th>Action</th>' ş    HTML<-1> = '</tr>'ş    *ş    LOOPş      READNEXT ID ELSE EXITş      MATREAD USER.ITEM FROM F.MVDB.USERS, ID ELSE MAT USER.ITEM = ""ş      IF USER.ROLE = "" THEN USER.ROLE = "User"ş      HTML<-1> = '<tr><td>':ID:'</td>'ş      HTML<-1> = '<td>':USER.NAME:'</td>'ş      HTML<-1> = '<td>':USER.DEFAULT.DB:'</td>'ş      CALL SWAP(ID,'"','\"')ş      CALL SWAP(USER.NAME,'"','\"')ş      CALL SWAP(USER.DEFAULT.DB,'"','\"')ş      CALL SWAP(USER.DEFAULT.DB,"'","&apos;")ş      * PJS 09-23-16: added USER.ALT.LOGO parameter to editUser()ş      ACTIONS = \&nbsp;<a href='javascript:editUser("\:ID:\","\:USER.NAME:\","\:USER.DEFAULT.DB:\","\:USER.ROLE:\","\:USER.ALT.LOGO:\");'><img title="Edit User" class="icon" src="/db/icons/user_edit.png" /></a>\ş      ACTIONS := \&nbsp;<a href='javascript:deleteUser("\:ID:\");'><img title="Delete User" class="icon" src="/db/icons/user_delete.png" /></a>\ş      HTML<-1> = '<td>':USER.ROLE:'</td>'ş      HTML<-1> = '<td>':ACTIONS:'</td>'ş      HTML<-1> = '</tr>'ş    REPEATş    HTML<-1> = '<tr><td colspan="5"><a href="':CGI$PATH:'/MVDB.ADMIN?action=adduser" class="add-user">Add User</a></td></tr>'ş    HTML<-1> = '</table>'ş    *ş    GOSUB MAKE.DB.SCRIPTşRETURNş*şLOAD.WIDGETS: *ş*şACTIVE.MENU = "WIDGETS"şCALL MVDB.SUB.WIDGET.LIST(WIDGET.LIST)şFFORM = '<form action="':CGI$PATH:'/MVDB.ADMIN" method="get">'şFFORM := '<input type="hidden" name="action" value="widgets">'şFFORM := 'Filter: <input type="text" name="filter" value="':filter:'"> <input type=submit name=fbtn value="Go">'şIF filter # "" THEN FFORM := ' <a href="':CGI$PATH:'/MVDB.ADMIN?action=widgets&clearfilter">Clear Filter</a>'şFFORM := '</form>'şHTML = '<table width="100%">'şHTML<-1> = '<tr><td colspan="3"><a href="':CGI$PATH:'/MVDB.ADMIN?action=addwidget" class="add-widget">Add a Widget</a></td>'şHTML<-1> = '<td colspan="4" align="right">':FFORM:'</td></tr>'şHTML<-1> = '<tr><th colspan="2">Widget ID</th>'şHTML<-1> = '<th>Type</th>' şHTML<-1> = '<th>Description</th>' şHTML<-1> = '<th>Subroutine</th>' şHTML<-1> = '<th>Users Allowed</th>' şHTML<-1> = '<th>Actions</th>' şHTML<-1> = '</tr>'ş*şWIDGET.CNT = DCOUNT( WIDGET.LIST<1>, @VM )şFOR WDX = 1 TO WIDGET.CNTş  ID = WIDGET.LIST<1,WDX>ş  WDESC = WIDGET.LIST<2,WDX>ş  WSUB = WIDGET.LIST<3,WDX>ş  WTYPE = WIDGET.LIST<4,WDX>ş  WTITLE = WIDGET.LIST<5,WDX>ş  WWIDTH = WIDGET.LIST<6,WDX>ş  FAIL.STATUS = WIDGET.LIST<7,WDX>ş  FAIL.TEXT = WIDGET.LIST<8,WDX>ş  MATREAD WIDGET.TYPES FROM F.MVDB.WIDGET.TYPES, WTYPE ELSE MAT WIDGET.TYPES = ""ş  IF filter # "" THENş    FILTER.MATCH = 0ş    IF INDEX(WDESC,filter,1) THEN FILTER.MATCH = 1ş    IF INDEX(WTITLE,filter,1) THEN FILTER.MATCH = 1ş    IF INDEX(WSUB,filter,1) THEN FILTER.MATCH = 1ş  END ELSE FILTER.MATCH =1ş  IF FILTER.MATCH THENş    IF WT$ICON # "" THENş      ICON.IMG = '<img height="20" width="20" src="/db/icons/':WT$ICON:'" />'ş    END ELSE ICON.IMG = "&nbsp;"ş    ID.LINK = IDş    CALL SUB.URL.ENCODE(ID.LINK)ş    ID.LINK = '<a href="':CGI$PATH:'/MVDB.MAIN?udview=':ID.LINK:'&dd" target="_blank" title="Open in new window">':ID:'</a>'ş    HTML<-1> = '<tr><td class="widget-name">':ID.LINK:'</td><td class="widget-icon">':ICON.IMG:'</td>'ş    HTML<-1> = '<td>':WTYPE:'</td>'ş    IF WTITLE = "" THEN WTITLE = WDESCş    HTML<-1> = '<td>':WTITLE:'</td>'ş    ENC.WIDGET.SUB = WSUBş    CALL SUB.URL.ENCODE(ENC.WIDGET.SUB)ş    HTML<-1> = '<td><a target="MVDB.SUBS_':ENC.WIDGET.SUB:'" href="':CGI$PATH:'/MVDB.WEB.ED?ed_file=MVDB.SUBS&ed_item=':ENC.WIDGET.SUB:'" title="Edit Source">':WSUB:'</a></td>'ş    MATREAD WIDGET.ITEM FROM F.MVDB.WIDGETS, ID ELSE MAT WIDGET.ITEM = ""ş    IF WIDGET.USERS # "" THENş      SHOW.USERS = WIDGET.USERSş      CONVERT @VM TO "," IN SHOW.USERSş      PASS.USER.LIST = SHOW.USERSş    END ELSEş      SHOW.USERS = "Anybody"ş      PASS.USER.LIST = ""ş    ENDş    HTML<-1> = '<td>':SHOW.USERS:'</td>'ş    CALL SWAP(WDESC,"'","\'")ş    CALL SWAP(WSUB,"'","\'")ş    CALL SWAP(PASS.USER.LIST,"'","\'")ş    URL.ID = IDş    CALL SUB.URL.ENCODE(URL.ID)ş    CALL SWAP(ID,"'","\'")ş    ACTIONS = \<a href="javascript:editWidget('\:ID:\','\:WDESC:\','\:WSUB:\','\:PASS.USER.LIST:\');"><img title="Edit Widget" class="icon" src="/db/icons/cog_edit.png" /></a>\ş    ACTIONS := '&nbsp;'ş    ACTIONS := \<a href="javascript:copyWidget('Copy of \:ID:\','\:WDESC:\','\:WSUB:\','\:PASS.USER.LIST:\');"><img title="Copy Widget" class="icon" src="/db/icons/page_copy.png" /></a>\ş    ACTIONS := '&nbsp;'ş    ACTIONS := \<a href="javascript:deleteWidget('\:ID:\','\:WDESC:\','\:WSUB:\','\:PASS.USER.LIST:\');"><img title="Delete Widget" class="icon" src="/db/icons/cog_delete.png" /></a>\ş    IF FAIL.STATUS = 1 THENş      * This widget has a fatal error and has been added to the "failed_widgets" session variable. Allow the admin to reset this status.ş      ACTIONS := \&nbsp;<a href="/dbc/MVDB.ADMIN?unfail_widget=\:URL.ID:\&action=widgets"><img title="Reset Fail Status" class="icon" src="/db/icons/arrow_redo.png" /></a>\ş    ENDş    HTML<-1> = '<td>':ACTIONS:'</td>'ş    HTML<-1> = '</tr>'ş  ENDşNEXT WDXşHTML<-1> = '<tr><td colspan="7"><a href="" class="add-widget">Add a Widget</a></td></tr>'şHTML<-1> = '</table>'ş*şSCRIPTS = 'var widgetList = new Array('şEXECUTE "SSELECT MVDB.WIDGETS" CAPTURING JUNKşFIRST = 1şLOOPş  READNEXT ID ELSE EXITş  CALL SWAP(ID,'"','\"')ş  IF NOT(FIRST) THEN SCRIPTS := ','ş  FIRST = 0ş  SCRIPTS := '"':ID:'"'şREPEATşSCRIPTS := ');'şRETURNş*şLOAD.DASHBOARDS: *ş*şACTIVE.MENU = "DASHBOARDS"şEXECUTE 'SSELECT MVDB.DEFS' CAPTURING JUNKşHTML = '<table width="100%">'şHTML<-1> = '<tr><td colspan="5"><a href="':CGI$PATH:'/MVDB.ADMIN?action=adddb" class="add-dashboard">Add A Dashboard</a></td></tr>'şHTML<-1> = '<tr><th>Dashboard ID</th>'şHTML<-1> = '<th>Description</th>' şHTML<-1> = '<th>Users Allowed</th>' şHTML<-1> = '<th>Actions</th>' şHTML<-1> = '</tr>'ş*şLOOPş  READNEXT ID ELSE EXITş  MATREAD DB.ITEM FROM F.MVDB.DEFS, ID ELSE MAT DB.ITEM = ''ş  HTML<-1> = '<tr><td>':ID:'</td>'ş  HTML<-1> = '<td>':DB.DESC:'</td>'ş  IF DB.USERS.ALLOWED # "" THENş    SHOW.USERS = DB.USERS.ALLOWEDş    CONVERT @VM TO "," IN SHOW.USERSş  END ELSE SHOW.USERS = "Anybody"ş  HTML<-1> = '<td>':SHOW.USERS:'</td>'ş  ACTIONS = '<a href="':CGI$PATH:'/MVDB.ADMIN?action=editdb&edit_dbid=':ID:'"><img title="Edit Dashboard" class="icon" src="/db/icons/layout_edit.png" /></a>&nbsp;'ş  ACTIONS := \<a onClick="return confirm('DELETE: Are you sure?');" href="\:CGI$PATH:\/MVDB.ADMIN?action=save_db&delete_db=1&save_dbid=\:ID:\"><img title="Delete Dashboard" class="icon" src="/db/icons/layout_delete.png" /></a>\ş  HTML<-1> = '<td>':ACTIONS:'</td>'ş  HTML<-1> = '</tr>'şREPEATşHTML<-1> = '<tr><td colspan="5"><a href="':CGI$PATH:'/MVDB.ADMIN?action=adddb" class="add-dashboard">Add A Dashboard</a></td></tr>'şHTML<-1> = '</table>'şRETURNş*şMAKE.DB.SCRIPT: *ş*şSCRIPTS = 'var dashboardList = new Array('şEXECUTE 'SSELECT MVDB.DEFS' CAPTURING JUNKşFIRST = 1şLOOPş  READNEXT ID ELSE EXITş  CALL SWAP(ID,'"','\"')ş  IF NOT(FIRST) THEN SCRIPTS := ','ş  FIRST = 0ş  SCRIPTS := '"':ID:'"'şREPEATşSCRIPTS := ');'şRETURN0002DCGET.SESSION.VARş0c2SUBROUTINE GET.SESSION.VAR( var, VAL )ş*ş* Copyright (C) 2003 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Michael Derheim, Sierra Bravoş* Date: 10/25/03ş* Description: This program reads a value from the current webş*              session record.ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD WWW.INCLUDEş*şEQU FALSE TO 0, TRUE TO 1şEQU AM TO CHAR(254), VM TO CHAR(253), SVM TO CHAR(252)şVAL = ''ş*şREAD REC FROM F.WEB.SESSION, SESSION$ID THENş  LOCATE var IN REC<1> SETTING POS THENş    VAL = REC<2,POS>ş  END ELSEş    VAL = ''ş  ENDşENDş*şCONVERT CHAR(2) TO @AM IN VALşCONVERT CHAR(3) TO @VM IN VALşCONVERT CHAR(4) TO @SVM IN VALş*şCALL PUT.SESSION.VAR('LastSessionAccess', DATE():'*':TIME())ş*şRETURNş*000E80SUB.EXCEL.FUNCş0c2SUBROUTINE SUB.EXCEL.FUNC(ACTION,SPREADSHEET,CSV.WIDGET.NAME)ş*ş* Copyright (c) 2020 Zumasys, Inc. All rights reserved.ş* Description: EXCEL utility functionsş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEş*ş*ş*şSPREADSHEET=''ş*ş* ISOLATE THE TITLEş*şBEGIN CASEş  CASE ACTION = 'generate'ş         * Use widget name to create a filename for the CSV fileş         OPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSE STOP 201, 'MVDB.CONTROL'ş         CALL SUB.GET.NEXT.ID(UNIQUE.ID,F.MVDB.CONTROL)    ş         CSV.FILE.NAME = CSV.WIDGET.NAME:'_' :UNIQUE.IDş         CALL SET.CONTENT.TYPE('text/csv')ş         SESSION$HEADERS<-1> = 'Content-Disposition: attachment; filename="':CSV.FILE.NAME:'.csv"'ş         * Build the CSV contentş         GOSUB BUILD.SPREADSHEET.CONTENTş         SPREADSHEET=CHANGE(SPREADSHEET,CHAR(254),CHAR(13):CHAR(10))ş         CALL SWAP(SPREADSHEET,'&nbsp;',' ')ş         CSV.SIZE=LEN(SPREADSHEET)ş         SESSION$HEADERS<-1>='Content-Length:':CSV.SIZEşEND CASEşRETURNş*şBUILD.SPREADSHEET.CONTENT:ş*şBEGIN CASEş   CASE W$TYPE = 'TABLE'ş      GOSUB TYPE.IS.TABLEş      DASHBOARD.TYPE='Report'ş   CASE INDEX(W$TYPE,'COLUMN',1)ş      GOSUB TYPE.IS.BAR.OR.COLUMNş      DASHBOARD.TYPE='Chart'ş   CASE INDEX(W$TYPE,'BAR',1)ş      GOSUB TYPE.IS.BAR.OR.COLUMNş      DASHBOARD.TYPE='Chart'ş   CASE INDEX(W$TYPE,'LINE',1)ş      GOSUB TYPE.IS.BAR.OR.COLUMNş      DASHBOARD.TYPE='Chart'ş   CASE INDEX(W$TYPE,'AREA',1)ş      GOSUB TYPE.IS.BAR.OR.COLUMNş      DASHBOARD.TYPE='Chart'ş   CASE INDEX(W$TYPE,'PIE',1)ş      GOSUB TYPE.IS.PIEş      DASHBOARD.TYPE='Pie'ş   CASE INDEX(W$TYPE,'DOUGHNUT',1)ş      GOSUB TYPE.IS.PIEş      DASHBOARD.TYPE='Pie'şEND CASEş*ş* STRIP OUT HTML STUFF AND CONVERT TO CSVş*şMAX.ROWS=DCOUNT(SPREADSHEET,CHAR(254))şFOR ROW.NO = 1 TO MAX.ROWSş   ROW=SPREADSHEET<ROW.NO>ş   *ş   * <br> to spaceş   *ş   LOOPş      POS=INDEX(ROW,'<br>',1)ş   UNTIL NOT(POS) DOş      ROW=ROW[1,POS-1]:' ':(ROW[POS+4,9999])ş   REPEATş   *ş   * ISOLATE XXX IN ]<a hrev.....">XXX</a>]ş   *ş   LOOPş      POS=INDEX(ROW,'</a>',1)ş   UNTIL NOT(POS) DOş      VAL.NO=DCOUNT(ROW[1,POS],CHAR(253))ş      VAL=ROW<1,VAL.NO>ş      POS=INDEX(VAL,'</a>',1)ş      VAL=VAL[1,POS-1]ş      POS=INDEX(VAL,'">',1)ş      VAL=VAL[POS+2,999]ş      ROW<1,VAL.NO>=VALş   REPEATş   MAX.VALS=DCOUNT(ROW,CHAR(253))ş   FOR VAL.NO = 1 TO MAX.VALSş      IF DASHBOARD.TYPE = 'Chart' AND VAL.NO > 1 THENş         VAL=ROW<1,VAL.NO>ş         IF NUM(VAL) AND NOT(INDEX(VAL,',',1)) THEN VAL=OCONV(VAL,'MD0,')ş         ROW<1,VAL.NO>=VALş       ENDş      ROW<1,VAL.NO>='"':ROW<1,VAL.NO>:'"'ş    NEXT VAL.NOş   SPREADSHEET<ROW.NO>=ROWş NEXT ROW.NOşCONVERT CHAR(253) TO ',' IN SPREADSHEETşRETURNş*şTYPE.IS.TABLE:ş*şSPREADSHEET<-1>=W$TABLE.COL.LABELSşSPREADSHEET<-1>=W$TABLE.DATAşSPREADSHEET<-1>=W$TABLE.TOTALSşRETURNş*şTYPE.IS.BAR.OR.COLUMN:ş*şSPREADSHEET<-1>='Displayed as: ':W$BAR.YMEMOşCOL.HEADINGS=W$BAR.LABELSşCONVERT CHAR(254) TO CHAR(253) IN COL.HEADINGS;  * MULTI-SERIES MAY HAVE SEVERALşIF COL.HEADINGS<1,2> = '' THEN;  * ONLY ONE THEN USE W$BAR.YMEMOş   COL.HEADINGS=W$BAR.YMEMOş ENDşCOL.HEADINGS=INSERT(COL.HEADINGS,1,1,0,W$BAR.XMEMO)şSPREADSHEET<-1>=COL.HEADINGSşNUM.ROWS=DCOUNT(W$BAR.XLABELS,CHAR(253))şNUM.COL.VALUES=DCOUNT(W$BAR.VALUES,CHAR(254))şFOR ROW.NO = 1 TO NUM.ROWSş   THIS.ROW=W$BAR.XLABELS<1,ROW.NO>ş   FOR COL.NO = 1 TO NUM.COL.VALUESş      THIS.COL=W$BAR.VALUES<COL.NO,ROW.NO>ş      IF NUM(THIS.COL) THENş         IF THIS.COL > 999 THENş            THIS.COL=OCONV(THIS.COL,'MD0,')ş          ENDş       ENDş      THIS.ROW<1,COL.NO+1>=THIS.COLş    NEXT COL.NOş   SPREADSHEET<-1>=THIS.ROWş NEXT ROW.NOşRETURNş*şTYPE.IS.PIE:ş*şSPREADSHEET<-1>=W$PIE.LABELSşSPREADSHEET<-1>=W$PIE.VALUESşRETURNşEND0009A5XML.DATAş0c2CALL WDB.VARS(VARS, VALS)şDISPLAY.TERM = 1şWEB.DATA = ''şLINE.CNT = 1şNUM.BYTES = 0ş*ş****************************************ş* q = number of bytes to quit early onş* default is full dumpş****************************************şLOCATE 'q' IN VARS SETTING POS THENş  q = VALS<POS>şEND ELSEş  q = ''şENDş*ş****************************************ş* l = number of lines of text to printş* default is 10000ş****************************************şLOCATE 'l' IN VARS SETTING POS THENş  l = VALS<POS>şEND ELSEş  l = 10000şENDş*ş****************************************ş* b = number of characters per lineş* default is 10ş****************************************şLOCATE 'b' IN VARS SETTING POS THENş  b = VALS<POS>şEND ELSEş  b = 10şENDş*ş****************************************ş* w = use web.load or printş* if w is 0, then use WEB.LOADş* default is 0ş****************************************şLOCATE 'w' IN VARS SETTING POS THENş  w = VALS<POS>şEND ELSEş  w = 0şENDş*ş****************************************ş* p = number of seconds to pause beforeş*     starting to send outputş* default is 0ş****************************************şLOCATE 'p' IN VARS SETTING POS THENş  p = VALS<POS>şEND ELSEş  p = 0şENDş*ş****************************************ş* s = which quit string to useş* default = 800 WDB-COMPLETEş****************************************şLOCATE 's' IN VARS SETTING POS THENş  s = VALS<POS>şEND ELSEş  s = '800 WDB-COMPLETE'şENDş*ş****************************************ş* MAIN PROGRAMş****************************************şIF w # 0 THENş  SLEEP pşENDşFOR X = 1 TO lş  NUM.CHARS = LEN(LINE.CNT) + 1ş  LINE = ''ş  NUM.ZEROS = b - NUM.CHARSş  FOR Y = 1 TO NUM.ZEROSş    LINE := '0'ş    NUM.BYTES += 1ş  NEXT Yş  LINE := LINE.CNTş  NUM.BYTES += LEN(LINE.CNT) + 1 ; * this is for the line counter and the line breakş  GOSUB CHECK.EARLY.TERMINATEş  IF w = 0 THENş    WEB.DATA<-1> = LINEş    IF TERM.DATA # '' THENş      WEB.DATA<-1> = TERM.DATAş    ENDş  END ELSEş    PRINT LINEş    IF TERM.DATA # '' THENş      PRINT TERM.DATAş    ENDş  ENDş  LINE.CNT += 1şNEXT XşIF w = 0 THENş  SLEEP pş  CALL WEB.SEND(WEB.DATA)şENDşSTOPş*ş********************************************************************************şCHECK.EARLY.TERMINATE:ş********************************************************************************şTERM.DATA = ''şIF q # '' AND NUM.BYTES >= q AND DISPLAY.TERM = 1 THENş  TERM.DATA = s:CHAR(10):CHAR(10)ş  DISPLAY.TERM = 0şENDşRETURNş*ş0001C9DESTROY.SESSIONş0c2SUBROUTINE DESTROY.SESSIONş*ş* Copyright (C) 2003 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Michael Derheim, Sierra Bravoş* Date: 10/25/03ş* Description: This program removes the session recordsş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD WWW.INCLUDEş* Initş*EQU FALSE TO 0, TRUE TO 1ş*EQU AM TO CHAR(254), VM TO CHAR(253), SVM TO CHAR(252)ş*şCALL SET.COOKIE("sessionid=; path=/")ş*şDELETE F.WEB.SESSION, SESSION$IDşRETURNş*002C2EMVDBTOOLKIT.APP.INSTALLERş0c2      *ş      * Copyright (C) 2009 Sierra Bravo Corporation, All Rights Reservedş      *ş      * Written by: Luke Bucklin, Sierra Bravo Corporationş      * Date: 07/15/2009ş      * Description: Application installerş      *ş      * Modified By: Dave Bucklin, Nerdery Interactive Labsş      * Date: 02/04/2011ş      * Description: Add overwrite flag, clashes handling specific to MVDashboardş      *ş      *ş      INCLUDE DM,BP,UNIX.H FCNTL.Hş      INCLUDE DM,BP,UNIX.H MODE.Hş      *ş      CHAR BUFFER[10000]ş      *ş      INSTALL.LOG.ON = 0ş      INSTALL.LOG.ID = "INSTALL*":DATE():"*":TIME()ş      INSTALL.LOG = ""ş      PROCESS.STATUS = 0ş      OVR.FLAG = 0ş      *ş      CRT "Version 2.0"ş      ş      PROMPT ""ş      PRINT "File path: ":ş      INPUT PACKAGE.FILEş      IF PACKAGE.FILE = "VERSION" THENş         PRINTş         PRINT "Installer Version"ş         PRINT "1.0"ş         STOPş      ENDş      HANDLE = %OPEN(PACKAGE.FILE,O$RDONLY+O$BINARY)ş      IF NOT(HANDLE) THENş         PRINT "Unable to open file." ; STOPş      ENDş      *ş      PACKET = ""ş      LOOPş         L = %READ(HANDLE,BUFFER,10000)ş      WHILE L > 0 DOş         PACKET := BUFFER[1,L]ş      REPEATş      IF PACKET = "" THENş         PRINT "No package."ş         STOPş      ENDş      INSTALL.ID = TIMEDATE()ş      KEEP.SOURCE = "1"ş      *ş      PRINTş      PRINT "Installing..."ş      *ş      OPEN '','MV.PACKED.FILE' TO F.PACKED.FILE ELSEş         CMD = "CREATE-FILE MV.PACKED.FILE 1 31"ş         GOSUB EXEC.CMDş         OPEN '','MV.PACKED.FILE' TO F.PACKED.FILE ELSEş            ERRFILE = "MV.PACKED.FILE"ş            GOSUB OPEN.ERRş            STOPş         ENDş      ENDş      WRITE PACKET ON F.PACKED.FILE, "PACKAGE"şş      OPEN '','MD' TO F.MD ELSEş         ERRFILE = "MD"ş         GOSUB OPEN.ERRş         STOPş      ENDş      OPEN "MV.INSTALL" TO F.INSTALL ELSEş         CMD = "CREATE-FILE MV.INSTALL 1 11"ş         GOSUB EXEC.CMDş         OPEN "MV.INSTALL" TO F.INSTALL ELSEş            ERRFILE = "MV.INSTALL"ş            GOSUB OPEN.ERRş            STOPş         ENDş      ENDş      OPEN "MV.INSTALL.CF" TO F.INSTALL.CF ELSEş         CMD = "CREATE-FILE MV.INSTALL.CF 1 11"ş         GOSUB EXEC.CMDş         OPEN "MV.INSTALL.CF" TO F.INSTALL.CF ELSEş            ERRFILE = "MV.INSTALL.CF"ş            GOSUB OPEN.ERRş            STOPş         ENDş      ENDş      OPEN "MVAPPS.INSTALLED" TO F.MVAPPS.INSTALLED ELSEş         CMD = "CREATE-FILE MVAPPS.INSTALLED 3 31"ş         GOSUB EXEC.CMDş         OPEN "MVAPPS.INSTALLED" TO F.MVAPPS.INSTALLED ELSEş            ERRFILE = "MVAPPS.INSTALLED"ş            GOSUB OPEN.ERRş            STOPş         ENDş      ENDş      OPEN "DICT","MVDB.CLASHES" TO FD.MVDB.CLASHES ELSEş         CMD = "CREATE-FILE DICT MVDB.CLASHES 3"ş         GOSUB EXEC.CMDş      ENDş      INSTALL.LOG.ON = 1ş      *ş      CLEARFILE F.INSTALLş      DELETE F.INSTALL.CF, "MVAPPS-PRE-SCRIPT" ;* Get rid of this just in case one is left overş      DELETE F.INSTALL.CF, "MVAPPS-POST-SCRIPT"ş      DELETE F.INSTALL.CF, "PACKAGE.INFO"ş      TARGET = F.INSTALLş      TARGET.NAME = "MV.INSTALL"ş      GOSUB UNPACKş      * All individual file packages are now in INSTALLş      * Unpack the MD scriptsş      READ PACKET FROM F.INSTALL, "MV.INSTALL.CF" THENş         TARGET = F.INSTALL.CFş         TARGET.NAME = "MV.INSTALL.CF"ş         GOSUB UNPACKş         DELETE F.INSTALL, "MV.INSTALL.CF"ş      ENDş      *ş      * Execute script that are required prior to compilationş      *ş      READ CMD FROM F.INSTALL.CF, "MVAPPS-PRE-SCRIPT" THENş         LOG.LINE = TIMEDATE():": Processing PRE-INSTALL commands..."ş         INSTALL.LOG<-1> = LOG.LINEş         * Execute commands that need to be run before the install process beginsş         GOSUB EXEC.CMDş         LOG.LINE = TIMEDATE():": Completed PRE-INSTALL commands."ş         INSTALL.LOG<-1> = LOG.LINEş      ENDş      READ PACKAGE.INFO FROM F.INSTALL.CF, "PACKAGE.INFO" ELSE PACKAGE.INFO = ""ş      PACKAGE.ID = PACKAGE.INFO<6>ş      PACKAGE.INFO<4> = DATE()ş      PACKAGE.INFO<5> = TIME()ş      *ş      SELECT F.INSTALLş      LOOPş         READNEXT PKG.ID ELSE EXITş         IF PKG.ID # "" THENş            READ PACKET FROM F.INSTALL, PKG.ID THENş               TARGET.FILE = FIELD(PKG.ID," ",1)ş               DICT.MOD = FIELD( PKG.ID," ",2)ş               DATA.MOD = FIELD( PKG.ID," ",3)ş               DICT = ""ş               IF FIELD( PKG.ID,'_',1 ) = "DICT" THENş                  TARGET.FILE = FIELD( PKG.ID, '_', 2 )ş                  DICT = "DICT"ş               ENDş               OPEN DICT,TARGET.FILE TO F.TARGET ELSEş                  IF NOT(INDEX(TARGET.FILE,':',1)) THENş                     IF DICT.MOD = "" THEN DICT.MOD = 3ş                     IF DATA.MOD = "" THEN DATA.MOD = 31ş                     CMD = "CREATE-FILE ":TARGET.FILE:" ":DICT.MOD:" ":DATA.MODş                     GOSUB EXEC.CMDş                  ENDş                  OPEN DICT,TARGET.FILE TO F.TARGET ELSEş                     PRINT "Unable to create file ":TARGET.FILEş                     GOSUB CLEANUPş                     STOPş                  ENDş               ENDş               TARGET = F.TARGETş               TARGET.NAME = TRIM(DICT:" ":TARGET.FILE)ş               GOSUB UNPACKş            ENDş         ENDş      REPEATş      *ş      * Execute script required post compilationş      *ş      READ CMD FROM F.INSTALL.CF, "MVAPPS-POST-SCRIPT" THENş         LOG.LINE = TIMEDATE():": Processing POST-INSTALL commands..."ş         INSTALL.LOG<-1> = LOG.LINEş         * Use compile options if they are present.ş         OPEN 'MVDB.CONTROL' TO F.MVDB.CONTROL THENş            READ COMPILE.SETUP FROM F.MVDB.CONTROL, 'COMPILE.SETUP' THENş               COMPILE.VERB = FIELD(COMPILE.SETUP<1>,' ',1)ş               IF COMPILE.VERB # '' THENş                  OPTS = FIELD(COMPILE.SETUP<1>,'(',2)ş                  IF OPTS # '' THEN OPTS = "(":OPTSş                  CMD.CNT = DCOUNT( CMD, @AM )ş                  FOR CMD.XX = 1 TO CMD.CNTş                     IF FIELD(CMD<CMD.XX>,' ',1) = 'BASIC' OR FIELD(CMD<CMD.XX>,' ',1) = 'COMPILE' THENş                        *make sure we use the right verb and options from the compile.setupş                        CMD<CMD.XX> = COMPILE.VERB:' ':CMD<CMD.XX>[INDEX(CMD<CMD.XX>,' ',1)+1,999]:' ':OPTSş                     ENDş                  NEXT CMD.XXş               ENDş            ENDş         ENDş         * Execute commands that need to be run at the end of the install processş         GOSUB EXEC.CMDş         LOG.LINE = TIMEDATE():": Completed POST-INSTALL commands."ş         INSTALL.LOG<-1> = LOG.LINEş      ENDş      *ş      **IF NOT(KEEP.SOURCE) THENş      **  FOR X = 1 TO DCOUNT( SOURCE.FILES, @AM )ş      **    CMD = "CLEAR-FILE DATA ":SOURCE.FILES<X>ş      **    GOSUB EXEC.CMDş      **  NEXT Xş      **ENDş      READ INSTALL.LIST FROM F.INSTALL.CF, "LAST.INSTALL" ELSE INSTALL.LIST = ""ş      INSTALL.LIST = INSERT( INSTALL.LIST, 1, 0, 0, INSTALL.ID )ş      WRITE INSTALL.LIST ON F.INSTALL.CF, "LAST.INSTALL"ş      GOSUB CLEANUPş      INSTALL.LOG<-1> = TIMEDATE():": Install complete."ş      WRITE INSTALL.LOG ON F.INSTALL.CF, INSTALL.LOG.IDş      WRITE PACKAGE.INFO ON F.MVAPPS.INSTALLED, PACKAGE.IDş      PROCESS.STATUS = 1ş      GOSUB SEND.DATAş      STOPş      *********şUNPACK: *ş      *********ş      PRINT "Unpacking ":TARGET.NAME:"... ":ş      *ş      BYTES = 0ş      CNT = 0ş      LOOPş         PLENGTH = OCONV( PACKET[1,6], 'MCXD' )ş         REC = PACKET[7,PLENGTH]ş         PACKET = PACKET[PLENGTH+7,9999999]ş         ID = REC<1>ş         REC = DELETE( REC, 1, 0, 0 )ş         TYP = REC[1,2]ş         OVR.FLAG = REC[3,1]ş         REC = REC[4,9999999]ş         IF TYP = "0x" THENş            REC = OCONV( REC, 'MY' )ş         END ELSE IF TYP # "0c" THENş            REC = TYP:RECş         ENDş         *ş         CNT += 1ş         BYTES += LEN(REC)ş         IF OVR.FLAG THENş            IF DICT = "" THENş               *If we're not installing DICT items, compare for CLASHESş               READ CLASH FROM TARGET, ID THENş                  BEGIN CASEş                        *Preserve dashboard user passwordsş                     CASE TARGET.FILE = "MVDB.USERS"ş                        IF CLASH<1> # REC<1> THEN REC<1> = CLASH<1>ş                        *Preserve dashboard access profileş                     CASE TARGET.FILE = "MVDB.DEFS"ş                        IF CLASH<5> # REC<5> THEN REC<5> = CLASH<5>ş                        *Preserve widget access profileş                     CASE TARGET.FILE = "MVDB.WIDGETS"ş                        IF CLASH<2> # REC<2> THEN REC<2> = CLASH<2>ş                        *Preserve widget compile optionş                     CASE TARGET.FILE = "MVDB.CONTROL" AND ID = "COMPILE.SETUP"ş                        IF CLASH<1> # REC<1> THEN REC<1> = CLASH<1>ş                  END CASEş                  IF CLASH # '' AND REC # CLASH THENş                     CLASH.NAME = TARGET.NAMEş                     CONVERT " " TO "_" IN CLASH.NAMEş                     OPEN 'MVDB.CLASHES,':CLASH.NAME TO F.CLASHES ELSEş                        CMD = "CREATE-FILE DATA MVDB.CLASHES,":CLASH.NAME:" 7"ş                        GOSUB EXEC.CMDş                        OPEN 'MVDB.CLASHES,':CLASH.NAME TO F.CLASHES ELSEş                           PRINT "Unable to create file MVDB.CLASHES,":CLASH.NAMEş                           GOSUB CLEANUPş                           STOPş                        ENDş                     ENDş                     WRITE CLASH ON F.CLASHES, IDş                     CLOSE F.CLASHESş                  ENDş               ENDş            ENDş            WRITE REC ON TARGET, IDş         END ELSEş            READ TST FROM TARGET, ID ELSEş               WRITE REC ON TARGET, IDş            ENDş         ENDş         IF NOT(MOD(CNT,500)) THEN PRINT "*":ş      UNTIL PACKET = "" DO REPEATş      IF CNT # 1 THEN PLURAL = "s" ELSE PLURAL = ""ş      PRINT CNT:" record":PLURAL:"."ş      LOG.LINE = TIMEDATE():": UNPACKED ":CNT:" RECORDS TO ":TARGET.NAMEş      INSTALL.LOG<-1> = LOG.LINEş      RETURNş      **********şCLEANUP: *ş      **********ş      CLEARFILE F.INSTALLş      CLEARFILE F.PACKED.FILEş      RETURNş      *şEXEC.CMD: *ş      *ş      CMD.CNT = DCOUNT( CMD, @AM )ş      FOR CMD.XX = 1 TO CMD.CNTş         THIS.CMD = CMD<CMD.XX>ş         IF INDEX(THIS.CMD,@VM,1) THENş            THIS.DATA = THIS.CMD<1,1>ş            THIS.CMD = THIS.CMD<1,2>ş         END ELSEş            THIS.DATA = ''ş         ENDş         IF THIS.DATA # "" THENş              DATA THIS.DATA; * ADDED 7/22/2020 FOR PACKAGE.INSTALLERş              CRT "Data      ":THIS.DATAş         ENDş         CRT "Executing   ":THIS.CMDş         LOG.LINE = TIMEDATE():": EXEC: ":THIS.CMDş         INSTALL.LOG<-1> = LOG.LINEş         EXECUTE THIS.CMDş         IF INSTALL.LOG.ON THENş            WRITE INSTALL.LOG ON F.INSTALL.CF, INSTALL.LOG.IDş         ENDş      NEXT CMD.XXş      RETURNş      *şOPEN.ERR: *ş      *ş      LOG.LINE = TIMEDATE():": FILE OPEN ERROR: ":ERRFILEş      INSTALL.LOG<-1> = LOG.LINEş      PRINT LOG.LINEş      GOSUB SEND.DATAş      RETURNş      *şSEND.DATA: *ş      *ş      PRINTş      IF PROCESS.STATUS = 1 THEN INSTALL.STATUS = "Success" ELSE INSTALL.STATUS = "Failed"ş      PRINT "Install process finished. Status: ":INSTALL.STATUSş      RETURN0021C5RSS.MAINTş0c2*ş* Copyright (C) 2007 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Luke Bucklin, Sierra Bravoş* Date: March 10, 2009ş* Description: RSS Feed Maintenanceş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE RSS.BP RSS.DATA.INCş*şOPEN '','RSS.FEEDS' TO F.RSS.FEEDS ELSE STOP 201, 'RSS.FEEDS'şOPEN '','WEB.FORMS' TO F.WEB.FORMS ELSE STOP 201, 'WEB.FORMS'şOPEN '','MD' TO F.MD ELSEş  OPEN '','VOC' TO F.MD ELSE STOP 201, 'MD'şENDşOPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSE STOP 201, 'MVDB.CONTROL'şOPEN '','MVDB.THEMES' TO F.MVDB.THEMES ELSE STOP 201, 'MVDB.THEMES'ş*şDIM SITE$SETTINGS(100)şEQU SITE$AUTH.SUB     TO SITE$SETTINGS(1)şEQU SITE$NULL.PW.OK   TO SITE$SETTINGS(2)şEQU SITE$W.MAX.DUR    TO SITE$SETTINGS(3)şEQU SITE$TCP.PORT     TO SITE$SETTINGS(4)şEQU SITE$ALT.LOGO     TO SITE$SETTINGS(7)şEQU SITE$THEME        TO SITE$SETTINGS(8)şEQU SITE$CHARSET      TO SITE$SETTINGS(9)ş*şMATREAD SITE$SETTINGS FROM F.MVDB.CONTROL, "MVDB.SETTINGS" ELSE MAT SITE$SETTINGS = ""şREADV THEME.CSS FROM F.MVDB.THEMES, SITE$THEME, 1 ELSE THEME.CSS = ''şIF SITE$ALT.LOGO = '' THENş  SITE.LOGO = '/db/images/mv-logo.png'şEND ELSEş  SITE.LOGO = SITE$ALT.LOGOş  IF NOT(INDEX(SITE.LOGO,'/',1)) THENş    SITE.LOGO = '/db/images/':SITE.LOGOş  ENDşENDşIF THEME.CSS # '' THEN THEME.CSS = '<link rel="Stylesheet" href="/db/themes/':THEME.CSS:'" media="screen" type="text/css" />'şIF SITE$CHARSET = '' THEN SITE$CHARSET = 'UTF-8'ş*şCALL GET.SESSION.VAR("adminauth",adminauth)şCALL PUT.SESSION.VAR("dd_mode",0)şadminpass = ""şIF adminauth # 1 THENş  FORM = '<html><head><meta http-equiv="Refresh" content="0; url=/dbc/MVDB.MAIN" />'ş  FORM := '</head><body><p>Administrative priviledges are required. 'ş  FORM:= 'Please <a href="/dbc/MVDB.MAIN">log in</a>.</p></body></html>'ş  CALL WEB.SEND(FORM)ş  STOPşENDş*şLOCATE "action" IN CGI$VARS SETTING POS THENş  action = CGI$VALS<POS>şEND ELSE action = ""şLOCATE "id" IN CGI$VARS SETTING POS THENş  id = CGI$VALS<POS>şEND ELSE id = ""şLOCATE "cancel_edit" IN CGI$VARS SETTING POS THENş  action = "list"şENDş*şHTML = ''şBEGIN CASEş  CASE action = "edit" OR action = "add" AND 0 ;* This code is depricatedş    IF action = "edit" THENş      READ FEED.REC FROM F.RSS.FEEDS, id ELSE FEED.REC = ""ş    END ELSE FEED.REC = ""ş    FEED.NAME = FEED.REC<1>ş    FEED.DESC = FEED.REC<3>ş    CRLF = CHAR(13):CHAR(10)ş    CALL SWAP(FEED.DESC,'<br />',CRLF)ş    SEL.SUB = FEED.REC<4>ş    ITEM.SUB = FEED.REC<5>ş    READ INNER.TEMPLATE FROM F.WEB.FORMS, "rss_edit.html" ELSE INNER.TEMPLATE = "rss_edit.html missing"ş    IF action = "add" THENş      edit_id = '<input type="text" name="new_id" value="">'ş      id = "NEW"ş    END ELSEş      edit_id = idş    ENDş    CALL SWAP(INNER.TEMPLATE,'<!-- feed_id -->',id)ş    CALL SWAP(INNER.TEMPLATE,'<!-- edit_feed_id -->',edit_id)ş    CALL SWAP(INNER.TEMPLATE,'<!-- feed_name -->',FEED.NAME)ş    CALL SWAP(INNER.TEMPLATE,'<!-- feed_desc -->',FEED.DESC)ş    CALL SWAP(INNER.TEMPLATE,'<!-- sel_sub -->',SEL.SUB)ş    CALL SWAP(INNER.TEMPLATE,'<!-- item_sub -->',ITEM.SUB)ş    *ş    SEL.SUB.MSG = '' ; ITEM.SUB.MSG = ''ş    IF SEL.SUB # "" THENş      READ TST FROM F.MD, SEL.SUB ELSEş        SEL.SUB.MSG = 'Not Cataloged'ş      ENDş    ENDş    IF ITEM.SUB # "" THENş      READ TST FROM F.MD, ITEM.SUB ELSEş        ITEM.SUB.MSG = 'Not Cataloged'ş      ENDş    ENDş    CALL SWAP(INNER.TEMPLATE,'<!-- sel_sub_msg -->',SEL.SUB.MSG)ş    CALL SWAP(INNER.TEMPLATE,'<!-- item_sub_msg -->',ITEM.SUB.MSG)ş    *ş    FEED.MODE.NAMES = FEED.REC<6>ş    FEED.MODE.PARAMS = FEED.REC<7>ş    FEED.MODES = ""ş    FOR N = 1 TO DCOUNT( FEED.MODE.NAMES<1>, @VM )ş      FEED.MODES<-1> = FEED.MODE.NAMES<1,N>:',':FEED.MODE.PARAMS<1,N>ş    NEXT Nş    CALL SWAP(FEED.MODES,@AM,CRLF)ş    CALL SWAP(INNER.TEMPLATE,'<!-- feed_modes -->',FEED.MODES)ş    HTML = INNER.TEMPLATEş  CASE action = "delete" AND id # ""ş    DELETE F.RSS.FEEDS, idş    GOSUB LOAD.FEEDSş  CASE action = "save" AND id # ""ş    FEED.REC = ""ş    LOCATE "feed_name" IN CGI$VARS SETTING POS THENş      name = CGI$VALS<POS>ş    END ELSE name = ""ş    LOCATE "feed_desc" IN CGI$VARS SETTING POS THENş      desc = CGI$VALS<POS>ş    END ELSE desc = ""ş    CONVERT CHAR(13) TO "" IN descş    CALL SWAP(desc,CHAR(10),'<br />')ş    LOCATE "sel_sub" IN CGI$VARS SETTING POS THENş      sel_sub = CGI$VALS<POS>ş    END ELSE sel_sub = ""ş    LOCATE "item_sub" IN CGI$VARS SETTING POS THENş      item_sub = CGI$VALS<POS>ş    END ELSE item_sub = ""ş    FEED.REC<1> = nameş    FEED.REC<3> = descş    FEED.REC<4> = sel_subş    FEED.REC<5> = item_subş    LOCATE "feed_modes" IN CGI$VARS SETTING POS THENş      feed_modes = CGI$VALS<POS>ş    END ELSE feed.modes = ""ş    CONVERT CHAR(13) TO "" IN feed_modesş    CONVERT CHAR(10) TO @AM IN feed_modesş    FOR N = 1 TO DCOUNT( feed_modes, @AM )ş      IF TRIM( feed_modes<N> ) # "" THENş        FEED.REC<6,N> = TRIM( FIELD( feed_modes<N>, ',',  1 ) )ş        FEED.REC<7,N> = TRIM( FIELD( feed_modes<N>, ',',  2 ) )ş      ENDş    NEXT Nş    IF id = "NEW" THENş      LOCATE "new_id" IN CGI$VARS SETTING POS THENş        id = CGI$VALS<POS>ş      ENDş      IF id = "NEW" THEN id="NEW1"ş    ENDş    IF id # "" THENş      WRITE FEED.REC ON F.RSS.FEEDS, idş    ENDş    GOSUB LOAD.FEEDSş  CASE 1 ; * Action = list (default)ş    GOSUB LOAD.FEEDSşEND CASEş*şREAD ADMIN.TEMPLATE FROM F.WEB.FORMS, "rss_admin_template.html" ELSE ADMIN.TEMPLATE = "rss_admin_template.html not found."şCALL SWAP(ADMIN.TEMPLATE,'<!--CHARACTER_SET-->',SITE$CHARSET)şHEADER = '<div id="dashboard_nav">'şHEADER := '<ol class="dashboard_list">'şHEADER := '<li><a href="':CGI$PATH:'/MVDB.ADMIN?action=users">Users</a></li>'şHEADER := '<li><a href="':CGI$PATH:'/MVDB.ADMIN?action=widgets">Widgets</a></li>'şHEADER := '<li><a href="':CGI$PATH:'/MVDB.ADMIN?action=dashboards">Dashboards</a></li>'şHEADER := '<li class="db_active"><a href="':CGI$PATH:'/RSS.MAINT">RSS Feed Maintenance</a></li>'şOPEN 'MVPKG.DATA' TO F.MVPKG.DATA THENş  HEADER := '<li><a href="':CGI$PATH:'/MVPKG.MAIN">Package Manager</a></li>'şENDşHEADER := '<li><a href="':CGI$PATH:'/MVDB.MAIN">Return to Dashboard</a></li>'şHEADER := '</ol>'şHEADER := '</div>'şCALL SWAP(ADMIN.TEMPLATE,'<!-- HEADER -->',HEADER)şFOOTER = ''şCALL SWAP(ADMIN.TEMPLATE,'<!-- FOOTER -->',FOOTER)şCALL SWAP(ADMIN.TEMPLATE,'<!-- ADMIN_MAIN -->',HTML)şCALL SWAP(ADMIN.TEMPLATE,'<!-- SITE_LOGO -->',SITE.LOGO)şCALL SWAP(ADMIN.TEMPLATE,'<!-- SITE_THEME -->',THEME.CSS)şCALL WEB.SEND(ADMIN.TEMPLATE)şSTOPş*şLOAD.FEEDS: *ş*şHTML = '<table width="100%">'şHTML<-1> = '<tr><td colspan="6"><a href="" class="add-feed">Add a Feed</a></td></tr>'şHTML<-1> = '<tr><th>ID</th><th>Name</th><th>Feed URL</th><th>Sel SUB</th><th>Item SUB</th><th>Action</th></tr>'şşEXECUTE "SSELECT RSS.FEEDS BY NAME" CAPTURING JUNKşLOOPş  READNEXT FID ELSE EXITş  READ FEED.REC FROM F.RSS.FEEDS, FID ELSE CONTINUEş  FEED.NAME = FEED.REC<1>ş  CALL RSS.XML.ENCODE(FEED.NAME,"")ş  FEED.URL = "http://":CGI$SERVER.NAME:CGI$PATH:'/RSS.MAIN?feed=':FIDş  FEED.URL = '<a target="_blank" href="':FEED.URL:'">':FEED.URL:'</a>'ş  FEED.DESC = FEED.REC<3>ş  SEL.SUB = FEED.REC<4>ş  ITEM.SUB = FEED.REC<5>ş  URL.SEL.SUB = SEL.SUBş  URL.ITEM.SUB = ITEM.SUBş  CALL SUB.URL.ENCODE(URL.SEL.SUB)ş  CALL SUB.URL.ENCODE(URL.ITEM.SUB)ş  ROW = '<tr><td>':FID:'</td><td>':FEED.NAME:'</td><td>':FEED.URL:'</td><td><a href="/dbc/MVDB.WEB.ED?ed_file=RSS.BP&ed_item=':SEL.SUB:'" target="RSS.BP_':URL.SEL.SUB:'">':SEL.SUB:'</a></td><td><a href="/dbc/MVDB.WEB.ED?ed_file=RSS.BP&ed_item=':ITEM.SUB:'" target="RSS.BP_':URL.ITEM.SUB:'">':ITEM.SUB:'</a></td>'ş  ROW := \<td>\ş  IF FID = "FEEDS" THENş    ROW := '&nbsp;'ş  END ELSEş    FEED.MODE.NAMES = FEED.REC<6>ş    FEED.MODE.PARAMS = FEED.REC<7>ş    FEED.MODES = ""ş    FOR N = 1 TO DCOUNT( FEED.MODE.NAMES<1>, @VM )ş      FEED.MODES<-1> = FEED.MODE.NAMES<1,N>:',':FEED.MODE.PARAMS<1,N>ş    NEXT Nş    CALL SWAP(FEED.MODES,@AM,'\n')ş    CALL SWAP(FEED.MODES,'"','\"')ş    CALL SWAP(FEED.NAME,'"','\"')ş    CALL SWAP(FEED.DESC,'"','\"')ş    CALL SWAP(SEL.SUB,'"','\"')ş    CALL SWAP(ITEM.SUB,'"','\"')ş    ROW := \<a href="javascript:editFeed('\:FID:\','\:FEED.NAME:\','\:FEED.DESC:\','\:SEL.SUB:\','RSS.BP_\:URL.SEL.SUB:\','\:ITEM.SUB:\','RSS.BP_\:URL.ITEM.SUB:\','\:FEED.MODES:\');"><img title="Edit Feed" class="icon" src="/db/icons/feed_edit.png" /></a> &nbsp;\ş    ROW := \<a onClick="return confirm('DELETE: Are you sure?');" href="/dbc/RSS.MAINT?action=delete&id=\:FID:\"><img title="Delete Feed" class="icon" src="/db/icons/feed_delete.png" /></a>\ş  ENDş  ROW := '</td></tr>'ş  HTML<-1> = ROWşREPEATşHTML<-1> = '<tr><td colspan="6"><a href="" class="add-feed">Add a Feed</a></td></tr>'şHTML<-1> = '</table>'şRETURN0003F5VALIDATE.SESSIONş0c2SUBROUTINE VALIDATE.SESSION( FLAG )ş*ş* Copyright (C) 2003 Sierra Bravo Corporation, All Rights Reservedş*ş* Written By   : Michael Schmidt, Sierra Bravoş* Date Written : 11/7/2003ş* Description  : This program will validate the session.ş*             ş***************************************************************************ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD WWW.INCLUDEşEQU FALSE TO 0, TRUE TO 1şEQU AM TO CHAR(254), VM TO CHAR(253), SVM TO CHAR(252)şFLAG = FALSEşIF SESSION$ID # "" THENş  READ REC FROM F.WEB.SESSION, SESSION$ID THENş    SESSION.DATE = REC<3>    ş    SESSION.TIME = REC<4>ş    CURRENT.DATE = DATE()ş    CURRENT.TIME = TIME()ş    MAX.SECONDS = 86400; * Total number of seconds in a dayş    MAX.DIFF.AMOUNT = SESSION$TIME.OUT * 60 ; * Get the time in secondsş    CURRENT.TIME = ((CURRENT.DATE - SESSION.DATE) * MAX.SECONDS) + CURRENT.TIMEş    DIFF.TIME = CURRENT.TIME - SESSION.TIMEş    IF DIFF.TIME <= MAX.DIFF.AMOUNT THENş      FLAG = TRUEş    ENDş  ENDşENDş*şRETURNş*0002B5WEB.FLUSHş0c2SUBROUTINE WEB.FLUSHş**********************************************************************ş* Copyright (C) 2003 Sierra Bravo Corporation, All Rights Reservedş*ş* Written By   : Michael Schmidt, Sierra Bravo Corporationş* Date Written : 11/06/03ş* Description  : This program sets the calls SET.BUFFER(FALSE) then ş*                calls WEB.SEND("") if the SESSION$OUTPUT variablesş*                length is greater then 0.ş*              ş**********************************************************************ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD WWW.INCLUDEşEQU FALSE TO 0, TRUE TO 1ş*şCALL SET.BUFFER(FALSE)ş*IF LEN(SESSION$OUTBUF) > 0 THENş  CALL WEB.SEND("")ş*ENDş*şRETURNş*0006C9SET.BUFFERş0c2SUBROUTINE SET.BUFFER( B.VAL )ş**********************************************************************ş* Copyright (C) 2003 Sierra Bravo Corporation, All Rights Reservedş*ş* Written By   : Michael Schmidt, Sierra Bravo Corporationş* Date Written : 11/06/03ş* Updated by: Peter Schellenbach, Zumasysş* Date Updated : 11/30/17ş* Description  : This program sets the SESSION$OUTBUF.FLAG and optionallyş*                SESSION$OUTBUF.SIZE variables to enable or disableş*                buffering of output generated by WSEND. If bufferingş*                is enabled, be sure to call WFLUSH to flush the finalş*                buffer content.ş*ş*                B.VAL = 0 : disable bufferingş*                B.VAL = 1 : enable buffering using current buffer sizeş*                B.VAL > 1 : enable buffering and set buffer size toş*                            this value.ş*ş*                By default buffering is disabled. If buffering will beş*                used, call WSETBUFFER before the first call to WSEND.ş*                If the size of buffer content ever exceeds the bufferş*                size, the buffer is flushed to the client along withş*                any headers, and buffering is disabled.ş*              ş**********************************************************************şINCLUDE WBPD WWW.INCLUDEşEQU FALSE TO 0, TRUE TO 1ş*şIF NUM(B.VAL) AND B.VAL > 0 AND B.VAL <= 1000000 THENş  * Set buffer size and enable bufferingş  SESSION$OUTBUF.SIZE = B.VALş  SESSION$OUTBUF.FLAG = TRUEşEND ELSEş  * Enable or disable bufferingş  IF B.VAL # TRUE AND B.VAL # FALSE THENş    IF B.VAL = "" THENş      B.VAL = FALSEş    END ELSEş      B.VAL = TRUEş    ENDş  ENDş  SESSION$OUTBUF.FLAG = B.VALşENDşRETURNşEND000296SET.CONTENT.TYPEş0c2SUBROUTINE SET.CONTENT.TYPE( C.TYPE )ş**********************************************************************ş* Copyright (C) 2003 Sierra Bravo Corporation, All Rights Reservedş*ş* Written By   : Michael Schmidt, Sierra Bravo Corporationş* Date Written : 10/25/03ş* Description  : This program sets the SESSION$CONTENT.TYPE variable.ş*              ş**********************************************************************ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD WWW.INCLUDEş*şEQU FALSE TO 0, TRUE TO 1şEQU AM TO CHAR(254), VM TO CHAR(253), SVM TO CHAR(252)ş*şIF C.TYPE = "" THENş  C.TYPE = "text/html"şENDş*şSESSION$CONTENT.TYPE = C.TYPEş*şRETURNş*000DEEINIT.WWWş0c2**********************************************************************ş* Copyright (C) 2004 Sierra Bravo Corporation, All Rights Reservedş*ş* This software is the property of Sierra Bravo Corporation and mayş* not be duplicated or modified without the express written permissionş* of Sierra Bravo Corporation.ş*ş* Written By   : Michael Derheim, Sierra Bravo Corporationş* Description  : Initialize the standard WWW includes. Parse cookies, etc.ş*ş* Modified By: Peter Schellenbach, Zumasysş* Date: 06/12/2015ş* Description: Changed PROCREAD to use SENTENCE() in the ELSE clauseş*ş**********************************************************************ş**********************************************************************ş*                                                                    *  ş* 10-25-16 Peter Schellenbach                                        *ş*                                                                    *  ş***       THIS PROGRAM IS OBSOLETE AND IS NO LONGER USED! ***        *ş*                                                                    *  ş**********************************************************************ş**********************************************************************ş*ş*#MAKE# RL $OPTIONS D3ş*şINCLUDE WBPD WWW.INCLUDEş*şOPEN '','WEB.SESSION' TO F.WEB.SESSION ELSE STOP 201, 'WEB.SESSION'ş*şMAT WWW.INFO = ""ş*ş*PJS 06-12-15*PROCREAD TCL.LINE ELSE TCL.LINE = ''şPROCREAD TCL.LINE ELSE TCL.LINE = SENTENCE() ; *PJS 06-12-15*ş*şCGI$UNIQUE.ID = FIELD( TCL.LINE, ' ', 2)ş*ş* Populate the vars and valsş*şCALL WDB.VARS(VARS,VALS)şCGI$VARS = VARSşCGI$VALS = VALSş*şLOCATE "APPSVR_ID" IN CGI$VARS SETTING POS THENş  CGI$APPSVR.ID = CGI$VALS<POS>ş  CGI$VARS = DELETE( CGI$VARS, POS, 0, 0 )ş  CGI$VALS = DELETE( CGI$VALS, POS, 0, 0 )şEND ELSEş  CGI$APPSVR.ID = ""şENDş*ş* How many active users are online?ş*şSELECT F.WEB.SESSIONşUSER.COUNT = 0şLOOPş  READNEXT WSID ELSE EXITş  READ SREC FROM F.WEB.SESSION, WSID ELSE CONTINUEş  LOCATE "userid" IN SREC<1> SETTING UPOS THEN USER.COUNT += 1şREPEATşPRINT "Client-Count: ":USER.COUNTş*ş* Load the Cookie variables and valuiesşLOCATE 'HTTP_COOKIE' IN VARS SETTING POS THENş  CSTRING = VALS<POS>şEND ELSE CSTRING = ''ş*şCONVERT ';' TO @AM IN CSTRINGşNUM.COOKIES = DCOUNT(CSTRING, @AM)şFOR Y = 1 TO NUM.COOKIESş  CGI$CVARS<Y> = TRIM(FIELD(CSTRING<Y>,'=',1))ş  CGI$CVALS<Y> = CSTRING<Y>[(1+INDEX(CSTRING<Y>,'=',1)),99999]şNEXT Yş* Load the session ID if there is oneşCALL GET.SESSION.ID( SESSION$ID, VARS, VALS )şIF (SESSION$ID = '') THENş  CALL CREATE.SESSION(SESSION$ID)ş  CALL SET.COOKIE("sessionid=":SESSION$ID)şENDşSESSION$GLOBAL.DEBUG = 0şSESSION$DEBUG.TEXT = ''ş* Clear the out buffer and set some generic varsşSESSION$CONTENT.SENT = 0şOPEN '','WEB.SESSION' TO F.WEB.SESSION ELSE STOP 201, "WEB.SESSION"şOPEN '','WEB.FORMS' TO F.WEB.FORMS ELSE STOP 201, 'WEB.FORMS'ş*şLOCATE "HTTP_HOST" IN CGI$VARS SETTING POS THENş  CGI$SERVER.NAME = CGI$VALS<POS>şEND ELSE CGI$SERVER.NAME = ""şLOCATE "SERVER_PORT" IN CGI$VARS SETTING POS THENş  CGI$SERVER.PORT = CGI$VALS<POS>şEND ELSE CGI$SERVER.PORT = ""şIF CGI$SERVER.PORT = "" OR CGI$SERVER.PORT = "0" THENş  OPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL THENş    READV TCP.PORT FROM F.MVDB.CONTROL, 'MVDB.SETTINGS', 4 ELSE TCP.PORT = ""ş  ENDş  CGI$SERVER.PORT = TCP.PORTşENDşIF CGI$SERVER.PORT # "" THEN CGI$SERVER.NAME := ":":CGI$SERVER.PORTşLOCATE "SIMPLEWEB_HANDLER" IN CGI$VARS SETTING POS THENş  CGI$PATH = CGI$VALS<POS>ş  IF CGI$PATH[1,1] # "/" THEN CGI$PATH = "/":CGI$PATHşEND ELSE CGI$PATH = "/dbc"şSTOPş*şEND0058AEMV.DEBUGş0c2* WDEBUGş*ş* Debug REST Servicesş* Copyright (c) 2017 Zumasys Inc.ş* Rewritten by Peter Schellenbach, 10/18/2017ş*ş* Based on original version:ş*  Copyright (C) 2007 Sierra Bravo Corporation, All Rights Reservedş*  Written by: Luke Bucklin, Sierra Bravoş*  Date: Sometime, 2006-ishş*ş$OPTIONS TIME.MILLISECOND ;*UV*ş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD FI.WDB.DEBUGş*şCLR.SCR = @(-1)şCLR.EOS = @(-3)şMAX.LINES = SYSTEM(3) - 4şMAX.COLS = SYSTEM(2) - 1şIF MAX.LINES <= 0 OR CLR.SCR = '' OR CLR.EOS = '' THENş  MAX.LINES = 20ş  CLR.SCR = ''ş  CLR.EOS = ''ş  PRMPT.LINE = CHAR(13):CHAR(10)şEND ELSEş  PRMPT.LINE = @(0, MAX.LINES + 2):CLR.EOSşENDşPROMPT ''ş*şPRINT CLR.SCR:şPRINTşPRINT 'WDEBUG Web Request Degug Tool'şPRINTşPRINT 'The WDEBUG tool allows you to inspect, modify and re-run web requests.'şPRINT 'Whenever a request for a debuggable resource is processed by WDB.INIT,'şPRINT 'a debug record for the request is added to the WDB.DEBUG file. WDEBUG'şPRINT 'allows you to select a debug record, view the request details, edit the'şPRINT 'request variables, re-run the request and view the response.'şPRINTşPRINT 'To debug web requests for a resource, set attribute 7 of the WDB.RESOURCE'şPRINT 'record for the resource to 1, then issue the web request from the client'şPRINT 'browser or other agent. WDEBUG will show a list of recent web requests to'şPRINT 'select from.'şPRINTşPRINT 'Start WDEBUG with an active select list if you need to use special criteria'şPRINT 'to select the record(s) you need to debug.'şPRINTşPRINT 'Press <enter> to continue':şINPUT ANSş*şOPEN 'WDB.DEBUG' TO F.WDB.DEBUG ELSEş  PRINT 'The WDB.DEBUG data file is required to use WDEBUG. Default installations'ş  PRINT 'only create the dictionary for this file. Please create the data section'ş  PRINT 'to use WDEBUG: CREATE-FILE DATA WDB.DEBUG 101.'ş  STOPşENDş*şSESSION.FLAG = 0şOPEN 'WEB.SESSION' TO F.WEB.SESSION THEN SESSION.FLAG = 1 ;* can restore session when running debug reqestş*şEDITOR = ''şIDS = ''şNUM.IDS = 0şIF SYSTEM(11) THENş  LOOPş    READNEXT ID ELSE EXITş    READV X FROM F.WDB.DEBUG, ID, 1 THENş      IDS<-1> = IDş      NUM.IDS += 1ş    END ELSEş      PRINT ID:' not found in WDB.DEBUG!'ş    ENDş  REPEATşENDşUSE.SUPPLIED.LIST = (NUM.IDS > 0)ş*şLOOPş  IF NOT(USE.SUPPLIED.LIST) THENş* Select available WDB.DEBUG itemsş    CMND = 'SSELECT WDB.DEBUG WITH TYPE = "C" "R" BY-DSND DATE BY-DSND TIME'ş    EXECUTE CMND CAPTURING RESULTş    IF SYSTEM(11) = 0 THENş      PRINT "No items found."ş      STOPş    ENDş    IDS = ''ş    NUM.IDS = 0ş    LOOPş      READNEXT ID ELSE EXITş      IDS<-1> = IDş      NUM.IDS += 1ş    REPEATş  ENDş*ş  TOP = 0ş  LOOPş* Display page of itemsş    PRINT CLR.SCR:ş    PRINT "Ln Date. Time.... Path................ Remote Address...... Request ID........."ş    FOR CNTR = 1 TO MAX.LINES UNTIL CNTR + TOP > NUM.IDSş      DBG.ID = IDS<CNTR>ş      READ DBGREC FROM F.WDB.DEBUG, DBG.ID ELSE CONTINUEş      PATH.INFO = DBGREC<WDBG_PATH>ş      IF PATH.INFO = '' THEN PATH.INFO = DBGREC<WDBG_HANDLER>:'/':DBGREC<WDBG_RESOURCE>ş      PRINT CNTR "R#2 ":ş      PRINT OCONV(DBGREC<WDBG_DATE>, 'D0-') "L#5 ":ş      PRINT OCONV(DBGREC<WDBG_TIME>, 'MTS') "L#8 ":ş      PRINT PATH.INFO "L#20 ":ş      PRINT DBGREC<WDBG_REMOTE_ADDR> "L#20 ":ş      PRINT DBGREC<WDBG_REQUEST_ID>[1,20]ş    NEXT CNTRş    IF TOP + MAX.LINES > NUM.IDS THEN BOT = NUM.IDS ELSE BOT = TOP + MAX.LINESş    PRINT "Showing items ":(TOP + 1):"-":BOT:" of ":NUM.IDSş*ş    LOOPş      PRINT PRMPT.LINE:"Command: (Q)uit (R)efresh (C)lear (N)ext (P)rev (##) Line to debug: ":ş      INPUT COMMANDş      IF COMMAND MATCHES '1N0N' THENş        IF COMMAND >= 1 AND COMMAND <= MAX.LINES AND COMMAND + TOP <= NUM.IDS THENş          DBG.ID = IDS<COMMAND + TOP>ş          GOSUB debug.requestş        ENDş        COMMAND = ''ş      END ELSEş        COMMAND = OCONV(COMMAND[1,1], 'MCU')ş        IF COMMAND = '' THEN COMMAND = 'N'ş        IF INDEX('ERCNPQ', COMMAND, 1) = 0 THEN COMMAND = ''ş      ENDş    WHILE COMMAND = '' DO REPEATş*ş    BEGIN CASEş      CASE COMMAND = 'N'ş        IF TOP + MAX.LINES < NUM.IDS THEN TOP += MAX.LINESş      CASE COMMAND = 'P'ş        IF TOP - MAX.LINES >= 0 THEN TOP -= MAX.LINESş    END CASEş  WHILE COMMAND = 'N' OR COMMAND = 'P' DO REPEATş*şUNTIL COMMAND = 'Q' DOş  BEGIN CASEş    CASE COMMAND = 'R' ; NULLş    CASE COMMAND = 'C'ş      EXECUTE 'SELECT WDB.DEBUG WITH TYPE = "C" "R"'ş      PRINT 'Are you sure you want to clear these items from the WDB.DEBUG file? ':ş      INPUT ANSş      ANS = OCONV(ANS[1,1],'MCU')ş      IF ANS = 'Y' THENş        IF SYSTEM(11) THENş          LOOPş            READNEXT ID ELSE EXITş            DELETE F.WDB.DEBUG, IDş          REPEATş        ENDş      END ELSEş        CLEARSELECTş      ENDş  END CASEşREPEATşSTOPş*ş*----------şdebug.request:ş*----------ş*şREAD DBGREC FROM F.WDB.DEBUG, DBG.ID ELSEş  PRINT "The selected item '":DBG.ID:"' is not available!"ş  PRINTş  PRINT 'Press <enter> to continue':ş  INPUT ANSş  RETURNşENDşEDIT.ID = 'D':DBG.ID[2, LEN(DBG.ID)]şLOOPş  PRINT PRMPT.LINE:"Debugging ":DBG.ID[1,28]:" - command: (Q)uit (V)iew (E)dit (R)un: ":ş  INPUT COMMANDş  COMMAND = OCONV(COMMAND[1,1], 'MCU')şUNTIL COMMAND = 'Q' DOş  BEGIN CASEş    CASE COMMAND = 'V'ş      GOSUB view.requestş    CASE COMMAND = 'E'ş      GOSUB edit.requestş    CASE COMMAND = 'R'ş      GOSUB run.requestş  END CASEşREPEATşRETURNş*ş*----------şview.request:ş*----------ş*şIF DBGREC = '' THENş  PRINT 'No debug info is available for this request!'ş  PRINTş  PRINT 'Press <enter> to continue':ş  INPUT ANSş  RETURNşENDşGOSUB to.editşNUM.LNS = DCOUNT(EDIT.REC, @AM)şI = 1şLOOP WHILE I <= NUM.LNS DOş  X = EDIT.REC<I>ş  IF LEN(X) > MAX.COLS THENş    X = FOLD(X, MAX.COLS)ş    EDIT.REC<I> = Xş    N = COUNT(X, @AM)ş    NUM.LNS += Nş    I += Nş  ENDş  I += 1şREPEATşIF NUM.LNS = 0 THEN NUM.LNS = 1şNUM.PGS = INT((NUM.LNS - 1) / MAX.LINES) + 1şCUR.PG = 1şLOOPş  PG.TOP = (CUR.PG - 1) * MAX.LINESş  IF PG.TOP + MAX.LINES > NUM.LNS THEN LPP = NUM.LNS - PG.TOP ELSE LPP = MAX.LINESş  PRINT CLR.SCR:ş  PRINT 'Page ':CUR.PG:' of ':NUM.PGS:SPACE(10):DBG.IDş  PRINTş  FOR I = 1 TO LPPş    PRINT EDIT.REC<I + PG.TOP>ş  NEXT Iş  PRINT PRMPT.LINE:'Command: (Q)uit (N)ext (P)rev (##) Goto page ':ş  INPUT COMMANDş  IF COMMAND MATCHES '1N0N' THENş    IF COMMAND >= 1 AND COMMAND <= NUM.PGS THEN CUR.PG = COMMANDş  END ELSEş    COMMAND = OCONV(COMMAND[1,1], 'MCU')ş  ENDşUNTIL COMMAND = 'Q' DOş  BEGIN CASEş    CASE COMMAND = 'N' OR COMMAND = ''ş      IF CUR.PG < NUM.PGS THEN CUR.PG = CUR.PG + 1ş    CASE COMMAND = 'P'ş      IF CUR.PG > 1 THEN CUR.PG = CUR.PG - 1ş  END CASEşREPEATşRETURNş*ş*----------şedit.request:ş*----------ş*şIF EDITOR = '' THEN GOSUB choose.editorşIF EDITOR <> '' THENş  EDIT.ID = 'D':DBG.IDş  GOSUB to.editş  WRITE EDIT.REC ON F.WDB.DEBUG, EDIT.IDş  CMND = EDITOR:' WDB.DEBUG ':EDIT.IDş  EXECUTE CMNDş  READ EDIT.REC FROM F.WDB.DEBUG, EDIT.ID ELSE NULLş  DELETE F.WDB.DEBUG, EDIT.IDş  GOSUB from.editşENDşRETURNş*ş*----------şrun.request:ş*----------ş*şIF DBGREC = '' THENş  PRINT 'No debug info is available for this request!'ş  PRINTş  PRINT 'Press <enter> to continue':ş  INPUT ANSş  RETURNşENDş*şHANDLER.NAME = DBGREC<WDBG_HANDLER>şRESOURCE.NAME = DBGREC<WDBG_RESOURCE>ş* Reconstruct query stringşQSTR = ''şQSEP = ''ş* headers and server variablesşN = DCOUNT(DBGREC<WDBG_HEADER_VARS>, @VM)şFOR I = 1 TO Nş  HDR.VAR = DBGREC<WDBG_HEADER_VARS, I>ş  URLENCODE.STRING = DBGREC<WDBG_HEADER_VALS, I>ş  GOSUB url.encodeş  QSTR := QSEP:HDR.VAR:'=':NEW.STRINGş  QSEP = '&'şNEXT Iş* form variablesşN = DCOUNT(DBGREC<WDBG_CGI_VARS>, @VM)şFOR I = 1 TO Nş  HDR.VAR = DBGREC<WDBG_CGI_VARS, I>ş  URLENCODE.STRING = DBGREC<WDBG_CGI_VALS, I>ş  GOSUB url.encodeş  QSTR := QSEP:HDR.VAR:'=':NEW.STRINGş  QSEP = '&'şNEXT Iş* bodyşTHE.BODY = DBGREC<WDBG_BODY>şIF THE.BODY <> '' THENş  URLENCODE.STRING = CHANGE(THE.BODY, @VM, CHAR(10))ş  GOSUB url.encodeş  QSTR := QSEP:'__body__=':NEW.STRINGşENDş* restore session stateşIF SESSION.FLAG THENş  SESSION.ID = DBGREC<WDBG_SESSION_ID>ş  IF SESSION.ID <> '' THENş    SESSION.REC = ''ş    SESSION.REC<1> = DBGREC<WDBG_SESSION_VARS>ş    SESSION.REC<2> = DBGREC<WDBG_SESSION_VALS>ş    SESSION.REC<3> = DBGREC<WDBG_SESSION_DATE>ş    SESSION.REC<4> = DBGREC<WDBG_SESSION_TIME>ş    WRITE SESSION.REC ON F.WEB.SESSION, SESSION.IDş  ENDşENDş* break the query string into 1000 byte chunksşN = INT((LEN(QSTR) - 1) / 1000) + 1ş* build the command lineşRUN.ID = DBGREC<WDBG_REQUEST_ID>şCMND = 'WDB.INIT ':HANDLER.NAME:'/':RESOURCE.NAME:' ':RUN.ID:'-1-':N:' %% _WDEBUG_MODE_'ş*ş* run the commandşPRINTşPRINT 'Executing the request: ':CMNDşPRINTşMAT WWW.INFO = ""şEXECSTART = SYSTEM(12)ş* send query string as stacked inputşFOR I = 1 TO Nş  DATA QSTR[((I - 1) * 1000) + 1, 1000]şNEXT IşEXECUTE CMND CAPTURING RESPONSEşEXECDUR = SYSTEM(12) - EXECSTARTşPRINT 'Request complete. Press <enter> to parse results':şINPUT ANSş*ş* update the request runtimeşDBGREC<WDBG_DATE> = DATE()şDBGREC<WDBG_TIME> = TIME()şDBGREC<WDBG_DURATION> = EXECDURş* process the responseşLINT.BEFORE = ''şLINT.AFTER = ''şWARN = ''şERR = ''ş* Gather lint from before the start tag and after the complete tagşDBGREC<WDBG_WARNING> = '' ;* WarningsşDBGREC<WDBG_ERROR> = '' ;* ErrorsşDBGREC<WDBG_LINT> = '' ;* LintşIF RESPONSE<1> = "700 WDB-START" THENş  RESPONSE = DELETE(RESPONSE, 1)şEND ELSEş  TAG = @AM:"700 WDB-START":@AMş  TAG.POS = INDEX(RESPONSE, TAG, 1)ş  IF TAG.POS = 0 THENş    WARN = '700 WDB-START tag is missing from response'ş    LINT.BEFORE = RESPONSEş    RESPONSE = ''ş  END ELSEş    IF TAG.POS >= 1 THENş      LINT.BEFORE = RESPONSE[1, TAG.POS - 1]ş      RESPONSE = RESPONSE[TAG.POS + LEN(TAG), LEN(RESPONSE)]ş    ENDş  ENDşENDşN = DCOUNT(RESPONSE, @AM)şIF RESPONSE<N> = "800 WDB-COMPLETE" THENş  RESPONSE = DELETE(RESPONSE, N)şEND ELSEş  TAG = @AM:"800 WDB-COMPLETE":@AMş  TAG.POS = INDEX(RESPONSE, TAG, 1)ş  IF TAG.POS = 0 THENş    WARN = '800 WDB-COMPLETE tag missing from response!'ş  END ELSEş    LINT.AFTER = RESPONSE[TAG.POS + LEN(TAG), LEN(RESPONSE)]ş    RESPONSE = RESPONSE[1, TAG.POS - 1]ş  ENDşENDş* Clean up lintşIF TRIM(CHANGE(LINT.BEFORE, @AM, '')) = '' THEN LINT.BEFORE = ''şIF TRIM(CHANGE(LINT.AFTER, @AM, '')) = '' THEN LINT.AFTER = ''şIF LINT.BEFORE <> '' OR LINT.AFTER <> '' THENş  LINT = LINT.BEFOREş  IF LINT.BEFORE <> '' AND LINT.AFTER <> '' THEN LINT := @AM:'...':@AMş  LINT := LINT.AFTERş  DBGREC<WDBG_LINT> = LOWER(LINT)şENDş* Parse the response headersşDBGREC<WDBG_RESPONSE_VARS> = ''şDBGREC<WDBG_RESPONSE_VALS> = ''şDBGREC<WDBG_RESPONSE_CONTENT> = ''şNUM.VARS = 0şSTATUS.CODE = ''şEOH = INDEX(RESPONSE, @AM:@AM, 1) ;* headers end at first blank line in responseşIF EOH = 0 THEN EOH = LEN(RESPONSE) + 1şN = DCOUNT(RESPONSE[1, EOH - 1], @AM)şFOR I = 1 TO Nş  HDR.LINE = RESPONSE<I>ş  IF HDR.LINE[1,10] = '500 ERROR ' THENş    ERR = HDR.LINE[11, LEN(HDR.LINE)]ş    IF STATUS.CODE = '' THEN STATUS.CODE = 500ş  END ELSEş    HDR.VAR = FIELD(HDR.LINE, ':', 1)ş    HDR.VAL = TRIMF(HDR.LINE[COL2() + 1, LEN(HDR.LINE)])ş    M = LEN(HDR.VAR)ş    FOR J = 1 TO Mş      IF NOT(HDR.VAR[J,1] MATCHES '1A') AND HDR.VAR[J,1] <> '-' THENş        HDR.VAR = ''ş        EXITş      ENDş    NEXT Jş    IF HDR.LINE[LEN(HDR.VAR) + 1, 1] <> ':' THEN HDR.VAR = ''ş    IF HDR.VAR = '' THENş      NUM.VARS += 1ş      DBGREC<WDBG_RESPONSE_VARS, NUM.VARS> = '_BAD_'ş      DBGREC<WDBG_RESPONSE_VALS, NUM.VARS> = HDR.LINE ;* invalid header line!ş    END ELSEş      IF HDR.VAR = 'X-MVDB-STATUS' THENş        STATUS.CODE = HDR.VALş      END ELSEş        NUM.VARS += 1ş        DBGREC<WDBG_RESPONSE_VARS, NUM.VARS> = HDR.VARş        DBGREC<WDBG_RESPONSE_VALS, NUM.VARS> = HDR.VALş      ENDş    ENDş  ENDşNEXT IşIF STATUS.CODE = '' THEN STATUS.CODE = 200şDBGREC<WDBG_STATUS> = STATUS.CODEş* save response contentşIF EOH + 2 <= LEN(RESPONSE) THENş  DBGREC<WDBG_RESPONSE_CONTENT> = LOWER(RESPONSE[EOH + 2, LEN(RESPONSE)])şENDşDBGREC<WDBG_WARNING> = WARNşDBGREC<WDBG_ERROR> = ERRşRETURNş*ş*----------şto.edit:ş*----------ş*şEDIT.REC = ''şEDIT.REC<-1> = '[INFO] (do not edit this section)'şEDIT.REC<-1> = 'Date            = ':OCONV(DBGREC<WDBG_DATE>,'D4')şEDIT.REC<-1> = 'Time            = ':OCONV(DBGREC<WDBG_TIME>,'MTS')şEDIT.REC<-1> = 'Duration        = ':DBGREC<WDBG_DURATION>şEDIT.REC<-1> = 'Port            = ':DBGREC<WDBG_PORT>şEDIT.REC<-1> = 'Handler         = ':DBGREC<WDBG_HANDLER>şEDIT.REC<-1> = 'Resource        = ':DBGREC<WDBG_RESOURCE>şEDIT.REC<-1> = 'Controller      = ':DBGREC<WDBG_CONTROLLER>şEDIT.REC<-1> = 'Program         = ':DBGREC<WDBG_PROGRAM>şEDIT.REC<-1> = 'RequestID       = ':DBGREC<WDBG_REQUEST_ID>şEDIT.REC<-1> = 'Method          = ':DBGREC<WDBG_METHOD>şEDIT.REC<-1> = 'Path            = ':DBGREC<WDBG_PATH>şEDIT.REC<-1> = 'RemoteAddr      = ':DBGREC<WDBG_REMOTE_ADDR>şEDIT.REC<-1> = 'Status          = ':DBGREC<WDBG_STATUS>şIF DBGREC<WDBG_WARNING> <> '' THENş  EDIT.REC<-1> = 'WARNING: ':DBGREC<WDBG_WARNING>şENDşIF DBGREC<WDBG_ERROR> <> '' THENş  EDIT.REC<-1> = 'ERROR: ':DBGREC<WDBG_ERROR>şENDşIF DBGREC<WDBG_LINT> <> '' THENş  EDIT.REC<-1> = 'LINT:':@AM:RAISE(DBGREC<WDBG_LINT>)şENDş* Request headers and server variablesşEDIT.REC<-1> = @AM:'[HEADERS]'şN = DCOUNT(DBGREC<WDBG_HEADER_VARS>, @VM)şFOR I = 1 TO Nş  HDR.VAR = DBGREC<WDBG_HEADER_VARS, I>ş  HDR.VAL = DBGREC<WDBG_HEADER_VALS, I>ş  EDIT.REC<-1> = HDR.VAR:SPACE(16-LEN(HDR.VAR)):'= ':HDR.VALşNEXT Iş* Query string variablesşN = DCOUNT(DBGREC<WDBG_CGI_VARS>, @VM)şIF N > 0 THENş  EDIT.REC<-1> = @AM:'[VARS]'ş  FOR I = 1 TO Nş    CGI.VAR = DBGREC<WDBG_CGI_VARS, I>ş    CGI.VAL = DBGREC<WDBG_CGI_VALS, I>ş    EDIT.REC<-1> = CGI.VAR:SPACE(16-LEN(CGI.VAR)):'= ':CGI.VALş  NEXT IşENDş* CookiesşLOCATE 'HTTP_COOKIE' IN DBGREC<WDBG_HEADER_VARS> SETTING POS THENş  CSTRING = DBGREC<WDBG_HEADER_VALS, POS>şEND ELSE CSTRING = ''şCONVERT ';' TO @AM IN CSTRINGşN = DCOUNT(CSTRING, @AM)şIF N > 0 THENş  EDIT.REC<-1> = @AM:'[COOKIES]'ş  FOR I = 1 TO Nş    COOKIE.VAR = TRIM(FIELD(CSTRING<I>, '=', 1))ş    COOKIE.VAL = CSTRING<I>[COL2() + 1, 99999]ş    EDIT.REC<-1> = COOKIE.VAR:SPACE(16-LEN(COOKIE.VAR)):'= ':COOKIE.VALş  NEXT IşENDş* REST parametersşLOCATE 'PATH_INFO' IN DBGREC<WDBG_HEADER_VARS> SETTING POS THENş  PATH = DBGREC<WDBG_HEADER_VALS, POS>şEND ELSE PATH = ''şIF PATH[1,1] = '/' THEN PATH = PATH[2,9999]şN = DCOUNT(PATH, '/')şIF N > 0 THENş  EDIT.REC<-1> = @AM:'[PARAMS]'ş  FOR I = 3 TO Nş    PARAM.VAR = 'Param[':(I-2):']'ş    EDIT.REC<-1> = PARAM.VAR:SPACE(16-LEN(PARAM.VAR)):'= ':FIELD(PATH, '/', I)ş  NEXT IşENDş* Session variablesşIF SESSION.FLAG THENş  SESSION.ID = DBGREC<WDBG_SESSION_ID>ş  IF SESSION.ID <> '' THENş    N = DCOUNT(DBGREC<WDBG_SESSION_VARS>, @VM)ş    IF N > 0 THENş      EDIT.REC<-1> = @AM:'[SESSION]'ş      EDIT.REC<-1> = '_SessionID      = ':SESSION.IDş      IF DBGREC<WDBG_SESSION_DATE> <> '' THEN EDIT.REC<-1> = '_Date           = ':OCONV(DBGREC<20>, 'D4')ş      IF DBGREC<WDBG_SESSION_TIME> <> '' THEN EDIT.REC<-1> = '_Time           = ':OCONV(DBGREC<21>, 'MTS')ş      FOR I = 1 TO Nş        SESSION.VAR = DBGREC<WDBG_SESSION_VARS, I>ş        EDIT.REC<-1> = SESSION.VAR:SPACE(16-LEN(SESSION.VAR)):'= ':DBGREC<WDBG_SESSION_VALS, I>ş      NEXT Iş    ENDş  ENDşENDş* Request bodyşTHE.BODY = DBGREC<WDBG_BODY>şIF THE.BODY <> '' THENş  EDIT.REC<-1> = @AM:'[BODY]':@AM:RAISE(THE.BODY)şENDş* Response headersşN = DCOUNT(DBGREC<WDBG_RESPONSE_VARS>, @VM)şIF N > 0 THENş  EDIT.REC<-1> = @AM:'[RESPONSE_HEADERS]'ş  FOR I = 1 TO Nş    HDR.VAR = DBGREC<WDBG_RESPONSE_VARS, I>ş    HDR.VAL = DBGREC<WDBG_RESPONSE_VALS, I>ş    EDIT.REC<-1> = HDR.VAR:SPACE(16-LEN(HDR.VAR)):'= ':HDR.VALş  NEXT IşENDş* Response contentşTHE.CONTENT = DBGREC<WDBG_RESPONSE_CONTENT>şIF THE.CONTENT <> '' THENş  EDIT.REC<-1> = @AM:'[RESPONSE_CONTENT]':@AM:RAISE(THE.CONTENT)şENDş*şRETURNş*ş*----------şfrom.edit:ş*----------ş*şSESSION.ID = ''şHANDLER.NAME = DBGREC<WDBG_HANDLER>şRESOURCE.NAME = DBGREC<WDBG_RESOURCE>ş* If COOKIES section exists, rebuild HTTP_COOKIE headerşCOOKIES = ''şSECT = 'COOKIES'şGOSUB find.sectionşIF SECT.START > 0 THENş  FOR I = SECT.START + 1 TO SECT.ENDş    COOKIE = EDIT.REC<I>ş    IF COOKIE <> '' THENş      COOKIE.NAME = TRIM(FIELD(COOKIE, '=', 1))ş      COOKIE.VAL = TRIMF(COOKIE[COL2() + 1, LEN(COOKIE)])ş      COOKIES := COOKIE.NAME:'=':COOKIE.VAL:';'ş      IF OCONV(COOKIE.NAME, 'MCU') = 'SESSIONID' THEN SESSION.ID = COOKIE.VALş    ENDş  NEXT Iş  IF COOKIES[LEN(COOKIES), 1] = ';' THEN COOKIES = COOKIES[1, LEN(COOKIES) - 1]şENDş* If PARAMS section exists, rebuild PATH_INFO headerşPARAMS = ''şSECT = 'PARAMS'şGOSUB find.sectionşIF SECT.START > 0 THENş  PNUM = 1ş  FOR I = SECT.START + 1 TO SECT.ENDş    PARAM = EDIT.REC<I>ş    IF PARAM <> '' THENş      PARAM.NAME = TRIM(OCONV(FIELD(PARAM, '=', 1), 'MCU'))ş      PARAM.VAL = TRIMF(PARAM[COL2() + 1, LEN(PARAM)])ş      IF PARAM.NAME <> 'PARAM[':PNUM:']' THEN EXITş      PARAMS := '/':PARAM.VALş      PNUM += 1ş    ENDş  NEXT Iş  IF PARAMS <> '' THEN PARAMS = '/':HANDLER.NAME:'/':RESOURCE.NAME:PARAMS ;* handler & resource come before paramsşENDş* Get headers and server variablesşDBGREC<WDBG_HEADER_VARS> = ''şDBGREC<WDBG_HEADER_VALS> = ''şNUM.VARS = 0şSECT = 'HEADERS'şGOSUB find.sectionşIF SECT.START > 0 THENş  FOR I = SECT.START + 1 TO SECT.ENDş    VAR.LINE = EDIT.REC<I>ş    IF VAR.LINE <> '' THENş      VAR.NAME = TRIM(FIELD(VAR.LINE, '=', 1))ş      VAR.VAL = TRIMF(VAR.LINE[COL2() + 1, LEN(VAR.LINE)])ş* check for special headersş      BEGIN CASEş        CASE OCONV(VAR.NAME, 'MCU') = 'HTTP_COOKIE'ş          IF COOKIES <> '' THENş            VAR.VAL = COOKIESş          ENDş        CASE OCONV(VAR.NAME, 'MCU') = 'PATH_INFO'ş          IF PARAMS <> '' THENş            VAR.VAL = PARAMSş          ENDş          IF VAR.VAL[1,1] <> '/' THEN VAR.VAL = '/' : VAR.VALş          IF COUNT(VAR.VAL, '/') >= 2 THENş            HANDLER.NAME = FIELD(VAR.VAL, '/', 2)ş            RESOURCE.NAME = FIELD(VAR.VAL, '/', 3)ş          ENDş          DBGREC<WDBG_PATH> = VAR.VALş        CASE OCONV(VAR.NAME, 'MCU') = 'REQUEST_METHOD'ş          DBGREC<WDBG_METHOD> = VAR.VAL      ş        CASE OCONV(VAR.NAME, 'MCU') = 'REMOTE_ADDR'ş          DBGREC<WDBG_REMOTE_ADDR> = VAR.VALş      END CASEş      NUM.VARS += 1ş      DBGREC<WDBG_HEADER_VARS, NUM.VARS> = VAR.NAMEş      DBGREC<WDBG_HEADER_VALS, NUM.VARS> = VAR.VALş    ENDş  NEXT Iş  DBGREC<WDBG_HANDLER> = HANDLER.NAMEş  DBGREC<WDBG_RESOURCE> = RESOURCE.NAMEşENDş* Get form variablesşDBGREC<WDBG_CGI_VARS> = ''şDBGREC<WDBG_CGI_VALS> = ''şNUM.VARS = 0şSECT = 'VARS'şGOSUB find.sectionşIF SECT.START > 0 THENş  FOR I = SECT.START + 1 TO SECT.ENDş    VAR.LINE = EDIT.REC<I>ş    IF VAR.LINE <> '' THENş      VAR.NAME = TRIM(FIELD(VAR.LINE, '=', 1))ş      VAR.VAL = TRIMF(VAR.LINE[COL2() + 1, LEN(VAR.LINE)])ş      NUM.VARS += 1ş      DBGREC<WDBG_CGI_VARS, NUM.VARS> = VAR.NAMEş      DBGREC<WDBG_CGI_VALS, NUM.VARS> = VAR.VALş    ENDş  NEXT IşENDş* Get bodyşDBGREC<WDBG_BODY> = ''şSECT = 'BODY'şGOSUB find.sectionşIF SECT.START > 0 THENş  I = INDEX(EDIT.REC, @AM, SECT.START)ş  IF I > 0 THENş    I += 1ş    J = INDEX(EDIT.REC, @AM, SECT.END)ş    IF J = 0 THEN J = LEN(EDIT.REC) + 1 ELSE J -= 1ş    IF EDIT.REC[J - 1, 1] = @AM AND J > 1 THEN J -= 1ş    THE.BODY = EDIT.REC[I, J - I + 1]ş    DBGREC<WDBG_BODY> = LOWER(THE.BODY)ş  ENDşENDş* Get session stateşIF SESSION.FLAG AND SESSION.ID <> '' THENş  DBGREC<WDBG_SESSION_ID> = ''ş  DBGREC<WDBG_SESSION_VARS> = ''ş  DBGREC<WDBG_SESSION_VALS> = ''ş  DBGREC<WDBG_SESSION_DATE> = ''ş  DBGREC<WDBG_SESSION_TIME> = ''ş  NUM.VARS = 0ş  SECT = 'SESSION'ş  GOSUB find.sectionş  IF SECT.START > 0 THENş    FOR I = SECT.START + 1 TO SECT.ENDş      SESSION.LINE = EDIT.REC<I>ş      SESSION.VAR = TRIM(FIELD(SESSION.LINE, '=', 1))ş      SESSION.VAL = TRIMF(SESSION.LINE[COL2() + 1, LEN(SESSION.LINE)])ş      BEGIN CASEş        CASE SESSION.VAR = '_SessionID'ş          DBGREC<WDBG_SESSION_ID> = SESSION.VALş        CASE SESSION.VAR = '_Date'ş          DBGREC<WDBG_SESSION_DATE> = ICONV(SESSION.VAL, 'D')ş        CASE SESSION.VAR = '_Time'ş          DBGREC<WDBG_SESSION_TIME> = ICONV(SESSION.VAL, 'MTS')ş        CASE 1ş          NUM.VARS += 1ş          DBGREC<WDBG_SESSION_VARS, NUM.VARS> = SESSION.VARş          DBGREC<WDBG_SESSION_VALS, NUM.VARS> = SESSION.VALş      END CASEş    NEXT Iş  ENDşENDş* Get response headersşDBGREC<WDBG_RESPONSE_VARS> = ''şDBGREC<WDBG_RESPONSE_VALS> = ''şNUM.VARS = 0şSECT = 'RESPONSE_HEADERS'şGOSUB find.sectionşIF SECT.START > 0 THENş  FOR I = SECT.START + 1 TO SECT.ENDş    VAR.LINE = EDIT.REC<I>ş    IF VAR.LINE <> '' THENş      VAR.NAME = TRIM(FIELD(VAR.LINE, '=', 1))ş      VAR.VAL = TRIMF(VAR.LINE[COL2() + 1, LEN(VAR.LINE)])ş      NUM.VARS += 1ş      DBGREC<WDBG_RESPONSE_VARS, NUM.VARS> = VAR.NAMEş      DBGREC<WDBG_RESPONSE_VALS, NUM.VARS> = VAR.VALş    ENDş  NEXT IşENDş* Get response contentşDBGREC<WDBG_RESPONSE_CONTENT> = ''şSECT = 'RESPONSE_CONTENT'şGOSUB find.sectionşIF SECT.START > 0 THENş  I = INDEX(EDIT.REC, @AM, SECT.START)ş  IF I > 0 THENş    I += 1ş    J = INDEX(EDIT.REC, @AM, SECT.END)ş    IF J = 0 THEN J = LEN(EDIT.REC) + 1 ELSE J -= 1ş    IF EDIT.REC[J - 1, 1] = @AM AND J > 1 THEN J -= 1ş    THE.CONTENT = EDIT.REC[I, J - I + 1]ş    DBGREC<WDBG_RESPONSE_CONTENT> = LOWER(THE.CONTENT)ş  ENDşENDşRETURNş*ş*----------şchoose.editor:ş*----------ş*şPRINTşLOOPş  PRINT 'Select the editor you want to use: 1 = ED, 2 = other: ':ş  INPUT ANSşUNTIL ANS EQ '' DOş  BEGIN CASEş    CASE ANS = 1ş      EDITOR = 'ED'ş      EXITş    CASE ANS = 2ş      PRINT 'Enter the verb to invoke your editor: ':ş      INPUT TMPş      PRINT TMP:' OK?':ş      INPUT ANSş      ANS = OCONV(ANS[1,1], 'MCU')ş      IF ANS = 'Y' THENş        EDITOR = TMPş        EXITş      ENDş  END CASEşREPEATşRETURNş*ş*----------şfind.section:ş*----------ş*şSECT.START = -1şSECT.END = -1şTAG = @AM:'[':SECT:']':@AMşTAG.POS = INDEX(EDIT.REC, TAG, 1)şIF TAG.POS = 0 THEN RETURN ;* Section not foundşSECT.START = DCOUNT(EDIT.REC[1, TAG.POS], @AM)şSECT.END = DCOUNT(EDIT.REC, @AM)şFOR I = SECT.START + 1 TO SECT.ENDş  SECT.LN = EDIT.REC<I>ş  IF SECT.LN MATCHES '"["1A0A"]"' OR SECT.LN MATCHES '"["1A0A"_"1A0A"]"' THENş* beginning of next section is end of current sectionş    SECT.END = I - 1ş    EXITş  ENDşNEXT IşRETURNş*ş*----------şurl.encode:ş*----------ş*şNEW.STRING = ""şUE.LEN = LEN(URLENCODE.STRING)şFOR UEX = 1 TO UE.LENş  UE.CHR = URLENCODE.STRING[UEX,1]ş  UE.CVAL = SEQ(UE.CHR)ş  BEGIN CASEş    CASE UE.CVAL < 32; ENC.FLAG = 1   ;* control characterş    CASE UE.CVAL = 37 OR UE.CVAL = 38 OR UE.CVAL = 43 OR UE.CVAL = 61; ENC.FLAG = 1 ;* % & + =ş    CASE UE.CVAL = 127; ENC.FLAG = 1  ;* DEL control characterş    CASE UE.CVAL >= 252; ENC.FLAG = 1 ;* delimiter characterş    CASE 1 ; ENC.FLAG = 0ş  END CASEş  IF ENC.FLAG THENş    UE.CHR = "%":(OCONV(UE.CVAL,'MCDX') 'R%2')ş  ENDş  NEW.STRING := UE.CHRşNEXT UEXşRETURNş*şEND000FBDSUB.DEBUG.WIDGETş0c2    SUBROUTINE SUB.DEBUG.WIDGETş* @(#) SUB.DEBUG.WIDGET Ported to jBASE 17:00:17  08 JUL 2015ş*  The following variable names were convertedş*   PROG,LN,DATE,TIMEş* ş* 07-17-15 Peter Schellenbach - removed D3 runtime error code - if there is a way toş*   get UniVerse runtime errors, create new SUB.GET.RUNTIME.ERRORS subroutine and callş*   it to get the errors.ş*ş* 01-20-16 Peter Schellenbach - added code to insert extra widget info after runtime errors.ş*   Call new SUB.LOG.DEBUG.INFO in widget code to save extra widget info for display here.ş*ş    INCLUDE WBPD MVDB.INCLUDEş*ş    W$TYPE = "HTML"ş    W$TITLE = "Widget Debug: ":G$WIDGET.NAMEş    IF GLOBAL.INFO(90) = "FAIL" THENş        W$TITLE := " (Widget Failed)"ş    END ELSEş        W$TITLE := ' (Debug Mode)'ş    ENDş    W$WIDTH = 3     ;* Maybe we can track the last known width of this widgetş*ş    IF G$QUERYMODE THEN RETURNş*ş    OPEN '','WEB.FORMS' TO F.WEB.FORMS ELSEş        W$HTML.DATA = '<h2>Unable to open WEB.FORMS</h2>'ş        RETURNş    ENDş    READ W$HTML.DATA FROM F.WEB.FORMS, "widget_debug.html" ELSE W$HTML.DATA = "<h2>Error: widget_debug.html is missing.</h2>"ş*ş    WIDGET.SUB.NAME = GLOBAL.INFO(91)   ;* Set by MVDB.MAIN before re-assigning the subroutine name to this program.ş*ş    EDIT.LINK = ''ş    IF G$ADMIN.USER THENş* Add a link to edit the subroutineş        URL.SUBNAME = WIDGET.SUB.NAMEş        CALL SUB.URL.ENCODE(URL.SUBNAME)ş        EDIT.LINK = '<a href="/dbc/MVDB.WEB.ED?ed_file=MVDB.SUBS&ed_item=':URL.SUBNAME:'" target="MVDB.SUBS_':URL.SUBNAME:'">Edit Subroutine</a>'ş    ENDş*ş    UDINFO = ""ş    FOR UDPOS = 1 TO 100ş        IF WIDGET.USER.DATA(UDPOS) # "" THENş            UDINFO := '<tr><td>':UDPOS:'</td><td>':WIDGET.USER.DATA(UDPOS):'</td></tr>':CHAR(10)ş        ENDş    NEXT UDPOSş*ş    URL.WIDGET.NAME = G$WIDGET.NAMEş    CALL SUB.URL.ENCODE(URL.WIDGET.NAME)ş    IF GLOBAL.INFO(90) = "FAIL" THENş        DB.REASON = "<hr />This widget has been disabled for one of the following reasons:"ş        DB.REASON := '<ul><li>The widget subroutine has an error causing it to terminate unexpectedly.</li>'ş        DB.REASON := '<li>The page was refreshed or a new dashboard page was loaded before the widget subroutine finished running.</li>'ş        DB.REASON := '<li>The widget is running, but it is taking too long for it to finish.</li>'ş        DB.REASON := '<li>The widget subroutine encountered a system error and could not finish running.</li></ul>'ş        REMOVE.LINK = '<a href="/dbc/MVDB.MAIN?unfail_widget=':URL.WIDGET.NAME:'">click here</a>'ş        REMEDY =  "When the problem has been corrected, ":REMOVE.LINK:" to take this widget out of debug mode.<hr />"ş    END ELSEş        DB.REASON = ""ş        REMEDY = ""ş    ENDş*ş* Runtime errors?ş*ş    RE.INFO = ""ş    *PJS 07-17-15 Universe TODO: get runtime errors*ş    MAX.ERRS = 50ş    *TODO: CALL SUB.GET.RUNTIME.ERRORS(RE.INFO, '', WIDGET.SUB.NAME, MAX.ERRS, G$ADMIN.USER)ş    RE.INFO := CHAR(10): '</table>'ş    *ş    *PJS 01-20-16 Check for widget debug info and add to runtime errors section.ş    * To use this feature, widget code can call SUB.LOG.DEBUG.INFO with widgetş    * name and a message. The last 100 lines of message text are saved in WDB.DEBUGş    * for the widget and displayed here after runtime errors by the debug widget.ş    OPEN 'WDB.DEBUG' TO F.WDB.DEBUG THENş        READ EXTRA.INFO FROM F.WDB.DEBUG,G$WIDGET.NAME THENş            CALL SWAP(EXTRA.INFO,@AM,CHAR(10))ş            RE.INFO := '<pre>':CHAR(10):EXTRA.INFO:CHAR(10):'</pre>':CHAR(10)ş        ENDş    END ş    ş*ş    CALL SWAP(W$HTML.DATA,'<!-- WIDGET_NAME -->',G$WIDGET.NAME)ş    CALL SWAP(W$HTML.DATA,'<!-- WIDGET_SUB_NAME -->',WIDGET.SUB.NAME)ş    CALL SWAP(W$HTML.DATA,'<!-- WIDGET_EDIT_LINK -->',EDIT.LINK)ş    CALL SWAP(W$HTML.DATA,'<!-- DEBUG_REASON -->',DB.REASON)ş    CALL SWAP(W$HTML.DATA,'<!-- REMEDY -->',REMEDY)ş    CALL SWAP(W$HTML.DATA,'<!-- WIDGET_USER_DATA -->',UDINFO)ş    CALL SWAP(W$HTML.DATA,'<!-- RUNTIME_ERRORS -->',RE.INFO)ş    RETURN000474MVAPPS.STATUSş0c2*ş* Program: MVAPPS.STATUSş* Author: Luke Bucklin, Sierra Bravo Corporationş* Date: January 4, 2010ş* Purpose: Provide app status information to the mvappsvr config appş*şAPP.LIST = ""şAPP.CNT = 0şPRINT "MVAPPS START"şOPEN '','MVAPPS.INSTALLED' TO F.MVAPPS.INSTALLED THENş  EXECUTE 'SSELECT MVAPPS.INSTALLED' CAPTURING JUNKş  LOOPş    READNEXT ID ELSE EXITş    READ REC FROM F.MVAPPS.INSTALLED, ID THENş      APP.CNT += 1ş      APP.LIST<1,APP.CNT> = IDş      APP.LIST<2,APP.CNT> = REC<1>ş      APP.LIST<3,APP.CNT> = REC<2>ş      APP.LIST<4,APP.CNT> = REC<3>ş      APP.LIST<5,APP.CNT> = OCONV(REC<4>,'D2/')ş    ENDş  REPEATşENDşAPP.NAMES = APP.LIST<2>şCONVERT "|" TO "\" IN APP.NAMESşAPP.LIST<2> = APP.NAMESşPRINT "MVAPPS-VERSION: 1.0"şDATA "VERSION"şEXECUTE "APP.INSTALLER" CAPTURING AIVşLOCATE "Installer Version" IN AIV SETTING POS THENş  VNO = AIV<POS+1>şEND ELSE VNO = "?"şIF NOT(VNO MATCHES "1N0N'.'0X") THEN VNO = "?"şPRINT "INSTALLER-VERSION: ":VNOşPRINT 'APP-COUNT: ':APP.CNTşFOR N = 1 TO APP.CNTş  PRINT 'APP: ':APP.LIST<2,N>:",":APP.LIST<3,N>:",":APP.LIST<4,N>:",":APP.LIST<5,N>şNEXT NşPRINT "MVAPPS END"şSTOPşEND000789SUB.MVDB.FEATURESş0c2SUBROUTINE SUB.MVDB.FEATURES(USER.LIMIT,MAPS.ENABLED,FUSION.WIDGETS.ENABLED,WATERMARK)şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEş*ş*ş* Decipher the license dataş*şCDIGIT = CGI$APPSVR.ID[1,1]şLSEG1 = CGI$APPSVR.ID[2,5]şLSEG2 = CGI$APPSVR.ID[7,7]şLSEG3 = CGI$APPSVR.ID[14,8]şUID4 = CGI$UNIQUE.ID "R%4"şUID3 = UID4 "R%3"şUID2 = UID4 "R%2"şUIDL1 = UID4 "R%1"şUIDL2 = UID4[3,1]ş*şCHKVAL = 0şFOR N = 2 TO 21ş  CHKVAL += SEQ(CGI$APPSVR.ID[N,1])şNEXT NşCHKVAL = MOD(CHKVAL,16)ş*ş* SEGMENT 1: Extract license editionş*şSEG1 = OCONV(LSEG1,'MCXD')şSEG1 = SEG1 / (4*(UID4+1))şLICENSE.EDITION = SEG1-1ş*ş* SEGMENT 2: Extract user limitş*şSEG2 = OCONV(LSEG2,'MCXD')şSEG2 = SEG2 / (3*(UID3+1))şLICENSE.CNT = SEG2ş*ş* SEGMENT 3: Extract system idş*şSEG3 = OCONV(LSEG3,'MCXD')şSEG3 = SEG3 / (UIDL1 + UIDL2 + 2)şLICENSE.SYSID = SEG3ş*şWWW.INFO(46) = OCONV(CHKVAL,'MCDX'):'/':OCONV(LSEG3,'MCXD'):" / ":(UIDL1 + UIDL2 + 2):" = ":LICENSE.SYSIDşWWW.INFO(47) = LICENSE.CNT:'/':LICENSE.EDITIONşWWW.INFO(48) = LICENSE.SYSIDş*şUSER.LIMIT = LICENSE.CNTşMAPS.ENABLED = 0şFUSION.WIDGETS.ENABLED = 0şWATERMARK = ''şEDITION = ''şBEGIN CASEş  CASE LICENSE.EDITION = 1ş    FUSION.WIDGETS.ENABLED = 1ş    MAPS.ENABLED = 1ş    WATERMARK = 'Development Version'ş    EDITION = 'Development Edition'ş  CASE LICENSE.EDITION = 2 ş    EDITION = 'Standard Edition'ş  CASE LICENSE.EDITION = 3ş    FUSION.WIDGETS.ENABLED = 1ş    EDITION = 'Professional Edition'ş  CASE LICENSE.EDITION = 4ş    FUSION.WIDGETS.ENABLED = 1ş    MAPS.ENABLED = 1ş    EDITION = 'Enterprise Edition'ş  CASE LICENSE.EDITION = 5ş    FUSION.WIDGETS.ENABLED = 1ş    MAPS.ENABLED = 1ş    WATERMARK = 'Evaluation Version'ş    EDITION = 'Evaluation'ş  CASE 1ş    EDITION = 'Edition unavailable'şEND CASEş*ş*Populate globals for user referenceş*şG$LICENSE.COUNT = LICENSE.CNTşG$EDITION = EDITION ;*:' | ':CGI$APPSVR.ID:' | ':CGI$UNIQUE.IDşG$SYSTEM.ID = LICENSE.SYSIDş*şRETURN007424MVPKG.MAINş0c2* @(#) MVPKG.MAIN Ported to jBASE 17:00:17  08 JUL 2015ş* Copyright (C) 2010 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Dave Bucklin, Sierra Bravoş* Date: May, 2010ş* Description: Administration area of Bravo Dashboardş*ş*#MAKE# RL $OPTIONS D3ş    INCLUDE WBPD WWW.INCLUDEş    INCLUDE WBPD MVDB.INCLUDEş*UV INCLUDE WBPD MVPKG.INCLUDEş    INCLUDE WBPD FI.MVDB.WIDGETSş    INCLUDE WBPD FI.MVDB.DEFSş    INCLUDE WBPD FI.MVDB.WIDGET.TYPESş*ş    EQU TRUE TO 1, FALSE TO 0, AM TO CHAR(254), VM TO CHAR(253), SVM TO CHAR(252)ş*ş    OPEN '','MVPKG.DATA' TO F.MVPKG.DATA ELSE STOP 201, 'MVPKG.DATA'ş    OPEN '','MVDB.WIDGETS' TO F.MVDB.WIDGETS ELSE STOP 201, 'MVDB.WIDGETS'ş    OPEN '','MVDB.SUBS' TO F.MVDB.SUBS ELSE STOP 201, 'MVDB.SUBS'ş    OPEN '','MVDB.DEFS' TO F.MVDB.DEFS ELSE STOP 201, 'MVDB.DEFS'ş    OPEN '','MVDB.WIDGET.TYPES' TO F.MVDB.WIDGET.TYPES ELSE STOP 201, 'MVDB.WIDGET.TYPES'ş    OPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSE STOP 201, 'MVDB.CONTROL'ş    OPEN '','WEB.FORMS' TO F.WEB.FORMS ELSE STOP 201, 'WEB.FORMS'ş    OPEN '','MD' TO F.MD ELSEş        OPEN '','VOC' TO F.MD ELSE STOP 201, 'MD'ş    ENDş*ş    DIM PKG.REC(40)ş    DIM SITE$SETTINGS(100)ş    EQU SITE$AUTH.SUB     TO SITE$SETTINGS(1)ş    EQU SITE$NULL.PW.OK   TO SITE$SETTINGS(2)ş    EQU SITE$W.MAX.DUR    TO SITE$SETTINGS(3)ş    EQU SITE$TCP.PORT     TO SITE$SETTINGS(4)ş    EQU SITE$ALT.LOGO     TO SITE$SETTINGS(7)ş    EQU SITE$THEME        TO SITE$SETTINGS(8)ş    EQU SITE$CHARSET      TO SITE$SETTINGS(9)ş*ş    EQU STEP$WIDGETS TO 1ş    EQU STEP$DASHBOARDS TO 2ş    EQU STEP$ITEMS TO 3ş    EQU STEP$WEB.FILES TO 4ş    EQU STEP$SETTINGS TO 5ş    EQU STEP$SUMMARY TO 6ş*ş    MATREAD SITE$SETTINGS FROM F.MVDB.CONTROL, "MVDB.SETTINGS" ELSE MAT SITE$SETTINGS = ""ş    IF SITE$ALT.LOGO = '' THENş        SITE.LOGO = '/db/images/mv-logo.png'ş    END ELSEş        SITE.LOGO = SITE$ALT.LOGOş        IF NOT(INDEX(SITE.LOGO,'/',1)) THENş            SITE.LOGO = '/db/images/':SITE.LOGOş        ENDş    ENDş    IF SITE$THEME # '' THEN SITE$THEME = '<link rel="Stylesheet" href="/db/themes/':SITE$THEME:'" media="screen" type="text/css" />'ş    IF SITE$CHARSET = '' THEN SITE$CHARSET = 'UTF-8'ş*ş    CALL GET.SESSION.VAR("adminauth",adminauth)ş    CALL PUT.SESSION.VAR("dd_mode",0)ş    adminpass = ""ş    IF adminauth # 1 THENş        FORM = '<html><head><meta http-equiv="Refresh" content="0; url=/dbc/MVDB.MAIN" />'ş        FORM := '</head><body><p>Administrative priviledges are required. 'ş        FORM:= 'Please <a href="/dbc/MVDB.MAIN">log in</a>.</p></body></html>'ş        CALL WEB.SEND(FORM)ş        STOPş    ENDş*ş    HTML = ''ş    LOCATE "action" IN CGI$VARS SETTING POS THENş        action = CGI$VALS<POS>ş    END ELSE action = ""ş    LOCATE 'pkg_id' IN CGI$VARS SETTING POS THENş        PKG.ID = CGI$VALS<POS>ş    END ELSE PKG.ID = ''ş*ş    BEGIN CASEş    CASE action = 'rebuild'ş        MATREAD PKG.REC FROM F.MVPKG.DATA, PKG.ID THENş*translate this package definition into something usable by the package builderş            OPEN 'MAKE.FILE,':PKG.ID TO F.MAKE.FILE ELSEş                EXECUTE "CREATE-FILE DATA MAKE.FILE,":PKG.ID:" 11"ş                OPEN 'MAKE.FILE,':PKG.ID TO F.MAKE.FILE ELSE STOP 201, 'MAKE.FILE,':PKG.IDş            ENDş            CLEARFILE F.MAKE.FILEş*ş*Dashboardsş*ş            WIDGET.LIST = ''  ;*composite of dashboard and individual widgetsş            DB.LIST = ''ş            FILE.LIST = ''ş            DB.CNT = DCOUNT(PKG$DASHBOARDS<1>,VM)ş            FOR ON.DB = 1 TO DB.CNTş                IF PKG$DASHBOARDS.OVR<1,ON.DB> = 1 THEN LIST.POS = 2 ELSE LIST.POS = 1ş                IF PKG$DASHBOARDS.ADD<1,ON.DB> = 1 THENş*add the widgets from this dbş                    READV WIDGETS FROM F.MVDB.DEFS, PKG$DASHBOARDS<1,ON.DB>, 2 ELSE WIDGETS = ''ş                    WCNT = DCOUNT(WIDGETS<1>,VM)ş                    FOR ON.W = 1 TO WCNTş                        LOCATE WIDGETS<1,ON.W> IN WIDGET.LIST<LIST.POS> SETTING DUM ELSEş                            WIDGET.LIST = INSERT(WIDGET.LIST,LIST.POS,0,0,WIDGETS<1,ON.W>)ş                        ENDş                    NEXT ON.Wş                ENDş                DB.LIST<LIST.POS,-1> = PKG$DASHBOARDS<1,ON.DB>ş            NEXT ON.DBş*DB.LIST = PKG$DASHBOARDSş*CONVERT VM TO AM IN DB.LISTş*WRITE DB.LIST ON F.MAKE.FILE, 'DATA_MVDB.DEFS'ş            PKG.LIST = DB.LIST<1>ş            CONVERT VM TO AM IN PKG.LISTş            IF DCOUNT(PKG.LIST,AM) THENş                WRITE PKG.LIST ON F.MAKE.FILE, 'DATA_MVDB.DEFS'ş                FILE.LIST<-1> = 'MVDB.DEFS'ş            ENDş            O.PKG.LIST = DB.LIST<2>ş            CONVERT VM TO AM IN O.PKG.LISTş            IF DCOUNT(O.PKG.LIST,AM) THENş                WRITE O.PKG.LIST ON F.MAKE.FILE, 'DATA_O:MVDB.DEFS'ş                FILE.LIST<-1> = 'O:MVDD.DEFS'ş            ENDş*ş*Widget defs and subsş*ş            WCNT = DCOUNT(PKG$WIDGETS<1>,VM)ş            FOR ON.W = 1 TO WCNTş                IF PKG$WIDGETS.OVR<1,ON.DB> = 1 THEN LIST.POS = 2 ELSE LIST.POS = 1ş                LOCATE PKG$WIDGETS<1,ON.W> IN WIDGET.LIST<LIST.POS> SETTING DUM ELSEş                    WIDGET.LIST = INSERT(WIDGET.LIST,LIST.POS,0,0,WIDGETS<1,ON.W>)ş                ENDş            NEXT ON.Wş*WRITE WIDGET.LIST ON F.MAKE.FILE, 'DATA_MVDB.WIDGETS'ş            WGT.LIST = WIDGET.LIST<1>ş            CONVERT VM TO AM IN WGT.LISTş            IF DCOUNT(WGT.LIST,AM) THENş                WRITE WGT.LIST ON F.MAKE.FILE, 'DATA_MVDB.WIDGETS'ş                FILE.LIST<-1> = 'MVDB.WIDGETS'ş            ENDş            O.WGT.LIST = WIDGET.LIST<2>ş            CONVERT VM TO AM IN O.WGT.LISTş            IF DCOUNT(WGT.LIST,AM) THENş                WRITE O.WGT.LIST ON F.MAKE.FILE, 'DATA_O:MVDB.WIDGETS'ş                FILE.LIST<-1> = 'O:MVDB.WIDGETS'ş            ENDş*ş            COMPILE.COMMANDS = ''ş            SUB.LIST = ''ş            WCNT = DCOUNT(WIDGET.LIST,AM)ş            FOR ON.W = 1 TO WCNTş                READV SUB.NAME FROM F.MVDB.WIDGETS, WIDGET.LIST<ON.W>, 1 THENş                    LOCATE SUB.NAME IN SUB.LIST SETTING DUM ELSEş                        SUB.LIST = INSERT(SUB.LIST,1,0,0,SUB.NAME)ş                        IF PKG$COMPILE.OPT = 1 THENş                            COMPILE.COMMANDS<-1> = 'COMPILE MVDB.SUBS ':SUB.NAMEş                            IF PKG$FLASH.OPT = 1 THEN COMPILE.COMMANDS := " (O"ş                        ENDş                    ENDş                ENDş            NEXT ON.Wş            WRITE SUB.LIST ON F.MAKE.FILE, 'DATA_MVDB.SUBS'ş*ş*Additional files and itemsş*ş            FILE.CNT = DCOUNT(PKG$FILES<1>,VM)ş            FOR ON.FILE = 1 TO FILE.CNTş                FNAME = PKG$FILES<1,ON.FILE>ş                ITEM.LIST = ''ş                IF PKG$LIST<1,ON.FILE> # '' THENş                    EXECUTE 'GET-LIST ':PKG$LIST.FILE<1,ON.FILE>:' ':PKG$LIST<1,ON.FILE> CAPTURING JUNKş                    LOOPş                        READNEXT ID ELSE EXITş                        ITEM.LIST<-1> = IDş                    REPEATş                END ELSEş                    IF PKG$ITEMS<1,ON.FILE> = '*' THENş                        EXECUTE 'SELECT ':PKG$FILES.DICT<1,ON.FILE>:' ':PKG$FILES<1,ON.FILE> CAPTURING JUNKş                        LOOPş                            READNEXT ID ELSE EXITş                            ITEM.LIST<-1> = IDş                        REPEATş                    END ELSEş                        ITEM.LIST = PKG$ITEMS<1,ON.FILE>ş                        CONVERT SVM TO AM IN ITEM.LISTş                    ENDş                ENDş                IF PKG$FILES.OVR<1,ON.FILE> = 1 THEN FNAME = 'O:':FNAMEş                IF PKG$FILES.DICT<1,ON.FILE> = 'DICT' THENş                    WRITE ITEM.LIST ON F.MAKE.FILE, "DICT_":FNAMEş                END ELSEş                    WRITE ITEM.LIST ON F.MAKE.FILE, "DATA_":FNAMEş                ENDş                LOCATE FNAME IN FILE.LIST SETTING DUM ELSEş                    FILE.LIST<-1> = FNAMEş                ENDş            NEXT ON.FILEş*ş            WRITE FILE.LIST ON F.MAKE.FILE, 'FILE.LIST'ş*ş            PRE.COMMANDS = PKG$PRE.CMDş            CONVERT VM TO AM IN PRE.COMMANDSş            WRITE PRE.COMMANDS ON F.MAKE.FILE, 'PRE.COMMANDS'ş            POST.COMMANDS = PKG$POST.CMDş            CONVERT VM TO AM IN POST.COMMANDSş            POST.COMMANDS<-1> = COMPILE.COMMANDSş            WRITE POST.COMMANDS ON F.MAKE.FILE, 'POST.COMMANDS'ş*ş            CALL MVDB.BUILD.PACKAGE(PKG.ID,PATH,SIZE)ş            PKG$BUILD.TS = DATE() : TIME() "R%5"ş            PKG$BUILD.SEQ += 1ş            PKG$SIZE = SIZEş            PKG$PATH = PATHş            MATWRITE PKG.REC ON F.MVPKG.DATA, PKG.IDş        ENDş        GOSUB LOAD.PKGSş    CASE action = 'addfile'ş        LOCATE 'file_name' IN CGI$VARS SETTING POS THENş            FILE.NAME = CGI$VALS<POS>ş        END ELSE FILE.NAME = ''ş        LOCATE 'file_dict' IN CGI$VARS SETTING POS THENş            FILE.DICT = CGI$VALS<POS>ş        END ELSE FILE.DICT = ''ş        LOCATE 'file_ovr' IN CGI$VARS SETTING POS THENş            FILE.OVR = CGI$VALS<POS>ş        END ELSE FILE.OVR = ''ş        LOCATE 'list_file' IN CGI$VARS SETTING POS THENş            LIST.FILE = CGI$VALS<POS>ş        END ELSE LIST.FILE = ''ş        LOCATE 'list_name' IN CGI$VARS SETTING POS THENş            LIST.NAME = CGI$VALS<POS>ş        END ELSE LIST.NAME = ''ş        LOCATE 'items' IN CGI$VARS SETTING POS THENş            ITEMS = CGI$VALS<POS>ş            CONVERT ',' TO SVM IN ITEMSş        END ELSE ITEMS = ''ş        IF PKG.ID # '' AND FILE.NAME # '' AND ((LIST.NAME # '' AND LIST.FILE # '') OR ITEMS # '') THENş            MATREAD PKG.REC FROM F.MVPKG.DATA, PKG.ID THENş                ADD.POS = DCOUNT(PKG$FILES<1>,VM) + 1ş                PKG$FILES<1,ADD.POS> = FILE.NAMEş                PKG$FILES.DICT<1,ADD.POS> = FILE.DICTş                PKG$ITEMS<1,ADD.POS> = ITEMSş                PKG$LIST<1,ADD.POS> = LIST.NAMEş                PKG$LIST.FILE<1,ADD.POS> = LIST.FILEş*PKG$FILES.OVR<1,ADD.POS> = FILE.OVRş                DATA 'LIST ':FILE.DICT:' ':FILE.NAME:' TOTAL SIZE DET-SUPP'ş                IF LIST.NAME # '' THENş                    EXECUTE 'SELECT ':LIST.FILE:' ':LIST.NAME CAPTURING OUTPUTş                    END ELSE IF ITEMS = "*" THENş                        EXECUTE 'SELECT ':FILE.DICT:' ':FILE.NAME CAPTURING OUTPUTş                    END ELSEş                        ITEM.LIST = ITEMSş                        CALL SWAP(ITEM.LIST,SVM,'""')ş                        EXECUTE 'SELECT ':FILE.DICT:' ':FILE.NAME:' "':ITEM.LIST:'"' CAPTURING OUTPUTş                    ENDş                    PKG$FILES.SIZE<1,ADD.POS> = TRIM(OUTPUT<7>) + 0ş                    MATWRITE PKG.REC ON F.MVPKG.DATA, PKG.IDş                ENDş                GOSUB EDIT.PACKAGEş            END ELSEş                PRINT "Error 1"ş            ENDş        CASE action = 'edit'ş            MATREAD PKG.REC FROM F.MVPKG.DATA, PKG.ID THENş                GOSUB EDIT.PACKAGEş            ENDş        CASE action = 'save'ş            VAR.CNT = DCOUNT(CGI$VARS,AM)ş            MATREAD PKG.REC FROM F.MVPKG.DATA, PKG.ID ELSE MAT PKG.REC = ''ş*Clear these so we can rebuild them. We have the technology.ş            PKG$WIDGETS = ''ş            PKG$WIDGETS.OVR = ''ş            PKG$DASHBOARDS = ''ş            PKG$DASHBOARDS.OVR = ''ş            PKG$DASHBOARDS.ADD = ''ş            PKG$FILES.OVR = ''ş            PKG$WEB.IMAGE = ''ş            PKG$WEB.CSS = ''ş            PKG$WEB.JS = ''ş            PKG$WEB.ICON = ''ş            PKG$WEB.IMAGE.OVR = ''ş            PKG$WEB.CSS.OVR = ''ş            PKG$WEB.JS.OVR = ''ş            PKG$WEB.ICON.OVR = ''ş            WIDGET.ADD.POS = 1ş            DB.ADD.POS = 1ş            IMAGE.ADD.POS = 1ş            CSS.ADD.POS = 1ş            JS.ADD.POS = 1ş            ICON.ADD.POS = 1ş            FOR ON.VAR = 1 TO VAR.CNTş                THIS.VAR = CGI$VARS<ON.VAR>ş                THIS.VAL = CGI$VALS<ON.VAR>ş                BEGIN CASEş                CASE THIS.VAL = ''ş*Get widgetsş                CASE THIS.VAR[1,11] = 'widget_ovr_'ş                CASE THIS.VAR[1,7] = 'widget_'ş                    WIDGET.ID = THIS.VAR[8,99]ş                    OVR = 'widget_ovr_':WIDGET.IDş                    OVR.FLAG = 0ş                    LOCATE OVR IN CGI$VARS SETTING POS THENş                        OVR.FLAG = 1ş                    ENDş                    PKG$WIDGETS<1,WIDGET.ADD.POS> = WIDGET.IDş                    PKG$WIDGETS.OVR<1,WIDGET.ADD.POS> = OVR.FLAGş                    WIDGET.ADD.POS += 1ş*Get Dashboardsş                CASE THIS.VAR[1,10] = 'dashboard_'ş                    DB.ID = THIS.VAR[11,99]ş                    OVR = 'db_ovr_':DB.IDş                    ADD = 'db_add_':DB.IDş                    OVR.FLAG = 0; ADD.FLAG = 0ş                    LOCATE OVR IN CGI$VARS SETTING POS THENş                        OVR.FLAG = 1ş                    ENDş                    LOCATE ADD IN CGI$VARS SETTING POS THENş                        ADD.FLAG = 1ş                    ENDş                    PKG$DASHBOARDS<1,DB.ADD.POS> = DB.IDş                    PKG$DASHBOARDS.OVR<1,DB.ADD.POS> = OVR.FLAGş                    PKG$DASHBOARDS.ADD<1,DB.ADD.POS> = ADD.FLAGş                    DB.ADD.POS += 1ş*Get file overwite flagsş                CASE THIS.VAR[1,10] = 'files_ovr_'ş                    OVR.POS = FIELD(THIS.VAR,'_',3)ş                    PKG$FILES.OVR<1,OVR.POS> = 1ş*Get web filesş                CASE THIS.VAR = 'web_images'ş                    CALL SWAP(THIS.VAL,CHAR(13):CHAR(10),VM)ş                    PKG$WEB.IMAGE = TRIM(THIS.VAL,VM)ş                CASE THIS.VAR = 'web_icons'ş                    CALL SWAP(THIS.VAL,CHAR(13):CHAR(10),VM)ş                    PKG$WEB.ICON = TRIM(THIS.VAL,VM)ş                CASE THIS.VAR = 'web_css'ş                    CALL SWAP(THIS.VAL,CHAR(13):CHAR(10),VM)ş                    PKG$WEB.CSS = TRIM(THIS.VAL,VM)ş                CASE THIS.VAR = 'web_js'ş                    CALL SWAP(THIS.VAL,CHAR(13):CHAR(10),VM)ş                    PKG$WEB.JS = TRIM(THIS.VAL,VM)ş                END CASEş            NEXT ON.VARş*Get settingsş            LOCATE 'pkg_pre_cmd' IN CGI$VARS SETTING POS THENş                PKG$PRE.CMD = CGI$VALS<POS>ş                CALL SWAP(PKG$PRE.CMD,CHAR(13):CHAR(10),VM)ş            END ELSE PKG$PRE.CMD = ''ş            LOCATE 'pkg_post_cmd' IN CGI$VARS SETTING POS THENş                PKG$POST.CMD = CGI$VALS<POS>ş                CALL SWAP(PKG$POST.CMD,CHAR(13):CHAR(10),VM)ş            END ELSE PKG$POST.CMD = ''ş            LOCATE 'compile_opt' IN CGI$VARS SETTING POS THENş                PKG$COMPILE.OPT = 1ş            END ELSE PKG$COMPILE.OPT = 0ş            LOCATE 'flash_opt' IN CGI$VARS SETTING POS THENş                PKG$FLASH.OPT = 1ş            END ELSE PKG$FLASH.OPT = 1ş            LOCATE 'access_opt' IN CGI$VARS SETTING POS THENş                PKG$ACCESS.OPT = 1ş            END ELSE PKG$ACCESS.OPT = 0ş            LOCATE 'pkg_name' IN CGI$VARS SETTING POS THENş                PKG$NAME = CGI$VALS<POS>ş            ENDş            LOCATE 'pkg_desc' IN CGI$VARS SETTING POS THENş                PKG$DESC = CGI$VALS<POS>ş            ENDş            MATWRITE PKG.REC ON F.MVPKG.DATA, PKG.IDş            GOSUB LOAD.PKGSş        CASE action = 'delete'ş            DELETE F.MVPKG.DATA, PKG.IDş            EXECUTE 'DELETE-FILE MAKE.FILE,':PKG.ID CAPTURING JUNKş            GOSUB LOAD.PKGSş        CASE 1ş            GOSUB LOAD.PKGSş        END CASEş*ş        READ ADMIN.TEMPLATE FROM F.WEB.FORMS, "pkg_list_template.html" ELSE ADMIN.TEMPLATE = "pkg_list_template.html not found."ş        CALL SWAP(ADMIN.TEMPLATE,'<!--CHARACTER_SET-->',SITE$CHARSET)ş        HEADER = '<div id="dashboard_nav">'ş        HEADER := '<ol class="dashboard_list">'ş        HEADER := '<li><a href="':CGI$PATH:'/MVDB.ADMIN?action=users">Users</a></li>'ş        HEADER := '<li><a href="':CGI$PATH:'/MVDB.ADMIN?action=widgets">Widgets</a></li>'ş        HEADER := '<li><a href="':CGI$PATH:'/MVDB.ADMIN?action=dashboards">Dashboards</a></li>'ş        OPEN 'RSS.BP' TO F.RSS.BP THENş            HEADER := '<li><a href="':CGI$PATH:'/RSS.MAINT">RSS Feed Maintenance</a></li>'ş        ENDş        HEADER := '<li class="db_active"><a href="':CGI$PATH:'/RSS.MAINT">Package Manager</a></li>'ş        HEADER := '<li><a href="':CGI$PATH:'/MVDB.MAIN">Return to Dashboard</a></li>'ş        HEADER := '</ol>'ş        HEADER := '</div>'ş        CALL SWAP(ADMIN.TEMPLATE,'<!-- HEADER -->',HEADER)ş        FOOTER = ''ş        CALL SWAP(ADMIN.TEMPLATE,'<!-- FOOTER -->',FOOTER)ş        CALL SWAP(ADMIN.TEMPLATE,'<!-- ADMIN_MAIN -->',HTML)ş        CALL SWAP(ADMIN.TEMPLATE,'<!-- SITE_LOGO -->',SITE.LOGO)ş        CALL SWAP(ADMIN.TEMPLATE,'<!-- SITE_THEME -->',SITE$THEME)ş        CALL WEB.SEND(ADMIN.TEMPLATE)ş        STOPş*şLOAD.PKGS:ş*ş        HTML = '<table width="100%">'ş        HTML<-1> = '<tr><td colspan="6"><a href="':CGI$PATH:'/MVPKG.MAIN?action=editpkg" class="add-pkg">Add a Package</a></td></tr>'ş        HTML<-1> = '<tr><th>Package</th><th>Last Build</th><th>Size</th><th>Build#</th><th>Description</th><th>Action</th></tr>'ş        EXECUTE "SSELECT MVPKG.DATA BY NAME" CAPTURING JUNKş        LOOPş            READNEXT FID ELSE EXITş            MATREAD PKG.REC FROM F.MVPKG.DATA, FID ELSE CONTINUEş            IF PKG$SIZE # '' THENş                BEGIN CASEş                CASE PKG$SIZE >= PWR(10,9)ş                    PKG$SIZE = OCONV(PKG$SIZE,"MD29"):' GB'ş                CASE PKG$SIZE >= PWR(10,6)ş                    PKG$SIZE = OCONV(PKG$SIZE,"MD26"):' MB'ş                CASE PKG$SIZE >= PWR(10,3)ş                    PKG$SIZE = OCONV(PKG$SIZE,"MD23"):' kB'ş                CASE 1ş                    PKG$SIZE := ' bytes'ş                END CASEş            ENDş            BUILD.DATE = OCONV(PKG$BUILD.TS[1,5],"D2/")ş            BUILD.TIME = OCONV(PKG$BUILD.TS[6,5],"MTS")ş            ROW = '<tr><td>':PKG$NAME:'</td><td>':BUILD.DATE:' ':BUILD.TIME:'</td>'ş            ROW := '<td>':PKG$SIZE:'</td><td>':PKG$BUILD.SEQ:'</td><td>':PKG$DESC:'</td>'ş            ROW := '<td><a href="/dbc/MVPKG.MAIN?action=edit&pkg_id=':FID:'"><img src="/db/icons/brick_edit.png" title="Edit"></a> 'ş            ROW := \<a onClick="return confirm('DELETE: Are you sure?');" href="/dbc/MVPKG.MAIN?action=delete&pkg_id=\:FID:\"><img src="/db/icons/brick_delete.png" title="Delete"></a> \ş            ROW := '<a href="/dbc/MVPKG.MAIN?action=rebuild&pkg_id=':FID:'"><img src="/db/icons/brick_go.png" title="Rebuild"></a>'ş            ROW := '<a href="/dbc/MVPKG.MAIN?action=download&pkg_id=':FID:'"><img src="/db/icons/arrow_down.png" title="Download"></a></td></tr>'ş            HTML<-1> = ROWş        REPEATş        HTML<-1> = '<tr><td colspan="6"><a href="':CGI$PATH:'/MVPKG.MAIN?action=editpkg" class="add-pkg">Add a Package</a></td></tr>'ş        HTML<-1> = '</table>'ş        RETURNş*şEDIT.PACKAGE:ş        CALL MVDB.SUB.WIDGET.LIST(WIDGET.LIST)ş        HTML<-1> = '<form action="':CGI$PATH:'/MVPKG.MAIN" method="POST">'ş        HTML<-1> = 'Package Name: <input type="text" name="pkg_name" value="':PKG$NAME:'"><br/>'ş        HTML<-1> = 'Description: <input type="text" name="pkg_desc" value="':PKG$DESC:'"><br/>'ş        HTML<-1> = '<input type="hidden" name="action" value="save">'ş        HTML<-1> = '<input type="hidden" name="pkg_id" value="':PKG.ID:'">'ş        HTML<-1> = '<div id="submit"><input class="ui-state-default ui-corner-all" type="submit" value="Save" /></div> 'ş        HTML<-1> = '<div id="tabs"> 'ş        HTML<-1> = '<ul><li><a href="#tabs-1">Widgets</a></li>'ş        HTML<-1> = '<li><a href="#tabs-2">Dashboards</a></li>'ş        HTML<-1> = '<li><a href="#tabs-3">File Items</a></li>'ş        HTML<-1> = '<li><a href="#tabs-4">Web Files</a></li>'ş        HTML<-1> = '<li><a href="#tabs-5">Settings</a></li></ul>'ş        HTML<-1> = '<div id="tabs-1" class="tab_content">'ş*ş        HTML<-1> = '<table width="100%">'ş        HTML<-1> = '<tr><th>Selected</th><th>Widget</th><th>Type</th><th>Subroutine</th><th>Overwrite</th></tr>'ş        WIDGET.CNT = DCOUNT(WIDGET.LIST<1>,VM)ş        FOR W.POS = 1 TO WIDGET.CNTş            IF WIDGET.LIST<7,W.POS> = 1 THEN CLASS = 'error' ELSE CLASS = 'p'ş            LOCATE WIDGET.LIST<1,W.POS> IN PKG$WIDGETS<1> SETTING POS THENş                CHECKED = 'checked'ş            END ELSE CHECKED = ''ş            HTML<-1> = '<tr class="':CLASS:'"><td><input type="checkbox" name="widget_':WIDGET.LIST<1,W.POS>:'" value="checked" ':CHECKED:'></td>'ş            HTML := '<td>':WIDGET.LIST<1,W.POS>:'</td><td>':WIDGET.LIST<4,W.POS>:'</td><td>':WIDGET.LIST<3,W.POS>:'</td>'ş            IF PKG$WIDGETS.OVR<1,POS> = 1 THENş                CHECKED = 'checked'ş            END ELSE CHECKED = ''ş            HTML := '<td><input type="checkbox" name="widget_ovr_':WIDGET.LIST<1,W.POS>:'" value="checked" ':CHECKED:'></td></tr>'ş        NEXT W.POSş        HTML<-1> = '</table>'ş*ş        EXECUTE 'SSELECT MVDB.DEFS' CAPTURING JUNKş        HTML<-1> = '</div><!--#tabs-1-->'ş        HTML<-1> = '<div id="tabs-2" class="tab_content"> 'ş        HTML<-1> = '<table width="100%">'ş        HTML<-1> = '<tr><th>Selected</th><th>Dashboard ID</th><th>Description</th><th>Include Widgets</th><th>Overwrite</th></tr>'ş*ş        DB.POS = 1ş        LOOPş            READNEXT ID ELSE EXITş            MATREAD DB.ITEM FROM F.MVDB.DEFS, ID ELSE MAT DB.ITEM = ''ş            HTML<-1> = '<tr>'ş            LOCATE ID IN PKG$DASHBOARDS<1> SETTING POS THENş                CHECKED = 'checked'ş            END ELSE CHECKED = ''ş            HTML<-1> = '<td><input type="checkbox" name="dashboard_':ID:'" value="checked" ':CHECKED:'></td>'ş            HTML<-1> = '<td>':ID:'</td>'ş            HTML<-1> = '<td>':DB.DESC:'</td>'ş            ADD.CHECKED = ''; OVR.CHECKED = ''ş            IF CHECKED # '' THENş                IF PKG$DASHBOARDS.ADD<1,POS> = 1 THENş                    ADD.CHECKED = 'checked'ş                ENDş                IF PKG$DASHBOARDS.OVR<1,POS> = 1 THENş                    OVR.CHECKED = 'checked'ş                ENDş            ENDş*HTML<-1> = '<td><input type="checkbox" name="db_add_':ID:'" value="checked" ':ADD.CHECKED:'></td>'ş            HTML<-1> = '<td><input type="button" value="Add Widgets to Package"></td>'ş            HTML<-1> = '<td><input type="checkbox" name="db_ovr_':ID:'" value="checked" ':OVR.CHECKED:'></td>'ş            HTML<-1> = '</tr>'ş            DB.POS += 1ş        REPEATş        HTML<-1> = '</table>'ş*ş        HTML<-1> = '</div><!--#tabs-2-->'ş        HTML<-1> = '<div id="tabs-3" class="tab_content">'ş        HTML<-1> = '<table width="100%">'ş        HTML<-1> = '<tr><td colspan="5"><a href="/dbc/MVPKG.MAIN?action=addfile" class="add-file">Add a File</a></td></tr>'ş        HTML<-1> = '<tr><th>File Name</th><th>Items/List</th><th>Size</th><th>Overwrite</th><th>Action</th></tr>'ş        FILE.CNT = DCOUNT(PKG$FILES<1>,VM)ş        FOR ON.FILE = 1 TO FILE.CNTş            FILE.ERR = 0; ITEM.ERR = 0ş            OPEN PKG$FILES.DICT<1,ON.FILE>,PKG$FILES<1,ON.FILE> TO PKG.FILEVAR ELSE FILE.ERR = 1ş            HTML<-1> = '<tr><td 'ş            IF FILE.ERR THEN HTML := 'class="error"'ş            HTML := '>':PKG$FILES.DICT<1,ON.FILE>:' ':PKG$FILES<1,ON.FILE>:'</td>'ş            IF PKG$LIST<1,ON.FILE> # '' THENş                OPEN PKG$LIST.FILE<1,ON.FILE> TO LISTFILE THENş                    READV TST FROM LISTFILE, PKG$LIST<1,ON.FILE>, 1 ELSEş                        ITEM.ERR = 1ş                    ENDş                END ELSE ITEM.ERR = 1ş                HTML<-1> = '<td 'ş                IF ITEM.ERR THEN HTML := 'class="error"'ş                HTML := '>List: 'ş                IF PKG$LIST.FILE<1,ON.FILE> # '' THENş                    HTML := PKG$LIST.FILE:', 'ş                ENDş                HTML := PKG$LIST<1,ON.FILE>:'</td>'ş            END ELSEş                IF NOT(FILE.ERR = 1) THENş                    IF PKG$ITEMS<1,ON.FILE> # '*' THENş                        ITEM.CNT = DCOUNT(PKG$ITEMS<1,ON.FILE>,SVM)ş                        FOR ON.ITEM = 1 TO ITEM.CNTş                            READV TST FROM PKG.FILEVAR, PKG$ITEMS<1,ON.FILE,ON.ITEM>, 1 ELSEş                                ITEM.ERR = 1ş                            ENDş                        NEXT ON.ITEMş                    ENDş                END ELSE ITEM.ERR = 1ş                SHOW.ITEMS = PKG$ITEMS<1,ON.FILE>ş                CONVERT SVM TO ',' IN SHOW.ITEMSş                IF LEN(SHOW.ITEMS) > 20 THENş                    SHOW.ITEMS = SHOW.ITEMS[1,20]:'...'ş                ENDş                HTML<-1> = '<td 'ş                IF ITEM.ERR THEN HTML := 'class="error"'ş                HTML := '>':SHOW.ITEMS:'</td>'ş            ENDş            SHOW.SIZE = PKG$FILES.SIZE<1,ON.FILE>ş            IF SHOW.SIZE # '' THENş                BEGIN CASEş                CASE SHOW.SIZE >= PWR(10,9)ş                    SHOW.SIZE = OCONV(SHOW.SIZE,"MD29"):' GB'ş                CASE SHOW.SIZE >= PWR(10,6)ş                    SHOW.SIZE = OCONV(SHOW.SIZE,"MD26"):' MB'ş                CASE SHOW.SIZE >= PWR(10,3)ş                    SHOW.SIZE = OCONV(SHOW.SIZE,"MD23"):' kB'ş                CASE 1ş                    SHOW.SIZE := ' bytes'ş                END CASEş            ENDş            HTML<-1> = '<td>':SHOW.SIZE:'</td>'ş            IF PKG$FILES.OVR<1,ON.FILE> = 1 THEN CHECKED = 'checked' ELSE CHECKED = ''ş            HTML<-1> = '<td><input type="checkbox" name="files_ovr_':ON.FILE:'" ':CHECKED:'></td>'ş            HTML<-1> = \<td><a href="javascript:editFile('\:PKG$FILES.DICT<1,ON.FILE>:',':PKG$FILES<1,ON.FILE>:',':PKG$LIST.FILE<1,ON.FILE>:',':PKG$LIST<1,ON.FILE>:',':PKG$ITEMS<1,ON.FILE>:\');"><img title="Edit" class="icon" src="/db/icons/pencil.png"></a>\ş            HTML<-1> = \<a href="javascript:deleteFile('\:ON.FILE:\')"><img title="Delete" class="icon" src="/db/icons/delete.png"></a>\ş            HTML<-1> = '</td></tr>'ş        NEXT ON.FILEş        HTML<-1> = '<tr><td colspan="5"><a href="/dbc/MVPKG.MAIN?action=addfile" class="add-file">Add a File</a></td></tr></table>'ş*ş        HTML<-1> = '</div><!--#tabs-3-->'ş        HTML<-1> = '<div id="tabs-4" class="tab_content">'ş        HTML<-1> = '<div id="accordion">'ş        HTML<-1> = '<h3><a href="#">Images</a></h3><div>'ş        IMAGE.CNT = DCOUNT(PKG$WEB.IMAGE<1>,VM)ş        HTML<-1> = '<textarea rows="8" cols="40" name="web_images">'ş        FOR ON.IMAGE = 1 TO IMAGE.CNTş            IF PKG$WEB.IMAGE.OVR<1,ON.IMAGE> = 1 THEN CHECKED = 'checked' ELSE CHECKED = ''ş*HTML<-1> = '<li><input type="checkbox" name="image_ovr_':ON.IMAGE:'" value="1" ':CHECKED:'><input type="text" name="image_':ON.IMAGE:'" value="':PKG$WEB.IMAGE<1,ON.IMAGE>:'"></li>'ş            HTML<-1> = PKG$WEB.IMAGE<1,ON.IMAGE>ş        NEXT ON.IMAGEş        HTML<-1> = '</textarea></div>'ş        HTML<-1> = '<h3><a href="#">CSS</a></h3><div>'ş        CSS.CNT = DCOUNT(PKG$WEB.CSS<1>,VM)ş        HTML<-1> = '<textarea rows="8" cols="40" name="web_css">'ş        FOR ON.CSS = 1 TO CSS.CNTş            IF PKG$WEB.CSS.OVR<1,ON.CSS> = 1 THEN CHECKED = 'checked' ELSE CHECKED = ''ş*HTML<-1> = '<li><input type="checkbox" name="css_ovr_':ON.CSS:'" value="checked" ':CHECKED:'><input type="text" name="css_':ON.CSS:'" value="':PKG$WEB.CSS<1,ON.CSS>:'"></li>'ş            HTML<-1> = PKG$WEB.CSS<1,ON.CSS>ş        NEXT ON.CSSş        HTML<-1> = '</textarea></div>'ş        HTML<-1> = '<h3><a href="#">Javascript</a></h3><div>'ş        JS.CNT = DCOUNT(PKG$WEB.JS<1>,VM)ş        HTML<-1> = '<textarea rows="8" cols="40" name="web_js">'ş        FOR ON.JS = 1 TO JS.CNTş            IF PKG$WEB.JS.OVR<1,ON.JS> = 1 THEN CHECKED = 'checked' ELSE CHECKED = ''ş*HTML<-1> = '<li><input type="checkbox" name="js_ovr_':ON.JS:'" value="checked" ':CHECKED:'><input type="text" name="js_':ON.JS:'" value="':PKG$WEB.JS<1,ON.JS>:'"></li>'ş            HTML<-1> = PKG$WEB.JS<1,ON.JS>ş        NEXT ON.JSş        HTML<-1> = '</textarea></div>'ş        HTML<-1> = '<h3><a href="#">Icons</a></h3><div>'ş        ICON.CNT = DCOUNT(PKG$WEB.ICON<1>,VM)ş        HTML<-1> = '<textarea rows="8" cols="40" name="web_icons">'ş        FOR ON.ICON = 1 TO ICON.CNTş            IF PKG$WEB.ICON.OVR<1,ON.ICON> = 1 THEN CHECKED = 'checked' ELSE CHECKED = ''ş*HTML<-1> = '<li><input type="checkbox" name="icon_ovr_':ON.ICON:'" value="checked" ':CHECKED:'><input type="text" name="icon_':ON.ICON:'" value="':PKG$WEB.ICON<1,ON.ICON>:'"></li>'ş            HTML<-1> = PKG$WEB.ICON<1,ON.ICON>ş        NEXT ON.ICONş        HTML<-1> = '</textarea></div>'ş        HTML<-1> = '</div>'ş*ş        HTML<-1> = '</div><!--#tabs-4-->'ş        HTML<-1> = '<div id="tabs-5" class="tab_content">'ş*HTML<-1> = '<b>Settings</b>'ş        HTML<-1> = '<ul><li>Pre-Install Commands</li>'ş        CALL SWAP(PKG$PRE.CMD,VM,CHAR(13):CHAR(10))ş        HTML<-1> = '<li><textarea rows="5" cols="50" name="pkg_pre_cmd">':PKG$PRE.CMD:'</textarea></li>'ş        HTML<-1> = '<li>Post-Install Commands</li>'ş        CALL SWAP(PKG$POST.CMD,VM,CHAR(13):CHAR(10))ş        HTML<-1> = '<li><textarea rows="5" cols="50" name="pkg_post_cmd">':PKG$POST.CMD:'</textarea></li>'ş        IF PKG$COMPILE.OPT = 1 THEN CHECKED = 'checked' ELSE CHECKED = ''ş        HTML<-1> = '<li><input type="checkbox" name="compile_opt" value="checked" ':CHECKED:'> Compile widget subroutines</li>'ş        IF PKG$FLASH.OPT = 1 THEN CHECKED = 'checked' ELSE CHECKED = ''ş        HTML<-1> = '<li><input type="checkbox" name="flash_opt" value="checked" ':CHECKED:'> Flash compile widget subroutines</li>'ş        IF PKG$ACCESS.OPT = 1 THEN CHECKED = 'checked' ELSE CHECKED = ''ş        HTML<-1> = '<li><input type="checkbox" name="access_opt" value="checked" ':CHECKED:'> Include dashboard and widget user access settings</li>'ş        HTML<-1> = '</ul></div></div></form>'ş        RETURN000EAFRSS.MAINş0c2* RSS.MAINş*ş* Program: RSS.MAINş* Author: Luke Bucklinş* Date: 2/23/2009ş*ş* Purpose: Create an RSS feed using user-defined subroutine callsş*ş* Modified by Peter Schellenbach of Zumasys 07-17-15 for UV compatiblity:ş*   When testing for cataloged program, check if line 1 is 'V', not 'VR'.ş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE RSS.BP RSS.DATA.INCş*şCALL SET.CONTENT.TYPE("application/xml")ş*şOPEN '','RSS.FEEDS' TO F.RSS.FEEDS ELSE STOP 201, 'RSS.FEEDS'şOPEN '','MD' TO F.MD ELSEş  OPEN '','VOC' TO F.MD ELSE STOP 201, 'MD OR VOC'şENDşOPEN 'MVDB.CONTROL' TO F.MVDB.CONTROL ELSE STOP 201, 'MVDB.CONTROL'ş*şFEED.REC = ""şLOCATE "feed" IN CGI$VARS SETTING POS THENş  feed = CGI$VALS<POS>ş  READ FEED.REC FROM F.RSS.FEEDS, feed ELSE FEED.REC = ""şENDşIF FEED.REC = "" THENş  feed = "FEEDS"ş  READ FEED.REC FROM F.RSS.FEEDS, feed ELSEş    CALL SET.CONTENT.TYPE("application/xml")ş    CALL WEB.SEND('<H1>No feeds configured</H1>')ş    STOPş  ENDşENDşSEL.SUB = FEED.REC<4>şITEM.SUB = FEED.REC<5>şMAT RSS.DATA = ""şRSS$FEED.REC = FEED.RECşREAD CATPTR FROM F.MD, SEL.SUB ELSE CATPTR = ""ş*PJS 07-17-15*IF CATPTR<1> = "VR" THENşIF CATPTR<1> = "V" THEN ; *PJS 07-17-15*ş  CALL @SEL.SUB(CGI$VARS,CGI$VALS,feed,F.FEED.FILE,MAT RSS.DATA)şEND ELSEş  RSS$FEED.REC<1> = "Feed error: ":SEL.SUB:" not cataloged."şENDşFEED.REC = RSS$FEED.RECşCALL RSS.XML.ENCODE(FEED.REC,1)şFEED.TITLE = FEED.REC<1>şFEED.LINK = "http://":CGI$SERVER.NAME:CGI$PATH:'/RSS.MAIN?feed=':feedşIF FEED.REC<2> # "" THEN FEED.LINK := "&":FEED.REC<2>şFEED.DESC = FEED.REC<3>şXML = ""şXML<-1> = '<?xml version="1.0" ?>'şXML<-1> = '<rss version="2.0">'şXML<-1> = '<channel>'şXML<-1> = ' <title>':FEED.TITLE:'</title>'şXML<-1> = ' <link>':FEED.LINK:'</link>'şSHOW.DESC = FEED.DESCşIF SHOW.DESC = "" THEN SHOW.DESC = FEED.TITLEşXML<-1> = ' <description>':SHOW.DESC:'</description>'şXML<-1> = ' <generator>Sierra Bravo Pick RSS</generator>'şXDATE = DATE()şXTIME = TIME()şGOSUB MAKE.DATE.TIMEşXML<-1> = ' <lastBuildDate>':DATE.TIME:'</lastBuildDate>'ş*şIF SYSTEM(11) THENş  SELECT TO ID.LISTşEND ELSE ID.LIST = ""şSUB.ERR = 0şLOOPş  READNEXT RID FROM ID.LIST ELSE EXITş  READ FEED.REC FROM F.FEED.FILE, RID ELSE EXITş  READ CATPTR FROM F.MD, ITEM.SUB ELSE CATPTR = ""ş*PJS 07-17-15*  IF CATPTR<1> = "VR" THENş  IF CATPTR<1> = "V" THEN ; *PJS 07-17-15*ş    CALL @ITEM.SUB(CGI$VARS,CGI$VALS,F.FEED.FILE,RID,FEED.REC,MAT RSS.DATA)ş  END ELSEş    SUB.ERR = 1ş    MAT RSS.DATA = ""ş    RSS$TITLE = "Subroutine ":ITEM.SUB:" not cataloged."ş    RSS$DESCRIPTION = "Feed Error"ş    RSS$DATE = ICONV("1/1/2000",'D')ş    RSS$TIME = ICONV("12:00:00",'MT')ş  ENDş  FOR XX = 1 TO 5ş    CALL RSS.XML.ENCODE(RSS.DATA(XX),1)ş  NEXT XXş  XML<-1> = '<item>'ş  XML<-1> = ' <title>':RSS$TITLE:'</title>'ş  IF INDEX(RSS$LINK,'//',1) THENş    LINK = RSS$LINKş  END ELSE IF RSS$LINK # "" THENş    LINK = "http://":CGI$SERVER.NAME:CGI$PATH:'/':RSS$LINKş  END ELSEş    LINK = ""ş  ENDş  XML<-1> = ' <link>':LINK:'</link>'ş  XML<-1> = ' <author>':RSS$AUTHOR:'</author>'ş  XML<-1> = ' <description><![CDATA['ş  XML<-1> = RSS$DESCRIPTIONş  XML<-1> =']]></description>'ş  XDATE = RSS$DATEş  XTIME = RSS$TIMEş  GOSUB MAKE.DATE.TIMEş  XML<-1> = '<pubDate>':DATE.TIME:'</pubDate>'ş  XML<-1> = '</item>'ş  CALL WEB.SEND(XML)ş  XML = ''şREPEATşXML<-1> = '</channel>'şXML<-1> = '</rss>'şCALL WEB.SEND(XML)şSTOPş*şMAKE.DATE.TIME: *ş*şREADV GMT.OFFSET FROM F.MVDB.CONTROL, 'MVDB.SETTINGS', 6 ELSE GMT.OFFSET = 0şIF XTIME = "" THEN XTIME = TIME()şIF XDATE = "" THEN XDATE = DATE()ş*XTIME += ICONV("5:00",'MT')şXTIME += 3600 * (GMT.OFFSET * (-1))şIF XTIME > 86400 THENş  XTIME -= 86400ş  XDATE += 1şENDşDATE.TIME = OCONV(XDATE,'DWA')[1,3]:', ':OCONV(XDATE,'DD'):' ':OCONV(XDATE,'DMA')[1,3]:' ':OCONV(XDATE,'DY'):' ':OCONV(XTIME,'MTS')şRETURN000DDDMVDB.PURGE.SESSIONSş0c2* @(#) MVDB.PURGE.SESSIONS Ported to jBASE 17:00:17  08 JUL 2015ş*  The following variable names were convertedş*   DATE,TIMEş* ş*ş* Copyright (C) 2007 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Luke Bucklin, Sierra Bravoş* Date: November, 2007ş* Description: Purge old session dataş*ş* Modified By: Peter Schellenbach, Zumasysş* Date: 06/12/2015ş* Description: Changed TCLREAD to use SENTENCE() - its more portableş* 11-30-15 TOM PARKER - PURGE BASED ON PASSED USERIDş* 01-25-16 TOM PARKER - DONT AUTO PURGE EMAILED AND WEBSERVICE LOGINS FOR 10 MINUTESş*ş*#MAKE# RL $OPTIONS D3ş    OPEN '','WEB.SESSION' TO F.WEB.SESSION ELSE STOP 201, 'WEB.SESSION'ş    OPEN '','MVDB.UDATA' TO F.MVDB.UDATA ELSE STOP 201, 'MVDB.UDATA'ş    OPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSE STOP 201, 'MVDB.CONTROL'ş*ş    READ SETTINGS.REC FROM F.MVDB.CONTROL, 'MVDB.SETTINGS' ELSE SETTINGS.REC = ""ş    PURGE.AGE = SETTINGS.REC<5> * 3600  ;* Specified in hoursş    IF PURGE.AGE = 0 THEN PURGE.AGE = 8 * 3600ş*ş*PJS 06-12-15*TCLREAD TCL.LINEş    TCL.LINE = SENTENCE()     ;*PJS 06-12-15*ş    PS.LIST = OCONV( TCL.LINE, 'G1 999' )ş    PS.LIST = TRIM( PS.LIST )ş    CONVERT " " TO @AM IN PS.LISTş*11-30-15*    IF PS.LIST # "" THENş*11-30-15*        XLINE = "SELECT WEB.SESSION "ş*11-30-15*        FOR N = 1 TO DCOUNT(PS.LIST,@AM)ş*11-30-15*            XLINE := "'":PS.LIST<N>:"' "ş*11-30-15*        NEXT Nş*11-30-15*        EXECUTE XLINE CAPTURING JUNKş*11-30-15*        FORCE.PURGE = 1ş*11-30-15*    END ELSEş*11-30-15*        EXECUTE 'SSELECT WEB.SESSION' CAPTURING JUNKş*11-30-15*        FORCE.PURGE = 0ş*11-30-15*    ENDş    EXECUTE 'SSELECT WEB.SESSION' CAPTURING JUNK; *11-30-15*ş    PURGE.LIST = ''ş    LOOPş        READNEXT SESS.ID ELSE EXITş        READ SESS.REC FROM F.WEB.SESSION,SESS.ID ELSE SESS.REC = ''ş        PURGE.THIS = 0ş        PURGE.WEBSERVICE=0;  *01-25-16*ş*11-30-15*        IF FORCE.PURGE THENş*11-30-15*            PURGE.THIS = 1ş*11-30-15*        END ELSEş        LOCATE SESS.ID IN PS.LIST SETTING PURGE.THIS ELSEş           PURGE.THIS=0ş           LOCATE 'userid' IN SESS.REC<1> SETTING USERID.POS ELSE USERID.POS=0ş           IF USERID.POS THENş              USERID=SESS.REC<2,USERID.POS>ş*01-25-16*              LOCATE USERID IN PS.LIST SETTING PURGE.THIS ELSE PURGE.THIS=0ş              LOCATE USERID IN PS.LIST SETTING PURGE.WEBSERVICE ELSE PURGE.WEBSERVICE=0; *01-25-16ş            ENDş         ENDş        IF NOT(PURGE.THIS) THENş            LOCATE "LastSessionAccess" IN SESS.REC<1> SETTING VPOS THENş                Date = FIELD(SESS.REC<2,VPOS>,'*',1)ş                Time = FIELD(SESS.REC<2,VPOS>,'*',2)ş*ş                AGE = (DATE()-Date) * 86400ş                AGE += (TIME()-Time)ş*ş*01-25-16*                IF AGE > PURGE.AGE THENş                IF PURGE.WEBSERVICE THEN THIS.PURGE.AGE=600 ELSE THIS.PURGE.AGE=PURGE.AGE; * 01-25-16ş                IF AGE > THIS.PURGE.AGE THEN; * 01-25-16ş                    PURGE.THIS = 1ş                ENDş            END ELSE PURGE.THIS = 1ş        ENDş        IF PURGE.THIS THENş            DELETE F.WEB.SESSION, SESS.IDş            PURGE.LIST<-1> = SESS.IDş        ENDş    REPEATş*ş    EXECUTE 'SELECT MVDB.UDATA' CAPTURING JUNKş    LOOPş        READNEXT ID ELSE EXITş        SID = FIELD( ID, '$', 1 )ş        LOCATE SID IN PURGE.LIST SETTING POS THENş            DELETE F.MVDB.UDATA, IDş        END ELSEş            READ TST FROM F.WEB.SESSION, SID ELSEş                DELETE F.MVDB.UDATA, IDş            ENDş        ENDş    REPEATş    STOP002BE3APP.INSTALLERş0c2*ş* Copyright (C) 2009 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Luke Bucklin, Sierra Bravo Corporationş* Date: 07/15/2009ş* Description: Application installerş*ş* Modified By: Dave Bucklin, Nerdery Interactive Labsş* Date: 02/04/2011ş* Description: Add overwrite flag, clashes handling specific to MVDashboardş*ş* Modified By: Mike Street, Zumasysş* Date: 07/17/2015ş* Description: Adapt for UniVerseş*ş*ş    BUFFER = ""ş*ş    INSTALL.LOG.ON = 0ş    INSTALL.LOG.ID = "INSTALL*":DATE():"*":TIME()ş    INSTALL.LOG = ""ş    PROCESS.STATUS = 0ş    OVR.FLAG = 0ş    PROMPT ""ş    PRINT "File path: ":    ş    INPUT PACKAGE.FILEş    IF PACKAGE.FILE = "VERSION" THENş        PRINTş        PRINT "Installer Version"ş        PRINT "1.0"ş        STOPş    ENDş*ş    returnCode = ""ş*ş    OPENSEQ PACKAGE.FILE TO HANDLE ELSEş        PRINT "Unable to open sequential file"ş        STOPş    ENDş*UV   HANDLE = %OPEN(PACKAGE.FILE,O$RDONLY+O$BINARY)ş*UV   IF NOT(HANDLE) THENş*UV       PRINT "Unable to open file." ; STOPş*UV   ENDş*ş    L = 0ş    PACKET = ""ş    LOOP    ş*UV     L = %READ(HANDLE,BUFFER,10000)ş*UVş        READBLK BUFFER FROM HANDLE, 10000 ELSEş   IF PACKET = '' THENş      CRT 'CANT READ BUFFER'ş      STOPş    ENDş   BUFFER=''ş ENDş        L=LEN(BUFFER)ş*END UV*ş    WHILE L > 0 DOş        PACKET := BUFFERş    REPEATş    IF PACKET = "" THENş        PRINT "No package."ş        STOPş    ENDş    INSTALL.ID = TIMEDATE()ş    KEEP.SOURCE = "1"ş*ş    PRINTş    PRINT "Installing..."ş*ş    OPEN '','MV.PACKED.FILE' TO F.PACKED.FILE ELSEş        CMD = "CREATE-FILE MV.PACKED.FILE 1 31"ş        GOSUB EXEC.CMDş        OPEN '','MV.PACKED.FILE' TO F.PACKED.FILE ELSEş            ERRFILE = "MV.PACKED.FILE"ş            GOSUB OPEN.ERRş            STOPş        ENDş    ENDş    WRITE PACKET ON F.PACKED.FILE, "PACKAGE"şş    OPEN '','VOC' TO F.MD ELSEş        ERRFILE = "VOC"ş        GOSUB OPEN.ERRş        STOPş    ENDş    OPEN "MV.INSTALL" TO F.INSTALL ELSEş        CMD = "CREATE-FILE MV.INSTALL 1 11"ş        GOSUB EXEC.CMDş        OPEN "MV.INSTALL" TO F.INSTALL ELSEş            ERRFILE = "MV.INSTALL"ş            GOSUB OPEN.ERRş            STOPş        ENDş    ENDş    OPEN "MV.INSTALL.CF" TO F.INSTALL.CF ELSEş        CMD = "CREATE-FILE MV.INSTALL.CF 1 11"ş        GOSUB EXEC.CMDş        OPEN "MV.INSTALL.CF" TO F.INSTALL.CF ELSEş            ERRFILE = "MV.INSTALL.CF"ş            GOSUB OPEN.ERRş            STOPş        ENDş    ENDş    OPEN "MVAPPS.INSTALLED" TO F.MVAPPS.INSTALLED ELSEş        CMD = "CREATE-FILE MVAPPS.INSTALLED 3 31"ş        GOSUB EXEC.CMDş        OPEN "MVAPPS.INSTALLED" TO F.MVAPPS.INSTALLED ELSEş            ERRFILE = "MVAPPS.INSTALLED"ş            GOSUB OPEN.ERRş            STOPş        ENDş    ENDş    OPEN "DICT","MVDB.CLASHES" TO FD.MVDB.CLASHES ELSEş        CMD = "CREATE-FILE DICT MVDB.CLASHES 3"ş        GOSUB EXEC.CMDş    ENDş    INSTALL.LOG.ON = 1ş*ş    CLEARFILE F.INSTALLş    DELETE F.INSTALL.CF, "MVAPPS-PRE-SCRIPT"      ;* Get rid of this just in case one is left overş    DELETE F.INSTALL.CF, "MVAPPS-POST-SCRIPT"ş    DELETE F.INSTALL.CF, "PACKAGE.INFO"ş    TARGET = F.INSTALLş    TARGET.NAME = "MV.INSTALL"ş    GOSUB UNPACKş* All individual file packages are now in INSTALLş* Unpack the MD scriptsş    READ PACKET FROM F.INSTALL, "MV.INSTALL.CF" THENş        TARGET = F.INSTALL.CFş        TARGET.NAME = "MV.INSTALL.CF"ş        GOSUB UNPACKş        DELETE F.INSTALL, "MV.INSTALL.CF"ş    ENDş*ş* Execute scripts that are required prior to compilationş*ş    READ CMD FROM F.INSTALL.CF, "MVAPPS-PRE-SCRIPT" THENş        LOG.LINE = TIMEDATE():": Processing PRE-INSTALL commands..."ş        INSTALL.LOG<-1> = LOG.LINEş* Execute commands that need to be run before the install process beginsş        GOSUB EXEC.CMDş        LOG.LINE = TIMEDATE():": Completed PRE-INSTALL commands."ş        INSTALL.LOG<-1> = LOG.LINEş    ENDş    READ PACKAGE.INFO FROM F.INSTALL.CF, "PACKAGE.INFO" ELSE PACKAGE.INFO = ""ş    PACKAGE.ID = PACKAGE.INFO<6>ş    PACKAGE.INFO<4> = DATE()ş    PACKAGE.INFO<5> = TIME()ş*ş    SELECT F.INSTALLş    LOOPş        READNEXT PKG.ID ELSE EXITş        IF PKG.ID # "" THENş            READ PACKET FROM F.INSTALL, PKG.ID THENş                TARGET.FILE = FIELD(PKG.ID," ",1)ş                IF TARGET.FILE[1,7] = "BINARY:" THEN TARGET.FILE=TARGET.FILE[8,999]        ;*UVş                DICT.MOD = FIELD( PKG.ID," ",2)ş                DATA.MOD = FIELD( PKG.ID," ",3)ş                DICT = ""ş                IF FIELD( PKG.ID,'_',1 ) = "DICT" THENş                    TARGET.FILE = FIELD( PKG.ID, '_', 2 )ş                    IF TARGET.FILE[1,7] = "BINARY:" THEN TARGET.FILE=TARGET.FILE[8,999]    ;*UVş                    DICT = "DICT"ş                ENDş                OPEN DICT,TARGET.FILE TO F.TARGET ELSEş                    IF NOT(INDEX(TARGET.FILE,':',1)) THENş                        IF DICT.MOD = "" THEN DICT.MOD = 3ş                        IF DATA.MOD = "" THEN DATA.MOD = 31ş                        CMD = "CREATE-FILE ":TARGET.FILE:" ":DICT.MOD:" ":DATA.MODş                        GOSUB EXEC.CMDş                    ENDş                    OPEN DICT,TARGET.FILE TO F.TARGET ELSEş                        PRINT "Unable to create file ":TARGET.FILEş                        GOSUB CLEANUPş                        STOPş                    ENDş                ENDş                TARGET = F.TARGETş                TARGET.NAME = TRIM(DICT:" ":TARGET.FILE)ş                GOSUB UNPACKş            ENDş        ENDş    REPEATş*ş* Execute script required post compilationş*ş    READ CMD FROM F.INSTALL.CF, "MVAPPS-POST-SCRIPT" THENş        LOG.LINE = TIMEDATE():": Processing POST-INSTALL commands..."ş        INSTALL.LOG<-1> = LOG.LINEş* Use compile options if they are present.ş        OPEN 'MVDB.CONTROL' TO F.MVDB.CONTROL THENş            READ COMPILE.SETUP FROM F.MVDB.CONTROL, 'COMPILE.SETUP' THENş                COMPILE.VERB = FIELD(COMPILE.SETUP<1>,' ',1)ş                IF COMPILE.VERB # '' THENş                    OPTS = FIELD(COMPILE.SETUP<1>,'(',2)ş                    IF OPTS # '' THEN OPTS = "(":OPTSş                    CMD.CNT = DCOUNT( CMD, @AM )ş                    FOR CMD.XX = 1 TO CMD.CNTş                        IF FIELD(CMD<CMD.XX>,' ',1) = 'BASIC' OR FIELD(CMD<CMD.XX>,' ',1) = 'COMPILE' THENş*make sure we use the right verb and options from the compile.setupş                            CMD<CMD.XX> = COMPILE.VERB:' ':CMD<CMD.XX>[INDEX(CMD<CMD.XX>,' ',1)+1,999]:' ':OPTSş                        ENDş                    NEXT CMD.XXş                ENDş            ENDş        ENDş* Execute commands that need to be run at the end of the install processş        GOSUB EXEC.CMDş        LOG.LINE = TIMEDATE():": Completed POST-INSTALL commands."ş        INSTALL.LOG<-1> = LOG.LINEş    ENDş*ş*UV*    IF NOT(KEEP.SOURCE) THENş*UV*        FOR X = 1 TO DCOUNT( SOURCE.FILES, @AM )ş*UV*            CMD = "CLEAR-FILE DATA ":SOURCE.FILES<X>ş*UV*            GOSUB EXEC.CMDş*UV*        NEXT Xş*UV*    ENDş    READ INSTALL.LIST FROM F.INSTALL.CF, "LAST.INSTALL" ELSE INSTALL.LIST = ""ş    INSTALL.LIST = INSERT( INSTALL.LIST, 1, 0, 0, INSTALL.ID )ş    WRITE INSTALL.LIST ON F.INSTALL.CF, "LAST.INSTALL"ş    GOSUB CLEANUPş    INSTALL.LOG<-1> = TIMEDATE():": Install complete."ş    WRITE INSTALL.LOG ON F.INSTALL.CF, INSTALL.LOG.IDş    WRITE PACKAGE.INFO ON F.MVAPPS.INSTALLED, PACKAGE.IDş    PROCESS.STATUS = 1ş    GOSUB SEND.DATAş    STOPş*********şUNPACK:   *ş*********ş    PRINT "Unpacking ":TARGET.NAME:"... ":ş*ş    BYTES = 0ş    CNT = 0ş    LOOPş        PLENGTH = OCONV( PACKET[1,6], 'MCXD' )ş        REC = PACKET[7,PLENGTH]ş        PACKET = PACKET[PLENGTH+7,9999999]ş        ID = REC<1>ş        REC = DELETE( REC, 1, 0, 0 )ş        TYP = REC[1,2]ş        OVR.FLAG = REC[3,1]ş        REC = REC[4,9999999]ş        IF TYP = "0x" THENş            REC = OCONV( REC, 'MY' )ş            END ELSE IF TYP # "0c" THENş                REC = TYP:RECş            ENDş*ş            CNT += 1ş            BYTES += LEN(REC)ş            IF OVR.FLAG THENş                IF DICT = "" THENş*If we're not installing DICT items, compare for CLASHESş                    READ CLASH FROM TARGET, ID THENş                        BEGIN CASEş*Preserve dashboard user passwordsş                        CASE TARGET.FILE = "MVDB.USERS"ş                            IF CLASH<1> # REC<1> THEN REC<1> = CLASH<1>ş*Preserve dashboard access profileş                        CASE TARGET.FILE = "MVDB.DEFS"ş                            IF CLASH<5> # REC<5> THEN REC<5> = CLASH<5>ş*Preserve widget access profileş                        CASE TARGET.FILE = "MVDB.WIDGETS"ş                            IF CLASH<2> # REC<2> THEN REC<2> = CLASH<2>ş*Preserve widget compile optionş                        CASE TARGET.FILE = "MVDB.CONTROL" AND ID = "COMPILE.SETUP"ş                            IF CLASH<1> # REC<1> THEN REC<1> = CLASH<1>ş                        END CASEş                        IF CLASH # '' AND REC # CLASH THENş                            CLASH.NAME = TARGET.NAMEş                            CONVERT " " TO "_" IN CLASH.NAMEş                            OPEN 'MVDB.CLASHES,':CLASH.NAME TO F.CLASHES ELSEş                                CMD = "CREATE-FILE DATA MVDB.CLASHES,":CLASH.NAME:" 7"ş                                GOSUB EXEC.CMDş                                OPEN 'MVDB.CLASHES,':CLASH.NAME TO F.CLASHES ELSEş                                    PRINT "Unable to create file MVDB.CLASHES,":CLASH.NAMEş                                    GOSUB CLEANUPş                                    STOPş                                ENDş                            ENDş                            WRITE CLASH ON F.CLASHES, IDş                            CLOSE F.CLASHESş                        ENDş                    ENDş                ENDş                WRITE REC ON TARGET, IDş            END ELSEş                READ TST FROM TARGET, ID ELSEş                    WRITE REC ON TARGET, IDş                ENDş            ENDş            IF NOT(MOD(CNT,500)) THEN PRINT "*":ş        UNTIL PACKET = "" DO REPEATş        IF CNT # 1 THEN PLURAL = "s" ELSE PLURAL = ""ş        PRINT CNT:" record":PLURAL:"."ş        LOG.LINE = TIMEDATE():": UNPACKED ":CNT:" RECORDS TO ":TARGET.NAMEş        INSTALL.LOG<-1> = LOG.LINEş        RETURNş**********şCLEANUP:  *ş**********ş        CLEARFILE F.INSTALLş        CLEARFILE F.PACKED.FILEş        RETURNş*şEXEC.CMD: *ş*ş        CMD.CNT = DCOUNT( CMD, @AM )ş        FOR CMD.XX = 1 TO CMD.CNTş            THIS.CMD = CMD<CMD.XX>ş            LOG.LINE = TIMEDATE():": EXEC: ":THIS.CMDş            INSTALL.LOG<-1> = LOG.LINEş            CRT "Executing   ":THIS.CMDş            EXECUTE THIS.CMDş            IF INSTALL.LOG.ON THENş                WRITE INSTALL.LOG ON F.INSTALL.CF, INSTALL.LOG.IDş            ENDş        NEXT CMD.XXş        RETURNş*şOPEN.ERR: *ş*ş        LOG.LINE = TIMEDATE():": FILE OPEN ERROR: ":ERRFILEş        INSTALL.LOG<-1> = LOG.LINEş        PRINT LOG.LINEş        GOSUB SEND.DATAş        RETURNş*şSEND.DATA:*ş*ş        PRINTş        IF PROCESS.STATUS = 1 THEN INSTALL.STATUS = "Success" ELSE INSTALL.STATUS = "Failed"ş        PRINT "Install process finished. Status: ":INSTALL.STATUSş        RETURNş    END0019BBWEB.SENDş0c2SUBROUTINE WEB.SEND(FORM)ş********************ş*ş* (C) Copyright 2003 Sierra Bravo Corporation, All rights reserved.ş*ş* Program: WEB.SENDş* Library: WBPş*  Author: Luke J. Bucklinş*    Date: 2/29/00ş*ş* Purpose: Send the web page.ş*ş* Modified By  : Mike Schmidt, Sierra Bravoş* Date Revised : 11/06/2003ş* Modification : The program was modified to account for the following:ş*                1) Header Management: This program will check to seeş*                   if the content type has been written to the browserş*                   before ever printing anything to standard out.  Ifş*                   the headers have not been sent, the program will printş*                   the headers using the SESSION$CONTENT.TYPE,ş*                   SESSION$HEADERS, and SESSION$COOKIES session variables.ş*                   The program will then set the SESSION$CONTENT.SENTş*                   variable.ş*                   WARNING: This program assumes that the global SESSIONş*                   variables were setup prior to using this subroutine.ş*                   WARNING: The SESSION$OUTBUF.SIZE should not be reliedş*                   upon to prevent the buffer from exceeding the set limit.ş*                   This program simply flushes the buffer if it exceedsş*                   the set size limit.ş*ş*                2) Buffer Management: Instead of always printing everyş*                   thing to standard out, by default the program willş*                   write everything passed into into the SESSION$OUTBUFş*                   variable.  This program will then flush the bufferş*                   under certain situations.  The first is if the bufferş*                   size reaches the limit set in SESSION$OUTBUF.SIZE. Ifş*                   this happens the prgram will flush the buffer thenş*                   reinitialize it.  The second is if the SESSION$OUTBUF.FLAGş*                   is set to FALSE, then this program will always flushş*                   the buffer.ş*ş*                3) The program will display debug information if the globalş*                   variable SESSION$GLOBAL.DEBUG flag is >= 3.ş*ş* Modified by Peter Schellenbach of Zumasys 12-15-15 for new PDF generation featureş*   do not append form & @AM to output buffer if form is nullş*   do not add DOCTYPE to output unless content type is htmlş*   do not include debug output if content type is not html or xmlş*ş* 09-23-16 Tom Parker - Eliminate GO_BACK button support and replace withş*          logic to handle standard browser back button (need to prevent browserş*          from caching MVDB pages).ş*ş* 04-21-17 Peter Schellenbach - send response status code before Content-type,ş*          if set (X-MVDB-STATUS private header).ş*ş* 10-18-17 Peter Schellenbach - removed duplicate debug info section. Changed conditionş*          for sending debug info to SESSION$GLOBAL.DEBUG >= 3 instead of = 1.ş*          Eliminate extra AM appended to the form data.ş*ş********************ş*ş* Add the incoming string to the buffer.şINCLUDE WBPD WWW.INCLUDEş*şIF NOT(ASSIGNED(SESSION$CONTENT.SENT)) THENş  MAT WWW.INFO = ""ş  SESSION$CONTENT.SENT = 1şENDş*şSHOW.SESSION.VARS = 0şIF SESSION$GLOBAL.DEBUG >= 3 THENş  OPEN 'WEB.SESSION' TO F.WEB.SESSION THEN SHOW.SESSION.VARS = 1şENDş*şIF FORM <> '' THENş  CALL SWAP(FORM,'<!-- CGI$PATH -->',CGI$PATH)ş  *PJS 09-21-2017*SESSION$OUTBUF := FORM:@AMş  SESSION$OUTBUF := FORM ; *PJS 09-21-2017*şENDş*ş* If the buffer is greater then the max size or the buffer flag is false then flush.şIF LEN(SESSION$OUTBUF) >= SESSION$OUTBUF.SIZE OR NOT(SESSION$OUTBUF.FLAG) THENş* Before flushing, check to see if the headers have been send.ş  IF NOT(SESSION$CONTENT.SENT) THENş    IF SESSION$STATUS.CODE > 0 THENş* 04-21-17 send the status code before headersş      PRINT "X-MVDB-STATUS: ":SESSION$STATUS.CODEş    ENDş* The headers have not been sent so send them now.ş    IF SESSION$CONTENT.TYPE = "" THENş      CALL SET.CONTENT.TYPE("")ş    ENDş* If there are any cookies that need to be set, do it now.ş    PRINT "Content-type: ":SESSION$CONTENT.TYPEş* If there are any cookies that need to be set, do it now.ş    FOR I = 1 TO DCOUNT(SESSION$COOKIES,@AM)ş      COOKIE = SESSION$COOKIES<I>ş      IF INDEX(COOKIE, "; path=", 1) + INDEX(COOKIE, ";path=", 1) = 0 THEN COOKIE := "; path=/"ş      PRINT "Set-Cookie: ":COOKIEş    NEXT Iş* If there are any additional headers that need to be set, do it now.ş* 9-23-16 *    PRINT 'Cache-Control: no-cache'ş    PRINT 'Expires: Mon, 26 Jul 1997 05:00:00 GMT'; * 9-26-13 *ş    PRINT 'Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0'; * 9-26-13 *ş    PRINT 'Pragma: no-cache'; * 9-26-13 *ş    FOR I = 1 TO DCOUNT(SESSION$HEADERS,@AM)ş      PRINT SESSION$HEADERS<I>ş    NEXT Iş* Now print the blank line that ends the headers.ş    PRINTş    IF INDEX(SESSION$CONTENT.TYPE,'html',1) THENş      IF INDEX(SESSION$OUTBUF<1>,'<!DOCTYPE',1) = 0 THENş        PRINT '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"'ş        PRINT '"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">'ş      ENDş    ENDş* Set the SESSION$CONTENT.SENT variable so next time we know not to send the headers.ş    SESSION$CONTENT.SENT = 1ş* From this point on, do not buffer.ş    IF SESSION$OUTBUF.FLAG THENş      CALL SET.BUFFER(0)ş    ENDş  ENDş  LINE.CNT = DCOUNT( SESSION$OUTBUF, @AM )ş  FOR LINE.J = 1 TO LINE.CNTş    PRINT SESSION$OUTBUF<LINE.J>ş  NEXT LINE.Jş  IF SESSION$GLOBAL.DEBUG >= 3 THENş    IF INDEX(SESSION$CONTENT.TYPE,'xml',1) OR INDEX(SESSION$CONTENT.TYPE,'html',1) THENş* If the debug flag is set then dump all the session information to the browser.ş      PRINT '<!-- Debug Information generated by WEB.SEND.  This feature can be turned off by'ş      PRINT '     setting the SESSION$GLOBAL.DEBUG = "1" in the initalization program     -->'ş      PRINT '<!-- START DEBUG OUPUT 'ş      PRINT '     GET AND POST VARS:'ş      FOR I = 1 TO DCOUNT(CGI$VARS,@AM)ş        PRINT '     ':CGI$VARS<I>:' = ':CGI$VALS<I>ş      NEXT Iş      PRINTş      IF SHOW.SESSION.VARS THENş        PRINT '    SESSION VARIABLES:'ş        PRINT '    SESSION$ID = ':SESSION$IDş        READ REC FROM F.WEB.SESSION, SESSION$ID THENş          PRINT '    SESSION DATE = ':OCONV(REC<3>,'D4/')ş          PRINT '    SESSION TIME = ':OCONV(REC<4>,'MTS,')ş          FOR I = 1 TO DCOUNT(REC<1>,@VM)ş            PRINT '    ':REC<1,I>:' = ':REC<2,I>ş          NEXT Iş        ENDş      ENDş        PRINT '    END DEBUG OUTPUT -->'ş        PRINTş      ENDş    ENDş  SESSION$OUTBUF = ''ş  ENDş  RETURNşEND00009CWDB.VIEWş0c2*şCALL WDB.VARS(VARS,VALS)şHEADING "Variable" "L#20":" ":"Value"şFOR N = 1 TO DCOUNT( VARS, @AM )ş  PRINT VARS<N> "L#20":" ":VALS<N>şNEXT NşSTOP00172FSUB.PDF.FUNCş0c2SUBROUTINE SUB.PDF.FUNC(ACTION, MAIN.TEMPLATE)ş*ş* Copyright (c) 2016 Zumasys, Inc. All rights reserved.ş* Description: PDF utility functionsş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEş*şDIM PDF$SETTINGS(10)şEQU PDF$ENABLED   TO PDF$SETTINGS(1)şEQU PDF$COMMAND   TO PDF$SETTINGS(2)şEQU PDF$DIRECTORY TO PDF$SETTINGS(3)şEQU PDF$LIFETIME  TO PDF$SETTINGS(4)ş*şIF SYSTEM(91) THEN isWindows = 1 ELSE isWindows = 0 ;*UV*ş*şOPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL ELSE STOP 201, 'MVDB.CONTROL'şMATREAD PDF$SETTINGS FROM F.MVDB.CONTROL,'PDF.SETTINGS' ELSE MAT PDF$SETTINGS=''ş*şOPEN '','WDB.DEBUG' TO F.WDB.DEBUG THEN LOGGING = 1 ELSE LOGGING = 0ş*şBEGIN CASEş  CASE ACTION = 'generate'ş    * HTML templates may have references to css, javascript, images, etc. so swap these to be file referencesş    IF LOGGING THENş      CALL SUB.LOG.DEBUG.INFO(G$WIDGET.NAME,'SUB.PDF.FUNC generate')ş    ENDş    IF isWindows THEN DIRSEP = '\' ELSE DIRSEP = '/'ş    LOCATE 'INSTALL_PATH' IN CGI$VARS SETTING POS THENş      DBROOT = CGI$VALS<POS>ş    END ELSEş      IF isWindows THENş        DBROOT = 'C:\Program Files (x86)\Zumasys\MV Dashboard\bin\mvappsvr'ş      END ELSEş        DBROOT = '/usr/local/mvappsvr/bin/mvappsvr'ş      ENDş    ENDş    IF isWindows THEN CONVERT '\' TO '/' IN DBROOT ;* HTML path uses forward slashş    NDS = DCOUNT(DBROOT,'/')ş    POS = INDEX(DBROOT,'/',NDS-2)ş    IF POS = 0 THEN POS = LEN(DBROOT)ş    DBROOT = DBROOT[1,POS]:'docroot/db/'ş    *IF LOGGING THENş    *  SAVE.MAIN.TEMPLATE = MAIN.TEMPLATEş    *ENDş    *ş    * TODO: the SWAP() below handles any references to images, css & scriptsş    * that are found in the HTML to be rendered, but if there are referencesş    * to images within css these are not handled. Need to figure out how toş    * handle these.ş    *ş    CALL SWAP(MAIN.TEMPLATE,'/db/',DBROOT)ş    *ş    ** CLONED FROM WEB.SENDş    CALL SWAP(MAIN.TEMPLATE,'<!-- CGI$PATH -->',CGI$PATH)ş    IF INDEX(MAIN.TEMPLATE<1>,'<!DOCTYPE',1) = 0 THEN    ş      MAIN.TEMPLATE = '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"':@AM:'"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">':MAIN.TEMPLATEş    ENDş    ** END CLONE FROM WEB.SENDş    *ş    * Open the native content directory & get path to sameş    OPEN 'NATIVE.CONTENT' TO F.NATIVE.DIR ELSEş      PRINT '500 ERROR: CANNOT OPEN NATIVE.CONTENT'ş      STOP ;* intentional stopş    ENDş    NATIVE.DIR = PDF$DIRECTORYş    IF isWindows THEN CONVERT '/' TO '\' IN NATIVE.DIR ;*UV may have wrong separator!ş    IF NATIVE.DIR[LEN(NATIVE.DIR),1] NE DIRSEP THEN NATIVE.DIR = NATIVE.DIR : DIRSEPş    *ş    * Generate unique ID for HTML & PDF files in NATIVE.CONTENTş    CALL SUB.GET.NEXT.ID(UNIQUE.ID,F.MVDB.CONTROL)ş    HTM.ID=UNIQUE.ID:'.htm'ş    PDF.ID=UNIQUE.ID:'.pdf'ş    *ş    * Save HTML in native content directoryş    WRITE MAIN.TEMPLATE ON F.NATIVE.DIR,HTM.IDş    *ş    * Build command line for PDF converterş    INPFILE = NATIVE.DIR:HTM.IDş    OUTFILE = NATIVE.DIR:PDF.IDş    CMDLINE = PDF$COMMANDş    IF CMDLINE = '' THENş      PRINT '500 ERROR: PDF CONVERT COMMAND MISSING'ş      STOP ;* intentional stopş    ENDş    CALL SWAP(CMDLINE,'[INPUT_FILE]',INPFILE)ş    CALL SWAP(CMDLINE,'[OUTPUT_FILE]',OUTFILE)ş    IF isWindows THENş      CMDLINE = 'DOS /c ':CMDLINE ;*UV/WIN* quotes around INPFILE & OUTFILE are OK on UV!ş    END ELSEş      CMDLINE = 'SH -c "':CMDLINE:'"' ;*UV/LINUX* quotes around INPFILE & OUTFILE are OK on UV!ş    ENDş    *ş    * Execute the PDF convert commandş    EXECUTE CMDLINE CAPTURING OUTPUTş    *TODO: check for errors creating PDF fileş    IF LOGGING THENş      CALL SUB.LOG.DEBUG.INFO(G$WIDGET.NAME,'Command line: ':CMDLINE)ş      CALL SUB.LOG.DEBUG.INFO(G$WIDGET.NAME,'docroot/db: ':DBROOT)ş      CALL SUB.LOG.DEBUG.INFO(G$WIDGET.NAME,'Command output:':@AM:OUTPUT)ş      *CALL SWAP(SAVE.MAIN.TEMPLATE,'&','&amp;')ş      *CALL SWAP(SAVE.MAIN.TEMPLATE,'<','&lt;')ş      *CALL SWAP(SAVE.MAIN.TEMPLATE,'>','&gt;')ş      *CALL SUB.LOG.DEBUG.INFO(G$WIDGET.NAME,'MAIN.TEMPLATE':@AM:SAVE.MAIN.TEMPLATE)ş    ENDş    *ş    * Send content file name to mvappsvr using special headerş    PRINT 'X-MVDB-CONTENT-FILE: ':OUTFILEş    CALL SET.CONTENT.TYPE('application/pdf')ş    SESSION$HEADERS<-1> = 'Content-Disposition: attachment; filename=':PDF.IDş    *ş    * Remove HTML file from native content directoryş    IF NOT(LOGGING) THENş      DELETE F.NATIVE.DIR,HTM.IDş    ENDş    *ş    * All done!ş    *ş  CASE ACTION = 'cleanup'ş    IF PDF$LIFETIME >= 999999 THEN RETURN ;* Keep PDF files foreverş    IF PDF$LIFETIME = 0 THEN Freq = 3600 ELSE Freq = 86400ş    Today = DATE()ş    Now = (Today * 86400) + TIME()ş    READU PDF.CLEANUP.REC FROM F.MVDB.CONTROL,'PDF.CLEANUP.TASK' THENş      Prev = PDF.CLEANUP.REC<1>ş    END ELSEş      Prev = Now - Freqş    ENDş    IF Now < Prev + Freq THENş      RELEASE F.MVDB.CONTROL,'PDF.CLEANUP.TASK'ş      RETURNş    ENDş    IF OCONV('0','D2/')[1,2] # '31' THEN USA.DATE=1 ELSE USA.DATE=0ş    * Preform cleanup once per day (or once per hour for immediate removal)ş    PDF.CLEANUP.REC = Nowş    WRITE PDF.CLEANUP.REC ON F.MVDB.CONTROL,'PDF.CLEANUP.TASK' ON ERRORş      NULLş    ENDş    OPEN 'NATIVE.CONTENT' TO F.NATIVE.DIR ELSE RETURNş    SELECT F.NATIVE.DIRş    DONE = 0ş    LOOPş      READNEXT PDF.ID ELSE DONE = 1ş    UNTIL DONE DOş      IF PDF.ID MATCHES '18N.pdf' OR PDF.ID MATCHES '18N.PDF' THENş        IF USA.DATE THENş          PDFTime = (ICONV(PDF.ID[5,2]:'/':PDF.ID[7,2]:'/':PDF.ID[1,4],'D') * 86400) + (PDF.ID[9,2] * 3600) + (PDF.ID[11,2] * 60) + PDF.ID[13,2]ş        END ELSEş          PDFTime = (ICONV(PDF.ID[7,2]:'/':PDF.ID[5,2]:'/':PDF.ID[1,4],'D') * 86400) + (PDF.ID[9,2] * 3600) + (PDF.ID[11,2] * 60) + PDF.ID[13,2]ş        ENDş        Expires = PDFTime + (PDF$LIFETIME * 86400) + 1800ş        IF Expires < Now THENş          DELETE F.NATIVE.DIR,PDF.ID ON ERRORş            NULLş          ENDş        ENDş      ENDş    REPEATş    *şEND CASEşRETURNşEND00031FDELETE.SESSION.VARş0c2    SUBROUTINE DELETE.SESSION.VAR( Var )ş* @(#) DELETE.SESSION.VAR Ported to jBASE 17:00:16  08 JUL 2015ş*  The following variable names were convertedş*   VARş* ş*ş* Copyright (C) 2003 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Michael Derheim, Sierra Bravoş* Date: 10/25/03ş* Description: This program reads a value from the current webş*              session record.ş* Initş*#MAKE# RL $OPTIONS D3ş    INCLUDE WBPD WWW.INCLUDEş    EQU FALSE TO 0, TRUE TO 1ş    EQU AM TO CHAR(254), VM TO CHAR(253), SVM TO CHAR(252)ş*ş    READ REC FROM F.WEB.SESSION, SESSION$ID THENş        LOCATE Var IN REC<1> SETTING POS THENş            DELETE REC<1,POS>ş            DELETE REC<2,POS>ş            WRITE REC ON F.WEB.SESSION, SESSION$IDş        ENDş    ENDş*ş    RETURN000338XML.ENCODEş0c2SUBROUTINE XML.ENCODE(STRING.TO.PARSE, FLAG)ş*ş* Copyright (C) 2007 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: David Kam (Probably), Sierra Bravoş* Date: Unknownş* Description: Encode text prior to inserting into XML documentsş*ş*#MAKE# RL $OPTIONS D3şIF STRING.TO.PARSE # '' THENş  IF INDEX(STRING.TO.PARSE,'<!CDATA[',1) > 0 THENş    FLAG = 'X'ş  ENDş  IF INDEX(STRING.TO.PARSE,']]>',1) > 0 THENş    FLAG = 'X'ş  ENDş  IF FLAG = 'C' THENş    STRING.TO.PARSE = '<[!CDATA[':STRING.TO.PARSE:']]>'ş  END ELSEş    CALL SWAP(STRING.TO.PARSE,'&','&amp;')ş    CALL SWAP(STRING.TO.PARSE,'<','&lt;')ş    CALL SWAP(STRING.TO.PARSE,'>','&gt;')ş    CALL SWAP(STRING.TO.PARSE,'"','&quot;')ş    CALL SWAP(STRING.TO.PARSE,"'",'&#39;') ;*dmb 12/7/10 &apos; wasn't rendering correctly in IE8ş  ENDşENDşRETURN0004A5TIMEOUT.SESSIONş0c2*ş* Copyright (C) 2004 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Michael Derheim, Sierra Bravoş* Date: 06/03/04ş* Description: This program is used to timeout session records.  This programş*              should be run at regular intervals to remove unused session records.ş*            ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD WWW.INCLUDEş*şEQU FALSE TO 0, TRUE TO 1şEQU AM TO CHAR(254), VM TO CHAR(253), SVM TO CHAR(252)şVAL = ''ş*şTODAY = DATE()şNOW   = TIME()ş*şOPEN '','WEB.SESSION' TO F.WEB.SESSION ELSE STOPş*şCMD = 'SELECT WEB.SESSION'şEXECUTE CMD CAPTURING JUNKş*şLOOPş  READNEXT ID ELSE EXITş  READU REC FROM F.WEB.SESSION, ID THENş    LOCATE 'LastSessionAccess' IN REC<1> SETTING POS THENş      LAST.ACCESS = REC<2,POS>şş      LA.DAY = FIELD(LAST.ACCESS,'*',1)ş      LA.TIME = FIELD(LAST.ACCESS,'*',2)şş      IF (LA.DAY < (TODAY-1)) THENş        * If it is two days old, then get rid of it.ş        DELETE F.WEB.SESSION, IDş      ENDş    END ELSEş      TOTAL.VARS = DCOUNT(REC<1>, @VM)ş      REC<1,TOTAL.VARS+1> = 'LastSessionAccess'ş      REC<2,TOTAL.VARS+1> = DATE():'*':TIME()ş      WRITE REC ON F.WEB.SESSION, IDş    ENDş  ENDşREPEATş*şEND0000A8GET.CGIş0c2SUBROUTINE GET.CGI(VARNAME,VALUE)ş*şINCLUDE WBPD WWW.INCLUDEş*şLOCATE VARNAME IN CGI$VARS SETTING POS THENş  VALUE = CGI$VALS<POS>şEND ELSE VALUE = ""şRETURN0014B5DRILLDOWN.STACK.RTNEş0c2SUBROUTINE DRILLDOWN.STACK.RTNE(F.MVDB.UDATA,DD.STACK,GO.BACK)ş*ş* 4-25-16 Tom Parker - Created to support drilldown cookie concept to ş*                      allow for automatic go back functionalityş* 09-23-16 Tom Parker - Made obsolete with changes in philosophy on howş*                       to handle going back from drilldownsşINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEşINCLUDE WBPD FI.MVDB.USERSşINCLUDE WBPD FI.MVDB.DEFSşINCLUDE WBPD FI.MVDB.WIDGETSşINCLUDE WBPD FI.MVDB.WIDGET.TYPESş*şEQU TRUE TO 1, FALSE TO 0, AM TO CHAR(254), VM TO CHAR(253), SVM TO CHAR(252)ş*şMATREAD GLOBAL.USER.DATA FROM F.MVDB.UDATA, SESSION$ID:'$UG' ELSE MAT GLOBAL.USER.DATA=''şSTACK.ID=SESSION$ID:'$DD.STACK'şREAD DD.STACK FROM F.MVDB.UDATA, STACK.ID ELSE DD.STACK=''şIF DD.STACK <> '' THENş   LAST.STACK.CNTR=DCOUNT(DD.STACK,AM)ş   LAST.STACK.ENTRY.ID=SESSION$ID:'$DD.':LAST.STACK.CNTRş   READ LAST.CGI.REC FROM F.MVDB.UDATA, LAST.STACK.ENTRY.ID:'.VARS' ELSE LAST.CGI.REC=''ş END ELSEş   LAST.STACK.CNTR=0ş   LAST.CGI.REC=''ş ENDşVAL.VARS=CGI$VARS; CONVERT AM TO VM IN VAL.VARSşCGI.REC=VAL.VARSşVAL.VALS=CGI$VALS; CONVERT AM TO VM IN VAL.VALSşCGI.REC<2>=VAL.VALSşLOCATE 'dd' IN CGI$VARS SETTING POS ELSE POS=999şDD.VAR=CGI$VALS<POS>ş* DBNAME WILL BE GO_BACK IF PULLING BACK FROM DRILLDOWNşLOCATE 'dbname' IN CGI$VARS SETTING POS ELSE POS=999şDBNAME=CGI$VALS<POS>ş*ş** IF DOING A BACKUP PULL IN INFORMATION FROM PREVIOUSş*şIF (DBNAME = "GO_BACK" OR DBNAME = "go_back") AND LAST.STACK.CNTR > 1 THENş   DELETE.STACK.ENTRY.ID=SESSION$ID:'$DD.':LAST.STACK.CNTRş   DELETE F.MVDB.UDATA, DELETE.STACK.ENTRY.ID:'.GUD'ş   DELETE F.MVDB.UDATA, DELETE.STACK.ENTRY.ID:'.WUD'ş   DELETE F.MVDB.UDATA, DELETE.STACK.ENTRY.ID:'.VARS'ş   DD.STACK=DELETE(DD.STACK,LAST.STACK.CNTR,0,0)ş   WRITE DD.STACK ON F.MVDB.UDATA, STACK.IDş   NEW.STACK.ENTRY.ID=SESSION$ID:'$DD.':LAST.STACK.CNTR-1ş   READ CGI.REC FROM F.MVDB.UDATA, NEW.STACK.ENTRY.ID:'.VARS' ELSE CGI.REC=''ş   CGI$VARS=CGI.REC<1>ş   CONVERT VM TO AM IN CGI$VARSş   CGI$VALS=CGI.REC<2>ş   CONVERT VM TO AM IN CGI$VALSş   MATREAD GLOBAL.USER.DATA FROM F.MVDB.UDATA, NEW.STACK.ENTRY.ID:'.GUD' ELSE MAT GLOBAL.USER.DATA=''ş   MATWRITE GLOBAL.USER.DATA ON F.MVDB.UDATA, SESSION$ID:'$UG'ş**   MATREAD WIDGET.USER.DATA FROM F.MVDB.UDATA, NEW.STACK.ENTRY.ID:'.WUD' ELSE MAT WIDGET.USER.DATA=''ş   GO.BACK=1ş   RETURNş ENDş*ş** IF FROM A SUBMIT BUTTON THEN SIMPLY REFRESH LAST STACK ENTRYş** BUT MAKE SURE IT HAS DRILLDOWN IF PREVIOUS DIDş** SAME APPLIES TO DEBUG AND UNDEBUG BUTTONş*şLOCATE 'debug_widget' IN CGI$VARS SETTING DEBUG.POS ELSE DEBUG.POS=0şLOCATE 'undebug_widget' IN CGI$VARS SETTING UNDEBUG.POS ELSE UNDEBUG.POS=0şLOCATE 'sw' IN CGI$VARS SETTING POS ELSE POS=999şSW.VAR=CGI$VALS<POS>şINP.POS=INDEX(VM:VAL.VARS,VM:'inp_',1)şIF (SW.VAR <> '' AND INP.POS) OR DEBUG.POS OR UNDEBUG.POS THENş   LOCATE 'dd' IN LAST.CGI.REC<1> SETTING DD.POS ELSE DD.POS=999ş   DD.VAL=LAST.CGI.REC<2,DD.POS>ş   IF DD.VAL <> '' THENş      LOCATE 'dd' IN CGI$VARS SETTING DD.POS ELSE DD.POS=DCOUNT(CGI$VARS,AM)+1ş      IF CGI$VALS<DD.POS> = '' THENş         CGI.REC<1,DD.POS>='dd'ş         CGI.REC<2,DD.POS>=DD.VALş         CGI$VARS<DD.POS>='dd'ş         CGI$VALS<DD.POS>=DD.VALş       ENDş    ENDş   * DEBUG POSITION MAY HAVE CHANGED SO FIND AGAINş   IF DEBUG.POS THENş      LOCATE 'debug_widget' IN CGI.REC<1> SETTING DEBUG.POS ELSE DEBUG.POS=0ş      IF DEBUG.POS THENş         CGI.REC=DELETE(CGI.REC,1,DEBUG.POS,0)ş         CGI.REC=DELETE(CGI.REC,2,DEBUG.POS,0)ş       ENDş    ENDş   IF UNDEBUG.POS THENş      LOCATE 'undebug_widget' IN CGI.REC<1> SETTING UNDEBUG.POS ELSE UNDEBUG.POS=0ş      IF UNDEBUG.POS THENş         CGI.REC=DELETE(CGI.REC,1,UNDEBUG.POS,0)ş         CGI.REC=DELETE(CGI.REC,2,UNDEBUG.POS,0)ş       ENDş    ENDş   STACK.ENTRY.ID=LAST.STACK.ENTRY.IDş   GOSUB WRITE.STACKş   RETURNş ENDş*ş*ş** SIMPLY WRITE OUT THIS SESSION INFORMATION IF:ş**    1.  NOTHING YET ON THE STACKş**    2.  ONLY ONE ENTRY ON THE STACK AND THIS ISN'T A DRILL DOWNş*şIF NOT(LAST.STACK.CNTR) OR (LAST.STACK.CNTR = 1 AND DD.VAR = '') THENş   *ş   STACK.ENTRY.ID=SESSION$ID:'$DD.1'ş   DD.STACK=STACK.ENTRY.IDş   GOSUB WRITE.STACKş   RETURNş ENDş*ş** ID DOING A DRILLDOWN THEN PUSH ONTO STACKş*şIF DD.VAR <> '' THENş   NEXT.STACK.CNTR=LAST.STACK.CNTR+1ş   STACK.ENTRY.ID=SESSION$ID:'$DD.':NEXT.STACK.CNTRş   DD.STACK<NEXT.STACK.CNTR>=STACK.ENTRY.IDş   GOSUB WRITE.STACKş   RETURNş ENDş*ş** IF NO CHANGE IN CGI VARS THEN REFRESH LAST STACK ENTRYş*şIF CGI.REC = LAST.CGI.REC THENş   STACK.ENTRY.ID=LAST.STACK.ENTRY.IDş   GOSUB WRITE.STACKş   RETURNş ENDş*ş** ALL ELSE SHOULD BE A NEW DASHBOARD SO START OVER WITH STACKş** AFTER PURGING ALL PREVIOUSLY STACKED ITEMSş*şIF LAST.STACK.CNTR > 1 THENş   FOR DELETE.CNTR = LAST.STACK.CNTR TO 2 STEP -1ş      DELETE.STACK.ENTRY.ID=SESSION$ID:'$DD.':DELETE.CNTRş      DELETE F.MVDB.UDATA, DELETE.STACK.ENTRY.ID:'.GUD'ş      DELETE F.MVDB.UDATA, DELETE.STACK.ENTRY.ID:'.WUD'ş      DELETE F.MVDB.UDATA, DELETE.STACK.ENTRY.ID:'.VARS'ş    NEXT DELETE.CNTRş ENDşSTACK.ENTRY.ID=SESSION$ID:'$DD.1'şDD.STACK=STACK.ENTRY.IDşGOSUB WRITE.STACKş*şRETURNş*şWRITE.STACK:ş*şWRITE DD.STACK ON F.MVDB.UDATA, STACK.IDşWRITE CGI.REC ON F.MVDB.UDATA, STACK.ENTRY.ID:'.VARS'şMATWRITE GLOBAL.USER.DATA ON F.MVDB.UDATA, STACK.ENTRY.ID:'.GUD'şRETURNş*şEND000DFFMVDB.DEBUGş0c2*ş* Copyright (C) 2007 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Luke Bucklin, Sierra Bravoş* Date: December, 2007ş* Description: Dashboard & Widget Debuggerş*ş* Modified by Peter Schellenbach of Zumasys 07-17-15 for UV compatiblity:ş*   Added $OPTIONS TIME.MILLISECONDS to so that SYSTEM(12) returns milliseconds, not seconds.ş*ş$OPTIONS TIME.MILLISECOND *PJS 07-17-15 UV*ş*ş*#MAKE# RL $OPTIONS D3şINCLUDE WBPD MVDB.INCLUDEşINCLUDE WBPD FI.MVDB.WIDGETSşPROMPT ''ş*şOPEN '','MVDB.DEBUG.INFO' TO F.MVDB.DEBUG.INFO ELSEş  EXECUTE 'CREATE-FILE MVDB.DEBUG.INFO 1 3' CAPTURING JUNKş  OPEN '','MVDB.DEBUG.INFO' TO F.MVDB.DEBUG.INFO ELSE STOP 201, 'MVDB.DEBUG.INFO'şENDşOPEN '','MVDB.WIDGETS' TO F.MVDB.WIDGETS ELSE STOP 201, 'MVDB.WIDGETS'ş*şMY.PORT = @USERNO ; * FIELD( OCONV( '', 'U50BB' ), ' ', 1 ) *PJS 06-08-15*şDEBUG.ID = MY.PORTş*şREAD DB.REC FROM F.MVDB.DEBUG.INFO, DEBUG.ID ELSE DB.REC = ''ş*şWIDGET.ID = DB.REC<1>ş*şPRINT "Bravo Dashboard Debugger"şPRINTşOK = 0şLOOPş  PRINT "Widget (?=list)":ş  IF WIDGET.ID # "" THEN PRINT " (":WIDGET.ID:")":ş  PRINT ": ":ş  INPUT USE.WIDGET.IDş  IF USE.WIDGET.ID # '' THEN WIDGET.ID = USE.WIDGET.IDş  BEGIN CASEş    CASE WIDGET.ID = ''ş      STOPş    CASE WIDGET.ID = "?"ş      EXECUTE "SORT MVDB.WIDGETS"ş      PRINTş      WIDGET.ID = ''ş    CASE 1ş      MATREAD WIDGET.ITEM FROM F.MVDB.WIDGETS, WIDGET.ID THENş        OK = 1ş      END ELSEş        PRINT "Invalid widget ID: ":WIDGET.IDş      ENDş  END CASEşUNTIL OK DO REPEATşDB.REC<1> = WIDGET.IDş*şUSERID = DB.REC<2>şPRINTşOK = 0şLOOPş  PRINT "User ID (?=list)":ş  IF USERID # "" THEN PRINT " (":USERID:")":ş  PRINT ": ":ş  INPUT USE.USERIDş  IF USE.USERID # '' THEN USERID = USE.USERIDş  BEGIN CASEş    CASE USERID = "?"ş      EXECUTE 'SORT MVDB.USERS'ş      PRINTş      USERID = ''ş    CASE 1ş      OK = 1ş  END CASEşUNTIL OK DO REPEATş*şDB.REC<2> = USERIDş*şG$CURRENT.DB = DB.REC<3>şPRINTşOK = 0şLOOPş  PRINT "Dashboard ID (?=list)":ş  IF G$CURRENT.DB # "" THEN PRINT " (":G$CURRENT.DB:")":ş  PRINT ": ":ş  INPUT USE.DBş  IF USE.DB # '' THEN G$CURRENT.DB = USE.DBş  BEGIN CASEş    CASE USE.DB = "?"ş      EXECUTE 'SORT MVDB.DEFS'ş      PRINTş      G$CURRENT.DB = ''ş    CASE 1ş      OK = 1ş  END CASEşUNTIL OK DO REPEATş*şDB.REC<3> = G$CURRENT.DBş*ş* Pull in user dataş*şMATREAD WIDGET.USER.DATA FROM F.MVDB.DEBUG.INFO,DEBUG.ID:"$":WIDGET.ID ELSE MAT WIDGET.USER.DATA = ''ş*şLOOPş  PRINT "Widget User Data"ş  PRINT "----------------"ş  FOR X = 1 TO 100ş    IF WIDGET.USER.DATA(X) # '' THENş      PRINT X "R#3":". '":WIDGET.USER.DATA(X):"'"ş    ENDş  NEXT Xş  PRINTş  PRINT "User Data field # to change or ENTER to continue: ":ş  INPUT UPOSşWHILE UPOS MATCHES "1N0N" DOş  PRINT "Position ":UPOSş  PRINT "Current Value: ":WIDGET.USER.DATA(UPOS)ş  PRINT "New Value: ":ş  INPUT NEW.VALş  WIDGET.USER.DATA(UPOS) = NEW.VALşREPEATş*şMATWRITE WIDGET.USER.DATA ON F.MVDB.DEBUG.INFO, DEBUG.ID:"$":WIDGET.IDş*şWRITE DB.REC ON F.MVDB.DEBUG.INFO, DEBUG.IDş*şMAT WIDGET.INFO = ''şG$WIDGET.NAME = WIDGET.IDşG$WIDGET.SUB = WIDGET.SUBşG$USERID = USERIDşG$QUERYMODE = ''şG$DRILLDOWNMODE = 0ş*şPRINTşPRINT "Use Debugger (y/N): ":şINPUT USE.DEBUGşIF USE.DEBUG = "Y" THEN DEBUG ELSEş  PRINT "Calling ":WIDGET.SUBşENDş*#MAKE# RL IF 0 THENşSTART.TIMER = SYSTEM(12)ş*#MAKE# RL ENDşUSE.SUB.NAME = WIDGET.SUBşCALL @USE.SUB.NAMEş*#MAKE# RL IF 0 THENşDURATION = SYSTEM(12) - START.TIMERş*#MAKE# RL END ELSEş*#MAKE# RL   DURATION = "Unavailable"ş*#MAKE# RL ENDşMATWRITE WIDGET.USER.DATA ON F.MVDB.DEBUG.INFO, DEBUG.ID:"$":WIDGET.IDşPRINT "Call completed. Duration: ":DURATIONşSTOP000A3BMVDB.SUB.WIDGET.LISTş0c2SUBROUTINE MVDB.SUB.WIDGET.LIST(WIDGET.LIST)ş*ş* Copyright (C) 2007 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Luke Bucklin, Sierra Bravoş* Date: November, 2007ş* Description: Produce a list of defined widgets.ş*ş*#MAKE# RL $OPTIONS D3şOPEN '','MVDB.WIDGETS' TO F.MVDB.WIDGETS ELSE STOP 201, 'MVDB.WIDGETS'şOPEN '','MD' TO F.MD ELSEş  OPEN '','VOC' TO F.MD ELSE STOP 201, 'MD OR VOC'şENDş*şINCLUDE WBPD MVDB.INCLUDEşINCLUDE WBPD FI.MVDB.WIDGETSş*şCALL GET.SESSION.VAR("failed_widgets",FAILED.WIDGETS) ;* Retrieve a list of failed widgets this sessionşCALL GET.SESSION.VAR("running_widget",FAILED.WIDGET)şCALL GET.SESSION.VAR("running_widget_dt",FAILED.WIDGET.DT)şIF FAILED.WIDGET # "" THENş  FW.DATE = FIELD( FAILED.WIDGET.DT, '*', 1 )ş  FW.TIME = FIELD( FAILED.WIDGET.DT, '*', 2 )ş  FW.LAPSE = TIME() - FW.TIMEş  FW.LAPSE += ((DATE() - FW.DATE) * 86400)ş  IF FW.LAPSE < 2 THEN FAILED.WIDGET = "" ;* No more than 2 seconds to run a widget in query modeşENDşIF FAILED.WIDGET # "" THENş  CALL PUT.SESSION.VAR("running_widget","")ş  CALL PUT.SESSION.VAR("running_widget_dt","")ş  LOCATE FAILED.WIDGET IN FAILED.WIDGETS SETTING FWPOS ELSEş    FAILED.WIDGETS<-1> = FAILED.WIDGETş    CALL PUT.SESSION.VAR("failed_widgets",FAILED.WIDGETS)ş  ENDşENDş*şWIDGET.LIST = ''ş*şEXECUTE 'SSELECT MVDB.WIDGETS' CAPTURING JUNKş*şDP = 0şLOOPş  READNEXT ID ELSE EXITş  MATREAD WIDGET.ITEM FROM F.MVDB.WIDGETS, ID ELSE MAT WIDGET.ITEM = ''ş  DP += 1ş  WIDGET.LIST<1,DP> = IDş  SUBNAME = WIDGET.SUBş  G$QUERYMODE = 1ş  G$WIDGET.NAME = IDş  MAT WIDGET.INFO = ''ş  MAT WIDGET.USER.DATA = ''ş  MAT GLOBAL.TEMP.DATA = ''ş  MAT GLOBAL.USER.DATA = ''ş  FAIL.STATUS = 0 ;* Okayş  FAIL.TEXT = ""ş  LOCATE ID IN FAILED.WIDGETS SETTING POS THENş    W$TYPE = "FAILED"ş    W$TITLE = "Failed Widget - ":SUBNAMEş    W$WIDTH = 3ş    FAIL.STATUS = 1 ;* Failedş    FAIL.TEXT = "Subroutine Failed"ş  END ELSEş    READ CATPTR FROM F.MD, SUBNAME THENş      CALL PUT.SESSION.VAR("running_widget",ID)ş      DT.STAMP = DATE():"*":TIME()ş      CALL PUT.SESSION.VAR("running_widget_dt",DT.STAMP)ş      CALL @SUBNAMEş      CALL PUT.SESSION.VAR("running_widget","")ş      CALL PUT.SESSION.VAR("running_widget_dt","")ş    END ELSEş      W$TYPE = "FAILED"ş      W$TITLE = "Not Cataloged - ":SUBNAMEş      W$WIDTH = 3ş      FAIL.TEXT = "Subroutine Not Cataloged"ş    ENDş  ENDş  IF FIELD(W$TYPE,':',1) = "MAP" THEN W$TYPE = "MAP"ş  WIDGET.LIST<3,DP> = SUBNAMEş  WIDGET.LIST<4,DP> = W$TYPEş  WIDGET.LIST<5,DP> = W$TITLEş  WIDGET.LIST<6,DP> = W$WIDTHş  WIDGET.LIST<7,DP> = FAIL.STATUSş  WIDGET.LIST<8,DP> = FAIL.TEXTşREPEATşRETURN00042EGET.SESSION.IDş0c2SUBROUTINE GET.SESSION.ID( SESSION.ID, VARS, VALS )ş*ş* Copyright (C) 2003 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Michael Derheim, Sierra Bravoş* Date: 10/25/03ş* Description: This program extracts the session id from the VARS and VALSş*              The programmer could just as easily parse out the HTTP_COOKIEş*              header and get the value, but this just standardizes the ş*              process.ş*             ş* Initş*#MAKE# RL $OPTIONS D3şEQU FALSE TO 0, TRUE TO 1şEQU AM TO CHAR(254), VM TO CHAR(253), SVM TO CHAR(252)şSESSION.ID = ''ş*şNUM.VARS = DCOUNT(VARS, AM)şFOR X = 1 TO NUM.VARSş  IF (VARS<X> = 'HTTP_COOKIE') THENş    CSTRING = VALS<X>ş        CALL SWAP( CSTRING, '%3B ', ';')ş    CONVERT ';' TO AM IN CSTRINGş    NUM.COOKIES = DCOUNT(CSTRING, AM)ş    FOR Y = 1 TO NUM.COOKIESş      CVAR = TRIM(FIELD(CSTRING<Y>,'=',1))ş      CVAL = CSTRING<Y>[(1+INDEX(CSTRING<Y>,'=',1)),99999]ş      IF (CVAR = 'sessionid') THENş        SESSION.ID = TRIM(CVAL)ş        EXITş      ENDş    NEXT Yş  ENDşNEXT Xş*şRETURNş*0001C5RSS.XML.ENCODEş0c2SUBROUTINE RSS.XML.ENCODE(STRING.TO.PARSE, FLAG)ş*ş* Copyright (C) 2007 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: David Kam (Probably), Sierra Bravoş* Date: Unknownş* Description: Encode text prior to inserting into XML documentsş*şSWAP.CHARS = \&<>\şFOR SW = 1 TO LEN(SWAP.CHARS)ş  CH = SWAP.CHARS[SW,1]ş  HX = OCONV(SEQ(CH),'MCDX')ş  SWTO = "&#x":HX "R%2":";"ş  CALL SWAP(STRING.TO.PARSE,CH,SWTO)şNEXT SWşRETURNşş000536PUT.SESSION.VARş0c2SUBROUTINE PUT.SESSION.VAR( var, VAL )ş*ş* Copyright (C) 2003 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Michael Derheim, Sierra Bravoş* Date: 10/25/03ş* Description: This program inserts a variable in the the currentş*              session record.  If the variable already exists, itş*              is replaced.  If it does not exist, then it is created.ş*#MAKE# RL $OPTIONS D3ş* InitşINCLUDE WBPD WWW.INCLUDEşEQU FALSE TO 0, TRUE TO 1şEQU AM TO CHAR(254), VM TO CHAR(253), SVM TO CHAR(252)şIF SESSION$ID = "" THEN RETURNş*ş* Need to get rid of the VM,SVM, and AM chars so that we canş* store multi-valued data in the record. I am changing them toş* very small ASCII codes that are usually not used.  This shouldş* be pretty safe.ş*şCONVERT AM TO CHAR(2) IN VALşCONVERT VM TO CHAR(3) IN VALşCONVERT SVM TO CHAR(4) IN VALş*şREAD REC FROM F.WEB.SESSION, SESSION$ID ELSE REC = ''şTOTAL.VARS = DCOUNT(REC<1>, VM)şLOCATE var IN REC<1> SETTING POS THENş  REC<2,POS> = VALşEND ELSEş  NEXT.REC = TOTAL.VARS + 1ş  REC<1,NEXT.REC> = varş  REC<2,NEXT.REC> = VALşENDşWRITE REC ON F.WEB.SESSION, SESSION$IDşCONVERT CHAR(2) TO AM IN VALşCONVERT CHAR(3) TO VM IN VALşCONVERT CHAR(4) TO SVM IN VALş*şIF (var # 'LastSessionAccess') THENş  CALL PUT.SESSION.VAR('LastSessionAccess', DATE():'*':TIME())şENDş*şRETURN000B3EWDB.VARSş0c2SUBROUTINE WDB.VARS( VARS, VALS )ş*ş* Copyright (C) 2003 Sierra Bravo Corporation, All Rights Reservedş*ş* Written by: Michael Derheim, Sierra Bravoş* Date: 12/24/03ş* Description: This program is used to gather the vars and vals from aş*              web request.ş*ş* Modified By: Peter Schellenbach, Zumasysş* Date: 06/12/2015ş* Description: Changed PROCREAD to use SENTENCE() in the ELSE clauseş*ş* Modified By: Peter Schellenbach, Zumasysş* Date: 10/25/2016ş* Description: Added INCLUDE WWW.INCLUDE so we have access to CGI$UNIQUE.IDş*              in /WWW/ COMMON, instead of using PROCREAD / SENTENCE.ş*ş*#MAKE# RL $OPTIONS D3ş*şINCLUDE WBPD WWW.INCLUDE ; *PJS 10-25-16*ş*şVARS = ''şVALS = ''şVAR.POS = 1şDIM TEMP(50)ş*ş*PJS 06-12-15*PROCREAD TCL.LINE ELSE TCL.LINE = ''ş*PJS 10-25-16*PROCREAD TCL.LINE ELSE TCL.LINE = SENTENCE() ; *PJS 06-12-15*ş*PJS 10-25-16*UNIQUE.ID = FIELD( TCL.LINE, ' ', 2)şUNIQUE.ID = CGI$UNIQUE.ID ;*PJS 10-25-16*ş*şOPEN '','WDB.Q' TO WDB.Q ELSE RETURNş*şIF (UNIQUE.ID # '') THENş  READ QSTRING FROM WDB.Q, UNIQUE.ID ELSE QSTRING = ''ş  CONVERT @AM TO '' IN QSTRINGş  QLENGTH=LEN(QSTRING)ş  IF QSTRING[1,1] = '"' AND QSTRING[LEN(QSTRING),1] = '"' THENş    QSTRING = QSTRING[2,LEN(QSTRING)-2] ;* UNIDATA hackş  ENDş  CONVERT '&' TO @AM IN QSTRINGş  FOR X = 1 TO DCOUNT( QSTRING, @AM )ş    IF (TRIM(FIELD(QSTRING<X>,'=',1)) # '') THENş      HEX.STRING = FIELD(QSTRING<X>, '=', 1) ; GOSUB CONVERT.HEXş      VARS<VAR.POS> = HEX.STRINGş      EQ.POS = INDEX(QSTRING<X>,'=',1)ş      HEX.STRING = QSTRING<X>[EQ.POS+1,QLENGTH] ; GOSUB CONVERT.HEXş      VALS<VAR.POS> = HEX.STRINGş      VAR.POS += 1ş    ENDş  NEXT XşENDşRETURNş*------------şCONVERT.HEX:ş*------------şHSLEN = LEN(HEX.STRING)şIF HSLEN > 5000 THENş*IF 0 THENş  CHUNKLEN = INT( HSLEN / 50 )ş  START.POS = 1ş  FOR CHX = 1 TO 49ş    CUT.POINT = (START.POS-1) + CHUNKLENş    NCC = 0ş    LOOP UNTIL HEX.STRING[CUT.POINT+1,1] = "%" OR NCC > 1 DOş      CUT.POINT += 1ş      NCC += 1ş    REPEATş    TEMP(CHX) = HEX.STRING[START.POS,CHUNKLEN+NCC]ş    START.POS += CHUNKLEN + NCCş  NEXT CHXş  TEMP(50) = HEX.STRING[START.POS,QLENGTH]ş  MAX.TEMP.LOC = 50şEND ELSEş  TEMP(1) = HEX.STRINGş  MAX.TEMP.LOC = 1şENDşHEX.STRING = ""şFOR TEMP.LOC = 1 TO MAX.TEMP.LOC ş  IDX = 1ş  CONVERT '+' TO ' ' IN TEMP(TEMP.LOC)ş  LOOPş    LOC = INDEX( TEMP(TEMP.LOC), '%', IDX )ş  WHILE LOC DOş    IF TEMP(TEMP.LOC)[LOC+1,1] = "%" THENş      IDX += 2ş    END ELSEş      SWAP.VAL = TEMP(TEMP.LOC)[LOC+1,2]ş      SWAP.VAL = OCONV( SWAP.VAL, 'MCU' )ş      SWAP.VAL = OCONV(SWAP.VAL,'MCXD')ş      IF SWAP.VAL MATCHES "1N0N" THEN SWAP.VAL = CHAR(SWAP.VAL)ş  *    SWAP.VAL = CHAR(OCONV(SWAP.VAL,'MCXD'))ş      TEMP(TEMP.LOC)=TEMP(TEMP.LOC)[1,LOC-1]:SWAP.VAL:TEMP(TEMP.LOC)[LOC+3,QLENGTH]ş      IF SWAP.VAL = '%' THENş        IDX += 1ş      ENDş    ENDş  REPEATş  HEX.STRING := TEMP(TEMP.LOC)şNEXT TEMP.LOCş*şRETURN000961USER.UPDATEş0c2*On a new install, this should encrypt the default, plaintext passwords.ş*On an upgrade, it will encrypt all user passwords if they have not been encrypted by this program.ş* 1-2-15 TFP don't if the password is the same as the encryption of the userş*        name then don't encrypt againş* Modified by Peter Schellenbach of Zumasys 07-17-15 for UV compatiblity:ş*   Change U3060 user exist to use DIGEST('MD5',...) instead.ş*ş* 06-19-17 PJS After initial installation, scan for any MVDB.USERS records whereş* the password in USER.REC<1> is the same as the user ID. These are default usersş* 'admin' and 'guest', and the default plaintext password on attr 1 is encryptedş* and the user record updated. The USER.UPDATE flag in MVDB.CONTROL is updated toş* 2 so this process will not be repeated during upgrades. There is a special caseş* where the USER.UPDATE flag is 1, which indicates that the previous version ofş* MVDB.ADMIN had a bug where passwords were stored in the users record before butş* conversion to hex was not done. In this case, the MD5 hash in attr 1 is convertedş* to hex and the user record is updated.ş*şOPEN 'MVDB.USERS' TO F.MVDB.USERS ELSE STOP 201, 'MVDB.USERS'şOPEN 'MVDB.CONTROL' TO F.MVDB.CONTROL ELSE STOP 201, 'MVDB.CONTROL'şREADV USER.UPDATE.FLAG FROM F.MVDB.CONTROL, "USER.UPDATE",1 ELSE USER.UPDATE.FLAG = ''şIF USER.UPDATE.FLAG + 0 < 2 THENş  SELECT F.MVDB.USERSş  LOOPş    READNEXT USER.ID ELSE EXITş    READ USER.REC FROM F.MVDB.USERS, USER.ID THENş      MUST.UPDATE = 0ş      * Check for plaintext passwords in original installationş      IF USER.ID = USER.REC<1> THEN        ş        IF DIGEST('MD5', USER.REC<1>, 1, ENCRYPTED.PSWD) = 0 THEN ; *07-17-15 UV*ş          ENCRYPTED.PSWD = OCONV(ENCRYPTED.PSWD, 'MX0C') ; *07-17-15 UV*ş          MUST.UPDATE = 1ş        ENDş      END ELSEş        * Check for non-hex encrypted password in MVDB.USERS caused by bug in prior versions of MVDB.ADMINş        IF USER.UPDATE.FLAG = 1 THENş          ENCRYPTED.LEN = LEN(USER.REC<1>)ş          IF ENCRYPTED.LEN = 16 THENş            ENCRYPTED.PSWD = OCONV(USER.REC<1>, 'MX0C') ; *07-17-15 UV*ş            MUST.UPDATE = 1ş          END        ş        ENDş      ENDş      IF MUST.UPDATE THENş        USER.REC<1> = ENCRYPTED.PSWDş        WRITE USER.REC ON F.MVDB.USERS, USER.IDş      ENDş    ENDş  REPEATş  WRITEV 2 ON F.MVDB.CONTROL, "USER.UPDATE", 1şENDşSTOPşEND00207AMVDB.BUILD.PACKAGEş0c2    SUBROUTINE MVDB.BUILD.PACKAGE(MAKE.FILE,LOCATION,SIZE)ş*ş*   INCLUDE DM,BP,UNIX.H FCNTL.Hş*   INCLUDE DM,BP,UNIX.H MODE.Hş*   INCLUDE WBPD MVPKG.INCLUDEş*ş    EQU FALSE TO 0, TRUE TO 1ş    EQU AM TO CHAR(254), VM TO CHAR(253)ş*UV CHAR BUFFER[10000]ş    BUFFER = ""ş    DIM PKG.REC(40)ş    LOCATION = ''ş    SIZE = 0ş*ş    OPEN "MAKE.FILE,":MAKE.FILE TO F.MAKE.FILE ELSEş        OPEN MAKE.FILE TO F.MAKE.FILE ELSE STOP 201, MAKE.FILEş    ENDş    OPEN '','MVAPPS.INSTALLED' TO F.MVAPPS.INSTALLED ELSEş        EXECUTE "CREATE-FILE MVAPPS.INSTALLED 3 11" CAPTURING JUNKş        OPEN '','MVAPPS.INSTALLED' TO F.MVAPPS.INSTALLED ELSE STOP 201, 'MVAPPS.INSTALLED'ş    ENDş    OPEN '','MVPKG.DATA' TO F.MVPKG.DATA ELSEş        EXECUTE "CREATE-FILE MVPKG.DATA 3 11" CAPTURING JUNKş        OPEN '','MVPKG.DATA' TO F.MVPKG.DATA ELSE STOP 201, 'MVPKG.DATA'ş    ENDş    OPEN '','PACKED.FILE' TO TARGET.FILE ELSEş        EXECUTE "CREATE-FILE PACKED.FILE 3 31" CAPTURING JUNKş        OPEN '','PACKED.FILE' TO TARGET.FILE ELSE STOP 201, 'PACKED.FILE'ş    ENDş    MATREAD PKG.REC FROM F.MVPKG.DATA, MAKE.FILE ELSE RETURNş    PACKAGE.NAME = PKG$NAMEş    PACKAGE.NAME = OCONV(PACKAGE.NAME,"MCAN")ş    PACKAGE.DESCRIPTION = PKG$DESCş    PACKAGE.VERSION = PKG$BUILD.SEQ + 1ş    IF MAKE.FILE = '' OR PACKAGE.NAME = '' THEN RETURNş*ş    PACKAGE.INFO = ""ş    PACKAGE.MODE = 1ş* Set up the temporary storage area for the scriptsş    OPEN "MAKE.TEMP" TO F.MAKE.TEMP ELSEş        EXECUTE "CREATE-FILE MAKE.TEMP 1 31" CAPTURING JUNKş        OPEN "MAKE.TEMP" TO F.MAKE.TEMP ELSE STOP 201, "MAKE.TEMP"ş    ENDş    CLEARFILE F.MAKE.TEMPş    OPEN "PACKED.FILE" TO F.PACKED.FILE ELSEş        EXECUTE "CREATE-FILE PACKED.FILE 1 31" CAPTURING JUNKş        OPEN "PACKED.FILE" TO F.PACKED.FILE ELSE STOP 201, "PACKED.FILE"ş    ENDş    CLEARFILE F.PACKED.FILEş    BINARY.OPT = " (B"ş    PACKAGE.INFO<1> = PACKAGE.DESCRIPTIONş    PACKAGE.INFO<2> = PACKAGE.VERSIONş    PACKAGE.INFO<3> = "db"ş    PACKAGE.INFO<6> = PACKAGE.NAMEş*ş    TARGET = "D3"ş    SCRIPT = ""ş    SCRIPT.SEG = 0ş*ş    READ COMMANDS FROM F.MAKE.FILE, TARGET:"*PRE.COMMANDS" ELSEş        READ COMMANDS FROM F.MAKE.FILE, "PRE.COMMANDS" ELSE COMMANDS = ""ş    ENDş    GOSUB ADD.COMMANDSş*ş    WRITE SCRIPT ON F.MAKE.TEMP, "MVAPPS-PRE-SCRIPT"ş    WRITE PACKAGE.INFO ON F.MAKE.TEMP, "PACKAGE.INFO"ş    SCRIPT = ""ş*ş    READ FILE.LIST FROM F.MAKE.FILE, TARGET:"*FILE.LIST" ELSEş        READ FILE.LIST FROM F.MAKE.FILE, "FILE.LIST" ELSE FILE.LIST = ""ş    ENDş    FOR FX = 1 TO DCOUNT( FILE.LIST, @AM )ş        FNAME = FILE.LIST<FX>ş        FX.OVR = FALSEş        IF FNAME[1,2] = 'O:' THENş            FNAME=FNAME[3,999]ş            FX.OVR = TRUEş        ENDş        OPEN FNAME TO FVAR THENş            READ ITEM.LIST FROM F.MAKE.FILE, TARGET:"*DATA_":FNAME ELSEş                READ ITEM.LIST FROM F.MAKE.FILE, "DATA_":FNAME ELSE ITEM.LIST = ""ş            ENDş            IF ITEM.LIST<1> = "*" THENş                SELECT FVARş                ITEM.LIST = ''ş                LOOPş                    READNEXT ITEM.LIST.ID ELSE EXITş                    ITEM.LIST<-1> = ITEM.LIST.IDş                REPEATş            ENDş            WRITE ITEM.LIST ON F.MAKE.TEMP, FNAMEş            EXECUTE "QSELECT MAKE.TEMP '":FNAME:"'" CAPTURING JUNKş            IF SYSTEM(11) THENş                GOSUB PACK.FILEş            ENDş            DELETE F.MAKE.TEMP, FNAMEş            OPEN "DICT",FNAME TO D.FVAR THENş                READ ITEM.LIST FROM F.MAKE.FILE, TARGET:"*DICT_":FNAME ELSEş                    READ ITEM.LIST FROM F.MAKE.FILE, "DICT_":FNAME ELSE ITEM.LIST = ""ş                ENDş                FNAME = "DICT ":FNAMEş                IF ITEM.LIST<1> = "*" THENş                    SELECT D.FVARş                    ITEM.LIST = ''ş                    LOOPş                        READNEXT ITEM.LIST.ID ELSE EXITş                        ITEM.LIST<-1> = ITEM.LIST.IDş                    REPEATş                ENDş                WRITE ITEM.LIST ON F.MAKE.TEMP, FNAMEş                EXECUTE "QSELECT MAKE.TEMP '":FNAME:"'" CAPTURING JUNKş                IF SYSTEM(11) THENş                    GOSUB PACK.FILEş                ENDş                DELETE F.MAKE.TEMP, FNAMEş            ENDş        ENDş    NEXT FXş*ş    READ COMMANDS FROM F.MAKE.FILE, TARGET:"*POST.COMMANDS" ELSEş        READ COMMANDS FROM F.MAKE.FILE, "POST.COMMANDS" ELSE COMMANDS = ""ş    ENDş    SCRIPT = ""ş    GOSUB ADD.COMMANDSş    WRITE SCRIPT ON F.MAKE.TEMP, "MVAPPS-POST-SCRIPT"ş    EXECUTE 'SELECT MAKE.TEMP "MVAPPS-PRE-SCRIPT" "MVAPPS-POST-SCRIPT" "PACKAGE.INFO"' CAPTURING JUNKş    FNAME = "MAKE.TEMP"ş    GOSUB PACK.FILEş*ş* Change the name of the file containing the scripts from MAKE.TEMP to MDş* so they can be executed upon arrival.ş*ş    READ REC FROM F.PACKED.FILE, "MAKE.TEMP" ELSE REC = ""ş    WRITE REC ON F.PACKED.FILE, "MV.INSTALL.CF"ş    DELETE F.PACKED.FILE, "MAKE.TEMP"ş*ş    FNAME = "PACKED.FILE"ş    GOSUB PACK.FILEş    READ PACKAGE FROM F.PACKED.FILE, "PACKED.FILE" ELSE RETURNş    CLEARFILE F.PACKED.FILEş    WRITE PACKAGE ON F.PACKED.FILE, PACKAGE.NAME:'-':PACKAGE.VERSIONş    OUT.DIR = "/tmp/"ş*   HANDLE = %OPEN(OUT.DIR:PACKAGE.NAME,O$CREAT+O$TRUNC+O$RDWR+O$BINARY)ş    OPENSEQ OUT.DIR:PACKAGE.NAME TO HANDLE THENş        ORIG.LEN =LEN(PACKAGE)ş        WTOT = 0ş        LOOPş            IF LEN(PACKAGE) >= 10000 THENş                BUFFER = PACKAGE[1,10000]ş                BLEN = 10000ş                PACKAGE = PACKAGE[10001,9999999]ş            END ELSEş                BUFFER = PACKAGEş                BLEN = LEN(PACKAGE)ş                PACKAGE = ""ş            ENDş*UV         W = %WRITE(HANDLE,BUFFER,BLEN)ş            WRITESEQ BUFFER APPEND TO HANDLE ELSE RETURNş            WTOT += BLENş        WHILE PACKAGE # "" DO REPEATş        LOCATION = OUT.DIR:PACKAGE.NAMEş        SIZE = WTOTş    ENDş    RETURNş*şADD.COMMANDS:       *ş*ş    FOR CMDX = 1 TO DCOUNT( COMMANDS, @AM )ş        SCRIPT<-1> = COMMANDS<CMDX>ş    NEXT CMDXş    RETURNş*şCHECK.DPOINTER:     * Check to see if the record contains a dpointerş*ş    D.POINTER = FALSEş    IF OCONV(REC<1>[1,1],'MCU') = "D" THENş        IF FILE.TYPE = "DICT" THENş            IF REC<2> MATCHES "3N0N" AND REC<3> MATCHES "1N0N" THENş                D.POINTER = TRUEş            ENDş        ENDş    ENDş    RETURNş*şPACK.FILE:ş    ARG.LIST = TRIM( FNAME )ş    BINARY = 1ş*ş    FILE.TYPE = 'DATA'ş    FILE.NAME = FIELD( ARG.LIST, ' ', 1 )ş    POS = 2ş    IF FILE.NAME = "DATA" OR FILE.NAME = "DICT" THENş        FILE.TYPE = FILE.NAMEş        FILE.NAME = FIELD( ARG.LIST, ' ', 2 )ş        POS = 3ş    ENDş    IF FILE.TYPE = "DATA" THEN FILE.TYPE = ""ş*ş    OPEN FILE.TYPE,FILE.NAME TO PACK.FILE ELSE RETURNş    PACK.FILE.ID = ''ş    IF FILE.TYPE # "" THEN PACK.FILE.ID = FILE.TYPE:"_"ş    IF FX.OVR THEN PACK.FILE.ID := 'O:'ş    PACK.FILE.ID := FILE.NAMEş*ş*Packing PACK.FILE.IDş*ş    IF INDEX(FILE.NAME,'BINARY:',1) THENş        HEX.MODE = 1ş    END ELSE HEX.MODE = 0ş    CHK.FILE.NAME = FILE.NAMEş    Count = 0ş    SELECT PACK.FILEş    EOF = FALSEş    PACK.REC = ""ş    DLIST = ""ş    SEPARATOR = @AMş    LOOPş        READNEXT CHK.REC.ID ELSE EOF = TRUEş    UNTIL EOF DOş        READ REC FROM PACK.FILE, CHK.REC.ID ELSE REC = ""ş*Remove db/widget user access data?ş        IF PKG$ACCESS.OPT # 1 THENş            IF FILE.NAME = 'MVDB.DEFS' THENş                REC<5> = ''ş                END ELSE IF FILE.NAME = 'MVDB.WIDGETS' THENş                    REC<2> = ''ş                ENDş            ENDş            GOSUB CHECK.DPOINTERş            IF NOT( D.POINTER ) THENş                Count = Count + 1ş                IF HEX.MODE THENş                    REC = CHK.REC.ID:SEPARATOR:"0x":OCONV(REC,'MX')ş                END ELSEş                    REC = CHK.REC.ID:SEPARATOR:"0c":RECş                ENDş                LENGTH = OCONV( LEN(REC), 'MCDX' ) "R%6"ş                PACK.REC = PACK.REC:LENGTH:RECş            END ELSEş                DLIST<-1> = CHK.REC.IDş            ENDş        REPEATş*ş        FOR D = 1 TO DCOUNT( DLIST, AM )ş*PRINTş*PRINT "Item '":DLIST<D>:"' is a D-Pointer.  Not packed."ş        NEXT Dş        IF PACK.REC # "" THENş            WRITE PACK.REC ON TARGET.FILE, PACK.FILE.IDş        ENDş*PRINT PACK.FILE.ID:" packed.  ":Count:" records packed into ":PACK.FILE.IDş        RETURN00029BSET.STATUS.CODEş0c2SUBROUTINE SET.STATUS.CODE( STATUS.CODE )ş**********************************************************************ş* Copyright (C) 2020 Zumasys, Inc., All Rights Reservedş*ş* Written By   : Peter Schellenbachş* Date Written : 04/21/2017ş* Description  : This program sets the response status code sentş*                back to client. Successful requests should returnş*                status code 200 (this is the default). Status codeş*                500 indicates a generic server failure.ş*              ş**********************************************************************şINCLUDE WBPD WWW.INCLUDEşSESSION$STATUS.CODE = STATUS.CODEş*şRETURNş*0001E6WDB.TESTş0c2INCLUDE WBPD WWW.INCLUDEşPRINT "junk before content"şPRINT CHAR(10)şPRINT "Content-type: text/html"şPRINT ""şCALL WDB.VARS( VARS, VALS )şPRINT "<pre>"şPRINT "Vars: "şFOR X = 1 TO DCOUNT(VARS, @AM)ş  PRINT VARS<X>:" = ":VALS<X>şNEXT XşPRINTşFOR N = 45 TO 49ş  PRINT "WWW.INFO(":N:"): ":WWW.INFO(N)şNEXT NşPRINT "</pre>"şPRINT '<form method="POST" action="/dbc/WDB.TEST">'şPRINT '<input type="text" name="thing">'şPRINT '<input type="submit" value="submit">'şPRINT '</form>'ş*00019ACREATE.WEBSERVICE.PASSWORDş0c2SUBROUTINE CREATE.WEBSERVICE.PASSWORD(PASSWORD,PASSTIME)ş* VALID PASSWORD IS THE SUM OF MMDDYY + SSMMHH (FROM PASSTIME)ş* INVERT THE TIME TO SSMMHHşPASSTIME=OCONV(TIME(),'MTS')şCONVERT ':' TO '' IN PASSTIMEşEMITSSAP=''şFOR TIME.I = 6 TO 1 STEP -1ş  EMITSSAP:=PASSTIME[TIME.I,1]şNEXT TIME.IşOTODAY=OCONV(DATE(),'D2-')şCONVERT '-' TO '' IN OTODAYşPASSWORD=OTODAY+EMITSSAPşRETURNşEND004079WDB.INITş0c2*ş* Copyright (C) 2017 Zumasys, Inc., All Rights Reservedş*ş* Written by: Michael Derheim, Sierra Bravoş* Date: 12/24/03ş* Description: This program is the man entry point for web transactions.ş*ş* Modified By: Peter Schellenbach, Zumasysş* Date: 06/12/2015ş* Description: Changed PROCREAD to use SENTENCE() in the ELSE clause.ş*              When reading MD PROC item, if its missing, read againş*              with '.PROC' suffix on ID. This way we can keep the PROCş*              in the MD as a flag that the function is allowed, but notş*              require it in the MD, since jBASE does not place catalogş*              items in the MD.ş*ş* Modified by Peter Schellenbach of Zumasys 07-28-15 for UV compatiblity:ş*   UniVerse SYSTEM(19) replacement using DATE(), SYSTEM(12) & RND() to create unique IDş*ş* Modified By: Peter Schellenbach, Zumasysş* Date: 10/25/2016ş* Description: This program was made more generic, so that it can serveş*              as the main entry point for both MVDB and REST services.ş*              The MVDB specific code has been refactored into MVDB.INIT.ş*              A new WDB.RESOURCE file is used to determine supportedş*              resources and the name of the program to handle the resource.ş*              For example, the MVDB.MAIN record in the WDB.RESOURCE fileş*              defines MVDB.INIT as the handler for the MVDB.RESOURCE.ş*ş*              Removed PROCREAD (and calling PROC from MD). Only useş*              SENTENCE now.ş*ş* Modified By: Peter Schellenbach, Zumasysş* Date: 04/21/2017ş* Description: Updated to use CONFIG record in WDB.RESOURCE toş*ş* Modified By: Peter Schellenbach, Zumasysş* Date: 06/16/2017ş* Description: For REST, separate header & request vars from rest of cgi vars.ş*              Fix VARS variable conflict in APPEND.REC to use QSTR and saveş*              QSTR in WDB.DEBUG record instead of VARS. Change program nameş*              in WDB.DEBUG record ID to RSRC.ID so MV.DEBUG can recreate theş*              WDB.INIT command line.ş*ş* Modified By: Peter Schellenbach, Zumasysş* Date: 10/18/2017ş* Description: Save detailed debug info in WDB.DEBUG record to enable reproducingş*              original environment when debugging requests.ş*              WDB.DEBUG: initialized from WDB.RESOURCE record attr 7, set whenş*              WDB.INIT should create debug records in WDB.DEBUG file for use by WDEBUG.ş*              WDEBUG.MODE: set if WDB.INIT is being called by WDEBUG instead of mvappsvr.ş*ş* Modified By: Peter Schellenbach, Zumasysş* Date: 11/29/2017ş* Description: Provide for execution of dashboard or REST service in a differentş*              account. New RSRC.ACCOUNT field added to WDB.RESOURCE records.ş*              Use LOGTO to switch accounts prior to executing the resourceş*              handler program.ş*ş$OPTIONS TIME.MILLISECOND *PJS 10-18-17 UV*ş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD FI.WDB.RESOURCEşINCLUDE WBPD FI.WDB.DEBUGş*şMAT WWW.INFO = ''şSTATUS.CODE = 0şLOGGING = 0şLOG.REC = ''şWDB.DEBUG = 0şWDEBUG.MODE = 0ş*şOPEN 'WDB.Q' TO Q ELSEş  ERR = 'Cannot open Queue file'ş  GOSUB SEND.ERRORşENDşOPEN 'WDB.RESOURCE' TO F.RESOURCE ELSEş  ERR = 'Cannot open resource file'ş  GOSUB SEND.ERRORşENDş*ş* Read and parse config settingsş*ş*  Important config settings:ş*   LOGLEVEL - see belowş*   DEFAULT_HANDLER - if a "handler" is not included in RESOURCE.NAME, use this default handlerş*   DEFAULT_RESOURCE - if a "resource" is not included in RESOURCE.NAME, use this default resourceş*ş*   Note: PATH_INFO is the part of the URL beginning with a forward slash (/) after theş*   server/port and before the query string. It is interpreted as:ş*     /<handler>/<resource>/<REST parameter>/<another REST parameter> ...ş*ş*   MVAppSvr will pass <handler>/<resource> as 2nd command line argument, unless the defaultş*   handler is being used, then only <resource> is passed.ş*şREAD TEMPCONFIG FROM F.RESOURCE, 'CONFIG' ELSE TEMPCONFIG = ''şNUMCONFIG = DCOUNT(TEMPCONFIG, @AM)şCGI$CONFIG = ''şCONFIGCNTR = 0şFOR A = 2 TO NUMCONFIGş  CONFIGNAME = TEMPCONFIG<A,1>ş  CONFIGVALUE = TEMPCONFIG<A,2>ş  IF CONFIGNAME <> '' THENş    LOCATE CONFIGNAME IN CGI$CONFIG<1,1> SETTING POS ELSEş      CONFIGCNTR += 1ş      CGI$CONFIG<1,1,CONFIGCNTR> = CONFIGNAMEş    ENDş    CGI$CONFIG<1,2,CONFIGCNTR> = CONFIGVALUEş  ENDşNEXT Aş*ş* Get the logging level from configş*ş*  Log levels:ş*   0 - no loggingş*   1 - log errorsş*   2 - log all requestsş*   3 - log everything (debug mode)ş*ş*  Log info is written to the WDB.LOG file. Requests and errors are loggedş*  using a unique ID.ş*şSESSION$GLOBAL.DEBUG = 0şLOCATE 'LOGLEVEL' IN CGI$CONFIG<1,1> SETTING POS THENş  TEMPVALUE = CGI$CONFIG<1,2,POS>ş  IF TEMPVALUE MATCHES '1N' THEN SESSION$GLOBAL.DEBUG = TEMPVALUE + 0şENDşLOGGING = SESSION$GLOBAL.DEBUGşIF LOGGING THENş  OPEN 'WDB.LOG' TO F.LOG ELSE LOGGING = 0şENDş*ş* Get default handlerş*şDEFAULT.HANDLER = 'DBC' ;* ensure this is defined!şLOCATE 'DEFAULT_HANDLER' IN CGI$CONFIG<1,1> SETTING POS THENş  DEFAULT.HANDLER = OCONV(CGI$CONFIG<1,2,POS>, 'MCU')şENDş*ş* Parse the command lineş*şTCL.LINE = SENTENCE()şRESOURCE.NAME = OCONV(FIELD(TCL.LINE, ' ', 2), 'MCU')şINIT.VARS = FIELD(TCL.LINE, ' ', 3)şVAR.STRING = FIELD(TCL.LINE, ' ', 4)şXTRA.OPTS = FIELD(TCL.LINE, ' ', 5)ş*şUNIQUE.ID = FIELD(INIT.VARS, '-', 1)şONCOM     = FIELD(INIT.VARS, '-', 2)şCOMCOUNT  = FIELD(INIT.VARS, '-', 3)ş*ş* Get handler from RESOURCE.NAME argumentş*şIF DCOUNT(RESOURCE.NAME, '/') = 2 THENş  HANDLER.NAME = OCONV(FIELD(RESOURCE.NAME, '/', 1), 'MCU')ş  RESOURCE.NAME = OCONV(FIELD(RESOURCE.NAME, '/', 2), 'MCU')şEND ELSEş  HANDLER.NAME = DEFAULT.HANDLERş  RESOURCE.NAME = OCONV(RESOURCE.NAME, 'MCU')şENDş*ş* Get the resource record from WDB.RESOURCE fileş*şRSRC.ID = HANDLER.NAME:'*':RESOURCE.NAMEşMAT RSRC.ITEM = ''şMATREAD RSRC.ITEM FROM F.RESOURCE, RSRC.ID ELSEş  IF HANDLER.NAME = DEFAULT.HANDLER THENş    MATREAD RSRC.ITEM FROM F.RESOURCE,RESOURCE.NAME ELSE NULLş  ENDşENDş*ş* Sort out the debug modesş*ş*  WDEBUG.MODE is set when the request was initiated by WDEBUG rather than web.ş*  WDB.DEBUG is set when the resource indicates to log debug info for web requests.ş*  WDEBUG.MODE and WDB.DEBUG are exclusive!ş*  SESSION$WDEBUG.MODE can be tested by resource handlers to break into debugger, or ???şIF INDEX(XTRA.OPTS, '_WDEBUG_MODE_', 1) THEN WDEBUG.MODE = 1şSESSION$WDEBUG.MODE = WDEBUG.MODEşIF NOT(WDEBUG.MODE) THENş  WDB.DEBUG = RSRC.DEBUG.MODEş  IF WDB.DEBUG THENş    OPEN 'WDB.DEBUG' TO F.WDB.DEBUG ELSE WDB.DEBUG = 0ş  ENDşENDş*ş* Validate the resource - return error if invalid or disabledş*şIF (RSRC.TYPE = 'P') AND RSRC.ENABLED THENş  CGI.MODE = RSRC.PARSE.CGIş  IF ONCOM = 1 AND VAR.STRING = '%%' THENş* READ VARS FROM STDIN INSTEAD OF COMMAND LINEş    PROMPT ''ş    ECHO OFFş    FOR ONCOM = 1 TO COMCOUNTş      INPUT VAR.STRINGş      IF ONCOM < COMCOUNT THENş        GOSUB APPEND.RECş      ENDş    NEXT ONCOMş    ECHO ONş    ONCOM = COMCOUNTş  ENDş  IF (ONCOM = COMCOUNT) THENş    GOSUB APPEND.RECş    IF LOGGING > 1 THENş      LOG.REC<1> = RESOURCE.NAMEş      LOG.REC<2> = DATE()ş      LOG.REC<3> = SYSTEM(12) ;* START TIMEş      LOG.REC<6> = COMCOUNTş    ENDş*ş* Populate the vars and valsş*ş    CGI$UNIQUE.ID = UNIQUE.IDş    IF RSRC.PROGRAM <> '' THENş      CGI$RESOURCE.NAME = RSRC.PROGRAMş    END ELSEş      CGI$RESOURCE.NAME = RESOURCE.NAMEş    ENDş    IF CGI.MODE THENş*ş* Parse CGI, request & header variablesş*ş      CALL WDB.VARS(VARS, VALS)ş      LOCATE "APPSVR_ID" IN VARS SETTING POS THENş        CGI$APPSVR.ID = VALS<POS>ş        VARS = DELETE(VARS, POS, 0, 0)ş        VALS = DELETE(VALS, POS, 0, 0)ş      END ELSEş        CGI$APPSVR.ID = ""ş      ENDş      LOCATE "__body__" IN VARS SETTING POS THENş        CGI$BODY = VALS<POS>ş        VARS = DELETE(VARS, POS, 0, 0)ş        VALS = DELETE(VALS, POS, 0, 0)ş      ENDş*ş* Copy CGI variables to CGI$VARS/CGI$VALS and request & header variables to CGI$HEADERVARS/CGI$HEADERVALSş*ş      REQUEST.VAR.NAMES = 'SIMPLEWEB_MODULE':@AM:'SIMPLEWEB_HANDLER':@AM:'REMOTE_ADDR':@AM:'REMOTE_HOST':@AM:'REMOTE_USER':@AMş      REQUEST.VAR.NAMES := 'REQUEST_METHOD':@AM:'PROTOCOL_VERSION':@AM:'PATH_INFO':@AM:'CONTENT_TYPE':@AM:'SERVER_PORT':@AM:'INSTALL_PATH'ş      NUM.VARS = DCOUNT(VARS, @AM)ş      HDR.VAR.NUM = 1ş      CGI.VAR.NUM = 1ş      FOR Y = 1 TO NUM.VARSş        IS.HDR.VAR = 0ş        VAR.NAME = VARS<Y>ş        IF VAR.NAME[1,5] = 'HTTP_' THENş          IS.HDR.VAR = 1ş        END ELSEş          LOCATE VAR.NAME IN REQUEST.VAR.NAMES SETTING POS THEN IS.HDR.VAR = 1ş        ENDş        IF IS.HDR.VAR THENş          CGI$HEADERVARS<HDR.VAR.NUM> = VAR.NAMEş          CGI$HEADERVALS<HDR.VAR.NUM> = VALS<Y>ş          HDR.VAR.NUM += 1ş        END ELSEş          CGI$VARS<CGI.VAR.NUM> = VAR.NAMEş          CGI$VALS<CGI.VAR.NUM> = VALS<Y>ş          CGI.VAR.NUM += 1ş        ENDş      NEXT Yş*ş* Load the Cookie variables and valuesş*ş      LOCATE 'HTTP_COOKIE' IN VARS SETTING POS THENş        CSTRING = VALS<POS>ş      END ELSE CSTRING = ''ş      CONVERT ';' TO @AM IN CSTRINGş      NUM.COOKIES = DCOUNT(CSTRING, @AM)ş      FOR Y = 1 TO NUM.COOKIESş        CGI$CVARS<Y> = TRIM(FIELD(CSTRING<Y>,'=',1))ş        CGI$CVALS<Y> = CSTRING<Y>[1 + COL2(),99999]ş      NEXT Yş*ş* Get server infoş*ş      LOCATE "HTTP_HOST" IN VARS SETTING POS THENş        CGI$SERVER.NAME = VALS<POS>ş      END ELSE CGI$SERVER.NAME = ""ş      LOCATE "SERVER_PORT" IN VARS SETTING POS THENş        CGI$SERVER.PORT = VALS<POS>ş      END ELSE CGI$SERVER.PORT = ""ş      IF CGI$SERVER.PORT = "" OR CGI$SERVER.PORT = "0" THENş        OPEN '','MVDB.CONTROL' TO F.MVDB.CONTROL THENş          READV TCP.PORT FROM F.MVDB.CONTROL, 'MVDB.SETTINGS', 4 ELSE TCP.PORT = ""ş        ENDş        CGI$SERVER.PORT = TCP.PORTş      ENDş      IF CGI$SERVER.PORT # "" AND INDEX(CGI$SERVER.NAME, ':', 1) = 0 THEN CGI$SERVER.NAME := ":":CGI$SERVER.PORT ;*PJS 10-25-16* Only append port if its not already in the HTTP_HOST headerş      LOCATE "SIMPLEWEB_HANDLER" IN VARS SETTING POS THENş        CGI$PATH = VALS<POS>ş        IF CGI$PATH[1,1] # "/" THEN CGI$PATH = "/":CGI$PATHş      END ELSE CGI$PATH = "/dbc"ş*ş* Extract REST parametersş*ş      LOCATE "PATH_INFO" IN VARS SETTING POS THENş        PATH = VALS<POS>ş        IF PATH[1,1] = '/' THEN PATH = PATH[2,9999]ş        Y = INDEX(PATH, '/', 2)ş        IF Y > 0 THENş          CGI$RESTPARAMS = PATH[Y + 1, 99999]ş          CONVERT '/' TO @AM IN CGI$RESTPARAMSş        ENDş      ENDş    ENDş*ş* Clear the out buffer and set some generic varsş*ş    SESSION$CONTENT.SENT = 0ş*ş* LOGTO the account containing the resource, if not the current accountş*ş    IF RSRC.ACCOUNT <> '' THENş      IF OCONV(RSRC.ACCOUNT, 'MCU') = OCONV(@WHO, 'MCU') THENş        RSRC.ACCOUNT = ''ş      END ELSEş        IF OCONV(RSRC.ACCOUNT, 'MCU') = OCONV(@PATH, 'MCU') THENş          RSRC.ACCOUNT = ''ş        ENDş      ENDş    ENDş    IF RSRC.ACCOUNT <> '' THENş      ACCT.FROM = @PATHş      EXECUTE 'LOGTO ':RSRC.ACCOUNT CAPTURING DUMMYş      ACCT.TO = @PATHş      IF ACCT.FROM = ACCT.TO THENş* LOGTO failed!       ş        STATUS.CODE = 404ş        ERR = 'Resource account unavailable'ş        GOTO SEND.ERRORş      ENDş    ENDş*ş* Run the controller program for the resourceş*ş    PRINTş    PRINT "700 WDB-START"ş    IF WDB.DEBUG THENş      EXECDUR = ''ş      IF RSRC.PROGRAM <> '' THENş        DBG.ID = 'R/':RSRC.PROGRAM:'/':UNIQUE.IDş      END ELSEş        DBG.ID = 'R/':RSRC.CONTROLLER:'/':UNIQUE.IDş      ENDş      GOSUB CREATE.DEBUG.RECş      EXECSTART = SYSTEM(12)ş      EXECUTE RSRC.CONTROLLER:' ':UNIQUE.ID CAPTURING RESPONSEş      EXECDUR = SYSTEM(12) - EXECSTARTş      DELETE F.WDB.DEBUG, DBG.IDş      DBG.ID = 'C':DBG.ID[2, LEN(DBG.ID)]ş      GOSUB UPDATE.DEBUG.RECş      N = DCOUNT(RESPONSE, @AM)ş      FOR I = 1 TO Nş        PRINT RESPONSE<I>ş      NEXT Iş    END ELSEş      EXECUTE RSRC.CONTROLLER:' ':UNIQUE.IDş    ENDş*ş* Wrap upş*ş    * this call has been moved to MVDB.INIT: CALL WEB.FLUSHş    PRINT "800 WDB-COMPLETE"ş    DELETE Q, UNIQUE.IDş    IF LOGGING > 1 THENş      LOG.REC<4> = SYSTEM(12) ;* END TIMEş      LOG.REC<5> = LOG.REC<4> - LOG.REC<3>ş      LOG.REC<7> = 1 ;* this is a requestş      GOSUB UPDATE.LOGş    ENDş  END ELSEş    GOSUB APPEND.RECş    PRINTş    PRINT "700 WDB-START"ş    PRINT "800 WDB-COMPLETE"ş  ENDşEND ELSEş  IF (ONCOM = COMCOUNT) OR (ONCOM = 1 AND VAR.STRING = '%%') THENş* Final (or only) command part has been received - log the error nowş    IF LOGGING THENş      LOG.REC<1> = RESOURCE.NAMEş      LOG.REC<2> = DATE()ş      LOG.REC<3> = SYSTEM(12)ş      LOG.REC<6> = COMCOUNTş      LOG.REC<7> = 2 ;* this is an errorş      BEGIN CASEş        CASE RSRC.TYPE = ''ş          LOG.REC<8> = 'Undefined resource'ş        CASE RSRC.TYPE <> 'P'ş          LOG.REC<8> = 'Invalid resource'ş        CASE NOT(RSRC.ENABLED)ş          LOG.REC<8> = 'Disabled resource'ş        CASE 1ş          LOG.REC<8> = 'Unknown error'ş      END CASEş      GOSUB UPDATE.LOGş    ENDş    STATUS.CODE = 404ş    ERR = 'Invalid Resource'ş    GOSUB SEND.ERRORş  END ELSEş    PRINTş    PRINT "700 WDB-START"ş    PRINT "800 WDB-COMPLETE"ş  ENDşENDşSTOPş*şSEND.ERROR:ş*şPRINTşPRINT "700 WDB-START"şIF STATUS.CODE > 0 THENş  PRINT 'X-MVDB-STATUS: ':STATUS.CODEşENDşPRINT '500 ERROR ':ERRşPRINT "800 WDB-COMPLETE"şSTOPş*----------şAPPEND.REC:ş*----------şREADU QSTR FROM Q, UNIQUE.ID ELSE QSTR = ''şQSTR<ONCOM> = VAR.STRINGşWRITE QSTR ON Q, UNIQUE.IDşRETURNş*----------şUPDATE.LOG:ş*----------ş*UV*LOG.ID = SYSTEM(19)şLOG.ID = (DATE() 'R%5'):(SYSTEM(12) 'R%8'):(RND(1000) 'R%4') ;*UV* we need a unique ID (this is not guaranteed unique, but should suffice)şWRITE LOG.REC ON F.LOG, LOG.IDşRETURNş*----------şCREATE.DEBUG.REC:ş*----------şDBGREC = ''şDBGREC<WDBG_DATE> = DATE()şDBGREC<WDBG_TIME> = TIME()şDBGREC<WDBG_PORT> = FIELD(OCONV('','U50BB'),' ',1) ;*PortşDBGREC<WDBG_HANDLER> = HANDLER.NAMEşDBGREC<WDBG_RESOURCE> = RESOURCE.NAMEşDBGREC<WDBG_CONTROLLER> = RSRC.CONTROLLERşDBGREC<WDBG_PROGRAM> = RSRC.PROGRAMşDBGREC<WDBG_REQUEST_ID> = UNIQUE.IDşLOCATE "REQUEST_METHOD" IN VARS SETTING POS THENş  DBGREC<WDBG_METHOD> = VALS<POS>şENDşLOCATE "PATH_INFO" IN VARS SETTING POS THENş  DBGREC<WDBG_PATH> = VALS<POS>şENDşLOCATE "REMOTE_ADDR" IN VARS SETTING POS THENş  DBGREC<WDBG_REMOTE_ADDR> = VALS<POS>şENDş* save headers variablesşDBGREC<WDBG_HEADER_VARS> = LOWER(CGI$HEADERVARS)şDBGREC<WDBG_HEADER_VALS> = LOWER(CGI$HEADERVALS)şIF CGI$APPSVR.ID <> '' THENş  N = DCOUNT(DBGREC<WDBG_HEADER_VARS>, @VM) + 1ş  DBGREC<WDBG_HEADER_VARS, N> = 'APPSVR_ID'ş  DBGREC<WDBG_HEADER_VALS, N> = CGI$APPSVR.IDşENDş* save form variablesşDBGREC<WDBG_CGI_VARS> = LOWER(CGI$VARS)şDBGREC<WDBG_CGI_VALS> = LOWER(CGI$VALS)ş* Request bodyşDBGREC<WDBG_BODY> = CHANGE(CHANGE(CGI$BODY, CHAR(13), ''), CHAR(10), @VM)ş* Session variablesşTEMPVARS = OCONV(CGI$CVARS, 'MCU')şLOCATE 'SESSIONID' IN TEMPVARS SETTING POS THENş  SID = CGI$CVALS<POS>ş  SREC = ''ş  OPEN 'WEB.SESSION' TO F.WEB.SESSION THENş    READ SREC FROM F.WEB.SESSION, SID ELSE NULLş  ENDş  DBGREC<WDBG_SESSION_ID> = SIDş  DBGREC<WDBG_SESSION_VARS> = SREC<1>ş  DBGREC<WDBG_SESSION_VALS> = SREC<2>ş  DBGREC<WDBG_SESSION_DATE> = SREC<3>ş  DBGREC<WDBG_SESSION_TIME> = SREC<4>şENDş* save debug info before processing requestşWRITE DBGREC ON F.WDB.DEBUG, DBG.IDşRETURNş*----------şUPDATE.DEBUG.REC:ş*----------şDBGREC<WDBG_DATE> = DATE()şDBGREC<WDBG_TIME> = TIME()şDBGREC<WDBG_DURATION> = EXECDURşIF STATUS.CODE > 0 THEN DBGREC<WDBG_STATUS> = STATUS.CODE ELSE DBGREC<WDBG_STATUS> = 200ş* save response headersşNUM.VARS = 0şEOH = INDEX(RESPONSE, @AM:@AM, 1) ;* headers end at first blank line in responseşIF EOH = 0 THEN EOH = LEN(RESPONSE) + 1şN = DCOUNT(RESPONSE[1, EOH - 1], @AM)şFOR I = 1 TO Nş  HDR.LINE = RESPONSE<I>ş  HDR.VAR = FIELD(HDR.LINE, ':', 1)ş  HDR.VAL = TRIMF(HDR.LINE[COL2() + 1, LEN(HDR.LINE)])ş  M = LEN(HDR.VAR)ş  FOR J = 1 TO Mş    IF NOT(HDR.VAR[J,1] MATCHES '1A') AND HDR.VAR[J,1] <> '-' THENş      HDR.VAR = ''ş      EXITş    ENDş  NEXT Jş  IF HDR.LINE[LEN(HDR.VAR) + 1, 1] <> ':' THEN HDR.VAR = ''ş  IF HDR.VAR = '' THENş    NUM.VARS += 1ş    DBGREC<WDBG_RESPONSE_VARS, NUM.VARS> = '_BAD_'ş    DBGREC<WDBG_RESPONSE_VALS, NUM.VARS> = HDR.LINE ;* invalid header line!ş  END ELSEş    NUM.VARS += 1ş    DBGREC<WDBG_RESPONSE_VARS, NUM.VARS> = HDR.VARş    DBGREC<WDBG_RESPONSE_VALS, NUM.VARS> = HDR.VALş  ENDşNEXT Iş* save response contentşIF EOH + 2 <= LEN(RESPONSE) THENş  DBGREC<WDBG_RESPONSE_CONTENT> = LOWER(RESPONSE[EOH + 2, LEN(RESPONSE)])şENDşWRITE DBGREC ON F.WDB.DEBUG, DBG.IDşRETURNş*şEND0002D0SUB.GET.NEXT.IDş0c2SUBROUTINE SUB.GET.NEXT.ID(NewID,F.CONTROL)ş*ş* Copyright (c) 2020 Zumasys, Inc. All rights reserved.ş* Description: generate a (probably) unique ID based on current time, date and counterş*ş* Pass MVDB.CONTROL file variable, returns new IDş* Up to 10,000 IDs can be generated per second without collisionş* Returned ID format: YYYYMMDDHHMMSSNNNNş*şD = DATE()şT = TIME()şHHMMSS = OCONV(OCONV(T,'MTS'),'MCN')şYYYY = OCONV(D,'DY')şIF LEN(YYYY) < 4 THEN YYYY=YYYY+2000şMM = OCONV(D,'DM') 'R%%'şDD = OCONV(D,'DD') 'R%%'şCTR = 1şREADVU CTR FROM F.CONTROL,'NEXT.ID.COUNTER',1 ELSEş CTR = 1şENDşWRITE CTR+1 ON F.CONTROL,'NEXT.ID.COUNTER' ON ERRORş NULLşENDşNewID = YYYY:MM:DD:HHMMSS:(CTR 'R%%%%')şRETURNşENDş0002A6SUB.LOG.DEBUG.INFOş0c2SUBROUTINE SUB.LOG.DEBUG.INFO(WIDGET.NAME,MESSAGE)ş*ş* Copyright (c) 2020 Zumasys, Inc. All rights reserved.ş*ş* Pass widget name and message to log. When widget is placed in debug mode,ş* up to 100 lines of log content are displayed.ş*şEQU MAX.LINES TO 100ş*şOPEN 'WDB.DEBUG' TO F.WDB.DEBUG THENş  READ EXTRA.INFO FROM F.WDB.DEBUG,WIDGET.NAME ELSE EXTRA.INFO = ''ş  EXTRA.INFO<-1> = TIMEDATE():' ':MESSAGEş  N = DCOUNT(EXTRA.INFO,@AM)ş  IF N > MAX.LINES THENş    * DISCARD ALL EXCEPT LAST 100 LINESş    M = N - MAX.LINESş    K = INDEX(EXTRA.INFO,@AM,M)ş    EXTRA.INFO = EXTRA.INFO[K+1,999999]ş  ENDş  WRITE EXTRA.INFO ON F.WDB.DEBUG,WIDGET.NAMEşRETURNşEND000677REBUILD.URL.STRINGş0c2SUBROUTINE REBUILD.URL.STRING(URL.STRING)ş* 12-15-15ş* 9-23-16 TPARKER - LOGIC TOTALLY REWRITTENşINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEşURL.STRING=''ş*ş** NEED CGI$VARS ALPHABETIZED TO INSURE URL ALWAYS IN SAME ORDERş** BUT EXCLUDE THOSE ADDED BY MVAPPSVRş*şMAX.VARS=DCOUNT(CGI$VARS,@AM)şALPHA.VARS=''şALPHA.VALS=''şFOR VAR.CNTR = 1 TO MAX.VARSş   var=CGI$VARS<VAR.CNTR>ş   BEGIN CASEş      CASE var = 'SIMPLEWEB_MODULE'; var=''ş      CASE var = 'REMOTE_ADDR'; var=''ş      CASE var = 'REMOTE_HOST'; var=''ş      CASE var = 'REMOTE_USER'; var=''ş      CASE var = 'REQUEST_METHOD'; var=''ş      CASE var = 'PROTOCOL_VERSION'; var=''ş      CASE var = 'HTTP_REFERER'; var=''ş      CASE var = 'HTTP_USER_AGENT'; var=''ş      CASE var = 'HTTP_HOST'; var=''ş      CASE var = 'HTTP_ACCEPT'; var=''ş      CASE var = 'HTTP_COOKIE'; var=''ş      CASE var = 'HTTP_CONNECTION'; var=''ş      CASE var = 'SIMPLEWEB_HANDLER'; var=''ş      CASE var = 'PATH_INFO'; var=''ş      CASE var = 'CONTENT_TYPE'; var=''ş      CASE var = 'SERVER_PORT'; var=''ş      CASE var = 'INSTALL_PATH'; var=''ş      CASE var = 'APPSVR_ID'; var=''ş      CASE var = '__body__'; var=''ş      CASE 1; NULLş   END CASEş   IF var <> '' THENş      val=CGI$VALS<VAR.CNTR>ş      LOCATE var IN ALPHA.VARS BY "AL" SETTING POS ELSE NULLş      ALPHA.VARS=INSERT(ALPHA.VARS,POS,0,0,var)ş      ALPHA.VALS=INSERT(ALPHA.VALS,POS,0,0,val)ş    ENDş NEXT VAR.CNTRşMAX.VAR.CNTR=DCOUNT(ALPHA.VARS,@AM)şFOR VAR.CNTR = 1 TO MAX.VAR.CNTRş   var=ALPHA.VARS<VAR.CNTR>ş   val=ALPHA.VALS<VAR.CNTR>ş   URL.STRING:='&':var:'=':valş NEXT VAR.CNTRşURL.STRING=URL.STRING[2,999999]şRETURNşEND0023EFMVDB.INITş0c2*ş*ş* Copyright (C) 2020 Zumasys, Inc., All Rights Reservedş* Description: perform common dashboard startup functionsş*ş* 9-23-16 TPARKER MODIFICATIONS TO ELIMINATE GO_BACK AND REPLACE WITHş*         STANDARD BROWSER BACK BUTTIONş*ş* 10-25-16 Peter Schellenbach - moved this out of INIT.WWW and intoş*          this new MVDB.INIT program to handle all MVDB-specificş*          initialization, then launch individual MVDB resourceş*          programs (MVDB.MAIN, MVDB.ADMIN, MVDB.WEB.ED).ş*ş*          Additional browser back button fixes:ş*            - do not save and restore SESSION as this reflects the login statusş*              and after a logout, using browser back and forward, then loggingş*              back in may cause unexpected logout by using browser back or forward.ş*              Only current_db is restored when backing up.ş*            - push current state before letting MVDB.MAIN process the request.ş*              Since any Go button click or link click only affects a single widget,ş*              only WIDGET.USER.DATA for that specific needs to be pushed. The widgetş*              can be identified by examining CGI variables 'sw' and 'udview' at theş*              next level. We do not know which widget state to save at level 'n'ş*              until we receive a request for level 'n+1' which specifies user inputş*              or drilldown for a specific widget. At this time the widget stateş*              is saved for the previous stack level.ş*            - no need to save and restore CGI variables, as these are all suppliedş*              in the query string in the URL, and when going back up the stack,ş*              the URL and query string matches the stack, so the CGI variablesş*              are identical.ş*            - include the PATH_INFO in the URL when pushing on stack, since weş*              need to handle other resources (MVDB.ADMIN, MVDB.WEB.ED) besidesş*              MVDB.MAIN.ş*şEQU AM TO CHAR(254), VM TO CHAR(253), SVM TO CHAR(252)ş*şINCLUDE WBPD WWW.INCLUDEşINCLUDE WBPD MVDB.INCLUDEş*şOPEN 'WEB.SESSION' TO F.WEB.SESSION ELSE STOP 201, 'WEB.SESSION'şOPEN 'WEB.FORMS' TO F.WEB.FORMS ELSE STOP 201, 'WEB.FORMS' ;** this is in /WWW/ common **şOPEN 'MVDB.UDATA' TO F.MVDB.UDATA ELSE STOP 201, 'MVDB.UDATA'ş*şIF CGI$RESOURCE.NAME = '' THEN CGI$RESOURCE.NAME = 'MVDB.MAIN' ;* safe defaultş*şMAT GLOBAL.INFO = ''ş*ş* Combine headers & cgi vars (MVDB programs don't use CGI$HEADERVARS/CGI$HEADERVALSş*şIF CGI$HEADERVARS <> "" THENş  IF CGI$VARS = "" THENş    CGI$VARS = CGI$HEADERVARSş    CGI$VALS = CGI$HEADERVALSş  END ELSEş    NUM.HDR.VARS = COUNT(CGI$HEADERVARS, @AM)ş    NUM.HDR.VALS = COUNT(CGI$HEADERVALS, @AM)ş    IF NUM.HDR.VARS >= NUM.HDR.VALS THENş      * Since there may be missing (null) vals at end of CGI$HEADERVALS,ş      * add appropriate number of @AM to keep vars & vals in sync!ş      CGI$VARS = CGI$HEADERVARS : @AM : CGI$VARSş      CGI$VALS = CGI$HEADERVALS : STR(@AM, NUM.HDR.VARS - NUM.HDR.VALS + 1) : CGI$VALSş    ENDş  ENDşENDş*ş* Validate the HTTP methodş*şMETHOD = 'UNKNOWN'şLOCATE "REQUEST_METHOD" IN CGI$VARS SETTING POS THEN METHOD = OCONV(CGI$VALS<POS>, 'MCU')şIF METHOD <> 'GET' AND METHOD <> 'POST' THENş  PRINT '500 ERROR Unsupported HTTP Method ':METHODş  STOPşENDş*ş* Load the session ID if there is oneş*şCALL GET.SESSION.ID(SESSION$ID, CGI$VARS, CGI$VALS)şIF (SESSION$ID = '') THENş  CALL CREATE.SESSION(SESSION$ID)ş  CALL SET.COOKIE("sessionid=":SESSION$ID)şENDş*ş* How many active users are online?ş*şSELECT F.WEB.SESSIONşUSER.COUNT = 0şLOOPş  READNEXT WSID ELSE EXITş  READ SREC FROM F.WEB.SESSION, WSID ELSE CONTINUEş  LOCATE "userid" IN SREC<1> SETTING UPOS THEN USER.COUNT += 1şREPEATşPRINT "Client-Count: ":USER.COUNTş*ş* Browser "back" button handlerş*şREAD DD.STACK FROM F.MVDB.UDATA, SESSION$ID:'$DD.STACK' ELSE DD.STACK=''şNEW.STACK.ITEM = 1şMAX.DDS = 0şCALL REBUILD.URL.STRING(URL.STRING)şLOCATE "PATH_INFO" IN CGI$VARS SETTING POS THENş  URL.PATH =  CGI$VALS<POS>ş  IF URL.PATH = "" OR URL.PATH = "/" THEN URL.PATH = CGI$PATH:"/MVDB.MAIN"ş  IF URL.PATH[1,1] # "/" THEN URL.PATH = "/":URL.PATHşEND ELSE URL.PATH = "/dbc/MVDB.MAIN"şURL = URL.PATH:'?':URL.STRINGş**W$GOBACK=0ş*ş**CALL SUB.LOG.DEBUG.INFO('MVDB.INIT','BEGIN REQUEST, SESSION=':SESSION$ID:' URL=':URL:' CUR STACK LEVEL=':DCOUNT(DD.STACK,AM):' METHOD=':METHOD)ş*şIF DD.STACK <> '' THENş  MAX.DDS = DCOUNT(DD.STACK,AM)ş  IF INDEX(DD.STACK,URL,1) THENş    DD.POS = MAX.DDSş    LOOPş      IF DD.POS THENş        IF URL = DD.STACK<DD.POS> THENş          NEW.STACK.ITEM = 0ş        ENDş      ENDş    UNTIL NOT(DD.POS) OR NOT(NEW.STACK.ITEM) DOş      DD.POS = DD.POS - 1ş    REPEATş    IF DD.POS THENş*ş** BACK BUTTON USED SO POP OFF PREVIOUS DRILLDOWNSş*ş      GOSUB PURGE.URLS.AFTER.BACKş      READ GUD FROM F.MVDB.UDATA, SESSION$ID:'$DD.':DD.POS:'.GUD' ELSE GUD=''ş      WRITE GUD ON F.MVDB.UDATA, SESSION$ID:'$UG'ş      READ WUD FROM F.MVDB.UDATA, SESSION$ID:'$DD.':DD.POS:'.WUD' ELSE WUD = ''ş      URL.WIDGET = WUD<1>ş      IF URL.WIDGET <> 'NULL' THENş        WRITE DELETE(WUD,1,0,0) ON F.MVDB.UDATA, SESSION$ID:'$':URL.WIDGETş      ENDş      READ SESSION FROM F.MVDB.UDATA, SESSION$ID:'$DD.':DD.POS:'.SESSION' ELSE SESSION=''ş      LOCATE "userid" IN SESSION<1> SETTING POS THEN userid = SESSION<2,POS> ELSE userid = ''ş      IF userid <> '' THENş* Restore current dashboard from drilldown stack, but leave other session variables aloneş        LOCATE "current_db" IN SESSION<1> SETTING POS THEN current_db = SESSION<2,POS> ELSE current_db = ''ş        CALL PUT.SESSION.VAR("current_db", current_db)ş      ENDş**        W$GOBACK=1ş    ENDş  ENDşENDş*şIF NEW.STACK.ITEM THENş* POST-REDIRECT-GET pattern causes extra GET after POST, but onlyş* the GET is on browser history, so skip duplicate URLs based onş* special CGI variables 'dblogin' and 'dbprg' (note: dbprg is notş* being used at this time).ş  LOCATE "dblogin" IN CGI$VARS SETTING POS THEN dblogin = CGI$VALS<POS> ELSE dblogin = 0ş  LOCATE "dbprg" IN CGI$VARS SETTING POS THEN dbprg = CGI$VALS<POS> ELSE dbprg = 0ş  IF NOT(dblogin) AND NOT(dbprg) THENş* Push the new URL and session state onto the stackş    MAX.DDS += 1ş    DD.STACK<MAX.DDS> = URLş* Save global user before running requestş    READ GUD FROM F.MVDB.UDATA, SESSION$ID:"$UG" ELSE GUD = ''ş    WRITE GUD ON F.MVDB.UDATA, SESSION$ID:'$DD.':MAX.DDS:'.GUD'ş* Get widget name from request CGI variables & save widget user data before running requestş    GOSUB GET.URL.WIDGETş    IF URL.WIDGET = '' THENş      DELETE F.MVDB.UDATA, SESSION$ID:'$DD.':MAX.DDS-1:'.WUD'ş    END ELSEş      READ WUD FROM F.MVDB.UDATA, SESSION$ID:'$':URL.WIDGET ELSE WUD = ''ş      WRITE INSERT(WUD,1,0,0,URL.WIDGET) ON F.MVDB.UDATA, SESSION$ID:'$DD.':MAX.DDS-1:'.WUD'ş    ENDş    READ SESSION FROM F.WEB.SESSION, SESSION$ID ELSE SESSION = ''ş    IF SESSION = '' THENş      DELETE F.MVDB.UDATA, SESSION$ID:'$DD.':MAX.DDS:'.SESSION'ş    END ELSEş      WRITE SESSION ON F.MVDB.UDATA, SESSION$ID:'$DD.':MAX.DDS:'.SESSION'ş    ENDş  ENDşENDşIF DD.STACK = '' THENş  DELETE F.MVDB.UDATA, SESSION$ID:'$DD.STACK'şEND ELSEş  WRITE DD.STACK ON F.MVDB.UDATA, SESSION$ID:'$DD.STACK'şENDş*ş* Run the MVDB program for this resource and check for failureş*şLOOPş  TRY.AGAIN = 0ş  APP.FAILURE = 0ş  EXECUTE CGI$RESOURCE.NAMEş  IF GLOBAL.INFO(100) # 1 THENş* The dashboard controller quit unexpectedly. If there is a runningş* widget, it is likely causing the failure. Fail it, and try again.ş    APP.FAILURE = 1ş    CALL GET.SESSION.VAR("running_widget",FAILED.WIDGET)ş    IF FAILED.WIDGET # "" THENş      CALL PUT.SESSION.VAR("running_widget","")ş      CALL GET.SESSION.VAR("failed_widgets",FAILED.WIDGETS)ş      LOCATE FAILED.WIDGET IN FAILED.WIDGETS SETTING FWPOS ELSEş        FAILED.WIDGETS<-1> = FAILED.WIDGETş        CALL PUT.SESSION.VAR("failed_widgets",FAILED.WIDGETS)ş        TRY.AGAIN = 1ş      ENDş    ENDş    LOCATE "unfail_widget" IN CGI$VARS SETTING DPOS THENş      CGI$VARS = DELETE( CGI$VARS, DPOS, 0, 0 )ş      CGI$VALS = DELETE( CGI$VALS, DPOS, 0, 0 )ş    ENDş  ENDşWHILE TRY.AGAIN DO REPEATşIF APP.FAILURE THENş  CALL WEB.SEND("An application error occured in program ":CGI$RESOURCE.NAME:".<hr>")ş  HTML = '<table><tr><th>Variable</th><th>Value</th></tr>'ş  FOR X = 1 TO DCOUNT( CGI$VARS, @AM )ş    HTML<-1> = '<tr><td>':CGI$VARS<X>:'</td><td>':CGI$VALS<X>:'</td></tr>'ş  NEXT Xş  HTML<-1> = '</table>'ş  CALL WEB.SEND(HTML)şENDş* Final WEB.FLUSH call moved from WDB.INIT to here (makes deploying MVConnect to other accounts simpler)şCALL WEB.FLUSHş*ş* Doneş*şSTOPş*ş* SUPPORT ROUTINES FOR BACK BUTTON HANDLERş*şPURGE.URLS.AFTER.BACK:ş*şFIRST.PURGE = DD.POS + 1şIF FIRST.PURGE > MAX.DDS THEN RETURNşFOR PURGE.CNTR = MAX.DDS TO FIRST.PURGE STEP -1ş  DD.STACK = DELETE(DD.STACK,PURGE.CNTR,0,0)ş  DELETE F.MVDB.UDATA, SESSION$ID:'$DD.':PURGE.CNTR:'.GUD'ş  DELETE F.MVDB.UDATA, SESSION$ID:'$DD.':PURGE.CNTR:'.WUD'ş  DELETE F.MVDB.UDATA, SESSION$ID:'$DD.':PURGE.CNTR:'.SESSION'şNEXT PURGE.CNTRşRETURNş*şGET.URL.WIDGET:ş*şURL.WIDGET='NULL'şLOCATE "sw" IN CGI$VARS SETTING POS THENş  URL.WIDGET = CGI$VALS<POS>şEND ELSEş  LOCATE "udview" IN CGI$VARS SETTING POS THENş    URL.WIDGET = CGI$VALS<POS>ş  ENDşENDşRETURNş*şEND000103SWAPş0c2SUBROUTINE SWAP(string,SUB1,SUB2)ş*ş*#MAKE# RL $OPTIONS D3şIDX.POS = 1şLOOPş  POS = INDEX( string, SUB1, IDX.POS )şWHILE POS DOş  string = string[1,POS-1]:SUB2:string[POS+LEN(SUB1),LEN(string)]ş  IDX.POS = IDX.POS + COUNT(SUB2,SUB1)şREPEATşRETURNşENDş016F3DMVBP.FORMSş0c0016F29listpeqs.htmlş0c2<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">ş<html xmlns="http://www.w3.org/1999/xhtml">ş<head>ş<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />ş<title>Print Queue</title>ş<style type="text/css">şhtml {şmargin:0;şpadding:0;ş}şbody{şmargin:0;şpadding:0;şfont-family:Arial, Helvetica, sans-serif;şfont-size:12px;şbackground: url(/db/images/background_body.gif) 0 0 repeat-x;ş}ş/* *html body {şheight:100%;ş}ş*/şbody.popupş{şmargin:5px 5px 5px 5px;ş}şp, td, thş{şfont-size:1em;ş}şpre {şfont-size:1em;ş}ş#container {şposition:relative;şmargin:0 auto;şpadding:15px 20px 0 20px;ş}ş#header {ş}ş#maincontentş{şbackground: url(/db/images/background_maincontent.gif) 0 0 no-repeat;şpadding:0 0 0 20px;şmargin:0 0 0 0;şposition:relative;ş}ş#content {şbackground: url(/db/images/background_maincontent.gif) 100% 0 no-repeat;şpadding:5px 20px 50px 0;şposition:relative;şmin-height:320px;ş_height:320px;ş}ş/* =HEADER STYLESş=================================================================*/ş#header #navbar {şposition:absolute;ştop:0;şright:-1px;şheight:30px;şlist-style:none;şmargin:0;şpadding:0 5px 0 0;şbackground: url(/db/images/background_navbar.gif) 0 0 repeat-x;ş}ş#header #navbar li {şheight:10px;şfloat:left;şposition:relative;ş}ş#header #navbar li.myreports {şbackground: url(/db/images/background_navbarleft.gif) 0 0 no-repeat;şpadding-left:15px;ş}ş#header #navbar li.completed {şbackground: url(/db/images/background_navbarright.gif) 100% 0 no-repeat;şpadding-right:15px;ş}ş#header #navbar li.admin {şbackground: url(/db/images/background_tabfirst.gif) 0 12px no-repeat;şpadding-left:15px;ş}ş#header #navbar li.admin a{şbackground: url(/db/images/background_tabfirst.gif) 100% 12px no-repeat;şmargin:0;şpadding:7px 12px 0 3px;şline-height:24px;şheight:24px;şcolor: #333333;ş}ş#header #navbar li.profile {şbackground: url(/db/images/background_tabfirst.gif) 0 12px no-repeat;şpadding-left:15px;ş}şbody.admin #header #navbar li.profile {şbackground: url(/db/images/background_tab.gif) 0 12px no-repeat;ş}ş#header #navbar li.profile a{şbackground: url(/db/images/background_tabright.gif) 100% 12px no-repeat;şpadding:7px 15px 0 0;şmargin:0;şline-height:24px;şheight:24px;şcolor: #333333;ş}ş#header #navbar li a {şfloat:left;şheight:32px;şline-height:32px;şmargin:0;şpadding: 0 8px;ştext-decoration:none;ş}ş#header #navbar li a:hover {ştext-decoration:underlineş}ş#header #navbar li.active a {şbackground: url(/db/images/background_navbaractive.gif) 50% 0 no-repeat;şheight:30px;şfont-weight:normal;ş}ş#header #navbar a {şcolor: #FFFFFF;ş}ş#header #logo {şposition:absolute;şleft:10px;ştop:20px;ş}ş#header #welcome {şposition:absolute;şright:15px;ştop:40px;şfont-size:.9em;şcolor:#333333;ş}ş#errors, #messages {şpadding:20px 20px 20px 40px;şborder:1px solid #CCCCCC;şbackground: #EEEEEE;şclear:both;şmargin-bottom:40px;şposition:relative;ş}ş/* =FOOTER STYLESş=================================================================*/ş#footer {ştext-align:center;şfont-size:.8em;şcolor: #999999;şclear:both;ş}ş#footer a {şcolor: #999999;ştext-decoration:none;ş}ş/* =HEADER STYLESş=================================================================*/şh1 {şfont-weight:normal;şfont-size:26px;şletter-spacing:-1px;şmargin:0 0 10px 0;ş}şh2 {şfont-size:22px;şmargin:10px 0 0 0;şfont-weight:normal;ş}şh3 {şmargin:15px 0 5px 0;şfont-weight:normal;şfont-size:16px;şborder-bottom: 1px solid #999999;şposition:relative;ş}şh4 {şmargin:0;şfont-weight:normal;şfont-size:12px;ş}ş/* =BASIC STYLESş=================================================================*/şpş{şmargin: 0 0 10px 0;şline-height:1.3em;ş}şlabelş{şfont-weight:bold;ş}ş/* =TABLE STYLESş=================================================================*/ş.listingş{şborder:1px solid #cccccc;şborder-collapse:collapse;şclear: both;şwidth:100%;şmargin: 0 0 5px 0;ş}ş.listing th, .form .listing th {şbackground-color:#cccccc;şpadding:5px;ştext-align:left;şvertical-align:top;şborder-bottom: 1px solid #cccccc;şcolor: #333333;ş}ştable.sortable th a{şcolor: #333333;ştext-decoration:none;ş}ş.listing td, .form .listing tdş{şpadding:5px;şborder-bottom:1px solid #cccccc;şvertical-align:top;ş}ş.even td, .even th{şbackground: #EEEEEE;ş}ş.odd td, .odd th{şbackground: #FFFFFF;ş}ş.even .odd th, .even .odd td {şbackground: #FFFFFF;ş}şfieldset {şpadding:0 10px 10px 10px;şmargin: 0 0 10px 0;şposition:relative;ş}şlegend {şmargin-top:5px;şfont-size:22px;şmargin-bottom:10px;şfont-weight:normal;şcolor: #000000;şletter-spacing:-1px;ş}ş.form {şborder-collapse:collapse;şmargin: 0;şpadding: 0;ş}ş.form thş{ştext-align:right;şpadding:5px 0 5px 5px;şbackground:none;şvertical-align:top;ş}ş.form tdş{ştext-align:left;şpadding:3px;şvertical-align:top;ş}şspan.button button {şbackground: url(/db/images/background_button.gif) 100% 0 no-repeat;şborder:none;şpadding:0 5px 0 0;şheight:23px;şcolor:#333333;ş}şspan.button {şbackground: url(/db/images/background_button.gif) 0 0 no-repeat;şpadding: 0 0 0 5px;ş}şhtml>body span.button {şpadding: 5px 0 5px 5px;ş}şinput.text {şborder: 1px solid #999999;ş}şinput.date {şwidth:55px;şbackground: url(/db/images/icon_calendar.gif) 2px 50% no-repeat;şpadding-left:20px;şborder: 1px solid #999999;ş}ş/* =PAGING STYLESş=================================================================*/ş.paging{ştext-align:right;ş}ş.wizardtab {şposition:relative;ş}ş.tabnav {ştext-align:right;şpadding-top:10px;ş}ş.note {şfont-size:smaller;şcolor: #666666;şmargin:0;ş}şa:link, a:visited {ştext-decoration: underline;şcolor: #ff8125;ş}şa:hover {ştext-decoration: underline;şcolor: #333;ş}şa img {şborder:none;ş}ş#printqueue tr:hover td, #printqueue tr.hover td {şbackground:#CCCCCC;ş}ş#printqueue tr:hover .preview, #printqueue tr.hover .preview {şdisplay:block;şz-index:200;ş}ş.preview {şposition:absolute;şright:25px;ştop:25px;şmargin-top:-5px;şborder-top:1px solid #666666;şborder-right:1px solid #666666;şborder-left:1px solid #666666;şfont-size:.8em;şpadding:20px 20px 10px 20px;şbackground: url(/db/images/background_preview.gif) 0 100% repeat-x;şdisplay:none;ş_width: 60em;şmin-width:60em;ş}şa.thumbnail pre {şfloat:left;şmargin:5px;şborder-top:1px solid #666666;şborder-right:1px solid #666666;şborder-left:1px solid #666666;şfont-size:4px;şpadding:5em 5em 4em 5em;şbackground: url(/db/images/background_preview.gif) 0 100% repeat-x;şposition:relative;ş}şa.thumbnail {ştext-decoration:none;şcolor:#666666;ş}şa.thumbnail:hover {şcolor:#000000ş}ş.queued td{şbackground:#FFCC33;ş}şdiv.page {şbackground: #FFFFFF;şborder-top:1px solid #BBBBBB;şborder-right:1px solid #999999;şborder-left:1px solid #333333;şborder-bottom:1px solid #000000;şmargin:10px 0;şpadding:20px;şfloat:left;şclear:both;ş_width:60em;şmin-width:60em;şfont-size:.9em;ş}ş.printDialog {şposition:absolute; ştop:5px; şright:0; şwidth:220px; şbackground:#FFFFFF; şborder: 1px solid #CCCCCC; şborder-top:none;ş}ş.printDialog div {şpadding:0 5px 5px 5px;ş}ş.even .printDialog {şbackground: #EEEEEE;ş}ştr.hover .printDialog, tr:hover .printDialog {şbackground:#CCCCCC;şz-index:201;ş}ş#alerts {şmargin: 50px 0 -30px 0;ş}şform {şmargin: 0;şpadding: 0;ş}ş#search_box {şmargin: 0;şposition: absolute;ştop: 20px;şright: 20px;ştext-align: right;ş}ş</style>ş<script>ş<!--şvar BaseURL = "/";ş-->ş</script>ş<script type="text/javascript" language="javascript">ş/*şBehaviour v1.1 by Ben Nolan, June 2005. Based largely on the workşof Simon Willison (see comments by Simon below).şDescription:şUses css selectors to apply javascript behaviours to enableşunobtrusive javascript in html documents.şUsage:   şvar myrules = {ş'b.someclass' : function(element){şelement.onclick = function(){şalert(this.innerHTML);ş}ş},ş'#someid u' : function(element){şelement.onmouseover = function(){şthis.innerHTML = "BLAH!";ş}ş}ş};şBehaviour.register(myrules);şLicense:şMy stuff is BSD licensed. Not sure about Simon's.şMore information:şhttp://ripcord.co.nz/behaviour/ş*/   şvar Behaviour = {şlist : new Array,şregister : function(sheet){şBehaviour.list.push(sheet);ş},şstart : function(){şBehaviour.addLoadEvent(function(){şBehaviour.apply();ş});ş},şapply : function(){şfor (h=0;sheet=Behaviour.list[h];h++){şfor (selector in sheet){şlist = document.getElementsBySelector(selector);şif (!list){şcontinue;ş}şfor (i=0;element=list[i];i++){şsheet[selector](element);ş}ş}ş}ş},şaddLoadEvent : function(func){şvar oldonload = window.onload;şif (typeof window.onload != 'function') {şwindow.onload = func;ş} else {şwindow.onload = function() {şoldonload();şfunc();ş}ş}ş}ş}şBehaviour.start();ş/*şThe following code is Copyright (C) Simon Willison 2004.şdocument.getElementsBySelector(selector)ş- returns an array of element objects from the current documentşmatching the CSS selector. Selectors can contain element names, şclass names and ids and can be nested. For example:şelements = document.getElementsBySelect('div#main p a.external')şWill return an array of all 'a' elements with 'external' in their şclass attribute that are contained inside 'p' elements that are şcontained inside the 'div' element which has id="main"şNew in version 0.4: Support for CSS2 and CSS3 attribute selectors:şSee http://www.w3.org/TR/css3-selectors/#attribute-selectorsşVersion 0.4 - Simon Willison, March 25th 2003ş-- Works in Phoenix 0.5, Mozilla 1.3, Opera 7, Internet Explorer 6, Internet Explorer 5 on Windowsş-- Opera 7 fails ş*/şfunction getAllChildren(e) {şreturn e.all ? e.all : e.getElementsByTagName('*');ş}şdocument.getElementsBySelector = function(selector) {şif (!document.getElementsByTagName) {şreturn new Array();ş}şvar tokens = selector.split(' ');şvar currentContext = new Array(document);şfor (var i = 0; i < tokens.length; i++) {ştoken = tokens[i].replace(/^\s+/,'').replace(/\s+$/,'');;şif (token.indexOf('#') > -1) {şvar bits = token.split('#');şvar tagName = bits[0];şvar id = bits[1];şvar element = document.getElementById(id);şif (tagName && element.nodeName.toLowerCase() != tagName) {şreturn new Array();ş}şcurrentContext = new Array(element);şcontinue; // Skip to next tokenş}şif (token.indexOf('.') > -1) {şvar bits = token.split('.');şvar tagName = bits[0];şvar className = bits[1];şif (!tagName) {ştagName = '*';ş}şvar found = new Array;şvar foundCount = 0;şfor (var h = 0; h < currentContext.length; h++) {şvar elements;şif (tagName == '*') {şelements = getAllChildren(currentContext[h]);ş} else {şelements = currentContext[h].getElementsByTagName(tagName);ş}şfor (var j = 0; j < elements.length; j++) {şfound[foundCount++] = elements[j];ş}ş}şcurrentContext = new Array;şvar currentContextIndex = 0;şfor (var k = 0; k < found.length; k++) {şif (found[k].className && found[k].className.match(new RegExp('\\b'+className+'\\b'))) {şcurrentContext[currentContextIndex++] = found[k];ş}ş}şcontinue; // Skip to next tokenş}şif (token.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)) {şvar tagName = RegExp.$1;şvar attrName = RegExp.$2;şvar attrOperator = RegExp.$3;şvar attrValue = RegExp.$4;şif (!tagName) {ştagName = '*';ş}şvar found = new Array;şvar foundCount = 0;şfor (var h = 0; h < currentContext.length; h++) {şvar elements;şif (tagName == '*') {şelements = getAllChildren(currentContext[h]);ş} else {şelements = currentContext[h].getElementsByTagName(tagName);ş}şfor (var j = 0; j < elements.length; j++) {şfound[foundCount++] = elements[j];ş}ş}şcurrentContext = new Array;şvar currentContextIndex = 0;şvar checkFunction; // This function will be used to filter the elementsşswitch (attrOperator) {şcase '=': // EqualityşcheckFunction = function(e) { return (e.getAttribute(attrName) == attrValue); };şbreak;şcase '~': // Match one of space seperated words şcheckFunction = function(e) { return (e.getAttribute(attrName).match(new RegExp('\\b'+attrValue+'\\b'))); };şbreak;şcase '|': // Match start with value followed by optional hyphenşcheckFunction = function(e) { return (e.getAttribute(attrName).match(new RegExp('^'+attrValue+'-?'))); };şbreak;şcase '^': // Match starts with valueşcheckFunction = function(e) { return (e.getAttribute(attrName).indexOf(attrValue) == 0); };şbreak;şcase '$': // Match ends with value - fails with "Warning" in Opera 7şcheckFunction = function(e) { return (e.getAttribute(attrName).lastIndexOf(attrValue) == e.getAttribute(attrName).length - attrValue.length); };şbreak;şcase '*': // Match ends with valueşcheckFunction = function(e) { return (e.getAttribute(attrName).indexOf(attrValue) > -1); };şbreak;şdefault :şcheckFunction = function(e) { return e.getAttribute(attrName); };ş}şcurrentContext = new Array;şvar currentContextIndex = 0;şfor (var k = 0; k < found.length; k++) {şif (checkFunction(found[k])) {şcurrentContext[currentContextIndex++] = found[k];ş}ş}şcontinue; // Skip to next tokenş}şif (!currentContext[0]){şreturn;ş}ştagName = token;şvar found = new Array;şvar foundCount = 0;şfor (var h = 0; h < currentContext.length; h++) {şvar elements = currentContext[h].getElementsByTagName(tagName);şfor (var j = 0; j < elements.length; j++) {şfound[foundCount++] = elements[j];ş}ş}şcurrentContext = found;ş}şreturn currentContext;ş}ş/* That revolting regular expression explained ş/^(\w+)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/ş\---/  \---/\-------------/    \-------/ş|      |         |               |ş|      |         |           The valueş|      |    ~,|,^,$,* or =ş|   Attribute şTagş*/ş</script>ş<script type="text/javascript" language="javascript">ş/*  Prototype JavaScript framework, version 1.4.0ş*  (c) 2005 Sam Stephenson <sam@conio.net>ş*ş*  THIS FILE IS AUTOMATICALLY GENERATED. When sending patches, please diffş*  against the source tree, available from the Prototype darcs repository.ş*ş*  Prototype is freely distributable under the terms of an MIT-style license.ş*ş*  For details, see the Prototype web site: http://prototype.conio.net/ş*ş/*--------------------------------------------------------------------------*/şvar Prototype = {şVersion: '1.4.0',şScriptFragment: '(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)',şemptyFunction: function() {},şK: function(x) {return x}ş}şvar Class = {şcreate: function() {şreturn function() {şthis.initialize.apply(this, arguments);ş}ş}ş}şvar Abstract = new Object();şObject.extend = function(destination, source) {şfor (property in source) {şdestination[property] = source[property];ş}şreturn destination;ş}şObject.inspect = function(object) {ştry {şif (object == undefined) return 'undefined';şif (object == null) return 'null';şreturn object.inspect ? object.inspect() : object.toString();ş} catch (e) {şif (e instanceof RangeError) return '...';şthrow e;ş}ş}şFunction.prototype.bind = function() {şvar __method = this, args = $A(arguments), object = args.shift();şreturn function() {şreturn __method.apply(object, args.concat($A(arguments)));ş}ş}şFunction.prototype.bindAsEventListener = function(object) {şvar __method = this;şreturn function(event) {şreturn __method.call(object, event || window.event);ş}ş}şObject.extend(Number.prototype, {ştoColorPart: function() {şvar digits = this.toString(16);şif (this < 16) return '0' + digits;şreturn digits;ş},şsucc: function() {şreturn this + 1;ş},ştimes: function(iterator) {ş$R(0, this, true).each(iterator);şreturn this;ş}ş});şvar Try = {şthese: function() {şvar returnValue;şfor (var i = 0; i < arguments.length; i++) {şvar lambda = arguments[i];ştry {şreturnValue = lambda();şbreak;ş} catch (e) {}ş}şreturn returnValue;ş}ş}ş/*--------------------------------------------------------------------------*/şvar PeriodicalExecuter = Class.create();şPeriodicalExecuter.prototype = {şinitialize: function(callback, frequency) {şthis.callback = callback;şthis.frequency = frequency;şthis.currentlyExecuting = false;şthis.registerCallback();ş},şregisterCallback: function() {şsetInterval(this.onTimerEvent.bind(this), this.frequency * 1000);ş},şonTimerEvent: function() {şif (!this.currentlyExecuting) {ştry {şthis.currentlyExecuting = true;şthis.callback();ş} finally {şthis.currentlyExecuting = false;ş}ş}ş}ş}ş/*--------------------------------------------------------------------------*/şfunction $() {şvar elements = new Array();şfor (var i = 0; i < arguments.length; i++) {şvar element = arguments[i];şif (typeof element == 'string')şelement = document.getElementById(element);şif (arguments.length == 1)şreturn element;şelements.push(element);ş}şreturn elements;ş}şObject.extend(String.prototype, {şstripTags: function() {şreturn this.replace(/<\/?[^>]+>/gi, '');ş},şstripScripts: function() {şreturn this.replace(new RegExp(Prototype.ScriptFragment, 'img'), '');ş},şextractScripts: function() {şvar matchAll = new RegExp(Prototype.ScriptFragment, 'img');şvar matchOne = new RegExp(Prototype.ScriptFragment, 'im');şreturn (this.match(matchAll) || []).map(function(scriptTag) {şreturn (scriptTag.match(matchOne) || ['', ''])[1];ş});ş},şevalScripts: function() {şreturn this.extractScripts().map(eval);ş},şescapeHTML: function() {şvar div = document.createElement('div');şvar text = document.createTextNode(this);şdiv.appendChild(text);şreturn div.innerHTML;ş},şunescapeHTML: function() {şvar div = document.createElement('div');şdiv.innerHTML = this.stripTags();şreturn div.childNodes[0] ? div.childNodes[0].nodeValue : '';ş},ştoQueryParams: function() {şvar pairs = this.match(/^\??(.*)$/)[1].split('&');şreturn pairs.inject({}, function(params, pairString) {şvar pair = pairString.split('=');şparams[pair[0]] = pair[1];şreturn params;ş});ş},ştoArray: function() {şreturn this.split('');ş},şcamelize: function() {şvar oStringList = this.split('-');şif (oStringList.length == 1) return oStringList[0];şvar camelizedString = this.indexOf('-') == 0ş? oStringList[0].charAt(0).toUpperCase() + oStringList[0].substring(1)ş: oStringList[0];şfor (var i = 1, len = oStringList.length; i < len; i++) {şvar s = oStringList[i];şcamelizedString += s.charAt(0).toUpperCase() + s.substring(1);ş}şreturn camelizedString;ş},şinspect: function() {şreturn "'" + this.replace('\\', '\\\\').replace("'", '\\\'') + "'";ş}ş});şString.prototype.parseQuery = String.prototype.toQueryParams;şvar $break    = new Object();şvar $continue = new Object();şvar Enumerable = {şeach: function(iterator) {şvar index = 0;ştry {şthis._each(function(value) {ştry {şiterator(value, index++);ş} catch (e) {şif (e != $continue) throw e;ş}ş});ş} catch (e) {şif (e != $break) throw e;ş}ş},şall: function(iterator) {şvar result = true;şthis.each(function(value, index) {şresult = result && !!(iterator || Prototype.K)(value, index);şif (!result) throw $break;ş});şreturn result;ş},şany: function(iterator) {şvar result = true;şthis.each(function(value, index) {şif (result = !!(iterator || Prototype.K)(value, index))şthrow $break;ş});şreturn result;ş},şcollect: function(iterator) {şvar results = [];şthis.each(function(value, index) {şresults.push(iterator(value, index));ş});şreturn results;ş},şdetect: function (iterator) {şvar result;şthis.each(function(value, index) {şif (iterator(value, index)) {şresult = value;şthrow $break;ş}ş});şreturn result;ş},şfindAll: function(iterator) {şvar results = [];şthis.each(function(value, index) {şif (iterator(value, index))şresults.push(value);ş});şreturn results;ş},şgrep: function(pattern, iterator) {şvar results = [];şthis.each(function(value, index) {şvar stringValue = value.toString();şif (stringValue.match(pattern))şresults.push((iterator || Prototype.K)(value, index));ş})şreturn results;ş},şinclude: function(object) {şvar found = false;şthis.each(function(value) {şif (value == object) {şfound = true;şthrow $break;ş}ş});şreturn found;ş},şinject: function(memo, iterator) {şthis.each(function(value, index) {şmemo = iterator(memo, value, index);ş});şreturn memo;ş},şinvoke: function(method) {şvar args = $A(arguments).slice(1);şreturn this.collect(function(value) {şreturn value[method].apply(value, args);ş});ş},şmax: function(iterator) {şvar result;şthis.each(function(value, index) {şvalue = (iterator || Prototype.K)(value, index);şif (value >= (result || value))şresult = value;ş});şreturn result;ş},şmin: function(iterator) {şvar result;şthis.each(function(value, index) {şvalue = (iterator || Prototype.K)(value, index);şif (value <= (result || value))şresult = value;ş});şreturn result;ş},şpartition: function(iterator) {şvar trues = [], falses = [];şthis.each(function(value, index) {ş((iterator || Prototype.K)(value, index) ?ştrues : falses).push(value);ş});şreturn [trues, falses];ş},şpluck: function(property) {şvar results = [];şthis.each(function(value, index) {şresults.push(value[property]);ş});şreturn results;ş},şreject: function(iterator) {şvar results = [];şthis.each(function(value, index) {şif (!iterator(value, index))şresults.push(value);ş});şreturn results;ş},şsortBy: function(iterator) {şreturn this.collect(function(value, index) {şreturn {value: value, criteria: iterator(value, index)};ş}).sort(function(left, right) {şvar a = left.criteria, b = right.criteria;şreturn a < b ? -1 : a > b ? 1 : 0;ş}).pluck('value');ş},ştoArray: function() {şreturn this.collect(Prototype.K);ş},şzip: function() {şvar iterator = Prototype.K, args = $A(arguments);şif (typeof args.last() == 'function')şiterator = args.pop();şvar collections = [this].concat(args).map($A);şreturn this.map(function(value, index) {şiterator(value = collections.pluck(index));şreturn value;ş});ş},şinspect: function() {şreturn '#<Enumerable:' + this.toArray().inspect() + '>';ş}ş}şObject.extend(Enumerable, {şmap:     Enumerable.collect,şfind:    Enumerable.detect,şselect:  Enumerable.findAll,şmember:  Enumerable.include,şentries: Enumerable.toArrayş});şvar $A = Array.from = function(iterable) {şif (!iterable) return [];şif (iterable.toArray) {şreturn iterable.toArray();ş} else {şvar results = [];şfor (var i = 0; i < iterable.length; i++)şresults.push(iterable[i]);şreturn results;ş}ş}şObject.extend(Array.prototype, Enumerable);şArray.prototype._reverse = Array.prototype.reverse;şObject.extend(Array.prototype, {ş_each: function(iterator) {şfor (var i = 0; i < this.length; i++)şiterator(this[i]);ş},şclear: function() {şthis.length = 0;şreturn this;ş},şfirst: function() {şreturn this[0];ş},şlast: function() {şreturn this[this.length - 1];ş},şcompact: function() {şreturn this.select(function(value) {şreturn value != undefined || value != null;ş});ş},şflatten: function() {şreturn this.inject([], function(array, value) {şreturn array.concat(value.constructor == Array ?şvalue.flatten() : [value]);ş});ş},şwithout: function() {şvar values = $A(arguments);şreturn this.select(function(value) {şreturn !values.include(value);ş});ş},şindexOf: function(object) {şfor (var i = 0; i < this.length; i++)şif (this[i] == object) return i;şreturn -1;ş},şreverse: function(inline) {şreturn (inline !== false ? this : this.toArray())._reverse();ş},şshift: function() {şvar result = this[0];şfor (var i = 0; i < this.length - 1; i++)şthis[i] = this[i + 1];şthis.length--;şreturn result;ş},şinspect: function() {şreturn '[' + this.map(Object.inspect).join(', ') + ']';ş}ş});şvar Hash = {ş_each: function(iterator) {şfor (key in this) {şvar value = this[key];şif (typeof value == 'function') continue;şvar pair = [key, value];şpair.key = key;şpair.value = value;şiterator(pair);ş}ş},şkeys: function() {şreturn this.pluck('key');ş},şvalues: function() {şreturn this.pluck('value');ş},şmerge: function(hash) {şreturn $H(hash).inject($H(this), function(mergedHash, pair) {şmergedHash[pair.key] = pair.value;şreturn mergedHash;ş});ş},ştoQueryString: function() {şreturn this.map(function(pair) {şreturn pair.map(encodeURIComponent).join('=');ş}).join('&');ş},şinspect: function() {şreturn '#<Hash:{' + this.map(function(pair) {şreturn pair.map(Object.inspect).join(': ');ş}).join(', ') + '}>';ş}ş}şfunction $H(object) {şvar hash = Object.extend({}, object || {});şObject.extend(hash, Enumerable);şObject.extend(hash, Hash);şreturn hash;ş}şObjectRange = Class.create();şObject.extend(ObjectRange.prototype, Enumerable);şObject.extend(ObjectRange.prototype, {şinitialize: function(start, end, exclusive) {şthis.start = start;şthis.end = end;şthis.exclusive = exclusive;ş},ş_each: function(iterator) {şvar value = this.start;şdo {şiterator(value);şvalue = value.succ();ş} while (this.include(value));ş},şinclude: function(value) {şif (value < this.start)şreturn false;şif (this.exclusive)şreturn value < this.end;şreturn value <= this.end;ş}ş});şvar $R = function(start, end, exclusive) {şreturn new ObjectRange(start, end, exclusive);ş}şvar Ajax = {şgetTransport: function() {şreturn Try.these(şfunction() {return new ActiveXObject('Msxml2.XMLHTTP')},şfunction() {return new ActiveXObject('Microsoft.XMLHTTP')},şfunction() {return new XMLHttpRequest()}ş) || false;ş},şactiveRequestCount: 0ş}şAjax.Responders = {şresponders: [],ş_each: function(iterator) {şthis.responders._each(iterator);ş},şregister: function(responderToAdd) {şif (!this.include(responderToAdd))şthis.responders.push(responderToAdd);ş},şunregister: function(responderToRemove) {şthis.responders = this.responders.without(responderToRemove);ş},şdispatch: function(callback, request, transport, json) {şthis.each(function(responder) {şif (responder[callback] && typeof responder[callback] == 'function') {ştry {şresponder[callback].apply(responder, [request, transport, json]);ş} catch (e) {}ş}ş});ş}ş};şObject.extend(Ajax.Responders, Enumerable);şAjax.Responders.register({şonCreate: function() {şAjax.activeRequestCount++;ş},şonComplete: function() {şAjax.activeRequestCount--;ş}ş});şAjax.Base = function() {};şAjax.Base.prototype = {şsetOptions: function(options) {şthis.options = {şmethod:       'post',şasynchronous: true,şparameters:   ''ş}şObject.extend(this.options, options || {});ş},şresponseIsSuccess: function() {şreturn this.transport.status == undefinedş|| this.transport.status == 0ş|| (this.transport.status >= 200 && this.transport.status < 300);ş},şresponseIsFailure: function() {şreturn !this.responseIsSuccess();ş}ş}şAjax.Request = Class.create();şAjax.Request.Events =ş['Uninitialized', 'Loading', 'Loaded', 'Interactive', 'Complete'];şAjax.Request.prototype = Object.extend(new Ajax.Base(), {şinitialize: function(url, options) {şthis.transport = Ajax.getTransport();şthis.setOptions(options);şthis.request(url);ş},şrequest: function(url) {şvar parameters = this.options.parameters || '';şif (parameters.length > 0) parameters += '&_=';ştry {şthis.url = url;şif (this.options.method == 'get' && parameters.length > 0)şthis.url += (this.url.match(/\?/) ? '&' : '?') + parameters;şAjax.Responders.dispatch('onCreate', this, this.transport);şthis.transport.open(this.options.method, this.url,şthis.options.asynchronous);şif (this.options.asynchronous) {şthis.transport.onreadystatechange = this.onStateChange.bind(this);şsetTimeout((function() {this.respondToReadyState(1)}).bind(this), 10);ş}şthis.setRequestHeaders();şvar body = this.options.postBody ? this.options.postBody : parameters;şthis.transport.send(this.options.method == 'post' ? body : null);ş} catch (e) {şthis.dispatchException(e);ş}ş},şsetRequestHeaders: function() {şvar requestHeaders =ş['X-Requested-With', 'XMLHttpRequest',ş'X-Prototype-Version', Prototype.Version];şif (this.options.method == 'post') {şrequestHeaders.push('Content-type',ş'application/x-www-form-urlencoded');ş/* Force "Connection: close" for Mozilla browsers to work aroundş* a bug where XMLHttpReqeuest sends an incorrect Content-lengthş* header. See Mozilla Bugzilla #246651.ş*/şif (this.transport.overrideMimeType)şrequestHeaders.push('Connection', 'close');ş}şif (this.options.requestHeaders)şrequestHeaders.push.apply(requestHeaders, this.options.requestHeaders);şfor (var i = 0; i < requestHeaders.length; i += 2)şthis.transport.setRequestHeader(requestHeaders[i], requestHeaders[i+1]);ş},şonStateChange: function() {şvar readyState = this.transport.readyState;şif (readyState != 1)şthis.respondToReadyState(this.transport.readyState);ş},şheader: function(name) {ştry {şreturn this.transport.getResponseHeader(name);ş} catch (e) {}ş},şevalJSON: function() {ştry {şreturn eval(this.header('X-JSON'));ş} catch (e) {}ş},şevalResponse: function() {ştry {şreturn eval(this.transport.responseText);ş} catch (e) {şthis.dispatchException(e);ş}ş},şrespondToReadyState: function(readyState) {şvar event = Ajax.Request.Events[readyState];şvar transport = this.transport, json = this.evalJSON();şif (event == 'Complete') {ştry {ş(this.options['on' + this.transport.status]ş|| this.options['on' + (this.responseIsSuccess() ? 'Success' : 'Failure')]ş|| Prototype.emptyFunction)(transport, json);ş} catch (e) {şthis.dispatchException(e);ş}şif ((this.header('Content-type') || '').match(/^text\/javascript/i))şthis.evalResponse();ş}ştry {ş(this.options['on' + event] || Prototype.emptyFunction)(transport, json);şAjax.Responders.dispatch('on' + event, this, transport, json);ş} catch (e) {şthis.dispatchException(e);ş}ş/* Avoid memory leak in MSIE: clean up the oncomplete event handler */şif (event == 'Complete')şthis.transport.onreadystatechange = Prototype.emptyFunction;ş},şdispatchException: function(exception) {ş(this.options.onException || Prototype.emptyFunction)(this, exception);şAjax.Responders.dispatch('onException', this, exception);ş}ş});şAjax.Updater = Class.create();şObject.extend(Object.extend(Ajax.Updater.prototype, Ajax.Request.prototype), {şinitialize: function(container, url, options) {şthis.containers = {şsuccess: container.success ? $(container.success) : $(container),şfailure: container.failure ? $(container.failure) :ş(container.success ? null : $(container))ş}şthis.transport = Ajax.getTransport();şthis.setOptions(options);şvar onComplete = this.options.onComplete || Prototype.emptyFunction;şthis.options.onComplete = (function(transport, object) {şthis.updateContent();şonComplete(transport, object);ş}).bind(this);şthis.request(url);ş},şupdateContent: function() {şvar receiver = this.responseIsSuccess() ?şthis.containers.success : this.containers.failure;şvar response = this.transport.responseText;şif (!this.options.evalScripts)şresponse = response.stripScripts();şif (receiver) {şif (this.options.insertion) {şnew this.options.insertion(receiver, response);ş} else {şElement.update(receiver, response);ş}ş}şif (this.responseIsSuccess()) {şif (this.onComplete)şsetTimeout(this.onComplete.bind(this), 10);ş}ş}ş});şAjax.PeriodicalUpdater = Class.create();şAjax.PeriodicalUpdater.prototype = Object.extend(new Ajax.Base(), {şinitialize: function(container, url, options) {şthis.setOptions(options);şthis.onComplete = this.options.onComplete;şthis.frequency = (this.options.frequency || 2);şthis.decay = (this.options.decay || 1);şthis.updater = {};şthis.container = container;şthis.url = url;şthis.start();ş},şstart: function() {şthis.options.onComplete = this.updateComplete.bind(this);şthis.onTimerEvent();ş},şstop: function() {şthis.updater.onComplete = undefined;şclearTimeout(this.timer);ş(this.onComplete || Prototype.emptyFunction).apply(this, arguments);ş},şupdateComplete: function(request) {şif (this.options.decay) {şthis.decay = (request.responseText == this.lastText ?şthis.decay * this.options.decay : 1);şthis.lastText = request.responseText;ş}şthis.timer = setTimeout(this.onTimerEvent.bind(this),şthis.decay * this.frequency * 1000);ş},şonTimerEvent: function() {şthis.updater = new Ajax.Updater(this.container, this.url, this.options);ş}ş});şdocument.getElementsByClassName = function(className, parentElement) {şvar children = ($(parentElement) || document.body).getElementsByTagName('*');şreturn $A(children).inject([], function(elements, child) {şif (child.className.match(new RegExp("(^|\\s)" + className + "(\\s|$)")))şelements.push(child);şreturn elements;ş});ş}ş/*--------------------------------------------------------------------------*/şif (!window.Element) {şvar Element = new Object();ş}şObject.extend(Element, {şvisible: function(element) {şreturn $(element).style.display != 'none';ş},ştoggle: function() {şfor (var i = 0; i < arguments.length; i++) {şvar element = $(arguments[i]);şElement[Element.visible(element) ? 'hide' : 'show'](element);ş}ş},şhide: function() {şfor (var i = 0; i < arguments.length; i++) {şvar element = $(arguments[i]);şelement.style.display = 'none';ş}ş},şshow: function() {şfor (var i = 0; i < arguments.length; i++) {şvar element = $(arguments[i]);şelement.style.display = '';ş}ş},şremove: function(element) {şelement = $(element);şelement.parentNode.removeChild(element);ş},şupdate: function(element, html) {ş$(element).innerHTML = html.stripScripts();şsetTimeout(function() {html.evalScripts()}, 10);ş},şgetHeight: function(element) {şelement = $(element);şreturn element.offsetHeight;ş},şclassNames: function(element) {şreturn new Element.ClassNames(element);ş},şhasClassName: function(element, className) {şif (!(element = $(element))) return;şreturn Element.classNames(element).include(className);ş},şaddClassName: function(element, className) {şif (!(element = $(element))) return;şreturn Element.classNames(element).add(className);ş},şremoveClassName: function(element, className) {şif (!(element = $(element))) return;şreturn Element.classNames(element).remove(className);ş},şcleanWhitespace: function(element) {şelement = $(element);şfor (var i = 0; i < element.childNodes.length; i++) {şvar node = element.childNodes[i];şif (node.nodeType == 3 && !/\S/.test(node.nodeValue))şElement.remove(node);ş}ş},şempty: function(element) {şreturn $(element).innerHTML.match(/^\s*$/);ş},şscrollTo: function(element) {şelement = $(element);şvar x = element.x ? element.x : element.offsetLeft,şy = element.y ? element.y : element.offsetTop;şwindow.scrollTo(x, y);ş},şgetStyle: function(element, style) {şelement = $(element);şvar value = element.style[style.camelize()];şif (!value) {şif (document.defaultView && document.defaultView.getComputedStyle) {şvar css = document.defaultView.getComputedStyle(element, null);şvalue = css ? css.getPropertyValue(style) : null;ş} else if (element.currentStyle) {şvalue = element.currentStyle[style.camelize()];ş}ş}şif (window.opera && ['left', 'top', 'right', 'bottom'].include(style))şif (Element.getStyle(element, 'position') == 'static') value = 'auto';şreturn value == 'auto' ? null : value;ş},şsetStyle: function(element, style) {şelement = $(element);şfor (name in style)şelement.style[name.camelize()] = style[name];ş},şgetDimensions: function(element) {şelement = $(element);şif (Element.getStyle(element, 'display') != 'none')şreturn {width: element.offsetWidth, height: element.offsetHeight};şvar els = element.style;şvar originalVisibility = els.visibility;şvar originalPosition = els.position;şels.visibility = 'hidden';şels.position = 'absolute';şels.display = '';şvar originalWidth = element.clientWidth;şvar originalHeight = element.clientHeight;şels.display = 'none';şels.position = originalPosition;şels.visibility = originalVisibility;şreturn {width: originalWidth, height: originalHeight};ş},şmakePositioned: function(element) {şelement = $(element);şvar pos = Element.getStyle(element, 'position');şif (pos == 'static' || !pos) {şelement._madePositioned = true;şelement.style.position = 'relative';şif (window.opera) {şelement.style.top = 0;şelement.style.left = 0;ş}ş}ş},şundoPositioned: function(element) {şelement = $(element);şif (element._madePositioned) {şelement._madePositioned = undefined;şelement.style.position =şelement.style.top =şelement.style.left =şelement.style.bottom =şelement.style.right = '';ş}ş},şmakeClipping: function(element) {şelement = $(element);şif (element._overflow) return;şelement._overflow = element.style.overflow;şif ((Element.getStyle(element, 'overflow') || 'visible') != 'hidden')şelement.style.overflow = 'hidden';ş},şundoClipping: function(element) {şelement = $(element);şif (element._overflow) return;şelement.style.overflow = element._overflow;şelement._overflow = undefined;ş}ş});şvar Toggle = new Object();şToggle.display = Element.toggle;ş/*--------------------------------------------------------------------------*/şAbstract.Insertion = function(adjacency) {şthis.adjacency = adjacency;ş}şAbstract.Insertion.prototype = {şinitialize: function(element, content) {şthis.element = $(element);şthis.content = content.stripScripts();şif (this.adjacency && this.element.insertAdjacentHTML) {ştry {şthis.element.insertAdjacentHTML(this.adjacency, this.content);ş} catch (e) {şif (this.element.tagName.toLowerCase() == 'tbody') {şthis.insertContent(this.contentFromAnonymousTable());ş} else {şthrow e;ş}ş}ş} else {şthis.range = this.element.ownerDocument.createRange();şif (this.initializeRange) this.initializeRange();şthis.insertContent([this.range.createContextualFragment(this.content)]);ş}şsetTimeout(function() {content.evalScripts()}, 10);ş},şcontentFromAnonymousTable: function() {şvar div = document.createElement('div');şdiv.innerHTML = '<table><tbody>' + this.content + '</tbody></table>';şreturn $A(div.childNodes[0].childNodes[0].childNodes);ş}ş}şvar Insertion = new Object();şInsertion.Before = Class.create();şInsertion.Before.prototype = Object.extend(new Abstract.Insertion('beforeBegin'), {şinitializeRange: function() {şthis.range.setStartBefore(this.element);ş},şinsertContent: function(fragments) {şfragments.each((function(fragment) {şthis.element.parentNode.insertBefore(fragment, this.element);ş}).bind(this));ş}ş});şInsertion.Top = Class.create();şInsertion.Top.prototype = Object.extend(new Abstract.Insertion('afterBegin'), {şinitializeRange: function() {şthis.range.selectNodeContents(this.element);şthis.range.collapse(true);ş},şinsertContent: function(fragments) {şfragments.reverse(false).each((function(fragment) {şthis.element.insertBefore(fragment, this.element.firstChild);ş}).bind(this));ş}ş});şInsertion.Bottom = Class.create();şInsertion.Bottom.prototype = Object.extend(new Abstract.Insertion('beforeEnd'), {şinitializeRange: function() {şthis.range.selectNodeContents(this.element);şthis.range.collapse(this.element);ş},şinsertContent: function(fragments) {şfragments.each((function(fragment) {şthis.element.appendChild(fragment);ş}).bind(this));ş}ş});şInsertion.After = Class.create();şInsertion.After.prototype = Object.extend(new Abstract.Insertion('afterEnd'), {şinitializeRange: function() {şthis.range.setStartAfter(this.element);ş},şinsertContent: function(fragments) {şfragments.each((function(fragment) {şthis.element.parentNode.insertBefore(fragment,şthis.element.nextSibling);ş}).bind(this));ş}ş});ş/*--------------------------------------------------------------------------*/şElement.ClassNames = Class.create();şElement.ClassNames.prototype = {şinitialize: function(element) {şthis.element = $(element);ş},ş_each: function(iterator) {şthis.element.className.split(/\s+/).select(function(name) {şreturn name.length > 0;ş})._each(iterator);ş},şset: function(className) {şthis.element.className = className;ş},şadd: function(classNameToAdd) {şif (this.include(classNameToAdd)) return;şthis.set(this.toArray().concat(classNameToAdd).join(' '));ş},şremove: function(classNameToRemove) {şif (!this.include(classNameToRemove)) return;şthis.set(this.select(function(className) {şreturn className != classNameToRemove;ş}).join(' '));ş},ştoString: function() {şreturn this.toArray().join(' ');ş}ş}şObject.extend(Element.ClassNames.prototype, Enumerable);şvar Field = {şclear: function() {şfor (var i = 0; i < arguments.length; i++)ş$(arguments[i]).value = '';ş},şfocus: function(element) {ş$(element).focus();ş},şpresent: function() {şfor (var i = 0; i < arguments.length; i++)şif ($(arguments[i]).value == '') return false;şreturn true;ş},şselect: function(element) {ş$(element).select();ş},şactivate: function(element) {şelement = $(element);şelement.focus();şif (element.select)şelement.select();ş}ş}ş/*--------------------------------------------------------------------------*/şvar Form = {şserialize: function(form) {şvar elements = Form.getElements($(form));şvar queryComponents = new Array();şfor (var i = 0; i < elements.length; i++) {şvar queryComponent = Form.Element.serialize(elements[i]);şif (queryComponent)şqueryComponents.push(queryComponent);ş}şreturn queryComponents.join('&');ş},şgetElements: function(form) {şform = $(form);şvar elements = new Array();şfor (tagName in Form.Element.Serializers) {şvar tagElements = form.getElementsByTagName(tagName);şfor (var j = 0; j < tagElements.length; j++)şelements.push(tagElements[j]);ş}şreturn elements;ş},şgetInputs: function(form, typeName, name) {şform = $(form);şvar inputs = form.getElementsByTagName('input');şif (!typeName && !name)şreturn inputs;şvar matchingInputs = new Array();şfor (var i = 0; i < inputs.length; i++) {şvar input = inputs[i];şif ((typeName && input.type != typeName) ||ş(name && input.name != name))şcontinue;şmatchingInputs.push(input);ş}şreturn matchingInputs;ş},şdisable: function(form) {şvar elements = Form.getElements(form);şfor (var i = 0; i < elements.length; i++) {şvar element = elements[i];şelement.blur();şelement.disabled = 'true';ş}ş},şenable: function(form) {şvar elements = Form.getElements(form);şfor (var i = 0; i < elements.length; i++) {şvar element = elements[i];şelement.disabled = '';ş}ş},şfindFirstElement: function(form) {şreturn Form.getElements(form).find(function(element) {şreturn element.type != 'hidden' && !element.disabled &&ş['input', 'select', 'textarea'].include(element.tagName.toLowerCase());ş});ş},şfocusFirstElement: function(form) {şField.activate(Form.findFirstElement(form));ş},şreset: function(form) {ş$(form).reset();ş}ş}şForm.Element = {şserialize: function(element) {şelement = $(element);şvar method = element.tagName.toLowerCase();şvar parameter = Form.Element.Serializers[method](element);şif (parameter) {şvar key = encodeURIComponent(parameter[0]);şif (key.length == 0) return;şif (parameter[1].constructor != Array)şparameter[1] = [parameter[1]];şreturn parameter[1].map(function(value) {şreturn key + '=' + encodeURIComponent(value);ş}).join('&');ş}ş},şgetValue: function(element) {şelement = $(element);şvar method = element.tagName.toLowerCase();şvar parameter = Form.Element.Serializers[method](element);şif (parameter)şreturn parameter[1];ş}ş}şForm.Element.Serializers = {şinput: function(element) {şswitch (element.type.toLowerCase()) {şcase 'submit':şcase 'hidden':şcase 'password':şcase 'text':şreturn Form.Element.Serializers.textarea(element);şcase 'checkbox':şcase 'radio':şreturn Form.Element.Serializers.inputSelector(element);ş}şreturn false;ş},şinputSelector: function(element) {şif (element.checked)şreturn [element.name, element.value];ş},ştextarea: function(element) {şreturn [element.name, element.value];ş},şselect: function(element) {şreturn Form.Element.Serializers[element.type == 'select-one' ?ş'selectOne' : 'selectMany'](element);ş},şselectOne: function(element) {şvar value = '', opt, index = element.selectedIndex;şif (index >= 0) {şopt = element.options[index];şvalue = opt.value;şif (!value && !('value' in opt))şvalue = opt.text;ş}şreturn [element.name, value];ş},şselectMany: function(element) {şvar value = new Array();şfor (var i = 0; i < element.length; i++) {şvar opt = element.options[i];şif (opt.selected) {şvar optValue = opt.value;şif (!optValue && !('value' in opt))şoptValue = opt.text;şvalue.push(optValue);ş}ş}şreturn [element.name, value];ş}ş}ş/*--------------------------------------------------------------------------*/şvar $F = Form.Element.getValue;ş/*--------------------------------------------------------------------------*/şAbstract.TimedObserver = function() {}şAbstract.TimedObserver.prototype = {şinitialize: function(element, frequency, callback) {şthis.frequency = frequency;şthis.element   = $(element);şthis.callback  = callback;şthis.lastValue = this.getValue();şthis.registerCallback();ş},şregisterCallback: function() {şsetInterval(this.onTimerEvent.bind(this), this.frequency * 1000);ş},şonTimerEvent: function() {şvar value = this.getValue();şif (this.lastValue != value) {şthis.callback(this.element, value);şthis.lastValue = value;ş}ş}ş}şForm.Element.Observer = Class.create();şForm.Element.Observer.prototype = Object.extend(new Abstract.TimedObserver(), {şgetValue: function() {şreturn Form.Element.getValue(this.element);ş}ş});şForm.Observer = Class.create();şForm.Observer.prototype = Object.extend(new Abstract.TimedObserver(), {şgetValue: function() {şreturn Form.serialize(this.element);ş}ş});ş/*--------------------------------------------------------------------------*/şAbstract.EventObserver = function() {}şAbstract.EventObserver.prototype = {şinitialize: function(element, callback) {şthis.element  = $(element);şthis.callback = callback;şthis.lastValue = this.getValue();şif (this.element.tagName.toLowerCase() == 'form')şthis.registerFormCallbacks();şelseşthis.registerCallback(this.element);ş},şonElementEvent: function() {şvar value = this.getValue();şif (this.lastValue != value) {şthis.callback(this.element, value);şthis.lastValue = value;ş}ş},şregisterFormCallbacks: function() {şvar elements = Form.getElements(this.element);şfor (var i = 0; i < elements.length; i++)şthis.registerCallback(elements[i]);ş},şregisterCallback: function(element) {şif (element.type) {şswitch (element.type.toLowerCase()) {şcase 'checkbox':şcase 'radio':şEvent.observe(element, 'click', this.onElementEvent.bind(this));şbreak;şcase 'password':şcase 'text':şcase 'textarea':şcase 'select-one':şcase 'select-multiple':şEvent.observe(element, 'change', this.onElementEvent.bind(this));şbreak;ş}ş}ş}ş}şForm.Element.EventObserver = Class.create();şForm.Element.EventObserver.prototype = Object.extend(new Abstract.EventObserver(), {şgetValue: function() {şreturn Form.Element.getValue(this.element);ş}ş});şForm.EventObserver = Class.create();şForm.EventObserver.prototype = Object.extend(new Abstract.EventObserver(), {şgetValue: function() {şreturn Form.serialize(this.element);ş}ş});şif (!window.Event) {şvar Event = new Object();ş}şObject.extend(Event, {şKEY_BACKSPACE: 8,şKEY_TAB:       9,şKEY_RETURN:   13,şKEY_ESC:      27,şKEY_LEFT:     37,şKEY_UP:       38,şKEY_RIGHT:    39,şKEY_DOWN:     40,şKEY_DELETE:   46,şelement: function(event) {şreturn event.target || event.srcElement;ş},şisLeftClick: function(event) {şreturn (((event.which) && (event.which == 1)) ||ş((event.button) && (event.button == 1)));ş},şpointerX: function(event) {şreturn event.pageX || (event.clientX +ş(document.documentElement.scrollLeft || document.body.scrollLeft));ş},şpointerY: function(event) {şreturn event.pageY || (event.clientY +ş(document.documentElement.scrollTop || document.body.scrollTop));ş},şstop: function(event) {şif (event.preventDefault) {şevent.preventDefault();şevent.stopPropagation();ş} else {şevent.returnValue = false;şevent.cancelBubble = true;ş}ş},şfindElement: function(event, tagName) {şvar element = Event.element(event);şwhile (element.parentNode && (!element.tagName ||ş(element.tagName.toUpperCase() != tagName.toUpperCase())))şelement = element.parentNode;şreturn element;ş},şobservers: false,ş_observeAndCache: function(element, name, observer, useCapture) {şif (!this.observers) this.observers = [];şif (element.addEventListener) {şthis.observers.push([element, name, observer, useCapture]);şelement.addEventListener(name, observer, useCapture);ş} else if (element.attachEvent) {şthis.observers.push([element, name, observer, useCapture]);şelement.attachEvent('on' + name, observer);ş}ş},şunloadCache: function() {şif (!Event.observers) return;şfor (var i = 0; i < Event.observers.length; i++) {şEvent.stopObserving.apply(this, Event.observers[i]);şEvent.observers[i][0] = null;ş}şEvent.observers = false;ş},şobserve: function(element, name, observer, useCapture) {şvar element = $(element);şuseCapture = useCapture || false;şif (name == 'keypress' &&ş(navigator.appVersion.match(/Konqueror|Safari|KHTML/)ş|| element.attachEvent))şname = 'keydown';şthis._observeAndCache(element, name, observer, useCapture);ş},şstopObserving: function(element, name, observer, useCapture) {şvar element = $(element);şuseCapture = useCapture || false;şif (name == 'keypress' &&ş(navigator.appVersion.match(/Konqueror|Safari|KHTML/)ş|| element.detachEvent))şname = 'keydown';şif (element.removeEventListener) {şelement.removeEventListener(name, observer, useCapture);ş} else if (element.detachEvent) {şelement.detachEvent('on' + name, observer);ş}ş}ş});ş/* prevent memory leaks in IE */şEvent.observe(window, 'unload', Event.unloadCache, false);şvar Position = {şincludeScrollOffsets: false,şprepare: function() {şthis.deltaX =  window.pageXOffsetş|| document.documentElement.scrollLeftş|| document.body.scrollLeftş|| 0;şthis.deltaY =  window.pageYOffsetş|| document.documentElement.scrollTopş|| document.body.scrollTopş|| 0;ş},şrealOffset: function(element) {şvar valueT = 0, valueL = 0;şdo {şvalueT += element.scrollTop  || 0;şvalueL += element.scrollLeft || 0;şelement = element.parentNode;ş} while (element);şreturn [valueL, valueT];ş},şcumulativeOffset: function(element) {şvar valueT = 0, valueL = 0;şdo {şvalueT += element.offsetTop  || 0;şvalueL += element.offsetLeft || 0;şelement = element.offsetParent;ş} while (element);şreturn [valueL, valueT];ş},şpositionedOffset: function(element) {şvar valueT = 0, valueL = 0;şdo {şvalueT += element.offsetTop  || 0;şvalueL += element.offsetLeft || 0;şelement = element.offsetParent;şif (element) {şp = Element.getStyle(element, 'position');şif (p == 'relative' || p == 'absolute') break;ş}ş} while (element);şreturn [valueL, valueT];ş},şoffsetParent: function(element) {şif (element.offsetParent) return element.offsetParent;şif (element == document.body) return element;şwhile ((element = element.parentNode) && element != document.body)şif (Element.getStyle(element, 'position') != 'static')şreturn element;şreturn document.body;ş},şwithin: function(element, x, y) {şif (this.includeScrollOffsets)şreturn this.withinIncludingScrolloffsets(element, x, y);şthis.xcomp = x;şthis.ycomp = y;şthis.offset = this.cumulativeOffset(element);şreturn (y >= this.offset[1] &&şy <  this.offset[1] + element.offsetHeight &&şx >= this.offset[0] &&şx <  this.offset[0] + element.offsetWidth);ş},şwithinIncludingScrolloffsets: function(element, x, y) {şvar offsetcache = this.realOffset(element);şthis.xcomp = x + offsetcache[0] - this.deltaX;şthis.ycomp = y + offsetcache[1] - this.deltaY;şthis.offset = this.cumulativeOffset(element);şreturn (this.ycomp >= this.offset[1] &&şthis.ycomp <  this.offset[1] + element.offsetHeight &&şthis.xcomp >= this.offset[0] &&şthis.xcomp <  this.offset[0] + element.offsetWidth);ş},şoverlap: function(mode, element) {şif (!mode) return 0;şif (mode == 'vertical')şreturn ((this.offset[1] + element.offsetHeight) - this.ycomp) /şelement.offsetHeight;şif (mode == 'horizontal')şreturn ((this.offset[0] + element.offsetWidth) - this.xcomp) /şelement.offsetWidth;ş},şclone: function(source, target) {şsource = $(source);ştarget = $(target);ştarget.style.position = 'absolute';şvar offsets = this.cumulativeOffset(source);ştarget.style.top    = offsets[1] + 'px';ştarget.style.left   = offsets[0] + 'px';ştarget.style.width  = source.offsetWidth + 'px';ştarget.style.height = source.offsetHeight + 'px';ş},şpage: function(forElement) {şvar valueT = 0, valueL = 0;şvar element = forElement;şdo {şvalueT += element.offsetTop  || 0;şvalueL += element.offsetLeft || 0;şif (element.offsetParent==document.body)şif (Element.getStyle(element,'position')=='absolute') break;ş} while (element = element.offsetParent);şelement = forElement;şdo {şvalueT -= element.scrollTop  || 0;şvalueL -= element.scrollLeft || 0;ş} while (element = element.parentNode);şreturn [valueL, valueT];ş},şclone: function(source, target) {şvar options = Object.extend({şsetLeft:    true,şsetTop:     true,şsetWidth:   true,şsetHeight:  true,şoffsetTop:  0,şoffsetLeft: 0ş}, arguments[2] || {})şsource = $(source);şvar p = Position.page(source);ştarget = $(target);şvar delta = [0, 0];şvar parent = null;şif (Element.getStyle(target,'position') == 'absolute') {şparent = Position.offsetParent(target);şdelta = Position.page(parent);ş}şif (parent == document.body) {şdelta[0] -= document.body.offsetLeft;şdelta[1] -= document.body.offsetTop;ş}şif(options.setLeft)   target.style.left  = (p[0] - delta[0] + options.offsetLeft) + 'px';şif(options.setTop)    target.style.top   = (p[1] - delta[1] + options.offsetTop) + 'px';şif(options.setWidth)  target.style.width = source.offsetWidth + 'px';şif(options.setHeight) target.style.height = source.offsetHeight + 'px';ş},şabsolutize: function(element) {şelement = $(element);şif (element.style.position == 'absolute') return;şPosition.prepare();şvar offsets = Position.positionedOffset(element);şvar top     = offsets[1];şvar left    = offsets[0];şvar width   = element.clientWidth;şvar height  = element.clientHeight;şelement._originalLeft   = left - parseFloat(element.style.left  || 0);şelement._originalTop    = top  - parseFloat(element.style.top || 0);şelement._originalWidth  = element.style.width;şelement._originalHeight = element.style.height;şelement.style.position = 'absolute';şelement.style.top    = top + 'px';;şelement.style.left   = left + 'px';;şelement.style.width  = width + 'px';;şelement.style.height = height + 'px';;ş},şrelativize: function(element) {şelement = $(element);şif (element.style.position == 'relative') return;şPosition.prepare();şelement.style.position = 'relative';şvar top  = parseFloat(element.style.top  || 0) - (element._originalTop || 0);şvar left = parseFloat(element.style.left || 0) - (element._originalLeft || 0);şelement.style.top    = top + 'px';şelement.style.left   = left + 'px';şelement.style.height = element._originalHeight;şelement.style.width  = element._originalWidth;ş}ş}şif (/Konqueror|Safari|KHTML/.test(navigator.userAgent)) {şPosition.cumulativeOffset = function(element) {şvar valueT = 0, valueL = 0;şdo {şvalueT += element.offsetTop  || 0;şvalueL += element.offsetLeft || 0;şif (element.offsetParent == document.body)şif (Element.getStyle(element, 'position') == 'absolute') break;şelement = element.offsetParent;ş} while (element);şreturn [valueL, valueT];ş}ş}ş</script>ş<!-- <script type="text/javascript" language="javascript" src="/scripts/scriptaculous.js"></script> -->ş<script type="text/javascript" language="javascript">ş/* ------------- element ext -------------- */  şString.prototype.parseColor = function() {  şvar color = '#';  şif(this.slice(0,4) == 'rgb(') {  şvar cols = this.slice(4,this.length-1).split(',');  şvar i=0; do { color += parseInt(cols[i]).toColorPart() } while (++i<3);  ş} else {  şif(this.slice(0,1) == '#') {  şif(this.length==4) for(var i=1;i<4;i++) color += (this.charAt(i) + this.charAt(i)).toLowerCase();  şif(this.length==7) color = this.toLowerCase();  ş}  ş}  şreturn(color.length==7 ? color : (arguments[0] || this));  ş}şElement.collectTextNodes = function(element) {  şreturn $A($(element).childNodes).collect( function(node) {şreturn (node.nodeType==3 ? node.nodeValue : ş(node.hasChildNodes() ? Element.collectTextNodes(node) : ''));ş}).flatten().join('');ş}şElement.collectTextNodesIgnoreClass = function(element, className) {  şreturn $A($(element).childNodes).collect( function(node) {şreturn (node.nodeType==3 ? node.nodeValue : ş((node.hasChildNodes() && !Element.hasClassName(node,className)) ? şElement.collectTextNodes(node) : ''));ş}).flatten().join('');ş}şElement.setStyle = function(element, style) {şelement = $(element);şfor(k in style) element.style[k.camelize()] = style[k];ş}şElement.setContentZoom = function(element, percent) {  şElement.setStyle(element, {fontSize: (percent/100) + 'em'});   şif(navigator.appVersion.indexOf('AppleWebKit')>0) window.scrollBy(0,0);  ş}şElement.getOpacity = function(element){  şvar opacity;şif (opacity = Element.getStyle(element, 'opacity'))  şreturn parseFloat(opacity);  şif (opacity = (Element.getStyle(element, 'filter') || '').match(/alpha\(opacity=(.*)\)/))  şif(opacity[1]) return parseFloat(opacity[1]) / 100;  şreturn 1.0;  ş}şElement.setOpacity = function(element, value){  şelement= $(element);  şif (value == 1){şElement.setStyle(element, { opacity: ş(/Gecko/.test(navigator.userAgent) && !/Konqueror|Safari|KHTML/.test(navigator.userAgent)) ? ş0.999999 : null });şif(/MSIE/.test(navigator.userAgent))  şElement.setStyle(element, {filter: Element.getStyle(element,'filter').replace(/alpha\([^\)]*\)/gi,'')});  ş} else {  şif(value < 0.00001) value = 0;  şElement.setStyle(element, {opacity: value});şif(/MSIE/.test(navigator.userAgent))  şElement.setStyle(element, ş{ filter: Element.getStyle(element,'filter').replace(/alpha\([^\)]*\)/gi,'') +ş'alpha(opacity='+value*100+')' });  ş}   ş}  şElement.getInlineOpacity = function(element){  şreturn $(element).style.opacity || '';ş}  şElement.childrenWithClassName = function(element, className) {  şreturn $A($(element).getElementsByTagName('*')).select(şfunction(c) { return Element.hasClassName(c, className) });ş}şArray.prototype.call = function() {şvar args = arguments;şthis.each(function(f){ f.apply(this, args) });ş}ş/*--------------------------------------------------------------------------*/şvar Effect = {ştagifyText: function(element) {şvar tagifyStyle = 'position:relative';şif(/MSIE/.test(navigator.userAgent)) tagifyStyle += ';zoom:1';şelement = $(element);ş$A(element.childNodes).each( function(child) {şif(child.nodeType==3) {şchild.nodeValue.toArray().each( function(character) {şelement.insertBefore(şBuilder.node('span',{style: tagifyStyle},şcharacter == ' ' ? String.fromCharCode(160) : character), şchild);ş});şElement.remove(child);ş}ş});ş},şmultiple: function(element, effect) {şvar elements;şif(((typeof element == 'object') || ş(typeof element == 'function')) && ş(element.length))şelements = element;şelseşelements = $(element).childNodes;şvar options = Object.extend({şspeed: 0.1,şdelay: 0.0ş}, arguments[2] || {});şvar masterDelay = options.delay;ş$A(elements).each( function(element, index) {şnew effect(element, Object.extend(options, { delay: index * options.speed + masterDelay }));ş});ş},şPAIRS: {ş'slide':  ['SlideDown','SlideUp'],ş'blind':  ['BlindDown','BlindUp'],ş'appear': ['Appear','Fade']ş},ştoggle: function(element, effect) {şelement = $(element);şeffect = (effect || 'appear').toLowerCase();şvar options = Object.extend({şqueue: { position:'end', scope:(element.id || 'global') }ş}, arguments[2] || {});şEffect[Element.visible(element) ? şEffect.PAIRS[effect][1] : Effect.PAIRS[effect][0]](element, options);ş}ş};şvar Effect2 = Effect; // deprecatedş/* ------------- transitions ------------- */şEffect.Transitions = {}şEffect.Transitions.linear = function(pos) {şreturn pos;ş}şEffect.Transitions.sinoidal = function(pos) {şreturn (-Math.cos(pos*Math.PI)/2) + 0.5;ş}şEffect.Transitions.reverse  = function(pos) {şreturn 1-pos;ş}şEffect.Transitions.flicker = function(pos) {şreturn ((-Math.cos(pos*Math.PI)/4) + 0.75) + Math.random()/4;ş}şEffect.Transitions.wobble = function(pos) {şreturn (-Math.cos(pos*Math.PI*(9*pos))/2) + 0.5;ş}şEffect.Transitions.pulse = function(pos) {şreturn (Math.floor(pos*10) % 2 == 0 ? ş(pos*10-Math.floor(pos*10)) : 1-(pos*10-Math.floor(pos*10)));ş}şEffect.Transitions.none = function(pos) {şreturn 0;ş}şEffect.Transitions.full = function(pos) {şreturn 1;ş}ş/* ------------- core effects ------------- */şEffect.ScopedQueue = Class.create();şObject.extend(Object.extend(Effect.ScopedQueue.prototype, Enumerable), {şinitialize: function() {şthis.effects  = [];şthis.interval = null;ş},ş_each: function(iterator) {şthis.effects._each(iterator);ş},şadd: function(effect) {şvar timestamp = new Date().getTime();şvar position = (typeof effect.options.queue == 'string') ? şeffect.options.queue : effect.options.queue.position;şswitch(position) {şcase 'front':şthis.effects.findAll(function(e){ return e.state=='idle' }).each( function(e) {şe.startOn  += effect.finishOn;şe.finishOn += effect.finishOn;ş});şbreak;şcase 'end':ştimestamp = this.effects.pluck('finishOn').max() || timestamp;şbreak;ş}şeffect.startOn  += timestamp;şeffect.finishOn += timestamp;şthis.effects.push(effect);şif(!this.interval) şthis.interval = setInterval(this.loop.bind(this), 40);ş},şremove: function(effect) {şthis.effects = this.effects.reject(function(e) { return e==effect });şif(this.effects.length == 0) {şclearInterval(this.interval);şthis.interval = null;ş}ş},şloop: function() {şvar timePos = new Date().getTime();şthis.effects.invoke('loop', timePos);ş}ş});şEffect.Queues = {şinstances: $H(),şget: function(queueName) {şif(typeof queueName != 'string') return queueName;şif(!this.instances[queueName])şthis.instances[queueName] = new Effect.ScopedQueue();şreturn this.instances[queueName];ş}ş}şEffect.Queue = Effect.Queues.get('global');şEffect.DefaultOptions = {ştransition: Effect.Transitions.sinoidal,şduration:   1.0,   // secondsşfps:        25.0,  // max. 25fps due to Effect.Queue implementationşsync:       false, // true for combiningşfrom:       0.0,şto:         1.0,şdelay:      0.0,şqueue:      'parallel'ş}şEffect.Base = function() {};şEffect.Base.prototype = {şposition: null,şstart: function(options) {şthis.options      = Object.extend(Object.extend({},Effect.DefaultOptions), options || {});şthis.currentFrame = 0;şthis.state        = 'idle';şthis.startOn      = this.options.delay*1000;şthis.finishOn     = this.startOn + (this.options.duration*1000);şthis.event('beforeStart');şif(!this.options.sync)şEffect.Queues.get(typeof this.options.queue == 'string' ? ş'global' : this.options.queue.scope).add(this);ş},şloop: function(timePos) {şif(timePos >= this.startOn) {şif(timePos >= this.finishOn) {şthis.render(1.0);şthis.cancel();şthis.event('beforeFinish');şif(this.finish) this.finish(); şthis.event('afterFinish');şreturn;  ş}şvar pos   = (timePos - this.startOn) / (this.finishOn - this.startOn);şvar frame = Math.round(pos * this.options.fps * this.options.duration);şif(frame > this.currentFrame) {şthis.render(pos);şthis.currentFrame = frame;ş}ş}ş},şrender: function(pos) {şif(this.state == 'idle') {şthis.state = 'running';şthis.event('beforeSetup');şif(this.setup) this.setup();şthis.event('afterSetup');ş}şif(this.state == 'running') {şif(this.options.transition) pos = this.options.transition(pos);şpos *= (this.options.to-this.options.from);şpos += this.options.from;şthis.position = pos;şthis.event('beforeUpdate');şif(this.update) this.update(pos);şthis.event('afterUpdate');ş}ş},şcancel: function() {şif(!this.options.sync)şEffect.Queues.get(typeof this.options.queue == 'string' ? ş'global' : this.options.queue.scope).remove(this);şthis.state = 'finished';ş},şevent: function(eventName) {şif(this.options[eventName + 'Internal']) this.options[eventName + 'Internal'](this);şif(this.options[eventName]) this.options[eventName](this);ş},şinspect: function() {şreturn '#<Effect:' + $H(this).inspect() + ',options:' + $H(this.options).inspect() + '>';ş}ş}şEffect.Parallel = Class.create();şObject.extend(Object.extend(Effect.Parallel.prototype, Effect.Base.prototype), {şinitialize: function(effects) {şthis.effects = effects || [];şthis.start(arguments[1]);ş},şupdate: function(position) {şthis.effects.invoke('render', position);ş},şfinish: function(position) {şthis.effects.each( function(effect) {şeffect.render(1.0);şeffect.cancel();şeffect.event('beforeFinish');şif(effect.finish) effect.finish(position);şeffect.event('afterFinish');ş});ş}ş});şEffect.Opacity = Class.create();şObject.extend(Object.extend(Effect.Opacity.prototype, Effect.Base.prototype), {şinitialize: function(element) {şthis.element = $(element);şif(/MSIE/.test(navigator.userAgent) && (!this.element.hasLayout))şElement.setStyle(this.element, {zoom: 1});şvar options = Object.extend({şfrom: Element.getOpacity(this.element) || 0.0,şto:   1.0ş}, arguments[1] || {});şthis.start(options);ş},şupdate: function(position) {şElement.setOpacity(this.element, position);ş}ş});şEffect.Move = Class.create();şObject.extend(Object.extend(Effect.Move.prototype, Effect.Base.prototype), {şinitialize: function(element) {şthis.element = $(element);şvar options = Object.extend({şx:    0,şy:    0,şmode: 'relative'ş}, arguments[1] || {});şthis.start(options);ş},şsetup: function() {şElement.makePositioned(this.element);şthis.originalLeft = parseFloat(Element.getStyle(this.element,'left') || '0');şthis.originalTop  = parseFloat(Element.getStyle(this.element,'top')  || '0');şif(this.options.mode == 'absolute') {şthis.options.x = this.options.x - this.originalLeft;şthis.options.y = this.options.y - this.originalTop;ş}ş},şupdate: function(position) {şElement.setStyle(this.element, {şleft: this.options.x  * position + this.originalLeft + 'px',ştop:  this.options.y  * position + this.originalTop  + 'px'ş});ş}ş});şEffect.MoveBy = function(element, toTop, toLeft) {şreturn new Effect.Move(element, şObject.extend({ x: toLeft, y: toTop }, arguments[3] || {}));ş};şEffect.Scale = Class.create();şObject.extend(Object.extend(Effect.Scale.prototype, Effect.Base.prototype), {şinitialize: function(element, percent) {şthis.element = $(element)şvar options = Object.extend({şscaleX: true,şscaleY: true,şscaleContent: true,şscaleFromCenter: false,şscaleMode: 'box',        // 'box' or 'contents' or {} with provided valuesşscaleFrom: 100.0,şscaleTo:   percentş}, arguments[2] || {});şthis.start(options);ş},şsetup: function() {şthis.restoreAfterFinish = this.options.restoreAfterFinish || false;şthis.elementPositioning = Element.getStyle(this.element,'position');şthis.originalStyle = {};ş['top','left','width','height','fontSize'].each( function(k) {şthis.originalStyle[k] = this.element.style[k];ş}.bind(this));şthis.originalTop  = this.element.offsetTop;şthis.originalLeft = this.element.offsetLeft;şvar fontSize = Element.getStyle(this.element,'font-size') || '100%';ş['em','px','%'].each( function(fontSizeType) {şif(fontSize.indexOf(fontSizeType)>0) {şthis.fontSize     = parseFloat(fontSize);şthis.fontSizeType = fontSizeType;ş}ş}.bind(this));şthis.factor = (this.options.scaleTo - this.options.scaleFrom)/100;şthis.dims = null;şif(this.options.scaleMode=='box')şthis.dims = [this.element.offsetHeight, this.element.offsetWidth];şif(/^content/.test(this.options.scaleMode))şthis.dims = [this.element.scrollHeight, this.element.scrollWidth];şif(!this.dims)şthis.dims = [this.options.scaleMode.originalHeight,şthis.options.scaleMode.originalWidth];ş},şupdate: function(position) {şvar currentScale = (this.options.scaleFrom/100.0) + (this.factor * position);şif(this.options.scaleContent && this.fontSize)şElement.setStyle(this.element, {fontSize: this.fontSize * currentScale + this.fontSizeType });şthis.setDimensions(this.dims[0] * currentScale, this.dims[1] * currentScale);ş},şfinish: function(position) {şif (this.restoreAfterFinish) Element.setStyle(this.element, this.originalStyle);ş},şsetDimensions: function(height, width) {şvar d = {};şif(this.options.scaleX) d.width = width + 'px';şif(this.options.scaleY) d.height = height + 'px';şif(this.options.scaleFromCenter) {şvar topd  = (height - this.dims[0])/2;şvar leftd = (width  - this.dims[1])/2;şif(this.elementPositioning == 'absolute') {şif(this.options.scaleY) d.top = this.originalTop-topd + 'px';şif(this.options.scaleX) d.left = this.originalLeft-leftd + 'px';ş} else {şif(this.options.scaleY) d.top = -topd + 'px';şif(this.options.scaleX) d.left = -leftd + 'px';ş}ş}şElement.setStyle(this.element, d);ş}ş});şEffect.Highlight = Class.create();şObject.extend(Object.extend(Effect.Highlight.prototype, Effect.Base.prototype), {şinitialize: function(element) {şthis.element = $(element);şvar options = Object.extend({ startcolor: '#ffff99' }, arguments[1] || {});şthis.start(options);ş},şsetup: function() {şif(Element.getStyle(this.element, 'display')=='none') { this.cancel(); return; }şthis.oldStyle = {şbackgroundImage: Element.getStyle(this.element, 'background-image') };şElement.setStyle(this.element, {backgroundImage: 'none'});şif(!this.options.endcolor)şthis.options.endcolor = Element.getStyle(this.element, 'background-color').parseColor('#ffffff');şif(!this.options.restorecolor)şthis.options.restorecolor = Element.getStyle(this.element, 'background-color');şthis._base  = $R(0,2).map(function(i){ return parseInt(this.options.startcolor.slice(i*2+1,i*2+3),16) }.bind(this));şthis._delta = $R(0,2).map(function(i){ return parseInt(this.options.endcolor.slice(i*2+1,i*2+3),16)-this._base[i] }.bind(this));ş},şupdate: function(position) {şElement.setStyle(this.element,{backgroundColor: $R(0,2).inject('#',function(m,v,i){şreturn m+(Math.round(this._base[i]+(this._delta[i]*position)).toColorPart()); }.bind(this)) });ş},şfinish: function() {şElement.setStyle(this.element, Object.extend(this.oldStyle, {şbackgroundColor: this.options.restorecolorş}));ş}ş});şEffect.ScrollTo = Class.create();şObject.extend(Object.extend(Effect.ScrollTo.prototype, Effect.Base.prototype), {şinitialize: function(element) {şthis.element = $(element);şthis.start(arguments[1] || {});ş},şsetup: function() {şPosition.prepare();şvar offsets = Position.cumulativeOffset(this.element);şif(this.options.offset) offsets[1] += this.options.offset;şvar max = window.innerHeight ? şwindow.height - window.innerHeight :şdocument.body.scrollHeight - ş(document.documentElement.clientHeight ? şdocument.documentElement.clientHeight : document.body.clientHeight);şthis.scrollStart = Position.deltaY;şthis.delta = (offsets[1] > max ? max : offsets[1]) - this.scrollStart;ş},şupdate: function(position) {şPosition.prepare();şwindow.scrollTo(Position.deltaX, şthis.scrollStart + (position*this.delta));ş}ş});ş/* ------------- combination effects ------------- */şEffect.Fade = function(element) {şvar oldOpacity = Element.getInlineOpacity(element);şvar options = Object.extend({şfrom: Element.getOpacity(element) || 1.0,şto:   0.0,şafterFinishInternal: function(effect) { with(Element) { şif(effect.options.to!=0) return;şhide(effect.element);şsetStyle(effect.element, {opacity: oldOpacity}); }}ş}, arguments[1] || {});şreturn new Effect.Opacity(element,options);ş}şEffect.Appear = function(element) {şvar options = Object.extend({şfrom: (Element.getStyle(element, 'display') == 'none' ? 0.0 : Element.getOpacity(element) || 0.0),şto:   1.0,şbeforeSetup: function(effect) { with(Element) {şsetOpacity(effect.element, effect.options.from);şshow(effect.element); }}ş}, arguments[1] || {});şreturn new Effect.Opacity(element,options);ş}şEffect.Puff = function(element) {şelement = $(element);şvar oldStyle = { opacity: Element.getInlineOpacity(element), position: Element.getStyle(element, 'position') };şreturn new Effect.Parallel(ş[ new Effect.Scale(element, 200, ş{ sync: true, scaleFromCenter: true, scaleContent: true, restoreAfterFinish: true }), şnew Effect.Opacity(element, { sync: true, to: 0.0 } ) ], şObject.extend({ duration: 1.0, şbeforeSetupInternal: function(effect) { with(Element) {şsetStyle(effect.effects[0].element, {position: 'absolute'}); }},şafterFinishInternal: function(effect) { with(Element) {şhide(effect.effects[0].element);şsetStyle(effect.effects[0].element, oldStyle); }}ş}, arguments[1] || {})ş);ş}şEffect.BlindUp = function(element) {şelement = $(element);şElement.makeClipping(element);şreturn new Effect.Scale(element, 0, şObject.extend({ scaleContent: false, şscaleX: false, şrestoreAfterFinish: true,şafterFinishInternal: function(effect) { with(Element) {ş[hide, undoClipping].call(effect.element); }} ş}, arguments[1] || {})ş);ş}şEffect.BlindDown = function(element) {şelement = $(element);şvar oldHeight = Element.getStyle(element, 'height');şvar elementDimensions = Element.getDimensions(element);şreturn new Effect.Scale(element, 100, şObject.extend({ scaleContent: false, şscaleX: false,şscaleFrom: 0,şscaleMode: {originalHeight: elementDimensions.height, originalWidth: elementDimensions.width},şrestoreAfterFinish: true,şafterSetup: function(effect) { with(Element) {şmakeClipping(effect.element);şsetStyle(effect.element, {height: '0px'});şshow(effect.element); ş}},  şafterFinishInternal: function(effect) { with(Element) {şundoClipping(effect.element);şsetStyle(effect.element, {height: oldHeight});ş}}ş}, arguments[1] || {})ş);ş}şEffect.SwitchOff = function(element) {şelement = $(element);şvar oldOpacity = Element.getInlineOpacity(element);şreturn new Effect.Appear(element, { şduration: 0.4,şfrom: 0,ştransition: Effect.Transitions.flicker,şafterFinishInternal: function(effect) {şnew Effect.Scale(effect.element, 1, { şduration: 0.3, scaleFromCenter: true,şscaleX: false, scaleContent: false, restoreAfterFinish: true,şbeforeSetup: function(effect) { with(Element) {ş[makePositioned,makeClipping].call(effect.element);ş}},şafterFinishInternal: function(effect) { with(Element) {ş[hide,undoClipping,undoPositioned].call(effect.element);şsetStyle(effect.element, {opacity: oldOpacity});ş}}ş})ş}ş});ş}şEffect.DropOut = function(element) {şelement = $(element);şvar oldStyle = {ştop: Element.getStyle(element, 'top'),şleft: Element.getStyle(element, 'left'),şopacity: Element.getInlineOpacity(element) };şreturn new Effect.Parallel(ş[ new Effect.Move(element, {x: 0, y: 100, sync: true }), şnew Effect.Opacity(element, { sync: true, to: 0.0 }) ],şObject.extend(ş{ duration: 0.5,şbeforeSetup: function(effect) { with(Element) {şmakePositioned(effect.effects[0].element); }},şafterFinishInternal: function(effect) { with(Element) {ş[hide, undoPositioned].call(effect.effects[0].element);şsetStyle(effect.effects[0].element, oldStyle); }} ş}, arguments[1] || {}));ş}şEffect.Shake = function(element) {şelement = $(element);şvar oldStyle = {ştop: Element.getStyle(element, 'top'),şleft: Element.getStyle(element, 'left') };şreturn new Effect.Move(element, ş{ x:  20, y: 0, duration: 0.05, afterFinishInternal: function(effect) {şnew Effect.Move(effect.element,ş{ x: -40, y: 0, duration: 0.1,  afterFinishInternal: function(effect) {şnew Effect.Move(effect.element,ş{ x:  40, y: 0, duration: 0.1,  afterFinishInternal: function(effect) {şnew Effect.Move(effect.element,ş{ x: -40, y: 0, duration: 0.1,  afterFinishInternal: function(effect) {şnew Effect.Move(effect.element,ş{ x:  40, y: 0, duration: 0.1,  afterFinishInternal: function(effect) {şnew Effect.Move(effect.element,ş{ x: -20, y: 0, duration: 0.05, afterFinishInternal: function(effect) { with(Element) {şundoPositioned(effect.element);şsetStyle(effect.element, oldStyle);ş}}}) }}) }}) }}) }}) }});ş}şEffect.SlideDown = function(element) {şelement = $(element);şElement.cleanWhitespace(element);şvar oldInnerBottom = Element.getStyle(element.firstChild, 'bottom');şvar elementDimensions = Element.getDimensions(element);şreturn new Effect.Scale(element, 100, Object.extend({ şscaleContent: false, şscaleX: false, şscaleFrom: 0,şscaleMode: {originalHeight: elementDimensions.height, originalWidth: elementDimensions.width},şrestoreAfterFinish: true,şafterSetup: function(effect) { with(Element) {şmakePositioned(effect.element);şmakePositioned(effect.element.firstChild);şif(window.opera) setStyle(effect.element, {top: ''});şmakeClipping(effect.element);şsetStyle(effect.element, {height: '0px'});şshow(element); }},şafterUpdateInternal: function(effect) { with(Element) {şsetStyle(effect.element.firstChild, {bottom:ş(effect.dims[0] - effect.element.clientHeight) + 'px' }); }},şafterFinishInternal: function(effect) { with(Element) {şundoClipping(effect.element); şundoPositioned(effect.element.firstChild);şundoPositioned(effect.element);şsetStyle(effect.element.firstChild, {bottom: oldInnerBottom}); }}ş}, arguments[1] || {})ş);ş}şEffect.SlideUp = function(element) {şelement = $(element);şElement.cleanWhitespace(element);şvar oldInnerBottom = Element.getStyle(element.firstChild, 'bottom');şreturn new Effect.Scale(element, 0, şObject.extend({ scaleContent: false, şscaleX: false, şscaleMode: 'box',şscaleFrom: 100,şrestoreAfterFinish: true,şbeforeStartInternal: function(effect) { with(Element) {şmakePositioned(effect.element);şmakePositioned(effect.element.firstChild);şif(window.opera) setStyle(effect.element, {top: ''});şmakeClipping(effect.element);şshow(element); }},  şafterUpdateInternal: function(effect) { with(Element) {şsetStyle(effect.element.firstChild, {bottom:ş(effect.dims[0] - effect.element.clientHeight) + 'px' }); }},şafterFinishInternal: function(effect) { with(Element) {ş[hide, undoClipping].call(effect.element); şundoPositioned(effect.element.firstChild);şundoPositioned(effect.element);şsetStyle(effect.element.firstChild, {bottom: oldInnerBottom}); }}ş}, arguments[1] || {})ş);ş}şEffect.Squish = function(element) {şreturn new Effect.Scale(element, window.opera ? 1 : 0, ş{ restoreAfterFinish: true,şbeforeSetup: function(effect) { with(Element) {şmakeClipping(effect.element); }},  şafterFinishInternal: function(effect) { with(Element) {şhide(effect.element); şundoClipping(effect.element); }}ş});ş}şEffect.Grow = function(element) {şelement = $(element);şvar options = Object.extend({şdirection: 'center',şmoveTransistion: Effect.Transitions.sinoidal,şscaleTransition: Effect.Transitions.sinoidal,şopacityTransition: Effect.Transitions.fullş}, arguments[1] || {});şvar oldStyle = {ştop: element.style.top,şleft: element.style.left,şheight: element.style.height,şwidth: element.style.width,şopacity: Element.getInlineOpacity(element) };şvar dims = Element.getDimensions(element);    şvar initialMoveX, initialMoveY;şvar moveX, moveY;şswitch (options.direction) {şcase 'top-left':şinitialMoveX = initialMoveY = moveX = moveY = 0; şbreak;şcase 'top-right':şinitialMoveX = dims.width;şinitialMoveY = moveY = 0;şmoveX = -dims.width;şbreak;şcase 'bottom-left':şinitialMoveX = moveX = 0;şinitialMoveY = dims.height;şmoveY = -dims.height;şbreak;şcase 'bottom-right':şinitialMoveX = dims.width;şinitialMoveY = dims.height;şmoveX = -dims.width;şmoveY = -dims.height;şbreak;şcase 'center':şinitialMoveX = dims.width / 2;şinitialMoveY = dims.height / 2;şmoveX = -dims.width / 2;şmoveY = -dims.height / 2;şbreak;ş}şreturn new Effect.Move(element, {şx: initialMoveX,şy: initialMoveY,şduration: 0.01, şbeforeSetup: function(effect) { with(Element) {şhide(effect.element);şmakeClipping(effect.element);şmakePositioned(effect.element);ş}},şafterFinishInternal: function(effect) {şnew Effect.Parallel(ş[ new Effect.Opacity(effect.element, { sync: true, to: 1.0, from: 0.0, transition: options.opacityTransition }),şnew Effect.Move(effect.element, { x: moveX, y: moveY, sync: true, transition: options.moveTransition }),şnew Effect.Scale(effect.element, 100, {şscaleMode: { originalHeight: dims.height, originalWidth: dims.width }, şsync: true, scaleFrom: window.opera ? 1 : 0, transition: options.scaleTransition, restoreAfterFinish: true})ş], Object.extend({şbeforeSetup: function(effect) { with(Element) {şsetStyle(effect.effects[0].element, {height: '0px'});şshow(effect.effects[0].element); }},şafterFinishInternal: function(effect) { with(Element) {ş[undoClipping, undoPositioned].call(effect.effects[0].element); şsetStyle(effect.effects[0].element, oldStyle); }}ş}, options)ş)ş}ş});ş}şEffect.Shrink = function(element) {şelement = $(element);şvar options = Object.extend({şdirection: 'center',şmoveTransistion: Effect.Transitions.sinoidal,şscaleTransition: Effect.Transitions.sinoidal,şopacityTransition: Effect.Transitions.noneş}, arguments[1] || {});şvar oldStyle = {ştop: element.style.top,şleft: element.style.left,şheight: element.style.height,şwidth: element.style.width,şopacity: Element.getInlineOpacity(element) };şvar dims = Element.getDimensions(element);şvar moveX, moveY;şswitch (options.direction) {şcase 'top-left':şmoveX = moveY = 0;şbreak;şcase 'top-right':şmoveX = dims.width;şmoveY = 0;şbreak;şcase 'bottom-left':şmoveX = 0;şmoveY = dims.height;şbreak;şcase 'bottom-right':şmoveX = dims.width;şmoveY = dims.height;şbreak;şcase 'center':  şmoveX = dims.width / 2;şmoveY = dims.height / 2;şbreak;ş}şreturn new Effect.Parallel(ş[ new Effect.Opacity(element, { sync: true, to: 0.0, from: 1.0, transition: options.opacityTransition }),şnew Effect.Scale(element, window.opera ? 1 : 0, { sync: true, transition: options.scaleTransition, restoreAfterFinish: true}),şnew Effect.Move(element, { x: moveX, y: moveY, sync: true, transition: options.moveTransition })ş], Object.extend({            şbeforeStartInternal: function(effect) { with(Element) {ş[makePositioned, makeClipping].call(effect.effects[0].element) }},şafterFinishInternal: function(effect) { with(Element) {ş[hide, undoClipping, undoPositioned].call(effect.effects[0].element);şsetStyle(effect.effects[0].element, oldStyle); }}ş}, options)ş);ş}şEffect.Pulsate = function(element) {şelement = $(element);şvar options    = arguments[1] || {};şvar oldOpacity = Element.getInlineOpacity(element);şvar transition = options.transition || Effect.Transitions.sinoidal;şvar reverser   = function(pos){ return transition(1-Effect.Transitions.pulse(pos)) };şreverser.bind(transition);şreturn new Effect.Opacity(element, şObject.extend(Object.extend({  duration: 3.0, from: 0,şafterFinishInternal: function(effect) { Element.setStyle(effect.element, {opacity: oldOpacity}); }ş}, options), {transition: reverser}));ş}şEffect.Fold = function(element) {şelement = $(element);şvar oldStyle = {ştop: element.style.top,şleft: element.style.left,şwidth: element.style.width,şheight: element.style.height };şElement.makeClipping(element);şreturn new Effect.Scale(element, 5, Object.extend({   şscaleContent: false,şscaleX: false,şafterFinishInternal: function(effect) {şnew Effect.Scale(element, 1, { şscaleContent: false, şscaleY: false,şafterFinishInternal: function(effect) { with(Element) {ş[hide, undoClipping].call(effect.element); şsetStyle(effect.element, oldStyle);ş}} });ş}}, arguments[1] || {}));ş}ş</script>ş<script type="text/javascript" language="javascript">şaddEvent(window, "load", sortables_init);şvar SORT_COLUMN_INDEX;şfunction sortables_init() {şif (!document.getElementsByTagName) return;ştbls = document.getElementsByTagName("table");şfor (ti=0;ti<tbls.length;ti++) {şthisTbl = tbls[ti];şif (Element.hasClassName(thisTbl,'sortable') && (thisTbl.id)) {şts_makeSortable(thisTbl);ş}ş}ş}şfunction ts_makeSortable(table) {şif (table.rows && table.rows.length > 0) {şvar firstRow = table.rows[0];ş}şif (!firstRow) return;şfor (var i=0;i<firstRow.cells.length;i++) {şvar cell = firstRow.cells[i];şvar txt = ts_getInnerText(cell);şif(txt!="" && txt!=" " && !Element.hasClassName(cell,"nosort")){şcell.innerHTML = '<a href="#" class="sortheader" onclick="ts_resortTable(this);return false;">'+txt+'<span class="sortarrow"></span></a>';ş}ş}ş}şfunction ts_getInnerText(el) {şif (typeof el == "string") return el;şif (typeof el == "undefined") { return el };şif (el.innerText) return el.innerText;//Not needed but it is fasterşvar str = "";şvar cs = el.childNodes;şvar l = cs.length;şfor (var i = 0; i < l; i++) {şswitch (cs[i].nodeType) {şcase 1: //ELEMENT_NODEşstr += ts_getInnerText(cs[i]);şbreak;şcase 3://TEXT_NODEşstr += cs[i].nodeValue;şbreak;ş}ş}şreturn str;ş}şfunction ts_resortTable(lnk) {şvar span;şfor (var ci=0;ci<lnk.childNodes.length;ci++) {şif (lnk.childNodes[ci].tagName && lnk.childNodes[ci].tagName.toLowerCase() == 'span') span = lnk.childNodes[ci];ş}şvar spantext = ts_getInnerText(span);şvar td = lnk.parentNode;şvar column = td.cellIndex;şvar table = getParent(td,'TABLE');şif (table.rows.length <= 1) return;şvar itm = ts_getInnerText(table.rows[1].cells[column]);şsortfn = ts_sort_caseinsensitive;şif (itm.match(/^\d\d[\/-]\d\d[\/-]\d\d\d\d$/)) sortfn = ts_sort_date;şif (itm.match(/^\d\d[\/-]\d\d[\/-]\d\d$/)) sortfn = ts_sort_date;şif (itm.match(/^[$]/)) sortfn = ts_sort_currency;şif (itm.match(/^[\d\.]+$/)) sortfn = ts_sort_numeric;şSORT_COLUMN_INDEX = column;şvar firstRow = new Array();şvar newRows = new Array();şfor (i=0;i<table.rows[0].length;i++) { firstRow[i] = table.rows[0][i]; }şfor (j=1;j<table.rows.length;j++) { newRows[j-1] = table.rows[j]; }şnewRows.sort(sortfn);şif (span.getAttribute("sortdir") == 'down') {şARROW = '<img src="/db/images/icon_down.gif"/>';şnewRows.reverse();şspan.setAttribute('sortdir','up');ş} else {şARROW = '<img src="/db/images/icon_up.gif"/>';şspan.setAttribute('sortdir','down');ş}şfor (i=0;i<newRows.length;i++) { if (!newRows[i].className || (newRows[i].className && (newRows[i].className.indexOf('sortbottom') == -1))) table.tBodies[0].appendChild(newRows[i]);}şfor (i=0;i<newRows.length;i++) { if (newRows[i].className && (newRows[i].className.indexOf('sortbottom') != -1)) table.tBodies[0].appendChild(newRows[i]);}şvar allspans = document.getElementsByTagName("span");şfor (var ci=0;ci<allspans.length;ci++) {şif (allspans[ci].className == 'sortarrow') {şif (getParent(allspans[ci],"table") == getParent(lnk,"table")) { // in the same table as us?şallspans[ci].innerHTML = '&nbsp;&nbsp;&nbsp;';ş}ş}ş}şspan.innerHTML = ARROW;şts_stripeTable(table);ş}şfunction getParent(el, pTagName) {şif (el == null) return null;şelse if (el.nodeType == 1 && el.tagName.toLowerCase() == pTagName.toLowerCase())// Gecko bug, supposed to be uppercaseşreturn el;şelseşreturn getParent(el.parentNode, pTagName);ş}şfunction ts_sort_date(a,b) {şaa = ts_getInnerText(a.cells[SORT_COLUMN_INDEX]);şbb = ts_getInnerText(b.cells[SORT_COLUMN_INDEX]);şif (aa.length == 10) {şdt1 = aa.substr(6,4)+aa.substr(3,2)+aa.substr(0,2);ş} else {şyr = aa.substr(6,2);şif (parseInt(yr) < 50) { yr = '20'+yr; } else { yr = '19'+yr; }şdt1 = yr+aa.substr(3,2)+aa.substr(0,2);ş}şif (bb.length == 10) {şdt2 = bb.substr(6,4)+bb.substr(3,2)+bb.substr(0,2);ş} else {şyr = bb.substr(6,2);şif (parseInt(yr) < 50) { yr = '20'+yr; } else { yr = '19'+yr; }şdt2 = yr+bb.substr(3,2)+bb.substr(0,2);ş}şif (dt1==dt2) return 0;şif (dt1<dt2) return -1;şreturn 1;ş}şfunction ts_sort_currency(a,b) { şaa = ts_getInnerText(a.cells[SORT_COLUMN_INDEX]).replace(/[^0-9.]/g,'');şbb = ts_getInnerText(b.cells[SORT_COLUMN_INDEX]).replace(/[^0-9.]/g,'');şreturn parseFloat(aa) - parseFloat(bb);ş}şfunction ts_sort_numeric(a,b) { şaa = parseFloat(ts_getInnerText(a.cells[SORT_COLUMN_INDEX]));şif (isNaN(aa)) aa = 0;şbb = parseFloat(ts_getInnerText(b.cells[SORT_COLUMN_INDEX])); şif (isNaN(bb)) bb = 0;şreturn aa-bb;ş}şfunction ts_sort_caseinsensitive(a,b) {şaa = ts_getInnerText(a.cells[SORT_COLUMN_INDEX]).toLowerCase();şbb = ts_getInnerText(b.cells[SORT_COLUMN_INDEX]).toLowerCase();şif (aa==bb) return 0;şif (aa<bb) return -1;şreturn 1;ş}şfunction ts_sort_default(a,b) {şaa = ts_getInnerText(a.cells[SORT_COLUMN_INDEX]);şbb = ts_getInnerText(b.cells[SORT_COLUMN_INDEX]);şif (aa==bb) return 0;şif (aa<bb) return -1;şreturn 1;ş}şfunction ts_stripeTable(tbl) {şvar table = $(tbl);şvar tbody;şif(tbody = table.getElementsByTagName("tbody")[0]) {ştable = tbody;ş}şfor(i=0;i<table.rows.length;i++) {şif(i%2) {şnewClass = "even";şoldClass = "odd";ş} else {şnewClass = "odd";şoldClass = "even";ş}şElement.removeClassName(table.rows[i],oldClass);şElement.addClassName(table.rows[i],newClass);ş}ş}şfunction addEvent(elm, evType, fn, useCapture)ş{şif (elm.addEventListener){şelm.addEventListener(evType, fn, useCapture);şreturn true;ş} else if (elm.attachEvent){şvar r = elm.attachEvent("on"+evType, fn);şreturn r;ş} else {şalert("Handler could not be removed");ş}ş} ş</script>ş<script type="text/javascript" language="javascript">şfunction createStyleRule(selector, declaration) {şif (!document.getElementsByTagName ||ş!(document.createElement || document.createElementNS)) return;şvar agt = navigator.userAgent.toLowerCase();şvar is_ie = ((agt.indexOf("msie") != -1) &&  (agt.indexOf("opera") == -1));şvar is_iewin = (is_ie &&  (agt.indexOf("win") != -1));şvar is_iemac = (is_ie &&  (agt.indexOf("mac") != -1));şif (is_iemac) return; // script doesn't work properly in IE/Macşvar head = document.getElementsByTagName("head")[0]; şvar style = (typeof document.createElementNS != "undefined") ?şdocument.createElementNS("http://www.w3.org/1999/xhtml", "style") :şdocument.createElement("style");şif (!is_iewin) {şvar styleRule = document.createTextNode(selector + " {" + declaration + "}");şstyle.appendChild(styleRule); // bugs in IE/Winş}şstyle.setAttribute("type", "text/css");şstyle.setAttribute("media", "screen"); şhead.appendChild(style);şif (is_iewin &&  document.styleSheets &&  document.styleSheets.length > 0) {şvar lastStyle = document.styleSheets[document.styleSheets.length - 1];şif (typeof lastStyle.addRule == "object") {şlastStyle.addRule(selector, declaration);ş}ş}ş}şfunction zoomThumbnails(value) {şif(!document.all) {şvar newValue = Math.round(value);şvar cssRule = "font-size: "+newValue+"px";şcreateStyleRule("a.thumbnail pre",cssRule);ş}ş}şfunction zoomThumbnailsUpdate(value) {şvar newValue = Math.round(value);şvar cssRule = "font-size: "+newValue+"px";şcreateStyleRule("a.thumbnail pre",cssRule);ş}şvar myrules = {ş'#printqueue tr' : function(element){şelement.onmouseover = function(){şElement.addClassName(element,"hover");ş},şelement.onmouseout = function(){şElement.removeClassName(element,"hover");ş}ş},ş'a.deletejob' : function(element){şif(document.all) {şelement.onclick = function(e) {şreturn confirm("Are you sure you want to delete this job?");ş}ş}ş},ş'input.date' : function(dateField){şif(!$(dateField.id+"trigger")) {şif(dateField.id=="") {şdateField.id = dateField.name;ş}şCalendar.setup({şinputField : dateField.id, şifFormat : "%m/%d/%y",şshowsTime : true,şbutton : dateField.id, //*şstep : 1,şweekNumbers: false,ş/* range: [2004,2005,2006], */şshowsTime: false,şonUpdate: function(e) {şvar row = $(dateField.id).parentNode;şwhile(row.tagName!="TR") {şrow = row.parentNode;ş}şElement.removeClassName(row,"error");ş}ş});ş}ş}ş};şfunction selectAll() {şform = document.forms['printqueueform'];şif (form.elements['entries[]'].length) {ş  for(var i = 0; i < form.elements['entries[]'].length; i++) {ş    form.elements['entries[]'][i].checked = 1;ş  }ş} else {ş  form.elements['entries[]'].checked = 1;ş}ş}şfunction deselectAll() {şform = document.forms['printqueueform'];şif (form.elements['entries[]'].length) {ş  for(var i = 0; i < form.elements['entries[]'].length; i++) {ş    form.elements['entries[]'][i].checked = 0;ş  }ş} else {ş  form.elements['entries[]'].checked = 0;ş}ş}şfunction showAdvSearch() {şEffect.Fade('filter', {duration: 1.0});şsetTimeout("Effect.Appear('advanced_search', {duration: 1.0})", 940);ş$('search_link').innerHTML = 'Hide Advanced Search';ş$('search_link').onclick = hideAdvSearch;ş}şfunction hideAdvSearch() {şEffect.Fade('advanced_search', {duration: 1.0});şsetTimeout("Effect.Appear('filter', {duration: 1.0})", 940);ş$('search_link').innerHTML = 'Advanced Search';ş$('search_link').onclick = showAdvSearch;ş}şBehaviour.register(myrules);ş</script>ş</head>ş<body class="">ş<div id="container">ş<!-- ş<div id="header">ş<a href="/" id="logo"><img src="/db/images/logo_bravoprint.gif" /></a>ş<ul id="navbar">ş<li class="active"><a href="/dbc/SBBP.SB.LISTPEQS">Print Queue</a></li>ş</ul>ş</div>ş-->ş<div id="maincontent">ş<div id="content">ş<!--ş <h1>Print Queue</h1>ş<div id="alerts">ş</div>ş-->ş<div style="margin-left:12px; margin-bottom:30px;"> ş<div class="printDialog" id="printDialogSelected" style="display:none;left:92px;top:27px;">ş<div>şQueue <input type="text" value="" style="width:40px;" maxlength="4" name="overridequeue"/>ş<span class="button"><button type="submit" onclick="this.form.submit(); return false;">Print</button></span> ş<span class="button"><button type="button" onclick="Effect.SlideUp('printDialogSelected',{duration:0.25}); return false;">Cancel</button></span>ş</div>ş</div>ş</div>ş<form action="/dbc/SBBP.SB.LISTPEQS" method="post" id="printqueueform">ş<input type="hidden" value="" name="action" id="action"/>ş<input type="hidden" value="" name="overridequeue" id="overridequeue"/>ş<input type="hidden" value="" name="queue" id="queue"/>ş<input type="hidden" value="" name="port" id="port"/>ş<input type="hidden" value="" name="owner" id="owner"/>ş<input type="hidden" value="" name="searchstring" id="searchstring"/>ş<input type="hidden" value="" name="begindate" id="begindate"/>ş<input type="hidden" value="" name="enddate" id="enddate"/>ş<input type="hidden" value="" name="search_type" id="search_type"/>ş<div style="float: left;margin: 0 0 10px 12px;">ş<img src="/db/images/graphic_withselected_up.gif"/> <a href="#" title="Select All" onclick="selectAll();return false;">Select All</a> |ş<a href="#" title="Deselect All" onclick="deselectAll();return false;">Deselect All</a> | With Selected: ş<span id="queueOverride">Print to Queue <input type="text" value="" name="queuet" id="queuet" style="width:40px;vertical-align:bottom;"/></span>ş<a href="#" title="Print Selected" onclick="$('overridequeue').value=$('queuet').value;$('action').value='print';$('printqueueform').submit(); return false;"><img src="/db/images/button_print.gif"/></a>ş<a href="#" title="Delete Selected" onclick="if(confirm('Are you sure you want to delete the selected jobs?')) { $('action').value='delete';$('printqueueform').submit(); return false;} else { return false; }"><img src="/db/images/button_delete.gif"/></a>ş</div>ş<table class="listing sortable" id="printqueue">ş<thead>ş<tr>ş<th style="width:20px;"></th>ş<th>Job</th>ş<th>Queue</th>ş<th>User</th>ş<th>Port</th>ş<th>Size (k)</th>ş<th>Datetime</th>ş<th>Status</th>ş<th style="width:120px;"></th>ş</tr>ş</thead>ş<tbody>ş[QUEUE]ş</tbody>ş</table>ş<div style="margin: 0 0 0 12px;">ş<img src="/db/images/graphic_withselected.gif"/> <a href="#" title="Select All" onclick="selectAll();return false;">Select All</a> |ş<a href="#" title="Deselect All" onclick="deselectAll();return false;">Deselect All</a> | With Selected: ş<span id="queueOverride">Print to Queue <input type="text" value="" name="queueb" id="queueb" style="width:40px;vertical-align:bottom;"/></span>ş<a href="#" title="Print Selected" onclick="$('overridequeue').value=$('queueb').value;$('action').value='print';$('printqueueform').submit(); return false;"><img src="/db/images/button_print.gif"/></a>ş<a href="#" title="Delete Selected" onclick="if(confirm('Are you sure you want to delete the selected jobs?')) { $('action').value='delete';$('printqueueform').submit(); return false;} else { return false; }"><img src="/db/images/button_delete.gif"/></a><br/> ş</div>ş</form>ş</div>ş</div>ş</div>ş<div id="footer">ş</div>ş</body>ş</html>