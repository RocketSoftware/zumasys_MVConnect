0000C5MV.INSTALL.CFþ0c0000032MVAPPS-PRE-SCRIPTþ0c0CREATE-FILE ZAPIER.BP TYPE=UD00003CMVAPPS-POST-SCRIPTþ0c0BASIC ZAPIER.BP *þCATALOG ZAPIER.BP (W000034PACKAGE.INFOþ0c0Zapier Webhookþ1.0.3þdbþþþZAPIERþ21800088AZAPIER.BPþ0c0000877ZAPIER.WEB.HOOKþ0c2      * THIS IS MY NW ORDERS RTNE PROGRAMþþ      CALL WSETCONTENTTYPE("application/json")þþ      CALL WOBJ(RESULT.OBJ,"FROMSTRING","","{}","",RERR)þþ      * Create a dummy Multi-Valued sample order recordþ      * Typically you would open your order file and read your orderþ      * record hereþþ      ID='1001'þ      ORDER='CUSTOMER1'þ      ORDER<2>='EMPLOYEE1'þ      ORDER<3>=DATE(); * ORDERED DATEþ      ORDER<4>=DATE()+3; * REQUIRED DATEþ      ORDER<5>=''; * SHIPPED DATEþþ      FOR X=1 TO 3; * Number of productsþ         ORDER<10,X> = "PRODUCT":Xþ         ORDER<11,X> = RND(99999)þ         ORDER<12,X> = RND(100)þ         ORDER<13,X>=0þ      NEXT Xþþ      CALL WOBJ(ORDER.OBJ,"FROMSTRING","","{}","",RERR)þþ      * Add our fields to the order objectþ      CALL WOBJ(ORDER.OBJ,"SET","orderid"                 ,ID                           ,"",RERR)þ      CALL WOBJ(ORDER.OBJ,"SET","customerid"              ,ORDER<1>                     ,"",RERR)þ      CALL WOBJ(ORDER.OBJ,"SET","employeeid"              ,ORDER<2>                     ,"",RERR)þ      CALL WOBJ(ORDER.OBJ,"SET","orderdate"               ,OCONV(ORDER<3>,"D4-")        ,"",RERR)þ      CALL WOBJ(ORDER.OBJ,"SET","requiredate"             ,OCONV(ORDER<4>,"D4-")        ,"",RERR)þ      CALL WOBJ(ORDER.OBJ,"SET","shippeddate"             ,OCONV(ORDER<5>,"D4-")        ,"",RERR)þþ      CALL WOBJ(ORDER.OBJ,"SET.ARRAY","items","[]","",RERR)þþ      NUMBER.ITEMS=DCOUNT(ORDER<10>,@VM)þþ      FOR V=1 TO NUMBER.ITEMSþ         CALL WOBJ(ITEMS.OBJ,"FROMSTRING","","{}","",RERR)þþ         CALL WOBJ(ITEMS.OBJ,"SET","productid"            ,ORDER<10,V>                 ,"",RERR)þ         CALL WOBJ(ITEMS.OBJ,"SET.NUMBER","unitprice"     ,OCONV(ORDER<11,V>,"MD2")    ,"",RERR)þ         CALL WOBJ(ITEMS.OBJ,"SET.NUMBER","quantity"      ,ORDER<12,V>,"",RERR)þ         CALL WOBJ(ITEMS.OBJ,"SET.NUMBER","discount"      ,OCONV(ORDER<13,V>,"MD2")    ,"",RERR)þþ         CALL WOBJ(ITEMS.OBJ,"TOSTRING","",ITEMS.JSON,"",RERR)þ         CALL WOBJ(ORDER.OBJ,"SET.OBJECT","items[-1]",ITEMS.JSON,"{}",RERR)þ      NEXT Vþþþ      CALL WOBJ(ORDER.OBJ,"TOSTRING","",ORDERJSON,"PRETTIFY",RERR)þþþþþþþ      STOPþþ000060MVDB.CONTROLþ0c000004AZAPIER.PACKAGE.JSONþ0c2{þ "bpfiles": [þ   { "filename": "ZAPIER.BP" }þ ]þ}